/*! For license information please see 533.ec59be7e.js.LICENSE.txt */
(self.webpackChunk_alvis_web=self.webpackChunk_alvis_web||[]).push([["533"],{859:function(t,e,i){"use strict";i.d(e,{Z:()=>v});var r=i("4194"),n=i("8773"),s=i("2315"),a=i("8429"),o=function(){return(o=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},l=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},h=r.forwardRef(function(t,e){var i=t.className,n=t.style,h=t.children,u=l(t,["className","style","children"]),d=(0,(0,r.useContext)(a.E).getPrefixCls)("btn-group"),c=(0,s.Z)(d,i);return r.createElement("div",o({ref:e,className:c,style:n},u),h)});h.displayName="ButtonGroup";var u=i("2888"),d=function(){return(d=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},c=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},p=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},g=/^[\u4e00-\u9fa5]{2}$/,f={htmlType:"button",type:"default",shape:"square"},m=(0,r.forwardRef)(function(t,e){var i,o,l,h,m=(0,r.useContext)(a.E),v=m.getPrefixCls,y=m.size,_=m.autoInsertSpaceInButton,b=m.componentConfig,x=m.rtl,S=(0,u.Z)(t,f,null==b?void 0:b.Button),k=S.style,A=S.className,w=S.children,M=S.htmlType,C=S.type,T=S.status,E=S.size,O=S.shape,P=S.href,R=S.anchorProps,B=S.disabled,I=S.loading,L=S.loadingFixedWidth,D=S.icon,F=S.iconOnly,j=S.onClick,N=S.long,z=c(S,["style","className","children","htmlType","type","status","size","shape","href","anchorProps","disabled","loading","loadingFixedWidth","icon","iconOnly","onClick","long"]),H=I?r.createElement(n.Z,null):D,V=p((0,r.useState)(!1),2),W=V[0],G=V[1],U=(0,r.useRef)(),$=e||U;(0,r.useEffect)(function(){if(_&&$&&$.current){var t=$.current.textContent;g.test(t)?!W&&G(!0):W&&G(!1)}},[$.current,_]);var Y=v("btn"),K=(0,s.Z)(Y,Y+"-"+("default"===C?"secondary":C),Y+"-size-"+(E||y),Y+"-shape-"+O,((h={})[Y+"-long"]=N,h[Y+"-status-"+T]=T,h[Y+"-loading-fixed-width"]=L,h[Y+"-loading"]=I,h[Y+"-link"]=P,h[Y+"-icon-only"]=F||!w&&0!==w&&H,h[Y+"-disabled"]=B,h[Y+"-two-chinese-chars"]=W,h[Y+"-rtl"]=x,h),A),Z=function(t){if(I||B){"function"==typeof(null==t?void 0:t.preventDefault)&&t.preventDefault();return}j&&j(t)};var X=r.createElement(r.Fragment,null,H,(i=w,o=[],l=!1,r.Children.forEach(i,function(t){var e="string"==typeof t||"number"==typeof t;if(e&&l){var i=o.length-1,r=o[i];o[i]=""+r+t}else o.push(t);l=e}),r.Children.map(o,function(t){return"string"==typeof t?r.createElement("span",null,t):t})));if(P){var q=d({},R);return B?delete q.href:q.href=P,r.createElement("a",d({ref:$},z,q,{style:k,className:K,onClick:Z}),X)}return r.createElement("button",d({ref:$},z,{style:k,className:K,type:M,disabled:B,onClick:Z}),X)});m.__BYTE_BUTTON=!0,m.Group=h,m.displayName="Button";let v=m},8718:function(t,e,i){"use strict";i("4290")},800:function(t,e,i){"use strict";i.d(e,{Z:()=>M});var r=i("4194"),n=i("2315"),s=i("8429"),a=function(){return(a=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},o=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},l=r.forwardRef(function(t,e){var i,l=t.className,h=t.title,u=t.avatar,d=t.description,c=t.actionList,p=o(t,["className","title","avatar","description","actionList"]),g=(0,(0,r.useContext)(s.E).getPrefixCls)("card-meta"),f=(0,n.Z)(g,l);return r.createElement("div",a({},p,{ref:e,className:f}),h||d?r.createElement("div",{className:g+"-content"},h&&r.createElement("div",{className:g+"-title"},h),d&&r.createElement("div",{className:g+"-description"},d)):null,u||c?r.createElement("div",{className:(0,n.Z)(g+"-footer ",((i={})[g+"-footer-only-actions"]=!u,i))},u?r.createElement("div",{className:g+"-avatar"},u):null,c):null)});l.displayName="CardMeta";var h=r.forwardRef(function(t,e){var i,a=t.children,o=t.style,l=t.className,h=t.hoverable,u=(0,(0,r.useContext)(s.E).getPrefixCls)("card-grid");return r.createElement("div",{ref:e,style:o,className:(0,n.Z)(u,((i={})[u+"-hoverable"]=h,i),l)},a)});h.displayName="CardGrid";var u=i("7837"),d=i.n(u),c=i("8773"),p=i("9743"),g=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},f=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))};function m(t){var e=(0,(0,r.useContext)(s.E).getPrefixCls)("spin")+"-dot",i={width:t.size,height:t.size},n=t.size?parseInt(String(t.size)):0;return r.createElement("div",{className:e+"-list",style:{height:t.size,width:(0,p.hj)(n)&&n>0?7*n:""}},f([],g([,,,,,]),!1).map(function(t,n){return r.createElement("div",{key:n,className:e,style:i})}))}var v=i("2888"),y=function(){return(y=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},_=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},b=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},x=r.forwardRef(function(t,e){var i,a=(0,r.useContext)(s.E),o=a.getPrefixCls,l=a.componentConfig,h=(0,v.Z)(t,{},null==l?void 0:l.Spin),u=h.style,g=h.className,f=h.children,x=h.loading,S=h.size,k=h.icon,A=h.element,w=h.tip,M=h.dot,C=h.delay,T=h.block,E=_(h,["style","className","children","loading","size","icon","element","tip","dot","delay","block"]),O=b((0,r.useState)(!C&&x),2),P=O[0],R=O[1],B=(0,r.useCallback)(d()(R,C),[C]),I=C?P:x,L=o("spin");(0,r.useEffect)(function(){return C&&B(x),function(){B&&B.cancel()}},[x]);var D=r.createElement("span",{className:L+"-icon"},k?r.cloneElement(k,{className:(0,n.Z)(L.replace("-spin","-icon")+"-loading"),style:{fontSize:S}}):A||(M?r.createElement(m,{size:S}):r.createElement(c.Z,{style:{fontSize:S}})));return r.createElement("div",y({ref:e,className:(0,n.Z)(L,((i={})[L+"-block"]=void 0!==T&&T,i[L+"-loading"]=I,i[L+"-with-tip"]=w&&!f,i),g),style:u},E),(0,p.U$)(f)?r.createElement(r.Fragment,null,D,w?r.createElement("div",{className:L+"-tip"},w):null):r.createElement(r.Fragment,null,r.createElement("div",{className:L+"-children"},f),I&&r.createElement("div",{className:L+"-loading-layer",style:{fontSize:S}},r.createElement("span",{className:L+"-loading-layer-inner"},D,w?r.createElement("div",{className:L+"-tip"},w):null))))});x.displayName="Spin";var S=function(){return(S=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},k=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},A={size:"default",bordered:!0},w=r.forwardRef(function(t,e){var i,a,o=(0,r.useContext)(s.E),u=o.getPrefixCls,d=o.loadingElement,c=o.componentConfig,p=o.rtl,g=(0,v.Z)(t,A,null==c?void 0:c.Card),f=g.className,m=g.children,y=g.bordered,_=g.loading,b=g.hoverable,w=g.size,M=g.title,C=g.extra,T=g.cover,E=g.actions,O=g.headerStyle,P=g.bodyStyle,R=k(g,["className","children","bordered","loading","hoverable","size","title","extra","cover","actions","headerStyle","bodyStyle"]),B=u("card"),I=E&&E.length?r.createElement("div",{className:B+"-actions"},r.createElement("div",{className:B+"-actions-right"},E.map(function(t,e){return r.createElement("span",{key:"action-"+e,className:B+"-actions-item"},t)}))):null,L=!1,D=!1,F=r.Children.map(m,function(t){if(t&&t.type){if(t.type===h)L=!0;else if(t.type===l)return D=!0,r.cloneElement(t,{actionList:I})}return t});return r.createElement("div",S({},R,{ref:e,className:(0,n.Z)(B,B+"-size-"+w,((i={})[B+"-loading"]=_,i[B+"-bordered"]=y,i[B+"-hoverable"]=b,i[B+"-contain-grid"]=L,i[B+"-rtl"]=p,i),f)}),M||C?r.createElement("div",{className:(0,n.Z)(B+"-header",((a={})[B+"-header-no-title"]=!M,a)),style:O},M&&r.createElement("div",{className:B+"-header-title"},M),C&&r.createElement("div",{className:B+"-header-extra"},C)):null,T?r.createElement("div",{className:B+"-cover"},T):null,r.createElement("div",{className:B+"-body",style:P},_?d||r.createElement(x,null):F,D?null:I))});w.Meta=l,w.Grid=h,w.displayName="Card";let M=w},5792:function(t,e,i){"use strict";i("4290")},8429:function(t,e,i){"use strict";i.d(e,{E:()=>_,G:()=>y});var r=i("4194");i("6603");var n={formatYear:"YYYY \u5E74",formatMonth:"YYYY \u5E74 MM \u6708",monthBeforeYear:!1,today:"\u4ECA\u5929",view:{month:"\u6708",year:"\u5E74",week:"\u5468",day:"\u65E5"},month:{long:{January:"\u4E00\u6708",February:"\u4E8C\u6708",March:"\u4E09\u6708",April:"\u56DB\u6708",May:"\u4E94\u6708",June:"\u516D\u6708",July:"\u4E03\u6708",August:"\u516B\u6708",September:"\u4E5D\u6708",October:"\u5341\u6708",November:"\u5341\u4E00\u6708",December:"\u5341\u4E8C\u6708"},short:{January:"\u4E00\u6708",February:"\u4E8C\u6708",March:"\u4E09\u6708",April:"\u56DB\u6708",May:"\u4E94\u6708",June:"\u516D\u6708",July:"\u4E03\u6708",August:"\u516B\u6708",September:"\u4E5D\u6708",October:"\u5341\u6708",November:"\u5341\u4E00\u6708",December:"\u5341\u4E8C\u6708"}},week:{long:{self:"\u5468",monday:"\u5468\u4E00",tuesday:"\u5468\u4E8C",wednesday:"\u5468\u4E09",thursday:"\u5468\u56DB",friday:"\u5468\u4E94",saturday:"\u5468\u516D",sunday:"\u5468\u65E5"},short:{self:"\u5468",monday:"\u4E00",tuesday:"\u4E8C",wednesday:"\u4E09",thursday:"\u56DB",friday:"\u4E94",saturday:"\u516D",sunday:"\u65E5"}}},s=i("9933"),a=i("8336"),o=i("5296");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach(function(e){(0,a.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var u=r.forwardRef(function(t,e){var i=(0,r.useContext)(o.P).prefixCls,n=void 0===i?"arco":i,a=t.spin,l=t.className,u=h(h({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(l?l+" ":"").concat(n,"-icon ").concat(n,"-icon-empty")});return a&&(u.className="".concat(u.className," ").concat(n,"-icon-loading")),delete u.spin,delete u.isIcon,r.createElement("svg",(0,s.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},u),r.createElement("path",{d:"M24 5v6m7 1 4-4m-18 4-4-4m28.5 22H28s-1 3-4 3-4-3-4-3H6.5M40 41H8a2 2 0 0 1-2-2v-8.46a2 2 0 0 1 .272-1.007l6.15-10.54A2 2 0 0 1 14.148 18H33.85a2 2 0 0 1 1.728.992l6.149 10.541A2 2 0 0 1 42 30.541V39a2 2 0 0 1-2 2Z"}))});u.defaultProps={isIcon:!0},u.displayName="IconEmpty";var d=i("2315"),c=i("2888"),p=function(){return(p=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},g=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},f=(0,r.forwardRef)(function(t,e){var i=(0,r.useContext)(_),n=i.getPrefixCls,s=i.locale,a=i.componentConfig,o=(0,c.Z)(t,{},null==a?void 0:a.Empty),l=o.style,h=o.className,f=o.description,m=o.icon,v=o.imgSrc,y=g(o,["style","className","description","icon","imgSrc"]),b=n("empty"),x=(0,d.Z)(b,h),S=s.Empty.noData,k="string"==typeof f?f:"empty";return r.createElement("div",p({ref:e,className:x,style:l},y),r.createElement("div",{className:b+"-wrapper"},r.createElement("div",{className:b+"-image"},v?r.createElement("img",{alt:k,src:v}):m||r.createElement(u,null)),r.createElement("div",{className:b+"-description"},f||S)))});f.displayName="Empty";let m=(0,r.memo)(f);var v=function(){return(v=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},y={locale:{locale:"zh-CN",dayjsLocale:"zh-cn",Calendar:n,DatePicker:{Calendar:n,placeholder:{date:"\u8BF7\u9009\u62E9\u65E5\u671F",week:"\u8BF7\u9009\u62E9\u5468",month:"\u8BF7\u9009\u62E9\u6708\u4EFD",year:"\u8BF7\u9009\u62E9\u5E74\u4EFD",quarter:"\u8BF7\u9009\u62E9\u5B63\u5EA6"},placeholders:{date:["\u5F00\u59CB\u65E5\u671F","\u7ED3\u675F\u65E5\u671F"],week:["\u5F00\u59CB\u5468","\u7ED3\u675F\u5468"],month:["\u5F00\u59CB\u6708\u4EFD","\u7ED3\u675F\u6708\u4EFD"],year:["\u5F00\u59CB\u5E74\u4EFD","\u7ED3\u675F\u5E74\u4EFD"],quarter:["\u5F00\u59CB\u5B63\u5EA6","\u7ED3\u675F\u5B63\u5EA6"]},selectTime:"\u9009\u62E9\u65F6\u95F4",selectDate:"\u9009\u62E9\u65E5\u671F",today:"\u4ECA\u5929",now:"\u6B64\u523B",ok:"\u786E\u5B9A"},Drawer:{okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},Empty:{noData:"\u6682\u65E0\u6570\u636E"},Modal:{okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},Pagination:{goto:"\u524D\u5F80",page:"\u9875",countPerPage:"\u6761/\u9875",total:"\u5171 {0} \u6761",prev:"\u4E0A\u4E00\u9875",next:"\u4E0B\u4E00\u9875",currentPage:"\u7B2C {0} \u9875",prevSomePages:"\u5411\u524D {0} \u9875",nextSomePages:"\u5411\u540E {0} \u9875",pageSize:"\u9875\u7801"},Popconfirm:{okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},Table:{okText:"\u786E\u5B9A",resetText:"\u91CD\u7F6E",sortAscend:"\u70B9\u51FB\u5347\u5E8F",sortDescend:"\u70B9\u51FB\u964D\u5E8F",cancelSort:"\u53D6\u6D88\u6392\u5E8F"},TimePicker:{ok:"\u786E\u5B9A",placeholder:"\u8BF7\u9009\u62E9\u65F6\u95F4",placeholders:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],now:"\u6B64\u523B"},Progress:{success:"\u5B8C\u6210",error:"\u5931\u8D25"},Upload:{start:"\u5F00\u59CB",cancel:"\u53D6\u6D88",delete:"\u5220\u9664",reupload:"\u70B9\u51FB\u91CD\u8BD5",upload:"\u70B9\u51FB\u4E0A\u4F20",preview:"\u9884\u89C8",drag:"\u70B9\u51FB\u6216\u62D6\u62FD\u6587\u4EF6\u5230\u6B64\u5904\u4E0A\u4F20",dragHover:"\u91CA\u653E\u6587\u4EF6\u5E76\u5F00\u59CB\u4E0A\u4F20",error:"\u4E0A\u4F20\u5931\u8D25"},Typography:{copy:"\u590D\u5236",copied:"\u5DF2\u590D\u5236",edit:"\u7F16\u8F91",fold:"\u6298\u53E0",unfold:"\u5C55\u5F00"},Transfer:{resetText:"\u91CD\u7F6E"},ImagePreview:{fullScreen:"\u5168\u5C4F",rotateRight:"\u5411\u53F3\u65CB\u8F6C",rotateLeft:"\u5411\u5DE6\u65CB\u8F6C",zoomIn:"\u653E\u5927",zoomOut:"\u7F29\u5C0F",originalSize:"\u539F\u59CB\u5C3A\u5BF8"},Form:{validateMessages:{required:"#{field} \u662F\u5FC5\u586B\u9879",type:{string:"#{field} \u4E0D\u662F\u5408\u6CD5\u7684\u6587\u672C\u7C7B\u578B",number:"#{field} \u4E0D\u662F\u5408\u6CD5\u7684\u6570\u5B57\u7C7B\u578B",boolean:"#{field} \u4E0D\u662F\u5408\u6CD5\u7684\u5E03\u5C14\u7C7B\u578B",array:"#{field} \u4E0D\u662F\u5408\u6CD5\u7684\u6570\u7EC4\u7C7B\u578B",object:"#{field} \u4E0D\u662F\u5408\u6CD5\u7684\u5BF9\u8C61\u7C7B\u578B",url:"#{field} \u4E0D\u662F\u5408\u6CD5\u7684 url \u5730\u5740",email:"#{field} \u4E0D\u662F\u5408\u6CD5\u7684\u90AE\u7BB1\u5730\u5740",ip:"#{field} \u4E0D\u662F\u5408\u6CD5\u7684 IP \u5730\u5740"},number:{min:"`#{value}` \u5C0F\u4E8E\u6700\u5C0F\u503C `#{min}`",max:"`#{value}` \u5927\u4E8E\u6700\u5927\u503C `#{max}`",equal:"`#{value}` \u4E0D\u7B49\u4E8E `#{equal}`",range:"`#{value}` \u4E0D\u5728 `#{min} ~ #{max}` \u8303\u56F4\u5185",positive:"`#{value}` \u4E0D\u662F\u6B63\u6570",negative:"`#{value}` \u4E0D\u662F\u8D1F\u6570"},array:{length:"`#{field}` \u4E2A\u6570\u4E0D\u7B49\u4E8E #{length}",minLength:"`#{field}` \u4E2A\u6570\u6700\u5C11\u4E3A #{minLength}",maxLength:"`#{field}` \u4E2A\u6570\u6700\u591A\u4E3A #{maxLength}",includes:"#{field} \u4E0D\u5305\u542B #{includes}",deepEqual:"#{field} \u4E0D\u7B49\u4E8E #{deepEqual}",empty:"`#{field}` \u4E0D\u662F\u7A7A\u6570\u7EC4"},string:{minLength:"\u5B57\u7B26\u6570\u6700\u5C11\u4E3A #{minLength}",maxLength:"\u5B57\u7B26\u6570\u6700\u591A\u4E3A #{maxLength}",length:"\u5B57\u7B26\u6570\u5FC5\u987B\u662F #{length}",match:"`#{value}` \u4E0D\u7B26\u5408\u6A21\u5F0F #{pattern}",uppercase:"`#{value}` \u5FC5\u987B\u5168\u5927\u5199",lowercase:"`#{value}` \u5FC5\u987B\u5168\u5C0F\u5199"},object:{deepEqual:"`#{field}` \u4E0D\u7B49\u4E8E\u671F\u671B\u503C",hasKeys:"`#{field}` \u4E0D\u5305\u542B\u5FC5\u987B\u5B57\u6BB5",empty:"`#{field}` \u4E0D\u662F\u5BF9\u8C61"},boolean:{true:"\u671F\u671B\u662F `true`",false:"\u671F\u671B\u662F `false`"}}},ColorPicker:{history:"\u6700\u8FD1\u4F7F\u7528\u989C\u8272",preset:"\u7CFB\u7EDF\u9884\u8BBE\u989C\u8272",empty:"\u6682\u65E0"}},prefixCls:"arco",getPopupContainer:function(){return document.body},size:"default",renderEmpty:function(t){return r.createElement(m,null)},focusLock:{modal:{autoFocus:!0},drawer:{autoFocus:!0}}},_=(0,r.createContext)(v({getPrefixCls:function(t,e){return(e||"arco")+"-"+t}},y))},8442:function(t,e,i){"use strict";i.d(e,{Z:function(){return d}});var r=i(4194),n=i(2315),s=i(8429),a=i(2888),o=function(){return(o=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},l=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},h={type:"horizontal",orientation:"center"},u=(0,r.forwardRef)(function(t,e){var i,u=(0,r.useContext)(s.E),d=u.getPrefixCls,c=u.componentConfig,p=(0,a.Z)(t,h,null==c?void 0:c.Divider),g=p.children,f=p.style,m=p.className,v=p.type,y=p.orientation,_=l(p,["children","style","className","type","orientation"]),b=d("divider"),x=(0,n.Z)(b,b+"-"+v,((i={})[b+"-with-text"]=g,i[b+"-with-text-"+y]=g&&y,i),m);return r.createElement("div",o({role:"separator",ref:e,className:x,style:f},_),g&&"horizontal"===v?r.createElement("span",{className:b+"-text "+b+"-text-"+y},g):null)});u.displayName="Divider";let d=u},9575:function(t,e,i){"use strict";i("4290")},4887:function(t,e,i){"use strict";i.d(e,{Z:()=>B});var r=i("4194"),n=i("3546"),s=i.n(n),a=i("9745"),o=i("859"),l=i("9933"),h=i("8336"),u=i("5296");function d(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?d(Object(i),!0).forEach(function(e){(0,h.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var p=r.forwardRef(function(t,e){var i=(0,r.useContext)(u.P).prefixCls,n=void 0===i?"arco":i,s=t.spin,a=t.className,o=c(c({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(a?a+" ":"").concat(n,"-icon ").concat(n,"-icon-more")});return s&&(o.className="".concat(o.className," ").concat(n,"-icon-loading")),delete o.spin,delete o.isIcon,r.createElement("svg",(0,l.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),r.createElement("path",{fill:"currentColor",stroke:"none",d:"M38 25v-2h2v2h-2ZM23 25v-2h2v2h-2ZM8 25v-2h2v2H8Z"}),r.createElement("path",{d:"M38 25v-2h2v2h-2ZM23 25v-2h2v2h-2ZM8 25v-2h2v2H8Z"}))});p.defaultProps={isIcon:!0},p.displayName="IconMore";var g=i("8429"),f=i("2888"),m=i("8929"),v=function(){return(v=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},y=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},_=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},b={position:"br",trigger:"hover",type:"default",icon:r.createElement(p,null),unmountOnExit:!0},x=(0,r.forwardRef)(function(t,e){var i,n=(0,r.useContext)(g.E).componentConfig,s=(0,f.Z)(t,b,null==n?void 0:n["Dropdown.Button"]),a=s.className,l=s.style,h=s.children,u=s.disabled,d=s.position,c=s.type,x=void 0===c?"default":c,S=s.size,k=s.icon,A=void 0===k?r.createElement(p,null):k,w=s.onClick,M=s.buttonProps,C=s.buttonsRender,T=y(s,["className","style","children","disabled","position","type","size","icon","onClick","buttonProps","buttonsRender"]),E=r.createElement(o.Z,v({disabled:u,type:x,size:S,onClick:w},M),h),O=r.createElement(o.Z,{disabled:u,type:x,size:S,icon:A});C&&(E=(i=_(C([E,O]),2))[0],O=i[1]);var P=u||!O||O.props&&O.props.loading;return r.createElement(o.Z.Group,v({className:a,style:l,ref:e},(0,m.m)(s)),E,r.createElement(B,v({disabled:u,position:void 0===d?"br":d},T,{triggerProps:v({disabled:P},null==T?void 0:T.triggerProps)}),O))});x.displayName="DropdownButton";var S=i("2315"),k=i("3779"),A=i("4672"),w=function(){return(w=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},M=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},C=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},T=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],r=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},E=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))},O={position:"bl",trigger:"hover",unmountOnExit:!0},P={left:4,right:4,top:4,bottom:4},R=r.forwardRef(function(t,e){var i,n=(0,r.useContext)(g.E),o=n.getPrefixCls,l=n.componentConfig,h=n.rtl,u=(0,f.Z)(t,O,null==l?void 0:l.Dropdown),d=u.trigger,c=u.droplist,p=u.children,v=u.position,y=u.disabled,_=u.unmountOnExit,b=u.triggerProps,x=u.getPopupContainer,R=u.onVisibleChange,B=M(u,["trigger","droplist","children","position","disabled","unmountOnExit","triggerProps","getPopupContainer","onVisibleChange"]),I=o("dropdown"),L=(0,r.useRef)(null),D=C((0,k.Z)(!1,{defaultValue:u.defaultPopupVisible,value:u.popupVisible}),2),F=D[0],j=D[1],N=function(){return r.Children.only(c||r.createElement("span",null))},z=function(t){j(t),R&&R(t),b&&b.onVisibleChange&&b.onVisibleChange(t)};return r.createElement(a.Z,w({ref:function(t){return L.current=t},classNames:"slideDynamicOrigin",childrenPrefix:I,trigger:d,popup:function(){var t,e,i,n=N();if(s()(n,"type.__ARCO_MENU__")||s()(n,"props.isMenu")){var a=!0;try{for(var o=T(r.Children.toArray(n.props.children)),l=o.next();!l.done;l=o.next()){var h=l.value;if(null!=h){a=!1;break}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r.cloneElement(n,{prefixCls:(0,S.Z)(I+"-menu",((i={})[I+"-menu-hidden"]=a,i)),inDropdown:!0,selectable:!1,onClickMenuItem:function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=null,n=N();n.props.onClickMenuItem&&(r=(t=n.props).onClickMenuItem.apply(t,E([],C(e),!1)));var s=L.current&&L.current.getRootElement();s&&s.focus&&s.focus(),r instanceof Promise?r.finally(function(){return z(!1)}):!1!==r&&z(!1)}})}return n},mouseEnterDelay:400,mouseLeaveDelay:400,disabled:y,unmountOnExit:_,position:v,popupVisible:F,popupAlign:P,getPopupContainer:x,alignPoint:"contextMenu"===d},(0,m.Z)(B,a.C),(0,m.m)(B),(0,A.Z)(b,["onVisibleChange"]),{onVisibleChange:function(t){t!==F&&z(t)}}),r.isValidElement(p)?r.cloneElement(p,w(w({},"boolean"==typeof y?{disabled:y}:{}),{className:(0,S.Z)(((i={})[I+"-popup-visible"]=F,i[[I]+"-rtl"]=h,i),p.props.className)})):p)});R.displayName="Dropdown",R.Button=x;let B=R},7645:function(t,e,i){"use strict";i("4290"),i("8718"),i("5146")},8895:function(t,e,i){"use strict";i.d(e,{Z:()=>F});var r=i("4194"),n=i("2315"),s=i("9743"),a=i("8429"),o=i("2888"),l=(0,r.createContext)({}),h=(0,r.createContext)({}),u=(0,r.createContext)({}),d=function(){return(d=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},c=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},p={span:24};function g(t){return"string"==typeof t&&/\d+[px|%|em|rem|]{1}/.test(t)?"0 0 "+t:t}var f=(0,r.forwardRef)(function(t,e){var i,h,u,f,m=(0,r.useContext)(a.E),v=m.getPrefixCls,y=m.componentConfig,_=m.rtl,b=(0,o.Z)(t,p,null==y?void 0:y["Grid.Col"]),x=(0,r.useContext)(l),S=x.gutter,k=x.div,A=b.className,w=b.style,M=b.children,C=b.span,T=b.offset,E=b.order,O=b.pull,P=b.push,R=b.xs,B=b.sm,I=b.md,L=b.lg,D=b.xl,F=b.xxl,j=b.xxxl,N=b.flex,z=c(b,["className","style","children","span","offset","order","pull","push","xs","sm","md","lg","xl","xxl","xxxl","flex"]),H=v("col"),V=((f={})[""+H]=!k,f[H+"-order-"+E]=E,f[H+"-"+C]=!k&&!R&&!B&&!I&&!L&&!D&&!F&&!j,f[H+"-offset-"+T]=T,f[H+"-pull-"+O]=O,f[H+"-push-"+P]=P,f[H+"-rtl"]=_,f);i=H,h=V,Object.keys(u={xs:R,sm:B,md:I,lg:L,xl:D,xxl:F,xxxl:j}).forEach(function(t){var e=u[t];(0,s.hj)(e)?e>=0&&(h[i+"-"+t+"-"+e]=!0):(0,s.Kn)(e)&&(h[i+"-"+t+"-"+e.span]=e.span,h[i+"-"+t+"-offset-"+e.offset]=e.offset,h[i+"-"+t+"-order-"+e.order]=e.order,h[i+"-"+t+"-pull-"+e.pull]=e.pull,h[i+"-"+t+"-push-"+e.push]=e.push)}),V=h;var W=(0,n.Z)(N?H:V,A),G={};if(Array.isArray(S)&&!k){var U=S[0]&&S[0]/2||0,$=S[1]&&S[1]/2||0;U&&(G.paddingLeft=U,G.paddingRight=U),$&&(G.paddingTop=$,G.paddingBottom=$)}var Y=(0,r.useMemo)(function(){return g(N)?{flex:g(N)}:{}},[N]);return r.createElement("div",d({ref:e},z,{style:d(d(d({},w),G),Y),className:W}),M)});f.displayName="Col";var m=i("4672"),v=i("3095"),y=function(){return(y=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},_=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},b=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},x={gutter:0,align:"start",justify:"start"},S=(0,r.forwardRef)(function(t,e){var i,s=(0,r.useContext)(a.E),h=s.getPrefixCls,u=s.componentConfig,d=s.rtl,c=(0,o.Z)(t,x,null==u?void 0:u["Grid.Row"]),p=c.className,g=c.style,f=c.children,S=c.div,k=c.align,A=c.justify,w=c.gutter,M=_(c,["className","style","children","div","align","justify","gutter"]),C=b((0,r.useState)({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0,xxxl:!0}),2),T=C[0],E=C[1],O=(0,r.useRef)();function P(t){var e=0;if("object"==typeof t)for(var i=0;i<v.c4.length;i++){var r=v.c4[i];if(T[r]&&void 0!==t[r]){e=t[r];break}}else e=t;return e}(0,r.useEffect)(function(){return O.current=v.ZP.subscribe(function(t){(!Array.isArray(w)&&"object"==typeof w||Array.isArray(w)&&("object"==typeof w[0]||"object"==typeof w[1]))&&E(t)}),function(){v.ZP.unsubscribe(O.current)}},[]);var R=h("row"),B=(0,n.Z)(((i={})[""+R]=!S,i[R+"-align-"+k]=k,i[R+"-justify-"+A]=A,i[R+"-rtl"]=d,i),p),I={},L=P(Array.isArray(w)?w[0]:w),D=P(Array.isArray(w)?w[1]:0);if((L||D)&&!S){var F=-L/2,j=-D/2;F&&(I.marginLeft=F,I.marginRight=F),j&&(I.marginTop=j,I.marginBottom=j)}return r.createElement("div",y({ref:e},(0,m.Z)(M,["gutter"]),{style:y(y({},g),I),className:B}),r.createElement(l.Provider,{value:{gutter:[L,D],div:S}},f))});S.displayName="Row";var k=i("3546"),A=i.n(k),w=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};function M(t){return(0,s.Kn)(t)}var C=function(t,e,i){void 0===i&&(i=!1);var n=(0,r.useRef)(),a=w((0,r.useState)({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0,xxxl:!0}),2),o=a[0],l=a[1];return(0,r.useEffect)(function(){return n.current=v.ZP.subscribe(function(e){var i;if(i=t,(0,s.Kn)(i))l(e)}),function(){v.ZP.unsubscribe(n.current)}},[]),(0,r.useMemo)(function(){var r,n=e;if(r=t,(0,s.Kn)(r))for(var a=0;a<v.c4.length;a++){var l=v.c4[a];if((o[l]||"xs"===l&&i)&&void 0!==t[l]){n=t[l];break}}else n=t;return n},[o,t,e,i])},T=function(){return(T=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},E=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},O=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],r=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},P=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))},R={collapsed:!1,collapsedRows:1,cols:24,colGap:0,rowGap:0},B=(0,r.forwardRef)(function(t,e){var i,s=E((0,r.useState)(new Map),2),l=s[0],d=s[1],c=(0,r.useContext)(a.E),p=c.getPrefixCls,g=c.componentConfig,f=c.rtl,m=(0,o.Z)(t,R,null==g?void 0:g.Grid),v=m.children,y=m.className,_=m.style,b=m.cols,x=m.colGap,S=m.rowGap,k=m.collapsed,w=m.collapsedRows,M=C(b,24),B=C(x,0),I=C(S,0),L=p("grid"),D=((i={})[""+L]=!0,i[L+"-rtl"]=f,i),F=(0,n.Z)(D,y),j=function(t){var e=t.cols,i=t.collapsed,r=t.collapsedRows,n=t.itemDataList,s=!1,a=[];function o(t){return Math.ceil(t/e)>r}if(i){for(var l=0,h=0;h<n.length;h++)n[h].suffix&&(l+=n[h].span,a.push(h));if(!o(l)){for(var u=0;u<n.length;){var d=n[u];if(!d.suffix){if(o(l+=d.span))break;a.push(u)}u++}}s=n.some(function(t,e){return!t.suffix&&!a.includes(e)})}else a=n.map(function(t,e){return e});return{overflow:s,displayIndexList:a}}({cols:M,collapsed:k,collapsedRows:w,itemDataList:function(){var t,e,i=[];try{for(var r=O(l.entries()),n=r.next();!n.done;n=r.next()){var s=E(n.value,2),a=s[0],o=s[1];i[a]=o}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return i}()});return r.createElement("div",{ref:e,className:F,style:T(T({},{gap:I+"px "+B+"px",gridTemplateColumns:"repeat("+M+", minmax(0px, 1fr))"}),_)},r.createElement(u.Provider,{value:{collectItemData:function(t,e){l.set(t,e),d(new Map(P([],E(l),!1)))},removeItemData:function(t){l.delete(t),d(new Map(P([],E(l),!1)))}}},r.createElement(h.Provider,{value:{cols:M,colGap:B,collapsed:k,overflow:j.overflow,displayIndexList:j.displayIndexList}},r.Children.map(v,function(t,e){if(t){var i=T({__index__:e},t.props);return r.cloneElement(t,i)}return null}).filter(function(t){return A()(t,"type.__ARCO_GRID_ITEM__")}))))});B.displayName="Grid";var I=function(){return(I=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},L={suffix:!1,offset:0,span:1},D=(0,r.forwardRef)(function(t,e){var i,l=(0,r.useContext)(a.E),d=l.getPrefixCls,c=l.componentConfig,p=l.rtl,g=(0,o.Z)(t,L,null==c?void 0:c["Grid.GridItem"]),f=g.children,m=g.className,v=g.style,y=g.offset,_=g.span,b=g.__index__,x=(0,r.useContext)(h),S=(0,r.useContext)(u),k=S.collectItemData,A=S.removeItemData,w=x.colGap,M=x.cols,T=x.displayIndexList,E=x.overflow,O=C(y,0),P=C(_,1),R=d("grid-item"),B=null==T?void 0:T.includes(b),D=((i={})[""+R]=!0,i[R+"-rtl"]=p,i),F=(0,n.Z)(D,m),j=(0,r.useMemo)(function(){var t,e,i,r,n,s,a,o;return t=x.cols,i=(e={suffix:!!g.suffix,span:P,offset:O}).span,r=e.offset,n=e.suffix,s=null!=i?i:1,{span:Math.min((o=Math.min(a=null!=r?r:0,t))>0?s+a:s,t),offset:o,suffix:n}},[x.cols,g.suffix,P,O]);(0,r.useEffect)(function(){return k(b,j),function(){A(b)}},[b,j]);var N=(0,r.useMemo)(function(){var t=j.offset,e=j.span;return t>0?{marginLeft:"calc(("+("(100% - "+w*(e-1)+"px) / "+e)+" * "+t+") + "+w*t+"px)"}:{}},[j,w]),z=(0,r.useMemo)(function(){var t=j.suffix,e=j.span;return t?""+(M-e+1):"span "+e},[j,M]),H=B&&0!==P?{}:{display:"none"},V=I(I({gridColumn:z+" / span "+P},N),H);return r.createElement("div",{ref:e,className:F,style:I(I({},V),v)},(0,s.mf)(f)?f({overflow:E}):r.Children.map(f,function(t){return t&&x.collapsed&&r.isValidElement(t)&&!(0,s.HD)(t.type)?r.cloneElement(t,I({overflow:E},t.props)):t}))});D.displayName="GridItem",D.__ARCO_GRID_ITEM__=!0;B.Col=f,B.Row=S,B.GridItem=D;let F=B},4057:function(t,e,i){"use strict";i("4290")},8905:function(t,e,i){"use strict";i.d(e,{Z:()=>A});var r=i("4194"),n=i("3546"),s=i.n(n),a=i("2315"),o=i("7226"),l=i("8429"),h=function(){return(h=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},u=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},d=(0,r.forwardRef)(function(t,e){var i=(0,r.useContext)(l.E).getPrefixCls,n=t.className,s=t.children,o=u(t,["className","children"]),d=i("layout-header"),c=(0,a.Z)(d,n);return r.createElement("header",h({ref:e},o,{className:c}),s)});d.displayName="LayoutHeader";var c=function(){return(c=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},p=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},g=(0,r.forwardRef)(function(t,e){var i=t.className,n=t.children,s=p(t,["className","children"]),o=(0,(0,r.useContext)(l.E).getPrefixCls)("layout-footer"),h=(0,a.Z)(o,i);return r.createElement("footer",c({ref:e},s,{className:h}),n)});g.displayName="LayoutFooter";var f=function(){return(f=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},m=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},v=(0,r.forwardRef)(function(t,e){var i=t.className,n=t.children,s=m(t,["className","children"]),o=(0,(0,r.useContext)(l.E).getPrefixCls)("layout-content"),h=(0,a.Z)(o,i);return r.createElement("main",f({ref:e},s,{className:h}),n)});v.displayName="LayoutContent";var y=i("2888"),_=function(){return(_=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},b=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},x=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},S=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))},k=(0,r.forwardRef)(function(t,e){var i,n=(0,r.useContext)(l.E),o=n.getPrefixCls,h=n.componentConfig,u=(0,y.Z)(t,{},null==h?void 0:h.Layout),d=u.className,c=u.hasSider,p=u.children,g=b(u,["className","hasSider","children"]),f=x((0,r.useState)([]),2),m=f[0],v=f[1],k=o("layout"),A=(0,a.Z)(k,((i={})[k+"-has-sider"]="boolean"==typeof c?c:m.length>0,i),d);return r.createElement("section",_({ref:e},g,{className:A}),r.Children.map(p,function(t){var e=s()(t,"type.__ARCO_SIGN__")||s()(t,"props.sign");return t&&"sider"===e?r.cloneElement(t,{onSiderMount:function(t){return v(S(S([],x(m),!1),[t],!1))},onSiderUnmount:function(t){return v(m.filter(function(e){return e!==t}))}}):t}))});k.displayName="Layout",k.Sider=o.Z,k.Header=d,k.Footer=g,k.Content=v;let A=k},7226:function(t,e,i){"use strict";i.d(e,{D:()=>tu,Z:()=>tp});var r,n=i("4194"),s=i("2315"),a=i("4151"),o=i("6464"),l=i("8429"),h=i("4672"),u=i("6132"),d=i("263"),c=i("9933"),p=i("8336"),g=i("5296");function f(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function m(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?f(Object(i),!0).forEach(function(e){(0,p.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var v=n.forwardRef(function(t,e){var i=(0,n.useContext)(g.P).prefixCls,r=void 0===i?"arco":i,s=t.spin,a=t.className,o=m(m({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(a?a+" ":"").concat(r,"-icon ").concat(r,"-icon-drag-dot-vertical")});return s&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,n.createElement("svg",(0,c.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),n.createElement("path",{fill:"currentColor",stroke:"none",d:"M17 8h2v2h-2V8ZM17 23h2v2h-2v-2ZM17 38h2v2h-2v-2ZM29 8h2v2h-2V8ZM29 23h2v2h-2v-2ZM29 38h2v2h-2v-2Z"}),n.createElement("path",{d:"M17 8h2v2h-2V8ZM17 23h2v2h-2v-2ZM17 38h2v2h-2v-2ZM29 8h2v2h-2V8ZM29 23h2v2h-2v-2ZM29 38h2v2h-2v-2Z"}))});v.defaultProps={isIcon:!0},v.displayName="IconDragDotVertical";function y(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function _(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?y(Object(i),!0).forEach(function(e){(0,p.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var b=n.forwardRef(function(t,e){var i=(0,n.useContext)(g.P).prefixCls,r=void 0===i?"arco":i,s=t.spin,a=t.className,o=_(_({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(a?a+" ":"").concat(r,"-icon ").concat(r,"-icon-drag-dot")});return s&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,n.createElement("svg",(0,c.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),n.createElement("path",{fill:"currentColor",stroke:"none",d:"M40 17v2h-2v-2h2ZM25 17v2h-2v-2h2ZM10 17v2H8v-2h2ZM40 29v2h-2v-2h2ZM25 29v2h-2v-2h2ZM10 29v2H8v-2h2Z"}),n.createElement("path",{d:"M40 17v2h-2v-2h2ZM25 17v2h-2v-2h2ZM10 17v2H8v-2h2ZM40 29v2h-2v-2h2ZM25 29v2h-2v-2h2ZM10 29v2H8v-2h2Z"}))});b.defaultProps={isIcon:!0},b.displayName="IconDragDot";function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function S(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach(function(e){(0,p.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var k=n.forwardRef(function(t,e){var i=(0,n.useContext)(g.P).prefixCls,r=void 0===i?"arco":i,s=t.spin,a=t.className,o=S(S({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(a?a+" ":"").concat(r,"-icon ").concat(r,"-icon-caret-right")});return s&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,n.createElement("svg",(0,c.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),n.createElement("path",{fill:"currentColor",stroke:"none",d:"M34.829 23.063c.6.48.6 1.394 0 1.874L17.949 38.44c-.785.629-1.949.07-1.949-.937V10.497c0-1.007 1.164-1.566 1.95-.937l16.879 13.503Z"}))});k.defaultProps={isIcon:!0},k.displayName="IconCaretRight";function A(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function w(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?A(Object(i),!0).forEach(function(e){(0,p.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):A(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var M=n.forwardRef(function(t,e){var i=(0,n.useContext)(g.P).prefixCls,r=void 0===i?"arco":i,s=t.spin,a=t.className,o=w(w({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(a?a+" ":"").concat(r,"-icon ").concat(r,"-icon-caret-left")});return s&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,n.createElement("svg",(0,c.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),n.createElement("path",{fill:"currentColor",stroke:"none",d:"M13.171 24.937a1.2 1.2 0 0 1 0-1.874L30.051 9.56c.785-.629 1.949-.07 1.949.937v27.006c0 1.006-1.164 1.566-1.95.937L13.171 24.937Z"}))});M.defaultProps={isIcon:!0},M.displayName="IconCaretLeft";function C(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function T(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?C(Object(i),!0).forEach(function(e){(0,p.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var E=n.forwardRef(function(t,e){var i=(0,n.useContext)(g.P).prefixCls,r=void 0===i?"arco":i,s=t.spin,a=t.className,o=T(T({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(a?a+" ":"").concat(r,"-icon ").concat(r,"-icon-caret-down")});return s&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,n.createElement("svg",(0,c.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),n.createElement("path",{fill:"currentColor",stroke:"none",d:"M24.938 34.829a1.2 1.2 0 0 1-1.875 0L9.56 17.949c-.628-.785-.069-1.949.937-1.949h27.007c1.006 0 1.565 1.164.937 1.95L24.937 34.829Z"}))});E.defaultProps={isIcon:!0},E.displayName="IconCaretDown";function O(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function P(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?O(Object(i),!0).forEach(function(e){(0,p.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):O(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var R=n.forwardRef(function(t,e){var i=(0,n.useContext)(g.P).prefixCls,r=void 0===i?"arco":i,s=t.spin,a=t.className,o=P(P({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(a?a+" ":"").concat(r,"-icon ").concat(r,"-icon-caret-up")});return s&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,n.createElement("svg",(0,c.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),n.createElement("path",{fill:"currentColor",stroke:"none",d:"M23.063 13.171a1.2 1.2 0 0 1 1.875 0l13.503 16.88c.628.785.069 1.949-.937 1.949H10.497c-1.006 0-1.565-1.164-.937-1.95l13.503-16.879Z"}))});R.defaultProps={isIcon:!0},R.displayName="IconCaretUp";var B=i("9743"),I=function(){return(I=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},L=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i};function D(t){var e,i,r=t.className,a=t.direction,o=t.icon,u=t.onMouseDown,c=t.onResize,p=t.children,g=t.collapsible,f=void 0===g?{}:g,m=t.resizable,y=void 0===m||m,_=t.renderChildren,x=L(t,["className","direction","icon","onMouseDown","onResize","children","collapsible","resizable","renderChildren"]),S=(0,n.useContext)(l.E),A=S.getPrefixCls,w=S.rtl,C=A("resizebox-trigger"),T="horizontal"===a,O=w&&!T,P=(0,s.Z)(C,C+"-"+(T?"horizontal":"vertical"),((e={})[C+"-not-resizable"]=!y,e),((i={})[C+"-rtl"]=w,i),r),D=(0,n.useRef)(),F=O?[n.createElement(k,{key:"prev"}),n.createElement(M,{key:"next"})]:[n.createElement(M,{key:"prev"}),n.createElement(k,{key:"next"})],j=(0,B.Kn)(f.prev)?I(I({},f.prev),{icon:f.prev.icon||(T?n.createElement(R,null):F[0])}):{},N=(0,B.Kn)(f.next)?I(I({},f.next),{icon:f.next.icon||(T?n.createElement(E,null):F[1])}):{},z=j.icon&&!j.collapsed||N.collapsed?n.createElement("span",{className:(0,s.Z)(C+"-icon",(0,s.Z)(C+"-prev")),onClick:j.onClick},j.icon):n.createElement("span",{className:(0,s.Z)(C+"-icon-empty")}),H=y?n.createElement("span",{className:C+"-icon"},o||(T?n.createElement(b,null):n.createElement(v,null))):n.createElement("span",{className:(0,s.Z)(C+"-icon-empty")}),V=N.icon&&!N.collapsed||j.collapsed?n.createElement("span",{className:(0,s.Z)(C+"-icon",(0,s.Z)(C+"-next")),onClick:N.onClick},N.icon):n.createElement("span",{className:(0,s.Z)(C+"-icon-empty")}),W=function(){return n.createElement("div",{className:C+"-icon-wrapper"},z,H,V)};return y?n.createElement(d.Z,{onResize:c,getTargetDOMNode:function(){return D.current}},n.createElement("div",I({ref:D},(0,h.Z)(x,["style"]),{className:P,onMouseDown:u}),(0,B.mf)(_)?_(z,H,V):p||W())):n.createElement("div",{className:P},(0,B.mf)(_)?_(z,H,V):p||W())}var F=i("4308"),j=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},N="horizontal",z="vertical",H=(0,n.forwardRef)(function(t,e){var i,r,a=t.style,o=t.className,h=t.component,d=t.direction,c=void 0===d?"horizontal":d,p=t.icon,g=t.size,f=void 0===g?.5:g,m=t.min,v=t.max,y=t.panes,_=t.disabled,b=t.trigger,x=(0,n.useContext)(l.E),S=x.getPrefixCls,k=x.rtl,A=S("resizebox-split"),w=c.includes(N),M=c.includes("reverse"),C=w&&k,T=!w,E=(0,s.Z)(A,A+"-"+(w?N:z),((r={})[A+"-rtl"]=k,r),o),O=j(y,2),P=O[0],R=O[1],B="string"==typeof f,I=j((0,n.useState)(parseFloat(f)),2),L=I[0],H=I[1],V=j((0,n.useState)(0),2),W=V[0],G=V[1],U=(0,n.useRef)({startX:0,startY:0,startWidth:0,startHeight:0,startOffset:0,moving:!1}),$=(0,n.useRef)(),Y=(0,n.useRef)([]);function K(t,e){return parseFloat(t)/parseFloat(e)}function Z(t,e,i,r){var n="string"==typeof m?K(parseFloat(m),t):m||0,s="string"==typeof v?K(parseFloat(v),t):v||1,a=M?-1:1;a*=C?-1:1;var o=B?e+(r-i)*a:K(t*e+(r-i)*a,t),l=B?n*t:n,h=B?s*t:s;return o=Math.min(o=Math.max(o,l),h)}(0,n.useImperativeHandle)(e,function(){return $.current},[]);function X(e){if(U.current.moving){var i=w?Z(U.current.startWidth,U.current.startOffset,U.current.startX,e.pageX):Z(U.current.startHeight,U.current.startOffset,U.current.startY,e.pageY);H(i),t.onMoving&&t.onMoving(e,B?i+"px":i)}}function q(){U.current.moving=!1,(0,u.S1)(window,"mousemove",X),(0,u.S1)(window,"touchmove",X),(0,u.S1)(window,"mouseup",q),(0,u.S1)(window,"touchend",q),(0,u.S1)(window,"contextmenu",q),document.body.style.cursor="default",t.onMovingEnd&&t.onMovingEnd()}(0,n.useEffect)(function(){t.onPaneResize&&t.onPaneResize(Y.current)},[L,W]),(0,F.Z)(function(){var t=parseFloat(f);L!==t&&H(t)},[f]);var J=n.createElement("div",{className:(0,s.Z)(A+"-pane","first-pane"),style:{flexBasis:(i=B?"px":"%",L?"calc("+(B?L:100*L)+i+" - "+W/2+"px)":"0"+i)},ref:function(t){Y.current[0]=t}},P),Q=n.createElement("div",{className:(0,s.Z)(A+"-pane","second-pane"),ref:function(t){Y.current[1]=t}},R),tt=M?[Q,J]:[J,Q];return n.createElement(void 0===h?"div":h,{style:a,className:E,ref:$},tt[0],!_&&n.createElement(D,{className:A+"-trigger",direction:T?N:z,icon:p,onMouseDown:function(e){var i,r;t.onMovingStart&&t.onMovingStart(),U.current.moving=!0,U.current.startX=e.pageX,U.current.startY=e.pageY,U.current.startWidth=null===(i=$.current)||void 0===i?void 0:i.offsetWidth,U.current.startHeight=null===(r=$.current)||void 0===r?void 0:r.offsetHeight,U.current.startOffset=L,(0,u.on)(window,"mousemove",X),(0,u.on)(window,"touchmove",X),(0,u.on)(window,"mouseup",q),(0,u.on)(window,"touchend",q),(0,u.on)(window,"contextmenu",q),document.body.style.cursor=T?"row-resize":"col-resize"},onResize:function(t){G(t[0].contentRect[T?"height":"width"])}},b),tt[1])});H.displayName="ResizeBoxSplit";var V=i("3779"),W=i("2888"),G=function(){return(G=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},U=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},$=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},Y=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))},K="horizontal",Z="vertical",X=(0,n.forwardRef)(function(t,e){var i,r,a=t.panes,o=t.style,d=t.className,c=t.component,p=t.direction,g=t.icon,f=U(t,["panes","style","className","component","direction","icon"]),m=(0,n.useContext)(l.E),v=m.getPrefixCls,y=m.rtl,_=1/a.length,b=(0,n.useRef)(),x=(0,n.useRef)(Array(a.length).fill({moving:!1,startOffset:0,startPosition:0})),S=(0,n.useRef)([]),k=(0,n.useRef)(0),A=(0,n.useRef)([]),w=$((0,n.useState)(Array(a.length).fill(_)),2),M=w[0],C=w[1],T=$((0,n.useState)(!1),2),E=T[0],O=T[1],P=$((0,n.useState)(Array(a.length).fill(0)),2),R=P[0],I=P[1],L=$((0,n.useState)(Array(Math.max(a.length-1,0)).fill({prev:!1,next:!1})),2),F=L[0],j=L[1],N=v("resizebox-split-group"),z=(void 0===p?"horizontal":p)===K,H=z&&y,V=!z,W=(0,s.Z)(N,N+"-"+(z?K:Z),((i={})[N+"-moving"]=E,i),((r={})[N+"-rtl"]=y,r),d),X=function(){var t=[];a.forEach(function(e){var i=e.size;(0,B.o8)(i)?t.push(void 0):t.push(J(i))});var e=t.filter(function(t){return!t}),i=(1-t.reduce(function(t,e){return(t||0)+(e||0)},0))/e.length;return t=t.map(function(t){return(0,B.o8)(t)?i:t})},q=function(t){var e=R[t-1]||0,i=R[t],r=100*M[t];return"calc("+r+"% - "+(e+i)/2+"px)"};function J(t){var e=z?b.current.offsetWidth:b.current.offsetHeight;return!t||(0,B.hj)(t)&&t<0?0:Math.min((0,B.HD)(t)?parseFloat(t)/e:t,1)}var Q=function(t){var e=Math.min(t+1,a.length-1),i=M[t]+M[e],r=J(a[t].min)||0,n=J(a[t].max)||i,s=J(a[e].min)||0,o=J(a[e].max)||i;return n=Math.min(i-s,n),o=Math.min(i-r,o),{currentMin:r,currentMax:n,nextMin:s,nextMax:o}},tt=function(t,e,i){var r=k.current,n=r+1,s=Y([],$(M),!1),a=M[r],o=M[n],l=Q(r),h=l.currentMin,u=l.currentMax,d=t+J((i-e)*(H?-1:1)+"px");return d=Math.min(u,d=Math.max(h,d)),s[r]=d,s[n]=a+o-d,s},te=function(t){var e=a[t].collapsible;!(0,B.Kn)(e)&&(e=e?{prev:!0,next:!0}:{});var i=e.prev,r=e.next;return(i||r)&&F[t]?{hasPrev:!!i||!i&&F[t].next,hasNext:!!r||!r&&F[t].prev}:{}};function ti(e){var i=k.current,r=x.current[i],n=z?b.current.offsetWidth:b.current.offsetHeight;if(r.moving){var s=tt(r.startOffset,r.startPosition,z?e.pageX:e.pageY);C(s),A.current=s,t.onMoving&&t.onMoving(e,s.map(function(t){return t*n+"px"}),i)}}function tr(){var e=k.current;x.current[e].moving=!1,O(!1),(0,u.S1)(window,"mousemove",ti),(0,u.S1)(window,"touchmove",ti),(0,u.S1)(window,"mouseup",tr),(0,u.S1)(window,"touchend",tr),(0,u.S1)(window,"contextmenu",tr),document.body.style.cursor="default",t.onMovingEnd&&t.onMovingEnd(e)}function tn(e,i,r,n){var s=i+1,a=Y([],$(M),!1),o=M[i],l=M[s],h=o+l,u=z?b.current.offsetWidth:b.current.offsetHeight,d=Q(i),c=d.currentMin,p=d.nextMin,g=A.current[i],f=A.current[s],m=F[i][r];"prev"===r?(l!==p||f===p)&&(g=c,f=h-c,m=!0):(o!==c||g===c)&&(g=h-p,f=p,m=!0),a[i]=g,a[s]=f,t.onMoving&&t.onMoving(e,a.map(function(t){return t*u+"px"}),i),t.onMovingEnd&&t.onMovingEnd(i),C(a),(0,B.mf)(n)&&n(e,i,r,m)}return(0,n.useEffect)(function(){var t=X();C(t),A.current=t},[JSON.stringify(a.map(function(t){return t.size}))]),(0,n.useImperativeHandle)(e,function(){return b.current},[]),(0,n.useEffect)(function(){var t=[];M.forEach(function(e,i){var r={prev:!1,next:!1},n=i+1,s=Q(i),a=s.currentMin,o=s.nextMin;e===a?r.prev=!0:M[n]===o&&(r.next=!0),t.push(r)}),j(t)},[M]),n.createElement(void 0===c?"div":c,G({},(0,h.Z)(f,["onMovingStart","onPaneResize","onMoving","onMovingEnd"]),{style:o,className:W,ref:b}),a.map(function(e,i){var r=e.content,s=e.disabled,o=e.trigger,l=e.resizable,h=e.collapsible,d=void 0===h?{}:h,c=te(i),p=c.hasPrev,f=c.hasNext,m=(0,B.Kn)(d)&&(0,B.Kn)(d.prev)?d.prev:{},v=(0,B.Kn)(d)&&(0,B.Kn)(d.next)?d.next:{};return n.createElement(n.Fragment,{key:i},n.createElement("div",{className:N+"-pane",style:{flexBasis:q(i)},ref:function(t){return S.current[i]=t}},r),!s&&i!==a.length-1&&n.createElement(D,{className:N+"-trigger",direction:V?K:Z,icon:g,onResize:function(t){var e,r,n,s;return e=t,r=i,n=e[0].contentRect[V?"height":"width"],void((s=Y([],$(R),!1))[r]=n,I(s))},onMouseDown:function(e){var r,n,s;return r=e,n=i,t.onMovingStart&&t.onMovingStart(n),k.current=n,void((s=x.current[n]).moving=!0,s.startOffset=M[n],s.startPosition=z?r.pageX:r.pageY,O(!0),(0,u.on)(window,"mousemove",ti),(0,u.on)(window,"touchmove",ti),(0,u.on)(window,"mouseup",tr),(0,u.on)(window,"touchend",tr),(0,u.on)(window,"contextmenu",tr),document.body.style.cursor=V?"row-resize":"col-resize")},collapsible:{prev:p?{onClick:function(t){return tn(t,i,"prev",m.onClick)},icon:m.icon,collapsed:F[i].prev}:void 0,next:f?{onClick:function(t){return tn(t,i,"next",v.onClick)},icon:v.icon,collapsed:F[i].next}:void 0},resizable:void 0===l||l,renderChildren:o}))}))});X.displayName="ResizeBoxSplitGroup";var q=function(){return(q=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},J=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},Q=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},tt="left",te="right",ti="bottom",tr=[tt,te,"top",ti],tn={component:"div",directions:["right"],resizeIcons:{},resizeTriggers:{}},ts=function(t){switch(t){case"left":return"right";case"right":return"left";default:return t}},ta=(0,n.forwardRef)(function(t,e){var i,r=(0,n.useContext)(l.E),a=r.getPrefixCls,o=r.componentConfig,d=r.rtl,c=(0,W.Z)(t,tn,null==o?void 0:o.ResizeBox),p=c.style,g=c.className,f=c.component,m=c.directions,v=c.resizeIcons,y=c.children,_=c.resizeTriggers,b=c.width,x=c.height,S=J(c,["style","className","component","directions","resizeIcons","children","resizeTriggers","width","height"]),k=d?m.map(function(t){return ts(t)}):m,A=a("resizebox"),w=(0,s.Z)(A,((i={})[A+"-rtl"]=d,i),g),M=Q((0,n.useState)({}),2),C=M[0],T=M[1],E=Q((0,V.Z)(void 0,{value:b}),2),O=E[0],P=E[1],R=Q((0,V.Z)(void 0,{value:x}),2),I=R[0],L=R[1],F=(0,n.useRef)({startX:0,startY:0,startWidth:0,startHeight:0,direction:te,moving:!1,padding:{top:0,bottom:0,left:0,right:0}}),j=(0,n.useRef)();function N(t){return["top",ti].indexOf(t)>-1}function z(t,e){if(0===t)return 0;var i=t-e;return i<=0?0:i}function H(t){var e="data-arco-origin-cursor";if(t)document.body.setAttribute(e,document.body.style.cursor),document.body.style.cursor=t;else{var i=document.body.getAttribute(e);document.body.style.cursor=i||"",document.body.removeAttribute(e)}}(0,n.useImperativeHandle)(e,function(){return j.current},[]);function G(t){if(!F.current.moving)return!1;var e=F.current,i=e.startX,r=e.startY,n=e.startWidth,s=e.startHeight,a=n,o=s,l=t.pageX-i,h=t.pageY-r;switch(F.current.direction){case tt:P(a=n-l);break;case te:P(a=n+l);break;case"top":L(o=s-h);break;case ti:L(o=s+h)}c.onMoving&&c.onMoving(t,{width:a,height:o})}function U(){F.current.moving=!1,function(){(0,u.S1)(window,"mousemove",G),(0,u.S1)(window,"touchmove",G),(0,u.S1)(window,"mouseup",U),(0,u.S1)(window,"touchend",U),(0,u.S1)(window,"contextmenu",U)}(),H(),c.onMovingEnd&&c.onMovingEnd()}var $=q(q(q(q({},C),p||{}),(0,B.hj)(O)?{width:O}:{}),(0,B.hj)(I)?{height:I}:{});return n.createElement(f,q({},(0,h.Z)(S,["onMovingStart","onMoving","onMovingEnd"]),{style:$,className:w,ref:j}),y,k.map(function(t){if(-1!==tr.indexOf(t))return n.createElement(D,{key:t,className:A+"-direction-"+t,direction:N(t)?"horizontal":"vertical",icon:v[t],onMouseDown:function(e){var i,r,n,s,a,o,l,h,d;i=t,r=e,c.onMovingStart&&c.onMovingStart(),F.current.moving=!0,F.current.startX=r.pageX,F.current.startY=r.pageY,F.current.direction=i,o=(a=F.current.padding).top,l=a.left,h=a.right,d=a.bottom,F.current.startWidth=z(null===(n=j.current)||void 0===n?void 0:n.clientWidth,l+h),F.current.startHeight=z(null===(s=j.current)||void 0===s?void 0:s.clientHeight,o+d),(0,u.on)(window,"mousemove",G),(0,u.on)(window,"touchmove",G),(0,u.on)(window,"mouseup",U),(0,u.on)(window,"touchend",U),(0,u.on)(window,"contextmenu",U),H(N(i)?"row-resize":"col-resize")},onResize:function(e){var i,r,n,s,a,o;i=t,r=e,n=N(i),s=r[0].contentRect,a=""+i.slice(0,1).toUpperCase()+i.slice(1),o=s[n?"height":"width"],F.current.padding[i]=o,T(function(t){var e;return q(q({},t),((e={})["padding"+a]=o,e))})}},_[t])}))});ta.Split=H,ta.SplitGroup=X,ta.displayName="ResizeBox";var to=i("3095"),tl=function(){return(tl=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},th=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},tu=(0,n.createContext)({siderCollapsed:!1,collapsedWidth:64});var td=(r=0,function(t){return void 0===t&&(t=""),""+t+(r+=1)}),tc=(0,n.forwardRef)(function(t,e){var i,r,h,u,d=t.children,c=t.className,p=t.style,g=t.theme,f=void 0===g?"light":g,m=t.trigger,v=t.reverseArrow,y=t.collapsedWidth,_=void 0===y?48:y,b=t.width,x=void 0===b?200:b,S=t.collapsible,k=t.resizeDirections,A=t.onSiderMount,w=t.onSiderUnmount,M=t.breakpoint,C=t.onBreakpoint,T=t.onCollapse,E=t.resizeBoxProps,O=void 0===E?{}:E,P=td("arco-sider-"),R=(0,(0,n.useContext)(l.E).getPrefixCls)("layout-sider"),I=th((0,V.Z)(!1,{value:"collapsed"in t?t.collapsed:void 0,defaultValue:t.defaultCollapsed}),2),L=I[0],D=I[1],F=(0,B.hj)(x)?x+"px":String(x),j=(0,B.hj)(_)?""+_:String(_),N=th((0,n.useState)(L?j:F),2),z=N[0],H=N[1],W=(0,n.useRef)(null),G=(0,n.useRef)(null);G.current={breakpoint:M,collapsed:L,onCollapse:T,onBreakpoint:C},(0,n.useEffect)(function(){return A&&A(P),S&&M in to.f&&(W.current=to.ZP.subscribe(function(t,e){var i=G.current,r=i.breakpoint,n=i.collapsed,s=i.onCollapse,a=i.onBreakpoint;if(!e||e===r){var o=!t[r];o!==n&&(D(o),s&&s(o,"responsive")),a&&a(o)}})),function(){w&&w(P),W.current&&to.ZP.unsubscribe(W.current)}},[]),(0,n.useEffect)(function(){var t=(0,B.hj)(_)?_+"px":String(_);H(L?t:F)},[L,F,_]);var U=k&&(0,B.kJ)(k)||(null===(u=O.directions)||void 0===u?void 0:u.length),$=U?ta:"aside",Y=(0,n.useMemo)(function(){return U?tl(tl({component:"aside"},O),{width:z,directions:k,onMoving:function(t,e){var i;H(e.width+"px"),null===(i=null==O?void 0:O.onMoving)||void 0===i||i.call(O,t,e)}}):{}},[U,k,z,O]);return n.createElement(tu.Provider,{value:{siderCollapsed:L,collapsedWidth:_}},n.createElement($,tl({ref:e,style:tl({width:z},p),className:(0,s.Z)(R,((h={})[R+"-light"]="light"===f,h[R+"-has-trigger"]=null!==m&&S,h[R+"-collapsed"]=L,h),c)},Y),n.createElement("div",{className:R+"-children"},d),(r=m||(L?v?n.createElement(a.Z,null):n.createElement(o.Z,null):v?n.createElement(o.Z,null):n.createElement(a.Z,null)),S&&null!==m?n.createElement("div",{style:{width:z},className:(0,s.Z)(R+"-trigger",((i={})[R+"-trigger-light"]="light"===f,i)),onClick:function(){D(!L),T&&T(!L,"clickTrigger")}},r):null)))});tc.displayName="LayoutSider",tc.__ARCO_SIGN__="sider";let tp=tc},1462:function(t,e,i){"use strict";i("4290")},7147:function(t,e,i){"use strict";i.d(e,{Z:()=>y});var r=i("4194"),n=i("9933"),s=i("8336"),a=i("5296");function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){(0,s.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var h=r.forwardRef(function(t,e){var i=(0,r.useContext)(a.P).prefixCls,s=void 0===i?"arco":i,o=t.spin,h=t.className,u=l(l({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(h?h+" ":"").concat(s,"-icon ").concat(s,"-icon-link")});return o&&(u.className="".concat(u.className," ").concat(s,"-icon-loading")),delete u.spin,delete u.isIcon,r.createElement("svg",(0,n.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},u),r.createElement("path",{d:"m14.1 25.414-4.95 4.95a6 6 0 0 0 8.486 8.485l8.485-8.485a6 6 0 0 0 0-8.485m7.779.707 4.95-4.95a6 6 0 1 0-8.486-8.485l-8.485 8.485a6 6 0 0 0 0 8.485"}))});h.defaultProps={isIcon:!0},h.displayName="IconLink";var u=i("2315"),d=i("8429"),c=i("2888"),p=i("8569"),g=function(){return(g=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},f=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},m={hoverable:!0},v=(0,r.forwardRef)(function(t,e){var i,n=(0,r.useContext)(d.E),s=n.getPrefixCls,a=n.componentConfig,o=n.rtl,l=(0,c.Z)(t,m,null==a?void 0:a.Link),v=l.className,y=l.style,_=l.children,b=l.icon,x=l.status,S=l.disabled,k=l.hoverable,A=f(l,["className","style","children","icon","status","disabled","hoverable"]),w=(0,p.Z)({onKeyDown:l.onKeyDown}),M=s("link"),C="href"in l?"a":"span",T=function(t){S?(t.preventDefault(),t.stopPropagation()):l.onClick&&l.onClick(t)};return r.createElement(C,g({className:(0,u.Z)(M,((i={})[M+"-disabled"]=S,i[M+"-is-"+x]=x,i[M+"-with-icon"]=b,i[M+"-hoverless"]=!k,i[M+"-rtl"]=o,i),v),ref:e,tabIndex:S?-1:void 0},A,{style:y,onClick:T},w({onPressEnter:T})),b?r.createElement("span",{className:M+"-icon"},!0===b?r.createElement(h,null):b):null,_)});v.displayName="Link";let y=v},8119:function(t,e,i){"use strict";i("4290")},7287:function(t,e,i){"use strict";i.d(e,{Z:()=>tP});var r=i("4194"),n=i("2315");function s(t){return null!=t&&"object"==typeof t&&1===t.nodeType}function a(t,e){return(!e||"hidden"!==t)&&"visible"!==t&&"clip"!==t}function o(t,e){if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){var i=getComputedStyle(t,null);return a(i.overflowY,e)||a(i.overflowX,e)}return!1}function l(t,e,i,r,n,s,a,o){return s<t&&a>e||s>t&&a<e?0:s<=t&&o<=i||a>=e&&o>=i?s-t-r:a>e&&o<i||s<t&&o>i?a-e+n:0}let h=function(t,e){var i=e.scrollMode,r=e.block,n=e.inline,a=e.boundary,h=e.skipOverflowHiddenElements,u="function"==typeof a?a:function(t){return t!==a};if(!s(t))throw TypeError("Invalid target");for(var d=document.scrollingElement||document.documentElement,c=[],p=t;s(p)&&u(p);){if((p=p.parentNode)===d){c.push(p);break}if(!(p===document.body&&o(p))||!!o(document.documentElement))o(p,h)&&c.push(p)}for(var g=window.visualViewport?visualViewport.width:innerWidth,f=window.visualViewport?visualViewport.height:innerHeight,m=window.scrollX||pageXOffset,v=window.scrollY||pageYOffset,y=t.getBoundingClientRect(),_=y.height,b=y.width,x=y.top,S=y.right,k=y.bottom,A=y.left,w="start"===r||"nearest"===r?x:"end"===r?k:x+_/2,M="center"===n?A+b/2:"end"===n?S:A,C=[],T=0;T<c.length;T++){var E=c[T],O=E.getBoundingClientRect(),P=O.height,R=O.width,B=O.top,I=O.right,L=O.bottom,D=O.left;if("if-needed"===i&&x>=0&&A>=0&&k<=f&&S<=g&&x>=B&&k<=L&&A>=D&&S<=I)break;var F=getComputedStyle(E),j=parseInt(F.borderLeftWidth,10),N=parseInt(F.borderTopWidth,10),z=parseInt(F.borderRightWidth,10),H=parseInt(F.borderBottomWidth,10),V=0,W=0,G="offsetWidth"in E?E.offsetWidth-E.clientWidth-j-z:0,U="offsetHeight"in E?E.offsetHeight-E.clientHeight-N-H:0;if(d===E)V="start"===r?w:"end"===r?w-f:"nearest"===r?l(v,v+f,f,N,H,v+w,v+w+_,_):w-f/2,W="start"===n?M:"center"===n?M-g/2:"end"===n?M-g:l(m,m+g,g,j,z,m+M,m+M+b,b),V=Math.max(0,V+v),W=Math.max(0,W+m);else{V="start"===r?w-B-N:"end"===r?w-L+H+U:"nearest"===r?l(B,L,P,N,H+U,w,w+_,_):w-(B+P/2)+U/2,W="start"===n?M-D-j:"center"===n?M-(D+R/2)+G/2:"end"===n?M-I+z+G:l(D,I,R,j,z+G,M,M+b,b);var $=E.scrollLeft,Y=E.scrollTop;V=Math.max(0,Math.min(Y+V,E.scrollHeight-P+U)),W=Math.max(0,Math.min($+W,E.scrollWidth-R+G)),w+=Y-V,M+=$-W}C.push({el:E,top:V,left:W})}return C};function u(t){return t===Object(t)&&0!==Object.keys(t).length}let d=function(t,e){var i,r=!t.ownerDocument.documentElement.contains(t);if(u(e)&&"function"==typeof e.behavior)return e.behavior(r?[]:h(t,e));if(!r){var n=!1===(i=e)?{block:"end",inline:"nearest"}:u(i)?i:{block:"start",inline:"nearest"};return function(t,e){void 0===e&&(e="auto");var i="scrollBehavior"in document.body.style;t.forEach(function(t){var r=t.el,n=t.top,s=t.left;r.scroll&&i?r.scroll({top:n,left:s,behavior:e}):(r.scrollTop=n,r.scrollLeft=s)})}(h(t,n),n.behavior)}};var c=i("9542"),p=i("992"),g=(0,r.createContext)({}),f=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},m=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))};function v(t){var e=t.prefixCls,i=t.levelIndent,n=(0,r.useContext)(g).collapse,s=t.level-1;return!n&&s>0?r.createElement("span",null,m([],f(Array(s)),!1).map(function(t,n){return r.createElement("span",{key:n,className:e+"-indent",style:{width:i}})})):null}var y=i("4672"),_=function(){return(_=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},b=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},x=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))},S=["popup","triggerProps","selectable"],k=function(t){var e=[];return r.Children.forEach(t,function(t){var i,r=null===(i=null==t?void 0:t.type)||void 0===i?void 0:i.menuType;"MenuItem"===r||"SubMenu"===r?e.push(t):"MenuGroup"===r&&(e=e.concat(k(t.props.children)))}),e},A=function(t,e,i){void 0===e&&(e=[]),void 0===i&&(i={});var r=k(t);return r.forEach(function(t,n){var s,a,o,l=t.key,h=t.type.menuType,u=x([l],b(e),!1),d={keyPath:[],prev:(null===(a=r[n-1])||void 0===a?void 0:a.key)||null,next:(null===(o=r[n+1])||void 0===o?void 0:o.key)||null};if(0===n||n===r.length-1){var c=u[1];c&&(i[c]=_(_({},i[c]),((s={})[0===n?"firstChild":"lastChild"]=l,s)))}switch(h){case"SubMenu":d.keyPath=u,A(t.props.children,u,i);break;case"MenuItem":d.keyPath=u,d.disabled=t.props.disabled}i[l]=_(_({},i[l]),d)}),i},w=function(t,e){return r.Children.map(t,function(t,i){if(!t||!t.props)return t;var n="string"==typeof t.type;if(!(t.type&&t.type.menuType)&&t.props.children){var s=n?{}:e,a=w(t.props.children,e);return r.cloneElement(t,_(_({},s),{_key:t.key,children:1===a.length?a[0]:a}))}return n?t:r.cloneElement(t,_(_(_({},e),t.props),{_key:t.key||"$menu-"+i}))})};function M(t,e){var i=!1;return!function t(n){if(!!n&&!i)r.Children.forEach(n,function(r){if(r&&r.props&&r.type&&!i){var n=r.type.menuType,s=r.props.selectable;"MenuItem"===n?i=-1!==e.indexOf(r.key):"SubMenu"===n&&s&&(i=-1!==e.indexOf(r.key)),!i&&r.props.children&&t(r.props.children)}})}(t),i}var C=i("8564"),T=function(){return(T=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},E=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},O=(0,r.forwardRef)(function(t,e){var i,s=t._key,a=t.children,o=t.level,l=t.disabled,h=t.className,u=t.style,f=t.wrapper,m=t.onClick,_=t.renderItemInTooltip,b=E(t,["_key","children","level","disabled","className","style","wrapper","onClick","renderItemInTooltip"]),x=(0,r.useContext)(g),k=x.prefixCls,A=x.mode,w=x.collapse,M=x.inDropdown,O=x.levelIndent,P=x.selectedKeys,R=x.autoScrollIntoView,B=x.scrollConfig,I=x.tooltipProps,L=x.onClickMenuItem,D=(0,r.useRef)(null),F=(0,p.Z)(),j="vertical"===A&&o>1,N=w&&!M&&1===o,z=P&&~P.indexOf(s);(0,r.useEffect)(function(){var t=z&&R;D.current&&t&&setTimeout(function(){D.current&&d(D.current,T({behavior:"smooth",block:"start",scrollMode:"if-needed",boundary:document.body},B))},F?500:0)},[z,R]);var H=function(t){!l&&(L(s,t),m&&m(t))},V=r.createElement(void 0===f?"div":f,T({tabIndex:l?-1:0,role:"menuitem",ref:function(t){e=t,D.current=e},style:u,className:(0,n.Z)(k+"-item",((i={})[k+"-disabled"]=l,i[k+"-selected"]=z,i[k+"-item-indented"]=j&&!w,i),h),onClick:H,onKeyDown:function(t){(t.keyCode||t.which)===C.Ce.code&&H(t)}},(0,y.Z)(b,["key","_key"].concat(S))),j&&!w?r.createElement(r.Fragment,null,r.createElement(v,{prefixCls:k,levelIndent:O,level:o}),r.createElement("span",{className:k+"-item-inner",style:{display:"block"}},a)):a,z&&"horizontal"===A?r.createElement("div",{className:k+"-selected-label"}):null);return N?r.createElement(c.Z,T({trigger:"hover",position:"right",content:"function"==typeof _?_():r.createElement("span",null,a),triggerProps:T({className:k+"-item-tooltip"},(null==I?void 0:I.triggerProps)||{})},(0,y.Z)(I,["triggerProps"])),V):V});O.displayName="MenuItem",O.menuType="MenuItem";var P=(0,r.forwardRef)(function(t,e){var i=t.children,s=t.title,a=t.level,o=t.className,l=t.style,h=(0,r.useContext)(g),u=h.prefixCls,d=h.levelIndent,c=w(i,{level:1===a?a+1:a});return r.createElement("div",{ref:e,className:(0,n.Z)(u+"-group",o),style:l},r.createElement("div",{className:u+"-group-title"},r.createElement(v,{level:a,prefixCls:u,levelIndent:d}),r.createElement("span",null,s)),c)});P.displayName="MenuItemGroup",P.menuType="MenuGroup";var R=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};let B=function(t){var e=R((0,r.useState)({value:t,resolve:function(t){}}),2),i=e[0],n=e[1];return(0,r.useEffect)(function(){i.resolve(i.value)},[i]),[i.value,function(t){return new Promise(function(e){n(function(i){var r=t;return"function"==typeof t&&(r=t(i.value)),{value:r,resolve:e}})})}]};var I=i("4716"),L=i("8929"),D=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},F={};function j(t){var e=D((0,r.useState)(),2),i=e[0],n=e[1];return(0,r.useEffect)(function(){F[t]=t in F?F[t]:0,n(F[t]),F[t]+=1},[]),"number"==typeof i?""+t+i:void 0}var N=i("9027"),z=function(){return(z=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},H=function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function a(t){try{l(r.next(t))}catch(t){s(t)}}function o(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(a,o)}l((r=r.apply(t,e||[])).next())})},V=function(t,e){var i,r,n,s,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(i)throw TypeError("Generator is already executing.");for(;a;)try{if(i=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{i=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},W=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},G=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},U={height:0,visibility:"hidden"};let $=function(t){var e,i=t._key,s=t.children,a=t.style,o=t.className,l=t.title,h=t.level,u=t.forwardedRef,d=t.selectable,c=W(t,["_key","children","style","className","title","level","forwardedRef","selectable"]),p=(0,r.useContext)(g),f=p.id,m=p.prefixCls,_=p.levelIndent,b=p.openKeys,x=void 0===b?[]:b,k=p.selectedKeys,A=void 0===k?[]:k,T=p.icons,E=p.onClickSubMenu,O=p.onClickMenuItem,P=m+"-inline",R=(null==x?void 0:x.indexOf(i))>-1,D=d&&A.indexOf(t._key)>-1||M(s,A),F=G(B(R?{height:"auto"}:U),2),$=F[0],Y=F[1],K=function(t){E(i,h,"inline"),d&&O(i,t)},Z=j(f+"-submenu-inline-"),X=w(s,z(z({},(0,L.Z)(c,S)),{level:h+1,selectable:d})),q=r.createElement("div",{tabIndex:0,"aria-expanded":R,"aria-controls":Z,className:(0,n.Z)(P+"-header",((e={})[m+"-selected"]=D,e)),onClick:K,onKeyDown:function(t){(t.keyCode||t.which)===C.Ce.code&&K(t)}},r.createElement(v,{level:h,prefixCls:m,levelIndent:_}),r.createElement("span",null,l),r.createElement("span",{className:m+"-icon-suffix "+(R?"is-open":"")},T&&T.horizontalArrowDown?T.horizontalArrowDown:r.createElement(I.Z,null))),J=r.createElement("div",{id:Z,className:(0,n.Z)(P+"-content"),style:$},X);return r.createElement("div",z({ref:u,className:(0,n.Z)(P,o),style:a},(0,y.Z)(c,["key","popup","triggerProps"])),q,r.createElement(N.Z,{in:R,timeout:200,classNames:P,unmountOnExit:!1,onEnter:function(t){return H(void 0,void 0,void 0,function(){return V(this,function(e){switch(e.label){case 0:if(!t)return[2];return[4,Y(U)];case 1:return e.sent(),[4,Y({height:t.scrollHeight})];case 2:return e.sent(),[2]}})})},onEntered:function(){Y({height:"auto"})},onExit:function(t){return H(void 0,void 0,void 0,function(){return V(this,function(e){switch(e.label){case 0:if(!t)return[2];return[4,Y({height:t.scrollHeight})];case 1:return e.sent(),[4,Y(U)];case 2:return e.sent(),[2]}})})}},J))};var Y=i("6464"),K=i("4151"),Z=i("4887"),X=i("8429"),q=function(){return(q=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},J=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},Q=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};let tt=function(t){var e,i,s,a=t._key,o=t.children,l=t.style,h=t.className,u=t.title,d=t.level,c=t.selectable,p=t.forwardedRef,f=t.triggerProps,m=J(t,["_key","children","style","className","title","level","selectable","forwardedRef","triggerProps"]),_=(0,r.useContext)(g),b=_.id,x=_.prefixCls,S=_.mode,k=_.inDropdown,A=_.levelIndent,w=_.selectedKeys,T=void 0===w?[]:w,E=_.icons,O=_.triggerProps,P=_.onClickSubMenu,R=_.onClickMenuItem,B=(0,r.useContext)(X.E).rtl,L=q(q({},O),f),D=Q((0,r.useState)(!1),2),F=D[0],N=D[1],z=x+"-pop",H=c&&T.indexOf(t._key)>-1,V="horizontal"===S&&!k,W=j(b+"-submenu-pop-"),G=M(o,T)||H,U=B?["br","lt"]:["bl","rt"],$=function(t){P(a,d,"pop"),c&&R(a,t)};return r.createElement(Z.Z,{trigger:"hover",popupVisible:F,onVisibleChange:N,droplist:r.createElement(tP,{id:W,selectedKeys:T,onClickMenuItem:function(t,e){R(t,e),N(!1)}},o),triggerProps:q({position:V?U[0]:U[1],showArrow:!0,autoAlignPopupMinWidth:!0,classNames:"fadeIn",duration:100,mouseEnterDelay:50,mouseLeaveDelay:50,className:(0,n.Z)(z+"-trigger",L&&L.className)},(0,y.Z)(L,["className"]))},r.createElement("div",q({tabIndex:0,"aria-haspopup":!0,"aria-expanded":F,"aria-controls":W,ref:p,style:l,className:(0,n.Z)(z,z+"-header",((s={})[x+"-selected"]=G,s),h),onClick:$,onKeyDown:function(t){var e=t.keyCode||t.which;e===C.Ce.code?$(t):e===C.Xd.code?N(!1):e===C.ol.code&&N(!0)}},(0,y.Z)(m,["key","popup"])),r.createElement(v,{prefixCls:x,levelIndent:A,level:d}),u,(e=E&&E.popArrowRight?E.popArrowRight:B?r.createElement(K.Z,null):r.createElement(Y.Z,null),i=E&&E.horizontalArrowDown?E.horizontalArrowDown:r.createElement(I.Z,null),r.createElement("span",{className:x+"-icon-suffix"},V?i:e)),G&&"horizontal"===S?r.createElement("div",{className:x+"-selected-label"}):null))};var te=function(){return(te=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},ti=(0,r.forwardRef)(function(t,e){var i=t.children,n=t.popup,s=t.level,a=(0,r.useContext)(g),o=a.mode,l=a.collapse,h=a.inDropdown,u=a.collectInlineMenuKeys,d=!!("function"==typeof n?n(s):n),c=d||l||h||"vertical"!==o?tt:$;return(0,r.useEffect)(function(){return u(t._key),function(){u(t._key,!0)}},[]),r.createElement(c,te({forwardedRef:e},t),i)});ti.displayName="SubMenu",ti.menuType="SubMenu";function tr(t,e){if(!t||!e)return null;var i=e;"float"===i&&(i="cssFloat");try{if(document.defaultView){var r=document.defaultView.getComputedStyle(t,"");return t.style[i]||r?r[i]:""}}catch(e){return t.style[i]}}var tn=i("263"),ts=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},ta=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))};function to(t){return t&&Math.ceil(+t.getBoundingClientRect().width)}function tl(t){var e=Number(t.replace("px",""));return isNaN(e)?0:e}let th=function(t){var e,i=t.children,n=t.ellipsisText,s=void 0===n?"\xb7\xb7\xb7":n,a=t.onEllipsisChange,o=(0,r.useContext)(g).prefixCls,l=(0,r.useRef)(null),h=ts((0,r.useState)(null),2),u=h[0],d=h[1],c=o+"-overflow-sub-menu",p=o+"-overflow-hidden-menu-item",f=o+"-overflow-sub-menu-mirror",m=function(t){if(t!==u){var e=r.Children.toArray(i),n=null===t;null==a||a({lastVisibleIndex:n?e.length-1:t,overflowNodes:n?[]:e.slice(t+1)}),d(t)}},v=function(t,e){return void 0===e&&(e=!1),r.createElement(ti,{title:r.createElement("span",null,s),key:"arco-menu-overflow-sub-menu"+(e?"-mirror":""),className:e?f:c,children:t})};return r.createElement(tn.Z,{onResize:function(){if(!!l.current){for(var t=l.current,e=to(t)-5,i=[].slice.call(t.children),r=0,n=0,s=0,a=0;a<i.length;a++){var o=i[a],h=o.className.split(" "),u=h.indexOf(c)>-1,d=h.indexOf(f)>-1;if(!u){var p=to(o)+tl(tr(o,"marginLeft"))+tl(tr(o,"marginRight"));if(d){s=p;continue}if((n+=p)>e){m(r-(n-p+s<=e?1:2));return}r++}}m(null)}},getTargetDOMNode:function(){return l.current}},r.createElement("div",{className:o+"-overflow-wrap",ref:l},(e=null,ta(ta([v(null,!0)],ts(r.Children.map(i,function(t,n){var s=t;return null!==u&&(n>u&&(s=r.cloneElement(t,{className:p})),n===u+1&&(e=v(r.Children.toArray(i).slice(u+1).map(function(t){return r.cloneElement(t,{key:t.props._key})})))),s})),!1),[e],!1))))};var tu=i("7226"),td=i("3779"),tc=i("9933"),tp=i("8336"),tg=i("5296");function tf(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function tm(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?tf(Object(i),!0).forEach(function(e){(0,tp.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):tf(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var tv=r.forwardRef(function(t,e){var i=(0,r.useContext)(tg.P).prefixCls,n=void 0===i?"arco":i,s=t.spin,a=t.className,o=tm(tm({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(a?a+" ":"").concat(n,"-icon ").concat(n,"-icon-menu-fold")});return s&&(o.className="".concat(o.className," ").concat(n,"-icon-loading")),delete o.spin,delete o.isIcon,r.createElement("svg",(0,tc.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),r.createElement("path",{d:"M42 11H6M42 24H22M42 37H6M13.66 26.912l-4.82-3.118 4.82-3.118v6.236Z"}))});tv.defaultProps={isIcon:!0},tv.displayName="IconMenuFold";function ty(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function t_(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ty(Object(i),!0).forEach(function(e){(0,tp.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ty(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var tb=r.forwardRef(function(t,e){var i=(0,r.useContext)(tg.P).prefixCls,n=void 0===i?"arco":i,s=t.spin,a=t.className,o=t_(t_({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(a?a+" ":"").concat(n,"-icon ").concat(n,"-icon-menu-unfold")});return s&&(o.className="".concat(o.className," ").concat(n,"-icon-loading")),delete o.spin,delete o.isIcon,r.createElement("svg",(0,tc.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),r.createElement("path",{d:"M6 11h36M22 24h20M6 37h36M8 20.882 12.819 24 8 27.118v-6.236Z"}))});tb.defaultProps={isIcon:!0},tb.displayName="IconMenuUnfold";var tx=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},tS=i("2888"),tk=i("8569"),tA=i("9743"),tw=function(){return(tw=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},tM=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},tC=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},tT=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))},tE={mode:"vertical",selectable:!0,ellipsis:!0},tO=(0,r.forwardRef)(function(t,e){var i,s,a,o,l=(0,r.useContext)(X.E),h=l.getPrefixCls,u=l.componentConfig,d=l.rtl,c=(0,tS.Z)(t,tE,null==u?void 0:u.Menu),p=c.style,f=c.children,m=c.className,v=c.prefixCls,_=c.mode,b=c.theme,x=c.icons,S=c.levelIndent,k=c.collapse,M=c.inDropdown,C=c.selectable,T=c.triggerProps,E=c.tooltipProps,O=c.ellipsis,P=c.accordion,R=c.autoOpen,B=c.autoScrollIntoView,I=c.scrollConfig,L=c.hasCollapseButton,D=c.defaultOpenKeys,F=c.defaultSelectedKeys,N=c.openKeys,z=c.selectedKeys,H=c.onClickSubMenu,V=c.onClickMenuItem,W=c.onCollapseChange,G=c.onEllipsisChange,U=tM(c,["style","children","className","prefixCls","mode","theme","icons","levelIndent","collapse","inDropdown","selectable","triggerProps","tooltipProps","ellipsis","accordion","autoOpen","autoScrollIntoView","scrollConfig","hasCollapseButton","defaultOpenKeys","defaultSelectedKeys","openKeys","selectedKeys","onClickSubMenu","onClickMenuItem","onCollapseChange","onEllipsisChange"]),$=tC((0,td.Z)([],{defaultValue:D,value:N}),2),Y=$[0],K=$[1],Z=tC((0,td.Z)([],{defaultValue:F,value:z}),2),q=Z[0],J=Z[1],Q=tC((0,td.Z)(!1,{value:k}),2),tt=Q[0],te=Q[1],ti=(0,r.useContext)(g),tr=(0,r.useContext)(tu.D).siderCollapsed,tn=v||h("menu"),ts=tr||tt||M||"popButton"===_,ta=b||ti.theme||"light",to=(0,r.useRef)([]),tl=(0,r.useRef)([]),tc=tx((0,r.useReducer)(function(t){return t+1},0),2)[1],tp=(0,tk.Z)(),tg=(0,r.useMemo)(function(){return A(f)},[f]),tf=j(tn+"-"),tm=U.id||tf;(0,r.useEffect)(function(){var t=Y.filter(function(t){return -1!==to.current.indexOf(t)});if(R){var e=to.current.filter(function(t){return -1===tl.current.indexOf(t)});t=Y.concat(e)}K(P?t.slice(0,1):t),tl.current=to.current.slice()},[to.current.toString()]);var ty="horizontal"!==_&&"popButton"!==_&&!M&&L,t_=tw({},p);return ts&&!M&&delete t_.width,r.createElement("div",tw({id:ty?tm:void 0,role:"menu"},(0,y.Z)(U,["isMenu"]),{ref:e,style:t_,className:(0,n.Z)(tn,tn+"-"+ta,tn+"-"+("horizontal"===_?"horizontal":"vertical"),((o={})[tn+"-collapse"]=ts,o[tn+"-pop"]="pop"===_||ts,o[tn+"-pop-button"]="popButton"===_,o[tn+"-rtl"]=d,o),m)}),r.createElement(g.Provider,{value:{mode:_,theme:ta,collapse:ts,levelIndent:S,inDropdown:M,selectedKeys:q,openKeys:Y,icons:x,triggerProps:T,tooltipProps:E,autoScrollIntoView:B,scrollConfig:I,id:tm,prefixCls:tn,collectInlineMenuKeys:function(t,e){e?to.current=to.current.filter(function(e){return e!==t}):to.current.push(t),tc()},onClickMenuItem:function(t,e){var i;C&&J([t]),V&&V(t,e,null===(i=tg[t])||void 0===i?void 0:i.keyPath)},onClickSubMenu:function(t,e,i){var r,n=tT([],tC(Y),!1);"inline"===i&&(n=(null==Y?void 0:Y.indexOf(t))>-1?P&&1===e?[]:Y.filter(function(e){return e!==t}):P&&1===e?[t]:Y.concat([t])),K(n),H&&H(t,n,null===(r=tg[t])||void 0===r?void 0:r.keyPath)}}},(i=w(f,{level:1}),s=tt?x&&x.collapseActive||r.createElement(tb,null):x&&x.collapseDefault||r.createElement(tv,null),a=function(){var t=!tt;te(t),W&&W(t)},r.createElement(r.Fragment,null,r.createElement("div",{className:tn+"-inner"},"horizontal"===_&&!1!==O?r.createElement(th,{ellipsisText:(0,tA.Kn)(O)?O.text:"\xb7\xb7\xb7",onEllipsisChange:G},i):i),ty&&r.createElement("div",tw({tabIndex:0,role:"button","aria-controls":tm,"aria-expanded":!tt,className:tn+"-collapse-button",onClick:a},tp({onPressEnter:a})),s)))))});tO.displayName="Menu",tO.Item=O,tO.SubMenu=ti,tO.ItemGroup=P,tO.__ARCO_MENU__=!0;let tP=tO},414:function(t,e,i){"use strict";i(4290),i(7645),i(3654),i(7236)},2407:function(t,e,i){"use strict";i.d(e,{Z:()=>iR});var r,n,s,a,o,l,h,u,d,c,p,g,f,m,v,y,_,b,x,S,k,A=i("4194"),w=i("6293"),M=i("9933"),C="data-focus-lock",T="data-focus-lock-disabled";function E(t,e){return"function"==typeof t?t(e):t&&(t.current=e),t}var O="undefined"!=typeof window?A.useLayoutEffect:A.useEffect,P=new WeakMap,R={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},B=function(){return(B=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function I(t){return t}function L(t,e){void 0===e&&(e=I);var i=[],r=!1;return{read:function(){if(r)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return i.length?i[i.length-1]:t},useMedium:function(t){var n=e(t,r);return i.push(n),function(){i=i.filter(function(t){return t!==n})}},assignSyncMedium:function(t){for(r=!0;i.length;){var e=i;i=[],e.forEach(t)}i={push:function(e){return t(e)},filter:function(){return i}}},assignMedium:function(t){r=!0;var e=[];if(i.length){var n=i;i=[],n.forEach(t),e=i}var s=function(){var i=e;e=[],i.forEach(t)},a=function(){return Promise.resolve().then(s)};a(),i={push:function(t){e.push(t),a()},filter:function(t){return e=e.filter(t),i}}}}}function D(t,e){return void 0===e&&(e=I),L(t,e)}var F=D({},function(t){return{target:t.target,currentTarget:t.currentTarget}}),j=D(),N=D();var z=(r={async:!0,ssr:"undefined"!=typeof document},(n=L(null)).options=B({async:!0,ssr:!1},r),n),H=(0,A.createContext)(void 0),V=[],W=A.forwardRef(function(t,e){var i,r,n,s,a,o,l,h=A.useState(),u=h[0],d=h[1],c=A.useRef(),p=A.useRef(!1),g=A.useRef(null),f=A.useState({})[1],m=t.children,v=t.disabled,y=void 0!==v&&v,_=t.noFocusGuards,b=void 0!==_&&_,x=t.persistentFocus,S=t.crossFrame,k=t.autoFocus,w=(t.allowTextSelection,t.group),B=t.className,I=t.whiteList,L=t.hasPositiveIndices,D=t.shards,N=void 0===D?V:D,W=t.as,G=t.lockProps,U=t.sideCar,$=t.returnFocus,Y=void 0!==$&&$,K=t.focusOptions,Z=t.onActivation,X=t.onDeactivation,q=A.useState({})[0],J=A.useCallback(function(t){var e=t.captureFocusRestore;if(!g.current){var i,r=null==(i=document)?void 0:i.activeElement;g.current=r,r!==document.body&&(g.current=e(r))}c.current&&Z&&Z(c.current),p.current=!0,f()},[Z]),Q=A.useCallback(function(){p.current=!1,X&&X(c.current),f()},[X]),tt=A.useCallback(function(t){var e=g.current;if(e){var i=("function"==typeof e?e():e)||document.body,r="function"==typeof Y?Y(i):Y;if(r){var n="object"==typeof r?r:void 0;g.current=null,t?Promise.resolve().then(function(){return i.focus(n)}):i.focus(n)}}},[Y]),te=A.useCallback(function(t){p.current&&F.useMedium(t)},[]),ti=j.useMedium,tr=A.useCallback(function(t){c.current!==t&&(c.current=t,d(t))},[]),tn=(0,M.Z)(((l={})[T]=y&&"disabled",l[C]=w,l),void 0===G?{}:G),ts=!0!==b,ta=ts&&"tail"!==b;var to=(i=[e,tr],o=(n=null,s=function(t){return i.forEach(function(e){return E(e,t)})},(a=(0,A.useState)(function(){return{value:n,callback:s,facade:{get current(){return a.value},set current(value){var t=a.value;t!==value&&(a.value=value,a.callback(value,t))}}}})[0]).callback=s,a.facade),O(function(){var t=P.get(o);if(t){var e=new Set(t),r=new Set(i),n=o.current;e.forEach(function(t){!r.has(t)&&E(t,null)}),r.forEach(function(t){!e.has(t)&&E(t,n)})}P.set(o,i)},[i]),o),tl=A.useMemo(function(){return{observed:c,shards:N,enabled:!y,active:p.current}},[y,p.current,N,u]);return A.createElement(A.Fragment,null,ts&&[A.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:y?-1:0,style:R}),L?A.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:y?-1:1,style:R}):null],!y&&A.createElement(U,{id:q,sideCar:z,observed:u,disabled:y,persistentFocus:void 0!==x&&x,crossFrame:void 0===S||S,autoFocus:void 0===k||k,whiteList:I,shards:N,onActivation:J,onDeactivation:Q,returnFocus:tt,focusOptions:K}),A.createElement(void 0===W?"div":W,(0,M.Z)({ref:to},tn,{className:B,onBlur:ti,onFocus:te}),A.createElement(H.Provider,{value:tl},m)),ta&&A.createElement("div",{"data-focus-guard":!0,tabIndex:y?-1:0,style:R}))});W.propTypes={};var G=i("510"),U=i("8336"),$=function(t){for(var e=Array(t.length),i=0;i<t.length;++i)e[i]=t[i];return e},Y=function(t){return Array.isArray(t)?t:[t]},K=function(t){return Array.isArray(t)?t[0]:t},Z=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!!e&&!!e.getPropertyValue&&("none"===e.getPropertyValue("display")||"hidden"===e.getPropertyValue("visibility"))},X=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},q=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},J=function(t,e){return!t||q(t)||!Z(t)&&!t.hasAttribute("inert")&&e(X(t))},Q=function(t,e){var i=t.get(e);if(void 0!==i)return i;var r=J(e,Q.bind(void 0,t));return t.set(e,r),r},tt=function(t,e){var i,r,n=t.get(e);if(void 0!==n)return n;var s=(i=e,r=tt.bind(void 0,t),!i||!!q(i)||!!ts(i)&&r(X(i)));return t.set(e,s),s},te=function(t){return t.dataset},ti=function(t){return"INPUT"===t.tagName},tr=function(t){return ti(t)&&"radio"===t.type},tn=function(t){return!((ti(t)||"BUTTON"===t.tagName)&&("hidden"===t.type||t.disabled))},ts=function(t){return![!0,"true",""].includes(t.getAttribute("data-no-autofocus"))},ta=function(t){var e;return!!(t&&(null===(e=te(t))||void 0===e?void 0:e.focusGuard))},to=function(t){return!ta(t)},tl=function(t){return!!t},th=function(t,e){var i=Math.max(0,t.tabIndex),r=Math.max(0,e.tabIndex),n=i-r,s=t.index-e.index;if(n){if(!i)return 1;if(!r)return -1}return n||s},tu=function(t,e,i){return $(t).map(function(t,e){var r,n=(r=t).tabIndex<0&&!r.hasAttribute("tabindex")?0:r.tabIndex;return{node:t,index:e,tabIndex:i&&-1===n?(t.dataset||{}).focusGuard?0:-1:n}}).filter(function(t){return!e||t.tabIndex>=0}).sort(th)},td="button:enabled,select:enabled,textarea:enabled,input:enabled,a[href],area[href],summary,iframe,object,embed,audio[controls],video[controls],[tabindex],[contenteditable],[autofocus]",tc="".concat(td,", [data-focus-guard]"),tp=function(t,e){return $((t.shadowRoot||t).children).reduce(function(t,i){return t.concat(i.matches(e?tc:td)?[i]:[],tp(i))},[])},tg=function(t,e){var i;return t instanceof HTMLIFrameElement&&(null===(i=t.contentDocument)||void 0===i?void 0:i.body)?tf([t.contentDocument.body],e):[t]},tf=function(t,e){return t.reduce(function(t,i){var r,n=tp(i,e),s=(r=[]).concat.apply(r,n.map(function(t){return tg(t,e)}));return t.concat(s,i.parentNode?$(i.parentNode.querySelectorAll(td)).filter(function(t){return t===i}):[])},[])},tm=function(t,e){return $(t).filter(function(t){return Q(e,t)}).filter(function(t){return tn(t)})},tv=function(t,e){return void 0===e&&(e=new Map),$(t).filter(function(t){return tt(e,t)})},ty=function(t,e,i){return tu(tm(tf(t,i),e),!0,i)},t_=function(t,e){return tu(tm(tf(t),e),!1)},tb=function(t,e){return tm($(t.querySelectorAll("[".concat("data-autofocus-inside","]"))).map(function(t){return tf([t])}).reduce(function(t,e){return t.concat(e)},[]),e)},tx=function(t,e){return t.shadowRoot?tx(t.shadowRoot,e):!!(void 0!==Object.getPrototypeOf(t).contains&&Object.getPrototypeOf(t).contains.call(t,e))||$(t.children).some(function(t){var i;if(t instanceof HTMLIFrameElement){var r=null===(i=t.contentDocument)||void 0===i?void 0:i.body;return!!r&&tx(r,e)}return tx(t,e)})},tS=function(t){try{return t()}catch(t){return}},tk=function(t){if(void 0===t&&(t=document),!!t&&!!t.activeElement){var e=t.activeElement;return e.shadowRoot?tk(e.shadowRoot):e instanceof HTMLIFrameElement&&tS(function(){return e.contentWindow.document})?tk(e.contentWindow.document):e}},tA=function(t){void 0===t&&(t=document);var e=tk(t);return!!e&&$(t.querySelectorAll("[".concat("data-no-focus-lock","]"))).some(function(t){return tx(t,e)})},tw=function(t){for(var e=new Set,i=t.length,r=0;r<i;r+=1)for(var n=r+1;n<i;n+=1){var s=t[r].compareDocumentPosition(t[n]);(s&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(n),(s&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return t.filter(function(t,i){return!e.has(i)})},tM=function(t){return t.parentNode?tM(t.parentNode):t},tC=function(t){return Y(t).filter(Boolean).reduce(function(t,e){var i=e.getAttribute(C);return t.push.apply(t,i?tw($(tM(e).querySelectorAll("[".concat(C,'="').concat(i,'"]:not([').concat(T,'="disabled"])')))):[e]),t},[])},tT=function(t,e){return void 0===e&&(e=tk(K(t).ownerDocument)),!!e&&(!e.dataset||!e.dataset.focusGuard)&&tC(t).some(function(t){var i,r;return tx(t,e)||(i=t,r=e,!!$(i.querySelectorAll("iframe")).some(function(t){return t===r}))})},tE=function(t,e){if(!!t)"focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus()},tO=function(t,e){if(tr(t)&&t.name){var i;return i=t,e.filter(tr).filter(function(t){return t.name===i.name}).filter(function(t){return t.checked})[0]||i}return t},tP=function(t){var e=new Set;return t.forEach(function(i){return e.add(tO(i,t))}),t.filter(function(t){return e.has(t)})},tR=function(t){return t[0]&&t.length>1?tO(t[0],t):t[0]},tB=function(t,e){return t.indexOf(tO(e,t))},tI="NEW_FOCUS",tL=function(t,e,i,r,n){var s=t.length,a=t[0],o=t[s-1],l=ta(r);if(!(r&&t.indexOf(r)>=0)){var h=void 0!==r?i.indexOf(r):-1,u=n?i.indexOf(n):h,d=n?t.indexOf(n):-1;if(-1===h)return -1!==d?d:tI;if(-1===d)return tI;var c=h-u,p=i.indexOf(a),g=i.indexOf(o),f=tP(i),m=(void 0!==r?f.indexOf(r):-1)-(n?f.indexOf(n):h);if(!c&&d>=0||0===e.length)return d;var v=tB(t,e[0]),y=tB(t,e[e.length-1]);if(h<=p&&l&&Math.abs(c)>1)return y;if(h>=g&&l&&Math.abs(c)>1)return v;if(c&&Math.abs(m)>1)return d;if(h<=p)return y;if(h>g)return v;if(c)return Math.abs(c)>1?d:(s+d+c)%s}},tD=function(t,e,i){var r,n=tv(t.map(function(t){return t.node}).filter((r=i,function(t){var e,i=null===(e=te(t))||void 0===e?void 0:e.autofocus;return t.autofocus||void 0!==i&&"false"!==i||r.indexOf(t)>=0})));return n&&n.length?tR(n):tR(tv(e))},tF=function(t,e){return void 0===e&&(e=[]),e.push(t),t.parentNode&&tF(t.parentNode.host||t.parentNode,e),e},tj=function(t,e){for(var i=tF(t),r=tF(e),n=0;n<i.length;n+=1){var s=i[n];if(r.indexOf(s)>=0)return s}return!1},tN=function(t,e,i){var r=Y(t),n=Y(e),s=r[0],a=!1;return n.filter(Boolean).forEach(function(t){a=tj(a||t,t)||a,i.filter(Boolean).forEach(function(t){var e=tj(s,t);e&&(a=!a||tx(e,a)?e:tj(e,a))})}),a},tz=function(t,e){return t.reduce(function(t,i){return t.concat(tb(i,e))},[])},tH=function(t,e){var i=new Map;return e.forEach(function(t){return i.set(t.node,t)}),t.map(function(t){return i.get(t)}).filter(tl)},tV=function(t,e){var i=tk(Y(t).length>0?document:K(t).ownerDocument),r=tC(t).filter(to),n=tN(i||t,t,r),s=new Map,a=t_(r,s),o=a.filter(function(t){return to(t.node)});if(!!o[0]){var l=t_([n],s).map(function(t){return t.node}),h=tH(l,o),u=h.map(function(t){return t.node}),d=h.filter(function(t){return t.tabIndex>=0}).map(function(t){return t.node}),c=tL(u,d,l,i,e);if(c===tI){var p=tD(a,d,tz(r,s))||tD(a,u,tz(r,s));if(p)return{node:p};console.warn("focus-lock: cannot find any node to move focus into");return}return void 0===c?c:h[c]}},tW=0,tG=!1,tU=function(t,e,i){void 0===i&&(i={});var r=tV(t,e);if(!tG){if(r){if(tW>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),tG=!0,setTimeout(function(){tG=!1},1);return}tW++,tE(r.node,i.focusOptions),tW--}}},t$=function(t){var e=tC(t).filter(to),i=tu(tf([tN(t,t,e)],!0),!0,!0),r=tf(e,!1);return i.map(function(t){var e=t.node;return{node:e,index:t.index,lockItem:r.indexOf(e)>=0,guard:ta(e)}})},tY=function(t,e,i){if(!t||!e)return console.error("no element or scope given"),{};var r=Y(e);if(r.every(function(e){return!tx(e,t)}))return console.error("Active element is not contained in the scope"),{};var n=i?ty(r,new Map):t_(r,new Map),s=n.findIndex(function(e){return e.node===t});if(-1!==s)return{prev:n[s-1],next:n[s+1],first:n[0],last:n[n.length-1]}},tK=function(t,e){var i=e?ty(Y(t),new Map):t_(Y(t),new Map);return{first:i[0],last:i[i.length-1]}},tZ=function(t,e,i){void 0===e&&(e={});var r,n=(r=e,Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},r)),s=tY(t,n.scope,n.onlyTabbable);if(!!s){var a=i(s,n.cycle);a&&tE(a.node,n.focusOptions)}},tX=function(t,e,i){var r,n=tK(t,null===(r=e.onlyTabbable)||void 0===r||r)[i];n&&tE(n.node,e.focusOptions)};function tq(t){if(!t)return null;if("undefined"==typeof WeakRef)return function(){return t||null};var e=t?new WeakRef(t):null;return function(){return(null==e?void 0:e.deref())||null}}var tJ=function(t){if(!t)return null;for(var e=[],i=t;i&&i!==document.body;)e.push({current:tq(i),parent:tq(i.parentElement),left:tq(i.previousElementSibling),right:tq(i.nextElementSibling)}),i=i.parentElement;return{element:tq(t),stack:e,ownerDocument:t.ownerDocument}},tQ=function(t){if(!!t)for(var e,i,r,n,s,a=t.stack,o=t.ownerDocument,l=new Map,h=0;h<a.length;h++){var u=a[h],d=null===(e=u.parent)||void 0===e?void 0:e.call(u);if(d&&o.contains(d)){for(var c=null===(i=u.left)||void 0===i?void 0:i.call(u),p=u.current(),g=d.contains(p)?p:void 0,f=null===(r=u.right)||void 0===r?void 0:r.call(u),m=ty([d],l),v=null!==(s=null!==(n=null!=g?g:null==c?void 0:c.nextElementSibling)&&void 0!==n?n:f)&&void 0!==s?s:c;v;){for(var y=0;y<m.length;y++){var _=m[y];if(null==v?void 0:v.contains(_.node))return _.node}v=v.nextElementSibling}if(m.length)return m[0].node}}};function t0(t){setTimeout(t,1)}var t1=function(t){return t&&"current"in t?t.current:t},t2=null,t3=null,t5=null,t4=!1,t8=function(t,e){t5={observerNode:t,portaledElement:e}};function t6(t,e,i,r){var n=null,s=t;do{var a=r[s];if(a.guard)a.node.dataset.focusAutoGuard&&(n=a);else if(a.lockItem){if(s!==t)return;n=null}else break}while((s+=i)!==e);n&&(n.node.tabIndex=0)}var t9=function(){var t=!1;if(t2){var e=t2,i=e.observed,r=e.persistentFocus,n=e.autoFocus,s=e.shards,a=e.crossFrame,o=e.focusOptions,l=i||t5&&t5.portaledElement,h=document&&document.activeElement;if(l){var u,d,c,p=[l].concat(s.map(t1).filter(Boolean));if(!h||(u=h,(t2.whiteList||function(){return!0})(u))){if(r||(a?!!t4:"meanwhile"===t4)||!(document&&document.activeElement===document.body||tA())||!t3&&n){;if(l&&!(tT(p)||h&&(d=h,p.some(function(t){return function t(e,i,r){return i&&(i.host===e&&(!i.activeElement||r.contains(i.activeElement))||i.parentNode&&t(e,i.parentNode,r))}(d,t,t)}))||(c=h,t5&&t5.portaledElement===c)))document&&!t3&&h&&!n?(h.blur&&h.blur(),document.body.focus()):(t=tU(p,t3,{focusOptions:o}),t5={});t4=!1,t3=document&&document.activeElement}}if(document&&h!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var g=document&&document.activeElement,f=t$(p),m=f.map(function(t){return t.node}).indexOf(g);m>-1&&(f.filter(function(t){var e=t.guard,i=t.node;return e&&i.dataset.focusAutoGuard}).forEach(function(t){return t.node.removeAttribute("tabIndex")}),t6(m,f.length,1,f),t6(m,-1,-1,f))}}}return t},t7=function(t){t9()&&t&&(t.stopPropagation(),t.preventDefault())},et=function(){return t0(t9)},ee=function(t){var e=t.target,i=t.currentTarget;!i.contains(e)&&t8(i,e)},ei=function(){t4="just",t0(function(){t4="meanwhile"})},er=function(){document.addEventListener("focusin",t7),document.addEventListener("focusout",et),window.addEventListener("blur",ei)},en=function(){document.removeEventListener("focusin",t7),document.removeEventListener("focusout",et),window.removeEventListener("blur",ei)},es={moveFocusInside:tU,focusInside:tT,focusNextElement:function(t,e){void 0===e&&(e={}),tZ(t,e,function(t,e){var i=t.next,r=t.first;return i||e&&r})},focusPrevElement:function(t,e){void 0===e&&(e={}),tZ(t,e,function(t,e){var i=t.prev,r=t.last;return i||e&&r})},focusFirstElement:function(t,e){void 0===e&&(e={}),tX(t,e,"first")},focusLastElement:function(t,e){void 0===e&&(e={}),tX(t,e,"last")},captureFocusRestore:function(t){var e=tJ(t);return function(){return tQ(e)}}};F.assignSyncMedium(ee),j.assignMedium(et),N.assignMedium(function(t){return t(es)});let ea=(s=function(t){return t.filter(function(t){return!t.disabled})},a=function(t){var e=t.slice(-1)[0];e&&!t2&&er();var i=t2,r=i&&e&&e.id===i.id;t2=e,i&&!r&&(i.onDeactivation(),!t.filter(function(t){return t.id===i.id}).length&&i.returnFocus(!e)),e?(t3=null,(!r||i.observed!==e.observed)&&e.onActivation(es),t9(!0),t0(t9)):(en(),t3=null)},function(t){var e,i,r=[];function n(){a(i=s(r.map(function(t){return t.props})))}var o=function(e){function s(){return e.apply(this,arguments)||this}(0,G.Z)(s,e),s.peek=function(){return i};var a=s.prototype;return a.componentDidMount=function(){r.push(this),n()},a.componentDidUpdate=function(){n()},a.componentWillUnmount=function(){var t=r.indexOf(this);r.splice(t,1),n()},a.render=function(){return A.createElement(t,this.props)},s}(A.PureComponent);return(0,U.Z)(o,"displayName","SideEffect("+((e=t).displayName||e.name||"Component")+")"),o})(function(){return null});var eo=A.forwardRef(function(t,e){return A.createElement(W,(0,M.Z)({sideCar:ea,ref:e},t))}),el=W.propTypes||{};el.sideCar,(0,w.Z)(el,["sideCar"]),eo.propTypes={};var eh=i("6807"),eu=i("2315"),ed=i("6132"),ec=i("8564"),ep=i("859"),eg=i("6321");var ef=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),em=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=null,e}return ef(e,t),e.prototype.componentDidMount=function(){var t=this;this.createContainer(),this.timer=setTimeout(function(){!t.container&&t.createContainer()})},e.prototype.componentWillUnmount=function(){clearTimeout(this.timer)},e.prototype.createContainer=function(){var t=this.props.getContainer;this.container=null==t?void 0:t(),this.forceUpdate()},e.prototype.render=function(){var t=this.props.children;return this.container?eg.createPortal(t,this.container):null},e}(A.Component);var ev=(l=function(t,e){return(l=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),ey=function(){return(ey=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},e_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ev(e,t),e.prototype.componentWillUnmount=function(){this.instance=null},e.prototype.render=function(){var t=this,e=this.props,i=e.forceRender,r=e.visible;return i||r||this.instance?A.createElement(em,ey({ref:function(e){return t.instance=e}},this.props)):null},e.displayName="Portal",e.defaultProps={getContainer:function(){return document.body}},e}(A.Component),eb=i("98"),ex=i("5296");function eS(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function ek(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?eS(Object(i),!0).forEach(function(e){(0,U.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):eS(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var eA=A.forwardRef(function(t,e){var i=(0,A.useContext)(ex.P).prefixCls,r=void 0===i?"arco":i,n=t.spin,s=t.className,a=ek(ek({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(s?s+" ":"").concat(r,"-icon ").concat(r,"-icon-info-circle-fill")});return n&&(a.className="".concat(a.className," ").concat(r,"-icon-loading")),delete a.spin,delete a.isIcon,A.createElement("svg",(0,M.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},a),A.createElement("path",{fill:"currentColor",fillRule:"evenodd",stroke:"none",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm2-30a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2Zm0 17h1a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-6a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1h1v-8a1 1 0 0 1-1-1v-2a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v11Z",clipRule:"evenodd"}))});eA.defaultProps={isIcon:!0},eA.displayName="IconInfoCircleFill";var ew=i("672");function eM(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function eC(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?eM(Object(i),!0).forEach(function(e){(0,U.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):eM(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var eT=A.forwardRef(function(t,e){var i=(0,A.useContext)(ex.P).prefixCls,r=void 0===i?"arco":i,n=t.spin,s=t.className,a=eC(eC({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(s?s+" ":"").concat(r,"-icon ").concat(r,"-icon-exclamation-circle-fill")});return n&&(a.className="".concat(a.className," ").concat(r,"-icon-loading")),delete a.spin,delete a.isIcon,A.createElement("svg",(0,M.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},a),A.createElement("path",{fill:"currentColor",fillRule:"evenodd",stroke:"none",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm-2-11a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v2Zm4-18a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V15Z",clipRule:"evenodd"}))});eT.defaultProps={isIcon:!0},eT.displayName="IconExclamationCircleFill";function eE(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function eO(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?eE(Object(i),!0).forEach(function(e){(0,U.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):eE(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var eP=A.forwardRef(function(t,e){var i=(0,A.useContext)(ex.P).prefixCls,r=void 0===i?"arco":i,n=t.spin,s=t.className,a=eO(eO({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(s?s+" ":"").concat(r,"-icon ").concat(r,"-icon-close-circle-fill")});return n&&(a.className="".concat(a.className," ").concat(r,"-icon-loading")),delete a.spin,delete a.isIcon,A.createElement("svg",(0,M.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},a),A.createElement("path",{fill:"currentColor",fillRule:"evenodd",stroke:"none",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm4.955-27.771-4.95 4.95-4.95-4.95a1 1 0 0 0-1.414 0l-1.414 1.414a1 1 0 0 0 0 1.414l4.95 4.95-4.95 4.95a1 1 0 0 0 0 1.414l1.414 1.414a1 1 0 0 0 1.414 0l4.95-4.95 4.95 4.95a1 1 0 0 0 1.414 0l1.414-1.414a1 1 0 0 0 0-1.414l-4.95-4.95 4.95-4.95a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0Z",clipRule:"evenodd"}))});eP.defaultProps={isIcon:!0},eP.displayName="IconCloseCircleFill";var eR=function(){return(eR=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},eB={},eI={simple:!0},eL=[],eD=i("9743");function eF(t,e){var i=function(t){var e,i,r,n,s={r:(n=(i=[],r=(e=t).substr(1),3===e.length&&(r=e.replace(/(.)/g,"$1$1")),r.replace(/../g,function(t){i.push(parseInt(t,16))}),{r:i[0],g:i[1],b:i[2],rgb:"rgb("+i.join(",")+")"})).r,g:n.g,b:n.b},a=function(t,e,i){var r,n,s=t/255,a=e/255,o=i/255,l=Math.max(s,a,o),h=Math.min(s,a,o),u=(l+h)/2;if(l===h)r=0,n=0;else{var d=l-h;switch(n=u>.5?d/(2-l-h):d/(l+h),l){case s:r=(a-o)/d+(a<o?6:0);break;case a:r=(o-s)/d+2;break;case o:r=(s-a)/d+4}r/=6}return{h:r,s:n,l:u,hsl:"hsl("+360*r+", "+100*n+"%, "+100*u+"%)"}}(s.r,s.g,s.b);return{h:a.h,s:a.s,l:a.l}}(t);return(function(t){var e,i,r,n=t[0]/360,s=t[1]/100,a=t[2]/100;if(0===s)return[r=255*a,r,r];e=a<.5?a*(1+s):a+s-a*s;for(var o=2*a-e,l=[0,0,0],h=0;h<3;h++)(i=n+-(1/3*(h-1)))<0&&i++,i>1&&i--,r=6*i<1?o+(e-o)*6*i:2*i<1?e:3*i<2?o+(e-o)*(2/3-i)*6:o,l[h]=255*r;return l})([360*+i.h,100*+i.s,100*+i.l+ +e]).join(",")}var ej=i("6693");function eN(t,e){var i=Object.create(null);return t&&A.Children.map(t,function(t){return t}).forEach(function(t){var r;i[t.key]=(r=t,e&&(0,A.isValidElement)(r)?e(r):r)}),i}function ez(t,e,i){return null!=i[e]?i[e]:t.props[e]}var eH=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},eV=function(t){function e(e,i){var r,n=(r=t.call(this,e,i)||this).handleExited.bind(function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(r));return r.state={contextValue:{isMounting:!0},handleExited:n,firstRender:!0},r}(0,G.Z)(e,t);var i=e.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(t,e){var i,r,n,s,a,o,l,h=e.children,u=e.handleExited;return{children:e.firstRender?(i=t,r=u,eN(i.children,function(t){return(0,A.cloneElement)(t,{onExited:r.bind(null,t),in:!0,appear:ez(t,"appear",i),enter:ez(t,"enter",i),exit:ez(t,"exit",i)})})):(n=t,s=h,a=u,Object.keys(l=function(t,e){function i(i){return i in e?e[i]:t[i]}t=t||{},e=e||{};var r,n=Object.create(null),s=[];for(var a in t)a in e?s.length&&(n[a]=s,s=[]):s.push(a);var o={};for(var l in e){if(n[l])for(r=0;r<n[l].length;r++){var h=n[l][r];o[n[l][r]]=i(h)}o[l]=i(l)}for(r=0;r<s.length;r++)o[s[r]]=i(s[r]);return o}(s,o=eN(n.children))).forEach(function(t){var e=l[t];if((0,A.isValidElement)(e)){var i=t in s,r=t in o,h=s[t],u=(0,A.isValidElement)(h)&&!h.props.in;r&&(!i||u)?l[t]=(0,A.cloneElement)(e,{onExited:a.bind(null,e),in:!0,exit:ez(e,"exit",n),enter:ez(e,"enter",n)}):r||!i||u?r&&i&&(0,A.isValidElement)(h)&&(l[t]=(0,A.cloneElement)(e,{onExited:a.bind(null,e),in:h.props.in,exit:ez(e,"exit",n),enter:ez(e,"enter",n)})):l[t]=(0,A.cloneElement)(e,{in:!1})}}),l),firstRender:!1}},i.handleExited=function(t,e){var i=eN(this.props.children);!(t.key in i)&&(t.props.onExited&&t.props.onExited(e),this.mounted&&this.setState(function(e){var i=(0,M.Z)({},e.children);return delete i[t.key],{children:i}}))},i.render=function(){var t=this.props,e=t.component,i=t.childFactory,r=(0,w.Z)(t,["component","childFactory"]),n=this.state.contextValue,s=eH(this.state.children).map(i);return(delete r.appear,delete r.enter,delete r.exit,null===e)?A.createElement(ej.Z.Provider,{value:n},s):A.createElement(ej.Z.Provider,{value:n},A.createElement(e,r,s))},e}(A.Component);eV.propTypes={},eV.defaultProps={component:"div",childFactory:function(t){return t}};var eW=i("9027");var eG=(h=function(t,e){return(h=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),eU=function(){return(eU=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},e$=function(t){function e(e){var i=t.call(this,e)||this;return i.add=function(t){var e,r=(null==(e=t)?void 0:e.id)?null==e?void 0:e.id:"arco_notice_id_"+Math.random().toFixed(10).slice(2),n=i.state.notices;return t.id&&~n.findIndex(function(e){return e.id===t.id})?i.update(t):i.setState(function(e){return{notices:e.notices.concat(eU(eU({},t),{id:r})),position:t.position}}),r},i.update=function(t){var e=i.state.notices.map(function(e){return t.id===e.id?t:e});i.setState({notices:e},function(){var r=e.map(function(e){return t.id===e.id&&delete e.update,e});i.setState({notices:r})})},i.clear=function(){i.setState({notices:[]})},i.state={notices:[],position:"topRight"},i.remove=i.remove.bind(i),i}return eG(e,t),e.prototype.remove=function(t){this.setState(function(e){return{notices:e.notices.filter(function(e){return e.id!==t})}})},e}(A.Component),eY=i("8773"),eK=i("2920"),eZ=i("8429");var eX=(u=function(t,e){return(u=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),eq=function(){return(eq=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},eJ=function(t){function e(e){var i=t.call(this,e)||this;return i.getRootDOMNode=function(){return i.rootDOMRef.current},i.startTimer=function(){var t=i.props,e=t.duration,r=t.onClose,n=t.id;0!==e&&(i.timer=window.setTimeout(function(){r&&r(n),i.removeTimer()},e))},i.removeTimer=function(){i.timer&&(window.clearTimeout(i.timer),i.timer=null)},i.onClose=function(){i.props.onClose&&i.props.onClose(i.props.id)},i.renderIcon=function(){var t,e=i.props,r=e.showIcon,n=e.icon,s=e.type,a=e.prefixCls,o=e.iconPrefix;if(n)t=n;else if(r){switch(s){case"info":t=A.createElement(eA,null);break;case"success":t=A.createElement(ew.Z,null);break;case"error":t=A.createElement(eP,null);break;case"warning":t=A.createElement(eT,null);break;case"loading":t=A.createElement(eY.Z,null)}t=A.createElement(ex.P.Provider,{value:o?{prefixCls:o}:{}},t)}return A.createElement("span",{className:a+"-icon"},t)},i.onMouseEnter=function(){i.removeTimer()},i.onMouseLeave=function(){i.removeTimer(),i.startTimer()},i.rootDOMRef=(0,A.createRef)(),i}return eX(e,t),e.prototype.componentDidMount=function(){this.startTimer()},e.prototype.componentDidUpdate=function(t){(t.duration!==this.props.duration||this.props.update)&&(this.removeTimer(),this.startTimer())},e.prototype.componentWillUnmount=function(){this.removeTimer()},e.prototype.render=function(){var t,e=this.props,i=e.title,r=e.content,n=e.showIcon,s=e.className,a=e.style,o=e.type,l=e.btn,h=e.icon,u=e.prefixCls,d=e.closable,c=e.noticeType,p=e.iconPrefix,g=e.rtl,f=e.closeIcon,m=e.classPrefixCls,v=(0,eu.Z)(u,u+"-"+o,((t={})[u+"-closable"]=d,t[u+"-rtl"]=g,t),s),y=!("closable"in this.props)||d,_=n;"normal"===o&&!h&&(_=!1);var b=eq({},this.context);return(m&&(b.prefixCls=m),"message"===c)?(y=d,A.createElement(ip,eq({},b),A.createElement("div",{style:{textAlign:"center"},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,ref:this.rootDOMRef},A.createElement("div",{className:v,style:a,role:"alert"},_&&this.renderIcon(),A.createElement("span",{className:u+"-content"},r),y&&(void 0!==f?A.createElement("span",{onClick:this.onClose,className:u+"-close-btn"},f):A.createElement(eK.Z,{prefix:u,className:u+"-close-btn",onClick:this.onClose},A.createElement(eh.Z,null))))))):"notification"===c?A.createElement(ip,eq({},b),A.createElement("div",{ref:this.rootDOMRef,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},A.createElement("div",{className:v,style:a,role:"alert"},_&&A.createElement("div",{className:u+"-left"},this.renderIcon()),A.createElement("div",{className:u+"-right"},i&&A.createElement("div",{className:u+"-title"},i),A.createElement("div",{className:u+"-content"},r),l&&A.createElement("div",{className:u+"-btn-wrapper"},l)),y&&(void 0!==f?A.createElement("span",{onClick:this.onClose,className:u+"-close-btn"},f):A.createElement(eK.Z,{prefix:u,className:u+"-close-btn",onClick:this.onClose},A.createElement(ex.P.Provider,{value:p?{prefixCls:p}:{}},A.createElement(eh.Z,null))))))):void 0},e.defaultProps={type:"info",showIcon:!0,noticeType:"message",duration:3e3},e.contextType=eZ.E,e}(A.Component),eQ=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},e0=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))},e1=(0,A.forwardRef)(function(t,e){var i=(0,A.useContext)(eZ.E),r=eQ((0,A.useState)([]),2),n=r[0],s=r[1];function a(t){s(function(e){return e0(e0([],eQ(e),!1),[t],!1)})}function o(t){s(function(e){return e.filter(function(e){return t!==e})})}function l(){return i}return(0,A.useImperativeHandle)(e,function(){return{addInstance:a,removeInstance:o,getContextConfig:l}}),A.createElement(A.Fragment,null,A.Children.map(n,function(t,e){return A.cloneElement(t,{key:e})}))}),e2=function(){return(e2=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};var e3=(d=function(t,e){return(d=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),e5=function(){return(e5=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},e4={};function e8(t){var e,i=e5({position:"top",duration:f},t),r=i.position,n=i.transitionClassNames,s=i.transitionTimeout,a=e4[r]||{},o=a.instance,l=a.pending;if(o||l){var h=function(){var n=(e4[r]||{}).instance,s=n.state.notices,a=s.find(function(e){return e.id===t.id}),o=e5(e5({},i),{update:a});s.length>=p?a?n.add(e5(e5({},o),{id:a.id})):(s.shift(),n.add(o)):e=n.add(o)};o?h():(null==l?void 0:l.then)&&l.then(function(){h(),e4[r].pending=null})}else{var u=document.createElement("div");(m||document.body).appendChild(u),e4[r]={},e4[r].pending=new Promise(function(t){(0,eb.sY)(A.createElement(e6,{transitionClassNames:n,transitionTimeout:s,ref:function(n){!e4[r]&&(e4[r]={}),e4[r].instance=n,e=n.add(i),t(null)}}),u)})}return function(){var t,i;null===(i=null===(t=e4[r])||void 0===t?void 0:t.instance)||void 0===i||i.remove(e)}}var e6=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.remove=function(i){var r=e.state.notices.find(function(t){return t.id===i});r&&e.update(e5(e5({},r),{style:e5(e5({},r.style),{opacity:0})})),setTimeout(function(){t.prototype.remove.call(e,i)},100)},e}return e3(e,t),e.prototype.render=function(){var t=this,e=this.props,i=e.transitionClassNames,r=e.transitionTimeout,n=e.prefixCls,s=e.rtl,a=e.closable,o=this.state,l=o.notices,h=o.position,u=n||g,d=(0,eD.o8)(s)?v:s,c=(0,eD.o8)(a)?y:a,p=u?u+"-message":"arco-message",f={enter:(0,eD.hj)(null==r?void 0:r.enter)?null==r?void 0:r.enter:100,exit:(0,eD.hj)(null==r?void 0:r.exit)?null==r?void 0:r.exit:300},m=(0,eu.Z)(p+"-wrapper",p+"-wrapper-"+h);return A.createElement("div",{className:m},A.createElement(eV,{component:null},l.map(function(e){return A.createElement(eW.Z,{key:e.id,timeout:f,classNames:i||"fadeMessage",onExit:function(t){t&&(t.style.height=t.scrollHeight+"px")},onExiting:function(t){t&&(t.style.height=0)},onExited:function(t){t&&(t.style.height=0,e.onClose&&e.onClose())}},A.createElement(eJ,e5({},e,{prefixCls:p,classPrefixCls:u,iconPrefix:u,onClose:t.remove,noticeType:"message",rtl:d},(0,eD.o8)(c)?{}:{closable:c})))})))},e.config=function(t){void 0===t&&(t={}),(0,eD.hj)(t.maxCount)&&(p=t.maxCount),t.prefixCls&&(g=t.prefixCls),(0,eD.hj)(t.duration)&&(f=t.duration),"boolean"==typeof t.rtl&&(v=t.rtl),"boolean"==typeof t.closable&&(y=t.closable),t.getContainer&&t.getContainer()!==m&&(m=t.getContainer(),Object.values(e4).forEach(function(t){var e=t.instance;return null==e?void 0:e.clear()}),e4={})},e.clear=function(){Object.values(e4).forEach(function(t){var e=t.instance;null==e||e.clear()})},e.addInstance=e8,e}(e$);["info","success","error","warning","loading","normal"].forEach(function(t){e6[t]=function(e){return e8(e5(e5({},"string"==typeof e?{content:e}:e),{type:t}))}}),e6.useMessage=function(t){void 0===t&&(t={});var e,i=t.maxCount,r=t.duration,n=void 0===r?3e3:r,s=t.prefixCls,a=(0,A.createRef)(),o=A.createElement(e1,{ref:a}),l={},h={};return["info","success","warning","error","normal"].forEach(function(t){h[t]=function(r){var o=(0,eD.HD)(r)?{content:r}:r;return function(t){if(a.current){var r,o,h,u=a.current.getContextConfig();o=u.rtl,r=u.prefixCls}var d=s||r,c=e2({position:"top",duration:n},t),p=c.position,g=c.transitionClassNames;if(l[p]){var f=l[p].state.notices;f.length>=i?(h=f[0].id,f.shift(),l[p].add(e2(e2({},c),{id:h}))):h=l[p].add(c)}else e=A.createElement(e9,{transitionClassNames:g,ref:function(t){l[p]=t,l[p]&&(h=l[p].add(c))},prefixCls:d,rtl:o}),a.current.addInstance(e);return function(){l[p]&&l[p].remove(h)}}(e2(e2({},o),{type:t}))}}),[h,o]};let e9=e6;var e7=function(){return(e7=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};var it=(c=function(t,e){return(c=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),ie=function(){return(ie=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},ii={},ir=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.remove=function(i){var r=e.state.notices.find(function(t){return t.id===i});r&&e.update(ie(ie({},r),{style:ie(ie({},r.style),{opacity:0})})),setTimeout(function(){t.prototype.remove.call(e,i)},200)},e}return it(e,t),e.prototype.render=function(){var t,e,i=this,r=this.state.notices,n=this.props,s=n.prefixCls,a=n.rtl,o=n.getContainer,l=this.state.position,h=(0,eD.o8)(a)?k:a;(0,eD.o8)(l)&&(l=h?"topLeft":"topRight");var u=s||b,d=u?u+"-notification":"arco-notification";e="topLeft"===l||"bottomLeft"===l?"slideNoticeLeft":"slideNoticeRight";var c=(0,eu.Z)(d+"-wrapper",d+"-wrapper-"+l,((t={})[d+"-wrapper-rtl"]=k,t)),p=null==o?void 0:o(),g=A.createElement("div",{className:c},A.createElement(eV,{component:null},r.map(function(t){return A.createElement(eW.Z,{key:t.id,timeout:{enter:400,exit:300},classNames:e,onExit:function(t){t&&(t.style.height=t.scrollHeight+"px")},onExiting:function(t){t&&(t.style.height=0)},onExited:function(e){e&&(e.style.height=0,t.onClose&&t.onClose())}},A.createElement(eJ,ie({},t,{onClose:i.remove,prefixCls:d,iconPrefix:u,classPrefixCls:u,noticeType:"notification",rtl:h})))})));return p?(0,eg.createPortal)(g,p):g},e.config=function(t){void 0===t&&(t={}),(0,eD.hj)(t.maxCount)&&(_=t.maxCount),t.prefixCls&&(b=t.prefixCls),(0,eD.hj)(t.duration)&&(x=t.duration),"boolean"==typeof t.rtl&&(k=t.rtl),t.getContainer&&t.getContainer()!==S&&(S=t.getContainer(),Object.values(ii).forEach(function(t){var e=t.instance;return null==e?void 0:e.clear()}),ii={})},e.clear=function(){Object.values(ii).forEach(function(t){var e=t.instance;null==e||e.clear()})},e.remove=function(t){Object.values(ii).forEach(function(e){var i=e.instance;null==i||i.remove(t)})},e.addInstance=function(t){var i=t.position;(0,eD.o8)(t.position)&&(i=k?"topLeft":"topRight");var r=ie({duration:x},t),n=ii[i]||{},s=n.instance,a=n.pending;if(s||a){var o=function(){var e=(ii[i]||{}).instance,n=e.state.notices,s=n.find(function(e){return e.id===t.id}),a=ie(ie({},r),{update:s});return n.length>=_?s?e.add(ie(ie({},a),{id:s.id})):(n.shift(),e.add(a)):e.add(ie({},a)),e};return s?o():(null==a?void 0:a.then)&&a.then(function(){o(),ii[i].pending=null}),s}var l=document.createElement("div");return(S||document.body).appendChild(l),ii[i]={},ii[i].pending=new Promise(function(t){(0,eb.sY)(A.createElement(e,{ref:function(e){return!ii[i]&&(ii[i]={}),ii[i].instance=e,e.add(r),t(null),e}}),l)}),ii[i].instance},e}(e$);["info","success","error","warning","normal"].forEach(function(t){ir[t]=function(e){return ir.addInstance(ie(ie({},e),{type:t}))}}),ir.useNotification=function(t){void 0===t&&(t={});var e,i=t.maxCount,r=t.duration,n=void 0===r?3e3:r,s=t.prefixCls,a=t.getContainer,o=(0,A.createRef)(),l=A.createElement(e1,{ref:o}),h={},u={};return["info","success","warning","error","normal"].forEach(function(t){u[t]=function(r){return function(t){if(o.current){var r,l,u,d=o.current.getContextConfig();l=d.rtl,r=d.prefixCls}var c=s||r,p=t.position;(0,eD.o8)(t.position)&&(p=l?"topLeft":"topRight");var g=e7({duration:n},t);if(h[p]){var f=h[p].state.notices;f.length>=i?(u=f[0].id,f.shift(),h[p].add(e7(e7({},g),{id:u}))):u=h[p].add(g)}else e=A.createElement(is,{ref:function(t){h[p]=t,h[p]&&(u=h[p].add(g))},prefixCls:c,rtl:l,getContainer:a}),o.current.addInstance(e);return h[p]}(e7(e7({},r),{type:t}))}}),[u,l]};let is=ir;var ia=i("4672"),io=i("2888"),il=function(){return(il=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},ih={primaryColor:{default:"--arcoblue-6",hover:"--arcoblue-5",active:"--arcoblue-7"},successColor:{default:"--green-6",hover:"--green-5",active:"--green-7"},infoColor:{default:"--arcoblue-6",hover:"--arcoblue-5",active:"--arcoblue-7"},warningColor:{default:"--orangered-6",hover:"--orangered-5",active:"--orangered-7"},dangerColor:{default:"--red-6",hover:"--red-5",active:"--red-7"}},iu=eZ.G,id={};function ic(t){var e=(0,io.Z)(t,iu,id),i=e.theme,r=e.prefixCls,n=e.children,s=e.locale,a=e.rtl,o=e.effectGlobalNotice,l=void 0===o||o,h=e.effectGlobalModal,u=void 0===h||h;(0,A.useEffect)(function(){!function(t){if(t&&(0,eD.Kn)(t)){var e=document.body;Object.keys(ih).forEach(function(i){t[i]&&(e.style.setProperty(ih[i].default,eF(t[i],0)),!t[i+"Hover"]&&e.style.setProperty(ih[i].hover,eF(t[i],10)),!t[i+"Active"]&&e.style.setProperty(ih[i].active,eF(t[i],-10)))})}}(i)},[i]),(0,A.useEffect)(function(){l&&(e9.config({prefixCls:r,rtl:a}),is.config({prefixCls:r,rtl:a}))},[r,a,l]);var d=il(il({},(0,ia.Z)(e,["children"])),{getPrefixCls:function(t,e){return(e||r)+"-"+t}});(0,A.useEffect)(function(){if(u)eB=eR({},{locale:s,prefixCls:r,rtl:a})},[s,r,a,u]);var c=n;return r&&"arco"!==r&&(c=A.createElement(ex.P.Provider,{value:{prefixCls:r}},n)),A.createElement(eZ.E.Provider,{value:d},c)}ic.ConfigContext=eZ.E,ic.displayName="ConfigProvider";let ip=ic;eZ.E.Consumer;var ig=function(){return(ig=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function im(t){var e=eI,i=e.prefixCls,r=e.simple;return A.createElement(iP,ig({prefixCls:i,simple:r},t),t.content)}var iv=function(t){var e=t.icon;if(!e&&null!==e&&(e=A.createElement(eT,null),t.isNotice))switch(t.noticeType){case"info":e=A.createElement(eA,null);break;case"success":e=A.createElement(ew.Z,null);break;case"warning":e=A.createElement(eT,null);break;case"error":e=A.createElement(eP,null)}return t.isNotice&&(t.hideCancel=!0),t.title=null===e&&null===t.title?null:A.createElement("span",null,e,t.title),t};let iy=function(t,e){var i,r=document.createElement("div");document.body.appendChild(r);var n=eB,s=e||function(t){var e=A.createElement(ip,ig({},n),A.createElement(im,ig({},t,{onCancel:l})));i?i.render(e):i=(0,eb.sY)(e,r)},a=ig(ig({},t),{visible:!1});function o(){i=null==i?void 0:i._unmount(),r.parentNode&&r.parentNode.removeChild(r);for(var t=0;t<eL.length;t++)if(eL[t]===h){eL.splice(t,1);break}}function l(e){!e&&t.onCancel&&t.onCancel(),a.visible=!1,a.afterClose=function(){t.afterClose&&t.afterClose(),o()},s(a)}a.onOk=function(){var e,i=t.onOk||t.onConfirm;i&&(e=i()),e&&e.then&&(a.confirmLoading=!0,s(a),e.then(function(){l(!0)},function(t){console.error(t),a.confirmLoading=!1,s(a)})),!e&&l(!0)},(a=iv(a)).visible=!0,s(a);function h(){a.visible=!1,a.afterClose=function(){t.afterClose&&t.afterClose(),o()},s(a)}return eL.push(h),{close:h,update:function(e){s(a=iv(a=ig(ig(ig({},a),{title:t.title}),e)))}}};var i_=function(){return(i_=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},ib=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};let ix=(0,A.forwardRef)(function(t,e){var i=ib((0,A.useState)(!0),2),r=i[0],n=i[1],s=ib((0,A.useState)(t),2),a=s[0],o=s[1];return(0,A.useImperativeHandle)(e,function(){return{update:function(t){o(t)},close:function(){n(!1)}}}),A.createElement(iP,i_({unmountOnExit:!0,simple:!0},a,{visible:r,onOk:function(){var t=a.onOk&&a.onOk();t&&t.then&&(o(function(t){return i_(i_({},t),{confirmLoading:!0})}),t.then(function(){n(!1)},function(t){console.error(t),o(function(t){return i_(i_({},t),{confirmLoading:!1})})})),!t&&n(!1)},onCancel:function(){a.onCancel&&a.onCancel(),n(!1)}}),a.content)});var iS=function(){return(iS=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},ik=i("3779"),iA=function(){return(iA=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},iw=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},iM=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},iC=null,iT=0;!ed.ET&&document.documentElement.addEventListener("click",function(t){iC={left:t.clientX,top:t.clientY},setTimeout(function(){iC=null},100)},!0);var iE={mask:!0,maskClosable:!0,mountOnEnter:!0,escToExit:!0,getPopupContainer:function(){return document.body},alignCenter:!0},iO=(0,A.forwardRef)(function(t,e){var i,r,n,s,a,o,l,h,u,d=(0,A.useContext)(eZ.E),c=(0,io.Z)(t,iE,null===(u=d.componentConfig)||void 0===u?void 0:u.Modal),p=c.className,g=c.style,f=c.visible,m=c.simple,v=c.title,y=c.children,_=c.cancelText,b=c.okText,x=c.okButtonProps,S=c.cancelButtonProps,k=c.getPopupContainer,w=void 0===k?function(){return document.body}:k,M=c.footer,C=c.afterClose,T=c.confirmLoading,E=c.mountOnEnter,O=c.unmountOnExit,P=c.afterOpen,R=c.hideCancel,B=c.autoFocus,I=c.focusLock,L=c.maskClosable,D=c.mask,F=c.alignCenter,j=c.getChildrenPopupContainer,N=c.wrapClassName,z=c.escToExit,H=c.modalRender,V=c.maskStyle,W=c.wrapStyle,G=c.closeIcon,U=iw(c,["className","style","visible","simple","title","children","cancelText","okText","okButtonProps","cancelButtonProps","getPopupContainer","footer","afterClose","confirmLoading","mountOnEnter","unmountOnExit","afterOpen","hideCancel","autoFocus","focusLock","maskClosable","mask","alignCenter","getChildrenPopupContainer","wrapClassName","escToExit","modalRender","maskStyle","wrapStyle","closeIcon"]),$=(0,A.useRef)(null),Y=(0,A.useRef)(null),K=(0,A.useRef)(null),Z=iM((0,A.useState)(),2),X=Z[0],q=Z[1],J=iM((0,A.useState)(),2),Q=J[0],tt=J[1],te=(0,A.useRef)(null),ti=(0,A.useRef)(!1),tr=(0,A.useRef)(!1),tn=(0,A.useRef)(!0);f&&tn.current&&(tn.current=!1);var ts=(0,A.useRef)();!ts.current&&(ts.current=iT++);var ta=iM((0,ik.Z)(!1,{defaultValue:!1,value:T}),2),to=ta[0],tl=ta[1],th=d.getPrefixCls("modal",c.prefixCls),tu=d.locale,td=d.rtl,tc=!m,tp="closable"in c?c.closable:tc;i=(0,A.useCallback)(function(){return(0,eb.m$)(w())},[w]),r=({hidden:f&&D}).hidden,n=(0,A.useRef)(!1),s=(0,A.useRef)({}),a=function(){var t=i();if(t&&"hidden"!==t.style.overflow){var e,r=t.style;n.current=!0;var a="BODY"===(e=t).tagName?window.innerWidth-(document.body.clientWidth||document.documentElement.clientWidth):e.offsetWidth-e.clientWidth;a&&(s.current.width=r.width,t.style.width="calc("+(t.style.width||"100%")+" - "+a+"px)"),s.current.overflow=r.overflow,t.style.overflow="hidden"}},o=function(){if(n.current&&i()){var t=i(),e=s.current;Object.keys(e).forEach(function(i){return t.style[i]=e[i]})}n.current=!1,s.current={}},(0,A.useEffect)(function(){return r?a():o(),function(){o()}},[i,r]);var tg=function(){c.onCancel&&c.onCancel()},tf=function(t){z&&f&&t.key===ec.AV.key&&(t.stopPropagation(),tg())},tm=(0,A.useRef)(!1),tv=function(t){var e,i=c.onConfirm,r=c.onOk||i;r&&(e=r(t)),e&&e.then&&(tl(!0),e.then(function(){tl(!1)},function(t){tl(!1),console.error(t)}))};(0,A.useEffect)(function(){var t=null;return z&&(t=setTimeout(function(){var t;(0,ed.r3)(document.body,$.current)&&(null===(t=$.current)||void 0===t||t.focus())})),function(){t&&clearTimeout(t)}},[f,z]);var ty=function(){var t;if(f&&void 0===Q&&$.current){var e=+(null===(t=window.getComputedStyle($.current,null))||void 0===t?void 0:t.zIndex);!isNaN(e)&&tt(e+1)}},t_=d.focusLock.modal,tb=!!t_,tx=(0,eD.Kn)(t_)&&t_.autoFocus,tS=void 0!==I?I:tb,tk=void 0!==B?B:tx,tA=A.createElement(ip,iA({},d,{prefixCls:c.prefixCls||d.prefixCls,locale:tu,zIndex:Q||1050,getPopupContainer:function(t){return"function"==typeof j?j(t):Y.current}}),v&&A.createElement("div",{className:th+"-header"},A.createElement("div",{className:th+"-title",id:"arco-dialog-"+ts.current},v)),A.createElement("div",{ref:Y,className:th+"-content"},y),function(){if(null!==M){var t=A.createElement(ep.Z,iA({onClick:tg},S),_||tu.Modal.cancelText),e=A.createElement(ep.Z,iA({loading:to,onClick:tv,type:"primary"},x),b||tu.Modal.okText),i=(0,eD.mf)(M)?M(t,e):M||A.createElement(A.Fragment,null,!R&&t,e);return A.createElement("div",{className:th+"-footer"},i)}}(),tp&&(void 0!==G?A.createElement("span",{onClick:tg,className:th+"-close-icon"},G):A.createElement(eK.Z,{tabIndex:-1,onClick:tg,className:th+"-close-icon",role:"button","aria-label":"Close"},A.createElement(eh.Z,null)))),tw=v?{"aria-labelledby":"arco-dialog-"+ts.current}:{},tM=A.createElement("div",iA({role:"dialog","aria-modal":"true"},tw,{className:(0,eu.Z)(th,((l={})[th+"-simple"]=m,l[th+"-rtl"]=td,l),p),style:g,ref:K}),tS?A.createElement(eo,{crossFrame:!1,disabled:!f,autoFocus:tk,lockProps:{tabIndex:-1,onKeyDown:tf}},tA):A.createElement(A.Fragment,null,tA)),tC=function(t){if(!ti.current){var e="";if(te.current){var i=t.getBoundingClientRect(),r=te.current,n=r.left,s=r.top;e=n-i.left+"px "+(s-i.top)+"px"}t.style.transformOrigin=e}},tT=tn.current?!E:!!K.current;return f||tT?A.createElement(e_,{visible:f,forceRender:tT,getContainer:w},A.createElement("div",{ref:e},D?A.createElement(eW.Z,{in:f,timeout:400,appear:!0,mountOnEnter:E,classNames:"fadeModal",unmountOnExit:O,onEnter:function(t){t&&(t.style.display="block")},onExited:function(t){t&&(t.style.display="none")}},A.createElement("div",{"aria-hidden":!0,className:th+"-mask",style:V})):null,A.createElement("div",iA({},(0,ia.Z)(U,["content","icon","showIcon","isNotice","noticeType","onCancel","onOk","onConfirm","closable","prefixCls"]),{tabIndex:tS&&tk?null:-1,ref:function(t){$.current=t,ty()},className:(0,eu.Z)(th+"-wrapper",((h={})[th+"-wrapper-no-mask"]=!D,h[th+"-wrapper-align-center"]=F,h[th+"-wrapper-rtl"]=td,h),N),style:iA(iA({},W||{}),{display:f||X?"block":"none",overflow:!f&&X?"hidden":""}),onKeyDown:tS&&tk?null:tf,onMouseDown:function(t){tr.current=t.target===t.currentTarget},onClick:function(t){tr.current&&(tr.current=!1,!tm.current&&L&&D&&t.target===t.currentTarget&&setTimeout(function(){tg()},100))}}),A.createElement(eW.Z,{in:f,timeout:400,appear:!0,classNames:"zoomModal",unmountOnExit:O,mountOnEnter:E,onEnter:function(t){t&&(q(!0),te.current=iC,ti.current=!!t.style.transformOrigin,tC(t),K.current=t)},onEntered:function(t){t&&(tC(t),te.current=null,null==P||P())},onExit:function(){tm.current=!0},onExited:function(t){t&&(q(!1),tC(t),null==C||C(),tm.current=!1,O&&(K.current=null))}},A.cloneElement((0,eD.mf)(H)?H(tM):tM,{onMouseDown:function(){tr.current=!1},onMouseUp:function(){tr.current=!1}}))))):null});iO.displayName="Modal",iO.config=function(t){eI=eR(eR({},eI),t)},iO.confirm=function(t){return iy(t)},iO.useModal=function(){var t=(0,A.useRef)(),e=A.createElement(e1,{ref:t}),i=0;function r(e){i+=1;var r,n=(0,A.createRef)(),s=iS({},e),a=A.createElement(ix,iS({key:i,ref:n},iv(iS({},e)),{afterClose:function(){e.afterClose&&e.afterClose(),function(){var e;null===(e=t.current)||void 0===e||e.removeInstance(a)}()}}));null===(r=t.current)||void 0===r||r.addInstance(a);function o(){var t;null===(t=n.current)||void 0===t||t.close()}return eL.push(o),{close:o,update:function(t){var e;s=iS(iS({},s),t),null===(e=n.current)||void 0===e||e.update(iv(iS({},s)))}}}var n={confirm:function(t){return r(iS({},t))}};return["info","success","warning","error"].forEach(function(t){n[t]=function(e){return r(iS(iS({},e),{isNotice:!0,noticeType:t}))}}),[n,e]},["info","success","warning","error"].forEach(function(t){iO[t]=function(e){return iy(iA(iA({},e),{isNotice:!0,noticeType:t}))}}),iO.destroyAll=function(){for(;eL.length;){var t=eL.pop();t&&t()}};let iP=iO,iR=iP},5239:function(t,e,i){"use strict";i("4290"),i("8718")},480:function(t,e,i){"use strict";i.d(e,{Z:()=>F});var r=i("4194"),n=i("4672"),s=i("2315"),a=i("8429"),o=i("4151"),l=i("6464"),h=i("8929"),u=i("4887"),d=i("4716"),c=i("9743"),p=function(){return(p=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},g=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},f=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};function m(t){var e,i,a=t.children,o=t.style,l=t.className,m=t.prefixCls,v=t.droplist,y=t.dropdownProps,_=t.href,b=t.onClick,x=t.tagName,S=g(t,["children","style","className","prefixCls","droplist","dropdownProps","href","onClick","tagName"]),k=f((0,r.useState)(!1),2),A=k[0],w=k[1],M=(0,c.HD)(_)?"a":void 0===x?"div":x,C=r.createElement(M,p({href:_,onClick:b,role:"listitem",style:o,className:(0,s.Z)(m+"-item",((e={})[m+"-item-with-dropdown"]=v,e),l)},(0,h.m)(S)),a,v&&r.createElement("span",{"aria-hidden":!0,className:(0,s.Z)(m+"-item-dropdown-icon",((i={})[m+"-item-dropdown-icon-active"]=A,i))},r.createElement(d.Z,null)));return v?r.createElement(u.Z,p({droplist:v,onVisibleChange:function(t){w(t),y&&y.onVisibleChange&&y.onVisibleChange(t)}},(0,n.Z)(y,["onVisibleChange"])),C):C}m.displayName="BreadcrumbItem";var v=i("7287"),y=i("9933"),_=i("8336"),b=i("5296");function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function S(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach(function(e){(0,_.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var k=r.forwardRef(function(t,e){var i=(0,r.useContext)(b.P).prefixCls,n=void 0===i?"arco":i,s=t.spin,a=t.className,o=S(S({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(a?a+" ":"").concat(n,"-icon ").concat(n,"-icon-oblique-line")});return s&&(o.className="".concat(o.className," ").concat(n,"-icon-loading")),delete o.spin,delete o.isIcon,r.createElement("svg",(0,y.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),r.createElement("path",{d:"M29.506 6.502 18.493 41.498"}))});k.defaultProps={isIcon:!0},k.displayName="IconObliqueLine";var A=i("2888"),w=function(){return(w=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},M=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},C=function(t,e,i){return e.indexOf(t)===e.length-1?r.createElement("span",null,t.breadcrumbName):r.createElement("a",{href:"#/"+i.join("/").replace(/^\//,"")},t.breadcrumbName)},T={separator:r.createElement(k,null)},E=(0,r.forwardRef)(function(t,e){var i,o,l,h,u,d=(0,r.useContext)(a.E),p=d.getPrefixCls,g=d.componentConfig,f=d.rtl,y=(0,A.Z)(t,T,null==g?void 0:g.Breadcrumb),_=y.className,b=y.children,x=y.style,S=y.routes,k=y.maxCount,E=y.separator,O=M(y,["className","children","style","routes","maxCount","separator"]),P=p("breadcrumb"),R="itemRender"in y?y.itemRender:C,B=r.createElement("span",{"aria-label":"ellipses of breadcrumb items",className:P+"-item-ellipses"},"..."),I=r.createElement("span",{"aria-hidden":!0,className:P+"-item-separator"},E),L=function(t,e,i){var n=r.cloneElement(I,{key:i+"_separator"});if(e>0)return 0===i?[t,n,B]:i>e?[n,t]:null;return 0===i?[t]:[n,t]};return r.createElement("div",w({role:"list",ref:e,style:x,className:(0,s.Z)(P,((u={})[P+"-rtl"]=f,u),_)},(0,n.Z)(O,["itemRender"])),S&&S.length?(i=[],o=S.length-k,S.map(function(t,e){i.push((t.path||"").replace(/^\//,""));var n=t.children?r.createElement(v.Z,null,t.children.map(function(t){return r.createElement(v.Z.Item,{key:t.path||t.breadcrumbName},R(t,S,i))})):null;return L(r.createElement(m,{prefixCls:P,key:t.path||t.breadcrumbName,droplist:n},R(t,S,i)),o,e)})):(l=[],r.Children.forEach(b,function(t){!(0,c.U$)(t)&&l.push(t)}),h=l.length-k,r.Children.map(l,function(t,e){return L(r.cloneElement(t,{prefixCls:P}),h,e)})))});E.displayName="Breadcrumb",E.Item=m;var O=i("2920"),P=i("263"),R=i("8569"),B=function(){return(B=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},I=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},L=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};function D(t){var e,i,h=(0,r.useContext)(a.E),u=h.getPrefixCls,d=h.componentConfig,c=h.rtl,p=(0,A.Z)(t,{},null==d?void 0:d.PageHeader),g=p.title,f=p.subTitle,m=p.extra,v=p.children,y=p.backIcon,_=p.footer,b=p.breadcrumb,x=I(p,["title","subTitle","extra","children","backIcon","footer","breadcrumb"]),S=(0,R.Z)(),k=L((0,r.useState)(!1),2),w=k[0],M=k[1],C=(0,r.useRef)(),T=u("page-header");return r.createElement(P.Z,{onResize:function(){C.current&&M(C.current.offsetWidth<768)},getTargetDOMNode:function(){return C.current}},r.createElement("div",B({},(0,n.Z)(x,["onBack"]),{ref:C,className:(0,s.Z)(""+T,((e={})[T+"-with-breadcrumb"]=b,e[T+"-with-content"]=v,e[T+"-with-footer"]=_,e[T+"-wrap"]=w,e[T+"-rtl"]=c,e),p.className),style:p.style}),r.createElement("div",{className:T+"-head-wrapper"},b&&r.createElement(E,B({},b)),r.createElement("div",{className:T+"-head"},r.createElement("div",{className:(0,s.Z)(T+"-head-main",((i={})[T+"-head-main-with-back"]=y,i))},y&&r.createElement(O.Z,B({prefix:T,tabIndex:0,role:"button",className:T+"-back",onClick:p.onBack},S({onPressEnter:p.onBack})),r.createElement("span",{className:T+"-back-icon"},!0===y?c?r.createElement(l.Z,null):r.createElement(o.Z,null):y)),g&&r.createElement("div",{className:T+"-title"},g),f&&r.createElement(r.Fragment,null,r.createElement("div",{className:T+"-divider"}),r.createElement("div",{className:T+"-sub-title"},f))),m&&r.createElement("div",{className:T+"-head-extra"},m))),v&&r.createElement("div",{className:T+"-content"},v),_&&r.createElement("div",{className:T+"-footer"},_)))}D.displayName="PageHeader";let F=D},2994:function(t,e,i){"use strict";i("7236"),i("4290")},2666:function(t,e,i){"use strict";i.d(e,{Z:()=>p});var r=i("4194"),n=i("2315"),s=i("8429"),a=i("9743"),o=i("2888"),l=i("7101"),h=function(){return(h=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},u=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},d={size:"small",direction:"horizontal"},c=(0,r.forwardRef)(function(t,e){var i,c=(0,r.useContext)(s.E),p=c.getPrefixCls,g=c.componentConfig,f=c.rtl,m=(0,o.Z)(t,d,null==g?void 0:g.Space),v=m.className,y=m.style,_=m.children,b=m.size,x=m.direction,S=m.align,k=m.wrap,A=m.split,w=u(m,["className","style","children","size","direction","align","wrap","split"]),M=p("space"),C=S||("horizontal"===x?"center":""),T=(0,n.Z)(M,((i={})[M+"-"+x]=x,i[M+"-align-"+C]=C,i[M+"-wrap"]=k,i[M+"-rtl"]=f,i),v);function E(t){if((0,a.hj)(t))return t;switch(t){case"mini":return 4;case"small":default:return 8;case"medium":return 16;case"large":return 24}}var O=function t(e){var i=[];return r.Children.forEach(e,function(e){(0,l.isFragment)(e)&&e.props?i=i.concat(t(e.props.children)):null!=e&&i.push(e)}),i}(_);return r.createElement("div",h({ref:e,className:T,style:y},w),O.map(function(t,e){var i=(null==t?void 0:t.key)||e,n=null!=A&&e>0;return r.createElement(r.Fragment,{key:i},n&&r.createElement("div",{className:M+"-item-split"},A),r.createElement("div",{className:M+"-item",style:function(t){var e,i,r,n,s=O.length===t+1,o=f?"marginLeft":"marginRight";if("string"==typeof b||"number"==typeof b){var l=E(b);return k?s?{marginBottom:l}:((e={})[""+o]=l,e.marginBottom=l,e):s?{}:((i={})["vertical"===x?"marginBottom":o]=l,i)}if((0,a.kJ)(b)){var h=E(b[0]),u=E(b[1]);return k?s?{marginBottom:u}:((r={})[""+o]=h,r.marginBottom=u,r):"vertical"===x?{marginBottom:u}:((n={})[""+o]=h,n)}}(e)},t))}))});c.displayName="Space";let p=c},8490:function(t,e,i){"use strict";i("4290")},9542:function(t,e,i){"use strict";i.d(e,{Z:function(){return m}});var r=i(4194),n=i(2315),s=i(9745),a=i(8429),o=i(8929),l=i(2888),h=i(9743),u=function(){return(u=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},d=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},c={position:"top",trigger:"hover",escToClose:!1,unmountOnExit:!0,blurToHide:!0,popupHoverStay:!0},p={enter:300,exit:100},g={left:12,right:12,top:12,bottom:12},f=(0,r.forwardRef)(function(t,e){var i=(0,r.useContext)(a.E),f=i.getPrefixCls,m=i.componentConfig,v=(0,l.Z)(t,c,null==m?void 0:m.Tooltip),y=v.style,_=v.className,b=v.children,x=v.trigger,S=v.escToClose,k=v.defaultPopupVisible,A=v.position,w=v.unmountOnExit,M=v.popupVisible,C=v.prefixCls,T=v.blurToHide,E=v.popupHoverStay,O=v.disabled,P=v.onVisibleChange,R=v.triggerProps,B=v.childrenPrefix,I=v.getPopupContainer,L=v.content,D=v.mini,F=v.color,j=d(v,["style","className","children","trigger","escToClose","defaultPopupVisible","position","unmountOnExit","popupVisible","prefixCls","blurToHide","popupHoverStay","disabled","onVisibleChange","triggerProps","childrenPrefix","getPopupContainer","content","mini","color"]),N=(0,r.useRef)(),z=function(t,e){void 0===t&&(t=0),N.current&&N.current.updatePopupPosition(t,e)};(0,r.useImperativeHandle)(e,function(){return{updatePopupPosition:z,getRootDOMNode:function(){var t,e;return null===(e=null===(t=N.current)||void 0===t?void 0:t.getRootDOMNode)||void 0===e?void 0:e.call(t)}}},[]);var H=C||f("tooltip"),V=u(u(u(u({},(0,o.Z)(j,s.C)),(0,o.m)(j)),R),{className:(0,n.Z)(_,null==R?void 0:R.className)}),W=(0,h.mf)(L)?L():L;return"popupVisible"in v?V.popupVisible=M:(0,h.U$)(W,!0)&&(V.popupVisible=!1),(!1!==V.showArrow||V.arrowProps)&&(V.arrowProps=V.arrowProps||{},F&&(V.arrowProps.style=u({backgroundColor:F},V.arrowProps.style))),r.createElement(s.Z,u({style:u({maxWidth:350},y),ref:N,classNames:"zoomInFadeOut",duration:p,popup:function(){var t;return r.createElement("div",{style:{backgroundColor:F},className:(0,n.Z)(H+"-content",H+"-content-"+A,((t={})[H+"-mini"]=D,t)),role:"tooltip"},r.createElement("div",{className:H+"-content-inner"},W))},position:A,disabled:O,trigger:x,escToClose:S,showArrow:!0,popupAlign:g,mouseEnterDelay:200,mouseLeaveDelay:200,unmountOnExit:w,popupHoverStay:E,blurToHide:T,childrenPrefix:B||H,getPopupContainer:I,onVisibleChange:P,defaultPopupVisible:k},V),b)});f.displayName="Tooltip";let m=f},3654:function(t,e,i){"use strict";i("4290"),i("5146")},9745:function(t,e,i){"use strict";i.d(e,{C:()=>O,Z:()=>R});var r,n=i("4194"),s=i("759"),a=i("8977"),o=i("98"),l=i("6132"),h=i("9743"),u=i("8929"),d=i("8564"),c=i("6321"),p=i("992");let g=function(t){var e=t.getContainer,i=t.children,r=(0,n.useRef)();return((0,p.Z)()||null===r.current)&&!l.ET&&(r.current=e()),(0,n.useEffect)(function(){return function(){var t=r.current;t&&t.parentNode&&(t.parentNode.removeChild(t),r.current=null)}},[]),r.current?c.createPortal(i,r.current):null};var f=i("263"),m=i("2315"),v=i("8429"),y=function(){return(y=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},_=function(t,e){var i,r,n,s,a=e.position,o=t.getBoundingClientRect(),l=o.width,h=o.height,u=o.left,d=o.right,c=o.top,p=o.bottom,g=e.boundaryDistance||{},f="left"in g&&g.left||0,m="top"in g&&g.top||0;return["bottom","bl","br"].indexOf(a)>-1?(n=c,s=p):(n=c-m,s=p-m),["right","rt","rb"].indexOf(a)>-1?(i=u,r=d):(i=u-f,r=d-f),{width:l,height:h,left:i,right:r,top:n,bottom:s}},b=function(t,e,i){return i<t?t:i>e?e:i},x=function(t,e){var i=0,r=0,n={};for(var s in n=e?y({left:12,right:12,top:12,bottom:12},t):y({},t))if((0,h.kJ)(n[s])){var a=0;["top","bottom"].indexOf(s)>-1?(a=1,i=n[s][0]):r=n[s][1],n[s]=n[s][a]}return y(y({},n),{horizontalOffset:i,verticalOffset:r})},S=function(t,e,i){var r=i.boundaryDistance,n=i.position;return e?{left:e.clientX,top:e.clientY,width:0,height:0,right:e.clientX,bottom:e.clientY}:_(t,{boundaryDistance:r,position:n})},k=function(t){var e,i,r=t||{},n="left"in r?r.left:"right"in r?r.right:0,s="top"in r?r.top:"bottom"in r?r.bottom:0;return{windowHeight:((null===(e=document.documentElement)||void 0===e?void 0:e.clientHeight)||window.innerHeight)-(s||0),windowWidth:((null===(i=document.documentElement)||void 0===i?void 0:i.clientWidth)||window.innerWidth)-(n||0)}};let A=function(t,e,i,r,n){var s,a=t.autoAlignPopupWidth,o=t.autoAlignPopupMinWidth,h=t.alignPoint,u=t.style;if(!i||!e||!r)return{};var d={},c=!t.alignPoint&&t.boundaryDistance||{},p=S(i,h&&n,{boundaryDistance:c,position:t.position}),g=function(t,e,i,r){if(!i||!t||l.ET)return{left:0,width:0,height:0,top:0};var n=function(t){return document.documentElement[t]||document.body[t]},s=i===document.body?n("scrollTop"):i.scrollTop,a=i===document.body?n("scrollLeft"):i.scrollLeft,o=e.left,h=e.top,u=e.width,d=e.height,c=i===document.body?0:_(i,r).left,p=i===document.body?0:_(i,r).top;return{left:o+a-c,top:h+s-p,width:u,height:d}}(i,p,r,{boundaryDistance:c,position:t.position}),f=g.left,m=g.top,v=g.width,y=g.height,A=x(t.popupAlign,t.showArrow),w=A.left||0,M=A.right||0,C=A.top||0,T=A.bottom||0;a&&(null==u?void 0:u.width)===void 0&&(e.style.width=i.offsetWidth+"px"),o&&(e.style.minWidth=i.offsetWidth+"px");var E={width:(s=e).offsetWidth,height:s.offsetHeight},O=t.position,P={},R=function(e){if(!!t.autoFitPosition){var i=k(c),n=i.windowHeight,s=i.windowWidth,a=!1,o={left:f-p.left,top:m-p.top},l=d.top,h=void 0===l?0:l,u=d.left,g=void 0===u?0:u;if(("top"===e||"bottom"===e)&&(o.left>g&&p.right>12?(d.left=Math.max(o.left,f-E.width),d.left=Math.max(d.left,f-E.width+24)):g-o.left+E.width>s&&s-p.left>12&&(d.left=Math.max(o.left,o.left+s-E.width),d.left=Math.max(d.left,f-E.width+24))),("left"===e||"right"===e)&&(o.top>h&&p.bottom>12?(d.top=o.top,d.top=Math.max(d.top,m-E.height+p.height/2)):h-o.top+E.height>n&&n-p.top>12&&(d.top=Math.max(o.top,o.top+n-E.height),d.top=Math.max(d.top,m-E.height+p.height/2))),"top"===e&&o.top>h&&(p.top<n-p.bottom?(d.top=Math.min(m+y+(C||0),o.top+n-E.height),a=!0):d.top=o.top),"bottom"===e&&h-o.top+E.height>n&&(n-p.bottom<p.top?(d.top=Math.max(m-E.height-(T||0),o.top),a=!0):d.top=o.top+n-E.height),"left"===e&&o.left>g&&(p.left<s-p.right?(d.left=Math.min(v+f+M,o.left+s-E.width),a=!0):d.left=o.left),"right"===e&&g-o.left+E.width>s&&(s-p.right<p.left?(d.left=Math.max(f-E.width-w,o.left),a=!0):d.left=o.left+s-E.width),d.left<0)d.left=0;else{var _=r.scrollWidth-E.width;d.left=Math.min(_,d.left)}return a}},B=A.horizontalOffset||0,I=A.verticalOffset||0;switch(t.position){case"top":d.top=m-E.height-C,d.left=f+v/2-E.width/2,R("top")&&(O="bottom"),d.left+=B;var L=f-Number(d.left)+v/2;P.left=b(12,E.width-12,L);break;case"tl":d.top=m-E.height-C,d.left=f,R("top")&&(O="bl"),d.left+=B;var D=f-Number(d.left)+Math.min(v/2,50);P.left=b(12,E.width-12,D);break;case"tr":d.top=-e.clientHeight+m-C,d.left=f+v-E.width,R("top")&&(O="br"),d.left+=B,D=f-Number(d.left)+Math.max(v/2,v-50),P.left=b(12,E.width-12,D);break;case"bottom":d.top=y+m+T,d.left=f+v/2-E.width/2,R("bottom")&&(O="top"),d.left+=B;var F=f-Number(d.left)+v/2;P.left=b(12,E.width-12,F);break;case"bl":d.top=y+m+T,d.left=f,R("bottom")&&(O="tl"),d.left+=B,D=f-Number(d.left)+Math.min(v/2,50),P.left=b(12,E.width-12,D);break;case"br":d.top=y+m+T,d.left=f+v-E.width,R("bottom")&&(O="tr"),d.left+=B,D=f-Number(d.left)+Math.max(v/2,v-50),P.left=b(12,E.width-12,D);break;case"left":d.top=m+y/2-E.height/2,d.left=f-E.width-w,R("left")&&(O="right"),d.top+=I;var j=m-Number(d.top)+y/2;P.top=b(12,E.height-12,j);break;case"lt":d.top=m,d.left=f-E.width-w,R("left")&&(O="rt"),d.top+=I;var N=m-Number(d.top)+Math.min(y/2,50);P.top=b(12,E.height-12,N);break;case"lb":d.top=m+y-E.height,d.left=f-E.width-w,R("left")&&(O="rb"),d.top+=I,N=m-Number(d.top)+Math.max(y/2,y-50),P.top=b(12,E.height-12,N);break;case"right":d.top=m+y/2-E.height/2,d.left=v+f+M,R("right")&&(O="left"),d.top+=I;var z=m-Number(d.top)+y/2;P.top=b(12,E.height-12,z);break;case"rt":d.top=m,d.left=v+f+M,R("right")&&(O="lt"),d.top+=I,N=m-Number(d.top)+Math.min(y/2,50),P.top=b(12,E.height-12,N);break;case"rb":d.top=m+y-E.height,d.left=v+f+M,R("right")&&(O="lb"),d.top+=I,N=m-Number(d.top)+Math.max(y/2,y-50),P.top=b(12,E.height-12,N)}return{style:d,arrowStyle:P,realPosition:O}};var w=i("9968"),M=i("3520");var C=(r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),T=function(){return(T=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function E(t,e){if(!t)return{};var i=_(t,e);return{width:i.width,height:i.height,left:i.left,right:i.right}}var O=["onClick","onMouseEnter","onMouseLeave","onMouseMove","onFocus","onBlur","onContextMenu","onKeyDown"],P={blurToHide:!0,classNames:"fadeIn",trigger:"hover",position:"bottom",duration:200,unmountOnExit:!0,popupAlign:{},popupHoverStay:!0,clickOutsideToClose:!0,escToClose:!1,mouseLeaveToClose:!0,containerScrollToClose:!1,getDocument:function(){return window.document},autoFixPosition:!0,mouseEnterDelay:100,mouseLeaveDelay:100,autoFitPosition:!0};let R=function(t){function e(e,i){var r=t.call(this,e,i)||this;r.delayTimer=null,r.updatePositionTimer=null,r.popupOpen=!1,r.mousedownToHide=!1,r.hasPopupMouseDown=!1,r.unmount=!1,r.isDidMount=!1,r.mouseLocation={clientX:0,clientY:0},r.observerContainer=null,r.scrollElements=null,r.resizeObserver=new s.Z(function(){r.handleUpdatePosition()}),r.childrenDom=null,r.childrenDomSize={},r.getMergedProps=function(t){var e,i,n,s,a,o,l,u,d,c=r.context.componentConfig;return e=t&&(0,h.Kn)(t)?t:r.props,i=P,n=null==c?void 0:c.Trigger,s=t&&(0,h.kJ)(t)?t:void 0,a=i||{},o=n||{},l=e||{},u=new Set(s?s:Object.keys(l).concat(Object.keys(a)).concat(Object.keys(o))),d={},u.forEach(function(t){void 0!==l[t]?d[t]=l[t]:t in o?d[t]=o[t]:t in a&&(d[t]=a[t])}),d},r.getRootElement=function(){var t,e;return r.childrenDom=(0,o.m$)((null===(e=(t=r.props).getTargetDOMNode)||void 0===e?void 0:e.call(t))||r.rootElementRef,r),r.childrenDom},r.getPopupElement=function(){var t;return(null===(t=r.triggerRef)||void 0===t?void 0:t.current)||null},r.offScrollListeners=function(){(r.scrollElements||[]).forEach(function(t){(0,l.S1)(t,"scroll",r.handleScroll)}),r.scrollElements=null},r.offWindowResize=function(){r.handleWindowResize=!1,(0,l.S1)(window,"resize",r.handleUpdatePosition)},r.offContainerResize=function(){r.resizeObserver&&r.observerContainer&&(r.resizeObserver.unobserve(r.observerContainer),r.observerContainer=null)},r.handleScroll=function(){var t=r.getMergedProps(["containerScrollToClose","updateOnScroll"]);t.containerScrollToClose?r.setPopupVisible(!1):t.updateOnScroll&&r.handleUpdatePosition()},r.onContainersScroll=function(t){var e,i;if(!r.scrollElements)r.scrollElements=(0,l.IF)(r.childrenDom,null===(e=r.popupContainer)||void 0===e?void 0:e.parentNode),t.containerScrollToClose&&(null===(i=r.popupContainer)||void 0===i?void 0:i.parentNode)===document.body&&-1===r.scrollElements.indexOf(document.body)&&(0,l.Ib)(document.documentElement)&&r.scrollElements.push(window),r.scrollElements.forEach(function(t){(0,l.on)(t,"scroll",r.handleScroll)})},r.onContainerResize=function(){var t,e=null===(t=r.popupContainer)||void 0===t?void 0:t.parentNode;r.resizeObserver&&r.observerContainer!==e&&(r.offContainerResize(),e&&r.resizeObserver.observe(e),r.observerContainer=e)},r.handleUpdatePosition=(0,w.Z)(function(){r.updatePopupPosition()}),r.isClickTrigger=function(){return[].concat(r.getMergedProps(["trigger"]).trigger).indexOf("click")>-1},r.isFocusTrigger=function(){return[].concat(r.getMergedProps(["trigger"]).trigger).indexOf("focus")>-1},r.isHoverTrigger=function(){return[].concat(r.getMergedProps(["trigger"]).trigger).indexOf("hover")>-1},r.isContextMenuTrigger=function(){return[].concat(r.getMergedProps(["trigger"]).trigger).indexOf("contextMenu")>-1},r.isMouseLeaveToClose=function(){return r.isHoverTrigger()&&r.getMergedProps(["mouseLeaveToClose"]).mouseLeaveToClose},r.isPopupHoverHide=function(){return r.isHoverTrigger()&&!r.getMergedProps(["popupHoverStay"]).popupHoverStay},r.isClickToHide=function(){if(r.isClickTrigger()||r.isContextMenuTrigger()){var t=r.getMergedProps(["clickToClose"]).clickToClose;return void 0===t||t}return r.isHoverTrigger()&&r.props.clickToClose},r.isBlurToHide=function(){return r.isFocusTrigger()&&r.getMergedProps(["blurToHide"]).blurToHide},r.clearTimer=function(){r.updatePositionTimer&&(r.updatePositionTimer.cancel?r.updatePositionTimer.cancel():(clearTimeout(r.updatePositionTimer),r.updatePositionTimer=null)),r.delayTimer&&(clearTimeout(r.delayTimer),r.delayTimer=null),r.mouseDownTimeout&&(clearTimeout(r.mouseDownTimeout),r.mouseDownTimeout=null)},r.offClickOutside=function(){if(r.handleClickOutside){var t=r.getMergedProps(["getDocument"]).getDocument,e=(0,h.mf)(t)&&t();(0,l.S1)(e,"mousedown",r.onClickOutside),r.handleClickOutside=!1}},r.getTransformOrigin=function(t){var e,i,n=r.getPopupElement();if(!n)return{};var s=r.getMergedProps(["showArrow","classNames"]),a=s.showArrow,o=s.classNames,l=a&&(null===(e=r.arrowStyle)||void 0===e?void 0:e.top)||0,h=a&&(null===(i=r.arrowStyle)||void 0===i?void 0:i.left)||0;l=l?l+"px":"";var u={top:((h=h?h+"px":"")||"50%")+" 100% 0",tl:(h||"15px")+" 100% 0",tr:(h||n.clientWidth-15+"px")+" 100% 0",bottom:(h||"50%")+" 0 0",bl:(h||"15px")+" 0 0",br:(h||n.clientWidth-15+"px")+" 0 0",left:"100% "+(l||"50%")+" 0",lt:"100% "+(l||"15px")+" 0",lb:"100% "+(l||n.clientHeight-15+"px")+" 0",right:"0 "+(l||"50%")+" 0",rt:"0 "+(l||"15px")+" 0",rb:"0 "+(l||n.clientHeight-15+"px")+" 0"};if(o&&o.indexOf("zoom")>-1)return{transformOrigin:u[t]};if("slideDynamicOrigin"===o){var d="0% 0%";return["top","tl","tr"].indexOf(t)>-1&&(d="100% 100%"),{transformOrigin:d}}return{}},r.getTransformTranslate=function(){if("slideDynamicOrigin"!==r.getMergedProps(["classNames"]).classNames)return"";switch(r.realPosition){case"bottom":case"bl":case"br":return"scaleY(0.9) translateY(-4px)";case"top":case"tl":case"tr":return"scaleY(0.9) translateY(4px)";default:return""}},r.getPopupStyle=function(){if(!r.unmount&&!!r.popupContainer){var t=r.popupContainer,e=r.triggerRef.current,i=r.getRootElement();if(!i.offsetParent&&!i.getClientRects().length)return r.state.popupStyle;var n=r.getMergedProps(),s=A(n,e,i,t,r.mouseLocation),a=s.style,o=s.arrowStyle,l=s.realPosition;return r.realPosition=l||n.position,r.arrowStyle=o||{},T(T({},a),r.getTransformOrigin(r.realPosition))}},r.showPopup=function(t){void 0===t&&(t=function(){});var e=r.getPopupStyle();r.setState({popupStyle:e},t)},r.update=(0,w.Z)(function(t){if(!r.unmount&&!!r.state.popupVisible){var e=r.getPopupStyle();r.setState({popupStyle:e},function(){null==t||t()})}}),r.getRootDOMNode=function(){return r.getRootElement()},r.updatePopupPosition=function(t,e){if(void 0===t&&(t=0),!!r.state.popupVisible){if(t<4){r.updatePositionTimer=r.update(e);return}r.updatePositionTimer=setTimeout(function(){var t=r.getPopupStyle();r.setState({popupStyle:t},function(){null==e||e()})},t)}},r.setPopupVisible=function(t,e,i){void 0===e&&(e=0);var n=r.getMergedProps(["onVisibleChange","popupVisible"]),s=n.onVisibleChange;t!==r.state.popupVisible?r.delayToDo(e,function(){s&&s(t),"popupVisible"in n?null==i||i():t?r.setState({popupVisible:!0},function(){r.showPopup(i)}):r.setState({popupVisible:!1},function(){null==i||i()})}):null==i||i()},r.delayToDo=function(t,e){t?(r.clearDelayTimer(),r.delayTimer=setTimeout(function(){e(),r.clearDelayTimer()},t)):e()},r.onClickOutside=function(t){var e=r.getMergedProps(["onClickOutside","clickOutsideToClose"]),i=e.onClickOutside,n=e.clickOutsideToClose,s=r.getPopupElement(),a=r.getRootElement();!(0,l.r3)(s,t.target)&&!(0,l.r3)(a,t.target)&&!r.hasPopupMouseDown&&(null==i||i(),n&&!r.isBlurToHide()&&!r.isHoverTrigger()&&r.setPopupVisible(!1))},r.onKeyDown=function(t){var e=t.keyCode||t.which;r.triggerPropsEvent("onKeyDown",t),e===d.AV.code&&r.onPressEsc(t)},r.onPressEsc=function(t){r.getMergedProps(["escToClose"]).escToClose&&t&&t.key===d.AV.key&&r.state.popupVisible&&r.setPopupVisible(!1)},r.onMouseEnter=function(t){var e=r.getMergedProps(["mouseEnterDelay"]).mouseEnterDelay;r.triggerPropsEvent("onMouseEnter",t),r.clearDelayTimer(),r.setPopupVisible(!0,e||0)},r.onMouseMove=function(t){r.triggerPropsEvent("onMouseMove",t),r.setMouseLocation(t),r.state.popupVisible&&r.update()},r.onMouseLeave=function(t){var e=r.getMergedProps(["mouseLeaveDelay"]).mouseLeaveDelay;r.clearDelayTimer(),r.triggerPropsEvent("onMouseLeave",t),r.isMouseLeaveToClose()&&r.state.popupVisible&&r.setPopupVisible(!1,e||0)},r.onPopupMouseEnter=function(){r.clearDelayTimer()},r.onPopupMouseLeave=function(t){r.onMouseLeave(t)},r.setMouseLocation=function(t){r.getMergedProps(["alignPoint"]).alignPoint&&(r.mouseLocation={clientX:t.clientX,clientY:t.clientY})},r.onContextMenu=function(t){t.preventDefault(),r.triggerPropsEvent("onContextMenu",t),r.setMouseLocation(t),r.state.popupVisible?r.getMergedProps(["alignPoint"]).alignPoint&&r.update():r.setPopupVisible(!0,0)},r.clickToHidePopup=function(t){var e=r.state.popupVisible;e&&(r.mousedownToHide=!0),r.triggerPropsEvent("onClick",t),r.isClickToHide()&&e&&r.setPopupVisible(!e,0)},r.onClick=function(t){var e=r.state.popupVisible;if(e&&(r.mousedownToHide=!0),r.triggerPropsEvent("onClick",t),r.setMouseLocation(t),!!r.isClickToHide()||!e)r.setPopupVisible(!e,0)},r.onFocus=function(t){var e=r.getMergedProps(["focusDelay"]).focusDelay,i=function(){r.triggerPropsEvent("onFocus",t)};r.clearDelayTimer(),!r.mousedownToHide&&(r.state.popupVisible?null==i||i():r.setPopupVisible(!0,e||0,i)),r.mousedownToHide=!1},r.onBlur=function(t){r.setPopupVisible(!1,200,function(){return r.triggerPropsEvent("onBlur",t)})},r.onResize=function(){r.getMergedProps(["autoFixPosition"]).autoFixPosition&&r.state.popupVisible&&r.updatePopupPosition()},r.onPopupMouseDown=function(){r.hasPopupMouseDown=!0,clearTimeout(r.mouseDownTimeout),r.mouseDownTimeout=setTimeout(function(){r.hasPopupMouseDown=!1},0)},r.getChild=function(){var t,e=r.props.children,i=e&&"string"!=typeof e&&e.type,s=e;if(["string","number"].indexOf(typeof e)>-1||n.Children.count(e)>1)s=n.createElement("span",null,e);else if(e&&i&&(!0===i.__BYTE_BUTTON||!0===i.__BYTE_CHECKBOX||!0===i.__BYTE_SWITCH||!0===i.__BYTE_RADIO||"button"===i)&&e.props.disabled){var a,o,l,h,u=(a=e.props.style,o=["position","left","right","top","bottom","float","display","zIndex"],l={},h=T({},a),o.forEach(function(t){a&&t in a&&(l[t]=a[t],delete h[t])}),{picked:l,omitted:h}),d=u.picked,c=u.omitted;s=n.createElement("span",{className:null===(t=e.props)||void 0===t?void 0:t.className,style:T(T({display:"inline-block"},d),{cursor:"not-allowed"})},n.cloneElement(e,{style:T(T({},c),{pointerEvents:"none"}),className:void 0}))}return s||n.createElement("span",null)},r.appendToContainer=function(t){if((0,M.N)(r.rafId),r.isDidMount){var e=r.context.getPopupContainer,i=r.getMergedProps(["getPopupContainer"]).getPopupContainer,n=(i||e)(r.getRootElement());if(n){n.appendChild(t);return}}r.rafId=(0,M.W)(function(){r.appendToContainer(t)})},r.getContainer=function(){var t=document.createElement("div");return t.style.width="100%",t.style.position="absolute",t.style.top="0",t.style.left="0",r.popupContainer=t,r.appendToContainer(t),t},r.triggerPropsEvent=function(t,e){var i=r.getChild(),n=i&&i.props&&i.props[t],s=r.getMergedProps([t])[t];(0,h.mf)(n)&&n(e),(0,h.mf)(s)&&s(e)},r.triggerOriginEvent=function(t){var e=r.getChild(),i=e&&e.props&&e.props[t],n=r.getMergedProps([t])[t];return(0,h.mf)(n)&&(0,h.mf)(i)?function(t){i(t),n(t)}:i||n};var a=r.getMergedProps(e),u="popupVisible"in a?a.popupVisible:a.defaultPopupVisible;return r.popupOpen=!!u,r.triggerRef=(0,n.createRef)(),r.state={popupVisible:!!u,popupStyle:{}},r}return C(e,t),e.getDerivedStateFromProps=function(t,e){return"popupVisible"in t&&t.popupVisible!==e.popupVisible?{popupVisible:t.popupVisible}:null},e.prototype.componentDidMount=function(){this.componentDidUpdate(this.getMergedProps()),this.isDidMount=!0,this.unmount=!1,this.childrenDom=this.getRootElement(),this.state.popupVisible&&(this.childrenDomSize=E(this.childrenDom,{boundaryDistance:this.props.alignPoint?void 0:this.props.boundaryDistance,position:this.props.position}))},e.prototype.componentDidUpdate=function(t){var e=this.getMergedProps(t),i=this.getMergedProps();!e.popupVisible&&i.popupVisible&&this.update();var r=this.state.popupVisible;this.popupOpen=r;var n=i.getDocument;if(!r){this.offClickOutside(),this.offContainerResize(),this.offWindowResize(),this.offScrollListeners();return}var s=E(this.childrenDom,{boundaryDistance:this.props.alignPoint?{}:this.props.boundaryDistance,position:this.props.position});if(JSON.stringify(s)!==JSON.stringify(this.childrenDomSize)&&(this.updatePopupPosition(),this.childrenDomSize=s),this.onContainerResize(),(i.updateOnScroll||i.containerScrollToClose)&&this.onContainersScroll(i),!this.handleWindowResize&&((0,l.on)(window,"resize",this.handleUpdatePosition),this.handleWindowResize=!0),!this.handleClickOutside){var a=(0,h.mf)(n)&&n();a&&((0,l.on)(a,"mousedown",this.onClickOutside,{capture:!!(0,h.Kn)(i.clickOutsideToClose)&&i.clickOutsideToClose.capture}),this.handleClickOutside=!0)}},e.prototype.componentWillUnmount=function(){this.unmount=!0,this.offClickOutside(),this.clearTimer(),this.offWindowResize(),this.offScrollListeners(),this.offContainerResize(),(0,M.N)(this.rafId)},e.prototype.clearDelayTimer=function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)},e.prototype.render=function(){var t,e,i,r,s=this,l=this.getMergedProps(),d=l.children,c=l.style,p=l.className,v=l.arrowProps,y=l.disabled,_=l.popup,b=l.classNames,x=l.duration,S=l.unmountOnExit,k=l.alignPoint,A=l.autoAlignPopupWidth,w=l.position,M=l.childrenPrefix,C=l.showArrow,E=l.popupStyle,O=l.__onExit,P=l.__onExited,R=d||0===d,B=this.context,I=B.getPrefixCls,L=B.zIndex,D=B.rtl,F=this.state,j=F.popupVisible,N=F.popupStyle;if(!_)return null;var z={},H={onMouseDown:this.onPopupMouseDown};this.isHoverTrigger()&&!y?(z.onMouseEnter=this.onMouseEnter,z.onMouseLeave=this.onMouseLeave,this.isClickToHide()&&(z.onClick=this.clickToHidePopup),k&&(z.onMouseMove=this.onMouseMove),!this.isPopupHoverHide()&&(H.onMouseEnter=this.onPopupMouseEnter,H.onMouseLeave=this.onPopupMouseLeave)):(z.onMouseEnter=this.triggerOriginEvent("onMouseEnter"),z.onMouseLeave=this.triggerOriginEvent("onMouseLeave")),this.isContextMenuTrigger()&&!y?(z.onContextMenu=this.onContextMenu,z.onClick=this.clickToHidePopup):z.onContextMenu=this.triggerOriginEvent("onContextMenu"),this.isClickTrigger()&&!y?z.onClick=this.onClick:z.onClick=z.onClick||this.triggerOriginEvent("onClick"),this.isFocusTrigger()&&!y?(z.onFocus=this.onFocus,this.isBlurToHide()&&(z.onBlur=this.onBlur)):(z.onFocus=this.triggerOriginEvent("onFocus"),z.onBlur=this.triggerOriginEvent("onBlur")),y?z.onKeyDown=this.triggerOriginEvent("onKeyDown"):z.onKeyDown=this.onKeyDown;var V=this.getChild(),W=n.Children.only(_());V.props.className&&(z.className=V.props.className),M&&j&&(z.className=z.className?z.className+" "+M+"-open":M+"-open"),this.isFocusTrigger()&&(z.tabIndex=y?-1:0);var G=I("trigger"),U=(0,m.Z)(G,M,G+"-position-"+w,((t={})[G+"-rtl"]=D,t),p),$=R&&n.createElement(f.Z,{onResize:this.onResize,getTargetDOMNode:function(){return s.rootElementRef}},n.cloneElement(V,T(T({},z),{ref:(0,h.Yr)(V)?function(t){s.rootElementRef=t,(0,o.Kq)(V,t)}:void 0}))),Y=n.createElement(a.Z,{in:!!j,timeout:x,classNames:b,unmountOnExit:S,appear:!0,mountOnEnter:!0,onEnter:function(){s.triggerRefDestoried=!1;var t=s.getPopupElement();if(!!t)t.style.display="initial",t.style.pointerEvents="none","slideDynamicOrigin"===b&&(t.style.transform=s.getTransformTranslate())},onEntering:function(){var t=s.getPopupElement();if(!!t)"slideDynamicOrigin"===b&&(t.style.transform="")},onEntered:function(){var t=s.getPopupElement();if(!!t)t.style.pointerEvents="auto",s.forceUpdate()},onExit:function(){var t=s.getPopupElement();if(!!t)t.style.pointerEvents="none",null==O||O(t)},onExited:function(){var t=s.getPopupElement();if(!!t)t.style.display="none",S&&(s.triggerRefDestoried=!0),s.setState({popupStyle:{}}),null==P||P(t)},nodeRef:this.triggerRef},n.createElement(f.Z,{onResize:function(){var t=s.triggerRef.current;if(t){var e=s.getPopupStyle(),i=s.props.style||{};t.style.top=String(i.top||e.top+"px"),t.style.left=String(i.left||e.left+"px")}s.onResize()},getTargetDOMNode:function(){return s.getPopupElement()}},n.createElement("span",T({ref:this.triggerRef,"trigger-placement":this.realPosition,style:T(T(T({width:A&&(null==c?void 0:c.width)===void 0?null===(r=this.childrenDomSize)||void 0===r?void 0:r.width:""},N),{position:"absolute",zIndex:L||""}),c)},H,{className:U},(0,u.m)(this.props)),n.createElement(W.type,T({ref:W.ref},W.props,{style:T(T({},W.props.style),E)})),(C||v)&&n.createElement("div",{className:(0,m.Z)(G+"-arrow-container",((e={})[M+"-arrow-container"]=M,e))},n.createElement("div",T({},v,{className:(0,m.Z)(G+"-arrow",((i={})[M+"-arrow"]=M,i),null==v?void 0:v.className),style:T(T({},this.arrowStyle),null==v?void 0:v.style)})))))),K=j||this.getPopupElement()&&!this.triggerRefDestoried?n.createElement(g,{getContainer:this.getContainer},Y):null;return R?n.createElement(n.Fragment,null,$,K):K},e.displayName="Trigger",e.contextType=v.E,e}(n.PureComponent)},5146:function(t,e,i){"use strict";i("4290")},8007:function(t,e,i){"use strict";i.d(e,{Z:()=>tU});var r,n,s,a=i("4194"),o=i("8429"),l=i("263"),h=i("8569"),u=i("9542"),d=i("9743"),c=function(t,e){var i,r,n,s,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(i)throw TypeError("Generator is already executing.");for(;a;)try{if(i=1,r&&(n=2&s[0]?r.return:s[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,s[1])).done)return n;switch(r=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{i=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},p=i("9933"),g=i("8336"),f=i("5296");function m(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function v(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?m(Object(i),!0).forEach(function(e){(0,g.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var y=a.forwardRef(function(t,e){var i=(0,a.useContext)(f.P).prefixCls,r=void 0===i?"arco":i,n=t.spin,s=t.className,o=v(v({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(s?s+" ":"").concat(r,"-icon ").concat(r,"-icon-copy")});return n&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,a.createElement("svg",(0,p.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),a.createElement("path",{d:"M20 6h18a2 2 0 0 1 2 2v22M8 16v24c0 1.105.891 2 1.996 2h20.007A1.99 1.99 0 0 0 32 40.008V15.997A1.997 1.997 0 0 0 30 14H10a2 2 0 0 0-2 2Z"}))});y.defaultProps={isIcon:!0},y.displayName="IconCopy";var _=i("672");function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function x(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach(function(e){(0,g.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var S=a.forwardRef(function(t,e){var i=(0,a.useContext)(f.P).prefixCls,r=void 0===i?"arco":i,n=t.spin,s=t.className,o=x(x({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(s?s+" ":"").concat(r,"-icon ").concat(r,"-icon-edit")});return n&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,a.createElement("svg",(0,p.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),a.createElement("path",{d:"m30.48 19.038 5.733-5.734a1 1 0 0 0 0-1.414l-5.586-5.586a1 1 0 0 0-1.414 0l-5.734 5.734m7 7L15.763 33.754a1 1 0 0 1-.59.286l-6.048.708a1 1 0 0 1-1.113-1.069l.477-6.31a1 1 0 0 1 .29-.631l14.7-14.7m7 7-7-7M6 42h36"}))});S.defaultProps={isIcon:!0},S.displayName="IconEdit";var k=function(t){return(0,d.HD)(t)||(0,d.hj)(t)};function A(t){var e=[""];return a.Children.forEach(t,function(t){var i=e.length-1,r=e[i];k(t)&&k(r)?e[i]=""+r+t:t&&t.props&&t.props.children&&e.push(A(t.props.children))}),e.join("")}var w=function(){return(w=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},M=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};function C(t){var e=t.children,i=t.copyable,r=t.editable,n=t.ellipsis,s=t.expanding,o=t.setEditing,l=t.onClickExpand,p=t.forceShowExpand,g=t.isEllipsis,f=t.currentContext,m=void 0===f?{}:f,v=(0,h.Z)(),b=m.getPrefixCls,x=m.locale,k=b("typography"),C=M((0,a.useState)(!1),2),T=C[0],E=C[1],O=(0,a.useRef)(null),P=(0,d.Kn)(i)?i:{},R=(0,d.Kn)(n)?n:{},B=(0,d.Kn)(r)?r:{},I=(0,d.kJ)(R.expandNodes)?R.expandNodes:[x.Typography.fold,x.Typography.unfold];function L(t){if(!T){var i=void 0!==P.text?P.text:A(e);!function(t){var e,i,r,n;e=this,i=void 0,r=void 0,n=function(){var e,i,r,n,s;return c(this,function(a){switch(a.label){case 0:if(!(navigator.clipboard&&navigator.clipboard.writeText))return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,navigator.clipboard.writeText(t)];case 2:return a.sent(),[2];case 3:return console.error(null!=(e=a.sent())?e:new DOMException("The request is not allowed","NotAllowedError")),[3,4];case 4:(i=document.createElement("span")).textContent=t,i.style.whiteSpace="pre",document.body.appendChild(i),r=window.getSelection(),n=window.document.createRange(),r.removeAllRanges(),n.selectNode(i),r.addRange(n),s=!1;try{s=window.document.execCommand("copy")}catch(t){console.log("error",t)}return r.removeAllRanges(),window.document.body.removeChild(i),[2,s?Promise.resolve():Promise.reject(new DOMException("The request is not allowed","NotAllowedError"))]}})},new(r||(r=Promise))(function(t,s){function a(t){try{l(n.next(t))}catch(t){s(t)}}function o(t){try{l(n.throw(t))}catch(t){s(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(a,o)}l((n=n.apply(e,i||[])).next())})}(i),E(!0),P.onCopy&&P.onCopy(i,t),O.current=setTimeout(function(){E(!1)},3e3)}}(0,a.useEffect)(function(){return function(){clearTimeout(O.current),O.current=null}},[]);var D=function(t){B.onStart&&B.onStart(A(e),t),o(!0)},F=P.tooltips||[x.Typography.copy,x.Typography.copied],j=i&&a.createElement(u.Z,w({content:T?F[1]:F[0]},P.tooltipProps),a.createElement("span",w({className:T?k+"-operation-copied":k+"-operation-copy",onClick:L,role:"button","aria-label":F[0],tabIndex:0},v({onPressEnter:L})),T?a.createElement(_.Z,null):P.icon||a.createElement(y,null))),N=r&&a.createElement(u.Z,w({content:x.Typography.edit},B.tooltipProps),a.createElement("span",w({tabIndex:0,"aria-label":x.Typography.edit,role:"button",className:k+"-operation-edit",onClick:D},v({onPressEnter:D})),a.createElement(S,null))),z=p||R.expandable&&g?a.createElement("a",w({className:k+"-operation-expand",onClick:l,role:"button",tabIndex:0,"aria-label":x.Typography.unfold},v({onPressEnter:l})),s?I[0]:I[1]):null;return a.createElement(a.Fragment,null,z,N,j)}var T=i("2315"),E=i("859");function O(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function P(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?O(Object(i),!0).forEach(function(e){(0,g.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):O(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var R=a.forwardRef(function(t,e){var i=(0,a.useContext)(f.P).prefixCls,r=void 0===i?"arco":i,n=t.spin,s=t.className,o=P(P({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(s?s+" ":"").concat(r,"-icon ").concat(r,"-icon-search")});return n&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,a.createElement("svg",(0,p.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),a.createElement("path",{d:"M33.072 33.071c6.248-6.248 6.248-16.379 0-22.627-6.249-6.249-16.38-6.249-22.628 0-6.248 6.248-6.248 16.379 0 22.627 6.248 6.248 16.38 6.248 22.628 0Zm0 0 8.485 8.485"}))});R.defaultProps={isIcon:!0},R.displayName="IconSearch";var B=i("4672"),I=i("3779"),L=i("8773"),D=function(){return(D=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},F=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},j=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},N=a.forwardRef(function(t,e){var i,r=(0,a.useContext)(o.E).getPrefixCls,n=t.className,s=t.style,l=t.placeholder,h=t.disabled,u=t.searchButton,c=t.loading,p=t.defaultValue,g=t.addAfter,f=t.suffix,m=F(t,["className","style","placeholder","disabled","searchButton","loading","defaultValue","addAfter","suffix"]),v=(0,d.Kn)(t.maxLength)?t.maxLength.length:t.maxLength,y=(0,d.Kn)(t.maxLength)&&t.maxLength.errorOnly?void 0:v,_=j((0,I.Z)("",{defaultValue:"defaultValue"in t?tS(t.defaultValue,y):void 0,value:"value"in t?tS(t.value,y):void 0}),2),b=_[0],x=_[1],S=r("input-search"),k=(0,T.Z)(S,((i={})[S+"-button"]=u,i),n),A=function(){!h&&t.onSearch&&t.onSearch(b)};return a.createElement(tA,D({},(0,B.Z)(m,["onSearch"]),{disabled:h,className:k,style:s,ref:e,placeholder:l,addAfter:void 0!==g?g:u?a.createElement(E.Z,{disabled:h,size:m.size,className:S+"-btn",type:"primary",onClick:A,loading:c,loadingFixedWidth:!0,icon:!0===u&&!c&&a.createElement(R,null)},!0!==u&&u):null,suffix:void 0!==f?f:!u&&(c?a.createElement(L.Z,null):a.createElement(R,{onClick:A})),onChange:function(e,i){x(e),t.onChange&&t.onChange(e,i)},defaultValue:p,onPressEnter:function(e){A(),t.onPressEnter&&t.onPressEnter(e)}}))});N.displayName="Search";var z=["border-width","box-sizing","font-family","font-weight","font-size","font-variant","letter-spacing","line-height","padding-top","padding-bottom","padding-left","padding-right","text-indent","text-rendering","text-transform","width"];let H=function(t,e){if(t){var i,r,s,a,o,l=((0,d.Kn)(t)&&(i=t.minRows,r=t.maxRows),{minRows:i,maxRows:r}),h=l.minRows,u=l.maxRows;var c=(s=e,!n&&(n=document.createElement("textarea"),document.body.appendChild(n)),a=window.getComputedStyle(s),o="\n    "+z.map(function(t){return t+":"+a.getPropertyValue(t)}).join(";")+"\n  ",n.setAttribute("style","\n  position: absolute;\n  min-height: 0 !important;\n  max-height: none;\n  height:0;\n  visibility: hidden;\n  z-index: -100;\n  top: 0;\n  right: 0;\n"+o),{paddingSize:parseFloat(a.getPropertyValue("padding-top"))+parseFloat(a.getPropertyValue("padding-bottom")),boxSizing:a.getPropertyValue("box-sizing"),borderSize:parseFloat(a.getPropertyValue("border-top-width"))+parseFloat(a.getPropertyValue("border-bottom-width"))}),p=c.paddingSize,g=c.boxSizing,f=c.borderSize;n.value=e.value||e.placeholder||"";var m=n.scrollHeight+f,v=void 0,y=void 0,_=void 0;if(h||u){n.value="";var b=n.scrollHeight-p;(0,d.hj)(h)&&(v=b*h,"border-box"===g&&(v+=p+f),m=Math.max(m,v)),(0,d.hj)(u)&&(y=b*u,"border-box"===g&&(y+=p+f),_=m>y?"auto":"",y=Math.min(m,y))}var x={};return x.height=m,v&&(x.minHeight=v),y&&(x.maxHeight=y),_&&(x.overflowY=_),x}};var V=i("6807"),W=i("2920"),G=i("4308"),U=i("8564"),$=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};function Y(t){var e=t.value,i=t.maxLength,r=t.onChange,n=t.onKeyDown,s=t.onPressEnter,o=t.beforeTriggerValueChangeCallback,l=t.normalizeHandler,h=(0,a.useRef)(!1),u=$((0,a.useState)(""),2),d=u[0],c=u[1],p=function(t,n){o&&o(t),r&&t!==e&&(void 0===i||t.length<=i)&&r(t,n)};return{compositionValue:d,triggerValueChangeCallback:p,compositionHandler:function(t){h.current="compositionend"!==t.type,!h.current&&(c(void 0),p(t.target.value,t))},valueChangeHandler:function(t){var e=t.target.value;h.current?(h.current=!1,c(e)):(d&&c(void 0),p(e,t))},keyDownHandler:function(t){var e=t.keyCode||t.which;if(!h.current&&(n&&n(t),e===U.Ce.code)){s&&s(t);var i=null==l?void 0:l("onPressEnter");i&&p(i(t.target.value),t)}}}}var K=function(){return(K=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},Z=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},X=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},q=a.forwardRef(function(t,e){var i,r,n,s=t.className,l=t.style,h=t.wrapperStyle,u=t.placeholder,c=t.disabled,p=t.error,g=t.maxLength,f=t.showWordLimit,m=t.allowClear,v=t.onChange,y=t.onClear,_=t.onKeyDown,b=t.onPressEnter,x=t.status,S=t.clearIcon,k=Z(t,["className","style","wrapperStyle","placeholder","disabled","error","maxLength","showWordLimit","allowClear","onChange","onClear","onKeyDown","onPressEnter","status","clearIcon"]),A=(0,d.Kn)(g)?g.length:g,w=(0,d.Kn)(g)?g.errorOnly?void 0:g.length:g,M=(0,a.useRef)(),C=X((0,a.useState)({}),2),E=C[0],O=C[1],P=X((0,I.Z)("",{defaultValue:"defaultValue"in t?tS(t.defaultValue,w):void 0,value:"value"in t?tS(t.value,w):void 0}),2),R=P[0],L=P[1],D=Y({value:R,maxLength:w,onChange:v,onKeyDown:_,onPressEnter:b,beforeTriggerValueChangeCallback:function(e){!("value"in t)&&(void 0===w||e.length<=w)&&L(e)}}),F=D.compositionValue,j=D.compositionHandler,N=D.valueChangeHandler,z=D.keyDownHandler,U=D.triggerValueChangeCallback,$=F||R||"",q=(0,a.useContext)(o.E),J=q.getPrefixCls,Q=q.rtl,tt=J("textarea");c&&(E.resize="none");var te=function(){if(M.current&&M.current.focus){if(M.current.setSelectionRange){var t=M.current.textContent.length;M.current.setSelectionRange(t,t)}M.current.focus()}},ti=function(){var e=H(t.autoSize,M.current);e&&O(e)},tr=function(t){t.stopPropagation(),te(),U("",t),null==y||y()};(0,G.Z)(function(){ti()},[$]),(0,a.useImperativeHandle)(e,function(){return{dom:M.current,focus:function(){te()},blur:function(){M.current&&M.current.blur&&M.current.blur()},getRootDOMNode:function(){return M.current}}},[]);var tn=R?R.length:0,ts=A&&f||m,ta=(0,a.useMemo)(function(){return!w&&!!A&&tn>A},[tn,A,w]),to=x||(p||ta?"error":void 0),tl=(0,T.Z)(tt,((i={})[tt+"-"+to]=to,i[tt+"-disabled"]=c,i[tt+"-rtl"]=Q,i),s),th=a.createElement("textarea",K({},(0,B.Z)(k,["autoSize","defaultValue"]),{maxLength:w,ref:M,style:K(K({},l),E),className:tl,placeholder:u,disabled:c,value:$,onChange:N,onKeyDown:z,onCompositionStart:j,onCompositionUpdate:j,onCompositionEnd:j}));if(ts){var tu=!c&&m&&R,td=X(Q?[A,tn]:[tn,A],2),tc=td[0],tp=td[1];return a.createElement("div",{className:(0,T.Z)(tt+"-wrapper",((r={})[tt+"-clear-wrapper"]=m,r[tt+"-wrapper-rtl"]=Q,r)),style:h},th,tu?void 0!==S?a.createElement("span",{className:tt+"-clear-icon",onClick:tr,onMouseDown:function(t){t.preventDefault()}},S):a.createElement(W.Z,{className:tt+"-clear-icon"},a.createElement(V.Z,{onClick:tr,onMouseDown:function(t){t.preventDefault()}})):null,A&&f&&a.createElement("span",{className:(0,T.Z)(tt+"-word-limit",((n={})[tt+"-word-limit-error"]=ta,n))},tc,"/",tp))}return th});q.displayName="TextArea";function J(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function Q(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?J(Object(i),!0).forEach(function(e){(0,g.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):J(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var tt=a.forwardRef(function(t,e){var i=(0,a.useContext)(f.P).prefixCls,r=void 0===i?"arco":i,n=t.spin,s=t.className,o=Q(Q({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(s?s+" ":"").concat(r,"-icon ").concat(r,"-icon-eye")});return n&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,a.createElement("svg",(0,p.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),a.createElement("path",{d:"M24 37c6.627 0 12.627-4.333 18-13-5.373-8.667-11.373-13-18-13-6.627 0-12.627 4.333-18 13 5.373 8.667 11.373 13 18 13Z",clipRule:"evenodd"}),a.createElement("path",{d:"M29 24a5 5 0 1 1-10 0 5 5 0 0 1 10 0Z"}))});tt.defaultProps={isIcon:!0},tt.displayName="IconEye";function te(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function ti(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?te(Object(i),!0).forEach(function(e){(0,g.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):te(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var tr=a.forwardRef(function(t,e){var i=(0,a.useContext)(f.P).prefixCls,r=void 0===i?"arco":i,n=t.spin,s=t.className,o=ti(ti({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(s?s+" ":"").concat(r,"-icon ").concat(r,"-icon-eye-invisible")});return n&&(o.className="".concat(o.className," ").concat(r,"-icon-loading")),delete o.spin,delete o.isIcon,a.createElement("svg",(0,p.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},o),a.createElement("path",{d:"M14 14.5c-2.69 2-5.415 5.33-8 9.5 5.373 8.667 11.373 13 18 13 3.325 0 6.491-1.09 9.5-3.271M17.463 12.5C19 11 21.75 11 24 11c6.627 0 12.627 4.333 18 13-1.766 2.848-3.599 5.228-5.5 7.14"}),a.createElement("path",{d:"M29 24a5 5 0 1 1-10 0 5 5 0 0 1 10 0ZM6.852 7.103l34.294 34.294"}))});tr.defaultProps={isIcon:!0},tr.displayName="IconEyeInvisible";var tn=function(){return(tn=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},ts=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},ta=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},to=a.forwardRef(function(t,e){var i,r=ta((0,I.Z)(!1,{defaultValue:t.defaultVisibility,value:t.visibility}),2),n=r[0],s=r[1],l=(0,a.useContext)(o.E).getPrefixCls,u=(0,h.Z)(),d=t.className,c=t.visibilityToggle,p=void 0===c||c,g=t.onVisibilityChange,f=ts(t,["className","visibilityToggle","onVisibilityChange"]),m=l("input-password"),v=(0,T.Z)(m,((i={})[m+"-visibility"]=p,i),d),y=function(e){!("visibility"in t)&&s(e),g&&g(e)},_=t.suffix,b=function(){y(!n)};if(p){var x=tn({onClick:b,onMouseDown:function(t){return t.preventDefault()},onMouseUp:function(t){return t.preventDefault()}},u({onPressEnter:b}));if(t.suffix)_=a.createElement("span",tn({},x),t.suffix);else{var S=n?tt:tr;_=a.createElement(S,tn({},x,{focusable:void 0,"aria-hidden":void 0,tabIndex:0,className:m+"-visibility-icon"}))}}return a.createElement(tA,tn({},(0,B.Z)(f,["visibility","defaultVisibility"]),{type:n?"text":"password",className:v,ref:e,suffix:_}))});to.displayName="Password";var tl=function(){return(tl=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},th=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},tu=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},td=function(t){if(!t)return{};var e=window.getComputedStyle(t);return["font","letterSpacing","overflow","tabSize","textIndent","textTransform","whiteSpace","wordBreak","wordSpacing","paddingLeft","paddingRight","borderLeft","borderRight","boxSizing"].reduce(function(t,i){return t[i]=e[i],t},{})},tc=a.forwardRef(function(t,e){var i,r,n=t.allowClear,s=t.disabled,o=t.placeholder,u=t.className,c=t.style,p=t.height,g=t.prefixCls,f=t.hasParent,m=t.size,v=t.value,y=t.autoFitWidth,_=t.onClear,b=t.readOnly,x=t.onChange,S=t.onKeyDown,k=t.onPressEnter,A=t.maxLength,w=t.clearIcon,M=th(t,["allowClear","disabled","placeholder","className","style","height","prefixCls","hasParent","size","value","autoFitWidth","onClear","readOnly","onChange","onKeyDown","onPressEnter","maxLength","clearIcon"]),C=(0,B.Z)(M,["error","status","showWordLimit","className","defaultValue","addBefore","addAfter","afterStyle","beforeStyle","prefix","suffix","normalize","normalizeTrigger","autoWidth"]),E=tu((0,a.useState)(),2),O=E[0],P=E[1],R=(0,h.Z)(),I=(0,a.useRef)(),L=(0,a.useRef)(),D=(0,a.useRef)(null),F=(0,d.Kn)(A)?A.errorOnly?void 0:A.length:A,j=function(e){var i,r=t.normalizeTrigger||["onBlur"];return Array.isArray(r)&&r.indexOf(e)>-1&&(0,d.mf)(t.normalize)&&(i=t.normalize),i},N=Y({value:v,maxLength:F,onChange:x,onKeyDown:S,onPressEnter:k,normalizeHandler:j}),z=N.compositionValue,H=N.valueChangeHandler,G=N.compositionHandler,U=N.keyDownHandler,$=N.triggerValueChangeCallback,K=(0,T.Z)(g,g&&((r={})[g+"-size-"+m]=m,r[g+"-"+t.status]=t.status,r[g+"-disabled"]=s,r[g+"-autowidth"]=y,r),f?void 0:u),Z=tl(tl({"aria-invalid":"error"===t.status||void 0},C),{readOnly:b,maxLength:F,disabled:s,placeholder:o,value:z||v||"",className:K,onKeyDown:U,onChange:H,onCompositionStart:function(t){var e;null===(e=M.onCompositionStart)||void 0===e||e.call(M,t),G(t)},onCompositionUpdate:function(t){var e;null===(e=M.onCompositionUpdate)||void 0===e||e.call(M,t),G(t)},onCompositionEnd:function(t){var e;null===(e=M.onCompositionEnd)||void 0===e||e.call(M,t),G(t)},onBlur:function(e){null===(i=t.onBlur)||void 0===i||i.call(t,e);var i,r=j("onBlur");r&&$(r(e.target.value),e)}});(0,a.useImperativeHandle)(e,function(){return{dom:I.current,getRootDOMNode:function(){return I.current},focus:function(){I.current&&I.current.focus&&I.current.focus()},blur:function(){I.current&&I.current.blur&&I.current.blur()}}},[]);var X=function(){if(L.current&&I.current){var t=L.current.offsetWidth;I.current.style.width=t+2+"px"}};(0,a.useEffect)(function(){y&&((!(0,d.Kn)(y)||!y.pure)&&P(td(null==I?void 0:I.current)),X())},[y]);var q=Z.value||o,J=function(t){I.current&&I.current.focus&&I.current.focus(),$("",t),null==_||_()};return a.createElement(a.Fragment,null,n?a.createElement(a.Fragment,null,a.createElement("input",tl({ref:I},Z)),!b&&!s&&n&&v?void 0!==w?a.createElement("span",tl({tabIndex:0,className:g+"-clear-icon"},R({onPressEnter:J}),{onClick:function(t){t.stopPropagation(),J(t)},onMouseDown:function(t){t.preventDefault()}}),w):a.createElement(W.Z,tl({tabIndex:0,className:g+"-clear-icon"},R({onPressEnter:J}),{onClick:function(t){t.stopPropagation(),J(t)}}),a.createElement(V.Z,{onMouseDown:function(t){t.preventDefault()}})):null):a.createElement("input",tl({ref:I},Z,{style:f?{}:tl(tl({minWidth:(0,d.Kn)(y)?y.minWidth:void 0,maxWidth:(0,d.Kn)(y)?y.maxWidth:void 0},c),"height"in t?{height:p}:{})})),y&&a.createElement(l.Z,{getTargetDOMNode:function(){return L.current},onResize:function(){var t=L.current.offsetWidth;if("object"==typeof y){var e="function"==typeof y.delay?y.delay(t,D.current):y.delay;e?setTimeout(X,e):X()}else X();D.current=t}},a.createElement("span",{className:(0,T.Z)(g+"-mirror"),style:f?O:tl(tl(tl({},O),c),"height"in t?{height:p}:{}),ref:L},"string"==typeof(i=q)?i.replace(/(\s{2,})|(\s{1,}$)/g,function(t){return"\xa0".repeat(t.length)}):i)))});tc.displayName="InputComponent";var tp=function(){return(tp=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},tg=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},tf=a.forwardRef(function(t,e){var i,r=(0,a.useContext)(o.E).getPrefixCls,n=t.className,s=t.style,l=t.children,h=t.compact,u=tg(t,["className","style","children","compact"]),d=r("input-group"),c=(0,T.Z)(d,((i={})[d+"-compact"]=h,i),n);return a.createElement("div",tp({ref:e,className:c,style:s},u),l)});tf.displayName="InputGroup";var tm=i("6132"),tv=i("2888"),ty=function(){return(ty=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},t_=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},tb=function(t){"INPUT"!==t.target.tagName&&t.preventDefault()},tx=function(t,e,i,r){return void 0===i&&(i={}),e?a.createElement("span",{style:i,className:t,onClick:r},e):null};function tS(t,e){var i=null===t||(0,d.o8)(t)||(0,d.HD)(t)?t||"":String(t);return e?i.slice(0,e):i}var tk=a.forwardRef(function(t,e){var i,r,n,s=(0,a.useContext)(o.E),l=s.getPrefixCls,h=s.size,u=s.componentConfig,c=s.rtl,p=(0,tv.Z)(t,{},null==u?void 0:u.Input),g=p.className,f=p.style,m=p.addBefore,v=p.addAfter,y=p.suffix,_=p.prefix,b=p.beforeStyle,x=p.afterStyle,S=p.height,k=p.disabled,A=p.maxLength,w=p.showWordLimit,M=p.allowClear,C=p.autoWidth,E=C?ty({minWidth:0,maxWidth:"100%"},(0,d.Kn)(C)?C:{}):null,O=ty({minWidth:null==E?void 0:E.minWidth,maxWidth:null==E?void 0:E.maxWidth,width:E&&"auto"},f),P=(0,d.Kn)(A)?A.length:A,R=(0,d.Kn)(A)&&A.errorOnly?void 0:P,B=t_((0,a.useState)(!1),2),L=B[0],D=B[1],F=(0,a.useRef)(),j=(0,a.useRef)(),N=t_((0,I.Z)("",{defaultValue:"defaultValue"in p?tS(p.defaultValue,R):void 0,value:"value"in p?tS(p.value,R):void 0}),2),z=N[0],H=N[1];(0,a.useImperativeHandle)(e,function(){return F.current},[]);var V=l("input"),W=p.size||h,G="height"in p,U=y,$=z?z.length:0,Y=(0,a.useMemo)(function(){return!R&&!!P&&$>P},[$,P,R]);if(P&&w){var K=t_(c?[P,$]:[$,P],2),Z=K[0],X=K[1];U=a.createElement("span",{className:(0,T.Z)(V+"-word-limit",((i={})[V+"-word-limit-error"]=Y,i))},Z,"/",X)}var q=(0,T.Z)(V+"-group-wrapper",V+"-group-wrapper-"+W,((r={})[V+"-custom-height"]=G,r[V+"-has-suffix"]=U,r[V+"-group-wrapper-disabled"]=k,r[V+"-group-wrapper-rtl"]=c,r[V+"-group-wrapper-autowidth"]=E,r),g),J=p.status||(p.error||Y?"error":void 0),Q=m||v||U||_,tt=a.createElement(tc,ty({ref:F},p,{autoFitWidth:!!E,style:O,status:J,onFocus:function(t){D(!0),p.onFocus&&p.onFocus(t)},onBlur:function(t){D(!1),p.onBlur&&p.onBlur(t)},onChange:function(t,e){!("value"in p)&&H(t),p.onChange&&p.onChange(t,e)},prefixCls:V,value:z,hasParent:!!Q||M,size:W})),te=(0,T.Z)(V+"-inner-wrapper",((n={})[V+"-inner-wrapper-"+J]=J,n[V+"-inner-wrapper-disabled"]=k,n[V+"-inner-wrapper-focus"]=L,n[V+"-inner-wrapper-has-prefix"]=_,n[V+"-inner-wrapper-"+W]=W,n[V+"-clear-wrapper"]=M,n[V+"-inner-wrapper-rtl"]=c,n));return Q?a.createElement("div",{className:q,style:ty(ty({},O),G?{height:S}:{})},a.createElement("span",{className:V+"-group"},tx(V+"-group-addbefore",m,b),a.createElement("span",{className:te,ref:j,onMouseDown:function(t){"INPUT"!==t.target.tagName&&j.current&&(0,tm.r3)(j.current,t.target)&&t.preventDefault()},onClick:function(t){j.current&&(0,tm.r3)(j.current,t.target)&&F.current&&F.current.focus()}},tx(V+"-group-prefix",_),tt,tx(V+"-group-suffix",U)),tx(V+"-group-addafter",v,x))):M?a.createElement("span",{className:(0,T.Z)(g,te),style:ty(ty({},O),G?{height:S}:{}),onMouseDown:tb,onClick:function(){F.current&&F.current.focus()}},tt):tt});tk.displayName="Input",tk.Search=N,tk.TextArea=q,tk.Password=to,tk.Group=tf;let tA=tk,tw=(0,a.forwardRef)(function(t,e){var i=t.prefixCls,r=t.children,n=t.setEditing,s=t.editableConfig,o=t.style,l=(0,T.Z)(i+"-typography",i+"-edit-content",t.className),h=A(r),u=(0,a.useRef)(null);function d(){n(!1),s.onEnd&&s.onEnd(h)}return(0,a.useEffect)(function(){if(u.current&&u.current.focus&&u.current.focus(),u.current&&u.current.dom){var t=u.current.dom.value.length;u.current.dom.setSelectionRange(t,t)}},[]),a.createElement("div",{className:l,style:o,ref:e},a.createElement(tA.TextArea,{className:i+"-edit-content-textarea",onBlur:function(){d()},ref:u,value:h,autoSize:!0,onChange:function(t){s.onChange&&s.onChange(t)},onPressEnter:d}))});var tM=function(){return(tM=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},tC=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},tT={position:"top",trigger:"hover",unmountOnExit:!0},tE=(0,a.forwardRef)(function(t,e){var i,r=(0,a.useContext)(o.E),n=r.getPrefixCls,s=r.componentConfig,l=r.rtl,h=(0,tv.Z)(t,tT,null==s?void 0:s.Popover),c=h.style,p=h.className,g=h.children,f=h.position,m=h.getPopupContainer,v=h.trigger,y=h.defaultPopupVisible,_=h.popupVisible,b=h.triggerProps,x=h.unmountOnExit,S=h.onVisibleChange,k=h.content,A=h.title,w=tC(h,["style","className","children","position","getPopupContainer","trigger","defaultPopupVisible","popupVisible","triggerProps","unmountOnExit","onVisibleChange","content","title"]),M=n("popover"),C=(0,d.mf)(A)?A():A,E=(0,d.mf)(k)?k():k,O=(0,d.U$)(C,!0)&&(0,d.U$)(E,!0)?null:a.createElement("div",{className:(0,T.Z)(M+"-inner",((i={})[M+"-inner-rtl"]=l,i))},C?a.createElement("div",{className:M+"-title"},C):null,a.createElement("div",{className:M+"-inner-content"},E));return a.createElement(u.Z,tM({},w,{ref:e,style:tM({maxWidth:350},c),className:p,prefixCls:M,getPopupContainer:m,position:f,trigger:v,content:O,popupHoverStay:!0,unmountOnExit:x,triggerProps:b,defaultPopupVisible:y,onVisibleChange:S||(b?b.onVisibleChange:void 0),childrenPrefix:M},"popupVisible"in h?{popupVisible:_}:{}),"string"==typeof g?a.createElement("span",null,g):g)});tE.displayName="Popover";function tO(t,e){void 0===e&&(e=[]);var i=(0,a.useRef)(!1);(0,a.useEffect)(function(){i.current?t():i.current=!0},e)}var tP=i("9968"),tR=function(){return(tR=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},tB=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};(r=s||(s={}))[r.INIT=0]="INIT",r[r.BEFORE_MEASURE=1]="BEFORE_MEASURE",r[r.MEASURING=2]="MEASURING",r[r.MEASURE_END=3]="MEASURE_END",r[r.NO_NEED_ELLIPSIS=4]="NO_NEED_ELLIPSIS";let tI=function(t){var e,i=t.children,r=t.rows,n=void 0===r?1:r,o=t.width,l=t.expanding,h=t.renderMeasureContent,u=t.simpleEllipsis,c=t.onEllipsis,p=t.suffix,g=t.expandNodes,f=t.expandable,m=t.ellipsisStr,v=(0,a.useRef)(),y=(0,a.useRef)(),_=tB((0,a.useState)([0,0,0]),2),b=_[0],x=_[1],S=tB((0,a.useState)(0),2),k=S[0],A=S[1],w=tB((0,a.useState)(s.NO_NEED_ELLIPSIS),2),M=w[0],C=w[1],T=tB(b,3),E=T[0],O=T[1],P=T[2],R=tB((0,a.useState)(!1),2),B=R[0],I=R[1],L=(0,a.useMemo)(function(){return a.Children.toArray(i)},[i]),D=(0,a.useRef)(0);tO(function(){c&&c(B)},[B]);var F=function(t){return(0,d.HD)(t)||(0,d.hj)(t)},j=function(t){var e=0;return t.forEach(function(t){F(t)?e+=String(t).length:e+=1}),e},N=(0,a.useMemo)(function(){return j(L)},[L]),z=(0,tP.Z)(function(t){return x(t)}),H=function(t){var e=[],i=0;if(t>=N)return L;for(var r in L){var n=L[r];if(i>=t)break;var s=F(n)?String(n).length:1;if(s>t-i){e.push(String(n).slice(0,t-i)),i=t;break}i+=s,e.push(n)}return e},V=function(){var t,e;if(k){if(M===s.INIT){var i=n*k,r=null===(t=y.current)||void 0===t?void 0:t.offsetHeight,a=r>i;!a||u||l?(C(s.MEASURE_END),I(a),x([0,N,N])):(I(!0),C(s.BEFORE_MEASURE))}else if(M===s.BEFORE_MEASURE){var h=null==v?void 0:v.current.offsetWidth,d=n*o;if(h>n*o){var c=Math.floor((Math.floor(Math.max(d/h-.1,0)*N)+Math.ceil(Math.min(d/h+.1,1)*N))/2);D.current=c}C(s.MEASURING)}else if(M===s.MEASURING){if(E!==P-1){var r=null===(e=y.current)||void 0===e?void 0:e.offsetHeight,i=n*k,p=E,g=P;r<=i?p=O:g=O;var f=Math.floor((g+p)/2);z([p,f,g])}else z([E,E,E]),C(s.MEASURE_END)}}};(0,G.Z)(function(){t.rows&&o?(x([0,Math.floor(N/2),N]),C(s.INIT)):C(s.NO_NEED_ELLIPSIS)},[N,u,l,o,p,g,f,m,t.rows]),(0,G.Z)(function(){v.current&&M===s.INIT&&A(v.current.offsetHeight)},[M]),(0,G.Z)(function(){V()},[M,O,E,P,k]);var W={zIndex:-999,position:"fixed",opacity:0,padding:0,margin:0},U=tR({whiteSpace:"nowrap"},W),$=u?tR({textOverflow:"clip"},W):W;return M===s.INIT||M===s.BEFORE_MEASURE?e=(e=a.createElement("div",null,a.createElement("div",{ref:v,style:U},M===s.INIT?"hxj":h(i,!1)),a.createElement("div",{ref:y,style:tR({width:o},$)},h(i,B)))).props.children:M===s.MEASURING?e=(e=a.createElement("div",null,a.createElement("div",{ref:y,style:tR({width:o},$)},h(H(O),B)),a.createElement("div",{style:{height:k*n,overflow:"hidden"}},H(D.current)))).props.children:M===s.MEASURE_END?e=h(H(O),B):M===s.NO_NEED_ELLIPSIS&&(e=h(i,!1)),{ellipsisNode:e,isEllipsis:B,measureStatus:M}};var tL=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},tD=function(t,e){if("undefined"!=typeof window&&window.CSS&&window.CSS.supports)return(0,d.o8)(e)?window.CSS.supports(t):window.CSS.supports(t,e);if("undefined"!=typeof document&&document.createElement){var i=document.createElement("div");return i.setAttribute("style",t+":"+e+";"),void 0!==i.style[t]}return!1},tF={display:" -webkit-box","-webkit-line-clamp":2};let tj=function(t){var e=t.cssEllipsis,i=t.ellipsisStr,r=void 0===i?"...":i,n=t.suffix,s=t.rows,o=(0,a.useMemo)(function(){return!!(e&&(!(s>1)||Object.entries(tF).every(function(t){var e=tL(t,2);return tD(e[0],e[1])})))&&"..."===r&&!n},[r,e,s,n]),l={textOverflow:"ellipsis",whiteSpace:"normal",overflow:"hidden",WebkitLineClamp:""+t.rows,WebkitBoxOrient:"vertical",display:"-webkit-box"};return{simpleEllipsis:o,ellipsisStyle:o?t.rows>1?l:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}:{}}};var tN=i("3520"),tz=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},tH=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))},tV=function(){return(tV=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},tW=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},tG=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};let tU=(0,a.forwardRef)(function(t,e){var i,r,n,h,c,p,g,f,m,v,y,_,b,x,S,k,w,M,E,O,P,R,L,D,F,j=t.componentType,N=t.style,z=t.className,H=t.children,V=t.editable,W=t.ellipsis,G=t.heading,U=t.blockquote,$=tW(t,["componentType","style","className","children","editable","ellipsis","heading","blockquote"]),Y=(0,a.useContext)(o.E),K=Y.getPrefixCls,Z=Y.rtl,X=K("typography"),q=(0,a.useRef)();var J=(i=t,r=X,n=i.type,h=i.bold,c=i.disabled,p=i.mark,g=i.underline,f=i.delete,m=i.code,v=[],y=[],n&&y.push(r+"-"+n),c&&y.push(r+"-disabled"),h&&v.push("b"),g&&v.push("u"),f&&v.push("del"),m&&v.push("code"),p&&v.push("mark"),{component:v,className:y}),Q=J.component,tt=J.className,te=tG((0,a.useState)(!1),2),ti=te[0],tr=te[1],tn=tG((0,a.useState)(0),2),ts=tn[0],ta=tn[1],to=(0,d.Kn)(V)?V:{},tl="editing"in to?to.editing:ti,th=W?tV({rows:1,ellipsisStr:"...",cssEllipsis:!1},(0,d.Kn)(W)?W:{}):{},tu=th.wrapper||a.Fragment,td=tG((0,I.Z)(!1,{defaultValue:th.defaultExpanded,value:th.expanded}),2),tc=td[0],tp=td[1],tg=tj(th),tf=tg.simpleEllipsis,tm=tg.ellipsisStyle,tv=function(e,i){var r=(0,d.o8)(th.ellipsisStr)?"...":th.ellipsisStr,n=!(0,d.o8)(th.suffix)&&th.suffix;return a.createElement(tu,null,e,!i||tc||tf?"":r,n,function(e){return a.createElement(a.Fragment,null,a.createElement(C,tV({},t,{setEditing:tr,onClickExpand:tk,expanding:tc,isEllipsis:e,currentContext:Y})))}(i))},ty=tI(tV(tV({},th),{children:H,expanding:tc,width:ts,renderMeasureContent:tv,simpleEllipsis:tf||tc})),t_=ty.ellipsisNode,tb=ty.isEllipsis,tx=ty.measureStatus;var tS=(_=function(t){var e=(null==t?void 0:t[0]).contentRect;if(e){var i=Q.includes("code")?e.width-18:e.width;[s.NO_NEED_ELLIPSIS,s.MEASURE_END].includes(tx)&&ta(i)}},b=null,(x=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!b&&(_.apply(void 0,tH([],tz(t),!1)),b=(0,tN.W)(function(){})),b&&(0,tN.N)(b),b=(0,tN.W)(function(){_.apply(void 0,tH([],tz(t),!1)),b=null})}).cancel=function(){(0,tN.N)(b),b=null},x);function tk(e){tp(!tc),t.onClickExpand&&t.onClickExpand(e),th.onExpand&&th.onExpand(!tc,e)}function tA(t,e,i,r){void 0===r&&(r={});var n=t;return e.forEach(function(t,e){var s=0===e?r:{},o=(0,d.Kn)(i.mark)&&i.mark.color?tV({style:{backgroundColor:i.mark.color}},s):tV({},s);n=a.createElement(t,tV({},o),n)}),n}tO(function(){th.onEllipsis&&th.onEllipsis(tb)},[tb]),(0,a.useImperativeHandle)(e,function(){return q.current}),"Paragraph"===j?F=U?"blockquote":"div":"Title"===j?F="h"+G:"Text"===j&&(F=W?"div":"span");return tl?a.createElement(tw,tV({ref:e},t,{className:(0,T.Z)(X,tt,((D={})[X+"-rtl"]=Z,D),X+"-"+F,z),prefixCls:X,setEditing:tr,editableConfig:to})):(k=A(a.Children.toArray(H)),w=th.showTooltip,M=(0,d.Kn)(th.showTooltip)&&"popover"===th.showTooltip.type?"popover":"tooltip",E=(0,d.Kn)(th.showTooltip)&&th.showTooltip.props||{},O="popover"===M?tE:u.Z,P=tV({style:N},!tb||w||tc?{}:{title:k}),R=tb&&w&&!tc,L=a.createElement(l.Z,{onResize:tS,getTargetDOMNode:function(){return q.current}},a.createElement(F,tV({ref:q,className:(0,T.Z)(X,tt,((S={})[X+"-rtl"]=Z,S),z)},P,(0,B.Z)($,["spacing","type","close","bold","disabled","mark","underline","delete","code","copyable","isEllipsis","expanding","onClickExpand","setEditing","forceShowExpand"])),tf&&tx!==s.INIT&&!tc&&tb?tA(tv(a.createElement("span",{style:tm},H),tb),Q.length?Q:["span"],t,{className:X+"-simple-ellipsis"}):tA(t_,Q,t))),R?a.createElement(O,tV({content:k},E),a.createElement("span",null,L)):L)})},9590:function(t,e,i){"use strict";i.d(e,{Z:()=>k});var r=i("4194"),n=i("2315"),s=i("8429"),a=(0,r.forwardRef)(function(t,e){var i=(0,(0,r.useContext)(s.E).getPrefixCls)("typography"),a=t.className,o=t.style,l=t.children,h=(0,n.Z)(i,a);return r.createElement("article",{ref:e,style:o,className:h},l)});a.displayName="Typography";var o=i("9258"),l=i("8007"),h=function(){return(h=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},u=(0,r.forwardRef)(function(t,e){return r.createElement(l.Z,h({},t,{componentType:"Text",ref:e}))});u.displayName="Text";var d=i("8028"),c=i("9542"),p=i("263"),g=i("9968"),f=i("2888"),m=i("9743"),v=i("3779"),y=i("6132"),_=function(){return(_=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},b=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},x={rows:1,expandable:!0,defaultExpanded:!1},S=(0,r.forwardRef)(function(t,e){var i,a,o=(0,r.useContext)(s.E),l=(0,f.Z)(t,x,null===(i=o.componentConfig)||void 0===i?void 0:i["Typography.Ellipsis"]),h=l.className,u=l.style,d=l.rows,S=l.disabled,k=l.showTooltip,A=l.children,w=l.expandable,M=l.expandRender,C=l.onExpand,T=l.onEllipsis,E=o.locale,O=!y.ET&&/^((?!chrome|android).)*safari/i.test(null!==(a=null==navigator?void 0:navigator.userAgent)&&void 0!==a?a:""),P=(0,r.useRef)(null),R=(0,r.useRef)(null),B=b((0,r.useState)(""),2),I=B[0],L=B[1],D=b((0,r.useState)(!1),2),F=D[0],j=D[1],N=(0,r.useRef)(null),z=(0,r.useRef)(null),H=b((0,v.Z)(!1,{defaultValue:l.defaultExpanded,value:l.expanded}),2),V=H[0],W=H[1],G=b((0,r.useState)(!1),2),U=G[0],$=G[1],Y=(0,r.useMemo)(function(){return(0,m.Kn)(w)?!w.single&&1===d:1===d},[d,w]),K=(0,r.useMemo)(function(){return(0,m.Kn)(k)?{tooltip:!0,tooltipProps:k}:{tooltip:!!k,tooltipProps:k}},[k]);(0,r.useEffect)(function(){if(R.current){var t=R.current.textContent;t&&L(t)}},[A,R]);var Z=o.getPrefixCls("ellipsis"),X=function(){var t;return w&&U?r.createElement("div",{className:(0,n.Z)(Z+"-action",((t={})[Z+"-action-collapsed"]=!V,t)),onClick:function(t){V?(W(!1),null==C||C(!1,t)):(W(!0),j(!1),null==C||C(!0,t))}},M?M(V):r.createElement("span",{className:Z+"-action-text"},V?E.Typography.fold:E.Typography.unfold)):null},q=(0,r.useCallback)((0,g.Z)(function(){z.current&&N.current&&((Y?z.current.offsetWidth>N.current.offsetWidth:z.current.offsetHeight>N.current.offsetHeight)?!1===U&&($(!0),null==T||T(!0)):!0===U&&($(!1),null==T||T(!1)))}),[U,Y]),J=function(){var t,e;return Y?r.createElement("div",{className:(0,n.Z)(Z+"-content",Z+"-single")},r.createElement("span",{ref:R,className:Z+"-text"},A)):O?r.createElement("div",{className:(0,n.Z)(Z+"-content",Z+"-multiple"),title:K.tooltip||!U||V?void 0:I},!V&&X(),r.createElement("span",{ref:R,className:(0,n.Z)(Z+"-text",((t={})[Z+"-collapsed"]=!V,t)),style:{WebkitBoxOrient:"vertical",MozBoxOrient:"vertical",WebkitLineClamp:d}},A),V&&X()):r.createElement("div",{className:(0,n.Z)(Z+"-content",Z+"-multiple",((e={})[Z+"-collapsed"]=!V,e)),style:{WebkitBoxOrient:"vertical",MozBoxOrient:"vertical",WebkitLineClamp:d},title:K.tooltip||!U||V?void 0:I},!V&&X(),r.createElement("span",{ref:R,className:Z+"-text"},A),V&&X())};return r.createElement("div",{ref:P,className:(0,n.Z)(Z,h),style:u},S?null:r.createElement(p.Z,{onResize:q},r.createElement("div",{className:Y?(0,n.Z)(Z+"-content-mirror",Z+"-single"):(0,n.Z)(Z+"-content-mirror",Z+"-multiple",Z+"-collapsed"),style:{WebkitBoxOrient:"vertical",MozBoxOrient:"vertical",WebkitLineClamp:d},ref:N},r.createElement(p.Z,{onResize:q},r.createElement("span",{ref:z,className:Z+"-text"},A)))),S?r.createElement("div",{className:Z+"-content"},r.createElement("span",{ref:R,className:Z+"-text"},A)):K.tooltip?r.createElement(c.Z,_({content:I,popupVisible:F,disabled:!U||V,triggerProps:{mouseEnterDelay:100},onVisibleChange:function(t){t?U&&!V&&j(!0):j(!1)}},K.tooltipProps),J()):J())});a.Title=o.Z,a.Text=u,a.Paragraph=d.Z,a.Ellipsis=S;let k=a},8028:function(t,e,i){"use strict";i.d(e,{Z:function(){return h}});var r=i(4194),n=i(8007),s=i(2315),a=i(8429),o=function(){return(o=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},l=(0,r.forwardRef)(function(t,e){var i=t.spacing,l=t.className,h=(0,(0,r.useContext)(a.E).getPrefixCls)("typography"),u="close"===(void 0===i?"default":i)?(0,s.Z)(h+"-spacing-close",l):l;return r.createElement(n.Z,o({},t,{ref:e,componentType:"Paragraph",className:u}))});l.displayName="Paragraph";let h=l},8746:function(t,e,i){"use strict";i("4290"),i("3654"),i("8718")},9258:function(t,e,i){"use strict";i.d(e,{Z:function(){return l}});var r=i(4194),n=i(8007),s=function(){return(s=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},a=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},o=(0,r.forwardRef)(function(t,e){var i=t.heading,o=a(t,["heading"]);return r.createElement(n.Z,s({heading:void 0===i?1:i},o,{componentType:"Title",ref:e}))});o.displayName="Title";let l=o},2920:function(t,e,i){"use strict";i.d(e,{Z:function(){return l}});var r=i(4194),n=i(2315),s=i(8429),a=function(){return(a=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},o=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i};function l(t){var e,i=t.children,l=t.className,h=t.disabled,u=t.prefix,d=t.size,c=void 0===d?"default":d,p=o(t,["children","className","disabled","prefix","size"]),g=(0,(0,r.useContext)(s.E).getPrefixCls)("icon-hover");return r.createElement("span",a({className:(0,n.Z)(g,((e={})[u+"-icon-hover"]=u,e[g+"-size-"+c]=c&&"default"!==c,e[g+"-disabled"]=h,e),l),onClick:t.onClick},p),i)}},9027:function(t,e,i){"use strict";i.d(e,{Z:function(){return d}});var r=i(4194),n=i(8977),s=i(9743),a=i(98),o=function(){return(o=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},l=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]]);return i},h=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},u=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))};function d(t){var e=t.children,i=l(t,["children"]),d=(0,r.useRef)(),c=(0,r.useRef)(),p=(0,r.useMemo)(function(){return void 0===t.nodeRef&&(0,s.Yr)(e)&&(0,r.isValidElement)(e)?(c.current=!0,(0,r.cloneElement)(e,{ref:function(t){d.current=(0,a.m$)(t),(0,a.Kq)(e,t)}})):(c.current=!1,e)},[e,t.nodeRef]);return c.current&&["onEnter","onEntering","onEntered","onExit","onExiting","onExited"].forEach(function(e){t[e]&&(i[e]=function(i){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];t[e].apply(t,u([d.current],h(r),!1))})}),r.createElement(n.Z,o({},i,{nodeRef:c.current?d:void 0}),p)}},2315:function(t,e,i){"use strict";i.d(e,{Z:function(){return o}});var r=i(9743),n=i(1420),s=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},a=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))};function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t.length,o=[],l=0;l<i;l++)!function(e){var i=t[e];if(!i)return;(0,r.HD)(i)?o.push(i):(0,r.kJ)(i)?o=o.concat(i):(0,r.Kn)(i)?Object.keys(i).forEach(function(t){i[t]&&o.push(t)}):(0,n.Z)(!0,"arguments must be one of string/array/object.")}(l);return a([],s(new Set(o)),!1).join(" ")}},6132:function(t,e,i){"use strict";i.d(e,{ET:()=>n,S1:()=>a,on:()=>s,r3:()=>o,IF:()=>h,Ib:()=>l});var r=function(){},n=function(){try{return!("undefined"!=typeof window&&void 0!==document)}catch(t){return!0}}(),s=n?r:function(t,e,i,r){t&&t.addEventListener(e,i,r||!1)},a=n?r:function(t,e,i,r){t&&t.removeEventListener(e,i,r||!1)},o=function(t,e){if(!t)return!1;if(t.contains)return t.contains(e);for(var i=e;i;){if(i===t)return!0;i=i.parentNode}return!1},l=function(t){var e=t===document.documentElement?t.clientHeight:t.offsetHeight,i=t===document.documentElement?t.clientWidth:t.offsetWidth;return t.scrollHeight>e||t.scrollWidth>i},h=function(t,e){void 0===e&&(e=document.documentElement);for(var i=[],r=t;r&&r!==e;)l(r)&&i.push(r),r=r.parentElement;return i}},992:function(t,e,i){"use strict";i.d(e,{Z:function(){return n}});var r=i(4194);function n(){var t=(0,r.useRef)(!0);return(0,r.useEffect)(function(){t.current=!1},[]),t.current}},4308:function(t,e,i){"use strict";i.d(e,{Z:function(){return n}});var r=i(4194);let n=i(6132).ET?r.useEffect:r.useLayoutEffect},8569:function(t,e,i){"use strict";i.d(e,{Z:function(){return s}});var r=i(4194),n=i(8564);function s(t){return(0,r.useCallback)(function(e){return{onKeyDown:function(i){var r,s,a,o,l,h,u=i.keyCode||i.which;u===n.Ce.code&&(null===(r=e.onPressEnter)||void 0===r||r.call(e,i)),u===n.K5.code&&(null===(s=e.onArrowDown)||void 0===s||s.call(e,i)),u===n.Xd.code&&(null===(a=e.onArrowLeft)||void 0===a||a.call(e,i)),u===n.ol.code&&(null===(o=e.onArrowRight)||void 0===o||o.call(e,i)),u===n.a2.code&&(null===(l=e.onArrowUp)||void 0===l||l.call(e,i)),null===(h=null==t?void 0:t.onKeyDown)||void 0===h||h.call(t,i)}}},[])}},2888:function(t,e,i){"use strict";i.d(e,{Z:function(){return a}});var r=i(4194),n=i(4672),s=function(){return(s=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function a(t,e,i){var a=t._ignorePropsFromGlobal,o=(0,r.useMemo)(function(){return s(s({},e),a?{}:i)},[e,i,a]);return(0,r.useMemo)(function(){var e=(0,n.Z)(t,["_ignorePropsFromGlobal"]);for(var i in o)void 0===e[i]&&(e[i]=o[i]);return e},[t,o])}},3779:function(t,e,i){"use strict";i.d(e,{Z:()=>a});var r=i("4194"),n=i("9743"),s=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a};function a(t,e){var i,a,o=e||{},l=o.defaultValue,h=o.value,u=(0,r.useRef)(!0);var d=(i=h,a=(0,r.useRef)(),(0,r.useEffect)(function(){a.current=i}),a.current),c=s((0,r.useState)((0,n.o8)(h)?(0,n.o8)(l)?t:l:h),2),p=c[0],g=c[1];return(0,r.useEffect)(function(){if(u.current){u.current=!1;return}void 0===h&&d!==h&&g(h)},[h]),[(0,n.o8)(h)?p:h,g,p]}},9743:function(t,e,i){"use strict";i.d(e,{HD:function(){return d},Kn:function(){return u},U$:function(){return f},Yr:function(){return x},hj:function(){return c},kJ:function(){return h},mf:function(){return g},o8:function(){return p},yO:function(){return y}});var r,n,s=i(4194),a=i(6321),o=i(7101),l=Object.prototype.toString;function h(t){return"[object Array]"===l.call(t)}function u(t){return"[object Object]"===l.call(t)}function d(t){return"[object String]"===l.call(t)}function c(t){return"[object Number]"===l.call(t)&&t==t}function p(t){return void 0===t}function g(t){return"function"==typeof t}function f(t,e){return null==t||!1===t||"string"==typeof t&&(e?""===t.trim():""===t)||!1}var m=function(t){return t&&(0,s.isValidElement)(t)&&"function"==typeof t.type},v=function(t){var e;return m(t)&&!!(null===(e=t.type.prototype)||void 0===e?void 0:e.isReactComponent)},y=Number(null===(r=a.version)||void 0===r?void 0:r.split(".")[0])>17,_=Number(null===(n=a.version)||void 0===n?void 0:n.split(".")[0])>18,b=function(t){if(!_)return(0,o.isForwardRef)(t);var e=Symbol.for("react.element"),i=Symbol.for("react.transitional.element"),r=Symbol.for("react.forward_ref");if("object"==typeof t&&null!==t){var n=t.$$typeof;if(n===e||n===i){var s=t.type;return(s&&s.$$typeof)===r}}return!1},x=function(t){var e;return e=t,!!((0,s.isValidElement)(e)&&"string"==typeof e.type||b(t))||!!m(t)&&v(t)}},8564:function(t,e,i){"use strict";i.d(e,{AV:function(){return n},Ce:function(){return r},K5:function(){return a},Xd:function(){return o},a2:function(){return s},ol:function(){return l}});var r={key:"Enter",code:13},n={key:"Escape",code:27},s={key:"ArrowUp",code:38},a={key:"ArrowDown",code:40},o={key:"ArrowLeft",code:37},l={key:"ArrowRight",code:39}},4672:function(t,e,i){"use strict";i.d(e,{Z:function(){return n}});var r=function(){return(r=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function n(t,e){var i=r({},t);return e.forEach(function(t){t in i&&delete i[t]}),i}},8929:function(t,e,i){"use strict";function r(t,e){var i={};return e.forEach(function(e){e in t&&(i[e]=t[e])}),i}function n(t){var e={};return t&&Object.keys(t).forEach(function(i){var r=String(i);0===r.indexOf("data-")&&(e[r]=t[r]),0===r.indexOf("aria-")&&(e[r]=t[r])}),e}i.d(e,{Z:function(){return r},m:function(){return n}})},3520:function(t,e,i){"use strict";i.d(e,{N:function(){return s},W:function(){return n}});var r="undefined"==typeof window?i.g:window,n=r.requestAnimationFrame,s=r.cancelAnimationFrame;if((!n||!s)&&(["webkit","ms","moz","o"].some(function(t){return n=r[t+"RequestAnimationFrame"],s=r[t+"CancelAnimationFrame"]||r[t+"CancelRequestAnimationFrame"],n&&s}),!n||!s)){var a=0;n=function(t){var e=Date.now(),i=Math.max(0,16-(e-a));return setTimeout(function(){t(),a=e+i},i)},s=function(t){clearTimeout(t)}}n=n.bind(r),s=s.bind(r)},98:function(t,e,i){"use strict";i.d(e,{Kq:function(){return p},m$:function(){return c},sY:function(){return g}});var r,n,s,a=i(4194),o=i(6321),l=i(9743),h=i(1420),u="__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED",d=function(t){(0,l.Kn)(o[u])&&(o[u].usingClientEntryPoint=t)};try{n=o.createRoot}catch(t){}r=l.yO&&n?function(t,e){d(!0);var i=n(e);return d(!1),i.render(t),i._unmount=function(){setTimeout(function(){var t;null===(t=null==i?void 0:i.unmount)||void 0===t||t.call(i)})},i}:function(t,e){return o.render(t,e),{render:function(t){o.render(t,e)},_unmount:function(){o.unmountComponentAtNode(e)}}};var c=function(t,e){return t&&t instanceof Element?t:t&&t.current&&t.current instanceof Element?t.current:t&&(0,l.mf)(t.getRootDOMNode)?t.getRootDOMNode():t instanceof a.Component&&o.findDOMNode?o.findDOMNode(t):e&&((0,h.Z)(l.yO&&!function(t){var e=t.constructor;if("function"!=typeof e)return!1;!s&&"function"==typeof WeakSet&&(s=new WeakSet);var i=!!(null==s?void 0:s.has(e));return null==s||s.add(e),i}(e),"Element does not define the `getRootDOMNode` method causing a call to React.findDOMNode. but findDOMNode is deprecated in StrictMode. Please check the code logic",{element:t,instance:e}),o.findDOMNode)?o.findDOMNode(e):null},p=function(t,e){t&&t.ref&&((0,l.mf)(t.ref)&&(null==t||t.ref(e)),"current"in t.ref&&(t.ref.current=e))},g=r},263:function(t,e,i){"use strict";i.d(e,{Z:function(){return d}});var r,n=i(4194),s=i(759),a=i(4633),o=i.n(a),l=i(98),h=i(9743);var u=(r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});let d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getRootElement=function(){var t=e.props.getTargetDOMNode;return(0,l.m$)((null==t?void 0:t())||e.rootDOMRef,e)},e.getRootDOMNode=function(){return e.getRootElement()},e.componentWillUnmount=function(){e.resizeObserver&&e.destroyResizeObserver()},e.createResizeObserver=function(){var t=e.props.throttle,i=function(t){var i,r;null===(r=(i=e.props).onResize)||void 0===r||r.call(i,t)},r=void 0===t||t?o()(i):i,n=!0;e.resizeObserver=new s.Z(function(t){n&&(n=!1,i(t)),r(t)});var a=e.getRootElement();a&&e.resizeObserver.observe(a)},e.destroyResizeObserver=function(){e.resizeObserver&&e.resizeObserver.disconnect(),e.resizeObserver=null},e}return u(e,t),e.prototype.componentDidMount=function(){n.isValidElement(this.props.children)?this.createResizeObserver():console.warn("The children of ResizeObserver is invalid.")},e.prototype.componentDidUpdate=function(){!this.resizeObserver&&this.getRootElement()&&this.createResizeObserver()},e.prototype.render=function(){var t=this,e=this.props.children;return(0,h.Yr)(e)&&(0,n.isValidElement)(e)&&!this.props.getTargetDOMNode?(0,n.cloneElement)(e,{ref:function(i){t.rootDOMRef=i,(0,l.Kq)(e,i)}}):(this.rootDOMRef=null,this.props.children)},e}(n.Component)},3095:function(t,e,i){"use strict";i.d(e,{ZP:function(){return h},c4:function(){return n},f:function(){return s}});var r=function(){return(r=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},n=["xxxl","xxl","xl","lg","md","sm","xs"],s={xs:"(max-width: 575px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",xxl:"(min-width: 1600px)",xxxl:"(min-width: 2000px)"},a=[],o=-1,l={};let h={matchHandlers:{},dispatch:function(t,e){return l=t,!(a.length<1)&&(a.forEach(function(t){t.func(l,e)}),!0)},subscribe:function(t){0===a.length&&this.register();var e=(++o).toString();return a.push({token:e,func:t}),t(l,null),e},unsubscribe:function(t){0===(a=a.filter(function(e){return e.token!==t})).length&&this.unregister()},unregister:function(){var t=this;Object.keys(s).forEach(function(e){var i=s[e],r=t.matchHandlers[i];r&&r.mql&&r.listener&&r.mql.removeListener(r.listener)})},register:function(){var t=this;Object.keys(s).forEach(function(e){var i=s[e],n=function(i){var n,s=i.matches;t.dispatch(r(r({},l),((n={})[e]=s,n)),e)},a=window.matchMedia(i);a.addListener(n),t.matchHandlers[i]={mql:a,listener:n},n(a)})}}},9968:function(t,e,i){"use strict";i.d(e,{Z:function(){return a}});var r=i(3520),n=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a},s=function(t,e,i){if(i||2==arguments.length)for(var r,n=0,s=e.length;n<s;n++)(r||!(n in e))&&(!r&&(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))};function a(t){var e=null,i=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];e&&(0,r.N)(e),e=(0,r.W)(function(){t.apply(void 0,s([],n(i),!1)),e=null})};return i.cancel=function(){(0,r.N)(e),e=null},i}},1420:function(t,e,i){"use strict";function r(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r]}i.d(e,{Z:function(){return r}})},672:function(t,e,i){"use strict";i.d(e,{Z:function(){return u}});var r=i(9933),n=i(8336),s=i(4194),a=i(5296);function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){(0,n.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var h=s.forwardRef(function(t,e){var i=(0,s.useContext)(a.P).prefixCls,n=void 0===i?"arco":i,o=t.spin,h=t.className,u=l(l({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(h?h+" ":"").concat(n,"-icon ").concat(n,"-icon-check-circle-fill")});return o&&(u.className="".concat(u.className," ").concat(n,"-icon-loading")),delete u.spin,delete u.isIcon,s.createElement("svg",(0,r.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},u),s.createElement("path",{fill:"currentColor",fillRule:"evenodd",stroke:"none",d:"M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Zm10.207-24.379a1 1 0 0 0 0-1.414l-1.414-1.414a1 1 0 0 0-1.414 0L22 26.172l-4.878-4.88a1 1 0 0 0-1.415 0l-1.414 1.415a1 1 0 0 0 0 1.414l7 7a1 1 0 0 0 1.414 0l11.5-11.5Z",clipRule:"evenodd"}))});h.defaultProps={isIcon:!0},h.displayName="IconCheckCircleFill";let u=h},6807:function(t,e,i){"use strict";i.d(e,{Z:function(){return u}});var r=i(9933),n=i(8336),s=i(4194),a=i(5296);function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){(0,n.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var h=s.forwardRef(function(t,e){var i=(0,s.useContext)(a.P).prefixCls,n=void 0===i?"arco":i,o=t.spin,h=t.className,u=l(l({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(h?h+" ":"").concat(n,"-icon ").concat(n,"-icon-close")});return o&&(u.className="".concat(u.className," ").concat(n,"-icon-loading")),delete u.spin,delete u.isIcon,s.createElement("svg",(0,r.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},u),s.createElement("path",{d:"M9.857 9.858 24 24m0 0 14.142 14.142M24 24 38.142 9.858M24 24 9.857 38.142"}))});h.defaultProps={isIcon:!0},h.displayName="IconClose";let u=h},4716:function(t,e,i){"use strict";i.d(e,{Z:function(){return u}});var r=i(9933),n=i(8336),s=i(4194),a=i(5296);function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){(0,n.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var h=s.forwardRef(function(t,e){var i=(0,s.useContext)(a.P).prefixCls,n=void 0===i?"arco":i,o=t.spin,h=t.className,u=l(l({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(h?h+" ":"").concat(n,"-icon ").concat(n,"-icon-down")});return o&&(u.className="".concat(u.className," ").concat(n,"-icon-loading")),delete u.spin,delete u.isIcon,s.createElement("svg",(0,r.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},u),s.createElement("path",{d:"M39.6 17.443 24.043 33 8.487 17.443"}))});h.defaultProps={isIcon:!0},h.displayName="IconDown";let u=h},4151:function(t,e,i){"use strict";i.d(e,{Z:function(){return u}});var r=i(9933),n=i(8336),s=i(4194),a=i(5296);function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){(0,n.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var h=s.forwardRef(function(t,e){var i=(0,s.useContext)(a.P).prefixCls,n=void 0===i?"arco":i,o=t.spin,h=t.className,u=l(l({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(h?h+" ":"").concat(n,"-icon ").concat(n,"-icon-left")});return o&&(u.className="".concat(u.className," ").concat(n,"-icon-loading")),delete u.spin,delete u.isIcon,s.createElement("svg",(0,r.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},u),s.createElement("path",{d:"M32 8.4 16.444 23.956 32 39.513"}))});h.defaultProps={isIcon:!0},h.displayName="IconLeft";let u=h},8773:function(t,e,i){"use strict";i.d(e,{Z:function(){return u}});var r=i(9933),n=i(8336),s=i(4194),a=i(5296);function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){(0,n.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var h=s.forwardRef(function(t,e){var i=(0,s.useContext)(a.P).prefixCls,n=void 0===i?"arco":i,o=t.spin,h=t.className,u=l(l({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(h?h+" ":"").concat(n,"-icon ").concat(n,"-icon-loading")});return o&&(u.className="".concat(u.className," ").concat(n,"-icon-loading")),delete u.spin,delete u.isIcon,s.createElement("svg",(0,r.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},u),s.createElement("path",{d:"M42 24c0 9.941-8.059 18-18 18S6 33.941 6 24 14.059 6 24 6"}))});h.defaultProps={isIcon:!0},h.displayName="IconLoading";let u=h},2239:function(t,e,i){"use strict";i.d(e,{Z:function(){return u}});var r=i(9933),n=i(8336),s=i(4194),a=i(5296);function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){(0,n.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var h=s.forwardRef(function(t,e){var i=(0,s.useContext)(a.P).prefixCls,n=void 0===i?"arco":i,o=t.spin,h=t.className,u=l(l({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(h?h+" ":"").concat(n,"-icon ").concat(n,"-icon-play-arrow")});return o&&(u.className="".concat(u.className," ").concat(n,"-icon-loading")),delete u.spin,delete u.isIcon,s.createElement("svg",(0,r.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},u),s.createElement("path",{d:"M12.533 7.965A1 1 0 0 0 11 8.81v30.377a1 1 0 0 0 1.533.846L36.656 24.84a1 1 0 0 0 0-1.692L12.533 7.965Z"}))});h.defaultProps={isIcon:!0},h.displayName="IconPlayArrow";let u=h},6464:function(t,e,i){"use strict";i.d(e,{Z:function(){return u}});var r=i(9933),n=i(8336),s=i(4194),a=i(5296);function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){(0,n.Z)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var h=s.forwardRef(function(t,e){var i=(0,s.useContext)(a.P).prefixCls,n=void 0===i?"arco":i,o=t.spin,h=t.className,u=l(l({"aria-hidden":!0,focusable:!1,ref:e},t),{},{className:"".concat(h?h+" ":"").concat(n,"-icon ").concat(n,"-icon-right")});return o&&(u.className="".concat(u.className," ").concat(n,"-icon-loading")),delete u.spin,delete u.isIcon,s.createElement("svg",(0,r.Z)({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},u),s.createElement("path",{d:"m16 39.513 15.556-15.557L16 8.4"}))});h.defaultProps={isIcon:!0},h.displayName="IconRight";let u=h},5296:function(t,e,i){"use strict";i.d(e,{P:function(){return r}});var r=(0,i(4194).createContext)({prefixCls:"arco"})},7236:function(){},4290:function(){},6109:function(t,e,i){"use strict";let r,n,s,a,o,l,h,u,d,c,p,g,f,m,v,y;i.d(e,{ZPm:()=>GT});var _,b,x,S,k,A,w,M,C,T,E,O,P,R,B,I,L,D,F,j,N,z,H,V,W,G,U,$,Y,K,Z,X,q,J,Q,tt,te,ti,tr,tn,ts,ta,to,tl,th,tu,td,tc,tp,tg,tf,tm,tv,ty,t_,tb,tx,tS,tk,tA,tw,tM,tC,tT,tE,tO,tP,tR,tB,tI,tL,tD,tF,tj,tN,tz,tH,tV,tW,tG,tU,t$,tY,tK,tZ,tX,tq,tJ,tQ,t0,t1,t2,t3,t5,t4,t8,t6,t9,t7,et,ee,ei,er,en,es,ea,eo,el,eh,eu,ed,ec,ep={};i.r(ep),i.d(ep,{Color:()=>n$,DEFAULT_COLORS:()=>nz,RGB:()=>nY,hexToRgb:()=>xG,hslToRgb:()=>nD,interpolateRgb:()=>x$,rgbToHex:()=>xU,rgbToHsl:()=>nF});let eg=t=>t;(lr=lb||(lb={}))["desktop-browser"]="desktop-browser",lr["mobile-browser"]="mobile-browser",lr.node="node",lr.worker="worker",lr.miniApp="miniApp",lr.wx="wx",lr.tt="tt",lr.harmony="harmony",lr["desktop-miniApp"]="desktop-miniApp",lr.lynx="lynx",(ln=lx||(lx={})).cartesianAxis="cartesianAxis",ln.cartesianBandAxis="cartesianAxis-band",ln.cartesianLinearAxis="cartesianAxis-linear",ln.cartesianTimeAxis="cartesianAxis-time",ln.cartesianLogAxis="cartesianAxis-log",ln.cartesianSymlogAxis="cartesianAxis-symlog",ln.polarAxis="polarAxis",ln.polarBandAxis="polarAxis-band",ln.polarLinearAxis="polarAxis-linear",ln.crosshair="crosshair",ln.cartesianCrosshair="cartesianCrosshair",ln.polarCrosshair="polarCrosshair",ln.dataZoom="dataZoom",ln.geoCoordinate="geoCoordinate",ln.indicator="indicator",ln.discreteLegend="discreteLegend",ln.continuousLegend="continuousLegend",ln.colorLegend="colorLegend",ln.sizeLegend="sizeLegend",ln.mapLabel="mapLabel",ln.markLine="markLine",ln.markArea="markArea",ln.markPoint="markPoint",ln.polarMarkLine="polarMarkLine",ln.polarMarkArea="polarMarkArea",ln.polarMarkPoint="polarMarkPoint",ln.geoMarkPoint="geoMarkPoint",ln.tooltip="tooltip",ln.title="title",ln.player="player",ln.scrollBar="scrollBar",ln.label="label",ln.totalLabel="totalLabel",ln.brush="brush",ln.poptip="poptip",ln.customMark="customMark";var ef=i("1883"),em=i.n(ef);let ev=(t,e)=>Object.prototype.toString.call(t)===`[object ${e}]`,ey=(t,e=!1)=>{let i=typeof t;return e?"number"===i:"number"===i||ev(t,"Number")},e_="undefined"!=typeof console;function eb(t,e,i){let r=[e].concat([].slice.call(i));e_&&console[t].apply(console,r)}(ls=lS||(lS={}))[ls.None=0]="None",ls[ls.Error=1]="Error",ls[ls.Warn=2]="Warn",ls[ls.Info=3]="Info",ls[ls.Debug=4]="Debug";class ex{static getInstance(t,e){return ex._instance&&ey(t)?ex._instance.level(t):ex._instance||(ex._instance=new ex(t,e)),ex._instance}static setInstance(t){return ex._instance=t}static setInstanceLevel(t){ex._instance?ex._instance.level(t):ex._instance=new ex(t)}static clearInstance(){ex._instance=null}constructor(t=lS.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){let e=this._onErrorHandler.findIndex(e=>e===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=lS.Info}canLogDebug(){return this._level>=lS.Debug}canLogError(){return this._level>=lS.Error}canLogWarn(){return this._level>=lS.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=lS.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):eb(null!==(e=this._method)&&void 0!==e?e:"error","ERROR",t)),this}warn(...t){return this._level>=lS.Warn&&eb(this._method||"warn","WARN",t),this}info(...t){return this._level>=lS.Info&&eb(this._method||"log","INFO",t),this}debug(...t){return this._level>=lS.Debug&&eb(this._method||"log","DEBUG",t),this}}ex._instance=null;let eS=0;function ek(t="dataset"){return eS>1e8&&(eS=0),t+"_"+eS++}class eA{constructor(t){var e;let i;this.options=t,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new(em()),i=(null==t?void 0:t.name)?t.name:ek("dataset"),this.name=i,this._logger=null!==(e=null==t?void 0:t.logger)&&void 0!==e?e:ex.getInstance()}setLogger(t){this._logger=t}getDataView(t){return this.dataViewMap[t]}setDataView(t,e){var i;this.dataViewMap[t]&&(null===(i=this._logger)||void 0===i||i.error(`Error: dataView ${t} \u{4E4B}\u{524D}\u{5DF2}\u{5B58}\u{5728}\u{FF0C}\u{8BF7}\u{91CD}\u{65B0}\u{547D}\u{540D}`)),this.dataViewMap[t]=e}removeDataView(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}registerParser(t,e){var i;this.parserMap[t]&&(null===(i=this._logger)||void 0===i||i.warn(`Warn: transform ${t} \u{4E4B}\u{524D}\u{5DF2}\u{6CE8}\u{518C}\u{FF0C}\u{6267}\u{884C}\u{8986}\u{76D6}\u{903B}\u{8F91}`)),this.parserMap[t]=e}removeParser(t){this.parserMap[t]=null,delete this.parserMap[t]}getParser(t){return this.parserMap[t]||this.parserMap.default}registerTransform(t,e){var i;this.transformMap[t]&&(null===(i=this._logger)||void 0===i||i.warn(`Warn: transform ${t} \u{4E4B}\u{524D}\u{5DF2}\u{6CE8}\u{518C}\u{FF0C}\u{6267}\u{884C}\u{8986}\u{76D6}\u{903B}\u{8F91}`)),this.transformMap[t]=e}removeTransform(t){this.transformMap[t]=null,delete this.transformMap[t]}getTransform(t){return this.transformMap[t]}multipleDataViewAddListener(t,e,i){this._callMap||(this._callMap=new Map);let r=this._callMap.get(i);r||(r=()=>{t.some(t=>t.isRunning)||i()}),t.forEach(t=>{t.target.addListener(e,r)}),this._callMap.set(i,r)}allDataViewAddListener(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}multipleDataViewRemoveListener(t,e,i){if(this._callMap){let r=this._callMap.get(i);r&&t.forEach(t=>{t.target.removeListener(e,r)}),this._callMap.delete(i)}}multipleDataViewUpdateInParse(t){t.forEach(t=>{var e;return null===(e=this.getDataView(t.name))||void 0===e?void 0:e.markRunning()}),t.forEach(t=>{var e;return null===(e=this.getDataView(t.name))||void 0===e?void 0:e.parseNewData(t.data,t.options)})}multipleDataViewUpdateInRawData(t){t.forEach(t=>{var e;return null===(e=this.getDataView(t.name))||void 0===e?void 0:e.markRunning()}),t.forEach(t=>{var e;return null===(e=this.getDataView(t.name))||void 0===e?void 0:e.updateRawData(t.data,t.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}let ew=(t,e=!1)=>e?"boolean"==typeof t:!0===t||!1===t||ev(t,"Boolean"),eM=t=>Array.isArray?Array.isArray(t):ev(t,"Array"),eC=(t,e,i)=>{let r=!ew(null==e?void 0:e.dependencyUpdate)||(null==e?void 0:e.dependencyUpdate);if(!t||!eM(t))throw TypeError("Invalid data: must be DataView array!");return eM(i.rawData)&&i.rawData.forEach(t=>{t.target&&(t.target.removeListener("change",i.reRunAllTransform),t.target.removeListener("markRunning",i.markRunning))}),r&&t.forEach(t=>{t.target.addListener("change",i.reRunAllTransform),t.target.addListener("markRunning",i.markRunning)}),t},eT=t=>ev(t,"Date"),eE=(t,e=!1)=>{let i=typeof t;return e?"string"===i:"string"===i||ev(t,"String")},eO=t=>null!=t;function eP(t,e,i){let r;if(!eO(t)||"object"!=typeof t||e&&e(t))return t;let n=eM(t),s=t.length;r=n?Array(s):"object"==typeof t?{}:ew(t)||ey(t)||eE(t)?t:eT(t)?new Date(+t):void 0;let a=n?void 0:Object.keys(Object(t)),o=-1;if(r)for(;++o<(a||t).length;){let n=a?a[o]:o,s=t[n];i&&i.includes(n.toString())?r[n]=s:r[n]=eP(s,e,i)}return r}let eR=function(t){return null!==t&&"function"!=typeof t&&Number.isFinite(t.length)},eB=t=>"object"==typeof t&&null!==t,eI=function(t){if(!eB(t)||!ev(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};function eL(t,e,i=!1,r=!1){if(e&&t!==e&&eO(e)&&"object"==typeof e){let n=Object(e),s=[];for(let t in n)s.push(t);let{length:a}=s,o=-1;for(;a--;){let a=s[++o];!eO(n[a])||"object"!=typeof n[a]||r&&eM(t[a])?eD(t,a,n[a]):function(t,e,i,r=!1,n=!1){let s=t[i],a=e[i],o=e[i],l=!0;if(eM(a)){if(r)o=[];else if(eM(s))o=s;else if(eR(s)){o=Array(s.length);let t=-1,e=s.length;for(;++t<e;)o[t]=s[t]}}else eI(a)?(o=s,"function"!=typeof s&&"object"==typeof s||(o={})):l=!1;l&&eL(o,a,r,n),eD(t,i,o)}(t,e,a,i,r)}}}function eD(t,e,i){(void 0===i||function(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}(t[e],i))&&(void 0!==i||e in t)||(t[e]=i)}function eF(t,...e){let i=-1,r=e.length;for(;++i<r;)eL(t,e[i],!0);return t}let ej=t=>null==t,eN=(t,e)=>{var i,r;if(!(null==e?void 0:e.fields)||0===t.length)return t;let n=e.fields,s=t[0],a={},o=[];for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e)){let l;let h=n[e];if(!h.type){let r=s;e in s||(r=null!==(i=t.find(t=>e in t))&&void 0!==i?i:s),h.type="number"==typeof r[e]?"linear":"ordinal"}if("number"==typeof h.sortIndex&&(l={key:e,type:h.type,index:h.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===h.sortReverse},o.push(l)),(null===(r=h.domain)||void 0===r?void 0:r.length)>0){if("ordinal"===h.type){h._domainCache={},a[e]=h;let t={};h.domain.forEach((e,i)=>{t[e]=i,h._domainCache[e]=i}),l&&(l.sortIndex=t,l.sortIndexCount=h.domain.length)}else h.domain.length>=2&&(a[e]=h)}}return Object.keys(a).length>0&&(t=t.filter(t=>{for(let e in a){let i=a[e];if("ordinal"===i.type){if(!(t[e]in i._domainCache))return!1}else if(i.domain[0]>t[e]||i.domain[1]<t[e])return!1}return!0})),o.sort((t,e)=>t.index-e.index),t.sort((t,e)=>(function(t,e,i){for(let r=0;r<i.length;r++){let n=i[r],s=0;if("ordinal"===n.type?(void 0===n.sortIndex[e[n.key]]&&(n.sortIndex[e[n.key]]=n.sortIndexCount++),void 0===n.sortIndex[t[n.key]]&&(n.sortIndex[t[n.key]]=n.sortIndexCount++),s=n.sortIndex[t[n.key]]-n.sortIndex[e[n.key]]):"linear"===n.type&&(s=t[n.key]-e[n.key]),n.sortReverse&&(s=-s),0!==s)return s}return 0})(t,e,o)),t},ez="_data-view-diff-rank";class eH{constructor(t,e){let i;this.dataSet=t,this.options=e,this.isDataView=!0,this.target=new(em()),this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(t={pushHistory:!0,emitMessage:!0})=>(this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(e=>{this.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1}),this.isLastTransform(e)&&this.diffLastData()}),this.isRunning=!1,!1!==t.emitMessage&&this.target.emit("change",[]),this),this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},i=(null==e?void 0:e.name)?e.name:ek("dataview"),this.name=i,(null==e?void 0:e.history)&&(this.history=e.history,this.historyData=[]),this.dataSet.setDataView(i,this),this.setFields(null==e?void 0:e.fields)}parse(t,e,i=!1){var r;this.isRunning=!0,i&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);let n=this.cloneParseData(t,e);if(null==e?void 0:e.type){let t=(null!==(r=this.dataSet.getParser(e.type))&&void 0!==r?r:this.dataSet.getParser("bytejson"))(n,e.options,this);this.rawData=n,this.parserData=t,this.history&&this.historyData.push(n,t),this.latestData=t}else this.parserData=n,this.rawData=n,this.history&&this.historyData.push(n),this.latestData=n;return this.isRunning=!1,i&&this.target.emit("afterParse",[]),this}transform(t,e=!0){if(this.isRunning=!0,t&&t.type){let i=!0;if("fields"===t.type){this._fields=t.options.fields;let e=this.transformsArr.findIndex(e=>e.type===t.type);e>=0&&(i=!1,this.transformsArr[e].options.fields=this._fields)}if(i&&this.transformsArr.push(t),e){let e=this.isLastTransform(t);this.executeTransform(t),e&&this.diffLastData()}}return this.sortTransform(),this.isRunning=!1,this}isLastTransform(t){return this.transformsArr[this.transformsArr.length-1]===t}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((t,e)=>{var i,r;return(null!==(i=t.level)&&void 0!==i?i:0)-(null!==(r=e.level)&&void 0!==r?r:0)})}executeTransform(t,e={pushHistory:!0,emitMessage:!0}){let{pushHistory:i,emitMessage:r}=e,n=this.dataSet.getTransform(t.type)(this.latestData,t.options);this.history&&!1!==i&&this.historyData.push(n),this.latestData=n,!1!==r&&this.target.emit("change",[])}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}enableDiff(t){this._diffData=!0,this._diffKeys=t,this._diffMap=new Map,this._diffRank=0}disableDiff(){this._diffData=!1,this._diffMap=null,this._diffRank=null}resetDiff(){this._diffMap=new Map,this._diffRank=0}diffLastData(){var t;if(!this._diffData||!this.latestData.forEach||!(null===(t=this._diffKeys)||void 0===t?void 0:t.length))return;let e=this._diffRank+1;if(0===this._diffRank)this.latestData.forEach(t=>{t[ez]=e,this._diffMap.set(this._diffKeys.reduce((e,i)=>e+t[i],""),t)}),this.latestDataAUD={add:Array.from(this.latestData),del:[],update:[]};else{let t;this.latestDataAUD={add:[],del:[],update:[]},this.latestData.forEach(i=>{i[ez]=e,t=this._diffKeys.reduce((t,e)=>t+i[e],""),this._diffMap.get(t)?this.latestDataAUD.update.push(i):this.latestDataAUD.add.push(i),this._diffMap.set(t,i)}),this._diffMap.forEach((t,i)=>{t[ez]<e&&(this.latestDataAUD.del.push(t),this._diffMap.delete(i))})}this._diffRank=e}cloneParseData(t,e){let i=!1;return t instanceof eH||!0!==(null==e?void 0:e.clone)||(i=!0),i?eP(t):t}parseNewData(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}updateRawData(t,e){let i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}getFields(){var t;return this._fields?this._fields:"dataview"===(null===(t=this.parseOption)||void 0===t?void 0:t.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(t,e=!1){this._fields=t&&e?eF({},this._fields,t):t;let i=this.transformsArr.find(t=>"fields"===t.type);!ej(this._fields)&&ej(i)?(this.dataSet.registerTransform("fields",eN),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this._diffMap=null,this._diffRank=null,this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}class eV{static GenAutoIncrementId(){return eV.auto_increment_id++}}eV.auto_increment_id=0;class eW{constructor(t){this.id=eV.GenAutoIncrementId(),this.registry=t}}let eG="named",eU="inject",e$="multi_inject",eY="inversify:tagged",eK="inversify:paramtypes",eZ=function(t){var e;return function(t){let e=Object.prototype.hasOwnProperty,i="function"==typeof Symbol,r=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",n=i&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a=({__proto__:[]})instanceof Array,o=!s&&!a,l={create:s?function(){return x(Object.create(null))}:a?function(){return x({__proto__:null})}:function(){return x({})},has:o?function(t,i){return e.call(t,i)}:function(t,e){return e in t},get:o?function(t,i){return e.call(t,i)?t[i]:void 0}:function(t,e){return t[e]}},h=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){let t={},e=[],i=function(){function t(t,e,i){this._index=0,this._keys=t,this._values=e,this._selector=i}return t.prototype["@@iterator"]=function(){return this},t.prototype[n]=function(){return this},t.prototype.next=function(){let t=this._index;if(t>=0&&t<this._keys.length){let i=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:i,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){let e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){let i=this._find(t,!0);return this._values[i]=e,this},e.prototype.delete=function(e){let i=this._find(e,!1);if(i>=0){let r=this._keys.length;for(let t=i+1;t<r;t++)this._keys[t-1]=this._keys[t],this._values[t-1]=this._values[t];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new i(this._keys,this._values,r)},e.prototype.values=function(){return new i(this._keys,this._values,s)},e.prototype.entries=function(){return new i(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[n]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function s(t,e){return e}function a(t,e){return[t,e]}}():Map,c=(u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){return function(){function t(){this._map=new d}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[n]=function(){return this.keys()},t}()}():Set,new(u||"function"!=typeof WeakMap?function(){let t=l.create(),i=r();return function(){function t(){this._key=r()}return t.prototype.has=function(t){let e=n(t,!1);return void 0!==e&&l.has(e,this._key)},t.prototype.get=function(t){let e=n(t,!1);return void 0!==e?l.get(e,this._key):void 0},t.prototype.set=function(t,e){return n(t,!0)[this._key]=e,this},t.prototype.delete=function(t){let e=n(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=r()},t}();function r(){let e;do e="@@WeakMap@@"+function(){var t;let e=(t=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(16)):s(new Uint8Array(t),t):s(Array(t),t));e[6]=79&e[6]|64,e[8]=191&e[8]|128;let i="";for(let t=0;t<16;++t){let r=e[t];4!==t&&6!==t&&8!==t||(i+="-"),r<16&&(i+="0"),i+=r.toString(16).toLowerCase()}return i}();while(l.has(t,e));return t[e]=!0,e}function n(t,r){if(!e.call(t,i)){if(!r)return;Object.defineProperty(t,i,{value:l.create()})}return t[i]}function s(t,e){for(let i=0;i<e;++i)t[i]=255*Math.random()|0;return t}}():WeakMap));function p(t,e,i){let r=c.get(t);if(f(r)){if(!i)return;r=new d,c.set(t,r)}let n=r.get(e);if(f(n)){if(!i)return;n=new d,r.set(e,n)}return n}function g(t,e,i){let r=p(e,i,!1);return!f(r)&&function(t){return!!t}(r.has(t))}function f(t){return void 0===t}function m(t){return null===t}function v(t){return"object"==typeof t?null!==t:"function"==typeof t}function y(t){let e=function(t,e){switch(function(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}let i="string",n=function(t,e){let i=t[e];if(null!=i){if(!_(i))throw TypeError();return i}}(t,r);if(void 0!==n){let e=n.call(t,i);if(v(e))throw TypeError();return e}return function(t,e){if("string"===e){let e=t.toString;if(_(e)){let i=e.call(t);if(!v(i))return i}let i=t.valueOf;if(_(i)){let e=i.call(t);if(!v(e))return e}}else{let e=t.valueOf;if(_(e)){let i=e.call(t);if(!v(i))return i}let i=t.toString;if(_(i)){let e=i.call(t);if(!v(e))return e}}throw TypeError()}(t,"default"===i?"number":i)}(t,3);return"symbol"==typeof e?e:""+e}function _(t){return"function"==typeof t}function b(t){let e=Object.getPrototypeOf(t);if("function"!=typeof t||t===h||e!==h)return e;let i=t.prototype,r=i&&Object.getPrototypeOf(i);if(null==r||r===Object.prototype)return e;let n=r.constructor;return"function"!=typeof n||n===t?e:n}function x(t){return t.__=void 0,delete t.__,t}t("defineMetadata",function(t,e,i,r){if(!v(i))throw TypeError();return function(t,e,i,r){p(i,r,!0).set(t,e)}(t,e,i,r)}),t("hasMetadata",function(t,e,i){if(!v(e))throw TypeError();return f(i)||(i=y(i)),function t(e,i,r){if(g(e,i,r))return!0;let n=b(i);return!function(t){return null===t}(n)&&t(e,n,r)}(t,e,i)}),t("hasOwnMetadata",function(t,e,i){if(!v(e))throw TypeError();return f(i)||(i=y(i)),g(t,e,i)}),t("getMetadata",function(t,e,i){if(!v(e))throw TypeError();return f(i)||(i=y(i)),function t(e,i,r){if(g(e,i,r))return function(t,e,i){let r=p(e,i,!1);if(!f(r))return r.get(t)}(e,i,r);let n=b(i);return function(t){return null===t}(n)?void 0:t(e,n,r)}(t,e,i)})}(function(i,r){"function"!=typeof t[i]&&Object.defineProperty(t,i,{configurable:!0,writable:!0,value:r}),e&&e(i,r)}),t}({});function eX(){return function(t){return eZ.defineMetadata(eK,null,t),t}}class eq{constructor(t,e){this.key=t,this.value=e}toString(){return this.key===eG?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}function eJ(t){return(e,i,r)=>{var n,s,a,o,l,h,u,d;let c,p;n=e,s=0,a=r,o=t,l=eY,h=n,u=a.toString(),d=o,c={},eZ.hasOwnMetadata(l,h)&&(c=eZ.getMetadata(l,h)),void 0===(p=c[u])&&(p=[]),p.push(d),c[u]=p,eZ.defineMetadata(l,c,h)}}function eQ(t){return e=>(i,r,n)=>eJ(new eq(t,e))(i,r,n)}let e0=eQ(eU);function e1(t){return eJ(new eq(eG,t))}let e2=Symbol("ContributionProvider");class e3{constructor(t,e){this.serviceIdentifier=t,this.container=e}getContributions(){return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier))),this.caches}}function e5(t,e){t(e2).toDynamicValue(({container:t})=>new e3(e,t)).inSingletonScope().whenTargetNamed(e)}class e4{constructor(t,e){this._args=t,this.name=e,this.taps=[]}tap(t,e){this._tap("sync",t,e)}unTap(t,e){let i="string"==typeof t?t.trim():t.name;i&&(this.taps=this.taps.filter(t=>!(t.name===i&&(!e||t.fn===e))))}_parseOptions(t,e,i){let r;if("string"==typeof e)r={name:e.trim()};else if("object"!=typeof e||null===e)throw Error("Invalid tap options");if("string"!=typeof r.name||""===r.name)throw Error("Missing name for tap");return Object.assign({type:t,fn:i},r)}_tap(t,e,i){this._insert(this._parseOptions(t,e,i))}_insert(t){let e;"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));let i=0;"number"==typeof t.stage&&(i=t.stage);let r=this.taps.length;for(;r>0;){r--;let t=this.taps[r];this.taps[r+1]=t;let n=t.stage||0;if(e){if(e.has(t.name)){e.delete(t.name);continue}if(e.size>0)continue}if(!(n>i)){r++;break}}this.taps[r]=t}}class e8 extends e4{call(...t){this.taps.map(t=>t.fn).forEach(e=>e(...t))}}let e6=Symbol.for("EnvContribution"),e9=Symbol.for("VGlobal");var e7=function(t,e){return function(i,r){e(i,r,t)}};let it=class{get env(){return this._env}get devicePixelRatio(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}get supportEvent(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent}set supportEvent(t){this._env||this.setEnv("browser"),this.envContribution.supportEvent=t}get supportsTouchEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents}set supportsTouchEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=t}get supportsPointerEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents}set supportsPointerEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=t}get supportsMouseEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents}set supportsMouseEvents(t){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=t}get applyStyles(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles}set applyStyles(t){this._env||this.setEnv("browser"),this.envContribution.applyStyles=t}constructor(t){this.contributions=t,this.id=eV.GenAutoIncrementId(),this.hooks={onSetEnv:new e8(["lastEnv","env","global"])},this.measureTextMethod="native",this.optimizeVisible=!1}bindContribution(t){let e=[];if(this.contributions.getContributions().forEach(i=>{let r=i.configure(this,t);r&&r.then&&e.push(r)}),e.length)return Promise.all(e)}getDynamicCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}getStaticCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}setEnv(t,e){if(e&&!0===e.force||this._env!==t)return this.deactiveCurrentEnv(),this.activeEnv(t,e)}deactiveCurrentEnv(){this.envContribution&&this.envContribution.release()}activeEnv(t,e){let i=this._env;this._env=t;let r=this.bindContribution(e);if(r&&r.then)return r.then(()=>{this.envParams=e,this.hooks.onSetEnv.call(i,t,this)});this.envParams=e,this.hooks.onSetEnv.call(i,t,this)}setActiveEnvContribution(t){this.envContribution=t}createCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(t)}createOffscreenCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(t)}releaseCanvas(t){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(t)}addEventListener(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(t,e,i)}removeEventListener(t,e,i){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(t,e,i)}dispatchEvent(t){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(t)}getRequestAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}getCancelAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}getElementById(t){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(t):null}getRootElement(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}getDocument(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}mapToCanvasPoint(t,e){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(t,e):null}loadImage(t){return this._env||this.setEnv("browser"),this.envContribution.loadImage(t)}loadSvg(t){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(t)}loadJson(t){return this._env||this.setEnv("browser"),this.envContribution.loadJson(t)}loadArrayBuffer(t){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(t)}loadBlob(t){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(t)}isChrome(){return null!=this._isChrome||(this._env||this.setEnv("browser"),this._isChrome="browser"===this._env&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}isSafari(){return null!=this._isSafari||(this._env||this.setEnv("browser"),this._isSafari="browser"===this._env&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}getNativeAABBBounds(t){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(t)}removeDom(t){return this._env||this.setEnv("browser"),this.envContribution.removeDom(t)}createDom(t){return this._env||this.setEnv("browser"),this.envContribution.createDom(t)}updateDom(t,e){return this._env||this.setEnv("browser"),this.envContribution.updateDom(t,e)}getElementTop(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTop(t,e)}getElementLeft(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(t,e)}getElementTopLeft(t,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(t,e)}};it=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),e7(0,e0(e2)),e7(0,e1(e6)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],it);let ie=Math.PI,ii=ie/2,ir=2*ie,is=2*Math.PI,ia=Math.abs,io=Math.atan2,il=Math.cos,ih=Math.max,iu=Math.min,id=Math.sin,ic=Math.sqrt,ip=Math.pow;function ig(t){return t>1?0:t<-1?ie:Math.acos(t)}function im(t){return t>=1?ii:t<=-1?-ii:Math.asin(t)}function iv(t,e,i,r,n){let s=i,a=r;return"number"==typeof t&&"number"==typeof i&&(s=(1-n)*t+n*i),"number"==typeof e&&"number"==typeof r&&(a=(1-n)*e+n*r),{x:s,y:a}}function iy(t,e){return t[0]*e[1]-t[1]*e[0]}function i_(t,e=10){return Math.round(t*e)/e}function ib(t){let e=t.toString().split(/[eE]/),i=(e[0].split(".")[1]||"").length-(+e[1]||0);return i>0?i:0}function ix(t,e){return i_(t+e,10**Math.max(ib(t),ib(e)))}function iS(t,e){return i_(t-e,10**Math.max(ib(t),ib(e)))}function ik(t){return Math.PI/180*t}function iA(t){return 180*t/Math.PI}let iw=(t=0)=>{if(t<0)for(;t<-ir;)t+=ir;else if(t>0)for(;t>ir;)t-=ir;return t};function iM(t,e,i){return e?{x:t.x+e*Math.cos(i),y:t.y+e*Math.sin(i)}:{x:t.x,y:t.y}}function iC(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function iT(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}class iE{constructor(t=1,e=0,i=0,r=1,n=0,s=0){this.a=t,this.b=e,this.c=i,this.d=r,this.e=n,this.f=s}equalToMatrix(t){return!(this.e!==t.e||this.f!==t.f||this.a!==t.a||this.d!==t.d||this.b!==t.b||this.c!==t.c)}equalTo(t,e,i,r,n,s){return!(this.e!==n||this.f!==s||this.a!==t||this.d!==r||this.b!==e||this.c!==i)}setValue(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.e=n,this.f=s,this}reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}getInverse(){let t=this.a,e=this.b,i=this.c,r=this.d,n=this.e,s=this.f,a=new iE,o=t*r-e*i;return a.a=r/o,a.b=-e/o,a.c=-i/o,a.d=t/o,a.e=(i*s-r*n)/o,a.f=-(t*s-e*n)/o,a}rotate(t){let e=Math.cos(t),i=Math.sin(t),r=this.a*e+this.c*i,n=this.b*e+this.d*i,s=-(this.a*i)+this.c*e,a=-(this.b*i)+this.d*e;return this.a=r,this.b=n,this.c=s,this.d=a,this}rotateByCenter(t,e,i){let r=Math.cos(t),n=Math.sin(t),s=r*this.a-n*this.b,a=n*this.a+r*this.b,o=r*this.c-n*this.d,l=n*this.c+r*this.d,h=r*this.e-n*this.f+((1-r)*e+n*i),u=n*this.e+r*this.f+((1-r)*i-n*e);return this.a=s,this.b=a,this.c=o,this.d=l,this.e=h,this.f=u,this}scale(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}setScale(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}transform(t,e,i,r,n,s){return this.multiply(t,e,i,r,n,s),this}translate(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}transpose(){let{a:t,b:e,c:i,d:r,e:n,f:s}=this;return this.a=e,this.b=t,this.c=r,this.d=i,this.e=s,this.f=n,this}multiply(t,e,i,r,n,s){let a=this.a,o=this.b,l=this.c,h=this.d,u=a*n+l*s+this.e,d=o*n+h*s+this.f;return this.a=a*t+l*e,this.b=o*t+h*e,this.c=a*i+l*r,this.d=o*i+h*r,this.e=u,this.f=d,this}interpolate(t,e){let i=new iE;return i.a=this.a+(t.a-this.a)*e,i.b=this.b+(t.b-this.b)*e,i.c=this.c+(t.c-this.c)*e,i.d=this.d+(t.d-this.d)*e,i.e=this.e+(t.e-this.e)*e,i.f=this.f+(t.f-this.f)*e,i}transformPoint(t,e){let{a:i,b:r,c:n,d:s,e:a,f:o}=this,l=i*s-r*n,{x:h,y:u}=t;e.x=s/l*h+-n/l*u+(n*o-s*a)/l,e.y=-r/l*h+i/l*u+-(i*o-r*a)/l}onlyTranslate(t=1){return this.a===t&&0===this.b&&0===this.c&&this.d===t}clone(){return new iE(this.a,this.b,this.c,this.d,this.e,this.f)}toTransformAttrs(){let t=this.a,e=this.b,i=this.c,r=this.d,n=t*r-e*i,s={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){let a=Math.sqrt(t*t+e*e);s.rotateDeg=e>0?Math.acos(t/a):-Math.acos(t/a),s.scaleX=a,s.scaleY=n/a,s.skewX=(t*i+e*r)/n,s.skewY=0}else if(0!==i||0!==r){let a=Math.sqrt(i*i+r*r);s.rotateDeg=Math.PI/2-(r>0?Math.acos(-i/a):-Math.acos(i/a)),s.scaleX=n/a,s.scaleY=a,s.skewX=0,s.skewY=(t*i+e*r)/n}return s.rotateDeg=iA(s.rotateDeg),s}}let iO=ir-1e-8;class iP{constructor(t){this.init(t)}init(t){this.bounds=t}arc(t,e,i,r,n,s){if(Math.abs(n-r)>iO)return this.bounds.add(t-i,e-i),void this.bounds.add(t+i,e+i);let a,o,l,h,u=1/0,d=-Infinity,c=1/0,p=-Infinity;function g(t){l=i*Math.cos(t),h=i*Math.sin(t),l<u&&(u=l),l>d&&(d=l),h<c&&(c=h),h>p&&(p=h)}if(g(r),g(n),n!==r){if((r%=ir)<0&&(r+=ir),(n%=ir)<0&&(n+=ir),n<r&&(s=!s,a=r,r=n,n=a),s)for(n-=ir,a=r-r%ii,o=0;o<4&&a>n;++o,a-=ii)g(a);else for(a=r-r%ii+ii,o=0;o<4&&a<n;++o,a+=ii)g(a)}this.bounds.add(t+u,e+c),this.bounds.add(t+d,e+p)}arcTo(t,e,i,r,n){throw Error("\u4E0D\u652F\u6301arcTo")}bezierCurveTo(t,e,i,r,n,s){this.bounds.add(t,e),this.bounds.add(i,r),this.bounds.add(n,s)}closePath(){}ellipse(){throw Error("\u4E0D\u652F\u6301ellipse")}lineTo(t,e){this.bounds.add(t,e)}moveTo(t,e){this.bounds.add(t,e)}quadraticCurveTo(t,e,i,r){this.bounds.add(t,e),this.bounds.add(i,r)}rect(t,e,i,r){this.bounds.add(t,e),this.bounds.add(t+i,e+r)}clear(){this.bounds.clear()}release(...t){}}function iR(t,e,i){let{x1:r,y1:n,x2:s,y2:a}=e;return i.onlyTranslate()?(t!==e&&t.setValue(e.x1,e.y1,e.x2,e.y2),t.translate(i.e,i.f)):(t.clear(),t.add(i.a*r+i.c*n+i.e,i.b*r+i.d*n+i.f),t.add(i.a*s+i.c*n+i.e,i.b*s+i.d*n+i.f),t.add(i.a*s+i.c*a+i.e,i.b*s+i.d*a+i.f),t.add(i.a*r+i.c*a+i.e,i.b*r+i.d*a+i.f)),e}class iB{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new iB(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return eM(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){let r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){let n=this.scalePoints(t,e,i,r);return this.clear().add(n[0],n[1]).add(n[2],n[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return iR(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){let{x1:r,y1:n,x2:s,y2:a}=this,o=Math.cos(t),l=Math.sin(t),h=e-e*o+i*l,u=i-e*l-i*o;return[o*r-l*n+h,l*r+o*n+u,o*r-l*a+h,l*r+o*a+u,o*s-l*n+h,l*s+o*n+u,o*s-l*a+h,l*s+o*a+u]}scalePoints(t,e,i,r){let{x1:n,y1:s,x2:a,y2:o}=this;return[t*n+(1-t)*i,e*s+(1-e)*r,t*a+(1-t)*i,e*o+(1-e)*r]}}class iI extends iB{}class iL{constructor(){this.curves=[],this.bounds=new iI}getCurveLengths(){return this.curves.map(t=>t.getLength())}getPointAt(t){return{x:0,y:0}}getLength(){return 0}getBounds(){return this.bounds}}let iD=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,iF={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},ij={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};(la=lk||(lk={}))[la.NONE=0]="NONE",la[la.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",la[la.UPDATE_SHAPE=2]="UPDATE_SHAPE",la[la.CLEAR_SHAPE=253]="CLEAR_SHAPE",la[la.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",la[la.INIT=179]="INIT",la[la.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",la[la.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",la[la.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",la[la.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",la[la.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",la[la.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",la[la.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",la[la.CLEAR_LAYOUT=127]="CLEAR_LAYOUT",(lo=lA||(lA={}))[lo.GLOBAL=1]="GLOBAL",lo[lo.LOCAL=16]="LOCAL",lo[lo.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",lo[lo.LOCAL_ACCURATE=48]="LOCAL_ACCURATE",(ll=lw||(lw={}))[ll.INIT=0]="INIT",ll[ll.DEFAULT=1]="DEFAULT",ll[ll.STATE=2]="STATE",ll[ll.ANIMATE_BIND=10]="ANIMATE_BIND",ll[ll.ANIMATE_PLAY=11]="ANIMATE_PLAY",ll[ll.ANIMATE_START=12]="ANIMATE_START",ll[ll.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",ll[ll.ANIMATE_END=14]="ANIMATE_END",ll[ll.TRANSLATE=20]="TRANSLATE",ll[ll.TRANSLATE_TO=21]="TRANSLATE_TO",ll[ll.SCALE=22]="SCALE",ll[ll.SCALE_TO=23]="SCALE_TO",ll[ll.ROTATE=24]="ROTATE",ll[ll.ROTATE_TO=25]="ROTATE_TO",(lh=lM||(lM={}))[lh.INITIAL=0]="INITIAL",lh[lh.RUNNING=1]="RUNNING",lh[lh.PAUSED=2]="PAUSED",lh[lh.END=3]="END",(lu=lC||(lC={}))[lu.NORMAL=0]="NORMAL",lu[lu.SET_ATTR_IMMEDIATELY=1]="SET_ATTR_IMMEDIATELY",(ld=lT||(lT={})).wait="wait",ld.from="from",ld.to="to",ld.customAnimate="customAnimate",(lc=lE||(lE={}))[lc.ROW=1]="ROW",lc[lc.COLUMN=2]="COLUMN",(lp=lO||(lO={}))[lp.CubicBezierCurve=0]="CubicBezierCurve",lp[lp.QuadraticBezierCurve=1]="QuadraticBezierCurve",lp[lp.ArcCurve=2]="ArcCurve",lp[lp.LineCurve=3]="LineCurve",lp[lp.EllipseCurve=4]="EllipseCurve",lp[lp.MoveCurve=5]="MoveCurve",(lg=lP||(lP={}))[lg.beforeFillStroke=0]="beforeFillStroke",lg[lg.afterFillStroke=1]="afterFillStroke";function iN(t,e,i,r){let n=function(t,e,i,r,n,s,a,o,l){let h=ik(a),u=Math.sin(h),d=Math.cos(h),c=d*(o-t)*.5+u*(l-e)*.5,p=d*(l-e)*.5-u*(o-t)*.5,g=c*c/((i=Math.abs(i))*i)+p*p/((r=Math.abs(r))*r);g>1&&(i*=g=Math.sqrt(g),r*=g);let f=d/i,m=u/i,v=-u/r,y=d/r,_=f*o+m*l,b=v*o+y*l,x=f*t+m*e,S=v*t+y*e,k=1/((x-_)*(x-_)+(S-b)*(S-b))-.25;k<0&&(k=0);let A=Math.sqrt(k);s===n&&(A=-A);let w=.5*(_+x)-A*(S-b),M=.5*(b+S)+A*(x-_),C=Math.atan2(b-M,_-w),T=Math.atan2(S-M,x-w)-C;T<0&&1===s?T+=ir:T>0&&0===s&&(T-=ir);let E=Math.ceil(Math.abs(T/(ii+.001))),O=[];for(let t=0;t<E;++t){let e=C+t*T/E,n=C+(t+1)*T/E;O[t]=[w,M,e,n,i,r,u,d]}return O}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,i);for(let e=0;e<n.length;++e){let i=function(t){let e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],a=t[5],o=t[6],l=t[7],h=l*s,u=-o*a,d=o*s,c=l*a,p=Math.cos(r),g=Math.sin(r),f=Math.cos(n),m=Math.sin(n),v=.5*(n-r),y=Math.sin(.5*v),_=8/3*y*y/Math.sin(v),b=e+p-_*g,x=i+g+_*p,S=e+f,k=i+m,A=S+_*m,w=k-_*f;return[h*b+u*x,d*b+c*x,h*A+u*w,d*A+c*w,h*S+u*k,d*S+c*k]}(n[e]);t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5])}}let iz=(t,e,i,r,n,s,a)=>{let o=4*Math.tan(Math.abs(i-e)/4)/3,l=i<e?-1:1,h=Math.cos(e),u=Math.sin(e),d=Math.cos(i),c=Math.sin(i),p=d*s+r,g=c*a+n,f=s*o*l,m=a*o*l;t.push(h*s+r-f*u,u*a+n+m*h,p+f*c,g-m*d,p,g)},iH=[(t,e,i,r,n,s,a)=>e.arc(t[1]*n+i,t[2]*s+r,t[3]*(n+s)/2,t[4],t[5],t[6],a),(t,e,i,r,n,s,a)=>e.arcTo(t[1]*n+i,t[2]*s+r,t[3]*n+i,t[4]*s+r,t[5]*(n+s)/2,a),(t,e,i,r,n,s,a)=>e.bezierCurveTo(t[1]*n+i,t[2]*s+r,t[3]*n+i,t[4]*s+r,t[5]*n+i,t[6]*s+r,a),(t,e,i,r)=>e.closePath(),(t,e,i,r,n,s)=>e.ellipse(t[1]*n+i,t[2]*s+r,t[3]*n,t[4]*s,t[5],t[6],t[7],t[8]),(t,e,i,r,n,s,a)=>e.lineTo(t[1]*n+i,t[2]*s+r,a),(t,e,i,r,n,s,a)=>e.moveTo(t[1]*n+i,t[2]*s+r,a),(t,e,i,r,n,s,a)=>e.quadraticCurveTo(t[1]*n+i,t[2]*s+r,t[3]*n+i,t[4]*s+r,a),(t,e,i,r,n,s,a)=>e.rect(t[1]*n+i,t[2]*s+r,t[3]*n,t[4]*s,a)];function iV(t,e,i=0,r=0,n=1,s=1,a){for(let o=0;o<t.length;o++){let l=t[o];iH[l[0]](l,e,i,r,n,s,a)}}class iW{constructor(t=0,e=0,i,r){this.x=0,this.y=0,this.x=t,this.y=e,this.x1=i,this.y1=r}clone(){return new iW(this.x,this.y)}copyFrom(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}set(t,e){return this.x=t,this.y=e,this}add(t){return ey(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}sub(t){return ey(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}multi(t){throw Error("\u6682\u4E0D\u652F\u6301")}div(t){throw Error("\u6682\u4E0D\u652F\u6301")}}class iG{static distancePP(t,e){return ic(ip(t.x-e.x,2)+ip(t.y-e.y,2))}static distanceNN(t,e,i,r){return ic(ip(t-i,2)+ip(e-r,2))}static distancePN(t,e,i){return ic(ip(e-t.x,2)+ip(i-t.y,2))}static pointAtPP(t,e,i){return new iW((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}class iU{getLength(t){return null!=t?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}function i$(t,e,i,r,n){let s=1-n;return s*s*s*t+3*e*n*s*s+3*i*n*n*s+r*n*n*n}function iY(t,e,i,r,n){let s=i$(t.x,e.x,i.x,r.x,n);return new iW(s,i$(t.y,e.y,i.y,r.y,n))}function iK(t,e){let{p0:i,p1:r,p2:n,p3:s}=t,a=iY(i,r,n,s,e),o=iG.pointAtPP(i,r,e),l=iG.pointAtPP(r,n,e),h=iG.pointAtPP(n,s,e),u=iG.pointAtPP(o,l,e),d=iG.pointAtPP(l,h,e);return[new iZ(i,o,u,a),new iZ(a,d,h,s)]}class iZ extends iU{constructor(t,e,i,r){super(),this.type=lO.CubicBezierCurve,this.p0=t,this.p1=e,this.p2=i,this.p3=r}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}getPointAt(t){if(!1!==this.defined)return iY(this.p0,this.p1,this.p2,this.p3,t);throw Error("defined\u4E3Afalse\u7684\u70B9\u4E0D\u80FDgetPointAt")}calcLength(){var t,e,i,r,n;return this._validPoint()?(t=this.p0,e=this.p1,i=this.p2,r=this.p3,n=0,function(t,e){let i=0,r=t.length;for(let n=0;n<r;n++){let s=t[n],a=e[n],o=t[(n+1)%r],l=e[(n+1)%r];i+=iG.distanceNN(s,a,o,l)}return i/2}([t.x,e.x,i.x,r.x],[t.y,e.y,i.y,r.y])):60}calcProjLength(t){return t===lE.ROW?ia(this.p0.x-this.p3.x):t===lE.COLUMN?ia(this.p0.y-this.p3.y):0}getAngleAt(t){let e=ih(t-.01,0),i=iu(t+.01,1),r=this.getPointAt(e),n=this.getPointAt(i);return io(n.y-r.y,n.x-r.x)}}function iX(t,e){let{p0:i,p1:r}=t,n=iG.pointAtPP(i,r,e);return[new iq(i,n),new iq(n,r)]}class iq extends iU{constructor(t,e){super(),this.type=lO.LineCurve,this.p0=t,this.p1=e}getPointAt(t){if(!1!==this.defined)return iG.pointAtPP(this.p0,this.p1,t);throw Error("defined\u4E3Afalse\u7684\u70B9\u4E0D\u80FDgetPointAt")}getAngleAt(t){return null==this.angle&&(this.angle=io(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}calcLength(){return this._validPoint()?iG.distancePP(this.p0,this.p1):60}calcProjLength(t){return t===lE.ROW?ia(this.p0.x-this.p1.x):t===lE.COLUMN?ia(this.p0.y-this.p1.y):0}}class iJ{get endX(){return this._lastX}get endY(){return this._lastY}constructor(t,e){this.init(t,e)}init(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}bezierCurveTo(t,e,i,r,n,s,a,o){let l=new iZ(new iW(this._lastX,this._lastY),new iW(t,e),new iW(i,r),new iW(n,s));l.originP1=this._lastOriginP,l.originP2=o,l.defined=a,this.curves.push(l),this._lastX=n,this._lastY=s,this._lastOriginP=o}closePath(){if(this.curves.length<2)return;let t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}ellipse(){throw Error("SegContext\u4E0D\u652F\u6301\u8C03\u7528ellipse")}lineTo(t,e,i,r){let n=this.addLinearCurve(t,e,i,this._lastOriginP,r);this.curves.push(n),this._lastX=t,this._lastY=e,this._lastOriginP=r}moveTo(t,e,i){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=i,this._startOriginP=i,this}quadraticCurveTo(t,e,i,r){throw Error("SegContext\u4E0D\u652F\u6301\u8C03\u7528quadraticCurveTo")}clear(){this.curves=[],this.length=NaN}tryUpdateLength(t){return this.getLength(t)}addLinearCurve(t,e,i,r,n){let s=new iq(new iW(this._lastX,this._lastY),new iW(t,e));return s.originP1=r,s.originP2=n,s.defined=i,s}getPointAt(t){throw Error("\u6682\u672A\u5B9E\u73B0")}getCurveLengths(){return[]}getLength(t){var e,i;if(t===lE.COLUMN){if(!this.curves.length)return 0;let t=this.curves[0],i=this.curves[this.curves.length-1],r=null!==(e=i.p3)&&void 0!==e?e:i.p1;return ia(t.p0.y-r.y)}if(t===lE.ROW){if(!this.curves.length)return 0;let t=this.curves[0],e=this.curves[this.curves.length-1],r=null!==(i=e.p3)&&void 0!==i?i:e.p1;return ia(t.p0.x-r.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((t,e)=>t+e.getLength(),0)),this.length}}class iQ extends iJ{bezierCurveTo(t,e,i,r,n,s,a,o){return super.bezierCurveTo(e,t,r,i,s,n,a,o)}lineTo(t,e,i,r){return super.lineTo(e,t,i,r)}moveTo(t,e,i){return super.moveTo(e,t,i)}clear(){return super.clear()}}function i0(t,e,i=1){let r=!1;for(let i=0,n=e.length;i<=n;i++)i>=n===r&&((r=!r)?t.lineStart():t.lineEnd()),r&&t.point(e[i])}function i1(t,e,i){let r=null!=e?e:ia(i[i.length-1].x-i[0].x)>ia(i[i.length-1].y-i[0].y)?lE.ROW:lE.COLUMN;return"monotoneY"===t?new iQ(t,r):new iJ(t,r)}class i2{constructor(t,e){this.context=t,e&&(this.startPoint=e)}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t)}this._lastDefined=t.defined}tryUpdateLength(){return this.context.tryUpdateLength()}}function i3(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;let n=i1("linear",i,t);return function(t,e){i0(t,e,1)}(new i2(n,r),t),n}function i5(t,e,i,r,n){t.context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+i)/6,r,t.lastPoint1)}class i4{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){2===this._point&&i5(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;break;default:i5(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function i8(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return i3(t,e);let n=i1("basis",i,t);return i0(new i4(n,r),t,2),n}function i6(t){return t<0?-1:1}function i9(t,e,i){let r=t._x1-t._x0,n=e-t._x1,s=(t._y1-t._y0)/(r||Number(n<0&&-0)),a=(i-t._y1)/(n||Number(r<0&&-0)),o=(s*n+a*r)/(r+n);return((s<0?-1:1)+(a<0?-1:1))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function i7(t,e){let i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function rt(t,e,i,r,n){let s=t._x0,a=t._y0,o=t._x1,l=t._y1,h=(o-s)/3;t.context.bezierCurveTo(s+h,a+h*e,o-h,l-h*i,o,l,r,t.lastPoint1)}class re{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:rt(this,this._t0,i7(this,this._t0),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1)}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let e=NaN,i=t.x,r=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,r,!1!==this._lastDefined1&&!1!==this._lastDefined2,t):this.context.moveTo(i,r,t);break;case 1:this._point=2;break;case 2:this._point=3,rt(this,i7(this,e=i9(this,i,r)),e,!1!==this._lastDefined1&&!1!==this._lastDefined2,t);break;default:rt(this,this._t0,e=i9(this,i,r),!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=r,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=!1!==t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}class ri extends re{constructor(t,e){super(t,e)}point(t){return super.point({y:t.x,x:t.y,defined:t.defined})}}function rr(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return i3(t,e);let n=i1("monotoneX",i,t);return i0(new re(n,r),t,2),n}function rn(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;if(t.length<3-Number(!!r))return i3(t,e);let n=i1("monotoneY",i,t);return i0(new ri(n,r),t,2),n}class rs{constructor(t,e=.5,i){this.context=t,this._t=e,this.startPoint=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){0<this._t&&this._t<1&&2===this._point&&this.context.lineTo(this._x,this._y,!1!==this._lastDefined,this.lastPoint),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}point(t){let e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,i,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(e,i,!1!==this._lastDefined&&!1!==t.defined,t);else{let r=this._x*(1-this._t)+e*this._t;this.context.lineTo(r,this._y,!1!==this._lastDefined&&!1!==t.defined,this.lastPoint),this.context.lineTo(r,i,!1!==this._lastDefined&&!1!==t.defined,t)}}this._lastDefined=t.defined,this._x=e,this._y=i,this.lastPoint=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function ra(t,e,i={}){let{direction:r,startPoint:n}=i;if(t.length<2-Number(!!n))return null;let s=new iJ("step",null!=r?r:ia(t[t.length-1].x-t[0].x)>ia(t[t.length-1].y-t[0].y)?lE.ROW:lE.COLUMN);return function(t,e){i0(t,e,1)}(new rs(s,e,n),t),s}class ro extends i2{lineEnd(){this.context.closePath()}}function rl(t,e={}){let{direction:i,startPoint:r}=e;if(t.length<2-Number(!!r))return null;let n=i1("linear",i,t);return function(t,e){i0(t,e,1)}(new ro(n,r),t),n}function rh(t,e,i,r,n){let s=t._x1,a=t._y1,o=t._x2,l=t._y2;if(t._l01_a>1e-12){let e=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,i=3*t._l01_a*(t._l01_a+t._l12_a);s=(s*e-t._x0*t._l12_2a+t._x2*t._l01_2a)/i,a=(a*e-t._y0*t._l12_2a+t._y2*t._l01_2a)/i}if(t._l23_a>1e-12){let r=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,n=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*r+t._x1*t._l23_2a-e*t._l12_2a)/n,l=(l*r+t._y1*t._l23_2a-i*t._l12_2a)/n}t.context.bezierCurveTo(s,a,o,l,t._x2,t._y2,r,t.lastPoint1)}function ru(t,e){return function(i,r,n={}){let{direction:s,startPoint:a}=n;if(i.length<2-Number(!!a))return null;if(i.length<3-Number(!!a))return i3(i,n);let o=i1(t,s,i);return i0(new e(o,r,a),i,2),o}}let rd=ru("catmullRom",class t{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(t){let{x:e,y:i}=t;if(this._point){let t=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2):this.context.moveTo(e,i);break;case 1:this._point=2;break;case 2:this._point=3;default:rh(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}),rc=ru("catmullRomClosed",class t{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}point(t){let{x:e,y:i}=t;if(this._point){let t=this._x2-e,r=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=i;break;case 1:this._point=2,this.context.moveTo(this._x4=e,this._y4=i,t);break;case 2:this._point=3,this._x5=e,this._y5=i;break;default:rh(this,e,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}});function rp(t,e,i){var r,n;switch(e){case"linear":default:return i3(t,i);case"basis":return i8(t,i);case"monotoneX":return rr(t,i);case"monotoneY":return rn(t,i);case"step":return ra(t,.5,i);case"stepBefore":return ra(t,0,i);case"stepAfter":return ra(t,1,i);case"catmullRom":return rd(t,null!==(r=null==i?void 0:i.curveTension)&&void 0!==r?r:.5,i);case"catmullRomClosed":return rc(t,null!==(n=null==i?void 0:i.curveTension)&&void 0!==n?n:.5,i);case"linearClosed":return rl(t,i)}}class rg extends iL{constructor(t){super(),this.commandList=[],t&&(this._ctx=t),this._boundsContext=new iP(this.bounds)}setCtx(t){this._ctx=t}moveTo(t,e){return this.commandList.push([ij.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}lineTo(t,e){return this.commandList.push([ij.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}quadraticCurveTo(t,e,i,r){return this.commandList.push([ij.Q,t,e,i,r]),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,r),this}bezierCurveTo(t,e,i,r,n,s){return this.commandList.push([ij.C,t,e,i,r,n,s]),this._ctx&&this._ctx.bezierCurveTo(t,e,i,r,n,s),this}arcTo(t,e,i,r,n){return this.commandList.push([ij.AT,t,e,i,r,n]),this._ctx&&this._ctx.arcTo(t,e,i,r,n),this}ellipse(t,e,i,r,n,s,a,o){return this.commandList.push([ij.E,t,e,i,r,n,s,a,o]),this._ctx&&this._ctx.ellipse(t,e,i,r,n,s,a,o),this}rect(t,e,i,r){return this.commandList.push([ij.R,t,e,i,r]),this._ctx&&this._ctx.rect(t,e,i,r),this}arc(t,e,i,r,n,s){return this.commandList.push([ij.A,t,e,i,r,n,s]),this._ctx&&this._ctx.arc(t,e,i,r,n,s),this}closePath(){return this.commandList.push([ij.Z]),this._ctx&&this._ctx.closePath(),this}addCurve(t){this.curves.push(t)}clear(){this.transformCbList=null,this.commandList.length=0,this.curves.length=0}beginPath(){this.clear()}toString(){if(!this.toStringCbList){let t=[];t[ij.M]=t=>`M${t[1]} ${t[2]}`,t[ij.L]=t=>`L${t[1]} ${t[2]}`,t[ij.Q]=t=>`Q${t[1]} ${t[2]} ${t[3]} ${t[4]}`,t[ij.C]=t=>`C${t[1]} ${t[2]} ${t[3]} ${t[4]} ${t[5]} ${t[6]}`,t[ij.A]=t=>{let e=[];iz(e,t[4],t[5],t[1],t[2],t[3],t[3]);let i="";for(let t=0;t<e.length;t+=6)i+=`C${e[t]} ${e[t+1]} ${e[t+2]} ${e[t+3]} ${e[t+4]} ${e[t+5]}`;return i},t[ij.R]=t=>`M${t[1]} ${t[2]} h${t[3]} v${t[4]} H${t[1]}Z`,t[ij.Z]=t=>"Z",this.toStringCbList=t}let t=this.toStringCbList,e="";return this.commandList.forEach(i=>{e+=t[i[0]](i)}),e}fromString(t,e,i,l,h){this.clear();let u=function(t){let e,i;if(!t)return[];let l=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(null===l)return[];let h=[];for(let t=0,u=l.length;t<u;t++)if(n=(r=l[t]).slice(1),e=[s=r[0]],null!==(i=n.match(iD))){for(let t=0,r=i.length;t<r;t++)Number.isNaN(a=parseFloat(i[t]))||e.push(a);if(o=iF[s],e.length-1>o){let t;for(let i=1,r=e.length;i<r;i+=o){t=[s];for(let r=i,n=i+o;r<n;r++)t.push(e[r]);h.push(t)}}else h.push(e)}else h.push(e);return h}(t);return this._runCommandStrList(u,e,i,l,h),this._updateBounds(),this}fromLine(t){let{points:e,curveType:i,clipRangeByDimension:r}=t.attribute;if(!e)return;let n=rp(e,i);"x"===r?this.direction=lE.ROW:"y"===r?this.direction=lE.COLUMN:"auto"===r&&(this.direction=n.direction),this.curves=n.curves}fromCustomPath2D(t,e,i,r,n){return this.clear(),this._runCommandList(t.commandList,e,i,r,n),this._updateBounds(),this}transform(t,e,i,r){let n=this.commandList;if(!this.transformCbList){let t=[];t[ij.M]=this.moveToTransform,t[ij.L]=this.lineToTransform,t[ij.Q]=this.quadraticCurveToTransform,t[ij.C]=this.bezierCurveToTransform,t[ij.AT]=this.arcToTransform,t[ij.E]=this.ellipseTransform,t[ij.R]=this.rectTransform,t[ij.A]=this.arcTransform,t[ij.Z]=this.closePathTransform,this.transformCbList=t}n.forEach(n=>{this.transformCbList[n[0]](n,t,e,i,r)}),this._updateBounds()}moveToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i}lineToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i}quadraticCurveToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r+e,t[4]=t[4]*n+i}bezierCurveToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r+e,t[4]=t[4]*n+i,t[5]=t[5]*r+e,t[6]=t[6]*n+i}arcToTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r+e,t[4]=t[4]*n+i,t[5]=t[5]*(r+n)/2}ellipseTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r,t[4]=t[4]*n}rectTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*r,t[4]=t[4]*n}arcTransform(t,e,i,r,n){t[1]=t[1]*r+e,t[2]=t[2]*n+i,t[3]=t[3]*(r+n)/2}closePathTransform(){}_runCommandStrList(t,e=0,i=0,r=1,n=1){let s,a,o,l,h,u=null,d=0,c=0,p=0,g=0;for(let f=0,m=t.length;f<m;++f){switch(s=t[f],1===r&&1===n||(s=function(t,e,i){let r=rf[0]=t[0];if("a"===r||"A"===r)rf[1]=e*t[1],rf[2]=i*t[2],rf[3]=t[3],rf[4]=t[4],rf[5]=t[5],rf[6]=e*t[6],rf[7]=i*t[7];else if("h"===r||"H"===r)rf[1]=e*t[1];else if("v"===r||"V"===r)rf[1]=i*t[1];else for(let r=1,n=t.length;r<n;++r)rf[r]=(r%2==1?e:i)*t[r];return rf}(s,r,n)),s[0]){case"l":d+=s[1],c+=s[2],this.lineTo(d+e,c+i);break;case"L":d=s[1],c=s[2],this.lineTo(d+e,c+i);break;case"h":d+=s[1],this.lineTo(d+e,c+i);break;case"H":d=s[1],this.lineTo(d+e,c+i);break;case"v":c+=s[1],this.lineTo(d+e,c+i);break;case"V":c=s[1],this.lineTo(d+e,c+i);break;case"m":d+=s[1],c+=s[2],this.moveTo(d+e,c+i);break;case"M":d=s[1],c=s[2],this.moveTo(d+e,c+i);break;case"c":a=d+s[5],o=c+s[6],p=d+s[3],g=c+s[4],this.bezierCurveTo(d+s[1]+e,c+s[2]+i,p+e,g+i,a+e,o+i),d=a,c=o;break;case"C":d=s[5],c=s[6],p=s[3],g=s[4],this.bezierCurveTo(s[1]+e,s[2]+i,p+e,g+i,d+e,c+i);break;case"s":a=d+s[3],o=c+s[4],p=2*d-p,g=2*c-g,this.bezierCurveTo(p+e,g+i,d+s[1]+e,c+s[2]+i,a+e,o+i),p=d+s[1],g=c+s[2],d=a,c=o;break;case"S":a=s[3],o=s[4],p=2*d-p,g=2*c-g,this.bezierCurveTo(p+e,g+i,s[1]+e,s[2]+i,a+e,o+i),d=a,c=o,p=s[1],g=s[2];break;case"q":a=d+s[3],o=c+s[4],p=d+s[1],g=c+s[2],this.quadraticCurveTo(p+e,g+i,a+e,o+i),d=a,c=o;break;case"Q":a=s[3],o=s[4],this.quadraticCurveTo(s[1]+e,s[2]+i,a+e,o+i),d=a,c=o,p=s[1],g=s[2];break;case"t":a=d+s[1],o=c+s[2],null===u[0].match(/[QqTt]/)?(p=d,g=c):"t"===u[0]?(p=2*d-l,g=2*c-h):"q"===u[0]&&(p=2*d-p,g=2*c-g),l=p,h=g,this.quadraticCurveTo(p+e,g+i,a+e,o+i),d=a,c=o,p=d+s[1],g=c+s[2];break;case"T":a=s[1],o=s[2],p=2*d-p,g=2*c-g,this.quadraticCurveTo(p+e,g+i,a+e,o+i),d=a,c=o;break;case"a":iN(this,d+e,c+i,[s[1],s[2],s[3],s[4],s[5],s[6]+d+e,s[7]+c+i]),d+=s[6],c+=s[7];break;case"A":iN(this,d+e,c+i,[s[1],s[2],s[3],s[4],s[5],s[6]+e,s[7]+i]),d=s[6],c=s[7];break;case"z":case"Z":this.closePath()}u=s}}_runCommandList(t,e=0,i=0,r=1,n=1){if(0!==e||0!==i||1!==r||1!==n)for(let s=0,a=t.length;s<a;++s){let a=t[s].slice();switch(a[0]){case ij.L:this.lineToTransform(a,e,i,r,n);break;case ij.M:this.moveToTransform(a,e,i,r,n);break;case ij.C:this.bezierCurveToTransform(a,e,i,r,n);break;case ij.Q:this.quadraticCurveToTransform(a,e,i,r,n);break;case ij.A:this.arcToTransform(a,e,i,r,n);break;case ij.E:this.ellipseTransform(a,e,i,r,n);break;case ij.R:this.rectTransform(a,e,i,r,n);break;case ij.AT:this.arcToTransform(a,e,i,r,n);break;case ij.Z:this.closePath()}}else this.commandList=t.map(t=>t.slice())}_updateBounds(){this.bounds.clear(),iV(this.commandList,this._boundsContext)}release(){this.commandList=[],this._boundsContext=null,this._ctx=null}getLength(){if(this.direction===lE.COLUMN){if(!this.curves.length)return 0;let t=this.curves[0],e=this.curves[this.curves.length-1];return ia(t.p0.y-e.p1.y)}if(this.direction===lE.ROW){if(!this.curves.length)return 0;let t=this.curves[0],e=this.curves[this.curves.length-1];return ia(t.p0.x-e.p1.x)}return this.curves.reduce((t,e)=>t+e.getLength(),0)}getAttrAt(t){if(!this.curves)return{pos:{x:0,y:0},angle:0};let e,i=0;for(let r=0;r<this.curves.length;r++){let n=(e=this.curves[r]).getLength(this.direction);if(i+n>=t)break;i+=n}let r=(t-i)/e.getLength(this.direction);return{pos:e.getPointAt(r),angle:e.getAngleAt(r)}}}let rf=["l",0,0,0,0,0,0,0],rm={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new iE},rv={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},ry={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},r_=Object.assign({outerBorder:Object.assign(Object.assign({},ry),{distance:0}),innerBorder:Object.assign(Object.assign({},ry),{distance:0})},ry),rb={text:"",maxLineWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:"PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,\n    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",fontWeight:"",ellipsis:"\u2026",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0},rx=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,blur:0,cursor:null,html:null,react:null},rv),r_),{alignSelf:"auto"}),{pickStrokeBuffer:0}),rS={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},rk=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic"},{_debug_bounds:!1}),rx),rm),rA=Object.assign(Object.assign({},rk),{startAngle:0,endAngle:is,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),rw=Object.assign(Object.assign(Object.assign({},rk),rS),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),rM=Object.assign(Object.assign({},rk),{radius:1,startAngle:0,endAngle:is}),rC=Object.assign(Object.assign({},rk),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1}),rT=Object.assign(Object.assign({},rk),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),rE=Object.assign(Object.assign(Object.assign({},rk),rS),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),rO=Object.assign(Object.assign({},rk),{path:new rg,customPath:()=>{ex.getInstance().warn("\u7A7A\u51FD\u6570")}}),rP=Object.assign(Object.assign({},rk),{points:[],cornerRadius:0,closePath:!0}),rR=Object.assign(Object.assign({},rk),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0});Object.assign(Object.assign({},rk),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0});let rB=Object.assign(Object.assign({},rk),{symbolType:"circle",size:10,keepDirIn3d:!0}),rI=Object.assign(Object.assign(Object.assign({},rk),rb),{strokeBoundsBuffer:0,keepDirIn3d:!0}),rL=Object.assign(Object.assign(Object.assign({},rk),rb),{editable:!1,width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),rD=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0},rk),{fill:!0,cornerRadius:0}),rF=Object.assign(Object.assign({},rD),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1}),rj=new class t{},rN={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},rz={fill:!0,stroke:!1};String.fromCharCode(160);let rH=/\w|\(|\)|-/,rV=/[.?!,;:/]/,rW=/\S/;function rG(t,e,i,r,n){if(!e||e<=0)return 0;let s=rj.graphicUtil.textMeasure,a=r,o=t.slice(0,a),l=Math.floor(s.measureText(o,i).width),h=t.slice(0,a+1),u=Math.floor(s.measureText(h,i).width);for(;l>e||u<=e;){if(l>e?a--:a++,a>t.length){a=t.length;break}if(a<0){a=0;break}o=t.slice(0,a),l=Math.floor(s.measureText(o,i).width),h=t.slice(0,a+1),u=Math.floor(s.measureText(h,i).width)}return n&&(a=rU(t,a)),a}function rU(t,e){let i=e;for(;rH.test(t[i-1])&&rH.test(t[i])||rV.test(t[i]);)if(--i<=0)return e;return i}function r$(t,e){let i=rj.graphicUtil.textMeasure.measureText(t,e),r={ascent:0,height:0,descent:0,width:0};return"number"!=typeof i.actualBoundingBoxAscent||"number"!=typeof i.actualBoundingBoxDescent?(r.width=Math.floor(i.width),r.height=e.fontSize||0,r.ascent=r.height,r.descent=0):(r.width=Math.floor(i.width),r.height=Math.floor(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent),r.ascent=Math.floor(i.actualBoundingBoxAscent),r.descent=r.height-r.ascent),r}let rY=class{configure(t,e){this.canvas=t.canvas,this.context=t.context,t.bindTextMeasure(this)}measureTextWidth(t,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(t).width):this.estimate(t,e).width}estimate(t,{fontSize:e=rI.fontSize}){let i=0,r=0;for(let e=0;e<t.length;e++)128>t.charCodeAt(e)?i++:r++;return{width:~~(.8*i*e+r*e),height:e}}measureTextPixelHeight(t,e){var i;if(!this.context)return null!==(i=e.fontSize)&&void 0!==i?i:rb.fontSize;this.context.setTextStyleWithoutAlignBaseline(e);let r=this.context.measureText(t);return Math.abs(r.actualBoundingBoxAscent-r.actualBoundingBoxDescent)}measureTextBoundHieght(t,e){var i;if(!this.context)return null!==(i=e.fontSize)&&void 0!==i?i:rb.fontSize;this.context.setTextStyleWithoutAlignBaseline(e);let r=this.context.measureText(t);return Math.abs(r.fontBoundingBoxAscent-r.fontBoundingBoxDescent)}measureText(t,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(t)):this.estimate(t,e)}clipTextVertical(t,e,i,r){if(0===t.length)return{verticalList:t,width:0};let{fontSize:n=12}=e;t.forEach(t=>{t.width=0===t.direction?n:this.measureTextWidth(t.text,e)});let s=[],a=0,o=0;for(;o<t.length&&a+t[o].width<i;o++)a+=t[o].width,s.push(t[o]);if(t[o]&&t[o].text.length>1){let n=this._clipText(t[o].text,e,i-a,0,t[o].text.length-1,"end",!1);if(r&&n.str!==t[o].text){let i="",r=0;for(let e=0;e<o;e++){let n=t[e];i+=n.text,r+=n.text.length}i+=t[o].text;let s=void 0,a=rU(i,r+n.str.length);(a-=r)!=n.str.length-1&&(n.str=n.str.substring(0,a),n.width=this.measureTextWidth(n.str,e))}s.push(Object.assign(Object.assign({},t[o]),{text:n.str,width:n.width})),a+=n.width}return{verticalList:s,width:a}}clipText(t,e,i,r){if(0===t.length)return{str:"",width:0};let n=this.measureTextWidth(t,e);if(n<=i)return{str:t,width:n};if((n=this.measureTextWidth(t[0],e))>i)return{str:"",width:0};let s=this._clipText(t,e,i,0,t.length-1,"end",!1);if(r&&s.str!==t){let i=rU(t,s.str.length);i!==s.str.length&&(s.str=t.substring(0,i),s.width=this.measureTextWidth(s.str,e))}return s}_clipText(t,e,i,r,n,s,a){let o;if("start"===s)o=this._clipTextStart(t,e,i,r,n),a&&(o.result=a+o.str);else if("middle"===s){let r=this._clipTextMiddle(t,e,i,"","",0,0,1);o={str:"none",width:r.width,result:r.left+a+r.right}}else o=this._clipTextEnd(t,e,i,r,n),a&&(o.result=o.str+a);return o}_clipTextEnd(t,e,i,r,n){let s;let a=Math.floor((r+n)/2),o=t.substring(0,a+1),l=this.measureTextWidth(o,e);if(l>i){if(o.length<=1)return{str:"",width:0};let n=t.substring(0,a);return(s=this.measureTextWidth(n,e))<=i?{str:n,width:s}:this._clipTextEnd(t,e,i,r,a)}if(l<i){if(a>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};let r=t.substring(0,a+2);return(s=this.measureTextWidth(r,e))>=i?{str:o,width:l}:this._clipTextEnd(t,e,i,a,n)}return{str:o,width:l}}_clipTextStart(t,e,i,r,n){let s;let a=Math.ceil((r+n)/2),o=t.substring(a-1,t.length-1),l=this.measureTextWidth(o,e);if(l>i){if(o.length<=1)return{str:"",width:0};let r=t.substring(a,t.length-1);return(s=this.measureTextWidth(r,e))<=i?{str:r,width:s}:this._clipTextStart(t,e,i,a,t.length-1)}if(l<i){if(a<=0)return{str:t,width:this.measureTextWidth(t,e)};let n=t.substring(a-2,t.length-1);return(s=this.measureTextWidth(n,e))>=i?{str:o,width:l}:this._clipTextStart(t,e,i,r,a)}return{str:o,width:l}}_clipTextMiddle(t,e,i,r,n,s,a,o){let l=t.substring(0,o),h=this.measureTextWidth(l,e);if(h+a>i)return{left:r,right:n,width:s+a};let u=t.substring(t.length-o,t.length),d=this.measureTextWidth(u,e);return h+d>i?{left:l,right:n,width:h+a}:this._clipTextMiddle(t,e,i,l,u,h,d,o+1)}clipTextWithSuffixVertical(t,e,i,r,n,s){let a;if(""===r)return this.clipTextVertical(t,e,i,n);if(0===t.length)return{verticalList:t,width:0};let o=this.clipTextVertical(t,e,i,n);if(o.verticalList.length===t.length&&o.verticalList[o.verticalList.length-1].width===t[t.length-1].width)return o;let l=this.measureTextWidth(r,e);if(l>i)return o;if(i-=l,"start"===s){let s=this.revertVerticalList(t);a=this.clipTextVertical(s,e,i,n);let o=this.revertVerticalList(a.verticalList);o.unshift({text:r,direction:1,width:l}),a.verticalList=o}else if("middle"===s){let s=this.clipTextVertical(t,e,i/2,n),o=this.revertVerticalList(t),h=this.clipTextVertical(o,e,i/2,n);s.verticalList.push({text:r,direction:1,width:l}),this.revertVerticalList(h.verticalList).forEach(t=>s.verticalList.push(t)),a={verticalList:s.verticalList,width:s.width+h.width}}else(a=this.clipTextVertical(t,e,i,n)).verticalList.push({text:r,direction:1,width:l});return a.width+=l,a}revertVerticalList(t){return t.reverse().map(t=>{let e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})})}clipTextWithSuffix(t,e,i,r,n,s,a=!1){if(""===r)return this.clipText(t,e,i,n);if(0===t.length)return{str:"",width:0};let o=this.measureTextWidth(t,e);if(!a&&o<=i)return{str:t,width:o};let l=this.measureTextWidth(r,e);if(l>i)return{str:"",width:0};if(a&&o+l<=i)return{str:t+r,width:o+l};i-=l;let h=this._clipText(t,e,i,0,t.length-1,s,r);if(n&&h.str!==t){let i=rU(t,h.str.length);i!==h.str.length&&(h.result=t.substring(0,i),h.width=this.measureTextWidth(h.str,e))}else a&&h.str===t&&(h.result=t+r);return h.str=h.result,h.width+=l,h}};rY=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],rY);let rK=Symbol.for("TextMeasureContribution"),rZ=class extends rY{};rZ=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],rZ);let rX=t=>{let e=t.charCodeAt(0),i=2===t.length?t.charCodeAt(1):0,r=e;return 55296<=e&&e<=56319&&56320<=i&&i<=57343&&(e&=1023,i&=1023,r=(e<<10|i)+65536),12288===r||65281<=r&&r<=65376||65504<=r&&r<=65510?"F":8361===r||65377<=r&&r<=65470||65474<=r&&r<=65479||65482<=r&&r<=65487||65490<=r&&r<=65495||65498<=r&&r<=65500||65512<=r&&r<=65518?"H":4352<=r&&r<=4447||4515<=r&&r<=4519||4602<=r&&r<=4607||9001<=r&&r<=9002||11904<=r&&r<=11929||11931<=r&&r<=12019||12032<=r&&r<=12245||12272<=r&&r<=12283||12289<=r&&r<=12350||12353<=r&&r<=12438||12441<=r&&r<=12543||12549<=r&&r<=12589||12593<=r&&r<=12686||12688<=r&&r<=12730||12736<=r&&r<=12771||12784<=r&&r<=12830||12832<=r&&r<=12871||12880<=r&&r<=13054||13056<=r&&r<=19903||19968<=r&&r<=42124||42128<=r&&r<=42182||43360<=r&&r<=43388||44032<=r&&r<=55203||55216<=r&&r<=55238||55243<=r&&r<=55291||63744<=r&&r<=64255||65040<=r&&r<=65049||65072<=r&&r<=65106||65108<=r&&r<=65126||65128<=r&&r<=65131||110592<=r&&r<=110593||127488<=r&&r<=127490||127504<=r&&r<=127546||127552<=r&&r<=127560||127568<=r&&r<=127569||131072<=r&&r<=194367||177984<=r&&r<=196605||196608<=r&&r<=262141?"W":32<=r&&r<=126||162<=r&&r<=163||165<=r&&r<=166||172===r||175===r||10214<=r&&r<=10221||10629<=r&&r<=10630?"Na":161===r||164===r||167<=r&&r<=168||170===r||173<=r&&r<=174||176<=r&&r<=180||182<=r&&r<=186||188<=r&&r<=191||198===r||208===r||215<=r&&r<=216||222<=r&&r<=225||230===r||232<=r&&r<=234||236<=r&&r<=237||240===r||242<=r&&r<=243||247<=r&&r<=250||252===r||254===r||257===r||273===r||275===r||283===r||294<=r&&r<=295||299===r||305<=r&&r<=307||312===r||319<=r&&r<=322||324===r||328<=r&&r<=331||333===r||338<=r&&r<=339||358<=r&&r<=359||363===r||462===r||464===r||466===r||468===r||470===r||472===r||474===r||476===r||593===r||609===r||708===r||711===r||713<=r&&r<=715||717===r||720===r||728<=r&&r<=731||733===r||735===r||768<=r&&r<=879||913<=r&&r<=929||931<=r&&r<=937||945<=r&&r<=961||963<=r&&r<=969||1025===r||1040<=r&&r<=1103||1105===r||8208===r||8211<=r&&r<=8214||8216<=r&&r<=8217||8220<=r&&r<=8221||8224<=r&&r<=8226||8228<=r&&r<=8231||8240===r||8242<=r&&r<=8243||8245===r||8251===r||8254===r||8308===r||8319===r||8321<=r&&r<=8324||8364===r||8451===r||8453===r||8457===r||8467===r||8470===r||8481<=r&&r<=8482||8486===r||8491===r||8531<=r&&r<=8532||8539<=r&&r<=8542||8544<=r&&r<=8555||8560<=r&&r<=8569||8585===r||8592<=r&&r<=8601||8632<=r&&r<=8633||8658===r||8660===r||8679===r||8704===r||8706<=r&&r<=8707||8711<=r&&r<=8712||8715===r||8719===r||8721===r||8725===r||8730===r||8733<=r&&r<=8736||8739===r||8741===r||8743<=r&&r<=8748||8750===r||8756<=r&&r<=8759||8764<=r&&r<=8765||8776===r||8780===r||8786===r||8800<=r&&r<=8801||8804<=r&&r<=8807||8810<=r&&r<=8811||8814<=r&&r<=8815||8834<=r&&r<=8835||8838<=r&&r<=8839||8853===r||8857===r||8869===r||8895===r||8978===r||9312<=r&&r<=9449||9451<=r&&r<=9547||9552<=r&&r<=9587||9600<=r&&r<=9615||9618<=r&&r<=9621||9632<=r&&r<=9633||9635<=r&&r<=9641||9650<=r&&r<=9651||9654<=r&&r<=9655||9660<=r&&r<=9661||9664<=r&&r<=9665||9670<=r&&r<=9672||9675===r||9678<=r&&r<=9681||9698<=r&&r<=9701||9711===r||9733<=r&&r<=9734||9737===r||9742<=r&&r<=9743||9748<=r&&r<=9749||9756===r||9758===r||9792===r||9794===r||9824<=r&&r<=9825||9827<=r&&r<=9829||9831<=r&&r<=9834||9836<=r&&r<=9837||9839===r||9886<=r&&r<=9887||9918<=r&&r<=9919||9924<=r&&r<=9933||9935<=r&&r<=9953||9955===r||9960<=r&&r<=9983||10045===r||10071===r||10102<=r&&r<=10111||11093<=r&&r<=11097||12872<=r&&r<=12879||57344<=r&&r<=63743||65024<=r&&r<=65039||65533===r||127232<=r&&r<=127242||127248<=r&&r<=127277||127280<=r&&r<=127337||127344<=r&&r<=127386||917760<=r&&r<=917999||983040<=r&&r<=1048573||1048576<=r&&r<=1114109?"A":"N"};class rq{constructor(t,e){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet="-/: .,@%'\"~",this._option=t,this._userSpec=null!=e?e:{},this.textSpec=this._initSpec(),eO(t.specialCharSet)&&(this.specialCharSet=t.specialCharSet),this._standardMethod=eO(t.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if(ej(this._canvas)&&(eO(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),ej(this._canvas)&&"undefined"!=typeof window&&void 0!==window.document&&globalThis&&eO(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),ej(this._context)&&eO(this._canvas)){let t=this._canvas.getContext("2d");eO(t)&&(t.save(),t.font=function(t,e={},i){i||(i=1);let{fontStyle:r=e.fontStyle,fontVariant:n=e.fontVariant,fontWeight:s=e.fontWeight,fontSize:a=e.fontSize,fontFamily:o=e.fontFamily}=t;return(r?r+" ":"")+(n?n+" ":"")+(s?s+" ":"")+a*i+"px "+(o||"sans-serif")}(this.textSpec),this._contextSaved=!0,this._context=t)}return!ej(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var t,e,i;let{defaultFontParams:r={}}=this._option,{fontStyle:n=r.fontStyle,fontVariant:s=r.fontVariant,fontWeight:a=null!==(t=r.fontWeight)&&void 0!==t?t:"normal",fontSize:o=null!==(e=r.fontSize)&&void 0!==e?e:12,fontFamily:l=null!==(i=r.fontFamily)&&void 0!==i?i:"sans-serif",align:h,textAlign:u=null!=h?h:"center",baseline:d,textBaseline:c=null!=d?d:"middle",ellipsis:p,limit:g}=this._userSpec,{lineHeight:f=o}=this._userSpec;return eE(f)&&"%"===f[f.length-1]&&(f=o*(Number.parseFloat(f.substring(0,f.length-1))/100)),{fontStyle:n,fontVariant:s,fontFamily:l,fontSize:o,fontWeight:a,textAlign:u,textBaseline:c,ellipsis:p,limit:g,lineHeight:f}}measure(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}fullMeasure(t){let e;if(ej(t))return{width:0,height:0};if(ej(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);let{fontFamily:i,fontSize:r,fontWeight:n,textAlign:s,textBaseline:a,ellipsis:o,limit:l,lineHeight:h}=this.textSpec;try{let u=this._option.getTextBounds({text:t,fontFamily:i,fontSize:r,fontWeight:n,textAlign:s,textBaseline:a,ellipsis:!!o,maxLineWidth:l||1/0,lineHeight:h});e={width:u.width(),height:u.height()}}catch(i){this._notSupportVRender=!0,e=this.measureWithNaiveCanvas(t)}return e}measureWithNaiveCanvas(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(t){if(!this.initContext())return this._quickMeasureWithoutCanvas(t);let e=this._context.measureText(t),{fontSize:i,lineHeight:r}=this.textSpec;return{width:e.width,height:null!=r?r:i}}quickMeasure(t){return this._measureReduce(t,this._quickMeasure.bind(this))}_quickMeasure(t){let e={width:0,height:0};for(let i=0;i<t.length;i++){let r=t[i],n=this._measureSpecialChar(r);ej(n)&&rq.NUMBERS_CHAR_SET.includes(r)&&(n=this._measureNumberChar()),ej(n)&&["F","W"].includes(rX(r))&&(n=this._measureFullSizeChar()),ej(n)&&(n=this._measureLetterChar()),e.width+=n.width,e.height=Math.max(e.height,n.height)}return e}quickMeasureWithoutCanvas(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(t){let e={width:0,height:0},{fontSize:i,lineHeight:r}=this.textSpec;for(let r=0;r<t.length;r++){let n=["F","W"].includes(rX(t[r]))?1:.53;e.width+=n*i}return e.height=null!=r?r:i,e}_measureReduce(t,e){let{fontSize:i,lineHeight:r}=this.textSpec,n={width:0,height:0};if(ej(t))return n;if(eM(t)){let s=t.filter(eO).map(t=>t.toString());return 0===s.length?n:1===s.length?e(s[0]):{width:s.reduce((t,i)=>Math.max(t,e(i).width),0),height:s.length*((null!=r?r:i)+1)+1}}return e(t.toString())}_measureNumberChar(){if(ej(this._numberCharSize)){let t=this._standardMethod(rq.NUMBERS_CHAR_SET);this._numberCharSize={width:t.width/rq.NUMBERS_CHAR_SET.length,height:t.height}}return this._numberCharSize}_measureFullSizeChar(){return ej(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(rq.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if(ej(this._letterCharSize)){let t=this._standardMethod(rq.ALPHABET_CHAR_SET);this._letterCharSize={width:t.width/rq.ALPHABET_CHAR_SET.length,height:t.height}}return this._letterCharSize}_measureSpecialChar(t){return eO(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}release(){eO(this._canvas)&&(this._canvas=null),eO(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}rq.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",rq.NUMBERS_CHAR_SET="0123456789",rq.FULL_SIZE_CHAR="\u5B57";let rJ={Singleton:"Singleton",Transient:"Transient"},rQ={ConstantValue:"ConstantValue",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid"};class r0{constructor(t,e){this.id=eV.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=rQ.Invalid,this.constraint=t=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}clone(){let t=new r0(this.serviceIdentifier,this.scope);return t.activated=t.scope===rJ.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.provider=this.provider,t.constraint=this.constraint,t.cache=this.cache,t}}class r1{getConstructorMetadata(t){return{compilerGeneratedMetadata:eZ.getMetadata(eK,t),userGeneratedMetadata:eZ.getMetadata(eY,t)||{}}}getPropertiesMetadata(t){throw Error("\u6682\u672A\u5B9E\u73B0")}}let r2=(y=eG,t=>{let e=e=>{if(null==e)return!1;if(e.key===y&&e.value===t)return!0;if(null==e.constructorArgsMetadata)return!1;let i=e.constructorArgsMetadata;for(let e=0;e<i.length;e++)if(i[e].key===y&&i[e].value===t)return!0;return!1};return e.metaData=new eq(y,t),e});class r3{constructor(t){this._binding=t}inRequestScope(){throw Error("\u6682\u672A\u5B9E\u73B0")}inSingletonScope(){return this._binding.scope=rJ.Singleton,this}inTransientScope(){return this._binding.scope=rJ.Transient,this}whenTargetNamed(t){return this._binding.constraint=r2(t),this}}class r5{constructor(t){this._binding=t}to(t){return this._binding.type=rQ.Instance,this._binding.implementationType=t,new r3(this._binding)}toSelf(){let t=this._binding.serviceIdentifier;return this.to(t)}toDynamicValue(t){return this._binding.type=rQ.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new r3(this._binding)}toConstantValue(t){return this._binding.type=rQ.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=rJ.Singleton,new r3(this._binding)}toFactory(t){return this._binding.type=rQ.Factory,this._binding.factory=t,this._binding.scope=rJ.Singleton,new r3(this._binding)}toService(t){this.toDynamicValue(e=>e.container.get(t))}}let r4=new class t{constructor(t){let e=t||{};e.defaultScope=e.defaultScope||rJ.Transient,this.options=e,this.id=eV.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new r1}load(t){let e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}get(t){let e=this._getNotAllArgs(t,!1);return this._get(e)}getAll(t){let e=this._getAllArgs(t);return this._get(e)}getTagged(t,e,i){let r=this._getNotAllArgs(t,!1,e,i);return this._get(r)}getNamed(t,e){return this.getTagged(t,eG,e)}isBound(t){return this._bindingDictionary.has(t)}bind(t){let e=new r0(t,this.options.defaultScope),i=this._bindingDictionary.get(t)||[];return i.push(e),this._bindingDictionary.set(t,i),new r5(e)}unbind(t){this._bindingDictionary.delete(t)}rebind(t){return this.unbind(t),this.bind(t)}_getContainerModuleHelpersFactory(){let t=(t,e)=>{t._binding.moduleId=e},e=e=>i=>{let r=this.bind(i);return t(r,e),r},i=()=>t=>this.unbind(t),r=()=>t=>this.isBound(t),n=e=>i=>{let r=this.rebind(i);return t(r,e),r};return t=>({bindFunction:e(t),isboundFunction:r(),rebindFunction:n(t),unbindFunction:i(),unbindAsyncFunction:t=>null})}_getNotAllArgs(t,e,i,r){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:r}}_getAllArgs(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}_get(t){let e=[];return this._bindingDictionary.get(t.serviceIdentifier).filter(e=>e.constraint(t)).forEach(t=>{e.push(this._resolveFromBinding(t))}),t.isMultiInject||1!==e.length?e:e[0]}_getChildRequest(t){let e=t.implementationType,{userGeneratedMetadata:i}=this._metadataReader.getConstructorMetadata(e),r=Object.keys(i),n=[];for(let t=0;t<r.length;t++){let e=i[t],r={};e.forEach(t=>{r[t.key]=t.value});let s={inject:r[eU],multiInject:r[e$]},a=s.inject||s.multiInject,o={serviceIdentifier:a,constructorArgsMetadata:e},l={injectIdentifier:a,metadata:e,bindings:this._bindingDictionary.get(a).filter(t=>t.constraint(o))};n.push(l)}return n}_resolveFromBinding(t){let e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}_getResolvedFromBinding(t){let e;switch(t.type){case rQ.ConstantValue:case rQ.Function:e=t.cache;break;case rQ.Instance:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}_resolveInstance(t,e){if(t.activated)return t.cache;let i=this._getChildRequest(t);return this._createInstance(e,i)}_createInstance(t,e){return e.length?new t(...this._resolveRequests(e)):new t}_resolveRequests(t){return t.map(t=>t.bindings.length>1?t.bindings.map(t=>this._resolveFromBinding(t)):this._resolveFromBinding(t.bindings[0]))}_saveToScope(t,e){t.scope===rJ.Singleton&&(t.cache=e,t.activated=!0)}},r8=Symbol.for("CanvasFactory"),r6=Symbol.for("Context2dFactory");function r9(t){return r4.getNamed(r8,rj.global.env)(t)}let r7=new class t{constructor(){this.pools=[],this.allocatedCanvas=[]}shareCanvas(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}getCommonCanvas(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}allocate(t){if(!this.pools.length){let e=r9(Object.assign({nativeCanvas:rj.global.createCanvas(t)},t));return this.allocatedCanvas.push(e),e}let e=this.pools.pop();return e.resize(t.width,t.height),e.dpr=t.dpr,e}allocateByObj(t){if(!this.pools.length){let e={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},i=r9(Object.assign({nativeCanvas:rj.global.createCanvas(e)},e));return this.allocatedCanvas.push(i),i}let e=this.pools.pop();return e.width=t.width,e.height=t.height,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}},nt=Symbol.for("VWindow"),ne=Symbol.for("WindowHandlerContribution"),ni=class{get width(){if(this._handler){let t=this._handler.getWH();return this._width=t.width}return this._width}get height(){if(this._handler){let t=this._handler.getWH();return this._height=t.height}return this._height}get dpr(){return this._handler.getDpr()}constructor(){this.hooks={onChange:new e8(["x","y","width","height"])},this.active=()=>{let t=this.global;t.env&&!this.actived&&(r4.getNamed(ne,t.env).configure(this,t),this.actived=!0)},this._uid=eV.GenAutoIncrementId(),this.global=rj.global,this.postInit()}postInit(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}get style(){var t;return null!==(t=this._handler.getStyle())&&void 0!==t?t:{}}set style(t){this._handler.setStyle(t)}create(t){var e,i;this._handler.createWindow(t);let r=this._handler.getWH();this._width=r.width,this._height=r.height,t.viewBox?this.setViewBox(t.viewBox):!1!==t.canvasControled?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:null!==(e=t.width)&&void 0!==e?e:this._width,y2:null!==(i=t.height)&&void 0!==i?i:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}setWindowHandler(t){this._handler=t}setDpr(t){return this._handler.setDpr(t)}resize(t,e){return this._handler.resizeWindow(t,e)}configure(){throw Error("\u6682\u4E0D\u652F\u6301")}release(){return this.global.hooks.onSetEnv.unTap("window",this.active),this._handler.releaseWindow()}getContext(){return this._handler.getContext()}getNativeHandler(){return this._handler.getNativeHandler()}getImageBuffer(t){return this._handler.getImageBuffer?this._handler.getImageBuffer(t):null}addEventListener(t,e,i){return this._handler.addEventListener(t,e,i)}removeEventListener(t,e,i){return this._handler.removeEventListener(t,e,i)}dispatchEvent(t){return this._handler.dispatchEvent(t)}getBoundingClientRect(){return this._handler.getBoundingClientRect()}getContainer(){return this._handler.container}clearViewBox(t){this._handler.clearViewBox(t)}setViewBox(t){this._handler.setViewBox(t)}setViewBoxTransform(t,e,i,r,n,s){this._handler.setViewBoxTransform(t,e,i,r,n,s)}getViewBox(){return this._handler.getViewBox()}getViewBoxTransform(){return this._handler.getViewBoxTransform()}pointTransform(t,e){let i=this._handler.getViewBox(),r={x:t,y:e};return this._handler.getViewBoxTransform().transformPoint({x:t,y:e},r),r.x-=i.x1,r.y-=i.y1,r}hasSubView(){let t=this._handler.getViewBox();return!(0===t.x1&&0===t.y1&&this.width===t.width()&&this.height===t.height())}isVisible(t){return this._handler.isVisible(t)}onVisibleChange(t){return this._handler.onVisibleChange(t)}getTopLeft(t){return this._handler.getTopLeft(t)}};ni=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],ni);var nr=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a},nn=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},ns=function(t,e){return function(i,r){e(i,r,t)}};let na=class{get canvas(){return this.tryInitCanvas(),this._canvas}get context(){return this.tryInitCanvas(),this._context}constructor(t){this.contributions=t,this.configured=!1,this.global=rj.global,this.global.hooks.onSetEnv.tap("graphic-util",(t,e,i)=>{this.configured=!1,this.configure(i,e)})}get textMeasure(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}configure(t,e){this.configured||(this.contributions.getContributions().forEach(t=>{t.configure(this,e)}),this.configured=!0)}tryInitCanvas(){if(!this._canvas){let t=r7.shareCanvas();this._canvas=t,this._context=t.getContext("2d")}}bindTextMeasure(t){this._textMeasure=t}measureText(t,e,i="native"){var r;this.configure(this.global,this.global.env);let n=this.global.measureTextMethod;this.global.measureTextMethod=i;let s={width:this._textMeasure.measureTextWidth(t,e),height:null!==(r=e.fontSize)&&void 0!==r?r:rb.fontSize};return this.global.measureTextMethod=n,s}createTextMeasureInstance(t,e,i){return this.configure(this.global,this.global.env),new rq(Object.assign({defaultFontParams:{fontFamily:rb.fontFamily,fontSize:rb.fontSize},getCanvasForMeasure:i||(()=>this.canvas),getTextBounds:void 0,specialCharSet:"-/: .,@%'\"~"+rq.ALPHABET_CHAR_SET+rq.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t)}drawGraphicToCanvas(t,e,i){if(!e.defaultLayer)return null;let r=r4.get(nt),n=t.AABBBounds,s=n.width(),a=n.height(),o=-n.x1,l=-n.y1;r.create({viewBox:{x1:o,y1:l,x2:n.x2,y2:n.y2},width:s,height:a,canvas:i,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:""});let h=e.params.optimize.disableCheckGraphicWidthOutRange;e.params.optimize.disableCheckGraphicWidthOutRange=!0,e.defaultLayer.getNativeHandler().drawTo(r,[t],{transMatrix:r.getViewBoxTransform(),viewBox:r.getViewBox(),stage:e,layer:e.defaultLayer,renderService:e.renderService,background:"transparent",clear:!0,updateBounds:!1}),e.params.optimize.disableCheckGraphicWidthOutRange=h;let u=r.getNativeHandler();return u.nativeCanvas?u.nativeCanvas:null}};na=nr([eX(),ns(0,e0(e2)),ns(0,e1(rK)),nn("design:paramtypes",[Object])],na),(lf=lR||(lR={}))[lf.transform=0]="transform",lf[lf.matrix=1]="matrix";let no=new iE,nl=class{constructor(){this.matrix=new iE}init(t){return this.mode=lR.transform,this.originTransform=t,this.matrix.reset(),this}fromMatrix(t,e){return this.mode=lR.matrix,this.outSourceMatrix=t,this.outTargetMatrix=e,this}scaleMatrix(t,e,i){let r=this.outSourceMatrix;if(no.setValue(r.a,r.b,r.c,r.d,r.e,r.f),this.outTargetMatrix.reset(),i){let{x:r,y:n}=i;this.outTargetMatrix.translate(r,n),this.outTargetMatrix.scale(t,e),this.outTargetMatrix.translate(-r,-n)}else this.outTargetMatrix.scale(t,e);return this.outTargetMatrix.multiply(no.a,no.b,no.c,no.d,no.e,no.f),this}rotateMatrix(t,e){let i=this.outSourceMatrix;if(no.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){let{x:i,y:r}=e;this.outTargetMatrix.translate(i,r),this.outTargetMatrix.rotate(t),this.outTargetMatrix.translate(-i,-r)}else this.outTargetMatrix.rotate(t);return this.outTargetMatrix.multiply(no.a,no.b,no.c,no.d,no.e,no.f),this}scale(t,e,i){return this.mode===lR.matrix?this.scaleMatrix(t,e,i):this}rotate(t,e){return this.mode===lR.matrix?this.rotateMatrix(t,e):this}translateMatrix(t,e){let i=this.outSourceMatrix;return no.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(t,e),this.outTargetMatrix.multiply(no.a,no.b,no.c,no.d,no.e,no.f),this}translate(t,e){return this.mode===lR.matrix?this.translateMatrix(t,e):this}simplify(t){return this.mode===lR.matrix?this.simplifyMatrix(t):this}simplifyMatrix(t){return this}};nl=nr([eX(),nn("design:paramtypes",[])],nl);let nh={arc:rA,area:rw,circle:rM,line:rE,path:rO,symbol:rB,text:rI,rect:rR,polygon:rP,richtext:rL,richtextIcon:rF,image:rD,group:rC,glyph:rT},nu=Object.keys(nh);function nd(t,e){Object.keys(e).forEach(i=>{t[i]=e[i]})}let nc={arc:Object.assign({},nh.arc),area:Object.assign({},nh.area),circle:Object.assign({},nh.circle),line:Object.assign({},nh.line),path:Object.assign({},nh.path),symbol:Object.assign({},nh.symbol),text:Object.assign({},nh.text),rect:Object.assign({},nh.rect),polygon:Object.assign({},nh.polygon),richtext:Object.assign({},nh.richtext),richtextIcon:Object.assign({},nh.richtextIcon),image:Object.assign({},nh.image),group:Object.assign({},nh.group),glyph:Object.assign({},nh.glyph)};class np{constructor(){this.initTheme(),this.dirty=!1}initTheme(){this._defaultTheme={},nu.forEach(t=>{this._defaultTheme[t]=Object.create(nc[t])}),this.combinedTheme=this._defaultTheme}getTheme(t){if(!t||!this.dirty)return this.combinedTheme;let e={},i=this.getParentWithTheme(t);return i&&(e=i.theme),this.applyTheme(t,e),this.combinedTheme}getParentWithTheme(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}applyTheme(t,e,i=!1){if(this.dirty){let r=this.getParentWithTheme(t);if(r){let t=r.theme;(t.dirty||i)&&t.applyTheme(r,e,!0)}this.userTheme?this.doCombine(r&&r.theme.combinedTheme):(r?this.combinedTheme=r.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,ex.getInstance().warn("\u672A\u77E5\u9519\u8BEF\uFF0C\u8D70\u5230\u4E0D\u5E94\u8BE5\u8D70\u7684\u533A\u57DF\u91CC")),this.dirty=!1)}return this.combinedTheme}doCombine(t){let e=this.userTheme,i=this.combinedTheme;nu.forEach(r=>{let n=Object.create(nc[r]);t&&t[r]&&nd(n,t[r]),i[r]&&nd(n,i[r]),e[r]&&nd(n,e[r]),this.combinedTheme[r]=n}),e.common&&nu.forEach(t=>{nd(this.combinedTheme[t],e.common)}),this.dirty=!1}setTheme(t,e){let i=this.userTheme;i?Object.keys(t).forEach(e=>{i[e]?Object.assign(i[e],t[e]):i[e]=Object.assign({},t[e])}):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}resetTheme(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}dirtyChildren(t){t.forEachChildren(t=>{t.isContainer&&(t.theme&&(t.theme.dirty=!0),this.dirtyChildren(t))})}}let ng=new np;function nf(t,e){return t.glyphHost?nf(t.glyphHost):e?(t.isContainer,e):function(t){let e;if(e=t.isContainer?t:t.parent){for(;e&&!e.theme;)e=e.parent;return e?(e.theme||e.createTheme(),e.theme.getTheme(e)):ng.getTheme()}return null}(t)||t.attachedThemeGraphic&&nf(t.attachedThemeGraphic)||ng.getTheme()}let nm=Object.prototype.hasOwnProperty,nv=(t,e)=>null!=t&&nm.call(t,e),ny=t=>new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(t),n_=t=>new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(t),nb=t=>{let e=typeof t;return null!==t&&"object"===e||"function"===e},nx=t=>"function"==typeof t;class nS extends em(){get previousSibling(){return this._prev}get nextSibling(){return this._next}get children(){return this.getChildren()}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}get count(){return this._count}get childrenCount(){return this._idMap?this._idMap.size:0}constructor(){super(),this._uid=eV.GenAutoIncrementId(),this._firstChild=null,this._lastChild=null,this.parent=null,this._count=1}forEachChildren(t,e=!1){if(e){let e=this._lastChild,i=0;for(;e;){if(t(e,i++))return;e=e._prev}}else{let e=this._firstChild,i=0;for(;e;){if(t(e,i++))return;e=e._next}}}forEachChildrenAsync(t,e=!1){var i,r,n,s;return i=this,r=void 0,n=void 0,s=function*(){if(e){let e=this._lastChild,i=0;for(;e;){let r=t(e,i++);if(r.then&&(r=yield r),r)return;e=e._prev}}else{let e=this._firstChild,i=0;for(;e;){let r=t(e,i++);if(r.then&&(r=yield r),r)return;e=e._next}}},new(n||(n=Promise))(function(t,e){function a(t){try{l(s.next(t))}catch(t){e(t)}}function o(t){try{l(s.throw(t))}catch(t){e(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof n?i:new n(function(t){t(i)})).then(a,o)}l((s=s.apply(i,r||[])).next())})}forEach(t){return this.forEachChildren(t)}appendChild(t,e=!0){if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw Error("\u3010Node::appendChild\u3011\u4E0D\u80FD\u5C06\u7236\u8F88\u5143\u7D20append\u4E3A\u5B50\u5143\u7D20");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}appendChildArrHighPerformance(t,e=!1){return console.error("\u6682\u4E0D\u652F\u6301\u8BE5\u51FD\u6570"),t}insertBefore(t,e){if(!e)return this.appendChild(t);if(this._uid===t._uid)return null;if(t.isAncestorsOf(this))throw Error("\u3010Node::insertBefore\u3011\u4E0D\u80FD\u5C06\u7236\u8F88\u5143\u7D20insert\u4E3A\u5B50\u5143\u7D20");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertAfter(t,e){if(!e)return this.appendChild(t);if(this._uid===t._uid)return null;if(t.isAncestorsOf(this))throw Error("\u3010Node::insertAfter\u3011\u4E0D\u80FD\u5C06\u7236\u8F88\u5143\u7D20insert\u4E3A\u5B50\u5143\u7D20");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertInto(t,e){if(!this._ignoreWarn&&this._nodeList&&ex.getInstance().warn("insertIntoKeepIdx\u548CinsertInto\u6DF7\u7528\u53EF\u80FD\u4F1A\u5B58\u5728\u9519\u8BEF"),e>=this.childrenCount)return this.appendChild(t);if(this._uid===t._uid)return null;if(t.isAncestorsOf(this))throw Error("\u3010Node::insertBefore\u3011\u4E0D\u80FD\u5C06\u7236\u8F88\u5143\u7D20insert\u4E3A\u5B50\u5143\u7D20");if(t.parent&&t.parent.removeChild(t),t.parent=this,0===e)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{let i=this._firstChild;for(let t=0;t<e;t++){if(!i)return null;t>0&&(i=i._next)}if(!i)return null;t._next=i._next,t._prev=i,i._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}insertIntoKeepIdx(t,e){let i;if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){let i=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,i)}this._nodeList[e]=t;for(let t=e-1;t>=0&&!(i=this._nodeList[t]);t--);if(i)return i._next?this.insertBefore(t,i._next):this.appendChild(t);this._ignoreWarn=!0;let r=this.insertInto(t,0);return this._ignoreWarn=!1,r}removeChild(t){if(!this._idMap||!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){let e=this._nodeList.findIndex(e=>e===t);e>=0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}delete(){this.parent&&this.parent.removeChild(this)}removeAllChild(t){if(!this._idMap)return;this._nodeList&&(this._nodeList.length=0);let e=this._firstChild;for(;e;){let t=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=t}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}replaceChild(t,e){throw Error("\u6682\u4E0D\u652F\u6301")}find(t,e=!1){let i=null;return this.forEachChildren((e,r)=>!(e===this||!t(e,r))&&(i=e,!0)),e&&this.forEachChildren(e=>{if(e.isContainer){let r=e.find(t,!0);if(r)return i=r,!0}return!1}),i}findAll(t,e=!1){let i=[];return this.forEachChildren((e,r)=>{e!==this&&t(e,r)&&i.push(e)}),e&&this.forEachChildren(e=>{if(e.isContainer){let r=e.findAll(t,!0);r.length&&(i=i.concat(r))}}),i}getElementById(t){return this.find(e=>e.id===t,!0)}findChildById(t){return this.getElementById(t)}findChildByUid(t){return this._idMap&&this._idMap.get(t)||null}getElementsByName(t){return this.findAll(e=>e.name===t,!0)}findChildrenByName(t){return this.getElementsByName(t)}getElementsByType(t){return this.findAll(e=>e.type===t,!0)}getChildByName(t,e=!1){return this.find(e=>e.name===t,e)}getChildAt(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<t;i++){if(!e._next)return null;e=e._next}return e}at(t){return this.getChildAt(t)}containNode(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;let e=this._firstChild;for(;e;){if(e.containNode(t))return!0;e=e._next}return!1}getRootNode(){let t=this.parent;for(;null==t?void 0:t.parent;)t=t.parent;return t||this}hasChildNodes(){return null!==this._firstChild}addChild(t){return this.appendChild(t)}add(t){return this.appendChild(t)}getChildren(){let t=[],e=this._firstChild;for(;e;)t.push(e),e=e._next;return t}isChildOf(t){return!!this.parent&&this.parent._uid===t._uid}isParentOf(t){return t.isChildOf(this)}isDescendantsOf(t){let e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(null!==e);return!1}isAncestorsOf(t){return t.isDescendantsOf(this)}getAncestor(t){throw Error("\u6682\u4E0D\u652F\u6301")}setAllDescendantsProps(t,e){let i=this._firstChild;for(;i;)i[t]=e,i.setAllDescendantsProps(t,e),i=i._next}setCount(t){this._count+=t;let e=this.parent;if(e)do e._count+=t,e=e.parent;while(null!==e)}clone(){throw Error("\u6682\u4E0D\u652F\u6301")}cloneTo(t){throw Error("\u6682\u4E0D\u652F\u6301")}getParent(){return this.parent}del(t){return this.removeChild(t)}addEventListener(t,e,i){let r=ew(i,!0)&&i||nb(i)&&i.capture,n=nb(i)&&i.once,s=nx(e)?void 0:e;return t=r?`${t}capture`:t,e=nx(e)?e:e.handleEvent,n?super.once(t,e,s):super.on(t,e,s),this}on(t,e,i){return this.addEventListener(t,e,i)}removeEventListener(t,e,i){let r=ew(i,!0)&&i||nb(i)&&i.capture,n=nx(e)?void 0:e;t=r?`${t}capture`:t,e=nx(e)?e:e.handleEvent;let s=nb(i)&&i.once;return super.off(t,e,n,s),this}off(t,e,i){return this.removeEventListener(t,e,i)}once(t,e,i){return nb(i)?(i.once=!0,this.addEventListener(t,e,i)):this.addEventListener(t,e,{once:!0})}removeAllEventListeners(){return super.removeAllListeners(),this}removeAllListeners(){return this.removeAllEventListeners()}dispatchEvent(t,...e){return super.emit(t.type,t,...e),!t.defaultPrevented}emit(t,e){return this.dispatchEvent(t,e)}release(){this.removeAllListeners()}}class nk{get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get x(){return this.canvas.x}get y(){return this.canvas.y}get canvasX(){return this.canvas.x}get canvasY(){return this.canvas.y}get viewX(){return this.viewport.x}get viewY(){return this.viewport.y}constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=nk.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}composedDetailPath(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}_composedDetailPath(t){if(t&&t.graphic){let e=this.pickParams.graphic;if(e.stage){let i=e.stage.eventSystem.manager.propagationPath(e);this.detailPath.push(i),this._composedDetailPath(t.params)}}}preventDefault(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch(t){this.nativeEvent.preventDefault&&nx(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch(t){this.nativeEvent.stopPropagation&&nx(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}initEvent(){}initUIEvent(){}clone(){throw Error("Method not implemented.")}}class nA extends nk{constructor(t,e){super(),this.type=t,this.detail=e}}class nw{constructor(){}static linear(t){return t}static none(){return this.linear}static get(t){return t<-1?t=-1:t>1&&(t=1),function(e){return 0===t?e:t<0?e*(-(e*t)+1+t):e*((2-e)*t+(1-t))}}static getPowIn(t){return function(e){return Math.pow(e,t)}}static getPowOut(t){return function(e){return 1-Math.pow(1-e,t)}}static getPowInOut(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}static getBackIn(t){return function(e){return e*e*((t+1)*e-t)}}static getBackOut(t){return function(e){return--e*e*((t+1)*e+t)+1}}static getBackInOut(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}static sineIn(t){return 1-Math.cos(t*Math.PI/2)}static sineOut(t){return Math.sin(t*Math.PI/2)}static sineInOut(t){return-(Math.cos(Math.PI*t)-1)/2}static expoIn(t){return 0===t?0:Math.pow(2,10*t-10)}static expoOut(t){return 1===t?1:1-Math.pow(2,-10*t)}static expoInOut(t){return 0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}static circIn(t){return-(Math.sqrt(1-t*t)-1)}static circOut(t){return Math.sqrt(1- --t*t)}static circInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}static bounceOut(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}static bounceIn(t){return 1-nw.bounceOut(1-t)}static bounceInOut(t){return t<.5?.5*nw.bounceIn(2*t):.5*nw.bounceOut(2*t-1)+.5}static getElasticIn(t,e){return function(i){if(0===i||1===i)return i;let r=e/is*Math.asin(1/t);return-t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*is/e)}}static getElasticOut(t,e){return function(i){if(0===i||1===i)return i;let r=e/is*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-r)*is/e)+1}}static getElasticInOut(t,e){return function(i){let r=e/is*Math.asin(1/t);return(i*=2)<1?-(t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*is/e)*.5):t*Math.pow(2,-10*(i-=1))*Math.sin((i-r)*is/e)*.5+1}}}nw.quadIn=nw.getPowIn(2),nw.quadOut=nw.getPowOut(2),nw.quadInOut=nw.getPowInOut(2),nw.cubicIn=nw.getPowIn(3),nw.cubicOut=nw.getPowOut(3),nw.cubicInOut=nw.getPowInOut(3),nw.quartIn=nw.getPowIn(4),nw.quartOut=nw.getPowOut(4),nw.quartInOut=nw.getPowInOut(4),nw.quintIn=nw.getPowIn(5),nw.quintOut=nw.getPowOut(5),nw.quintInOut=nw.getPowInOut(5),nw.backIn=nw.getBackIn(1.7),nw.backOut=nw.getBackOut(1.7),nw.backInOut=nw.getBackInOut(1.7),nw.elasticIn=nw.getElasticIn(1,.3),nw.elasticOut=nw.getElasticOut(1,.3),nw.elasticInOut=nw.getElasticInOut(1,.3*1.5);class nM{constructor(){this.id=eV.GenAutoIncrementId(),this.animateHead=null,this.animateTail=null,this.animateCount=0,this.paused=!1}addAnimate(t){this.animateTail?(this.animateTail.nextAnimate=t,t.prevAnimate=this.animateTail,this.animateTail=t,t.nextAnimate=null):(this.animateHead=t,this.animateTail=t),this.animateCount++}pause(){this.paused=!0}resume(){this.paused=!1}tick(t){if(this.paused)return;let e=this.animateHead;for(this.animateCount=0;e;)e.status===lM.END?this.removeAnimate(e):e.status===lM.RUNNING||e.status===lM.INITIAL?(this.animateCount++,e.advance(t)):e.status===lM.PAUSED&&this.animateCount++,e=e.nextAnimate}clear(){let t=this.animateHead;for(;t;)t.release(),t=t.nextAnimate;this.animateHead=null,this.animateTail=null,this.animateCount=0}removeAnimate(t,e=!0){t._onRemove&&t._onRemove.forEach(t=>t()),t===this.animateHead?(this.animateHead=t.nextAnimate,t===this.animateTail?this.animateTail=null:this.animateHead.prevAnimate=null):t===this.animateTail?(this.animateTail=t.prevAnimate,this.animateTail.nextAnimate=null):(t.prevAnimate.nextAnimate=t.nextAnimate,t.nextAnimate.prevAnimate=t.prevAnimate),e&&t.release()}}let nC=new nM;class nT{constructor(t,e,i,r,n){this.from=t,this.to=e,this.duration=i,this.easing=r,this.params=n,this.updateCount=0}bind(t,e){this.target=t,this.subAnimate=e,this.onBind()}onBind(){}onFirstRun(){}onStart(){}onEnd(){}getEndProps(){return this.to}getFromProps(){return this.from}getMergedEndProps(){var t;let e=this.getEndProps();return e?this._endProps===e?this._mergedEndProps:(this._endProps=e,void(this._mergedEndProps=Object.assign({},null!==(t=this.step.prev.getLastProps())&&void 0!==t?t:{},e))):this.step.prev?this.step.prev.getLastProps():e}update(t,e,i){if(0===this.updateCount){this.onFirstRun();let t=this.step.getLastProps();Object.keys(t).forEach(e=>{this.subAnimate.animate.validAttr(e)&&(i[e]=t[e])})}this.updateCount+=1,this.onUpdate(t,e,i),t&&this.onEnd()}}class nE extends nT{constructor(t){super(null,null,0,"linear"),this.cb=t}onUpdate(t,e,i){}onStart(){this.cb()}}class nO{constructor(t=eV.GenAutoIncrementId(),e=nC){this.id=t,this.timeline=e,this.status=lM.INITIAL,this.tailAnimate=new nP(this),this.subAnimates=[this.tailAnimate],this.timeScale=1,this.rawPosition=-1,this._startTime=0,this._duringTime=0,this.timeline.addAnimate(this)}setTimeline(t){t!==this.timeline&&(this.timeline.removeAnimate(this,!1),t.addAnimate(this))}getStartTime(){return this._startTime}getDuration(){return this.subAnimates.reduce((t,e)=>t+e.totalDuration,0)}after(t){let e=t.getDuration();return this._startTime=e,this}afterAll(t){let e=-Infinity;return t.forEach(t=>{e=ih(t.getDuration(),e)}),this._startTime=e,this}parallel(t){return this._startTime=t.getStartTime(),this}static AddInterpolate(t,e){nO.interpolateMap.set(t,e)}play(t){if(this.tailAnimate.play(t),this.target){let t=this.target.stage;t&&t.renderNextFrame()}return 1===this.subAnimates.length&&this.tailAnimate.totalDuration===t.duration&&this.trySetAttribute(t.getFromProps(),t.mode),this}trySetAttribute(t,e=nO.mode){t&&e&lC.SET_ATTR_IMMEDIATELY&&this.target.setAttributes&&this.target.setAttributes(t,!1,{type:lw.ANIMATE_PLAY})}runCb(t){let e=new nE(()=>{t(this,e.step.prev)});return this.tailAnimate.play(e),this}customInterpolate(t,e,i,r,n,s){let a=nO.interpolateMap.get(t)||nO.interpolateMap.get("");return!!a&&a(t,e,i,r,n,s)}pause(){this.status===lM.RUNNING&&(this.status=lM.PAUSED)}resume(){this.status===lM.PAUSED&&(this.status=lM.RUNNING)}to(t,e,i,r){if(this.tailAnimate.to(t,e,i,r),this.target){let t=this.target.stage;t&&t.renderNextFrame()}return this}from(t,e,i,r){if(this.tailAnimate.from(t,e,i,r),this.target){let t=this.target.stage;t&&t.renderNextFrame()}return this}wait(t){if(this.tailAnimate.wait(t),this.target){let t=this.target.stage;t&&t.renderNextFrame()}return this}startAt(t){if(this.tailAnimate.startAt(t),this.target){let t=this.target.stage;t&&t.renderNextFrame()}return this}loop(t){if(this.tailAnimate.loop=t,this.target){let t=this.target.stage;t&&t.renderNextFrame()}return this}reversed(t){if(this.tailAnimate.reversed=t,this.target){let t=this.target.stage;t&&t.renderNextFrame()}return this}bounce(t){if(this.tailAnimate.bounce=t,this.target){let t=this.target.stage;t&&t.renderNextFrame()}return this}subAnimate(){let t=new nP(this,this.tailAnimate);return this.tailAnimate=t,this.subAnimates.push(t),t.bind(this.target),this}getStartProps(){return this.subAnimates[0].getStartProps()}getEndProps(){return this.tailAnimate.getEndProps()}depreventAttr(t){this._preventAttrs&&this._preventAttrs.delete(t)}preventAttr(t){this._preventAttrs||(this._preventAttrs=new Set),this._preventAttrs.add(t)}preventAttrs(t){t.forEach(t=>this.preventAttr(t))}validAttr(t){return!this._preventAttrs||!this._preventAttrs.has(t)}bind(t){return this.target=t,this.target.onAnimateBind&&this.target.onAnimateBind(this),this.subAnimates.forEach(e=>{e.bind(t)}),this}advance(t){if(this._duringTime<this._startTime){if(this._duringTime+t*this.timeScale<this._startTime)return void(this._duringTime+=t*this.timeScale);t=this._duringTime+t*this.timeScale-this._startTime,this._duringTime=this._startTime}this.status===lM.INITIAL&&(this.status=lM.RUNNING,this._onStart&&this._onStart.forEach(t=>t())),this.setPosition(this.rawPosition+t*this.timeScale)&&this.status===lM.RUNNING&&(this.status=lM.END,this._onEnd&&this._onEnd.forEach(t=>t()))}setPosition(t){let e,i=0,r=this.rawPosition,n=this.subAnimates.reduce((t,e)=>t+e.totalDuration,0);t<0&&(t=0);let s=t>=n;if(s&&(t=n),t===r)return s;for(let r=0;r<this.subAnimates.length&&!(i+(e=this.subAnimates[r]).totalDuration>=t);r++)i+=e.totalDuration,e=void 0;return this.rawPosition=t,e.setPosition(t-i),s}onStart(t){this._onStart||(this._onStart=[]),this._onStart.push(t)}onEnd(t){this._onEnd||(this._onEnd=[]),this._onEnd.push(t)}onRemove(t){this._onRemove||(this._onRemove=[]),this._onRemove.push(t)}onFrame(t){this._onFrame||(this._onFrame=[]),this._onFrame.push(t)}release(){this.status=lM.END}stop(t){t||this.target.onStop(),"start"===t?this.target.onStop(this.getStartProps()):"end"===t?this.target.onStop(this.getEndProps()):this.target.onStop(t),this.release()}}nO.mode=lC.NORMAL,nO.interpolateMap=new Map;class nP{get totalDuration(){return this.calcAttr(),this._totalDuration+this._startAt}constructor(t,e){this.rawPosition=-1,this.position=0,this.loop=0,this.duration=0,this.animate=t,this.stepHead=new nR(0,0,e?Object.assign({},e.stepTail.props):{}),this.stepTail=this.stepHead,this.dirty=!0,this._startAt=0}calcAttr(){this.dirty&&(this._totalDuration=this.duration*(this.loop+1))}bind(t){return this.target=t,this}play(t){let e=t.duration;(null==e||e<0)&&(e=0);let i=t.easing,r="string"==typeof i?nw[i]:i,n=this._addStep(e,null,r);return n.type=lT.customAnimate,this._appendProps(t.getEndProps(),n,!1),this._appendCustomAnimate(t,n),this}to(t,e,i,r){(null==e||e<0)&&(e=0);let n="string"==typeof i?nw[i]:i,s=this._addStep(e,null,n);return s.type=lT.to,this._appendProps(t,s,!!r&&r.tempProps),s.propKeys||(s.propKeys=Object.keys(s.props)),r&&r.noPreventAttrs||this.target.animates.forEach(t=>{t.id!==this.animate.id&&t.preventAttrs(s.propKeys)}),this}from(t,e,i,r){this.to(t,0,i,r);let n={};this.stepTail.propKeys||(this.stepTail.propKeys=Object.keys(this.stepTail.props)),this.stepTail.propKeys.forEach(t=>{n[t]=this.getLastPropByName(t,this.stepTail)}),this.to(n,e,i,r),this.stepTail.type=lT.from}startAt(t){return t<0&&(t=0),this._startAt=t,this}getStartProps(){var t;return null===(t=this.stepHead)||void 0===t?void 0:t.props}getEndProps(){return this.stepTail.props}getLastStep(){return this._lastStep}wait(t){if(t>0){let e=this._addStep(+t,null);e.type=lT.wait,e.prev.customAnimate?e.props=e.prev.customAnimate.getEndProps():e.props=e.prev.props,this.target.onAddStep&&this.target.onAddStep(e)}return this}_addStep(t,e,i){let r=new nR(this.duration,t,e,i);return this.duration+=t,this.stepTail.append(r),this.stepTail=r,r}_appendProps(t,e,i){e.props=i?t:Object.assign({},t);let r=e.prev,n=e.props;for(e.propKeys||(e.propKeys=Object.keys(e.props)),e.propKeys.forEach(t=>{void 0===e.props[t]&&(e.props[t]=this.target.getDefaultAttribute(t))});r.prev;)r.props&&(r.propKeys||(r.propKeys=Object.keys(r.props)),r.propKeys.forEach(t=>{void 0===n[t]&&(n[t]=r.props[t])})),e.propKeys=Object.keys(e.props),r=r.prev;let s=this.stepHead.props;e.propKeys||(e.propKeys=Object.keys(n)),e.propKeys.forEach(t=>{if(void 0===s[t]){let e=this.animate.getStartProps();s[t]=e[t]=this.target.getComputedAttribute(t)}}),this.target.onAddStep&&this.target.onAddStep(e)}_appendCustomAnimate(t,e){e.customAnimate=t,t.step=e,t.bind(this.target,this)}setPosition(t){var e;let i=this.duration,r=this.loop,n=this.rawPosition,s,a,o=!1,l=null!==(e=this._startAt)&&void 0!==e?e:0;if(t<0&&(t=0),t<l)return this.rawPosition=t,!1;if(t-=l,i<=0)return!0;if(s=Math.floor(t/i),a=t-s*i,(o=t>=r*i+i)&&(t=(a=i)*(s=r)+i),t===n)return o;let h=!this.reversed!=!(this.bounce&&s%2);return h&&(a=i-a),this._deltaPosition=a-this.position,this.position=a,this.rawPosition=t+l,this.updatePosition(o,h),o}updatePosition(t,e){if(!this.stepHead)return;let i=this.stepHead.next,r=this.position,n=this.duration;if(this.target&&i){let s=i.next;for(;s&&s.position<=r;)s=(i=s).next;let a=t?0===n?1:r/n:(r-i.position)/i.duration;i.easing&&(a=i.easing(a)),this.tryCallCustomAnimateLifeCycle(i,this._lastStep||(e?this.stepTail:this.stepHead),e),this.updateTarget(i,a,t),this._lastStep=i,this.animate._onFrame&&this.animate._onFrame.forEach(t=>t(i,a))}}tryCallCustomAnimateLifeCycle(t,e,i){if(t!==e){if(i){let i=e.prev;for(;i&&i!==t;)i.customAnimate&&(i.customAnimate.onStart&&i.customAnimate.onStart(),i.customAnimate.onEnd&&i.customAnimate.onEnd()),i=t.prev;e&&e.customAnimate&&e.customAnimate.onEnd&&e.customAnimate.onEnd(),t&&t.customAnimate&&t.customAnimate.onStart&&t.customAnimate.onStart()}else{let i=e.next;for(;i&&i!==t;)i.customAnimate&&(i.customAnimate.onStart&&i.customAnimate.onStart(),i.customAnimate.onEnd&&i.customAnimate.onEnd()),i=i.next;e&&e.customAnimate&&e.customAnimate.onEnd&&e.customAnimate.onEnd(),t&&t.customAnimate&&t.customAnimate.onStart&&t.customAnimate.onStart()}}}getLastPropByName(t,e){let i=e.prev;for(;i;){if(i.props&&void 0!==i.props[t])return i.props[t];if(i.customAnimate){let e=i.customAnimate.getEndProps()[t];if(void 0!==e)return e}i=i.prev}return ex.getInstance().warn("\u672A\u77E5\u9519\u8BEF\uFF0Cstep\u4E2D\u627E\u4E0D\u5230\u5C5E\u6027"),e.props[t]}updateTarget(t,e,i){null==t.props&&null==t.customAnimate||this.target.onStep(this,this.animate,t,e,i)}}class nR{constructor(t,e,i,r){this.duration=e,this.position=t,this.props=i,this.easing=r}append(t){t.prev=this,t.next=this.next,this.next=t}getLastProps(){let t=this.prev;for(;t;){if(t.props)return t.props;if(t.customAnimate)return t.customAnimate.getMergedEndProps();t=t.prev}return null}}let nB={duration:200,easing:"cubicOut"},nI={duration:1e3,easing:"quadInOut"},nL=function(t,e,i){return t<e?e:t>i?i:t};function nD(t,e,i){e/=100;let r=(1-Math.abs(2*(i/=100)-1))*e,n=r*(1-Math.abs(t/60%2-1)),s=i-r/2,a=0,o=0,l=0;return 0<=t&&t<60?(a=r,o=n,l=0):60<=t&&t<120?(a=n,o=r,l=0):120<=t&&t<180?(a=0,o=r,l=n):180<=t&&t<240?(a=0,o=n,l=r):240<=t&&t<300?(a=n,o=0,l=r):300<=t&&t<360&&(a=r,o=0,l=n),{r:a=Math.round(255*(a+s)),g:o=Math.round(255*(o+s)),b:l=Math.round(255*(l+s))}}function nF(t,e,i){t/=255,e/=255;let r=Math.min(t,e,i/=255),n=Math.max(t,e,i),s=n-r,a=0,o=0,l=0;return(a=Math.round(60*(a=0===s?0:n===t?(e-i)/s%6:n===e?(i-t)/s+2:(t-e)/s+4)))<0&&(a+=360),l=(n+r)/2,o=+(100*(o=0===s?0:s/(1-Math.abs(2*l-1)))).toFixed(1),{h:a,s:o,l:l=+(100*l).toFixed(1)}}let nj=/^#([0-9a-f]{3,8})$/,nN={transparent:4294967040},nz={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function nH(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function nV(t){return ey(t)?new nY(t>>16,t>>8&255,255&t,1):eM(t)?new nY(t[0],t[1],t[2]):new nY(255,255,255)}function nW(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function nG(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let nU=(t,e)=>{let i=nj.exec(t);if(e||i){let t=parseInt(i[1],16),e=i[1].length;return 3===e?new nY((t>>8&15)+((t>>8&15)<<4),(t>>4&15)+((t>>4&15)<<4),(15&t)+((15&t)<<4),1):6===e?nV(t):8===e?new nY(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):null}};class n${static Brighter(t,e=1){return 1===e?t:new n$(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return 1===e?t:new n$(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){let i=t instanceof n$?t:new n$(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3()}}static parseColorString(t){if(eO(nN[t])){var e;return ey(e=nN[t])?new nY(e>>>24,e>>>16&255,e>>>8&255,255&e):eM(e)?new nY(e[0],e[1],e[2],e[3]):new nY(255,255,255,1)}if(eO(nz[t]))return nV(nz[t]);let i=`${t}`.trim().toLowerCase(),r=nU(i);if(void 0!==r)return r;if(/^(rgb|RGB|rgba|RGBA)/.test(i)){let t=i.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new nY(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),parseFloat(t[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(i)){let t=i.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),e=nD(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10));return new nY(e.r,e.g,e.b,parseFloat(t[3]))}}constructor(t){let e=n$.parseColorString(t);e?this.color=e:(console.warn(`Warn: \u{4F20}\u{5165}${t}\u{65E0}\u{6CD5}\u{89E3}\u{6790}\u{4E3A}Color`),this.color=new nY(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){let{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){let{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){let r=this.color.opacity,n=nF(this.color.r,this.color.g,this.color.b),s=nD(ej(t)?n.h:nL(t,0,360),ej(e)?n.s:e>=0&&e<=1?100*e:e,ej(i)?n.l:i<=1&&i>=0?100*i:i);return this.color=new nY(s.r,s.g,s.b,r),this}setRGB(t,e,i){return ej(t)||(this.color.r=t),ej(e)||(this.color.g=e),ej(i)||(this.color.b=i),this}setHex(t){let e=nU(`${t}`.trim().toLowerCase(),!0);return null!=e?e:this}setColorName(t){let e=nz[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}clone(){return new n$(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){let i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=nW(t.color.r),this.color.g=nW(t.color.g),this.color.b=nW(t.color.b),this}copyLinearToSRGB(t){return this.color.r=nG(t.color.r),this.color.g=nG(t.color.g),this.color.b=nG(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class nY{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),eO(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${nH(this.r)+nH(this.g)+nH(this.b)+(1===this.opacity?"":nH(255*this.opacity))}`}formatRgb(){let t=this.opacity;return`${1===t?"rgb(":"rgba("}${this.r},${this.g},${this.b}${1===t?")":`,${t})`}`}formatHsl(){let t=this.opacity,{h:e,s:i,l:r}=nF(this.r,this.g,this.b);return`${1===t?"hsl(":"hsla("}${e},${i}%,${r}%${1===t?")":`,${t})`}`}toString(){return this.formatHex()}}(lm=lB||(lB={}))[lm.Color255=0]="Color255",lm[lm.Color1=1]="Color1";class nK{static Get(t,e=lB.Color1,i=[0,0,0,1]){if(e===lB.Color1){let e=nK.store1[t];if(e)return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i;let r=n$.parseColorString(t);if(r){let e=[r.r/255,r.g/255,r.b/255,r.opacity];nK.store1[t]=e,nK.store255[t]=[r.r,r.g,r.b,r.opacity],i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]}return i}let r=nK.store255[t];if(r)return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i;let n=n$.parseColorString(t);return n&&(nK.store1[t]=[n.r/255,n.g/255,n.b/255,n.opacity],nK.store255[t]=[n.r,n.g,n.b,n.opacity],i[0]=n.r,i[1]=n.g,i[2]=n.b,i[3]=n.opacity),i}static Set(t,e,i){if(e===lB.Color1)!nK.store1[t]&&(nK.store1[t]=i,nK.store255[t]=[Math.floor(255*i[0]),Math.floor(255*i[1]),Math.floor(255*i[2]),Math.floor(255*i[3])]);else{if(nK.store255[t])return;nK.store255[t]=i,nK.store1[t]=[i[0]/255,i[1]/255,i[2]/255,i[3]]}}}function nZ(t,e=!1){return Array.isArray(t)&&ey(t[0])?e?`rgb(${Math.round(t[0])},${Math.round(t[1])},${Math.round(t[2])},${t[3].toFixed(2)})`:`rgb(${Math.round(t[0])},${Math.round(t[1])},${Math.round(t[2])})`:t}function nX(t,e,i,r,n){return Array.isArray(t)&&!ey(t[0])||Array.isArray(e)&&!ey(e[0])?[,,,,].fill(0).map((n,s)=>nq(eM(t)?t[s]:t,eM(e)?e[s]:e,i,r)):nq(t,e,i,r,n)}function nq(t,e,i,r,n){if(!t||!e)return t&&nZ(t)||e&&nZ(e)||!1;let s,a,o=!1,l=!1;if(Array.isArray(t)?s=t:"string"==typeof t?s=nK.Get(t,lB.Color255):o=!0,Array.isArray(e)?a=e:"string"==typeof e?a=nK.Get(e,lB.Color255):l=!0,o!==l){let s=o?t:e,a=o?e:t,l=Object.assign(Object.assign({},s),{stops:s.stops.map(t=>Object.assign(Object.assign({},t),{color:nZ(a)}))});return o?nX(s,l,i,r,n):nX(l,s,i,r,n)}if(o){if(t.gradient===e.gradient){let r=t.stops,n=e.stops;if(r.length!==n.length)return!1;if("linear"===t.gradient)return function(t,e,i){let r=t.stops,n=e.stops;return{gradient:"linear",x0:t.x0+(e.x0-t.x0)*i,x1:t.x1+(e.x1-t.x1)*i,y0:t.y0+(e.y0-t.y0)*i,y1:t.y1+(e.y1-t.y1)*i,stops:Array(r.length).fill(0).map((t,e)=>({color:n0(r[e].color,n[e].color,i),offset:r[e].offset+(n[e].offset-r[e].offset)*i}))}}(t,e,i);if("radial"===t.gradient)return function(t,e,i){let r=t.stops,n=e.stops;return{gradient:"radial",x0:t.x0+(e.x0-t.x0)*i,x1:t.x1+(e.x1-t.x1)*i,y0:t.y0+(e.y0-t.y0)*i,y1:t.y1+(e.y1-t.y1)*i,r0:t.r0+(e.r0-t.r0)*i,r1:t.r1+(e.r1-t.r1)*i,stops:Array(r.length).fill(0).map((t,e)=>({color:n0(r[e].color,n[e].color,i),offset:r[e].offset+(n[e].offset-r[e].offset)*i}))}}(t,e,i);if("conical"===t.gradient)return function(t,e,i){let r=t.stops,n=e.stops;return{gradient:"conical",startAngle:t.startAngle+(e.startAngle-t.startAngle)*i,endAngle:t.endAngle+(e.endAngle-t.endAngle)*i,x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i,stops:Array(r.length).fill(0).map((t,e)=>({color:n0(r[e].color,n[e].color,i),offset:r[e].offset+(n[e].offset-r[e].offset)*i}))}}(t,e,i)}return!1}return n&&n(s,a),nZ(function(t,e,i){return[t[0]+(e[0]-t[0])*i,t[1]+(e[1]-t[1])*i,t[2]+(e[2]-t[2])*i,t[3]+(e[3]-t[3])*i]}(s,a,i),r)}nK.store255={},nK.store1={};let nJ=[0,0,0,0],nQ=[0,0,0,0];function n0(t,e,i){return nK.Get(t,lB.Color255,nJ),nK.Get(e,lB.Color255,nQ),`rgba(${Math.round(nJ[0]+(nQ[0]-nJ[0])*i)},${Math.round(nJ[1]+(nQ[1]-nJ[1])*i)},${Math.round(nJ[2]+(nQ[2]-nJ[2])*i)},${nJ[3]+(nQ[3]-nJ[3])*i})`}class n1{static GetImage(t,e){var i;let r=n1.cache.get(t);r?"fail"===r.loadState?rj.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):"init"===r.loadState||"loading"===r.loadState?null===(i=r.waitingMark)||void 0===i||i.push(e):e&&e.imageLoadSuccess(t,r.data):n1.loadImage(t,e)}static GetSvg(t,e){var i;let r=n1.cache.get(t);r?"fail"===r.loadState?rj.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):"init"===r.loadState||"loading"===r.loadState?null===(i=r.waitingMark)||void 0===i||i.push(e):e&&e.imageLoadSuccess(t,r.data):(r={type:"image",loadState:"init"},n1.cache.set(t,r),r.dataPromise=rj.global.loadSvg(t),r.dataPromise?(r.waitingMark=[e],r.dataPromise.then(e=>{var i;r.loadState=(null==e?void 0:e.data)?"success":"fail",r.data=null==e?void 0:e.data,null===(i=r.waitingMark)||void 0===i||i.map((i,n)=>{(null==e?void 0:e.data)?(r.loadState="success",r.data=e.data,i.imageLoadSuccess(t,e.data)):(r.loadState="fail",i.imageLoadFail(t))})})):(r.loadState="fail",e.imageLoadFail(t)))}static GetFile(t,e){let i=n1.cache.get(t);return i?"init"===i.loadState||"fail"===i.loadState?Promise.reject():"loading"===i.loadState?i.dataPromise.then(t=>t.data):Promise.resolve(i.data):(i={type:e,loadState:"init"},n1.cache.set(t,i),"arrayBuffer"===e?i.dataPromise=rj.global.loadArrayBuffer(t):"blob"===e?i.dataPromise=rj.global.loadBlob(t):"json"===e&&(i.dataPromise=rj.global.loadJson(t)),i.dataPromise.then(t=>t.data))}static loading(){setTimeout(()=>{if(!n1.isLoading&&n1.toLoadAueue.length){n1.isLoading=!0;let t=n1.toLoadAueue.splice(0,10),e=[];t.forEach(t=>{let{url:i,marks:r}=t,n={type:"image",loadState:"init"};if(n1.cache.set(i,n),n.dataPromise=rj.global.loadImage(i),n.dataPromise){n.waitingMark=r;let t=n.dataPromise.then(t=>{var e;n.loadState=(null==t?void 0:t.data)?"success":"fail",n.data=null==t?void 0:t.data,null===(e=n.waitingMark)||void 0===e||e.map((e,r)=>{(null==t?void 0:t.data)?(n.loadState="success",n.data=t.data,e.imageLoadSuccess(i,t.data)):(n.loadState="fail",e.imageLoadFail(i))})});e.push(t)}else n.loadState="fail",r.forEach(t=>t.imageLoadFail(i))}),Promise.all(e).then(()=>{n1.isLoading=!1,this.onLoadSuccessCb.forEach(t=>t()),n1.loading()}).catch(t=>{console.error(t),n1.isLoading=!1,this.onLoadSuccessCb.forEach(t=>t()),n1.loading()})}},0)}static loadImage(t,e){let i=n2(t,n1.toLoadAueue);if(-1!==i)return n1.toLoadAueue[i].marks.push(e),void n1.loading();n1.toLoadAueue.push({url:t,marks:[e]}),n1.loading()}static improveImageLoading(t){let e=n2(t,n1.toLoadAueue);if(-1!==e){let t=n1.toLoadAueue.splice(e,1);n1.toLoadAueue.unshift(t[0])}}static onLoadSuccess(t){this.onLoadSuccessCb.push(t)}}function n2(t,e){for(let i=0;i<e.length;i++)if(e[i].url===t)return i;return -1}n1.cache=new Map,n1.isLoading=!1,n1.toLoadAueue=[],n1.onLoadSuccessCb=[];let n3=new iE,n5=new iI,n4=["lineWidth","scaleX","scaleY","angle","anchor","visible"],n8=["x","y"],n6=["scaleX","scaleY"],n9=["angle"],n7=new iW,st={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1};class se extends nS{static mixin(t){let e=Object.keys(t);for(let i=0;i<e.length;++i){let r=e[i];Object.defineProperty(se.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get AABBBounds(){return this.tryUpdateAABBBounds("imprecise"===this.attribute.boundsMode)}get OBBBounds(){return this.tryUpdateOBBBounds()}get globalAABBBounds(){return this.tryUpdateGlobalAABBBounds()}get transMatrix(){return this.tryUpdateLocalTransMatrix(!0)}get globalTransMatrix(){return this.tryUpdateGlobalTransMatrix(!0)}constructor(t={}){var e;super(),this._AABBBounds=new iI,this._updateTag=lk.INIT,this.attribute=t,this.valid=this.isValid(),t.background?this.loadImage(null!==(e=t.background.background)&&void 0!==e?e:t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic)}setMode(t){"3d"===t?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}getOffsetXY(t,e=!1){var i,r;let{dx:n=t.dx,dy:s=t.dy}=this.attribute;if(e&&this.parent){let t=this.parent.attribute;n7.x=n+(null!==(i=t.scrollX)&&void 0!==i?i:0),n7.y=s+(null!==(r=t.scrollY)&&void 0!==r?r:0)}else n7.x=n,n7.y=s;return n7}onAnimateBind(t){this._emitCustomEvent("animate-bind",t)}tryUpdateAABBBounds(t){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;rj.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);let e=this.doUpdateAABBBounds(t);return rj.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),e}combindShadowAABBBounds(t){if(this.shadowRoot){let e=this.shadowRoot.AABBBounds.clone();t.union(e)}}tryUpdateGlobalAABBBounds(){let t=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(t.x1,t.y1,t.x2,t.y2):this._globalAABBBounds=t.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}tryUpdateGlobalTransMatrix(t=!0){if(this._globalTransMatrix){if(this.parent){let t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!0}tryUpdateLocalTransMatrix(t=!0){return this._transMatrix||(this._transMatrix=new iE),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}shouldUpdateAABBBounds(){return this.shadowRoot?!!(this._updateTag&lk.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&lk.UPDATE_BOUNDS)}shouldSelfChangeUpdateAABBBounds(){return this.shadowRoot?!!(this._updateTag&lk.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&lk.UPDATE_BOUNDS)}shouldUpdateLocalMatrix(){return!!(this._updateTag&lk.UPDATE_LOCAL_MATRIX)}isValid(){var t,e;let i=this.attribute;return Number.isFinite((null!==(t=i.x)&&void 0!==t?t:0)+(null!==(e=i.y)&&void 0!==e?e:0))}_validNumber(t){return null==t||Number.isFinite(t)}shouldUpdateShape(){return!!(this._updateTag&lk.UPDATE_SHAPE)}clearUpdateShapeTag(){this._updateTag&=lk.CLEAR_SHAPE}containsPoint(t,e,i,r){if(!r)return!1;if(i===lA.GLOBAL){let i=new iW(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(i,i),t=i.x,e=i.y}return r.containsPoint(this,{x:t,y:e})}setAttributes(t,e=!1,i){(t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t).background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._setAttributes(t,e,i)}_setAttributes(t,e=!1,i){let r=Object.keys(t);for(let e=0;e<r.length;e++){let i=r[e];this.attribute[i]=t[i]}this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(e||this.needUpdateTags(r))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}setAttribute(t,e,i,r){var n;let s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);s?this._setAttributes(s,i,r):ej(null===(n=this.normalAttrs)||void 0===n?void 0:n[t])?(this.attribute[t]=e,this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(i||this.needUpdateTag(t))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)):this.normalAttrs[t]=e,"background"===t?this.loadImage(e,!0):"shadowGraphic"===t&&this.setShadowGraphic(e)}needUpdateTags(t,e=n4){for(let i=0;i<e.length;i++){let r=e[i];if(-1!==t.indexOf(r))return!0}return!1}needUpdateTag(t,e=n4){for(let i=0;i<e.length;i++)if(t===e[i])return!0;return!1}initAttributes(t){let e={type:lw.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._updateTag=lk.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}translate(t,e){var i,r;if(0===t&&0===e)return this;let n={type:lw.TRANSLATE},s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,n8,n);s&&(t=s.x,e=s.y,delete s.x,delete s.y,this._setAttributes(s));let a=this.attribute,o=a.postMatrix;return o?rj.transformUtil.fromMatrix(o,o).translate(t,e):(a.x=(null!==(i=a.x)&&void 0!==i?i:rm.x)+t,a.y=(null!==(r=a.y)&&void 0!==r?r:rm.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this}translateTo(t,e){let i=this.attribute;if(i.x===t&&i.y===e)return this;let r={type:lw.TRANSLATE_TO},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,n8,r);return n?this._setAttributes(n,!1,r):(i.x=t,i.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)),this}scale(t,e,i){var r,n;if(1===t&&1===e)return this;let s={type:lw.SCALE},a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:i},this.attribute,n6,s);a&&(t=a.scaleX,e=a.scaleY,delete a.scaleX,delete a.scaleY,this._setAttributes(a));let o=this.attribute;if(i){let{postMatrix:r}=this.attribute;r||(r=new iE,o.postMatrix=r),rj.transformUtil.fromMatrix(r,r).scale(t,e,i)}else o.scaleX=(null!==(r=o.scaleX)&&void 0!==r?r:rm.scaleX)*t,o.scaleY=(null!==(n=o.scaleY)&&void 0!==n?n:rm.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(s),this}scaleTo(t,e){let i=this.attribute;if(i.scaleX===t&&i.scaleY===e)return this;let r={type:lw.SCALE_TO},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,n6,r);return n?this._setAttributes(n,!1,r):(i.scaleX=t,i.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)),this}rotate(t,e){var i;if(0===t)return this;let r={type:lw.ROTATE},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,n9,r);n&&(delete n.angle,this._setAttributes(n,!1,r));let s=this.attribute;if(e){let{postMatrix:i}=this.attribute;i||(i=new iE,s.postMatrix=i),rj.transformUtil.fromMatrix(i,i).rotate(t,e)}else s.angle=(null!==(i=s.angle)&&void 0!==i?i:rm.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}rotateTo(t){let e=this.attribute;if(e.angle===t)return this;let i={type:lw.ROTATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,n9,i);return r?this._setAttributes(r,!1,i):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)),this}skewTo(t,e){return this}animate(t){this.animates||(this.animates=new Map);let e=new nO(null==t?void 0:t.id,this.stage&&this.stage.getTimeline()).bind(this);if(t){let{onStart:i,onFrame:r,onEnd:n,onRemove:s}=t;null!=i&&e.onStart(i),null!=r&&e.onFrame(r),null!=n&&e.onEnd(n),null!=s&&e.onRemove(s),e.interpolateFunc=t.interpolate}return this.animates.set(e.id,e),e.onRemove(()=>{this.animates.delete(e.id)}),e}onAttributeUpdate(t){t&&t.skipUpdateCallback||(rj.graphicService.onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}update(t){t?(t.bounds&&this.tryUpdateAABBBounds("imprecise"===this.attribute.boundsMode),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds("imprecise"===this.attribute.boundsMode),this.tryUpdateLocalTransMatrix())}hasState(t){return!(!this.currentStates||!this.currentStates.length)&&(!!ej(t)||this.currentStates.includes(t))}getState(t){var e;return null===(e=this.states)||void 0===e?void 0:e[t]}applyStateAttrs(t,e,i,r){var n,s,a,o;if(i){let i;let l=Object.keys(t),h=this.getNoWorkAnimateAttr(),u={};l.forEach(e=>{h[e]?(i||(i={}),i[e]=t[e]):u[e]=r&&void 0===t[e]?this.getDefaultAttribute(e):t[e]});let d=this.animate();d.stateNames=e,d.to(u,null!==(s=null===(n=this.stateAnimateConfig)||void 0===n?void 0:n.duration)&&void 0!==s?s:nB.duration,null!==(o=null===(a=this.stateAnimateConfig)||void 0===a?void 0:a.easing)&&void 0!==o?o:nB.easing),i&&this.setAttributes(i,!1,{type:lw.STATE})}else this.stopStateAnimates(),this.setAttributes(t,!1,{type:lw.STATE})}updateNormalAttrs(t){let e={};this.normalAttrs?(Object.keys(t).forEach(t=>{t in this.normalAttrs?(e[t]=this.normalAttrs[t],delete this.normalAttrs[t]):e[t]=this.getNormalAttribute(t)}),Object.keys(this.normalAttrs).forEach(e=>{t[e]=this.normalAttrs[e]})):Object.keys(t).forEach(t=>{e[t]=this.getNormalAttribute(t)}),this.normalAttrs=e}stopStateAnimates(t="end"){this.animates&&this.animates.forEach(e=>{e.stateNames&&(e.stop(t),this.animates.delete(e.id))})}getNormalAttribute(t){let e=this.attribute[t];return this.animates&&this.animates.forEach(i=>{if(i.stateNames){let r=i.getEndProps();nv(r,t)&&(e=r[t])}}),e}clearStates(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}removeState(t,e){if((this.currentStates?this.currentStates.indexOf(t):-1)>=0){let i=this.currentStates.filter(e=>e!==t);this.useStates(i,e)}}toggleState(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){let i=this.currentStates?this.currentStates.slice():[];i.push(t),this.useStates(i,e)}}addState(t,e,i){var r;if(this.currentStates&&this.currentStates.includes(t)&&(e||1===this.currentStates.length))return;let n=e&&(null===(r=this.currentStates)||void 0===r?void 0:r.length)?this.currentStates.concat([t]):[t];this.useStates(n,i)}useStates(t,e){var i;if(!t.length)return void this.clearStates(e);if(!((null===(i=this.currentStates)||void 0===i?void 0:i.length)!==t.length||t.some((t,e)=>this.currentStates[e]!==t)))return;let r={};t.forEach(e=>{var i;let n=this.stateProxy?this.stateProxy(e,t):null===(i=this.states)||void 0===i?void 0:i[e];n&&Object.assign(r,n)}),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}addUpdateBoundTag(){this._updateTag|=lk.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}addUpdateShapeTag(){this._updateTag|=lk.UPDATE_SHAPE}addUpdateShapeAndBoundsTag(){this._updateTag|=lk.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}updateShapeAndBoundsTagSetted(){return(this._updateTag&lk.UPDATE_SHAPE_AND_BOUNDS)===lk.UPDATE_SHAPE_AND_BOUNDS}clearUpdateBoundTag(){this._updateTag&=lk.CLEAR_BOUNDS}addUpdatePositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=lk.UPDATE_GLOBAL_LOCAL_MATRIX}addUpdateGlobalPositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=lk.UPDATE_GLOBAL_MATRIX}clearUpdateLocalPositionTag(){this._updateTag&=lk.CLEAR_LOCAL_MATRIX}clearUpdateGlobalPositionTag(){this._updateTag&=lk.CLEAR_GLOBAL_MATRIX}addUpdateLayoutTag(){this._updateTag|=lk.UPDATE_LAYOUT}clearUpdateLayoutTag(){this._updateTag&=lk.CLEAR_LAYOUT}needUpdateLayout(){return!!(this._updateTag&lk.UPDATE_LAYOUT)}getAnchor(t,e){let i=[0,0],r=()=>{if(e.b)return e.b;let{scaleX:t,scaleY:i,angle:r}=this.attribute;return n5.copy(this._AABBBounds),this.setAttributes({scaleX:1,scaleY:1,angle:0}),e.b=this.AABBBounds.clone(),this._AABBBounds.copy(n5),this.setAttributes({scaleX:t,scaleY:i,angle:r}),e.b};if("string"==typeof t[0]){let e=parseFloat(t[0])/100,n=r();i[0]=n.x1+(n.x2-n.x1)*e}else i[0]=t[0];if("string"==typeof t[1]){let e=parseFloat(t[1])/100,n=r();i[1]=n.y1+(n.y2-n.y1)*e}else i[1]=t[1];return i}doUpdateLocalMatrix(){let{x:t=rm.x,y:e=rm.y,scaleX:i=rm.scaleX,scaleY:r=rm.scaleY,angle:n=rm.angle,scaleCenter:s,anchor:a,postMatrix:o}=this.attribute,l=[0,0],h={};if(a&&(l=this.getAnchor(a,h)),s&&(1!==i||1!==r)){let a=this._transMatrix;a.reset(),a.translate(l[0],l[1]),a.rotate(n),a.translate(-l[0],-l[1]),a.translate(t,e),l=this.getAnchor(s,h),rj.transformUtil.fromMatrix(a,a).scale(i,r,{x:l[0],y:l[1]})}else!function(t,e,i,r,n,s,a,o){let l,h;let u=e.a,d=e.b,c=e.c,p=e.d,g=e.e,f=e.f,m=il(a),v=id(a);o?(l=o[0],h=o[1]):(l=i,h=r);let y=l-i,_=h-r,b=u*m+c*v,x=d*m+p*v,S=c*m-u*v,k=p*m-d*v;t.a=n*b,t.b=n*x,t.c=s*S,t.d=s*k,t.e=g+u*l+c*h-b*y-S*_,t.f=f+d*l+p*h-x*y-k*_}(this._transMatrix,this._transMatrix.reset(),t,e,i,r,n,a&&l);let u=this.getOffsetXY(rm);if(this._transMatrix.e+=u.x,this._transMatrix.f+=u.y,o){let t=n3.setValue(o.a,o.b,o.c,o.d,o.e,o.f),e=this._transMatrix;t.multiply(e.a,e.b,e.c,e.d,e.e,e.f),e.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}doUpdateGlobalMatrix(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);let{scrollX:t=0,scrollY:e=0}=this.parent.attribute;this._globalTransMatrix.translate(t,e)}}setStage(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){let e=t.getTimeline();this.animates.forEach(t=>{t.setTimeline(e)})}this._onSetStage&&this._onSetStage(this,t,e),rj.graphicService.onSetStage(this,t)}}setStageToShadowRoot(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}onAddStep(t){}onStop(t){t&&this.setAttributes(t,!1,{type:lw.ANIMATE_END})}onStep(t,e,i,r,n){let s={};if(i.customAnimate)i.customAnimate.update(n,r,s);else{let a=i.props,o=i.parsedProps,l=i.propKeys;this.stepInterpolate(t,e,s,i,r,n,a,void 0,o,l)}this.setAttributes(s,!1,{type:lw.ANIMATE_UPDATE,animationState:{ratio:r,end:n,step:i,isFirstFrameOfStep:t.getLastStep()!==i}}),this.stage&&this.stage.renderNextFrame()}stepInterpolate(t,e,i,r,n,s,a,o,l,h){h||(h=Object.keys(a),r.propKeys=h),s?r.propKeys.forEach(t=>{e.validAttr(t)&&(i[t]=a[t])}):h.forEach(s=>{var h;let u;if(!e.validAttr(s))return;let d=a[s],c=null!==(h=o&&o[s])&&void 0!==h?h:t.getLastPropByName(s,r);if(null==d||null==c)return void(i[s]=d);(u=e.interpolateFunc&&e.interpolateFunc(s,n,c,d,i))||(u=e.customInterpolate(s,n,c,d,this,i))||this.defaultInterpolate(d,c,s,i,l,n)||this._interpolate(s,n,c,d,i)}),r.parsedProps=l}defaultInterpolate(t,e,i,r,n,s){if(Number.isFinite(t))return r[i]=e+(t-e)*s,!0;if("fill"===i){n||(n={});let a=n.fillColorArray,o=nX(e,null!=a?a:t,s,!1,(t,e)=>{n.fillColorArray=e});return o&&(r[i]=o),!0}if("stroke"===i){n||(n={});let a=n.strokeColorArray,o=nX(e,null!=a?a:t,s,!1,(t,e)=>{n.strokeColorArray=e});return o&&(r[i]=o),!0}if("shadowColor"===i){n||(n={});let a=n.shadowColorArray,o=nX(e,null!=a?a:t,s,!0,(t,e)=>{n.shadowColorArray=e});return o&&(r[i]=o),!0}return!1}_interpolate(t,e,i,r,n){}getDefaultAttribute(t){return nf(this)[this.type][t]}getComputedAttribute(t){var e;return null!==(e=this.attribute[t])&&void 0!==e?e:this.getDefaultAttribute(t)}onSetStage(t,e=!1){this._onSetStage=t,e&&this.stage&&t(this,this.stage)}attachShadow(t){return t&&(t.shadowHost=this),this.shadowRoot=null!=t?t:rj.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}detachShadow(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot=null)}toJson(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map(t=>t.toJson())}}createPathProxy(t){return eE(t,!0)?this.pathProxy=(new rg).fromString(t):this.pathProxy=new rg,this.pathProxy}loadImage(t,e=!1){if(!t||e&&function(t){return!(!t.fill&&!t.stroke)}(t))return;this.resources||(this.resources=new Map);let i={data:"init",state:null};this.resources.set(t,i),"string"==typeof t?(i.state="loading",t.startsWith("<svg")?(n1.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):(ny(t)||t.includes("/")||n_(t))&&(n1.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):nb(t)?(i.state="success",i.data=t,this.backgroundImg=this.backgroundImg||e):i.state="fail"}setShadowGraphic(t){t?this.attachShadow().add(t):this.detachShadow()}imageLoadSuccess(t,e,i){if(!this.resources)return;let r=this.resources.get(t);r&&(r.state="success",r.data=e,i&&i(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}imageLoadFail(t,e){if(!this.resources)return;let i=this.resources.get(t);i&&(i.state="fail",e&&e())}_stopAnimates(t){t&&t.forEach(t=>{t.stop()})}stopAnimates(t=!1){this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren(e=>{e.stopAnimates(t)})}release(){this.releaseStatus="released",rj.graphicService.onRelease(this)}_emitCustomEvent(t,e){var i,r;if(this._events&&t in this._events){let n=new nA(t,e);n.bubbles=!1,n.manager=null===(r=null===(i=this.stage)||void 0===i?void 0:i.eventSystem)||void 0===r?void 0:r.manager,this.dispatchEvent(n)}}}se.mixin({dispatchEvent(t){var e;if(!(t instanceof nk))throw Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=[],t.detailPath&&(t.detailPath=[]),t.target=this,null===(e=null==t?void 0:t.manager)||void 0===e||e.dispatchEvent(t),!t.defaultPrevented},emit(t,e){return this.dispatchEvent(new nA(t,e))}}),(lv=lI||(lI={}))[lv.Top=1]="Top",lv[lv.Right=2]="Right",lv[lv.Bottom=4]="Bottom",lv[lv.Left=8]="Left",lv[lv.ALL=15]="ALL";let si=[!1,!1,!1,!1],sr=t=>{var e;let i=!0;if(ew(t,!0)){for(let r=0;r<4;r++)si[r]=t,i&&(i=!(null!==(e=si[r])&&void 0!==e&&!e));i=t}else if(Array.isArray(t))for(let e=0;e<4;e++)si[e]=!!t[e],i&&(i=!!si[e]);else si[0]=!1,si[1]=!1,si[2]=!1,si[3]=!1;return{isFullStroke:i,stroke:si}},sn=[0,0,0,0],ss=t=>t?eM(t)?0===t.length?0:1===t.length?t[0]:2===t.length?(sn[0]=t[0],sn[2]=t[0],sn[1]=t[1],sn[3]=t[1],sn):t:t:0,sa=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],so=[1,2,3,0,1,2,3,0];function sl(t,e,i,r){for(;t>=is;)t-=is;for(;t<0;)t+=is;for(;t>e;)e+=is;sa[0].x=i,sa[1].y=i,sa[2].x=-i,sa[3].y=-i;let n=Math.ceil(t/ii)%4,s=Math.ceil(e/ii)%4;if(r.add(il(t)*i,id(t)*i),r.add(il(e)*i,id(e)*i),n!==s||e-t>ie){let t=!1;for(let e=0;e<so.length;e++)if(t||n!==so[e]){if(t&&s===so[e])break;if(t){let t=sa[so[e]];r.add(t.x,t.y)}}else{t=!0;let e=sa[n];r.add(e.x,e.y)}}}function sh(t,e,i){let{x:r,y:n}=iv(t.x,t.y,e.x,e.y,i),{x:s,y:a}=iv(t.x1,t.y1,e.x1,e.y1,i),o=new iW(r,n,s,a);return o.defined=e.defined,o}function su(t,e,i){if(!t||!e)return[];Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);let r=[];if(t.length>e.length){r=e.map(t=>{let e=new iW(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e});for(let n=0;n<e.length;n++)r[n]=sh(t[n],e[n],i)}else{r=e.map(t=>{let e=new iW(t.x,t.y,t.x1,t.y1);return e.defined=t.defined,e});for(let n=0;n<t.length;n++)r[n]=sh(t[n],e[n],i)}return r}let sd=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","scrollX","scrollY"],sc=t=>sd.includes(t);function sp(t,e){if(eM(t)){let i;for(let r=0;r<t.length&&void 0===i;r++)i=t[r][e];return i}return t[e]}class sg{constructor(t=sg.TimeOut){this.durations=[],this.timeout=t,this.lastDate=0,this.durationsListThreshold=30}call(t){return this.lastDate=Date.now(),setTimeout(()=>{this.appendDuration(Date.now()-this.lastDate),t(0)},this.timeout,!0)}clear(t){clearTimeout(t)}appendDuration(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((t,e)=>t+e,0)/this.durations.length,1e3/60),1e3/30)}}sg.TimeOut=1e3/60;let sf=new sg,sm=(t,e)=>eE(t)&&"%"===t[t.length-1]?e*(Number.parseFloat(t.substring(0,t.length-1))/100):t;function sv(t,e,i,r=0){return t.expand(e+(r/2+(i?function(t,e){return t?e:0}(i,e):0))),t}let sy=0;function s_(){return sy++}function sb(t){let e=[],i=0,r="";for(let n=0;n<t.length;n++)(function(t){if(sx.has(t))return!0;if(sS.has(t))return!1;let e=!1;return 256>t.codePointAt(0)&&(e=!0),e})(t[n])?i?r+=t[n]:(i=1,r=t[n]):(i&&(e.push({text:r,direction:lL.VERTICAL}),r="",i=0),e.push({text:t[n],direction:lL.HORIZONTAL}));return r&&e.push({text:r,direction:lL.VERTICAL}),e}(ly=lL||(lL={}))[ly.HORIZONTAL=0]="HORIZONTAL",ly[ly.VERTICAL=1]="VERTICAL";let sx=new Map;["\u2026","\uFF08","\uFF09","\u2014","\u3010","\u3011","\u300C","\u300D","\u300A","\u300B"].forEach(t=>sx.set(t,!0));let sS=new Map;[""].forEach(t=>sS.set(t,!0));let sk=s_(),sA=s_(),sw=s_(),sM=s_(),sC=s_(),sT=s_(),sE=s_(),sO=s_(),sP=s_(),sR=s_(),sB=s_(),sI=s_(),sL=s_(),sD=s_(),sF=s_(),sj=s_(),sN=Symbol.for("GraphicService"),sz=Symbol.for("GraphicCreator"),sH={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},sV=Object.keys(sH);(l_=lD||(lD={}))[l_.LESS_GROUP=0]="LESS_GROUP",l_[l_.MORE_GROUP=1]="MORE_GROUP";class sW extends se{constructor(t){super(t),this.type="group",this.parent=null,this.isContainer=!0,this.numberType=sT,this._childUpdateTag=lk.UPDATE_BOUNDS}setMode(t){"3d"===t?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}setTheme(t){return this.theme||(this.theme=new np),this.theme.setTheme(t,this)}createTheme(){this.theme||(this.theme=new np)}hideAll(){this.setAttribute("visible",!1),this.forEachChildren(t=>{t.isContainer&&t.hideAll?t.hideAll():t.setAttribute("visible",!1)})}showAll(){this.setAttribute("visible",!0),this.forEachChildren(t=>{t.isContainer&&t.showAll?t.showAll():t.setAttribute("visible",!0)})}containsPoint(t,e,i){if(i===lA.GLOBAL){let i=new iW(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(i,i),this.AABBBounds.contains(i.x,i.y)}return this.AABBBounds.contains(t,e)}shouldUpdateAABBBounds(){return!!super.shouldUpdateAABBBounds()||!!(this._childUpdateTag&lk.UPDATE_BOUNDS)}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;rj.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);let t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),rj.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),e}doUpdateLocalMatrix(){let{x:t=rm.x,y:e=rm.y,dx:i=rm.dx,dy:r=rm.dy,scaleX:n=rm.scaleX,scaleY:s=rm.scaleY,angle:a=rm.angle,postMatrix:o}=this.attribute;if(0!==t||0!==e||0!==i||0!==r||1!==n||1!==s||0!==a||o)return super.doUpdateLocalMatrix();this._transMatrix.reset()}doUpdateAABBBounds(){let t=this.attribute,e=nf(this).group;this._AABBBounds.clear();let i=rj.graphicService.updateGroupAABBBounds(t,e,this._AABBBounds,this),{boundsPadding:r=e.boundsPadding}=t,n=ss(r);return n&&i.expand(n),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),i}clearUpdateBoundTag(){this._updateTag&=lk.CLEAR_BOUNDS,this._childUpdateTag&=lk.CLEAR_BOUNDS}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}addUpdateBoundTag(){this._updateTag|=lk.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}addChildUpdateBoundTag(){this._childUpdateTag&lk.UPDATE_BOUNDS||(this._childUpdateTag|=lk.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}getTheme(){return this.theme.getTheme(this)}incrementalAppendChild(t){let e=super.appendChild(t);return this.stage&&e&&(e.stage=this.stage,e.layer=this.layer),this.addUpdateBoundTag(),rj.graphicService.onAddIncremental(t,this,this.stage),e}incrementalClearChild(){super.removeAllChild(),this.addUpdateBoundTag(),rj.graphicService.onClearIncremental(this,this.stage)}appendChild(t,e=!0){let i=super.appendChild(t);return e&&this.stage&&i&&i.setStage(this.stage,this.layer),this.addUpdateBoundTag(),i}insertBefore(t,e){let i=super.insertBefore(t,e);return this.stage&&i&&i.setStage(this.stage,this.layer),this.addUpdateBoundTag(),i}insertAfter(t,e){let i=super.insertAfter(t,e);return this.stage&&i&&i.setStage(this.stage,this.layer),this.addUpdateBoundTag(),i}insertInto(t,e){let i=super.insertInto(t,e);return this.stage&&i&&i.setStage(this.stage,this.layer),this.addUpdateBoundTag(),i}removeChild(t){let e=super.removeChild(t);return t.stage=null,rj.graphicService.onRemove(t),this.addUpdateBoundTag(),e}removeAllChild(t=!1){this.forEachChildren(e=>{rj.graphicService.onRemove(e),t&&e.isContainer&&e.removeAllChild(t)}),super.removeAllChild(),this.addUpdateBoundTag()}setStage(t,e){this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),rj.graphicService.onSetStage(this,t),this.forEachChildren(e=>{e.setStage(t,this.layer)}))}addUpdatePositionTag(){super.addUpdatePositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}addUpdateGlobalPositionTag(){super.addUpdateGlobalPositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){let t=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!!(this._updateTag&lk.UPDATE_GLOBAL_MATRIX)}_getChildByName(t,e){return this.find(e=>e.name===t,e)}createOrUpdateChild(t,e,i){let r=this._getChildByName(t);return r?r.setAttributes(e):((r=rj.graphicService.creator[i](e)).name=t,this.add(r)),r}clone(){return new sW(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return sW.NOWORK_ANIMATE_ATTR}}function sG(t){return new sW(t)}sW.NOWORK_ANIMATE_ATTR=st;class sU extends sW{get offscreen(){return this.layerHandler.offscreen}get layerMode(){return this.layerHandler.type}get width(){return this.stage?this.stage.width:0}get height(){return this.stage?this.stage.height:0}get viewWidth(){return this.stage?this.stage.viewWidth:0}get viewHeight(){return this.stage?this.stage.viewHeight:0}get dirtyBound(){throw Error("\u6682\u4E0D\u652F\u6301")}get dpr(){return this._dpr}constructor(t,e,i,r){var n;super({}),this.stage=t,this.global=e,this.window=i,this.main=r.main,this.layerHandler=r.layerHandler,this.layerHandler.init(this,i,{main:r.main,canvasId:r.canvasId,width:this.viewWidth,height:this.viewHeight,zIndex:null!==(n=r.zIndex)&&void 0!==n?n:0}),this.layer=this,this.subLayers=new Map,this.theme=new np,this.background="rgba(0, 0, 0, 0)",this.afterDrawCbs=[]}combineSubLayer(t=!0){let e=Array.from(this.subLayers.values()).sort((t,e)=>t.zIndex-e.zIndex);this.layerHandler.merge(e.map(e=>(e.layer.subLayers.size&&e.layer.combineSubLayer(t),e.layer.getNativeHandler()))),t&&e.forEach(t=>{t.group&&(t.group.incremental=0)}),e.forEach(t=>{rj.layerService.releaseLayer(this.stage,t.layer)}),this.subLayers.clear()}getNativeHandler(){return this.layerHandler}setStage(t,e){super.setStage(t,this)}pick(t,e){throw Error("\u6682\u4E0D\u652F\u6301")}tryRenderSecondaryLayer(t,e){this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach(i=>{i.layer.renderCount=this.renderCount,i.layer.render(t,e)})}render(t,e){var i;this.layerHandler.render([this],{renderService:t.renderService,stage:this.stage,layer:this,viewBox:t.viewBox,transMatrix:t.transMatrix,background:null!==(i=t.background)&&void 0!==i?i:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach(t=>t(this)),this.tryRenderSecondaryLayer(t,e)}resize(t,e){this.layerHandler.resize(t,e)}resizeView(t,e){this.layerHandler.resizeView(t,e)}setDpr(t){this.layerHandler.setDpr(t)}afterDraw(t){this.afterDrawCbs.push(t)}startAnimate(t){throw Error("\u6682\u4E0D\u652F\u6301")}setToFrame(t){throw Error("\u6682\u4E0D\u652F\u6301")}prepare(t,e){}release(){super.release(),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach(t=>{rj.layerService.releaseLayer(this.stage,t.layer)})}drawTo(t,e){var i;this.layerHandler.drawTo(t,[this],Object.assign({background:null!==(i=e.background)&&void 0!==i?i:this.background,renderService:e.renderService,viewBox:e.viewBox,transMatrix:e.transMatrix,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach(t=>t(this))}}let s$=Symbol.for("TransformUtil"),sY=Symbol.for("GraphicUtil"),sK=Symbol.for("LayerService"),sZ=Symbol.for("StaticLayerHandlerContribution"),sX=Symbol.for("DynamicLayerHandlerContribution"),sq=Symbol.for("VirtualLayerHandlerContribution");let sJ=lF=class{static GenerateLayerId(){return`${lF.idprefix}_${lF.prefix_count++}`}constructor(){this.layerMap=new Map,this.global=rj.global}tryInit(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}getStageLayer(t){return this.layerMap.get(t)}getRecommendedLayerType(t){return t||(0!==this.staticLayerCountInEnv?"static":0!==this.dynamicLayerCountInEnv?"dynamic":"virtual")}getLayerHandler(t){let e;return"static"===t?r4.get(sZ):"dynamic"===t?r4.get(sX):r4.get(sq)}createLayer(t,e={main:!1}){var i;this.tryInit();let r=this.getRecommendedLayerType(e.layerMode);r=e.main||e.canvasId?"static":r;let n=this.getLayerHandler(r),s=new sU(t,this.global,t.window,Object.assign(Object.assign({main:!1},e),{layerMode:r,canvasId:null!==(i=e.canvasId)&&void 0!==i?i:lF.GenerateLayerId(),layerHandler:n})),a=this.layerMap.get(t)||[];return a.push(s),this.layerMap.set(t,a),this.staticLayerCountInEnv--,s}prepareStageLayer(t){let e;t.forEachChildren(t=>{let i=t.getNativeHandler();"virtual"===i.type?(i.mainHandler=e,e.secondaryHandlers.push(i)):(e=i).secondaryHandlers=[]})}releaseLayer(t,e){e.release();let i=this.layerMap.get(t)||[];this.layerMap.set(t,i.filter(t=>t!==e))}layerCount(t){return(this.layerMap.get(t)||[]).length}restLayerCount(t){return"browser"===this.global.env?10:0}releaseStage(t){this.layerMap.delete(t)}};sJ.idprefix="visactor_layer",sJ.prefix_count=0,sJ=lF=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],sJ);let sQ=new eW(t=>{t(e9).to(it).inSingletonScope(),t(nt).to(ni),t(sY).to(na).inSingletonScope(),t(s$).to(nl).inSingletonScope(),t(sK).to(sJ).inSingletonScope()}),s0=Symbol.for("IncrementalDrawContribution"),s1=Symbol.for("ArcRender"),s2=Symbol.for("Arc3dRender"),s3=Symbol.for("AreaRender"),s5=Symbol.for("CircleRender"),s4=Symbol.for("GraphicRender"),s8=Symbol.for("GroupRender"),s6=Symbol.for("LineRender"),s9=Symbol.for("PathRender"),s7=Symbol.for("PolygonRender"),at=Symbol.for("RectRender"),ae=Symbol.for("Rect3DRender"),ai=Symbol.for("SymbolRender"),ar=Symbol.for("TextRender"),an=Symbol.for("RichTextRender"),as=Symbol.for("Pyramid3dRender"),aa=Symbol.for("GlyphRender"),ao=Symbol.for("ImageRender");Symbol.for("RenderSelector");let al=Symbol.for("DrawContribution"),ah=Symbol.for("RenderService");Symbol.for("BeforeRenderConstribution");let au=class{constructor(t){this.drawContribution=t}prepare(t){t&&this.renderTreeRoots.forEach(e=>{this._prepare(e,t)})}_prepare(t,e){t.forEachChildren(t=>{this._prepare(t,e)}),t.update({bounds:e,trans:!0})}prepareRenderList(){}beforeDraw(t){}draw(t){this.drawContribution.draw(this,Object.assign({},this.drawParams))}afterDraw(t){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}render(t,e){this.renderTreeRoots=t,this.drawParams=e;let i=e.updateBounds;this.prepare(i),this.prepareRenderList(),this.beforeDraw(e),this.draw(e),this.afterDraw(e),this.drawParams=null}};au=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(lj=0,lN=e0(al),function(t,e){lN(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],au);let ad=new eW(t=>{t(ah).to(au)});Symbol.for("GraphicPicker");let ac=Symbol.for("PickerService");Symbol.for("BoundsPicker");let ap=Symbol.for("GlobalPickerService");function ag(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Symbol.for("MatrixAllocate"),Symbol.for("Mat4Allocate");class af{constructor(){this.pools=[]}static identity(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}allocate(){if(!this.pools.length)return ag();let t=this.pools.pop();return af.identity(t),t}allocateByObj(t){let e;e=this.pools.length?this.pools.pop():ag();for(let i=0;i<e.length;i++)e[i]=t[i];return e}free(t){t&&this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}let am=new class t{constructor(){this.pools=[]}allocate(t,e,i,r,n,s){if(!this.pools.length)return new iE(t,e,i,r,n,s);let a=this.pools.pop();return a.a=t,a.b=e,a.c=i,a.d=r,a.e=n,a.f=s,a}allocateByObj(t){if(!this.pools.length)return new iE(t.a,t.b,t.c,t.d,t.e,t.f);let e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}},av=new af;var ay=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a};let a_=Symbol.for("PickItemInterceptor"),ab=class{constructor(){this.order=1}afterPickItem(t,e,i,r,n){return t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx?this._pickItem(t,e,i,r,n):null}beforePickItem(t,e,i,r,n){return t.attribute.shadowRootIdx<0?this._pickItem(t,e,i,r,n):null}_pickItem(t,e,i,r,n){var s;if(!t.shadowRoot)return null;let{parentMatrix:a}=n||{};if(!a)return null;let o=e.pickContext;o.highPerformanceSave();let l=null===(s=nf(t))||void 0===s?void 0:s[t.type],{shadowPickMode:h=null==l?void 0:l.shadowPickMode}=t.attribute,u=t.shadowRoot,d=am.allocateByObj(a),c=new iW(d.a*i.x+d.c*i.y+d.e,d.b*i.x+d.d*i.y+d.f),p=e.pickGroup(u,c,d,r);return o.highPerformanceRestore(),!p.graphic&&p.group&&"full"===h&&(p.graphic=p.group),p}};ab=ay([eX()],ab);let ax=class{constructor(){this.order=1}beforePickItem(t,e,i,r,n){let s=t.baseGraphic;if(s&&s.parent){let t=new iW(i.x,i.y),n=e.pickContext;n.highPerformanceSave();let a=s.parent.globalTransMatrix;a.transformPoint(t,t);let o=s.isContainer?e.pickGroup(s,t.clone(),a,r):e.pickItem(s,t.clone(),a,r);return n.highPerformanceRestore(),o}return null}};ax=ay([eX()],ax);let aS=class{constructor(){this.order=1}beforePickItem(t,e,i,r,n){if(!t.in3dMode||r.in3dInterceptor)return null;let s=e.pickContext,a=t.stage;if(!s||!a)return null;if(r.in3dInterceptor=!0,s.save(),this.initCanvasCtx(s),s.camera=a.camera,t.isContainer){let a,o=!1,l=!1;if(t.forEachChildren(t=>!(o=t.numberType===sA)),t.forEachChildren(t=>!(l=!!t.findFace)),o){let s=t.getChildren(),o=[...s];o.sort((t,e)=>{var i,r,n,s;let a=(null!==(r=null!==(i=t.attribute.startAngle)&&void 0!==i?i:0+t.attribute.endAngle)&&void 0!==r?r:0)/2,o=(null!==(s=null!==(n=e.attribute.startAngle)&&void 0!==n?n:0+e.attribute.endAngle)&&void 0!==s?s:0)/2;for(;a<0;)a+=is;for(;o<0;)o+=is;return o-a}),o.forEach(t=>{t._next=null,t._prev=null}),t.removeAllChild(),t.update(),o.forEach(e=>{t.appendChild(e)}),r.hack_pieFace="outside",(a=e.pickGroup(t,i,n.parentMatrix,r)).graphic||(r.hack_pieFace="inside",a=e.pickGroup(t,i,n.parentMatrix,r)),a.graphic||(r.hack_pieFace="top",a=e.pickGroup(t,i,n.parentMatrix,r)),t.removeAllChild(),s.forEach(t=>{t._next=null,t._prev=null}),s.forEach(e=>{t.appendChild(e)})}else if(l){let o=t.getChildren(),l=o.map(t=>({ave_z:t.findFace().vertices.map(e=>{var i;return s.view(e[0],e[1],null!==(i=e[2]+t.attribute.z)&&void 0!==i?i:0)[2]}).reduce((t,e)=>t+e,0),g:t}));l.sort((t,e)=>e.ave_z-t.ave_z),t.removeAllChild(),l.forEach(t=>{t.g._next=null,t.g._prev=null}),t.update(),l.forEach(e=>{t.add(e.g)}),a=e.pickGroup(t,i,n.parentMatrix,r),t.removeAllChild(),o.forEach(t=>{t._next=null,t._prev=null}),t.update(),o.forEach(e=>{t.add(e)})}else a=e.pickGroup(t,i,n.parentMatrix,r);return s.camera=null,r.in3dInterceptor=!1,s.restore(),a}return s.restore(),null}initCanvasCtx(t){t.setTransformForCurrent()}};aS=ay([eX()],aS);let ak=new eW((t,e,i)=>{i(ac)||(t(ap).toSelf(),t(ac).toService(ap)),t(aS).toSelf().inSingletonScope(),t(a_).toService(aS),t(ab).toSelf().inSingletonScope(),t(a_).toService(ab),t(ax).toSelf().inSingletonScope(),t(a_).toService(ax),e5(t,a_)});function aA(t,e=0,i=0){let r;if(!t)return{width:e,height:i};try{r=null==window?void 0:window.getComputedStyle}catch(t){r=()=>({})}let n=r(t);if(/^(\d*\.?\d+)(px)$/.exec(n.width)){let r=parseFloat(n.width)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)||t.clientWidth-1,s=parseFloat(n.height)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)||t.clientHeight-1;return{width:r<=0?e:r,height:s<=0?i:s}}return{width:e,height:i}}function aw(t,e){let i=t.parentNode;for(;null!==i;){if(i===e)return!0;i=i.parentNode}return!1}let aM=(t="")=>{let e={};return t.split(";").forEach(t=>{if(t){let i=t.split(":");if(2===i.length){let t=i[0].trim(),r=i[1].trim();t&&r&&(e[t]=r)}}}),e},aC=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase();function aT(t,e={},i){i||(i=1);let{fontStyle:r=e.fontStyle,fontVariant:n=e.fontVariant,fontWeight:s=e.fontWeight,fontSize:a=e.fontSize,fontFamily:o=e.fontFamily}=t;return(r?r+" ":"")+(n?n+" ":"")+(s?s+" ":"")+a*i+"px "+(o||"sans-serif")}function aE(t,e){return"end"===t||"right"===t?-e:"center"===t?-e/2:0}function aO(t,e,i,r=0){return"middle"===t?-e/2:"top"===t?0:"bottom"===t?r-e:t&&"alphabetic"!==t?0:(i||(i=e),-(e-i)/2-.79*i)}class aP{updateBounds(t,e,i,r){let{outerBorder:n,shadowBlur:s=e.shadowBlur}=t;if(n){let t=e.outerBorder,{distance:r=t.distance,lineWidth:a=t.lineWidth}=n;i.expand(r+(s+a)/2)}return i}}class aR extends aP{updateBounds(t,e,i,r){let{outerBorder:n,shadowBlur:s=e.shadowBlur,strokeBoundsBuffer:a=e.strokeBoundsBuffer}=t;if(n){let t=e.outerBorder,{distance:r=t.distance,lineWidth:o=t.lineWidth}=n;sv(i,r+(s+o)/2,!0,a)}return i}}function aB(t,e,i){let r,n,s,a,o,l,h,u,d,c,p,g;let f=i[0],m=i[1],v=i[2];return e===t?(t[12]=e[0]*f+e[4]*m+e[8]*v+e[12],t[13]=e[1]*f+e[5]*m+e[9]*v+e[13],t[14]=e[2]*f+e[6]*m+e[10]*v+e[14],t[15]=e[3]*f+e[7]*m+e[11]*v+e[15]):(r=e[0],n=e[1],s=e[2],a=e[3],o=e[4],l=e[5],h=e[6],u=e[7],d=e[8],c=e[9],p=e[10],g=e[11],t[0]=r,t[1]=n,t[2]=s,t[3]=a,t[4]=o,t[5]=l,t[6]=h,t[7]=u,t[8]=d,t[9]=c,t[10]=p,t[11]=g,t[12]=r*f+o*m+d*v+e[12],t[13]=n*f+l*m+c*v+e[13],t[14]=s*f+h*m+p*v+e[14],t[15]=a*f+u*m+g*v+e[15]),t}function aI(t,e){t[0]=e.a,t[1]=e.b,t[2]=0,t[3]=0,t[4]=e.c,t[5]=e.d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e.e,t[13]=e.f,t[14]=0,t[15]=1}function aL(t,e,i){let r=e[0],n=e[1],s=e[2],a=e[3],o=e[4],l=e[5],h=e[6],u=e[7],d=e[8],c=e[9],p=e[10],g=e[11],f=e[12],m=e[13],v=e[14],y=e[15],_=i[0],b=i[1],x=i[2],S=i[3];return t[0]=_*r+b*o+x*d+S*f,t[1]=_*n+b*l+x*c+S*m,t[2]=_*s+b*h+x*p+S*v,t[3]=_*a+b*u+x*g+S*y,_=i[4],b=i[5],x=i[6],S=i[7],t[4]=_*r+b*o+x*d+S*f,t[5]=_*n+b*l+x*c+S*m,t[6]=_*s+b*h+x*p+S*v,t[7]=_*a+b*u+x*g+S*y,_=i[8],b=i[9],x=i[10],S=i[11],t[8]=_*r+b*o+x*d+S*f,t[9]=_*n+b*l+x*c+S*m,t[10]=_*s+b*h+x*p+S*v,t[11]=_*a+b*u+x*g+S*y,_=i[12],b=i[13],x=i[14],S=i[15],t[12]=_*r+b*o+x*d+S*f,t[13]=_*n+b*l+x*c+S*m,t[14]=_*s+b*h+x*p+S*v,t[15]=_*a+b*u+x*g+S*y,t}function aD(t,e,i){var r,n;let{x:s=i.x,y:a=i.y,z:o=i.z,dx:l=i.dx,dy:h=i.dy,dz:u=i.dz,scaleX:d=i.scaleX,scaleY:c=i.scaleY,scaleZ:p=i.scaleZ,alpha:g=i.alpha,beta:f=i.beta,angle:m=i.angle,anchor3d:v=e.attribute.anchor,anchor:y}=e.attribute,_=[0,0,0];if(v){if("string"==typeof v[0]){let t=parseFloat(v[0])/100,i=e.AABBBounds;_[0]=i.x1+(i.x2-i.x1)*t}else _[0]=v[0];if("string"==typeof v[1]){let t=parseFloat(v[1])/100,i=e.AABBBounds;_[1]=i.x1+(i.x2-i.x1)*t}else _[1]=v[1];_[2]=null!==(r=v[2])&&void 0!==r?r:0}if((n=t)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,aB(t,t,[s+l,a+h,o+u]),aB(t,t,[_[0],_[1],_[2]]),function(t,e,i){let r=Math.sin(i),n=Math.cos(i),s=e[4],a=e[5],o=e[6],l=e[7],h=e[8],u=e[9],d=e[10],c=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*n+h*r,t[5]=a*n+u*r,t[6]=o*n+d*r,t[7]=l*n+c*r,t[8]=h*n-s*r,t[9]=u*n-a*r,t[10]=d*n-o*r,t[11]=c*n-l*r}(t,t,f),function(t,e,i){let r=Math.sin(i),n=Math.cos(i),s=e[0],a=e[1],o=e[2],l=e[3],h=e[8],u=e[9],d=e[10],c=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n-h*r,t[1]=a*n-u*r,t[2]=o*n-d*r,t[3]=l*n-c*r,t[8]=s*r+h*n,t[9]=a*r+u*n,t[10]=o*r+d*n,t[11]=l*r+c*n}(t,t,g),aB(t,t,[-_[0],-_[1],_[2]]),function(t,e,i){let r=i[0],n=i[1],s=i[2];t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(t,t,[d,c,p]),m){let i=av.allocate(),r=[0,0];if(y){if("string"==typeof v[0]){let t=parseFloat(v[0])/100,i=e.AABBBounds;r[0]=i.x1+(i.x2-i.x1)*t}else r[0]=v[0];if("string"==typeof v[1]){let t=parseFloat(v[1])/100,i=e.AABBBounds;r[1]=i.x1+(i.x2-i.x1)*t}else r[1]=v[1]}aB(i,i,[r[0],r[1],0]),function(t,e,i){let r=Math.sin(i),n=Math.cos(i),s=e[0],a=e[1],o=e[2],l=e[3],h=e[4],u=e[5],d=e[6],c=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n+h*r,t[1]=a*n+u*r,t[2]=o*n+d*r,t[3]=l*n+c*r,t[4]=h*n-s*r,t[5]=u*n-a*r,t[6]=d*n-o*r,t[7]=c*n-l*r}(i,i,m),aB(i,i,[-r[0],-r[1],0]),aL(t,t,i)}}let aF=class{constructor(t){this.creator=t,this.hooks={onAttributeUpdate:new e8(["graphic"]),onSetStage:new e8(["graphic","stage"]),onRemove:new e8(["graphic"]),onRelease:new e8(["graphic"]),onAddIncremental:new e8(["graphic","group","stage"]),onClearIncremental:new e8(["graphic","group","stage"]),beforeUpdateAABBBounds:new e8(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new e8(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"])},this.tempAABBBounds1=new iI,this.tempAABBBounds2=new iI,this._rectBoundsContribitions=[new aP],this._symbolBoundsContribitions=[new aR],this._imageBoundsContribitions=[new aP],this._circleBoundsContribitions=[new aP],this._arcBoundsContribitions=[new aP],this._pathBoundsContribitions=[new aP]}onAttributeUpdate(t){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(t)}onSetStage(t,e){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(t,e)}onRemove(t){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(t)}onRelease(t){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(t)}onAddIncremental(t,e,i){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(t,e,i)}onClearIncremental(t,e){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(t,e)}beforeUpdateAABBBounds(t,e,i,r){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(t,e,i,r)}afterUpdateAABBBounds(t,e,i,r,n){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(t,e,i,r,n)}updatePathProxyAABBBounds(t,e){let i="function"==typeof e.pathProxy?e.pathProxy(e.attribute):e.pathProxy;if(!i)return!1;let r=new iP(t);return iV(i.commandList,r,0,0),!0}updateRectAABBBounds(t,e,i,r){if(!this._validCheck(t,e,i,r))return i;if(!this.updatePathProxyAABBBounds(i,r)){let{width:e,height:r}=t,{x1:n,y1:s,x:a,y:o}=t;e=null!=e?e:n-a,r=null!=r?r:s-o,(isFinite(e)||isFinite(r)||isFinite(a)||isFinite(o))&&i.set(0,0,e||0,r||0)}let n=this.tempAABBBounds1,s=this.tempAABBBounds2;return n.setValue(i.x1,i.y1,i.x2,i.y2),s.setValue(i.x1,i.y1,i.x2,i.y2),this._rectBoundsContribitions.length&&this._rectBoundsContribitions.forEach(a=>{a.updateBounds(t,e,n,r),i.union(n),n.setValue(s.x1,s.y1,s.x2,s.y2)}),this.transformAABBBounds(t,i,e,!1,r),i}updateGroupAABBBounds(t,e,i,r){let n=i;i=i.clone();let{width:s,height:a,path:o,clip:l=e.clip,display:h}=t;o&&o.length?o.forEach(t=>{i.union(t.AABBBounds)}):null!=s&&null!=a&&i.set(0,0,Math.max(0,s),Math.max(0,a)),l||r.forEachChildren(t=>{i.union(t.AABBBounds)});let u=this.tempAABBBounds1,d=this.tempAABBBounds2;return u.setValue(i.x1,i.y1,i.x2,i.y2),d.setValue(i.x1,i.y1,i.x2,i.y2),this.transformAABBBounds(t,i,e,!1,r),n.copy(i),n}updateGlyphAABBBounds(t,e,i,r){return this._validCheck(t,e,i,r)&&r.getSubGraphic().forEach(t=>{i.union(t.AABBBounds)}),i}updateHTMLTextAABBBounds(t,e,i,r){let{textAlign:n,textBaseline:s}=t;if(null!=t.forceBoundsHeight){let e=ey(t.forceBoundsHeight)?t.forceBoundsHeight:t.forceBoundsHeight(),r=aO(s,e,e);i.set(i.x1,r,i.x2,r+e)}if(null!=t.forceBoundsWidth){let e=ey(t.forceBoundsWidth)?t.forceBoundsWidth:t.forceBoundsWidth(),r=aE(n,e);i.set(r,i.y1,r+e,i.y2)}}updateRichTextAABBBounds(t,e,i,r){if(!this._validCheck(t,e,i,r)||!r)return i;let{width:n=e.width,height:s=e.height,maxWidth:a=e.maxWidth,maxHeight:o=e.maxHeight,textAlign:l=e.textAlign,textBaseline:h=e.textBaseline}=t;if(n>0&&s>0)i.set(0,0,n,s);else{let{width:t,height:e}=r.getFrameCache().getActualSize(),l=n||t||0,h=s||e||0;h="number"==typeof o&&h>o?o:h||0,l="number"==typeof a&&l>a?a:l||0,i.set(0,0,l,h)}let u=0;switch(h){case"top":u=0;break;case"middle":u=-i.height()/2;break;case"bottom":u=-i.height()}let d=0;switch(l){case"left":d=0;break;case"center":d=-i.width()/2;break;case"right":d=-i.width()}i.translate(d,u);let c=this.tempAABBBounds1,p=this.tempAABBBounds2;return c.setValue(i.x1,i.y1,i.x2,i.y2),p.setValue(i.x1,i.y1,i.x2,i.y2),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||this.updateHTMLTextAABBBounds(t,e,i),this.transformAABBBounds(t,i,e,!1,r),i}updateTextAABBBounds(t,e,i,r){if(!this._validCheck(t,e,i,r)||!r)return i;let{text:n=e.text}=r.attribute;Array.isArray(n)?r.updateMultilineAABBBounds(n):r.updateSingallineAABBBounds(n);let s=this.tempAABBBounds1,a=this.tempAABBBounds2;s.setValue(i.x1,i.y1,i.x2,i.y2),a.setValue(i.x1,i.y1,i.x2,i.y2);let{scaleX:o=e.scaleX,scaleY:l=e.scaleY,shadowBlur:h=e.shadowBlur,strokeBoundsBuffer:u=e.strokeBoundsBuffer}=t;return h&&(sv(s,h/Math.abs(o+l),!0,u),i.union(s)),this.combindShadowAABBBounds(i,r),null==t.forceBoundsHeight&&null==t.forceBoundsWidth||this.updateHTMLTextAABBBounds(t,e,i),iR(i,i,r.transMatrix),i}updatePathAABBBounds(t,e,i,r){if(!this._validCheck(t,e,i,r))return i;this.updatePathProxyAABBBounds(i,r)||this.updatePathAABBBoundsImprecise(t,e,i,r);let n=this.tempAABBBounds1,s=this.tempAABBBounds2;n.setValue(i.x1,i.y1,i.x2,i.y2),s.setValue(i.x1,i.y1,i.x2,i.y2),this._pathBoundsContribitions.length&&this._pathBoundsContribitions.forEach(a=>{a.updateBounds(t,e,n,r),i.union(n),n.setValue(s.x1,s.y1,s.x2,s.y2)});let{lineJoin:a=e.lineJoin}=t;return this.transformAABBBounds(t,i,e,"miter"===a,r),i}updatePathAABBBoundsImprecise(t,e,i,r){if(!r)return i;let n=r.getParsedPathShape();return i.union(n.getBounds()),i}updatePyramid3dAABBBounds(t,e,i,r){if(!r)return i;let n=r.stage;if(!n||!n.camera)return i;r.findFace().vertices.forEach(t=>{let e=t[0],r=t[1];i.add(e,r)});let s=this.tempAABBBounds1,a=this.tempAABBBounds2;return s.setValue(i.x1,i.y1,i.x2,i.y2),a.setValue(i.x1,i.y1,i.x2,i.y2),this.transformAABBBounds(t,i,e,!1,r),i}updateArc3dAABBBounds(t,e,i,r){if(!r)return i;let n=r.stage;if(!n||!n.camera)return i;let{outerRadius:s=e.outerRadius,height:a=0}=t,o=s+a;i.setValue(-o,-o,o,o);let l=this.tempAABBBounds1,h=this.tempAABBBounds2;return l.setValue(i.x1,i.y1,i.x2,i.y2),h.setValue(i.x1,i.y1,i.x2,i.y2),this.transformAABBBounds(t,i,e,!1,r),i}updatePolygonAABBBounds(t,e,i,r){if(!this._validCheck(t,e,i,r))return i;this.updatePathProxyAABBBounds(i,r)||this.updatePolygonAABBBoundsImprecise(t,e,i,r);let n=this.tempAABBBounds1,s=this.tempAABBBounds2;n.setValue(i.x1,i.y1,i.x2,i.y2),s.setValue(i.x1,i.y1,i.x2,i.y2);let{lineJoin:a=e.lineJoin}=t;return this.transformAABBBounds(t,i,e,"miter"===a,r),i}updatePolygonAABBBoundsImprecise(t,e,i,r){let{points:n=e.points}=t;return n.forEach(t=>{i.add(t.x,t.y)}),i}updateLineAABBBounds(t,e,i,r){if(!this._validCheck(t,e,i,r))return i;this.updatePathProxyAABBBounds(i,r)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,i,r):this.updateLineAABBBoundsByPoints(t,e,i,r));let n=this.tempAABBBounds1,s=this.tempAABBBounds2;n.setValue(i.x1,i.y1,i.x2,i.y2),s.setValue(i.x1,i.y1,i.x2,i.y2);let{lineJoin:a=e.lineJoin}=t;return this.transformAABBBounds(t,i,e,"miter"===a,r),i}updateLineAABBBoundsByPoints(t,e,i,r){let{points:n=e.points,connectedType:s}=t;return n.forEach(t=>{!1===t.defined&&"zero"!==s||i.add(t.x,t.y)}),i}updateLineAABBBoundsBySegments(t,e,i,r){let{segments:n=e.segments,connectedType:s}=t;return n.forEach(t=>{t.points.forEach(t=>{!1===t.defined&&"zero"!==s||i.add(t.x,t.y)})}),i}updateAreaAABBBounds(t,e,i,r){if(!this._validCheck(t,e,i,r))return i;this.updatePathProxyAABBBounds(i,r)||(t.segments?this.updateAreaAABBBoundsBySegments(t,e,i,r):this.updateAreaAABBBoundsByPoints(t,e,i,r));let n=this.tempAABBBounds1,s=this.tempAABBBounds2;n.setValue(i.x1,i.y1,i.x2,i.y2),s.setValue(i.x1,i.y1,i.x2,i.y2);let{lineJoin:a=e.lineJoin}=t;return this.transformAABBBounds(t,i,e,"miter"===a,r),i}updateAreaAABBBoundsByPoints(t,e,i,r){let{points:n=e.points}=t;return n.forEach(t=>{var e,r;i.add(t.x,t.y),i.add(null!==(e=t.x1)&&void 0!==e?e:t.x,null!==(r=t.y1)&&void 0!==r?r:t.y)}),i}updateAreaAABBBoundsBySegments(t,e,i,r){let{segments:n=e.segments}=t;return n.forEach(t=>{t.points.forEach(t=>{var e,r;i.add(t.x,t.y),i.add(null!==(e=t.x1)&&void 0!==e?e:t.x,null!==(r=t.y1)&&void 0!==r?r:t.y)})}),i}updateCircleAABBBounds(t,e,i,r,n){if(!this._validCheck(t,e,i,n))return i;this.updatePathProxyAABBBounds(i,n)||(r?this.updateCircleAABBBoundsImprecise(t,e,i,n):this.updateCircleAABBBoundsAccurate(t,e,i,n));let s=this.tempAABBBounds1,a=this.tempAABBBounds2;return s.setValue(i.x1,i.y1,i.x2,i.y2),a.setValue(i.x1,i.y1,i.x2,i.y2),this._circleBoundsContribitions.length&&this._circleBoundsContribitions.forEach(r=>{r.updateBounds(t,e,s,n),i.union(s),s.setValue(a.x1,a.y1,a.x2,a.y2)}),this.transformAABBBounds(t,i,e,!1,n),i}updateCircleAABBBoundsImprecise(t,e,i,r){let{radius:n=e.radius}=t;return i.set(-n,-n,n,n),i}updateCircleAABBBoundsAccurate(t,e,i,r){let{startAngle:n=e.startAngle,endAngle:s=e.endAngle,radius:a=e.radius}=t;return s-n>is-1e-12?i.set(-a,-a,a,a):sl(n,s,a,i),i}updateArcAABBBounds(t,e,i,r,n){if(!this._validCheck(t,e,i,n))return i;this.updatePathProxyAABBBounds(i,n)||(r?this.updateArcAABBBoundsImprecise(t,e,i,n):this.updateArcAABBBoundsAccurate(t,e,i,n));let s=this.tempAABBBounds1,a=this.tempAABBBounds2;s.setValue(i.x1,i.y1,i.x2,i.y2),a.setValue(i.x1,i.y1,i.x2,i.y2),this._arcBoundsContribitions.length&&this._arcBoundsContribitions.forEach(r=>{r.updateBounds(t,e,s,n),i.union(s),s.setValue(a.x1,a.y1,a.x2,a.y2)});let{lineJoin:o=e.lineJoin}=t;return this.transformAABBBounds(t,i,e,"miter"===o,n),i}updateArcAABBBoundsImprecise(t,e,i,r){let{outerRadius:n=e.outerRadius,innerRadius:s=e.innerRadius}=t,{outerPadding:a=e.outerPadding,innerPadding:o=e.innerPadding}=t;return(n+=a)<(s-=o)&&(n=s),i.set(-n,-n,n,n),i}updateArcAABBBoundsAccurate(t,e,i,r){let{outerRadius:n=e.outerRadius,innerRadius:s=e.innerRadius}=t,{outerPadding:a=e.outerPadding,innerPadding:o=e.innerPadding}=t;if((n+=a)<(s-=o)){let t=n;n=s,s=t}let{endAngle:l=e.endAngle,startAngle:h=e.startAngle}=t;if(h>l){let t=h;h=l,l=t}return n<=1e-12?i.set(0,0,0,0):Math.abs(l-h)>is-1e-12?i.set(-n,-n,n,n):(sl(h,l,n,i),sl(h,l,s,i)),i}updateSymbolAABBBounds(t,e,i,r,n){if(!this._validCheck(t,e,i,n))return i;this.updatePathProxyAABBBounds(i,n)||(r?this.updateSymbolAABBBoundsImprecise(t,e,i,n):this.updateSymbolAABBBoundsAccurate(t,e,i,n));let s=this.tempAABBBounds1,a=this.tempAABBBounds2;s.setValue(i.x1,i.y1,i.x2,i.y2),a.setValue(i.x1,i.y1,i.x2,i.y2),this._symbolBoundsContribitions.length&&this._symbolBoundsContribitions.forEach(r=>{r.updateBounds(t,e,s,n),i.union(s),s.setValue(a.x1,a.y1,a.x2,a.y2)});let{lineJoin:o=e.lineJoin}=t;return this.transformAABBBounds(t,i,e,"miter"===o,n),i}updateSymbolAABBBoundsImprecise(t,e,i,r){let{size:n=e.size}=t;if(eM(n))i.set(-n[0]/2,-n[1]/2,n[0]/2,n[1]/2);else{let t=n/2;i.set(-t,-t,t,t)}return i}updateSymbolAABBBoundsAccurate(t,e,i,r){if(!r)return i;let{size:n=e.size}=t;return r.getParsedPath().bounds(n,i),i}updateImageAABBBounds(t,e,i,r){if(!this._validCheck(t,e,i,r))return i;if(!this.updatePathProxyAABBBounds(i,r)){let{width:r=e.width,height:n=e.height}=t;i.set(0,0,r,n)}let n=this.tempAABBBounds1,s=this.tempAABBBounds2;return n.setValue(i.x1,i.y1,i.x2,i.y2),s.setValue(i.x1,i.y1,i.x2,i.y2),this._imageBoundsContribitions.length&&this._imageBoundsContribitions.forEach(a=>{a.updateBounds(t,e,n,r),i.union(n),n.setValue(s.x1,s.y1,s.x2,s.y2)}),this.transformAABBBounds(t,i,e,!1,r),i}combindShadowAABBBounds(t,e){if(e&&e.shadowRoot){let i=e.shadowRoot.AABBBounds;t.union(i)}}transformAABBBounds(t,e,i,r,n){if(!e.empty()){let{scaleX:n=i.scaleX,scaleY:s=i.scaleY,stroke:a=i.stroke,shadowBlur:o=i.shadowBlur,lineWidth:l=i.lineWidth,pickStrokeBuffer:h=i.pickStrokeBuffer,strokeBoundsBuffer:u=i.strokeBoundsBuffer}=t,d=this.tempAABBBounds1,c=this.tempAABBBounds2;if(a&&l&&(sv(d,(l+h)/Math.abs(n+s),r,u),e.union(d),d.setValue(c.x1,c.y1,c.x2,c.y2)),o){let{shadowOffsetX:r=i.shadowOffsetX,shadowOffsetY:a=i.shadowOffsetY}=t;sv(d,o/Math.abs(n+s)*2,!1,u+1),d.translate(r,a),e.union(d)}}if(this.combindShadowAABBBounds(e,n),e.empty())return;let s=!0,a=n.transMatrix;n&&n.isContainer&&(s=!(1===a.a&&0===a.b&&0===a.c&&1===a.d&&0===a.e&&0===a.f)),s&&iR(e,e,a)}_validCheck(t,e,i,r){if(!r||null!=t.forceBoundsHeight||null!=t.forceBoundsWidth)return!0;if(!r.valid)return i.clear(),!1;let{visible:n=e.visible}=t;return!!n||(i.clear(),!1)}};aF=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(lz=0,lH=e0(sz),function(t,e){lH(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],aF);let aj=new class t{constructor(){this.store=new Map}RegisterGraphicCreator(t,e){this.store.set(t,e),this[t]=e}CreateGraphic(t,e){let i=this.store.get(t);return i?i(e):null}},aN=new eW(t=>{t(sN).to(aF).inSingletonScope(),t(sz).toConstantValue(aj)}),az=Symbol.for("AutoEnablePlugins"),aH=Symbol.for("PluginService");var aV=function(t,e){return function(i,r){e(i,r,t)}};let aW=class{constructor(t){this.autoEnablePlugins=t,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}active(t,e){this.stage=t,this.actived=!0;let{pluginList:i}=e;i&&r4.isBound(az)&&this.autoEnablePlugins.getContributions().forEach(t=>{i.includes(t.name)&&this.register(t)})}findPluginsByName(t){let e=[];return this.onStartupFinishedPlugin.forEach(i=>{i.name===t&&e.push(i)}),this.onRegisterPlugin.forEach(i=>{i.name===t&&e.push(i)}),e}register(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.push(t):"onRegister"===t.activeEvent&&(this.onRegisterPlugin.push(t),t.activate(this))}unRegister(t){"onStartupFinished"===t.activeEvent?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1):"onRegister"===t.activeEvent&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(t),1),t.deactivate(this)}release(...t){this.onStartupFinishedPlugin.forEach(t=>{t.deactivate(this)}),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach(t=>{t.deactivate(this)}),this.onRegisterPlugin=[]}};aW=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),aV(0,e0(e2)),aV(0,e1(az)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],aW);let aG=new eW(t=>{t(aH).to(aW),function(t,e){t(e2).toDynamicValue(({container:t})=>new e3(e,t)).whenTargetNamed(e)}(t,az)}),aU=new eW(t=>{e5(t,e6)}),a$=new eW(t=>{t(rK).to(rZ).inSingletonScope(),e5(t,rK)}),aY=class{constructor(){this.type="static",this.offscreen=!1,this.global=rj.global}setDpr(t){this.canvas.dpr=t}init(t,e,i){if(this.layer=t,this.window=e,i.main)this.main=!0,this.context=e.getContext(),this.canvas=this.context.getCanvas();else{let t;this.main=!1,i.canvasId&&(t=this.global.getElementById(i.canvasId)),t||(t=this.global.createCanvas({width:e.width,height:e.height})),t.style&&(t.style["pointer-events"]="none");let r=e.getContext().getCanvas().nativeCanvas,n=r9({nativeCanvas:t,width:e.width,height:e.height,dpr:e.dpr,id:i.canvasId,canvasControled:!0,container:e.getContainer(),x:r.offsetLeft,y:r.offsetTop});n.applyPosition(),this.canvas=n,this.context=n.getContext()}}resize(t,e){this.canvas.resize(t,e)}resizeView(t,e){}render(t,e,i){var r;if(!this.main){let t=this.window.getContext().getCanvas().nativeCanvas;t&&(this.canvas.x!==t.offsetLeft||this.canvas.y!==t.offsetTop)&&(this.canvas.x=t.offsetLeft,this.canvas.y=t.offsetTop,this.canvas.applyPosition())}e.renderService.render(t,Object.assign(Object.assign({context:this.context,clear:null!==(r=e.background)&&void 0!==r?r:"#ffffff"},e),i))}merge(t){t.forEach(t=>{let e=t.getContext().canvas.nativeCanvas;this.context.drawImage(e,0,0)})}prepare(t,e){}drawTo(t,e,i){var r;let n=t.getContext();i.renderService.render(e,Object.assign(Object.assign({context:n},i),{clear:i.clear?null!==(r=i.background)&&void 0!==r?r:"#fff":void 0}))}getContext(){return this.context}release(){this.canvas.release()}};aY=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],aY);let aK=class{constructor(){this.offscreen=!1,this.type="virtual",this.global=rj.global}setDpr(t){}init(t,e,i){if(this.layer=t,this.window=e,i.main)throw Error("virtual layer\u4E0D\u80FD\u4F5C\u4E3Amain layer");this.main=!1,this.canvas=null,this.context=null}resize(t,e){}resizeView(t,e){}render(t,e,i){this.mainHandler.render(t,e,Object.assign(Object.assign({},i),{clear:!1}))}merge(t){}prepare(t,e){}drawTo(t,e,i){var r;let n=t.getContext();i.renderService.render(e,Object.assign(Object.assign({context:n},i),{clear:i.clear?null!==(r=i.background)&&void 0!==r?r:"#fff":void 0}))}getContext(){return null}release(){}};aK=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],aK);let aZ=class{constructor(){this.offscreen=!0,this.type="dynamic",this.global=rj.global}setDpr(t){this.canvas.dpr=t}init(t,e,i){this.layer=t;let r=r9({nativeCanvas:this.global.createOffscreenCanvas({width:i.width,height:i.height,dpr:e.dpr}),width:i.width,height:i.height,dpr:e.dpr,canvasControled:!0});this.canvas=r,this.context=r.getContext()}resize(t,e){this.canvas.resize(t,e)}resizeView(t,e){this.canvas.resize(t,e)}render(t,e){var i;e.renderService.render(t,Object.assign(Object.assign({context:this.context,viewBox:e.stage.window.getViewBox(),transMatrix:e.stage.window.getViewBoxTransform()},e),{clear:null!==(i=e.background)&&void 0!==i?i:"#ffffff"}))}prepare(t,e){}release(){this.canvas.release()}getContext(){return this.context}drawTo(t,e,i){let r=t.getContext(),n=t.dpr,{viewBox:s}=i,a=s.x1,o=s.y1,l=s.width(),h=s.height();r.nativeContext.save(),r.nativeContext.setTransform(n,0,0,n,0,0),i.clear&&r.clearRect(a,o,l,h),r.drawImage(this.canvas.nativeCanvas,0,0,this.canvas.width,this.canvas.height,a,o,l,h),r.nativeContext.restore()}merge(t){}};aZ=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],aZ);let aX=new eW(t=>{t(aY).toSelf(),t(aZ).toSelf(),t(aK).toSelf(),t(sZ).toService(aY),t(sX).toService(aZ),t(sq).toService(aK)}),aq=eQ(e$);function aJ(t,e,i,r=!1,n=!1){let s={},a=[],o=!1;if(n)o=!0;else{let i;t.forEachChildren((t,r)=>{let{zIndex:n=e}=t.attribute;if(0===r)i=n;else if(i!==n)return o=!0,!0;return!1},r)}if(o){t.forEachChildren(t=>{let{zIndex:i=e}=t.attribute;s[i]?s[i].push(t):(s[i]=[t],a.push(i))},r),a.sort((t,e)=>r?e-t:t-e);let o=!1;for(let t=0;t<a.length&&!o;t++){let e=s[a[t]];n&&e.sort((t,e)=>{var i,n;return(r?-1:1)*((null!==(i=e.attribute.z)&&void 0!==i?i:0)-(null!==(n=t.attribute.z)&&void 0!==n?n:0))});for(let t=0;t<e.length;t++)if(i(e[t],t)){o=!0;break}}}else t.forEachChildren(i,r)}function aQ(t,e,i,r=!1){var n,s,a,o;return n=this,s=void 0,a=void 0,o=function*(){yield t.forEachChildrenAsync(i,r)},new(a||(a=Promise))(function(t,e){function i(t){try{l(o.next(t))}catch(t){e(t)}}function r(t){try{l(o.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):((n=e.value)instanceof a?n:new a(function(t){t(n)})).then(i,r)}l((o=o.apply(n,s||[])).next())})}function a0(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1]}function a1(t,e,i,r){let n=t[0],s=e[0],a=i[0],o=r[0];return s<n&&([n,s]=[s,n]),o<a&&([o,a]=[a,o]),!(s<a||o<n)&&(n=t[1],s=e[1],a=i[1],o=r[1],s<n&&([n,s]=[s,n]),o<a&&([o,a]=[a,o]),!(s<a||o<n))}function a2(t,e,i,r){var n,s;if(!a1(t,e,i,r))return!1;let a=[0,0],o=[0,0],l=[0,0];if(a0(a,e,t),a0(o,r,i),n=a,s=o,ia(n[0]-s[0])+ia(n[1]-s[1])<1e-12)return!0;a0(l,i,t);let h=iy(l,o)/iy(a,o);return h>=0&&h<=1&&[t[0]+a[0]*h,t[1]+a[1]*h]}function a3(t,e,i){if(null===t)return e;if(null===e)return t;let{x11:r,x12:n,y11:s,y12:a,x21:o,x22:l,y21:h,y22:u}=a5(t,e,i);return r>=l||n<=o||s>=u||a<=h?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(r,o),y1:Math.max(s,h),x2:Math.min(n,l),y2:Math.min(a,u)}}(lV=lW||(lW={}))[lV.NONE=0]="NONE",lV[lV.BBOX1=1]="BBOX1",lV[lV.BBOX2=2]="BBOX2";let a5=(t,e,i)=>{let r=t.x1,n=t.x2,s=t.y1,a=t.y2,o=e.x1,l=e.x2,h=e.y1,u=e.y2;return i&&(r>n&&([r,n]=[n,r]),s>a&&([s,a]=[a,s]),o>l&&([o,l]=[l,o]),h>u&&([h,u]=[u,h])),{x11:r,x12:n,y11:s,y12:a,x21:o,x22:l,y21:h,y22:u}};function a4(t,e,i){if(t&&e){if(!i)return!(t.x1>e.x2||t.x2<e.x1||t.y1>e.y2||t.y2<e.y1);let{x11:r,x12:n,y11:s,y12:a,x21:o,x22:l,y21:h,y22:u}=a5(t,e,!0);return!(r>l||n<o||s>u||a<h)}return!0}function a8(t,e,i){if(!e)return!0;if(!i)return t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2;let r=e.x1,n=e.x2,s=e.y1,a=e.y2;return r>n&&([r,n]=[n,r]),s>a&&([s,a]=[a,s]),t.x>=r&&t.x<=n&&t.y>=s&&t.y<=a}function a6(t,e){return Math.abs(e[0]*t[0]+e[1]*t[1])}function a9({x:t,y:e},i,r={x:0,y:0}){return{x:(t-r.x)*Math.cos(i)+(e-r.y)*Math.sin(i)+r.x,y:(t-r.x)*Math.sin(i)+(r.y-e)*Math.cos(i)+r.y}}function a7(t){return{x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2}}function ot(t,e){let i=e?t.angle:ik(t.angle),r=a7(t);return[a9({x:t.x1,y:t.y1},i,r),a9({x:t.x2,y:t.y1},i,r),a9({x:t.x2,y:t.y2},i,r),a9({x:t.x1,y:t.y2},i,r)]}let oe=Symbol.for("DrawItemInterceptor"),oi=new iI,or=new iI;class on{constructor(){this.order=1}afterDrawItem(t,e,i,r,n){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0||(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(t,e,i,r,n),!1}beforeDrawItem(t,e,i,r,n){return null==t.attribute.shadowRootIdx&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0||(t.attribute.shadowRootIdx<0||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(t,e,i,r,n),!1}drawItem(t,e,i,r,n){if(!t.shadowRoot)return!1;let{context:s}=i;if(s.highPerformanceSave(),s.transformFromMatrix(t.transMatrix,!0),r.dirtyBounds&&r.backupDirtyBounds){oi.copy(r.dirtyBounds),or.copy(r.backupDirtyBounds);let e=t.globalTransMatrix.getInverse();r.dirtyBounds.copy(r.backupDirtyBounds).transformWithMatrix(e),r.backupDirtyBounds.copy(r.dirtyBounds)}return r.renderGroup(t.shadowRoot,i,t.parent.globalTransMatrix),s.highPerformanceRestore(),r.dirtyBounds&&r.backupDirtyBounds&&(r.dirtyBounds.copy(oi),r.backupDirtyBounds.copy(or)),!0}}class os{constructor(){this.order=1}afterDrawItem(t,e,i,r,n){return t.attribute._debug_bounds&&this.drawItem(t,e,i,r,n),!1}drawItem(t,e,i,r,n){if(!t.attribute._debug_bounds)return!1;let{context:s}=i;s.highPerformanceSave(),t.parent&&s.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&s.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);let a=t.AABBBounds;return!0!==t.attribute._debug_bounds&&t.attribute._debug_bounds(s,t),s.strokeRect(a.x1,a.y1,a.width(),a.height()),s.highPerformanceRestore(),!0}}let oa=class{constructor(){this.order=1,this.interceptors=[new on,new ol,new oo,new os]}afterDrawItem(t,e,i,r,n){for(let s=0;s<this.interceptors.length;s++)if(this.interceptors[s].afterDrawItem&&this.interceptors[s].afterDrawItem(t,e,i,r,n))return!0;return!1}beforeDrawItem(t,e,i,r,n){if((!t.in3dMode||i.in3dInterceptor)&&!t.shadowRoot&&!(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))return!1;for(let s=0;s<this.interceptors.length;s++)if(this.interceptors[s].beforeDrawItem&&this.interceptors[s].beforeDrawItem(t,e,i,r,n))return!0;return!1}};oa=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],oa);class oo{constructor(){this.order=1}beforeDrawItem(t,e,i,r,n){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,i,r,n):this.beforeSetInteractive(t,e,i,r,n))}beforeSetInteractive(t,e,i,r,n){let s=t.interactiveGraphic;if(t.attribute.globalZIndex){s||(s=t.clone(),t.interactiveGraphic=s,s.baseGraphic=t),s.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer();let e=i.stage.getLayer("_builtin_interactive");return e&&this.getShadowRoot(e).add(s),!0}if(s){i.stage.tryInitInteractiveLayer();let e=i.stage.getLayer("_builtin_interactive");e&&this.getShadowRoot(e).removeChild(s),t.interactiveGraphic=null,s.baseGraphic=null}return!1}beforeDrawInteractive(t,e,i,r,n){let s=t.baseGraphic;if(!s.stage){let e=i.stage.getLayer("_builtin_interactive");return e&&this.getShadowRoot(e).removeChild(t),!0}if(s){this.processing=!0;let{context:t}=i;return t.highPerformanceSave(),t.setTransformFromMatrix(s.parent.globalTransMatrix,!0),s.isContainer?r.renderGroup(s,i,s.parent.globalTransMatrix):r.renderItem(s,i),t.highPerformanceRestore(),this.processing=!1,!0}return!1}getShadowRoot(t){var e;let i=t.getElementById("_interactive_group");return i||((i=aj.CreateGraphic("group",{})).id="_interactive_group",t.add(i)),null!==(e=i.shadowRoot)&&void 0!==e?e:i.attachShadow()}}class ol{constructor(){this.order=1}beforeDrawItem(t,e,i,r,n){if(!t.in3dMode||i.in3dInterceptor)return!1;i.in3dInterceptor=!0;let{context:s,stage:a}=e.drawParams;s.canvas,s.save(),this.initCanvasCtx(s),s.camera=a.camera;let o=s.currentMatrix;o.a/=s.dpr,o.b/=s.dpr,o.c/=s.dpr,o.d/=s.dpr,o.e/=s.dpr,o.f/=s.dpr;let l=av.allocate();aI(l,o);let h=s.modelMatrix;if(h){if(l){let t=av.allocate();s.modelMatrix=aL(t,h,l)}}else s.modelMatrix=l;if(s.setTransform(1,0,0,1,0,0,!0),t.isContainer){let e=!1,n=!1;if(t.forEachChildren(t=>!(e=t.numberType===sA)),t.forEachChildren(t=>!(n=!!t.findFace)),e){let e=t.getChildren(),n=[...e];n.sort((t,e)=>{var i,r,n,s;let a=((null!==(i=t.attribute.startAngle)&&void 0!==i?i:0)+(null!==(r=t.attribute.endAngle)&&void 0!==r?r:0))/2,o=((null!==(n=e.attribute.startAngle)&&void 0!==n?n:0)+(null!==(s=e.attribute.endAngle)&&void 0!==s?s:0))/2;for(;a<0;)a+=is;for(;o<0;)o+=is;return o-a}),n.forEach(t=>{t._next=null,t._prev=null}),t.removeAllChild(),t.update(),n.forEach(e=>{t.appendChild(e)});let s=t.parent.globalTransMatrix;i.hack_pieFace="outside",r.renderGroup(t,i,s),i.hack_pieFace="inside",r.renderGroup(t,i,s),i.hack_pieFace="top",r.renderGroup(t,i,s),t.removeAllChild(),e.forEach(t=>{t._next=null,t._prev=null}),e.forEach(e=>{t.appendChild(e)})}else if(n){let e=t.getChildren(),n=e.map(t=>({ave_z:t.findFace().vertices.map(e=>{var i;return s.view(e[0],e[1],null!==(i=e[2]+t.attribute.z)&&void 0!==i?i:0)[2]}).reduce((t,e)=>t+e,0),g:t}));n.sort((t,e)=>e.ave_z-t.ave_z),t.removeAllChild(),n.forEach(t=>{t.g._next=null,t.g._prev=null}),t.update(),n.forEach(e=>{t.add(e.g)}),r.renderGroup(t,i,t.parent.globalTransMatrix,!0),t.removeAllChild(),e.forEach(t=>{t._next=null,t._prev=null}),t.update(),e.forEach(e=>{t.add(e)})}else r.renderGroup(t,i,t.parent.globalTransMatrix)}else r.renderItem(t,i);return s.camera=null,s.restore(),s.modelMatrix!==h&&av.free(s.modelMatrix),s.modelMatrix=h,i.in3dInterceptor=!1,!0}initCanvasCtx(t){t.setTransformForCurrent()}}let oh=function(){let t={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i},e="";function i(t){let i=Error(e+": "+t);throw i.source=e,i}function r(){return n("linear",t.linearGradient,s)||n("radial",t.radialGradient,o)||n("conic",t.conicGradient,a)}function n(e,r,n){return function(e,r){let n=v(e);if(n){v(t.startCall)||i("Missing (");let e=r(n);return v(t.endCall)||i("Missing )"),e}}(r,function(r){let s=n();return s&&(v(t.comma)||i("Missing comma before color stops")),{type:e,orientation:s,colorStops:c(p)}})}function s(){return m("directional",t.sideOrCorner,1)||m("angular",t.angleValue,1)}function a(){return m("angular",t.fromAngleValue,1)}function o(){let i,r,n=l();return n&&((i=[]).push(n),r=e,v(t.comma)&&((n=l())?i.push(n):e=r)),i}function l(){let t=function(){let t=m("shape",/^(circle)/i,0);return t&&(t.style=f()||h()),t}()||function(){let t=m("shape",/^(ellipse)/i,0);return t&&(t.style=g()||h()),t}();if(t)t.at=u();else{let e=h();if(e){t=e;let i=u();i&&(t.at=i)}else{let e=d();e&&(t={type:"default-radial",at:e})}}return t}function h(){return m("extent-keyword",t.extentKeywords,1)}function u(){if(m("position",/^at/,0)){let t=d();return t||i("Missing positioning value"),t}}function d(){let t={x:g(),y:g()};if(t.x||t.y)return{type:"position",value:t}}function c(e){let r=e(),n=[];if(r)for(n.push(r);v(t.comma);)(r=e())?n.push(r):i("One extra comma");return n}function p(){let e=m("hex",t.hexColor,1)||m("rgba",t.rgbaColor,1)||m("rgb",t.rgbColor,1)||m("literal",t.literalColor,0);return e||i("Expected color definition"),e.length=g(),e}function g(){return m("%",t.percentageValue,1)||m("position-keyword",t.positionKeywords,1)||f()}function f(){return m("px",t.pixelValue,1)||m("em",t.emValue,1)}function m(t,e,i){let r=v(e);if(r)return{type:t,value:r[i]}}function v(t){let i=/^[\n\r\t\s]+/.exec(e);i&&y(i[0].length);let r=t.exec(e);return r&&y(r[0].length),r}function y(t){e=e.substr(t)}return function(t){return e=t.toString(),function(){let t=c(r);return e.length>0&&i("Invalid input not EOF"),t}()}}();class ou{static IsGradient(t){return!("string"==typeof t&&!t.includes("gradient"))}static IsGradientStr(t){return"string"==typeof t&&t.includes("gradient")}static Parse(t){if(ou.IsGradientStr(t))try{let e=oh(t)[0];if(e){if("linear"===e.type)return ou.ParseLinear(e);if("radial"===e.type)return ou.ParseRadial(e);if("conic"===e.type)return ou.ParseConic(e)}}catch(t){}return t}static ParseConic(t){let{orientation:e,colorStops:i=[]}=t,r=ie/2,n=parseFloat(e.value)/180*ie-r;return{gradient:"conical",x:.5,y:.5,startAngle:n,endAngle:n+is,stops:i.map(t=>({color:t.value,offset:parseFloat(t.length.value)/100}))}}static ParseRadial(t){let{colorStops:e=[]}=t;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:e.map(t=>({color:t.value,offset:parseFloat(t.length.value)/100}))}}static ParseLinear(t){let{orientation:e,colorStops:i=[]}=t,r=ie/2,n="angular"===e.type?parseFloat(e.value)/180*ie:0;for(;n<0;)n+=is;for(;n>is;)n-=is;let s=0,a=0,o=0,l=0;return n<r?(s=0,a=1,o=Math.sin(n),l=Math.cos(n)):n<ie?(s=0,a=0,o=Math.cos(n-r),l=Math.sin(n-r)):n<ie+r?(a=0,o=(s=1)-Math.sin(n-ie),l=Math.cos(n-ie)):(o=(s=1)-Math.cos(n-r-ie),l-=Math.sin(n-r-ie)),{gradient:"linear",x0:s,y0:a,x1:o,y1:l,stops:i.map(t=>({color:t.value,offset:parseFloat(t.length.value)/100}))}}}function od(t,e,i){let r=e,{a:n,b:s,c:a,d:o}=t.currentMatrix,l=Math.sign(n)*Math.sqrt(n*n+s*s),h=Math.sign(o)*Math.sqrt(a*a+o*o);return l+h===0?0:r=r/Math.abs(l+h)*2*i}function oc(t,e,i,r,n){let s,a;if(!e||!0===e)return"black";if(eM(e))for(let t=0;t<e.length&&!(a=e[t]);t++);else a=e;return"string"==typeof(a=ou.Parse(a))?a:("linear"===a.gradient?s=function(t,e,i,r=0,n=0){var s,a,o,l;let h=i.AABBBounds;if(!h)return;let u=h.x2-h.x1,d=h.y2-h.y1,c=h.x1-r,p=h.y1-n;if(i.attribute){let{scaleX:t=1,scaleY:e=1}=i.attribute;if(t*e==0)return;u/=t,d/=e,c/=t,p/=e}let g=t.createLinearGradient(c+(null!==(s=e.x0)&&void 0!==s?s:0)*u,p+(null!==(a=e.y0)&&void 0!==a?a:0)*d,c+(null!==(o=e.x1)&&void 0!==o?o:1)*u,p+(null!==(l=e.y1)&&void 0!==l?l:0)*d);return e.stops.forEach(t=>{g.addColorStop(t.offset,t.color)}),g}(t,a,i,r,n):"conical"===a.gradient?s=function(t,e,i,r=0,n=0){var s,a;let o=i.AABBBounds;if(!o)return;let l=o.x2-o.x1,h=o.y2-o.y1,u=o.x1-r,d=o.y1-n;if(i.attribute){let{scaleX:t=1,scaleY:e=1}=i.attribute;if(t*e==0)return;l/=t,h/=e,u/=t,d/=e}let c=t.createConicGradient(u+(null!==(s=e.x)&&void 0!==s?s:0)*l,d+(null!==(a=e.y)&&void 0!==a?a:0)*h,e.startAngle,e.endAngle);return e.stops.forEach(t=>{c.addColorStop(t.offset,t.color)}),c.GetPattern(l+u,h+d,void 0)}(t,a,i,r,n):"radial"===a.gradient&&(s=function(t,e,i,r=0,n=0){var s,a,o,l,h,u;let d=i.AABBBounds;if(!d)return;let c=d.x2-d.x1,p=d.y2-d.y1,g=d.x1-r,f=d.y1-n;if(i.attribute){let{scaleX:t=1,scaleY:e=1}=i.attribute;if(t*e==0)return;g/=t,f/=e,c/=t,p/=e}let m=t.createRadialGradient(g+(null!==(s=e.x0)&&void 0!==s?s:.5)*c,f+(null!==(a=e.y0)&&void 0!==a?a:.5)*p,Math.max(c,p)*(null!==(o=e.r0)&&void 0!==o?o:0),g+(null!==(l=e.x1)&&void 0!==l?l:.5)*c,f+(null!==(h=e.y1)&&void 0!==h?h:.5)*p,Math.max(c,p)*(null!==(u=e.r1)&&void 0!==u?u:.5));return e.stops.forEach(t=>{m.addColorStop(t.offset,t.color)}),m}(t,a,i,r,n)),s||"orange")}Symbol.for("BoundsAllocate");let op=new class t{constructor(){this.pools=[];for(let t=0;t<10;t++)this.pools.push(new iI)}allocate(t,e,i,r){if(!this.pools.length)return(new iI).setValue(t,e,i,r);let n=this.pools.pop();return n.x1=t,n.y1=e,n.x2=i,n.y2=r,n}allocateByObj(t){if(!this.pools.length)return new iI(t);let e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}};var og=function(t,e){return function(i,r){e(i,r,t)}};let of=class{constructor(t,e){this.contributions=t,this.drawItemInterceptorContributions=e,this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new iB,this.backupDirtyBounds=new iB,this.global=rj.global,this.layerService=rj.layerService,this.init()}init(){this.contributions.forEach(t=>{if(t.style){let e=this.styleRenderMap.get(t.style)||new Map;e.set(t.numberType,t),this.styleRenderMap.set(t.style,e)}else this.defaultRenderMap.set(t.numberType,t)}),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order)}prepareForDraw(t,e){e.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!e.stage.params.optimize.disableCheckGraphicWidthOutRange}draw(t,e){this.prepareForDraw(t,e),e.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(e.renderStyle)||this.defaultRenderMap,this.currentRenderService=t;let{context:i,stage:r,viewBox:n,transMatrix:s}=e;if(!i)return;let a=this.dirtyBounds.setValue(0,0,n.width(),n.height());if(r.dirtyBounds&&!r.dirtyBounds.empty()){let t=a3(a,r.dirtyBounds,!1);a.x1=Math.floor(t.x1),a.y1=Math.floor(t.y1),a.x2=Math.ceil(t.x2),a.y2=Math.ceil(t.y2)}let o=i.dpr%1;(o||.5!==o)&&(a.x1=Math.floor(a.x1*i.dpr)/i.dpr,a.y1=Math.floor(a.y1*i.dpr)/i.dpr,a.x2=Math.ceil(a.x2*i.dpr)/i.dpr,a.y2=Math.ceil(a.y2*i.dpr)/i.dpr),this.backupDirtyBounds.copy(a),i.inuse=!0,i.setClearMatrix(s.a,s.b,s.c,s.d,s.e,s.f),i.clearMatrix(),i.setTransformForCurrent(!0),i.translate(n.x1,n.y1,!0),i.beginPath(),i.rect(a.x1,a.y1,a.width(),a.height()),i.clip(),r.camera&&(this.dirtyBounds.setValue(-Infinity,-Infinity,1/0,1/0),this.backupDirtyBounds.setValue(-Infinity,-Infinity,1/0,1/0)),this.clearScreen(t,i,e),i.save(),t.renderTreeRoots.sort((t,e)=>{var i,r;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:rk.zIndex)-(null!==(r=e.attribute.zIndex)&&void 0!==r?r:rk.zIndex)}).forEach(t=>{t.isContainer?this.renderGroup(t,e,am.allocate(1,0,0,1,0,0)):this.renderItem(t,e)}),i.restore(),i.setClearMatrix(1,0,0,1,0,0),i.inuse=!1,i.draw()}doRegister(){throw Error("\u6682\u4E0D\u652F\u6301")}_findNextGraphic(t){let e=t.parent,i=t._uid;for(;e;){let t=function(t,e,i,r=!1){let n={},s=[],a=!1;t.forEachChildren((t,e)=>{let{zIndex:r=i}=t.attribute;if(0===e);else if(void 0!==r)return a=!0,!0;return!1},r);let o=null,l=!1;if(a){t.forEachChildren(t=>{let{zIndex:e=i}=t.attribute;n[e]?n[e].push(t):(n[e]=[t],s.push(e))},r),s.sort((t,e)=>r?e-t:t-e);let a=!1;for(let t=0;t<s.length&&!a;t++){let i=n[s[t]];for(let t=0;t<i.length;t++){if(l){a=!0,o=i[t];break}i[t]._uid!==e||(l=!0)}}}else t.forEachChildren(t=>l?(o=t,!0):(t._uid===e&&(l=!0),!1),r);return o}(e,i,rk.zIndex);if(t)return t;i=e._uid,e=e.parent}return null}renderGroup(t,e,i,r){if(e.break||!1===t.attribute.visibleAll)return;if(t.incremental&&(null==e.startAtId||e.startAtId===t._uid))return e.break=!0,void this._increaseRender(t,e);if(this.useDirtyBounds&&!a4(t.AABBBounds,this.dirtyBounds,!1))return;let n,s=i;if(this.useDirtyBounds){n=op.allocateByObj(this.dirtyBounds);let e=t.transMatrix;s=am.allocateByObj(i).multiply(e.a,e.b,e.c,e.d,e.e,e.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(s.getInverse())}this.renderItem(t,e,{drawingCb:()=>{var i;r?t.forEachChildren(t=>{e.break||(t.isContainer?this.renderGroup(t,e,s):this.renderItem(t,e))}):aJ(t,rk.zIndex,t=>{e.break||(t.isContainer?this.renderGroup(t,e,s):this.renderItem(t,e))},!1,!!(null===(i=e.context)||void 0===i?void 0:i.camera))}}),this.useDirtyBounds&&(this.dirtyBounds.copy(n),op.free(n),am.free(s))}_increaseRender(t,e){let{layer:i,stage:r}=e,{subLayers:n}=i,s=n.get(t._uid);s||(s={layer:this.layerService.createLayer(r),zIndex:n.size,group:t},n.set(t._uid,s));let a=s.layer.getNativeHandler().getContext(),o=s.drawContribution||r4.get(s0);o.dirtyBounds.setValue(-Infinity,-Infinity,1/0,1/0),o.backupDirtyBounds.setValue(-Infinity,-Infinity,1/0,1/0),o.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:o,clear:"transparent",layer:s.layer,context:a,startAtId:t._uid,break:!1})),s.drawContribution=o;let l=this._findNextGraphic(t);if(l){if(l.isContainer&&l.incremental)this._increaseRender(l,e);else{let t=n.get(l._uid);t||(t={layer:this.layerService.createLayer(r),zIndex:n.size},n.set(l._uid,t));let i=t.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:o,clear:"transparent",layer:t.layer,context:i,startAtId:l._uid,break:!1}))}}}getRenderContribution(t){let e;return e||(e=this.selectRenderByNumberType(t.numberType,t)),e||(e=this.selectRenderByType(t.type)),e}renderItem(t,e,i){if(this.InterceptorContributions.length)for(let r=0;r<this.InterceptorContributions.length;r++){let n=this.InterceptorContributions[r];if(n.beforeDrawItem&&n.beforeDrawItem(t,this.currentRenderService,e,this,i))return}let r=this.getRenderContribution(t);if(!r)return;let n,s=!1;if(t.parent){let{scrollX:e=0,scrollY:i=0}=t.parent.attribute;if(s=!(!e&&!i)){n=this.dirtyBounds.clone();let r=t.globalTransMatrix.getInverse();this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(r),this.dirtyBounds.translate(-e,-i)}}if(this.useDirtyBounds&&!t.isContainer&&!a4(t.AABBBounds,this.dirtyBounds,!1))return void(s&&this.dirtyBounds.copy(n));let a=null!=e.startAtId&&t._uid!==e.startAtId;if(t._uid===e.startAtId&&(e.startAtId=null),i&&(i.skipDraw=a),a?t.isContainer&&r.draw(t,this.currentRenderService,e,i):r.draw(t,this.currentRenderService,e,i),s&&this.dirtyBounds.copy(n),this.InterceptorContributions.length)for(let i=0;i<this.InterceptorContributions.length;i++){let r=this.InterceptorContributions[i];if(r.afterDrawItem&&r.afterDrawItem(t,this.currentRenderService,e,this))return}}selectRenderByType(t){return ex.getInstance().warn("\u672A\u77E5\u9519\u8BEF\uFF0C\u4E0D\u5E94\u8BE5\u8D70\u5230\u8FD9\u91CC"),null}selectRenderByNumberType(t,e){let i;if(e.attribute.renderStyle){let r=this.styleRenderMap.get(e.attribute.renderStyle);i=r&&r.get(t)}return i||this.currentRenderMap.get(t)||this.defaultRenderMap.get(t)}clearScreen(t,e,i){var r,n;let{clear:s,viewBox:a}=i,o=a.width(),l=a.height();if(s){e.clearRect(0,0,o,l);let i=null===(r=t.drawParams)||void 0===r?void 0:r.stage;if(i&&(e.globalAlpha=null!==(n=i.attribute.opacity)&&void 0!==n?n:1),i&&i.backgroundImg&&i.resources){let t=i.resources.get(s);t&&"success"===t.state&&t.data&&e.drawImage(t.data,0,0,o,l)}else e.fillStyle=oc(e,s,{AABBBounds:{x1:0,y1:0,x2:0+o,y2:0+l}},0,0),e.fillRect(0,0,o,l)}}afterDraw(t,e){}};function om(t){return eO(t)?eM(t)?t:[t]:[]}function ov(t){if(eR(t))return t[t.length-1]}of=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),og(0,aq(s4)),og(1,e0(e2)),og(1,e1(oe)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Array,Object])],of);let oy=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let n=1;n<t.length;n++){let s=t[n];(null!==(i=null==e?void 0:e(s,r))&&void 0!==i?i:s-r>0)&&(r=s)}return r},o_=(t,e)=>{var i;if(0===t.length)return;let r=t[0];for(let n=1;n<t.length;n++){let s=t[n];(null!==(i=null==e?void 0:e(s,r))&&void 0!==i?i:s-r<0)&&(r=s)}return r};function ob(t,e){if(!eM(t)||!eM(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function ox(t,e=Math.random){let i,r,n=t.length;for(;n;)i=Math.floor(e()*n),r=t[--n],t[n]=t[i],t[i]=r;return t}function oS(t){if(!eM(t))return[t];let e=[];for(let i of t)e.push(...oS(i));return e}let ok=ie/2;function oA(t,e,i,r,n,s){let a;if(r<0&&(e+=r,r=-r),n<0&&(i+=n,n=-n),ey(s,!0))a=[s=ia(s),s,s,s];else if(Array.isArray(s)){let t,e;let i=s;switch(i.length){case 0:a=[0,0,0,0];break;case 1:a=[t=ia(i[0]),t,t,t];break;case 2:case 3:t=ia(i[0]),a=[t,e=ia(i[1]),t,e];break;default:(a=i)[0]=ia(a[0]),a[1]=ia(a[1]),a[2]=ia(a[2]),a[3]=ia(a[3])}}else a=[0,0,0,0];if(r<0||a[0]+a[1]+a[2]+a[3]<1e-12)return t.rect(e,i,r,n);let[o,l,h,u]=[[e,i],[e+r,i],[e+r,i+n],[e,i+n]],d=Math.min(r/2,n/2),c=[Math.min(d,a[0]),Math.min(d,a[1]),Math.min(d,a[2]),Math.min(d,a[3])],p=[o[0]+c[0],o[1]],g=[o[0],o[1]+c[0]],f=[l[0]-c[1],l[1]],m=[l[0],l[1]+c[1]],v=[h[0]-c[2],h[1]],y=[h[0],h[1]-c[2]],_=[u[0]+c[3],u[1]],b=[u[0],u[1]-c[3]];if(t.moveTo(p[0],p[1]),t.lineTo(f[0],f[1]),!ob(f,m)){let e=f[0],i=f[1]+c[1];t.arc(e,i,c[1],-ok,0,!1)}if(t.lineTo(y[0],y[1]),!ob(v,y)){let e=y[0]-c[2],i=y[1];t.arc(e,i,c[2],0,ok,!1)}if(t.lineTo(_[0],_[1]),!ob(_,b)){let e=_[0],i=_[1]-c[3];t.arc(e,i,c[3],ok,ie,!1)}if(t.lineTo(g[0],g[1]),!ob(p,g)){let e=p[0],i=p[1]+c[0];t.arc(e,i,c[0],ie,ie+ok,!1)}return t.closePath(),t}function ow(t,e){return!(!t&&!e)}function oM(t,e){return(eM(t)?t.some(t=>t||void 0===t):!!t)&&e>0}function oC(t,e,i){return i&&t*e>0}function oT(t,e,i,r,n){return n&&t*e>0&&0!==i&&0!==r}function oE(t,e){return t*e>0}function oO(t,e,i,r){return t*e>0&&0!==i&&0!==r}function oP(t,e,i,r,n,s,a,o){let l=i-t,h=r-e,u=a-n,d=o-s,c=d*l-u*h;return c*c<1e-12?[]:(c=(u*(e-s)-d*(t-n))/c,[t+c*l,e+c*h])}function oR(t,e,i,r,n,s,a){let o=t-i,l=e-r,h=(a?s:-s)/Math.sqrt(o*o+l*l),u=h*l,d=-h*o,c=t+u,p=e+d,g=i+u,f=r+d,m=(c+g)/2,v=(p+f)/2,y=g-c,_=f-p,b=y*y+_*_,x=n-s,S=c*f-g*p,k=(_<0?-1:1)*Math.sqrt(Math.max(0,x*x*b-S*S)),A=(S*_-y*k)/b,w=(-S*y-_*k)/b,M=(S*_+y*k)/b,C=(-S*y+_*k)/b,T=A-m,E=w-v,O=M-m,P=C-v;return T*T+E*E>O*O+P*P&&(A=M,w=C),{cx:A,cy:w,x01:-u,y01:-d,x11:A*(n/x-1),y11:w*(n/x-1)}}function oB(t,e,i,r,n,s,a){let{startAngle:o,endAngle:l}=t.getParsedAngle(),h=ia(l-o),u=l>o,d=!1;if(n<s){let t=n;n=s,s=t}if(n<=1e-12)e.moveTo(i,r);else if(h>=is-1e-12)e.moveTo(i+n*il(o),r+n*id(o)),e.arc(i,r,n,o,l,!u),s>1e-12&&(e.moveTo(i+s*il(l),r+s*id(l)),e.arc(i,r,s,l,o,u));else{let c,p,g,f;let m=t.getParsedCornerRadius(),v=eM(m),{outerDeltaAngle:y,innerDeltaAngle:_,outerStartAngle:b,outerEndAngle:x,innerEndAngle:S,innerStartAngle:k}=t.getParsePadAngle(o,l),A=v?m[0]:m,w=v?m[1]:m,M=v?m[2]:m,C=v?m[3]:m,T=Math.max(w,A),E=Math.max(M,C),O=T,P=E,R=n*il(b),B=n*id(b),I=s*il(S),L=s*id(S);if((E>1e-12||T>1e-12)&&(c=n*il(x),p=n*id(x),g=s*il(k),f=s*id(k),h<ie)){let t=oP(R,B,g,f,c,p,I,L);if(t){let e=R-t[0],i=B-t[1],r=c-t[0],a=p-t[1],o=1/id(ig((e*r+i*a)/(ic(e*e+i*i)*ic(r*r+a*a)))/2),l=ic(t[0]*t[0]+t[1]*t[1]);P=iu(E,(s-l)/(o-1)),O=iu(T,(n-l)/(o+1))}}if(y<.001)a&&(a[3]||a[1])&&e.moveTo(i+R,r+B),d=!0;else if(O>1e-12){let t=iu(A,O),s=iu(w,O),o=oR(g,f,R,B,n,t,Number(u)),l=oR(c,p,I,L,n,s,Number(u));O<T&&t===s?!a||a[0]?(e.moveTo(i+o.cx+o.x01,r+o.cy+o.y01),e.arc(i+o.cx,r+o.cy,O,io(o.y01,o.x01),io(l.y01,l.x01),!u)):e.moveTo(i+o.cx+O*il(io(l.y01,l.x01)),r+o.cy+O*id(io(l.y01,l.x01))):!a||a[0]?(e.moveTo(i+o.cx+o.x01,r+o.cy+o.y01),t>0&&e.arc(i+o.cx,r+o.cy,t,io(o.y01,o.x01),io(o.y11,o.x11),!u),e.arc(i,r,n,io(o.cy+o.y11,o.cx+o.x11),io(l.cy+l.y11,l.cx+l.x11),!u),s>0&&e.arc(i+l.cx,r+l.cy,s,io(l.y11,l.x11),io(l.y01,l.x01),!u)):s>0?e.moveTo(i+l.cx+s*il(io(l.y01,l.x01)),r+l.cy+s*id(io(l.y01,l.x01))):e.moveTo(i+c,r+n*id(x))}else!a||a[0]?(e.moveTo(i+R,r+B),e.arc(i,r,n,b,x,!u)):e.moveTo(i+n*il(x),r+n*id(x));if(!(s>1e-12)||_<.001)!a||a[1]?e.lineTo(i+I,r+L):e.moveTo(i+I,r+L),d=!0;else if(P>1e-12){let t=iu(C,P),n=iu(M,P),o=oR(I,L,c,p,s,-n,Number(u)),l=oR(R,B,g,f,s,-t,Number(u));if(!a||a[1]?e.lineTo(i+o.cx+o.x01,r+o.cy+o.y01):e.moveTo(i+o.cx+o.x01,r+o.cy+o.y01),P<E&&t===n){let t=io(l.y01,l.x01);!a||a[2]?e.arc(i+o.cx,r+o.cy,P,io(o.y01,o.x01),t,!u):e.moveTo(i+o.cx+il(t),r+o.cy+id(t))}else!a||a[2]?(n>0&&e.arc(i+o.cx,r+o.cy,n,io(o.y01,o.x01),io(o.y11,o.x11),!u),e.arc(i,r,s,io(o.cy+o.y11,o.cx+o.x11),io(l.cy+l.y11,l.cx+l.x11),u),t>0&&e.arc(i+l.cx,r+l.cy,t,io(l.y11,l.x11),io(l.y01,l.x01),!u)):t>0?e.moveTo(i+l.cx+t*il(io(l.y01,l.x01)),r+l.cy+t*id(io(l.y01,l.x01))):e.moveTo(i+g,r+f)}else!a||a[1]?e.lineTo(i+I,r+L):e.moveTo(i+I,r+L),!a||a[2]?e.arc(i,r,s,S,k,u):e.moveTo(i+s*il(k),r+s*id(k))}return a?a[3]&&e.lineTo(i+n*il(o),r+n*id(o)):e.closePath(),d}let oI=Symbol.for("ArcRenderContribution"),oL=Symbol.for("AreaRenderContribution"),oD=Symbol.for("CircleRenderContribution"),oF=Symbol.for("GroupRenderContribution"),oj=Symbol.for("ImageRenderContribution"),oN=Symbol.for("PathRenderContribution"),oz=Symbol.for("PolygonRenderContribution"),oH=Symbol.for("RectRenderContribution"),oV=Symbol.for("SymbolRenderContribution"),oW=Symbol.for("TextRenderContribution");Symbol.for("CommonRenderContribution");let oG=Symbol.for("InteractiveSubRenderContribution");var oU=function(t,e){return function(i,r){e(i,r,t)}};class o${constructor(){this.time=lP.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,a,o,l,h,u,d,c){var p;let{background:g,backgroundOpacity:f=null!==(p=t.attribute.fillOpacity)&&void 0!==p?p:l.backgroundOpacity,opacity:m=l.opacity,backgroundMode:v=l.backgroundMode,backgroundFit:y=l.backgroundFit}=t.attribute;if(g){if(t.backgroundImg&&t.resources){let n=t.resources.get(g);if("success"!==n.state||!n.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){let i=nf(t.parent).group,{scrollX:r=i.scrollX,scrollY:n=i.scrollY}=t.parent.attribute;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(r,n)}e.clip();let s=t.AABBBounds;e.setCommonStyle(t,t.attribute,i,r,l),e.globalAlpha=f*m,this.doDrawImage(e,n.data,s,v,y),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,r,l),e.globalAlpha=f*m,e.fillStyle=g,e.fill(),e.highPerformanceRestore()}}doDrawImage(t,e,i,r,n){if("no-repeat"===r)t.drawImage(e,i.x1,i.y1,i.width(),i.height());else{let s=i.width(),a=i.height(),o=s,l=a;if(n&&"repeat"!==r&&(e.width||e.height)){let i=e.width,n=e.height;"repeat-x"===r?(o=a/n*i,l=a):"repeat-y"===r&&(l=s/i*n,o=s);let h=t.dpr,u=r7.allocate({width:o,height:l,dpr:h}),d=u.getContext("2d");d&&(d.inuse=!0,d.clearMatrix(),d.setTransformForCurrent(!0),d.clearRect(0,0,o,l),d.drawImage(e,0,0,o,l),e=u.nativeCanvas),r7.free(u)}let h=t.dpr,u=t.createPattern(e,r);u.setTransform&&u.setTransform(new DOMMatrix([1/h,0,0,1/h,0,0])),t.fillStyle=u,t.translate(i.x1,i.y1),t.fillRect(0,0,s,a),t.translate(-i.x1,-i.y1)}}}let oY=new o$,oK=class{constructor(t){this.subRenderContribitions=t,this.time=lP.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,a,o,l,h,u,d,c){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach(p=>{p.render(t,e,i,r,n,s,a,o,l,h,u,d,c)})}};oK=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),oU(0,e0(e2)),oU(0,e1(oG)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],oK);let oZ=new class t extends o${constructor(){super(...arguments),this.time=lP.beforeFillStroke}drawShape(t,e,i,r,n,s,a,o,l,h,u,d){let{background:c,backgroundMode:p=l.backgroundMode,backgroundFit:g=l.backgroundFit}=t.attribute;if(c){if(t.backgroundImg&&t.resources){let i=t.resources.get(c);if("success"!==i.state||!i.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);let r=t.AABBBounds;this.doDrawImage(e,i.data,r,p,g),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=c,e.fill(),e.highPerformanceRestore()}}};var oX=function(t,e){return function(i,r){e(i,r,t)}};let oq=class{constructor(t){this.groupRenderContribitions=t,this.numberType=sT}drawShape(t,e,i,r,n,s,a,o){var l,h;let u=nf(t,null==s?void 0:s.theme).group,{fill:d=u.fill,background:c,stroke:p=u.stroke,opacity:g=u.opacity,width:f=u.width,height:m=u.height,clip:v=u.clip,fillOpacity:y=u.fillOpacity,strokeOpacity:_=u.strokeOpacity,cornerRadius:b=u.cornerRadius,path:x=u.path,lineWidth:S=u.lineWidth,visible:k=u.visible}=t.attribute,A=oT(g,y,f,m,d),w=oO(g,_,f,m),M=(l=d,h=c,!(!l&&!h)),C=oM(p,S);if(!t.valid||!k||!v&&(!M&&!C||!(A||w||a||o||c)))return;if(x&&x.length&&n.drawContribution){let t=e.disableFill,i=e.disableStroke,r=e.disableBeginPath;e.disableFill=!0,e.disableStroke=!0,e.disableBeginPath=!0,x.forEach(t=>{n.drawContribution.getRenderContribution(t).draw(t,n.renderService,n,s)}),e.disableFill=t,e.disableStroke=i,e.disableBeginPath=r}else 0===b||eM(b)&&b.every(t=>0===t)?(e.beginPath(),e.rect(i,r,f,m)):(e.beginPath(),oA(e,i,r,f,m,b));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(oZ));let T={doFill:M,doStroke:C};this._groupRenderContribitions.forEach(s=>{s.time===lP.beforeFillStroke&&s.drawShape(t,e,i,r,M,C,A,w,u,n,a,o,T)}),v&&e.clip(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,u),T.doFill&&(a?a(e,t.attribute,u):A&&(e.setCommonStyle(t,t.attribute,i,r,u),e.fill())),T.doStroke&&(o?o(e,t.attribute,u):w&&(e.setStrokeStyle(t,t.attribute,i,r,u),e.stroke())),this._groupRenderContribitions.forEach(s=>{s.time===lP.afterFillStroke&&s.drawShape(t,e,i,r,M,C,A,w,u,n,a,o)})}draw(t,e,i,r){let n;let{context:s}=i;if(!s)return;let{clip:a,baseOpacity:o=1}=t.attribute;a?s.save():s.highPerformanceSave(),s.baseGlobalAlpha*=o;let l=nf(t,null==r?void 0:r.theme).group,h=s.modelMatrix;if(s.camera){let e=av.allocate(),i=av.allocate();aD(i,t,l),aL(e,h||e,i),s.modelMatrix=e,av.free(i),s.setTransform(1,0,0,1,0,0,!0)}else s.transformFromMatrix(t.transMatrix,!0);s.beginPath(),r.skipDraw?this.drawShape(t,s,0,0,i,r,()=>!1,()=>!1):this.drawShape(t,s,0,0,i);let{scrollX:u=l.scrollX,scrollY:d=l.scrollY}=t.attribute;(u||d)&&s.translate(u,d),r&&r.drawingCb&&(n=r.drawingCb()),s.modelMatrix!==h&&av.free(s.modelMatrix),s.modelMatrix=h,s.baseGlobalAlpha/=o,n&&n.then?n.then(()=>{a?s.restore():s.highPerformanceRestore()}):a?s.restore():s.highPerformanceRestore()}};oq=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),oX(0,e0(e2)),oX(0,e1(oF)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],oq);let oJ={x:0,y:0,z:0,lastModelMatrix:null};class oQ{init(t){t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions&&this.builtinContributions.forEach(t=>this._renderContribitions.push(t)),this._renderContribitions.length&&(this._renderContribitions.sort((t,e)=>e.order-t.order),this._beforeRenderContribitions=this._renderContribitions.filter(t=>t.time===lP.beforeFillStroke),this._afterRenderContribitions=this._renderContribitions.filter(t=>t.time===lP.afterFillStroke))}beforeRenderStep(t,e,i,r,n,s,a,o,l,h,u,d,c){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach(p=>{if(!p.supportedAppName||!t.stage||!t.stage.params||!t.stage.params.context||!t.stage.params.context.appName||!!(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName))p.drawShape(t,e,i,r,n,s,a,o,l,h,u,d,c)})}afterRenderStep(t,e,i,r,n,s,a,o,l,h,u,d,c){this._afterRenderContribitions&&this._afterRenderContribitions.forEach(p=>{if(!p.supportedAppName||!t.stage||!t.stage.params||!t.stage.params.context||!t.stage.params.context.appName||!!(Array.isArray(p.supportedAppName)?p.supportedAppName:[p.supportedAppName]).includes(t.stage.params.context.appName))p.drawShape(t,e,i,r,n,s,a,o,l,h,u,d,c)})}valid(t,e,i,r){var n,s,a,o;let{fill:l=e.fill,background:h,stroke:u=e.stroke,opacity:d=e.opacity,fillOpacity:c=e.fillOpacity,lineWidth:p=e.lineWidth,strokeOpacity:g=e.strokeOpacity,visible:f=e.visible}=t.attribute,m=(n=d,s=c,l&&n*s>0),v=d*g>0,y=(a=l,o=h,!(!a&&!o)),_=oM(u,p);return!(!t.valid||!f)&&!(!y&&!_)&&!!(m||v||i||r||h)&&{fVisible:m,sVisible:v,doFill:y,doStroke:_}}transform(t,e,i,r=!1){let{x:n=e.x,y:s=e.y,z:a=e.z,scaleX:o=e.scaleX,scaleY:l=e.scaleY,angle:h=e.angle,postMatrix:u}=t.attribute,d=i.modelMatrix,c=i.camera;oJ.x=n,oJ.y=s,oJ.z=a,oJ.lastModelMatrix=d;let p=c&&(r||function(t){let{alpha:e,beta:i}=t.attribute;return e||i}(t)),g=p?t.transMatrix.onlyTranslate()&&!u:1===o&&1===l&&0===h&&!u;if(p){let r=av.allocate(),n=av.allocate();aD(n,t,e),aL(r,d||r,n),oJ.x=0,oJ.y=0,oJ.z=0,i.modelMatrix=r,i.setTransform(1,0,0,1,0,0,!0),av.free(n)}if(g&&!d){let r=t.getOffsetXY(e);oJ.x+=r.x,oJ.y+=r.y,oJ.z=a,i.setTransformForCurrent()}else if(p)oJ.x=0,oJ.y=0,oJ.z=0,i.setTransform(1,0,0,1,0,0,!0);else if(c&&i.project){let r=t.getOffsetXY(e);oJ.x+=r.x,oJ.y+=r.y,this.transformWithoutTranslate(i,oJ.x,oJ.y,oJ.z,o,l,h)}else i.transformFromMatrix(t.transMatrix,!0),oJ.x=0,oJ.y=0,oJ.z=0;return oJ}transformUseContext2d(t,e,i,r){let n=r.camera;if(this.camera=n,n){let e=t.AABBBounds,n=e.x2-e.x1,s=e.y2-e.y1,a=r.project(0,0,i),o=r.project(n,0,i),l=r.project(n,s,i),h={x:0,y:0},u={x:n,y:0},d={x:n,y:s};r.camera=null;let c=1/(h.x*(d.y-u.y)-u.x*d.y+d.x*u.y+(u.x-d.x)*h.y),p=-(h.y*(l.x-o.x)-u.y*l.x+d.y*o.x+(u.y-d.y)*a.x)*c,g=(u.y*l.y+h.y*(o.y-l.y)-d.y*o.y+(d.y-u.y)*a.y)*c,f=(h.x*(l.x-o.x)-u.x*l.x+d.x*o.x+(u.x-d.x)*a.x)*c,m=-(u.x*l.y+h.x*(o.y-l.y)-d.x*o.y+(d.x-u.x)*a.y)*c,v=(h.x*(d.y*o.x-u.y*l.x)+h.y*(u.x*l.x-d.x*o.x)+(d.x*u.y-u.x*d.y)*a.x)*c,y=(h.x*(d.y*o.y-u.y*l.y)+h.y*(u.x*l.y-d.x*o.y)+(d.x*u.y-u.x*d.y)*a.y)*c;r.setTransform(p,g,f,m,v,y,!0)}}restoreTransformUseContext2d(t,e,i,r){this.camera&&(r.camera=this.camera)}transformWithoutTranslate(t,e,i,r,n,s,a){let o=t.project(e,i,r);t.translate(o.x,o.y,!1),t.scale(n,s,!1),t.rotate(a,!1),t.translate(-o.x,-o.y,!1),t.setTransformForCurrent()}_draw(t,e,i,r,n){let{context:s}=r;if(!s)return;let{renderable:a}=t.attribute;if(!1===a)return;s.highPerformanceSave();let{x:o,y:l,z:h,lastModelMatrix:u}=this.transform(t,e,s,i);this.z=h,function(t,e,i,r,n,s,a,o){var l,h,u;if(!t.pathProxy)return!1;let d=nf(t,null==s?void 0:s.theme)[t.type.replace("3d","")],{fill:c=d.fill,stroke:p=d.stroke,opacity:g=d.opacity,fillOpacity:f=d.fillOpacity,lineWidth:m=d.lineWidth,strokeOpacity:v=d.strokeOpacity,visible:y=d.visible,x:_=d.x,y:b=d.y}=t.attribute,x=(l=g,h=f,c&&l*h>0),S=g*v>0,k=!!c,A=oM(p,m);return!y||!k&&!A||!x&&!S&&!!1||(e.beginPath(),iV(("function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy).commandList,e,i,r),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),A&&(o?o(e,t.attribute,d):S&&(e.setStrokeStyle(t,t.attribute,i-_,r-b,d),e.stroke())),k&&(a?a(e,t.attribute,d):x&&(e.setCommonStyle(t,t.attribute,i-_,r-b,d),e.fill())),!0)}(t,s,o,l,0,n)||(this.drawShape(t,s,o,l,r,n),this.z=0,s.modelMatrix!==u&&av.free(s.modelMatrix),s.modelMatrix=u),s.highPerformanceRestore()}}function o0(t,e,i,r){if(!e.p1)return;let{offsetX:n=0,offsetY:s=0,offsetZ:a=0}=r||{};if(1===i)e.p2&&e.p3?t.bezierCurveTo(n+e.p1.x,s+e.p1.y,n+e.p2.x,s+e.p2.y,n+e.p3.x,s+e.p3.y,a):t.lineTo(n+e.p1.x,s+e.p1.y,a);else if(e.p2&&e.p3){let[r]=iK(e,i);t.bezierCurveTo(n+r.p1.x,s+r.p1.y,n+r.p2.x,s+r.p2.y,n+r.p3.x,s+r.p3.y,a)}else{let r=e.getPointAt(i);t.lineTo(n+r.x,s+r.y,a)}}function o1(t,e,i,r,n){var s;let a;let{offsetX:o=0,offsetY:l=0,offsetZ:h=0,mode:u="none",drawConnect:d=!1,zeroX:c=0,zeroY:p=0}=n||{};if(d&&"none"===u||!e)return;let g=!0,{curves:f}=e;if(i>=1){if(d){let e,i=!0;f.forEach((r,n)=>{var s;let a=r.p0;if(r.originP1!==r.originP2){if(e&&e.originP1===e.originP2&&(a=e.p0),r.defined)i||(t.lineTo(a.x+o,a.y+l,h),i=!i);else{let e;let{originP1:n,originP2:u}=r;if(n&&!1!==n.defined?e=a:n&&!1!==u.defined&&(e=null!==(s=r.p3)&&void 0!==s?s:r.p1),i){i=!i;let n=e?e.x:r.p0.x,s=e?e.y:r.p0.y;t.moveTo(n+o,s+l,h)}else e&&(i=!i,t.lineTo(e.x+o,e.y+l,h))}e=r}else e=r})}else f.forEach(e=>{e.defined?(g&&t.moveTo(e.p0.x+o,e.p0.y+l,h),o0(t,e,1,n),g=!1):g=!0});return}if(i<=0)return;"x"===r?a=lE.ROW:"y"===r?a=lE.COLUMN:"auto"===r&&(a=e.direction);let m=i*e.tryUpdateLength(a),v=0,y=!0,_=null;for(let e=0,i=f.length;e<i;e++){let i=f[e],r=i.getLength(a),u=(m-v)/r;if(v+=r,u<0)break;if(d){let e=i.p0;if(i.originP1===i.originP2){_=i;continue}if(_&&_.originP1===_.originP2&&(e=_.p0),i.defined)y||(t.lineTo(e.x+o,e.y+l,h),y=!y);else{let r;let{originP1:n,originP2:a}=i;if(n&&!1!==n.defined?r=e:n&&!1!==a.defined&&(r=null!==(s=i.p3)&&void 0!==s?s:i.p1),y){y=!y;let e=r?r.x:i.p0.x,n=r?r.y:i.p0.y;t.moveTo(e+o,n+l,h)}else r&&(y=!y,t.lineTo(r.x+o,r.y+l,h))}_=i}else{if(!i.defined){g=!0;continue}g&&t.moveTo(i.p0.x+o,i.p0.y+l,h),o0(t,i,iu(u,1),n),g=!1}}}let o2=class extends oQ{constructor(){super(...arguments),this.numberType=sO}draw(t,e,i,r){let n=nf(t,null==r?void 0:r.theme).line;this._draw(t,n,!1,i,r)}drawSegmentItem(t,e,i,r,n,s,a,o,l,h,u,d,c,p,g){var f,m,v,y,_;if(!e)return;t.beginPath();let b=null!==(f=this.z)&&void 0!==f?f:0;o1(t.camera?t:t.nativeContext,e,l,h,{offsetX:u,offsetY:d,offsetZ:b}),c.cache&&!eM(c.cache)&&c.cache.curves.every(t=>t.defined)&&c.attribute.curveType&&c.attribute.curveType.includes("Closed")&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(c,a,o);let{x:x=0,x:S=0}=a;!1!==i&&(p?p(t,a,o):n&&(t.setCommonStyle(c,a,x-u,S-d,o),t.fill())),!1!==r&&(g?g(t,a,o):s&&(t.setStrokeStyle(c,a,x-u,S-d,o),t.stroke()));let{connectedType:k,connectedX:A,connectedY:w,connectedStyle:M}=a;if(eM(o)?(k=null!==(m=null!=k?k:o[0].connectedType)&&void 0!==m?m:o[1].connectedType,A=null!==(v=null!=A?A:o[0].connectedX)&&void 0!==v?v:o[1].connectedX,w=null!==(y=null!=w?w:o[0].connectedY)&&void 0!==y?y:o[1].connectedY,M=null!==(_=null!=M?M:o[0].connectedStyle)&&void 0!==_?_:o[1].connectedStyle):(k=null!=k?k:o.connectedType,A=null!=A?A:o.connectedX,w=null!=w?w:o.connectedY,M=null!=M?M:o.connectedStyle),"connect"!==k&&"zero"!==k&&(k="none"),"none"!==k){t.beginPath(),o1(t.camera?t:t.nativeContext,e,l,h,{offsetX:u,offsetY:d,offsetZ:b,drawConnect:!0,mode:k,zeroX:A,zeroY:w});let f=[];eM(o)?o.forEach(t=>f.push(t)):f.push(o),f.push(a),!1!==i&&(p?p(t,a,o):n&&(t.setCommonStyle(c,M,x-u,S-d,f),t.fill())),!1!==r&&(g?g(t,a,o):s&&(t.setStrokeStyle(c,M,x-u,S-d,f),t.stroke()))}return!1}drawLinearLineHighPerformance(t,e,i,r,n,s,a,o,l,h,u,d,c){var p;e.beginPath();let g=null!==(p=this.z)&&void 0!==p?p:0,{points:f}=t.attribute,m=f[0];e.moveTo(m.x+a,m.y+o,g);for(let t=1;t<f.length;t++){let i=f[t];e.lineTo(i.x+a,i.y+o,g)}e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l);let{x:v=0,x:y=0}=t.attribute;!1!==i&&(d?d(e,t.attribute,l):n&&(e.setCommonStyle(t,t.attribute,v-a,y-o,l),e.fill())),!1!==r&&(c?c(e,t.attribute,l):s&&(e.setStrokeStyle(t,t.attribute,v-a,y-o,l),e.stroke()))}drawShape(t,e,i,r,n,s,a,o){let l=nf(t,null==s?void 0:s.theme).line,{fill:h=l.fill,stroke:u=l.stroke,fillOpacity:d=l.fillOpacity,strokeOpacity:c=l.strokeOpacity,segments:p,points:g,closePath:f,curveTension:m=l.curveTension}=t.attribute;if(!this.valid(t,l,a,o))return;let{curveType:v=l.curveType}=t.attribute;f&&"linear"===v&&(v="linearClosed");let{clipRange:y=l.clipRange,clipRangeByDimension:_=l.clipRangeByDimension}=t.attribute;if(1===y&&!p&&!g.some(t=>!1===t.defined)&&"linear"===v)return this.drawLinearLineHighPerformance(t,e,!!h,!!u,d,c,i,r,l,n,s,a,o);if(t.shouldUpdateShape()){let{points:e,segments:i}=t.attribute;if(i&&i.length){let e,r;if(t.cache=i.map((t,i)=>{if(t.points.length<=1&&0===i)return t.points[0]&&(r={endX:t.points[0].x,endY:t.points[0].y,curves:[{defined:!1!==t.points[0].defined}]}),null;1===i?e={x:r.endX,y:r.endY,defined:r.curves[r.curves.length-1].defined}:i>1&&(e.x=r.endX,e.y=r.endY,e.defined=r.curves[r.curves.length-1].defined);let n=rp(t.points,v,{startPoint:e,curveTension:m});return r=n,n}).filter(t=>!!t),"linearClosed"===v){let e;for(let i=0;i<t.cache.length;i++){let r=t.cache[i];for(let t=0;t<r.curves.length;t++)if(r.curves[t].defined){e=r.curves[t].p0;break}if(e)break}t.cache[t.cache.length-1]&&t.cache[t.cache.length-1].lineTo(e.x,e.y,!0)}}else{if(!e||!e.length)return t.cache=null,void t.clearUpdateShapeTag();t.cache=rp(e,v,{curveTension:m})}t.clearUpdateShapeTag()}if(Array.isArray(t.cache)){let n=t.attribute.segments.filter(t=>t.points.length);if(1===n[0].points.length&&n.shift(),1===y){let s=!1;t.cache.forEach((p,g)=>{s||(s=this.drawSegmentItem(e,p,!!h,!!u,d,c,n[g],[l,t.attribute],y,_,i,r,t,a,o))})}else{let s=y*t.cache.reduce((t,e)=>t+e.getLength(),0),p=0,g=!1;t.cache.forEach((f,m)=>{if(g)return;let v=f.getLength(),y=(s-p)/v;p+=v,y>0&&(g=this.drawSegmentItem(e,f,!!h,!!u,d,c,n[m],[l,t.attribute],iu(y,1),_,i,r,t,a,o))})}}else this.drawSegmentItem(e,t.cache,!!h,!!u,d,c,t.attribute,l,y,_,i,r,t,a,o)}};o2=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],o2);let o3=class extends o2{constructor(){super(...arguments),this.numberType=sO}drawShape(t,e,i,r,n,s,a,o){if(t.incremental&&n.multiGraphicOptions){var l,h,u;let{startAtIdx:e,length:s}=n.multiGraphicOptions,{segments:d=[]}=t.attribute;if(e>d.length)return;let c=nf(t).line,{fill:p=c.fill,stroke:g=c.stroke,opacity:f=c.opacity,fillOpacity:m=c.fillOpacity,strokeOpacity:v=c.strokeOpacity,lineWidth:y=c.lineWidth,visible:_=c.visible}=t.attribute,b=(l=f,h=m,p&&l*h>0),x=f*v>0,S=!!p,k=oM(g,y);if(!t.valid||!_||!S&&!k||!(b||x||a||o))return;let{context:A}=n;for(let n=e;n<e+s;n++)this.drawIncreaseSegment(t,A,d[n-1],d[n],t.attribute.segments[n],[c,t.attribute],i,r)}else super.drawShape(t,e,i,r,n,s,a,o)}drawIncreaseSegment(t,e,i,r,n,s,a,o){r&&(e.beginPath(),function(t,e,i,r){let{offsetX:n=0,offsetY:s=0}=r||{},a=e?e.points[e.points.length-1]:i.points[0];t.moveTo(a.x+n,a.y+s),i.points.forEach(e=>{!1!==e.defined?t.lineTo(e.x+n,e.y+s):t.moveTo(e.x+n,e.y+s)})}(e.nativeContext,i,r,{offsetX:a,offsetY:o}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,n,s),e.setStrokeStyle(t,n,a,o,s),e.stroke())}};o3=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],o3);function o5(t,e,i,r){if(e.length<2)return;let{offsetX:n=0,offsetY:s=0,offsetZ:a=0,mode:o}=r||{},l=e[0];t.moveTo(l.p0.x+n,l.p0.y+s,a);let h=(l=e[e.length-1]).p3||l.p1;t.lineTo(h.x+n,h.y+s,a),l=i[i.length-1],t.lineTo(l.p0.x+n,l.p0.y+s,a),h=(l=i[0]).p3||l.p1,t.lineTo(h.x+n,h.y+s,a),t.closePath()}function o4(t,e,i,r){let{offsetX:n=0,offsetY:s=0,offsetZ:a=0}=r||{},o=!0;e.forEach(e=>{e.defined?(o&&t.moveTo(e.p0.x+n,e.p0.y+s,a),o0(t,e,1,r),o=!1):o=!0}),o=!0;for(let e=i.length-1;e>=0;e--){let l=i[e];l.defined?(o&&t.lineTo(l.p0.x+n,l.p0.y+s,a),o0(t,l,1,r),o=!1):o=!0}t.closePath()}class o8{constructor(){this.time=lP.afterFillStroke,this.useStyle=!0,this.order=10}createCommonPattern(t,e,i,r,n){let s=(t-2*e)/2,a=r.dpr,o=r7.allocate({width:t,height:t,dpr:a}),l=o.getContext("2d");if(!l)return null;l.inuse=!0,l.clearMatrix(),l.setTransformForCurrent(!0),l.clearRect(0,0,t,t),n(s,l);let h=r.createPattern(o.nativeCanvas,"repeat");return h.setTransform&&h.setTransform(new DOMMatrix([1/a,0,0,1/a,0,0])),r7.free(o),h}createCirclePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,e)=>{e.fillStyle=i,e.arc(t,t,t,0,is),e.fill()})}createDiamondPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{let n=t/2;r.fillStyle=i,r.moveTo(n,n-e),r.lineTo(e+n,n),r.lineTo(n,n+e),r.lineTo(n-e,n),r.closePath(),r.fill()})}createRectPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,r)=>{r.fillStyle=i,r.fillRect(e,e,2*t,2*t)})}createVerticalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(r,n)=>{n.fillStyle=i,n.fillRect(e,0,2*r,t)})}createHorizontalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(r,n)=>{n.fillStyle=i,n.fillRect(0,e,t,2*r)})}createBiasLRLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{r.strokeStyle=i,r.lineWidth=e,r.moveTo(0,0),r.lineTo(t,t);let n=t/2,s=-n;r.moveTo(n,s),r.lineTo(n+t,s+t),r.moveTo(-n,-s),r.lineTo(-n+t,-s+t),r.stroke()})}createBiasRLLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(e,r)=>{r.strokeStyle=i,r.lineWidth=e,r.moveTo(t,0),r.lineTo(0,t);let n=t/2;r.moveTo(t+n,n),r.lineTo(n,n+t),r.moveTo(t-n,-n),r.lineTo(-n,-n+t),r.stroke()})}createGridPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(t,r)=>{r.fillStyle=i,r.fillRect(e,e,t,t),r.fillRect(e+t,e+t,t,t)})}initTextureMap(t,e){this.textureMap=new Map}drawShape(t,e,i,r,n,s,a,o,l,h,u,d,c){this.textureMap||this.initTextureMap(e,t.stage);let{texture:p=l.texture,textureColor:g=l.textureColor,textureSize:f=l.textureSize,texturePadding:m=l.texturePadding}=t.attribute;p&&this.drawTexture(p,t,e,i,r,l,g,f,m)}drawTexture(t,e,i,r,n,s,a,o,l){let h=this.textureMap.get(t);if(!h)switch(t){case"circle":h=this.createCirclePattern(o,l,a,i);break;case"diamond":h=this.createDiamondPattern(o,l,a,i);break;case"rect":h=this.createRectPattern(o,l,a,i);break;case"vertical-line":h=this.createVerticalLinePattern(o,l,a,i);break;case"horizontal-line":h=this.createHorizontalLinePattern(o,l,a,i);break;case"bias-lr":h=this.createBiasLRLinePattern(o,l,a,i);break;case"bias-rl":h=this.createBiasRLLinePattern(o,l,a,i);break;case"grid":h=this.createGridPattern(o,l,a,i)}h&&(i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,r,n,s),i.fillStyle=h,i.fill(),i.highPerformanceRestore())}}let o6=new o8,o9=new class t extends o8{constructor(){super(...arguments),this.time=lP.afterFillStroke}drawShape(t,e,i,r,n,s,a,o,l,h,u,d,c){var p,g,f,m;this.textureMap||this.initTextureMap(e,t.stage);let{attribute:v=t.attribute}=c||{},{texture:y=null!==(p=t.attribute.texture)&&void 0!==p?p:sp(l,"texture"),textureColor:_=null!==(g=t.attribute.textureColor)&&void 0!==g?g:sp(l,"textureColor"),textureSize:b=null!==(f=t.attribute.textureSize)&&void 0!==f?f:sp(l,"textureSize"),texturePadding:x=null!==(m=t.attribute.texturePadding)&&void 0!==m?m:sp(l,"texturePadding")}=v;y&&this.drawTexture(y,t,e,i,r,l,_,b,x)}};var o7=function(t,e){return function(i,r){e(i,r,t)}};function lt(t,e,i){var r,n;switch(e){case"linear":default:return i3(t,i);case"basis":return i8(t,i);case"monotoneX":return rr(t,i);case"monotoneY":return rn(t,i);case"step":return ra(t,.5,i);case"stepBefore":return ra(t,0,i);case"stepAfter":return ra(t,1,i);case"catmullRom":return rd(t,null!==(r=null==i?void 0:i.curveTension)&&void 0!==r?r:.5,i);case"catmullRomClosed":return rc(t,null!==(n=null==i?void 0:i.curveTension)&&void 0!==n?n:.5,i);case"linearClosed":return rl(t,i)}}let le=class extends oQ{constructor(t){super(),this.areaRenderContribitions=t,this.numberType=sw,this.builtinContributions=[o9,oY],this.init(t)}drawLinearAreaHighPerformance(t,e,i,r,n,s,a,o,l,h,u,d,c){var p,g,f,m,v;let{points:y}=t.attribute;if(y.length<2)return;e.beginPath();let _=null!==(p=this.z)&&void 0!==p?p:0,b=y[0];e.moveTo(b.x+a,b.y+o,_);for(let t=1;t<y.length;t++){let i=y[t];e.lineTo(i.x+a,i.y+o,_)}for(let t=y.length-1;t>=0;t--){let i=y[t];e.lineTo((null!==(g=i.x1)&&void 0!==g?g:i.x)+a,(null!==(f=i.y1)&&void 0!==f?f:i.y)+o,_)}e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,a,o,!!n,!1,i,!1,l,h,d,null,{attribute:t.attribute});let{x:x=0,x:S=0}=t.attribute;if(!1!==i&&(d?d(e,t.attribute,l):n&&(e.setCommonStyle(t,t.attribute,x-a,S-o,l),e.fill())),this.afterRenderStep(t,e,a,o,!!n,!1,i,!1,l,h,d,null,{attribute:t.attribute}),r){let{stroke:i=l&&l.stroke}=t.attribute;if(eM(i)&&(i[0]||i[2])&&!1===i[1]){if(e.beginPath(),i[0]){e.moveTo(b.x+a,b.y+o,_);for(let t=1;t<y.length;t++){let i=y[t];e.lineTo(i.x+a,i.y+o,_)}}else if(i[2]){let t=y[y.length-1];e.moveTo(t.x+a,t.y+o,_);for(let t=y.length-2;t>=0;t--){let i=y[t];e.lineTo((null!==(m=i.x1)&&void 0!==m?m:i.x)+a,(null!==(v=i.y1)&&void 0!==v?v:i.y)+o,_)}}}c?c(e,t.attribute,l):(e.setStrokeStyle(t,t.attribute,x-a,S-o,l),e.stroke())}}drawShape(t,e,i,r,n,s,a,o){var l,h,u,d,c,p;let g=nf(t,null==s?void 0:s.theme).area,{fill:f=g.fill,stroke:m=g.stroke,fillOpacity:v=g.fillOpacity,z:y=g.z,strokeOpacity:_=g.strokeOpacity,curveTension:b=g.curveTension}=t.attribute,x=this.valid(t,g,a,o);if(!x)return;let{doFill:S,doStroke:k}=x,{clipRange:A=g.clipRange,closePath:w,points:M,segments:C}=t.attribute,{curveType:T=g.curveType}=t.attribute;if(w&&"linear"===T&&(T="linearClosed"),1===A&&!C&&!M.some(t=>!1===t.defined)&&"linear"===T)return this.drawLinearAreaHighPerformance(t,e,!!f,k,v,_,i,r,g,n,s,a,o);if(t.shouldUpdateShape()){if(C&&C.length){let e,i,r;let n=C.map((t,r)=>{if(t.points.length<=1&&0===r)return t.points[0]&&(i={endX:t.points[0].x,endY:t.points[0].y}),null;1===r?e={x:i.endX,y:i.endY}:r>1&&(e.x=i.endX,e.y=i.endY);let n=lt(t.points,T,{startPoint:e,curveTension:b});return i=n,n}).filter(t=>!!t),s=[];for(let t=C.length-1;t>=0;t--){let e=C[t].points,i=[];for(let t=e.length-1;t>=0;t--)i.push({x:null!==(l=e[t].x1)&&void 0!==l?l:e[t].x,y:null!==(h=e[t].y1)&&void 0!==h?h:e[t].y});if(0!==t){let e=C[t-1].points,r=e[e.length-1];r&&i.push({x:null!==(u=r.x1)&&void 0!==u?u:r.x,y:null!==(d=r.y1)&&void 0!==d?d:r.y})}i.length>1&&(r=lt(i,"stepBefore"===T?"stepAfter":"stepAfter"===T?"stepBefore":T,{curveTension:b}),s.unshift(r))}t.cacheArea=s.map((t,e)=>({top:n[e],bottom:t}))}else{if(!M||!M.length)return t.cacheArea=null,void t.clearUpdateShapeTag();{let e=[];for(let t=M.length-1;t>=0;t--)e.push({x:null!==(c=M[t].x1)&&void 0!==c?c:M[t].x,y:null!==(p=M[t].y1)&&void 0!==p?p:M[t].y});let i=lt(M,T,{curveTension:b}),r=lt(e,"stepBefore"===T?"stepAfter":"stepAfter"===T?"stepBefore":T,{curveTension:b});t.cacheArea={top:i,bottom:r}}}t.clearUpdateShapeTag()}if(Array.isArray(t.cacheArea)){let s=t.attribute.segments.filter(t=>t.points.length);if(1===s[0].points.length&&s.shift(),1===A){let l=!1;t.cacheArea.forEach((h,u)=>{l||(l=this.drawSegmentItem(e,h,S,v,k,_,s[u],[g,t.attribute],A,i,r,y,t,n,a,o))})}else{let l=A*t.cacheArea.reduce((t,e)=>t+e.top.getLength(),0),h=0,u=!1;t.cacheArea.forEach((d,c)=>{if(u)return;let p=d.top.getLength(),f=(l-h)/p;h+=p,f>0&&(u=this.drawSegmentItem(e,d,S,v,k,_,s[c],[g,t.attribute],iu(f,1),i,r,y,t,n,a,o))})}}else this.drawSegmentItem(e,t.cacheArea,S,v,k,_,t.attribute,g,A,i,r,y,t,n,a,o)}draw(t,e,i,r){let n=nf(t,null==r?void 0:r.theme).area;this._draw(t,n,!1,i,r)}drawSegmentItem(t,e,i,r,n,s,a,o,l,h,u,d,c,p,g,f){let m=!1;return(m=this._drawSegmentItem(t,e,i,r,n,s,a,o,l,h,u,d,c,p,!1,g,f))||this._drawSegmentItem(t,e,i,r,n,s,a,o,l,h,u,d,c,p,!0,g,f)}_drawSegmentItem(t,e,i,r,n,s,a,o,l,h,u,d,c,p,g,f,m){var v,y,_,b;if(!(e&&e.top&&e.bottom&&e.top.curves&&e.top.curves.length&&e.bottom.curves&&e.bottom.curves.length))return;let{connectedType:x,connectedX:S,connectedY:k,connectedStyle:A}=a,w=[];if(g&&(eM(o)?(x=null!==(v=null!=x?x:o[0].connectedType)&&void 0!==v?v:o[1].connectedType,S=null!==(y=null!=S?S:o[0].connectedX)&&void 0!==y?y:o[1].connectedX,k=null!==(_=null!=k?k:o[0].connectedY)&&void 0!==_?_:o[1].connectedY,A=null!==(b=null!=A?A:o[0].connectedStyle)&&void 0!==b?b:o[1].connectedStyle):(x=null!=x?x:o.connectedType,S=null!=S?S:o.connectedX,k=null!=k?k:o.connectedY,A=null!=A?A:o.connectedStyle),"connect"!==x&&"zero"!==x&&(x="none"),eM(o)?o.forEach(t=>w.push(t)):w.push(o),w.push(a)),g&&"none"===x)return!1;t.beginPath();let{points:M,segments:C}=c.attribute,T,E,O=lE.ROW;if(C){let t=C[C.length-1];E=C[0].points[0],T=t.points[t.points.length-1]}else E=M[0],T=M[M.length-1];let P=ia(T.x-E.x),R=ia(T.y-E.y);O=null==T.x1?lE.ROW:null==T.y1?lE.COLUMN:Number.isFinite(P+R)?P>R?lE.ROW:lE.COLUMN:lE.ROW,function(t,e,i,r){var n;let{drawConnect:s=!1,mode:a="none"}=r||{};if(s&&"none"===a)return;let{top:o,bottom:l}=e;if(o.curves.length!==l.curves.length)return;if(i>=1){let e=[],i=[],n=!0;if(s){let n,s,a=!0,h=o.curves.length;o.curves.forEach((o,u)=>{let d=l.curves[h-u-1],c=o,p=d;if(o.originP1===o.originP2)return n=o,void(s=d);if(n&&n.originP1===n.originP2&&(c=n,p=s),o.defined)a||(e.push(c),i.push(p),o5(t,e,i,r),e.length=0,i.length=0,a=!a);else{let n,s;let{originP1:l,originP2:h}=o;l&&!1!==l.defined?(n=c,s=p):l&&!1!==h.defined&&(n=o,s=d),a?(a=!a,e.push(n||o),i.push(s||d)):n&&(a=!a,e.push(n||o),i.push(s||d),o5(t,e,i,r),e.length=0,i.length=0)}n=o}),o5(t,e,i,r)}else{for(let s=0,a=o.curves.length;s<a;s++){let h=o.curves[s];n!==h.defined?(n?(o4(t,e,i,r),e.length=0,i.length=0):(e.push(h),i.push(l.curves[a-s-1])),n=!n):n&&(e.push(h),i.push(l.curves[a-s-1]))}o4(t,e,i,r)}return}if(i<=0)return;let{direction:h}=r||{},{curves:u}=o,d=null!==(n=u[u.length-1].p3)&&void 0!==n?n:u[u.length-1].p1,c=ia(d.x-u[0].p0.x),p=ia(d.y-u[0].p0.y);h=null!=h?h:c>p?lE.ROW:lE.COLUMN,Number.isFinite(c)||(h=lE.COLUMN),Number.isFinite(p)||(h=lE.ROW);let g=i*(h===lE.ROW?c:p),f=0,m=!0,v=[],y=[],_,b,x=!0;for(let e=0,i=o.curves.length;e<i;e++){let n=o.curves[e],a=n.getLength(h),u=(g-f)/a;if(u<0)break;if(f+=a,s){let s=l.curves[i-e-1],a=n,o=s;if(n.originP1===n.originP2){_=n,b=s;continue}if(_&&_.originP1===_.originP2&&(a=_,o=b),n.defined)x||(v.push(a),y.push(o),o5(t,v,y,r),v.length=0,y.length=0,x=!x);else{let e,i;let{originP1:l,originP2:h}=n;l&&!1!==l.defined?(e=a,i=o):l&&!1!==h.defined&&(e=n,i=s),x?(x=!x,v.push(e||n),y.push(i||s)):e&&(x=!x,v.push(e||n),y.push(i||s),o5(t,v,y,r),v.length=0,y.length=0)}_=n}else{let s=null,a=null;m!==n.defined?(m?(o4(t,v,y,r),v.length=0,y.length=0):(s=n,a=l.curves[i-e-1]),m=!m):m&&(s=n,a=l.curves[i-e-1]),s&&a&&(u<1&&(s=s.p2&&s.p3?iK(s,u)[0]:iX(s,u)[0],a=a.p2&&a.p3?iK(a,1-u)[1]:iX(a,1-u)[1]),s.defined=m,a.defined=m,v.push(s),y.push(a)),s=null,a=null}}s?o5(t,v,y,r):o4(t,v,y,r)}(t.camera?t:t.nativeContext,e,l,{offsetX:h,offsetY:u,offsetZ:d,direction:O,drawConnect:g,mode:x,zeroX:S,zeroY:k}),this.beforeRenderStep(c,t,h,u,!!r,!1,i,!1,o,p,f,null,{attribute:a}),t.setShadowBlendStyle&&t.setShadowBlendStyle(c,a,o);let{x:B=0,x:I=0}=a;if(!1!==i&&(f?f(t,a,o):r&&(t.setCommonStyle(c,g?A:a,B-h,I-u,g?w:o),t.fill())),this.afterRenderStep(c,t,h,u,!!r,!1,i,!1,o,p,f,null,{attribute:a}),!1!==n){if(m)m(t,a,o);else{let{stroke:i=o&&o[1]&&o[1].stroke}=a;eM(i)&&(i[0]||i[2])&&!1===i[1]&&(t.beginPath(),o1(t.camera?t:t.nativeContext,i[0]?e.top:e.bottom,l,O===lE.ROW?"x":"y",{offsetX:h,offsetY:u,offsetZ:d,drawConnect:g,mode:x,zeroX:S,zeroY:k})),t.setStrokeStyle(c,g?A:a,B-h,I-u,g?w:o),t.stroke()}}return!1}};le=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),o7(0,e0(e2)),o7(0,e1(oL)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],le);let li=class extends le{constructor(){super(...arguments),this.numberType=sw}drawShape(t,e,i,r,n,s,a){if(t.incremental&&n.multiGraphicOptions){var o,l,h;let{startAtIdx:s,length:u}=n.multiGraphicOptions,{segments:d=[]}=t.attribute;if(s>d.length)return;let c=nf(t).area,{fill:p=c.fill,fillOpacity:g=c.fillOpacity,opacity:f=c.opacity,visible:m=c.visible}=t.attribute,v=(o=f,l=g,p&&o*l>0),y=!!p;if(!!t.valid&&!!m&&!!y){if(v||a)for(let n=s;n<s+u;n++)this.drawIncreaseSegment(t,e,d[n-1],d[n],t.attribute.segments[n],[c,t.attribute],i,r)}}else super.drawShape(t,e,i,r,n,s,a)}drawIncreaseSegment(t,e,i,r,n,s,a,o){r&&(e.beginPath(),function(t,e,i,r){let{offsetX:n=0,offsetY:s=0}=r||{},{points:a}=i,o=[],l=0;for(let t=0;t<a.length;t++)!1===a[t].defined&&(l+1!==t&&o.slice(l,t),l=t);o.push(a),o.forEach((i,r)=>{var a,o,l,h;let u=e&&0===r?e.points[e.points.length-1]:i[0];t.moveTo(u.x+n,u.y+s),i.forEach(e=>{!1!==e.defined?t.lineTo(e.x+n,e.y+s):t.moveTo(e.x+n,e.y+s)});for(let e=i.length-1;e>=0;e--){let r=i[e];t.lineTo(null!==(a=r.x1)&&void 0!==a?a:r.x,null!==(o=r.y1)&&void 0!==o?o:r.y)}t.lineTo(null!==(l=u.x1)&&void 0!==l?l:u.x,null!==(h=u.y1)&&void 0!==h?h:u.y),t.closePath()})}(e.camera?e:e.nativeContext,i,r,{offsetX:a,offsetY:o}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,n,s),e.setCommonStyle(t,n,a,o,s),e.fill())}};li=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],li);var lr,ln,ls,la,lo,ll,lh,lu,ld,lc,lp,lg,lf,lm,lv,ly,l_,lb,lx,lS,lk,lA,lw,lM,lC,lT,lE,lO,lP,lR,lB,lI,lL,lD,lF,lj,lN,lz,lH,lV,lW,lG,lU=function(t,e){return function(i,r){e(i,r,t)}},l$=function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function a(t){try{l(r.next(t))}catch(t){s(t)}}function o(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(a,o)}l((r=r.apply(t,e||[])).next())})};(cA=lG||(lG={}))[cA.NORMAL=0]="NORMAL",cA[cA.STOP=1]="STOP";let lY=class extends of{constructor(t,e,i,r){super(t,r),this.contributions=t,this.lineRender=e,this.areaRender=i,this.drawItemInterceptorContributions=r,this.rendering=!1,this.currFrameStartAt=0,this.currentIdx=0,this.status=lG.NORMAL,this.checkingForDrawPromise=null,this.hooks={completeDraw:new e8([])},this.defaultRenderMap.set(this.lineRender.numberType,this.lineRender),this.defaultRenderMap.set(this.areaRender.numberType,this.areaRender)}draw(t,e){return l$(this,void 0,void 0,function*(){if(this.checkingForDrawPromise)return;this.lastRenderService=t,this.lastDrawContext=e,this.checkingForDrawPromise=this.checkForDraw(e);let i=yield this.checkingForDrawPromise;if(this.checkingForDrawPromise=null,i)return;this.currentRenderService=t;let{context:r,viewBox:n}=e;r&&(r.inuse=!0,r.clearMatrix(),r.setTransformForCurrent(!0),r.save(),e.restartIncremental&&this.clearScreen(this.currentRenderService,r,e),r.translate(n.x1,n.y1,!0),r.save(),t.renderTreeRoots.sort((t,e)=>{var i,r;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:rk.zIndex)-(null!==(r=e.attribute.zIndex)&&void 0!==r?r:rk.zIndex)}).forEach(t=>{this.renderGroup(t,e)}),this.hooks.completeDraw.tap("top-draw",()=>{r.restore(),r.restore(),r.draw(),r.inuse=!1,this.rendering=!1}))})}_increaseRender(t,e){return l$(this,void 0,void 0,function*(){this.rendering=!0,yield this._renderIncrementalGroup(t,e)})}_renderIncrementalGroup(t,e){return l$(this,void 0,void 0,function*(){this.count=t.count,yield new Promise(i=>{this.renderItem(t,e,{drawingCb:()=>l$(this,void 0,void 0,function*(){if(2!==t.count)yield aQ(t,rk.zIndex,(i,r)=>{if(this.status===lG.STOP)return!0;if(i.isContainer||r<this.currentIdx)return!1;let n=this.currFrameStartAt+t.incremental;return r<n&&(this.currentIdx=r+1,this.renderItem(i,e)),r===n-1&&(this.currFrameStartAt=this.currentIdx,this.waitToNextFrame())}),i(!1);else{let r=t.getChildAt(0);if(r.incremental&&r.attribute.segments)for(r.incrementalAt||(r.incrementalAt=0);r.incrementalAt<r.attribute.segments.length;)e.multiGraphicOptions={startAtIdx:r.incrementalAt,length:r.incremental},this.renderItem(r,e),r.incrementalAt+=r.incremental,yield this.waitToNextFrame();else this.renderItem(r,e);i(!1)}})})}),this.hooks.completeDraw.call()})}waitToNextFrame(){return l$(this,void 0,void 0,function*(){return new Promise(t=>{this.global.getRequestAnimationFrame()(()=>{t(!1)})})})}checkForDraw(t){return l$(this,void 0,void 0,function*(){let e=this.rendering;return t.restartIncremental&&(e=!1,yield this.forceStop(),this.resetToInit()),e})}forceStop(){return l$(this,void 0,void 0,function*(){this.rendering&&(this.status=lG.STOP,yield new Promise(t=>{this.hooks.completeDraw.tap("stopCb",()=>{this.status=lG.NORMAL,this.hooks.completeDraw.taps=this.hooks.completeDraw.taps.filter(t=>"stopCb"!==t.name),t(!1)})}))})}resetToInit(){this.currFrameStartAt=0,this.currentIdx=0}renderGroup(t,e){return l$(this,void 0,void 0,function*(){if(!e.break&&!1!==t.attribute.visibleAll)return t.incremental&&e.startAtId===t._uid?(yield this._increaseRender(t,e),void(e.break=!0)):void(yield new Promise(i=>{this.renderItem(t,e,{drawingCb:()=>l$(this,void 0,void 0,function*(){yield aQ(t,rk.zIndex,t=>l$(this,void 0,void 0,function*(){e.break||t.isContainer&&(yield this.renderGroup(t,e))})),i(!1)})})}))})}};lY=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),lU(0,aq(s4)),lU(1,e0(o3)),lU(2,e0(li)),lU(3,e0(e2)),lU(3,e1(oe)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Array,Object,Object,Object])],lY);let lK=new eW(t=>{t(o$).toSelf().inSingletonScope(),t(o8).toSelf().inSingletonScope(),t(al).to(of),t(s0).to(lY),t(s8).to(oq).inSingletonScope(),t(s4).toService(s8),e5(t,oF),t(oK).toSelf().inSingletonScope(),e5(t,oG),e5(t,s4),t(oa).toSelf().inSingletonScope(),t(oe).toService(oa),e5(t,oe)});function lZ(){var t;lZ.__loaded||(lZ.__loaded=!0,r4.load(sQ),r4.load(aN),r4.load(ad),r4.load(ak),r4.load(aG),(t=r4).load(aU),t.load(a$),t.load(aX),function(t){t.load(lK)}(r4))}lZ.__loaded=!1,lZ();let lX=r4.get(e9);rj.global=lX;let lq=r4.get(sY);rj.graphicUtil=lq;let lJ=r4.get(s$);rj.transformUtil=lJ;let lQ=r4.get(sN);rj.graphicService=lQ;let l0=r4.get(sK);rj.layerService=l0;let l1=t=>ey(t)&&Number.isFinite(t),l2=!1;try{l2="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame}catch(t){l2=!1}l2=!1;let l3=function(t,e,i){let r,n,s,a,o,l,h=0,u=!1,d=!1,c=!0,p=!e&&0!==e&&l2;if("function"!=typeof t)throw TypeError("Expected a function");function g(e){let i=r,s=n;return r=n=void 0,h=e,a=t.apply(s,i)}function f(t,e){return p?(cancelAnimationFrame(o),requestAnimationFrame(t)):setTimeout(t,e)}function m(t){let i=t-l;return void 0===l||i>=e||i<0||d&&t-h>=s}function v(){let t=Date.now();if(m(t))return y(t);o=f(v,function(t){let i=t-h,r=e-(t-l);return d?Math.min(r,s-i):r}(t))}function y(t){return o=void 0,c&&r?g(t):(r=n=void 0,a)}function _(...t){let i=Date.now(),s=m(i);if(r=t,n=this,l=i,s){if(void 0===o){var c;return h=c=l,o=f(v,e),u?g(c):a}if(d)return o=f(v,e),g(l)}return void 0===o&&(o=f(v,e)),a}return e=+e||0,nb(i)&&(u=!!i.leading,(d="maxWait"in i)&&(s=Math.max(l1(i.maxWait)?i.maxWait:0,e)),c="trailing"in i?!!i.trailing:c),_.cancel=function(){void 0!==o&&function(t){if(p)return cancelAnimationFrame(t);clearTimeout(t)}(o),h=0,r=l=n=o=void 0},_.flush=function(){return void 0===o?a:y(Date.now())},_.pending=function(){return void 0!==o},_},l5=0;function l4(){return l5>=9999999&&(l5=0),l5++}function l8(t){return null!=t&&""!==t&&(!!ey(t)||+t==+t)}function l6(t){return!(!t||0===t.length)&&!ej(t[0])&&!ej(t[0].dataId)&&eM(t[0].fields)}function l9(t){switch(t){case"left":case"right":case"top":case"bottom":return!0;default:return!1}}function l7(t){return!!eE(t)&&!!t.endsWith("%")&&l8(t.substring(0,t.length-1))}function ht(t,e,i,r=0){var n,s;return ey(t)?t:l7(t)?Number(t.substring(0,t.length-1))*e/100:nx(t)?t(i):nb(t)?e*(null!==(n=t.percent)&&void 0!==n?n:0)+(null!==(s=t.offset)&&void 0!==s?s:0):r}function he(t,e,i){var r,n,s,a;let o={top:0,bottom:0,left:0,right:0};return Object.values(t).every(t=>ey(t))?(o.top=null!==(r=t.top)&&void 0!==r?r:0,o.right=null!==(n=t.right)&&void 0!==n?n:0,o.bottom=null!==(s=t.bottom)&&void 0!==s?s:0,o.left=null!==(a=t.left)&&void 0!==a?a:0,o):([{orients:["left","right"],size:e.width},{orients:["top","bottom"],size:e.height}].forEach(e=>{e.orients.forEach(r=>{o[r]=ht(t[r],e.size,i)})}),o)}function hi(t){var e;let i={};return eM(t)?(ej(t[0])||(i.top=i.left=i.bottom=i.right=t[0]),ej(t[1])||(i.left=i.right=t[1]),ej(t[2])||(i.bottom=t[2]),ej(t[3])||(i.left=t[3]),i):ey(t)||l7(t)||nx(t)||nb(e=t)&&("percent"in e||"offset"in e)?(i.top=i.left=i.bottom=i.right=t,i):nb(t)?i=Object.assign({},t):i}function hr(t,e,i){return i?{x:t.x+e.x,y:t.y+e.y}:t}let hn=(t,e)=>{let i=Number(t),r=t.toString();return isNaN(i)&&"%"===r[r.length-1]?e*(Number(r.slice(0,r.length-1))/100):i};function hs(){!function(){if(null==l)try{let t=document.createElement("canvas"),e=t.getContext("2d");(l=!!(window&&t.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&e&&e.isPointInPath&&e.isPointInStroke))&&(l=!!document.createElement)}catch(t){l=!1}}();let t=rj.global&&rj.global.env;return t?"browser"===t:l}let ha=hs(),ho=ha&&globalThis?globalThis.document:void 0;function hl(t){return("desktop-browser"===t||"mobile-browser"===t)&&ha}function hh(t){return hu(t)||"mobile-browser"===t}function hu(t){return t.includes("miniApp")||"lynx"===t||"wx"===t}let hd=(t,e)=>(nx(hp.warnHandler)&&hp.warnHandler.call(null,t,e),e?ex.getInstance().warn(`[VChart warn]: ${t}`,e):ex.getInstance().warn(`[VChart warn]: ${t}`)),hc=(t,e,i)=>{if(!hp.silent){if(!nx(hp.errorHandler))throw Error(t);hp.errorHandler.call(null,t,e)}},hp={silent:!1,warnHandler:!1,errorHandler:!1};function hg(t){var e,i;let{type:r}=t;return r===cZ.sankey?null!==(e=t.direction)&&void 0!==e?e:"horizontal":null!==(i=t.direction)&&void 0!==i?i:"vertical"}(cw=cZ||(cZ={})).area="area",cw.line="line",cw.bar="bar",cw.bar3d="bar3d",cw.rangeColumn="rangeColumn",cw.rangeColumn3d="rangeColumn3d",cw.rangeArea="rangeArea",cw.dot="dot",cw.geo="geo",cw.link="link",cw.map="map",cw.pie="pie",cw.pie3d="pie3d",cw.radar="radar",cw.rose="rose",cw.scatter="scatter",cw.circularProgress="circularProgress",cw.wordCloud="wordCloud",cw.wordCloud3d="wordCloud3d",cw.funnel="funnel",cw.funnel3d="funnel3d",cw.linearProgress="linearProgress",cw.boxPlot="boxPlot",cw.sankey="sankey",cw.gaugePointer="gaugePointer",cw.gauge="gauge",cw.treemap="treemap",cw.sunburst="sunburst",cw.circlePacking="circlePacking",cw.waterfall="waterfall",cw.heatmap="heatmap",cw.correlation="correlation",cw.liquid="liquid",cw.venn="venn",(cM=cX||(cX={})).label="label",cM.point="point",cM.line="line",cM.area="area",cM.bar="bar",cM.bar3d="bar3d",cM.boxPlot="boxPlot",cM.outlier="outlier",cM.circlePacking="circlePacking",cM.group="group",cM.gridBackground="gridBackground",cM.grid="grid",cM.dot="dot",cM.title="title",cM.subTitle="subTitle",cM.symbol="symbol",cM.funnel="funnel",cM.funnel3d="funnel3d",cM.transform="transform",cM.transform3d="transform3d",cM.transformLabel="transformLabel",cM.outerLabel="outerLabel",cM.outerLabelLine="outerLabelLine",cM.pin="pin",cM.pinBackground="pinBackground",cM.pointer="pointer",cM.segment="segment",cM.track="track",cM.cell="cell",cM.cellBackground="cellBackground",cM.link="link",cM.arrow="arrow",cM.pie="pie",cM.pie3d="pie3d",cM.labelLine="labelLine",cM.progress="progress",cM.minLabel="minLabel",cM.maxLabel="maxLabel",cM.rose="rose",cM.node="node",cM.sunburst="sunburst",cM.nonLeaf="nonLeaf",cM.leaf="leaf",cM.nonLeafLabel="nonLeafLabel",cM.leaderLine="leaderLine",cM.stackLabel="stackLabel",cM.word="word",cM.fillingWord="fillingWord",cM.nodePoint="nodePoint",cM.ripplePoint="ripplePoint",cM.centerPoint="centerPoint",cM.centerLabel="centerLabel",cM.barBackground="barBackground",cM.lineLabel="lineLabel",cM.areaLabel="areaLabel",cM.liquidGroup="liquidGroup",cM.liquid="liquid",cM.liquidBackground="liquidBackground",cM.liquidOutline="liquidOutline",cM.circle="circle",cM.overlap="overlap",cM.overlapLabel="overlapLabel";let hf={primaryFontColor:"titleFontColor",tertiaryFontColor:"labelFontColor",axisLabelFontColor:"axisFontColor",axisMarkerFontColor:"labelReverseFontColor",dataZoomHandleStrokeColor:"dataZoomHandlerStrokeColor",sliderHandleColor:"dataZoomHandlerFillColor",sliderRailColor:"dataZoomBackgroundColor",sliderTrackColor:"dataZoomSelectedColor",playerControllerColor:"dataZoomSelectedColor",popupBackgroundColor:"tooltipBackgroundColor",hoverBackgroundColor:"axisGridColor"},hm={titleFontColor:"primaryFontColor",labelFontColor:"tertiaryFontColor",axisFontColor:"axisLabelFontColor",labelReverseFontColor:"axisMarkerFontColor",dataZoomHandlerStrokeColor:"dataZoomHandleStrokeColor",dataZoomHandlerFillColor:"sliderHandleColor",dataZoomBackgroundColor:"sliderRailColor",dataZoomSelectedColor:"sliderTrackColor",tooltipBackgroundColor:"popupBackgroundColor"};function hv(t,e){if(!t)return[];let i=hk(t,e);if(!i||eM(i))return null!=i?i:[];if(nb(i)){let{dataScheme:r}=i;return r?hS(r)?r.map(i=>Object.assign(Object.assign({},i),{scheme:i.scheme.map(i=>hx(i)?h_(t,i,e):i).filter(eO)})):r.map(i=>hx(i)?h_(t,i,e):i).filter(eO):[]}return[]}function hy(t,e){var i,r;return hS(t)?null!==(r=null===(i=t.find(t=>eO(t.isAvailable)?nx(t.isAvailable)?t.isAvailable(e):!!t.isAvailable:!eO(t.maxDomainLength)||(null==e?void 0:e.length)<=t.maxDomainLength))||void 0===i?void 0:i.scheme)&&void 0!==r?r:t[t.length-1].scheme:t}function h_(t,e,i){var r;let n;let s=hk(t,i);if(!s)return;let{palette:a}=s;if(nb(a)&&(n=null!==(r=function(t,e){let i=hf[e];if(i&&t[i])return t[i];if(t[e])return t[e];let r=hm[e];return r?t[r]:void 0}(a,e.key))&&void 0!==r?r:e.default),!n)return;if(ej(e.a)&&ej(e.l)||!eE(n))return n;let o=new n$(n);if(eO(e.l)){let{r:t,g:i,b:r}=o.color,{h:n,s:s}=nF(t,i,r),a=nD(n,s,e.l),l=new n$(`rgb(${a.r}, ${a.g}, ${a.b})`);l.setOpacity(o.color.opacity),o=l}return eO(e.a)&&o.setOpacity(e.a),o.toRGBA()}let hb=(t,e,i)=>{if(e&&hx(t)){let r=h_(e,t,i);if(r)return r}return t};function hx(t){return t&&"palette"===t.type&&!!t.key}function hS(t){return!(!eM(t)||0===t.length)&&t.every(t=>eO(t.scheme))}function hk(t,e){var i,r;let n;let{type:s}=null!=e?e:{};if(!e||ej(s))n=null==t?void 0:t.default;else{let a=hg(e);n=null!==(r=null!==(i=null==t?void 0:t[`${s}_${a}`])&&void 0!==i?i:null==t?void 0:t[s])&&void 0!==r?r:null==t?void 0:t.default}return n}let hA="__VCHART",hw={label:{name:"label",type:"text"}},hM=`${hA}_rect_x`,hC=`${hA}_rect_x1`,hT=`${hA}_rect_y`,hE=`${hA}_rect_y1`,hO={data:!0},hP={animation:!0,animationAppear:!0,animationEnter:!0,animationUpdate:!0,animationExit:!0,animationNormal:!0},hR=Object.assign(Object.assign({},hw),{bar:{name:"bar",type:"rect"},barBackground:{name:"barBackground",type:"rect"}}),hB=Object.assign(Object.assign({},hw),{bar3d:{name:"bar3d",type:"rect3d"}}),hI={point:{name:"point",type:"symbol"},line:{name:"line",type:"line"}},hL=Object.assign(Object.assign({},hw),hI),hD=Object.assign(Object.assign({},hw),{point:{name:"point",type:"symbol"}}),hF=Object.assign(Object.assign(Object.assign({},hw),hI),{area:{name:"area",type:"area"}}),hj=Object.assign(Object.assign(Object.assign({},hw),hI),{area:{name:"area",type:"area"}}),hN=Object.assign(Object.assign({},hw),{pie:{name:"pie",type:"arc"},labelLine:{name:"labelLine",type:"path"}}),hz=Object.assign(Object.assign({},hw),{pie3d:{name:"pie3d",type:"arc3d"},labelLine:{name:"labelLine",type:"path"}}),hH=Object.assign(Object.assign({},hw),{rose:{name:"rose",type:"arc"}}),hV=Object.assign(Object.assign({},hw),{area:{name:"area",type:"path"}}),hW=Object.assign(Object.assign({},hw),{group:{name:"group",type:"group"}}),hG=Object.assign(Object.assign({},hW),{track:{name:"track",type:"arc"},progress:{name:"progress",type:"arc"}}),hU=Object.assign(Object.assign({},hw),{group:{name:"group",type:"group"},link:{name:"link",type:"rule"},arrow:{name:"arrow",type:"symbol"}}),h$=Object.assign(Object.assign({},hw),{group:{name:"group",type:"group"},grid:{name:"grid",type:"rule"},gridBackground:{name:"gridBackground",type:"rect"},dot:{name:"dot",type:"symbol"},title:{name:"title",type:"text"},subTitle:{name:"subTitle",type:"text"},symbol:{name:"symbol",type:"symbol"}}),hY=Object.assign(Object.assign({},hw),{word:{name:"word",type:"text"},fillingWord:{name:"fillingWord",type:"text"}}),hK=Object.assign(Object.assign({},hw),{funnel:{name:"funnel",type:"polygon"},transform:{name:"transform",type:"polygon"},transformLabel:{name:"transformLabel",type:"text"},outerLabel:{name:"outerLabel",type:"text"},outerLabelLine:{name:"outerLabelLine",type:"rule"}}),hZ=Object.assign(Object.assign({},hw),{funnel3d:{name:"funnel3d",type:"pyramid3d"},transform3d:{name:"transform3d",type:"pyramid3d"},transformLabel:{name:"transformLabel",type:"text"},outerLabel:{name:"outerLabel",type:"text"},outerLabelLine:{name:"outerLabelLine",type:"rule"}}),hX=Object.assign(Object.assign({},hw),{track:{name:"track",type:"rect"},progress:{name:"progress",type:"rect"},group:{name:"group",type:"group"}}),hq=Object.assign(Object.assign({},hR),{leaderLine:{name:"leaderLine",type:"rule"},stackLabel:{name:"stackLabel",type:"text"}}),hJ=Object.assign(Object.assign({},hw),{boxPlot:{name:"boxPlot",type:"boxPlot"},outlier:{name:"outlier",type:"symbol"}}),hQ=Object.assign(Object.assign({},hw),{nonLeaf:{name:"nonLeaf",type:"rect"},leaf:{name:"leaf",type:"rect"},nonLeafLabel:{name:"nonLeafLabel",type:"text"}}),h0=Object.assign(Object.assign({},hw),{node:{name:"node",type:"rect"},link:{name:"link",type:"linkPath"}}),h1=Object.assign(Object.assign({},hW),{segment:{name:"segment",type:"arc"},track:{name:"track",type:"arc"}}),h2=Object.assign(Object.assign({},hw),{pin:{name:"pin",type:"path"},pinBackground:{name:"pinBackground",type:"path"},pointer:{name:"pointer",type:["path","rect"]}}),h3=Object.assign(Object.assign({},hw),{sunburst:{name:"sunburst",type:"arc"}}),h5=Object.assign(Object.assign({},hR),{minLabel:{name:"minLabel",type:"text"},maxLabel:{name:"maxLabel",type:"text"}}),h4=Object.assign(Object.assign({},hB),{minLabel:{name:"minLabel",type:"text"},maxLabel:{name:"maxLabel",type:"text"}}),h8=Object.assign(Object.assign({},hw),{circlePacking:{name:"circlePacking",type:"arc"}}),h6=Object.assign(Object.assign({},hw),{cell:{name:"cell",type:"cell"},cellBackground:{name:"cellBackground",type:"cell"}}),h9=Object.assign(Object.assign({},hw),{nodePoint:{name:"nodePoint",type:"symbol"},ripplePoint:{name:"ripplePoint",type:"ripple"},centerPoint:{name:"centerPoint",type:"symbol"},centerLabel:{name:"centerLabel",type:"text"}}),h7=Object.assign({},hF),ut=Object.assign(Object.assign({},hw),{liquidGroup:{name:"liquidGroup",type:"group"},liquid:{name:"liquid",type:"liquid"},liquidBackground:{name:"liquidBackground",type:"group"},liquidOutline:{name:"liquidOutline",type:"group"}}),ue=Object.assign(Object.assign({},hw),{circle:{name:"circle",type:"arc"},overlap:{name:"overlap",type:"path"},overlapLabel:{name:"overlapLabel",type:"text"}});(cC=cq||(cq={})).area_horizontal="area_horizontal",cC.area_vertical="area_vertical",cC.area_stack="area_stack",cC.line_horizontal="line_horizontal",cC.line_vertical="line_vertical",cC.line_stack="line_stack",cC.bar_horizontal="bar_horizontal",cC.bar_vertical="bar_vertical",cC.bar_stack="bar_stack",cC.bar3d_horizontal="bar3d_horizontal",cC.bar3d_vertical="bar3d_vertical",cC.bar3d_stack="bar3d_stack",cC.rangeColumn_horizontal="rangeColumn_horizontal",cC.rangeColumn_vertical="rangeColumn_vertical",cC.rangeColumn3d_horizontal="rangeColumn3d_horizontal",cC.rangeColumn3d_vertical="rangeColumn3d_vertical",cC.rangeArea_horizontal="rangeArea_horizontal",cC.rangeArea_vertical="rangeArea_vertical",cC.linearProgress_horizontal="linearProgress_horizontal",cC.linearProgress_vertical="linearProgress_vertical",cC.linearProgress_stack="linearProgress_stack",cC.boxPlot_horizontal="boxPlot_horizontal",cC.boxPlot_vertical="boxPlot_vertical",cC.sankey_horizontal="sankey_horizontal",cC.sankey_vertical="sankey_vertical",cC.waterfall_horizontal="waterfall_horizontal",cC.waterfall_vertical="waterfall_vertical",cC.circularProgress_stack="circularProgress_stack",cC.radar_stack="radar_stack",cC.rose_stack="rose_stack";let ui={[cZ.bar]:hR,[cZ.bar3d]:hB,[cZ.line]:hL,[cZ.scatter]:hD,[cZ.area]:hF,[cZ.radar]:hj,[cZ.pie]:hN,[cZ.pie3d]:hz,[cZ.rose]:hH,[cZ.geo]:hw,[cZ.map]:hV,[cZ.circularProgress]:hG,[cZ.link]:hU,[cZ.dot]:h$,[cZ.wordCloud]:hY,[cZ.wordCloud3d]:hY,[cZ.funnel]:hK,[cZ.funnel3d]:hZ,[cZ.linearProgress]:hX,[cZ.waterfall]:hq,[cZ.boxPlot]:hJ,[cZ.treemap]:hQ,[cZ.sankey]:h0,[cZ.gauge]:h1,[cZ.gaugePointer]:h2,[cZ.sunburst]:h3,[cZ.rangeColumn]:h5,[cZ.rangeColumn3d]:h4,[cZ.circlePacking]:h8,[cZ.heatmap]:h6,[cZ.correlation]:h9,[cZ.rangeArea]:h7,[cZ.liquid]:ut,[cZ.venn]:ue};function ur(t,e,i=!1){if(e&&t!==e&&eO(e)&&"object"==typeof e){let r=Object(e),n=[];for(let t in r)n.push(t);let{length:s}=n,a=-1;for(;s--;){let s=n[++a];eO(r[s])&&"object"==typeof r[s]&&!eM(t[s])?function(t,e,i,r=!1){let n=t[i],s=e[i],a=e[i],o=!0;if(eM(s)){if(r)a=[];else if(eM(n))a=n;else if(eR(n)){a=Array(n.length);let t=-1,e=n.length;for(;++t<e;)a[t]=n[t]}}else eI(s)?(a=null!=n?n:{},"function"!=typeof n&&"object"==typeof n||(a={})):o=!1;o&&ur(a,s,r),un(t,i,a)}(t,e,s,i):un(t,s,r[s])}}}function un(t,e,i){(void 0===i||function(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}(t[e],i))&&(void 0!==i||e in t)||(t[e]=i)}function us(t,...e){let i=-1,r=e.length;for(;++i<r;)ur(t,e[i],!0);return t}function ua(t,e,i,r){Object.keys(t).forEach(n=>{if(nb(e))e.type===n&&(eM(t[n])?t[n].length>=e.index&&(t[n][e.index]=r?us({},t[n][e.index],i):i):t[n]=r?us({},t[n],i):i);else if(eM(t[n])){let s=t[n].findIndex(t=>t.id===e);s>=0&&(t[n][s]=r?us({},t[n][s],i):i)}else t.id===e&&(t[n]=r?us({},t[n],i):i)})}function uo(t,...e){return us(ul(t),...e.map(ul))}function ul(t){var e;let i;if(!t)return t;let r=function(t){return t&&(t=Object.keys(t).reduce((e,i)=>{var r;let n=t[i];return e[i]=eM(r=n)?{dataScheme:r}:r,e},{})),t}(t.colorScheme),{series:n}=t,{mark:s,markByName:a}=t;return(s||a)&&(i=Object.keys(ui).reduce((t,e)=>{var i;let r=null!==(i=null==n?void 0:n[e])&&void 0!==i?i:{};return t[e]=uh(r,e,s,a),t},{})),Object.assign({},t,{colorScheme:r,token:null!==(e=t.token)&&void 0!==e?e:{},series:Object.assign({},t.series,i)})}function uh(t,e,i,r){if(!ui[e])return t;let n={};return Object.values(ui[e]).forEach(({type:e,name:s})=>{n[s]=us({},null==i?void 0:i[om(e)[0]],null==r?void 0:r[s],null==t?void 0:t[s])}),Object.assign(Object.assign({},t),n)}let uu=[{maxDomainLength:10,scheme:["#1664FF","#1AC6FF","#FF8A00","#3CC780","#7442D4","#FFC400","#304D77","#B48DEB","#009488","#FF7DDA"]},{scheme:["#1664FF","#B2CFFF","#1AC6FF","#94EFFF","#FF8A00","#FFCE7A","#3CC780","#B9EDCD","#7442D4","#DDC5FA","#FFC400","#FAE878","#304D77","#8B959E","#B48DEB","#EFE3FF","#009488","#59BAA8","#FF7DDA","#FFCFEE"]}],ud="M1 0 C1 0.55228 0.55228 1 0 1 C-0.552285 1 -1 0.55228 -1 0 C-1 -0.552285 -0.552285 -1 0 -1 C0.55228 -1 1 -0.552285 1 0Z",uc=`${hA}_ARC_TRANSFORM_VALUE`,up=`${hA}_ARC_RATIO`,ug=`${hA}_ARC_START_ANGLE`,uf=`${hA}_ARC_END_ANGLE`,um=`${hA}_ARC_K`,uv=`${hA}_ARC_MIDDLE_ANGLE`,uy=`${hA}_ARC_QUADRANT`,u_=`${hA}_ARC_RADIAN`,ub=-Math.PI/2,ux=3*Math.PI/2,uS={label:{space:8},title:{space:8},maxHeight:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},uk=Object.assign(Object.assign({},uS),{label:{space:0}}),uA="M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3\nC-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6\nC0.3-1.4,0.3-1.4,0.3-1.4z;",uw={orient:"right",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"primaryFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},endText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},handlerText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6}},uM={style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:"#ffffff"},shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"}}},uC={horizontal:Object.assign(Object.assign({},uw),{rail:{width:200,height:8,style:{fill:{type:"palette",key:"sliderRailColor"}}},handler:uM}),vertical:Object.assign(Object.assign({},uw),{rail:{width:8,height:200,style:{fill:{type:"palette",key:"sliderRailColor"}}},handler:uM})},uT={style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:{type:"palette",key:"sliderTrackColor"}},fill:{type:"palette",key:"sliderHandleColor"}}},uE={horizontal:Object.assign(Object.assign({},uw),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:{width:200,height:4,style:{fill:{type:"palette",key:"sliderRailColor"}}},handler:uT}),vertical:Object.assign(Object.assign({},uw),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:{width:4,height:200,style:{fill:{type:"palette",key:"sliderRailColor"}}},handler:uT})},uO={area:{style:{fill:{type:"palette",key:"axisDomainColor",a:.25}}},label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}},uP={line:{style:{lineDash:[3,3],stroke:{type:"palette",key:"markLineStrokeColor"}}},startSymbol:{visible:!1,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{visible:!0,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},label:{refY:5,style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}},uR={itemLine:{decorativeLine:{visible:!1},startSymbol:{size:5,visible:!0,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},line:{style:{stroke:{type:"palette",key:"markLineStrokeColor"}}}},itemContent:{offsetY:-50}},uB={fontFamily:"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",fontSize:14,l1FontSize:32,l1LineHeight:"150%",l2FontSize:20,l2LineHeight:"140%",l3FontSize:16,l3LineHeight:"150%",l4FontSize:14,l4LineHeight:"150%",l5FontSize:12,l5LineHeight:"130%",l6FontSize:10,l6LineHeight:"120%"},uI={name:"light",background:{type:"palette",key:"backgroundColor"},padding:20,fontFamily:{type:"token",key:"fontFamily"},colorScheme:{default:{dataScheme:uu,palette:{backgroundColor:"#ffffff",borderColor:"#e3e5e8",shadowColor:"rgba(33,37,44,0.1)",hoverBackgroundColor:"#f1f2f5",sliderRailColor:"#f1f3f4",sliderHandleColor:"#ffffff",sliderTrackColor:"#0040ff",popupBackgroundColor:"#ffffff",primaryFontColor:"#21252c",secondaryFontColor:"#606773",tertiaryFontColor:"#89909d",axisLabelFontColor:"#89909d",disableFontColor:"#bcc1cb",axisMarkerFontColor:"#ffffff",axisGridColor:"#f1f2f5",axisDomainColor:"#d9dde4",dataZoomHandleStrokeColor:"#aeb5be",dataZoomChartColor:"#c9ced8",playerControllerColor:"#0040ff",scrollBarSliderColor:"rgba(0,0,0,0.3)",axisMarkerBackgroundColor:"#21252c",markLabelBackgroundColor:"#f1f2f5",markLineStrokeColor:"#606773",dangerColor:"#e33232",warningColor:"#ffc528",successColor:"#07a35a",infoColor:"#3073f2",discreteLegendPagerTextColor:"rgb(51, 51, 51)",discreteLegendPagerHandlerColor:"rgb(47, 69, 84)",discreteLegendPagerHandlerDisableColor:"rgb(170, 170, 170)"}}},token:uB,mark:{text:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1}}},markByName:{label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1,lineJoin:"bevel"}},area:{style:{fillOpacity:.2}},line:{style:{lineWidth:2,lineCap:"round",lineJoin:"round"}},point:{style:{size:8,stroke:{type:"palette",key:"backgroundColor"},lineWidth:1,fillOpacity:1}},word:{style:{fontSize:null}},fillingWord:{style:{fontSize:null}},sunburst:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},circlePacking:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},funnel3d:{style:{stroke:!1}},barBackground:{visible:!1,style:{fill:{type:"palette",key:"primaryFontColor",a:.06},stroke:"transparent"}}},series:{scatter:{point:{style:{size:8,symbolType:"circle",lineWidth:0,fillOpacity:.8}},label:{visible:!1,offset:5,position:"top",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},line:{label:{visible:!1,position:"top",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},area:{label:{visible:!1,offset:5,position:"top",style:{stroke:{type:"palette",key:"backgroundColor"},lineWidth:2}},point:{style:{symbolType:"circle"}},seriesMark:"area"},bar:{label:{visible:!1,position:"outside",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},bar3d:{bar3d:{style:{length:3}},label:{visible:!1,style:{offset:12,position:"outside"}}},pie:{outerRadius:.6,pie:{style:{fillOpacity:1}},label:{visible:!1,position:"outside",style:{fontWeight:"normal",stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1}},innerLabel:{style:{lineWidth:2}}},pie3d:{outerRadius:.6,pie3d:{style:{height:10,fillOpacity:1}},label:{visible:!1,position:"outside"}},map:{defaultFillColor:"#f3f3f3",area:{style:{lineWidth:.5,strokeOpacity:1,stroke:"black",fillOpacity:1}},label:{interactive:!1,style:{fontSize:{type:"token",key:"l6FontSize"},lineHeight:{type:"token",key:"l6LineHeight"},textBaseline:"middle",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},stroke:{type:"palette",key:"backgroundColor"}}}},radar:{label:{visible:!1,offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},dot:{dot:{style:{size:10,fillOpacity:1}},symbol:{style:{size:10}},title:{style:{textAlign:"left",textBaseline:"middle",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},subTitle:{style:{textAlign:"left",textBaseline:"top",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},link:{arrow:{style:{size:10}}},wordCloud:{word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}},wordCloud3d:{word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}},funnel:{transform:{style:{fill:{type:"palette",key:"axisGridColor"}}},label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"}},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle"}}},funnel3d:{transform3d:{style:{fill:"#f5f5f5"}},label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:"#707070"},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:"#707070",textBaseline:"middle"}}},linearProgress:{bandWidth:30,progress:{style:{fillOpacity:1}},track:{style:{fill:"#E7EBED",fillOpacity:1}}},circularProgress:{outerRadius:.8,innerRadius:.6,progress:{style:{fillOpacity:1}},track:{style:{fillOpacity:.2}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},waterfall:{seriesFieldName:{total:"total",increase:"increase",decrease:"decrease"},leaderLine:{style:{stroke:"black",lineWidth:1,lineDash:[4,4]}},stackLabel:{visible:!0,offset:12,position:"withChange",style:{fill:"black",fontSize:{type:"token",key:"l4FontSize"}}},label:{visible:!1,offset:12,position:"inside",style:{lineWidth:2}}},gauge:{outerRadius:.8,innerRadius:.6,padAngle:1.146,segment:{style:{fillOpacity:1}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},gaugePointer:{pointer:{type:"path",width:.4,height:.4,style:{path:"M-0.020059 -0.978425 C-0.018029 -0.9888053 -0.013378 -1 0 -1 C0.01342 -1 0.01812 -0.989146 0.0201 -0.978425 C0.02161 -0.9702819 0.0692 -0.459505 0.09486 -0.184807 C0.10298 -0.097849 0.1089 -0.034548 0.11047 -0.018339 C0.11698 0.04908 0.07373 0.11111 0.00002 0.11111 C-0.07369 0.11111 -0.117184 0.04991 -0.110423 -0.018339 C-0.103662 -0.086591 -0.022089 -0.9680447 -0.020059 -0.978425Z"}},pin:{width:.025,height:.025,style:{path:ud,fill:"#888"}},pinBackground:{width:.06,height:.06,style:{path:ud,fill:"#ddd"}}},treemap:{gapWidth:1,nodePadding:[5],nonLeaf:{visible:!1,style:{fillOpacity:.5}},label:{style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},nonLeafLabel:{padding:24,style:{fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},textBaseline:"middle",textAlign:"center"}}},sunburst:{innerRadius:0,outerRadius:1,startAngle:-90,endAngle:270,gap:0,labelLayout:{align:"center",offset:0,rotate:"radial"},sunburst:{style:{stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1,cursor:"pointer"}},label:{visible:!0,style:{cursor:"pointer",fill:{type:"palette",key:"primaryFontColor"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},rangeColumn:{label:{visible:!1,offset:5,position:"inside",style:{lineWidth:2,fill:{type:"palette",key:"axisMarkerFontColor"}},minLabel:{position:"end"},maxLabel:{position:"start"}}},circlePacking:{layoutPadding:5,circlePacking:{visible:!0,style:{cursor:"pointer",stroke:{type:"palette",key:"backgroundColor"}}},label:{visible:!0,style:{cursor:"pointer",fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},heatmap:{cell:{style:{shape:"square",fillOpacity:1}},cellBackground:{visible:!1}},sankey:{link:{style:{fillOpacity:.15,round:!0}}},rose:{rose:{style:{fillOpacity:1}},label:{style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"},textAlign:"center",textBaseline:"middle"}}},boxPlot:{boxPlot:{style:{lineWidth:1}},label:{style:{lineWidth:2}}},correlation:{centerLabel:{visible:!0,position:"center",style:{fill:"#fff",text:""}},label:{visible:!0,position:"bottom",style:{fill:"#000"}}},liquid:{outlinePadding:10,liquidBackground:{style:{lineWidth:0,fillOpacity:.2}},liquidOutline:{style:{lineWidth:2}}},venn:{circle:{style:{opacity:.8},state:{hover:{opacity:1}}},overlap:{style:{opacity:.8},state:{hover:{opacity:1,stroke:"white",lineWidth:2}}},label:{visible:!0,style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"}}},overlapLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}}},component:{discreteLegend:{orient:"bottom",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal"},space:12},pager:{textStyle:{fill:{type:"palette",key:"discreteLegendPagerTextColor"}},handler:{style:{fill:{type:"palette",key:"discreteLegendPagerHandlerColor"}},state:{disable:{fill:{type:"palette",key:"discreteLegendPagerHandlerDisableColor"}}}}},item:{visible:!0,spaceCol:10,spaceRow:6,padding:2,background:{state:{selectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}},unSelectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}}}},shape:{space:6,style:{lineWidth:0,fillOpacity:1,opacity:1},state:{unSelected:{fillOpacity:.2,opacity:1}}},label:{space:6,style:{fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},opacity:1},state:{unSelected:{fill:{type:"palette",key:"disableFontColor"},opacity:1}}}},allowAllCanceled:!1},colorLegend:uC,sizeLegend:uE,axis:{domainLine:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,inside:!1,tickSize:4,alignWithLabel:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},subTick:{visible:!1,tickSize:2,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},label:{visible:!0,inside:!1,space:10,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}},title:{space:10,padding:0,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor"},fontWeight:"normal",fillOpacity:1}}},axisBand:{domainLine:{visible:!0},grid:{visible:!1},subGrid:{visible:!1},tick:{visible:!0},subTick:{visible:!1}},axisLinear:{domainLine:{visible:!1},grid:{visible:!0},subGrid:{visible:!1},tick:{visible:!1},subTick:{visible:!1}},axisX:uS,axisY:{label:{space:12,autoLimit:!0},title:{space:12,autoRotate:!0},maxWidth:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},axisZ:uk,axisAngle:{grid:{visible:!0,style:{lineDash:[6,6]}},label:{space:5}},axisRadius:{grid:{smooth:!0,visible:!0},subGrid:{smooth:!0,visible:!1}},markLine:uP,markArea:uO,markPoint:uR,polarMarkLine:uP,polarMarkArea:uO,polarMarkPoint:uR,geoMarkPoint:uR,tooltip:{offset:{x:10,y:10},panel:{padding:{top:10,left:10,right:10,bottom:10},backgroundColor:{type:"palette",key:"popupBackgroundColor"},border:{color:{type:"palette",key:"popupBackgroundColor"},width:0,radius:3},shadow:{x:0,y:4,blur:12,spread:0,color:{type:"palette",key:"shadowColor"}}},spaceRow:6,titleLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0},shape:{size:8,spacing:6},keyLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle",spacing:26},valueLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0}},dataZoom:{padding:[12,0],showDetail:"auto",brushSelect:!1,middleHandler:{visible:!1,background:{size:6,style:{stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},cornerRadius:2}},icon:{style:{size:4,fill:{type:"palette",key:"sliderHandleColor"},stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}}},background:{size:20,style:{fill:{type:"palette",key:"sliderRailColor"},lineWidth:0}},selectedBackground:{style:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.1,outerBorder:{stroke:{type:"palette",key:"sliderTrackColor"},strokeOpacity:.2,distance:-.5,lineWidth:1}}},selectedBackgroundChart:{area:{style:{visible:!1,stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{visible:!1,stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}},startHandler:{style:{symbolType:uA,fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}},endHandler:{style:{symbolType:uA,fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}},startText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},endText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},backgroundChart:{area:{style:{stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}}},crosshair:{trigger:"hover",bandField:{visible:!1,line:{type:"rect",visible:!0,style:{fill:{type:"palette",key:"axisGridColor"},opacity:.7,lineWidth:0,stroke:{type:"palette",key:"markLineStrokeColor"},lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}},linearField:{visible:!1,line:{type:"line",visible:!0,style:{stroke:{type:"palette",key:"markLineStrokeColor"},fill:"transparent",opacity:.7,lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}}},player:{visible:!0,position:"start",padding:{top:20,bottom:20},slider:{space:10,trackStyle:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.8},railStyle:{fill:{type:"palette",key:"sliderRailColor"}},handlerStyle:{size:15,stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fill:{type:"palette",key:"playerControllerColor"}}},controller:{start:{order:0,space:0,style:{size:25,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},pause:{order:0,space:0,style:{size:25,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},backward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},forward:{order:0,space:10,position:"end",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}}}},brush:{style:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",lineWidth:2},brushMode:"single",brushType:"rect",brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:0},indicator:{title:{visible:!0,autoLimit:!1,autoFit:!1,style:{fontSize:{type:"token",key:"l1FontSize"},fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{visible:!0,style:{fontSize:{type:"token",key:"l2FontSize"},fill:{type:"palette",key:"tertiaryFontColor"},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}},title:{padding:{top:4,bottom:20},textStyle:{fontSize:{type:"token",key:"l3FontSize"},lineHeight:{type:"token",key:"l3LineHeight"},fill:{type:"palette",key:"primaryFontColor"}},subtextStyle:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fill:{type:"palette",key:"tertiaryFontColor"}}},mapLabel:{visible:!0,offset:12,position:"top",space:10,nameLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"left",fill:"black",fontSize:{type:"token",key:"l6FontSize"}}},valueLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"left",fill:"black",fontSize:{type:"token",key:"l6FontSize"}}},background:{visible:!0,padding:{top:4,bottom:4,left:6,right:6},style:{cornerRadius:2,lineWidth:1,fill:"white",stroke:"grey"}},leader:{visible:!1,style:{lineWidth:1,stroke:"red"}}},poptip:{visible:!0,position:"auto",padding:8,titleStyle:{fontSize:{type:"token",key:"l5FontSize"},fontWeight:"bold",fill:{type:"palette",key:"primaryFontColor"}},contentStyle:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"primaryFontColor"}},panel:{visible:!0,fill:{type:"palette",key:"popupBackgroundColor"},cornerRadius:3,lineWidth:0,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"},size:0,space:12}},totalLabel:{visible:!1,offset:5,overlap:{clampForce:!0,strategy:[]},smartInvert:!1,animation:!1,style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"primaryFontColor"}}},scrollBar:{horizontal:{height:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}},vertical:{width:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}}}},animationThreshold:2e3},uL=["animationThreshold","colorScheme","name","padding"];function uD(t,e,i,r){if(!t)return t;e||(e=t.colorScheme),i||(i=t.token);let n={};return Object.keys(t).forEach(s=>{var a,o,l;let h=t[s];uL.includes(s)?n[s]=h:eI(h)?hx(h)?n[s]=hb(h,e,r):(a=h)&&"token"===a.type&&a.key?n[s]=(o=i,l=h,o&&l.key in o?o[l.key]:l.default):n[s]=uD(h,e,i,r):n[s]=h}),n}let uF={[uI.name]:uI},uj=uI.name,uN=new Map(Object.keys(uF).map(t=>[t,uF[t]])),uz=new Map(Object.keys(uF).map(t=>[t,uD(uF[t])])),uH=new Map(Object.keys(uF).map(t=>[t,t===uj])),uV=(t,e)=>{if(!t)return;let i=u$(e);uN.set(t,i),uz.set(t,uD(i)),uH.set(t,!0)},uW=(t=uj,e=!1)=>(uH.has(t)&&!uH.get(t)&&uV(t,uN.get(t)),e?uz.get(t):uN.get(t)),uG=t=>uN.delete(t)&&uz.delete(t)&&uH.delete(t),uU=t=>!!eE(t)&&uN.has(t),u$=t=>{var e;return uo({},uW(null!==(e=t.type)&&void 0!==e?e:uj),t)};class uY{static registerInstance(t){uY.instances.set(t.id,t)}static unregisterInstance(t){uY.instances.delete(t.id)}static getInstance(t){return uY.instances.get(t)}static instanceExist(t){return uY.instances.has(t)}static forEach(t,e=[],i){let r=om(e);return uY.instances.forEach((e,i,n)=>{r.includes(i)||t(e,i,n)},i)}}uY.instances=new Map;class uK{static registerTheme(t,e){uV(t,e)}static getTheme(t,e=!1){return uW(t,e)}static removeTheme(t){return uG(t)}static themeExist(t){return uU(t)}static getDefaultTheme(){return uK.themes.get(uj)}static setCurrentTheme(t){uK.themeExist(t)&&(uK._currentThemeName=t,uY.forEach(e=>null==e?void 0:e.setCurrentTheme(t)))}static getCurrentTheme(t=!1){return uK.getTheme(uK._currentThemeName,t)}static getCurrentThemeName(){return uK._currentThemeName}}function uZ(t,e){return eE(t)?uK.themeExist(t)?uK.getTheme(t,e):{}:nb(t)?t:{}}uK.themes=uN,uK._currentThemeName=uj;var uX={},uq={};function uJ(t){return Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function uQ(t){var e=Object.create(null),i=[];return t.forEach(function(t){for(var r in t)!(r in e)&&i.push(e[r]=r)}),i}function u0(t,e){var i=t+"",r=i.length;return r<e?Array(e-r+1).join(0)+i:i}function u1(t){var e=RegExp('["'+t+"\n\r]"),i=t.charCodeAt(0);function r(t,e){var r,n=[],s=t.length,a=0,o=0,l=s<=0,h=!1;function u(){if(l)return uq;if(h)return h=!1,uX;var e,r,n=a;if(34===t.charCodeAt(n)){for(;a++<s&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=s?l=!0:10===(r=t.charCodeAt(a++))?h=!0:13===r&&(h=!0,10===t.charCodeAt(a)&&++a),t.slice(n+1,e-1).replace(/""/g,'"')}for(;a<s;){if(10===(r=t.charCodeAt(e=a++)))h=!0;else if(13===r)h=!0,10===t.charCodeAt(a)&&++a;else if(r!==i)continue;return t.slice(n,e)}return l=!0,t.slice(n,s)}for(10===t.charCodeAt(s-1)&&--s,13===t.charCodeAt(s-1)&&--s;(r=u())!==uq;){for(var d=[];r!==uX&&r!==uq;)d.push(r),r=u();if(!e||null!=(d=e(d,o++)))n.push(d)}return n}function n(e,i){return e.map(function(e){return i.map(function(t){return a(e[t])}).join(t)})}function s(e){return e.map(a).join(t)}function a(t){var i,r,n,s,a,o;return null==t?"":t instanceof Date?(r=(i=t).getUTCHours(),n=i.getUTCMinutes(),s=i.getUTCSeconds(),a=i.getUTCMilliseconds(),isNaN(i)?"Invalid Date":(o=i.getUTCFullYear(),(o<0?"-"+u0(-o,6):o>9999?"+"+u0(o,6):u0(o,4))+"-"+u0(i.getUTCMonth()+1,2)+"-"+u0(i.getUTCDate(),2)+(a?"T"+u0(r,2)+":"+u0(n,2)+":"+u0(s,2)+"."+u0(a,3)+"Z":s?"T"+u0(r,2)+":"+u0(n,2)+":"+u0(s,2)+"Z":n||r?"T"+u0(r,2)+":"+u0(n,2)+"Z":""))):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var i,n,s=r(t,function(t,r){var s,a,o;if(i)return i(t,r-1);n=t,i=e?(s=t,a=e,o=uJ(s),function(t,e){return a(o(t),e,s)}):uJ(t)});return s.columns=n||[],s},parseRows:r,format:function(e,i){return null==i&&(i=uQ(e)),[i.map(a).join(t)].concat(n(e,i)).join("\n")},formatBody:function(t,e){return null==e&&(e=uQ(t)),n(t,e).join("\n")},formatRows:function(t){return t.map(s).join("\n")},formatRow:s,formatValue:a}}var u2=u1(","),u3=u2.parse;u2.parseRows,u2.format,u2.formatBody,u2.formatRows,u2.formatRow,u2.formatValue;var u5=u1("	"),u4=u5.parse;u5.parseRows,u5.format,u5.formatBody,u5.formatRows,u5.formatRow,u5.formatValue,(cT=cJ||(cJ={})).DSV="dsv",cT.TREE="tree",cT.GEO="geo",cT.BYTE="bytejson",cT.HEX="hex",cT.GRAPH="graph",cT.TABLE="table",cT.GEO_GRATICULE="geo-graticule";let u8=function(t,...e){return function(t,...e){t||(t={});let i=-1,r=e.length;for(;++i<r;)!function(t,e){if(nb(e)&&t!==e)for(let i in e)!function t(e,i,r){let n=i[r];if(void 0===n)e[r]=null;else if(nb(n))for(let i in nb(e[r])||(e[r]={}),n)t(e[r],n,i);else e[r]=n}(t,e,i)}(t,e[i]);return t}(eP(t),...e)},u6={delimiter:","},u9=(t,e={},i)=>{i.type=cJ.DSV;let{delimiter:r}=u8(u6,e);if(!eE(r))throw TypeError("Invalid delimiter: must be a string!");return u1(r).parse(t)},u7=(t,e={},i)=>(i.type=cJ.DSV,u3(t)),dt=(t,e={},i)=>(i.type=cJ.DSV,u4(t));class de{static registerChart(t,e){de._charts[t]=e}static registerSeries(t,e){de._series[t]=e}static registerComponent(t,e,i){de._components[t]={cmp:e,alwaysCheck:i}}static registerMark(t,e){de._marks[t]=e}static registerRegion(t,e){de._regions[t]=e}static registerTransform(t,e){de.transforms[t]=e}static registerLayout(t,e){de._layout[t]=e}static registerAnimation(t,e){de._animations[t]=e}static registerImplement(t,e){de._implements[t]=e}static registerChartPlugin(t,e){de._chartPlugin[t]=e}static registerComponentPlugin(t,e){de._componentPlugin[t]=e}static createChart(t,e,i){return de._charts[t]?new de._charts[t](e,i):null}static createChartSpecTransformer(t,e){if(!de._charts[t])return null;let i=de._charts[t];return new i.transformerConstructor(Object.assign({seriesType:i.seriesType},e))}static createRegion(t,e,i){return de._regions[t]?new de._regions[t](e,i):null}static createRegionSpecTransformer(t,e){return de._regions[t]?new de._regions[t].transformerConstructor(e):null}static createSeries(t,e,i){return de._series[t]?new de._series[t](e,i):null}static createSeriesSpecTransformer(t,e){return de._series[t]?new de._series[t].transformerConstructor(e):null}static createMark(t,e,i){if(!de._marks[t])return null;let r=new de._marks[t](e,i);return"group"===r.type&&r.setInteractive(!1),r}static getComponents(){return Object.values(de._components)}static getComponentInKey(t){return de._components[t].cmp}static getLayout(){return Object.values(de._layout)}static getLayoutInKey(t){return de._layout[t]}static getSeries(){return Object.values(de._series)}static getSeriesInType(t){return de._series[t]}static getRegionInType(t){return de._regions[t]}static getAnimationInKey(t){return de._animations[t]}static getImplementInKey(t){return de._implements[t]}static getSeriesMarkMap(t){return de._series[t]?de._series[t].mark:{}}static getChartPlugins(){return Object.values(de._chartPlugin)}static getComponentPlugins(){return Object.values(de._componentPlugin)}static getComponentPluginInType(t){return de._componentPlugin[t]}static registerFormatter(t){this._formatter=t}static getFormatter(){return this._formatter}}de._charts={},de._series={},de._components={},de._marks={},de._regions={},de._animations={},de._implements={},de._chartPlugin={},de._componentPlugin={},de.transforms={fields:eN,filter:(t,e)=>{let{callback:i}=e;return i&&(t=t.filter(i)),t},fold:(t,e)=>{let{fields:i,key:r,value:n,retains:s}=e,a=[];for(let e=0;e<t.length;e++)i.forEach(o=>{let l={};if(l[r]=o,l[n]=t[e][o],s)s.forEach(i=>{l[i]=t[e][i]});else for(let r in t[e])-1===i.indexOf(r)&&(l[r]=t[e][r]);a.push(l)});return a}},de.dataParser={csv:u7,dsv:u9,tsv:dt},de._layout={},(cE=cQ||(cQ={})).dimensionHover="dimensionHover",cE.dimensionClick="dimensionClick",(cO=c0||(c0={})).Identity="identity",cO.Linear="linear",cO.Log="log",cO.Pow="pow",cO.Sqrt="sqrt",cO.Symlog="symlog",cO.Time="time",cO.Quantile="quantile",cO.Quantize="quantize",cO.Threshold="threshold",cO.Ordinal="ordinal",cO.Point="point",cO.Band="band";let di={};function dr(t){switch(t){case c0.Linear:case c0.Log:case c0.Pow:case c0.Sqrt:case c0.Symlog:case c0.Time:return!0;default:return!1}}function dn(t){return!!di[t]}function ds(t){switch(t){case c0.Ordinal:case c0.Point:case c0.Band:return!0;default:return!1}}Object.values(c0).forEach(t=>{di[t]=!0});let da=(t,e,i)=>t.x>=e.x&&t.x<=i.x&&t.y>=e.y&&t.y<=i.y,dl=(t,e,i)=>{let r=t.getRegionsInIds(om(e.layout.layoutBindRegionID));return null==r?void 0:r.some(t=>{let e=t.getLayoutRect(),r=t.getLayoutStartPoint();return da(i,{x:r.x,y:r.y},{x:e.width+r.x,y:e.height+r.y})})},dh=(t,e)=>{var i,r;return t===e||!ej(t)&&!ej(e)&&t.value===e.value&&(null===(i=t.axis)||void 0===i?void 0:i.id)===(null===(r=e.axis)||void 0===r?void 0:r.id)},du=(t,e,i,r)=>{var n;let s=ds(e.getScale().type),a=[];for(let o of e.getOption().getChart().getSeriesInIndex(e.getSpecInfo().seriesIndexes))if(o.coordinate===i){let i=om(r(o)),l=null===(n=o.getViewData())||void 0===n?void 0:n.latestData;if(i&&l){if(s){let e=[],r=[];l.forEach((n,s)=>{var a;(null===(a=n[i[0]])||void 0===a?void 0:a.toString())===(null==t?void 0:t.toString())&&(e.push(n),r.push(s))}),a.push({series:o,datum:e,key:dd(o,r)})}else if(eO(i[1])){let e=[],r=[];l.forEach((n,s)=>{var a;((null===(a=n[i[0]])||void 0===a?void 0:a.toString())===(null==t?void 0:t.toString())||eO(n[i[0]])&&eO(n[i[1]])&&t>=n[i[0]]&&t<n[i[1]])&&(e.push(n),r.push(s))}),a.push({series:o,datum:e,key:dd(o,r)})}else{let r=e.getSpec().tooltipFilterRange,n=l1(r)?[-r,r]:r,s=[],h=[];if(n)l.forEach((e,r)=>{if(eO(e[i[0]])){let a=e[i[0]]-t;a>=n[0]&&a<=n[1]&&(s.push(e),h.push(r))}});else{let e=1/0,r=0;l.forEach((n,a)=>{if(eO(n[i[0]])){let o=Math.abs(n[i[0]]-t),l=Math.sign(n[i[0]]-t);o<e?(e=o,s=[n],h=[a],r=l):o===e&&l===r&&(s.push(n),h.push(a))}})}a.push({series:o,datum:s,key:dd(o,h)})}}}return a},dd=(t,e)=>`${t.id}_${e.join("_")}`,dc=(t,e,i)=>{let r=t.getAllComponents().filter(r=>"axes"===r.specKey&&e(r)&&dl(t,r,i));return r.length?r:null};function dp(t,e,i,r){let n,s,a=-1;t.forEach(t=>{n=e(t),s=i(t),!ej(n)&&(n=+n)>=n&&!ej(s)&&(s=+s)>=s&&r(n,s,++a)})}function dg(t,e,i=1e-10,r=1e-10){let n=i*Math.max(t,e);return Math.abs(t-e)<=Math.max(r,n)}function df(t,e,i,r){return t>e&&!dg(t,e,i,r)}function dm(t,e,i,r){return t<e&&!dg(t,e,i,r)}function dv(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function dy(t){return Number(t)}let d_=(t,e)=>{let i=t;return!0!==e&&(i=t.sort(dv)),function(t,e,i=dy){let r=t.length;if(!r)return;if(r<2)return i(t[0],0,t);if(e>=1)return i(t[r-1],r-1,t);let n=(r-1)*e,s=Math.floor(n),a=i(t[s],s,t);return a+(i(t[s+1],s+1,t)-a)*(n-s)}(i,.5)};function db(t,e){let i=[];return t.forEach(t=>{let r=+t[e];l1(r)&&i.push(r)}),0===i.length?null:o_(i)}function dx(t,e){let i=[];return t.forEach(t=>{let r=+t[e];l1(r)&&i.push(r)}),0===i.length?null:oy(i)}function dS(t,e){return t.reduce((t,i)=>{let r=e?+i[e]:+i;return l1(r)&&(t+=r),t},0)}function dk(t,e){let i=0,r=0;return t.forEach(t=>{let n=e?+t[e]:+t;l1(n)&&(i+=n,r++)}),i/r}function dA(t,e){let i=dk(t,e);return t.length<=1?0:t.reduce((t,r)=>t+(e?+r[e]:+r-i)**2,0)/(t.length-1)}function dw(t,e){let i=dM(t),r=dM(e),n=Math.asin((t.x*e.y-e.x*t.y)/i/r),s=Math.acos((t.x*e.x+t.y*e.y)/i/r);return n<0?-s:s}function dM(t,e={x:0,y:0}){return iG.distancePP(t,e)}function dC(t,e,i){let r=!1;if(e&&nx(e)){for(let n of t)for(let t of n.getSeries(i))if(r=!!e.call(null,t))return r}return r}function dT(t,e){let i=[];for(let r of t)for(let t of r.getSeries(e))i.push(t);return i}let dE=(t,e)=>{for(let i=0;i<t.length;i++){let r=t[i].getSeries();for(let t=0;t<r.length;t++){let i=r[t];if(e&&i&&i.coordinate===e||!e&&i)return i}}return null},dO=(t,e)=>{let i=2*Math.PI,r=o_(e),n=oy(e);return t<r?t+=Math.ceil((r-t)/i)*i:t>n&&(t-=Math.ceil((t-n)/i)*i),t},dP=(t,e)=>{if(!t||!dE(t.getRegionsInIndex(),"polar"))return null;let{x:i,y:r}=e,n=dc(t,t=>"angle"===t.getOrient(),e),s=dc(t,t=>"radius"===t.getOrient(),e),a=[],o=t=>t.getDimensionField()[0];return n&&n.forEach(t=>{var e;let n=t.getScale();if(n&&ds(n.type)){let l=n.domain(),h=n.range(),u=t.getCenter(),d={x:i-t.getLayoutStartPoint().x-u.x,y:r-t.getLayoutStartPoint().y-u.y},c=dw({x:1,y:0},d);c=dO(c,h);let p=dM(d),g=null===(e=s[0])||void 0===e?void 0:e.getScale(),f=null==g?void 0:g.range();if((c-(null==h?void 0:h[0]))*(c-(null==h?void 0:h[1]))>0||(p-(null==f?void 0:f[0]))*(p-(null==f?void 0:f[1]))>0)return;let m=t.invert(c);if(ej(m))return;let v=l.findIndex(t=>(null==t?void 0:t.toString())===m.toString());v<0&&(v=void 0);let y=du(m,t,"polar",o);a.push({index:v,value:m,position:n.scale(m),axis:t,data:y})}}),s&&s.forEach(t=>{var e;let s=t.getScale(),l=null==s?void 0:s.range();if(s&&ds(s.type)){let h=t.getCenter(),u={x:i-t.getLayoutStartPoint().x-h.x,y:r-t.getLayoutStartPoint().y-h.y},d=dw({x:1,y:0},u);d<-Math.PI/2&&(d=2*Math.PI+d);let c=dM(u),p=null===(e=n[0])||void 0===e?void 0:e.getScale(),g=null==p?void 0:p.range();if((d-(null==g?void 0:g[0]))*(d-(null==g?void 0:g[1]))>0||(c-(null==l?void 0:l[0]))*(c-(null==l?void 0:l[1]))>0)return;let f=s.invert(c);if(ej(f))return;let m=s.domain().findIndex(t=>(null==t?void 0:t.toString())===f.toString());m<0&&(m=void 0);let v=du(f,t,"polar",o);a.push({index:m,value:f,position:s.scale(f),axis:t,data:v})}}),a.length?a:null};function dR(t){return"bottom"===t||"top"===t}function dB(t){return"left"===t||"right"===t}function dI(t){return"z"===t}function dL(t,e){return l9(t.orient)||e&&e.includes(t.orient)?t.orient:"left"}function dD(t){return"top"===t||"bottom"===t?"horizontal":"vertical"}function dF(t,e){var i,r;let n=null!==(i=t.type)&&void 0!==i?i:(r=t.orient,e?dR(r)?"linear":"band":dR(r)?"band":"linear");return{axisType:n,componentName:`${lx.cartesianAxis}-${n}`}}let dj=t=>t.fieldX[0],dN=t=>t.fieldY[0],dz=t=>{var e;return[t.fieldX[0],null!==(e=t.fieldX2)&&void 0!==e?e:t.fieldX[1]]},dH=t=>{var e;return[t.fieldY[0],null!==(e=t.fieldY2)&&void 0!==e?e:t.fieldY[1]]},dV=(t,e)=>t?e?dj:dz:e?dN:dH,dW=(t,e,i)=>{var r,n;if(!t||!dE(t.getRegionsInIndex(),"cartesian"))return null;let{x:s,y:a}=e,o=null!==(r=dc(t,t=>dR(t.getOrient()),e))&&void 0!==r?r:[],l=null!==(n=dc(t,t=>dB(t.getOrient()),e))&&void 0!==n?n:[],h=new Set,u=new Set,d=new Set;[o,l].forEach(t=>t.forEach(t=>{ds(t.getScale().type)?h.add(t):u.add(t),i&&t.getSpec().hasDimensionTooltip&&d.add(t)}));let c=[],p=t=>{let e="x"===t,i=e?s:a;(e?o:l).forEach(r=>{if(d.size>0){if(d.has(r)){let n=dG(r,i,t,dV(e,ds(r.getScale().type)));n&&c.push(n)}}else{let n=h.size>0;if((n?h:u).has(r)){let s=dG(r,i,t,dV(e,n));s&&c.push(s)}}})};return"horizontal"===t.getSpec().direction?(p("y"),0===c.length&&p("x")):(p("x"),0===c.length&&p("y")),c.length?c:null},dG=(t,e,i,r)=>{let n=t.getScale(),s=e-t.getLayoutStartPoint()[i];return(s-n.range()[0])*(s-n.range()[1])>0?null:dU(t,n.invert(s),r)},dU=(t,e,i)=>{let r=t.getScale();if(ej(e))return null;let n=r.domain().findIndex(t=>(null==t?void 0:t.toString())===e.toString());n<0&&(n=void 0);let s=du(e,t,"cartesian",null!=i?i:dR(t.getOrient())?dj:dN);return{index:n,value:e,position:r.scale(e),axis:t,data:s}};class d${constructor(t,e){this._eventDispatcher=t,this._mode=e}get chart(){var t,e;return this._chart||(this._chart=null===(e=(t=this._eventDispatcher.globalInstance).getChart)||void 0===e?void 0:e.call(t)),this._chart}register(t,e){var i,r;(null!==(r=null===(i=this.chart)||void 0===i?void 0:i.getOption().onError)&&void 0!==r?r:hc)("Method not implemented.")}unregister(){var t,e;(null!==(e=null===(t=this.chart)||void 0===t?void 0:t.getOption().onError)&&void 0!==e?e:hc)("Method not implemented.")}getTargetDimensionInfo(t,e){var i,r;let n=null!==(i=dW(this.chart,{x:t,y:e}))&&void 0!==i?i:[],s=[].concat(n,null!==(r=dP(this.chart,{x:t,y:e}))&&void 0!==r?r:[]);return 0===s.length?null:s}dispatch(t,e){var i;let r=null===(i=this.chart)||void 0===i?void 0:i.getAllComponents().filter(t=>"axes"===t.specKey&&(!(null==e?void 0:e.filter)||e.filter(t))),n=r.filter(t=>ds(t.getScale().type)),s=n.length?n:r.filter(t=>{let e=t.getOrient();return dR(e)||"angle"===e}),a=[];return s.forEach(e=>{let i=dU(e,t);i&&a.push(i)}),this._callback.call(null,{action:"enter",dimensionInfo:a}),a}}let dY=["pointerdown","pointerup","pointerupoutside","pointertap","pointerover","pointermove","pointerenter","pointerleave","pointerout","mousedown","mouseup","mouseupoutside","rightdown","rightup","rightupoutside","click","dblclick","mousemove","mouseover","mouseout","mouseenter","mouseleave","wheel","touchstart","touchend","touchendoutside","touchmove","touchcancel","tap","dragstart","drag","dragenter","dragleave","dragover","dragend","drop","pan","panstart","panend","press","pressup","pressend","pinch","pinchstart","pinchend","swipe"];(cP=c1||(c1={})).initialized="initialized",cP.rendered="rendered",cP.renderFinished="renderFinished",cP.animationFinished="animationFinished",cP.regionSeriesDataFilterOver="regionSeriesDataFilterOver",cP.afterInitData="afterInitData",cP.afterInitEvent="afterInitEvent",cP.afterInitMark="afterInitMark",cP.rawDataUpdate="rawDataUpdate",cP.viewDataFilterOver="viewDataFilterOver",cP.viewDataUpdate="viewDataUpdate",cP.viewDataStatisticsUpdate="viewDataStatisticsUpdate",cP.markDeltaYUpdate="markDeltaYUpdate",cP.viewDataLabelUpdate="viewDataLabelUpdate",cP.scaleDomainUpdate="scaleDomainUpdate",cP.scaleUpdate="scaleUpdate",cP.dataZoomChange="dataZoomChange",cP.drill="drill",cP.layoutStart="layoutStart",cP.layoutEnd="layoutEnd",cP.layoutRectUpdate="layoutRectUpdate",cP.playerPlay="playerPlay",cP.playerPause="playerPause",cP.playerEnd="playerEnd",cP.playerChange="playerChange",cP.playerForward="playerForward",cP.playerBackward="playerBackward",cP.scrollBarChange="scrollBarChange",cP.brushStart="brushStart",cP.brushChange="brushChange",cP.brushEnd="brushEnd",cP.brushClear="brushClear",cP.legendSelectedDataChange="legendSelectedDataChange",cP.legendFilter="legendFilter",cP.legendItemClick="legendItemClick",cP.legendItemHover="legendItemHover",cP.legendItemUnHover="legendItemUnHover",cP.tooltipShow="tooltipShow",cP.tooltipHide="tooltipHide",cP.tooltipRelease="tooltipRelease",cP.afterResize="afterResize",cP.afterRender="afterRender",cP.afterLayout="afterLayout",(cR=c2||(c2={})).chart="chart",cR.window="window",cR.canvas="canvas",(cB=c3||(c3={})).vchart="vchart",cB.chart="chart",cB.model="model",cB.mark="mark";let dK={[cQ.dimensionHover]:class t extends d${constructor(){super(...arguments),this._cacheDimensionInfo=null,this.onMouseMove=t=>{if(!t)return;let e=t.event.viewX,i=t.event.viewY,r=this.getTargetDimensionInfo(e,i);null===r&&null!==this._cacheDimensionInfo?(this._callback.call(null,Object.assign(Object.assign({},t),{action:"leave",dimensionInfo:this._cacheDimensionInfo.slice()})),this._cacheDimensionInfo=r):null!==r&&(null===this._cacheDimensionInfo||r.length!==this._cacheDimensionInfo.length||r.some((t,e)=>!dh(t,this._cacheDimensionInfo[e])))?(this._callback.call(null,Object.assign(Object.assign({},t),{action:"enter",dimensionInfo:r.slice()})),this._cacheDimensionInfo=r):null!==r&&this._callback.call(null,Object.assign(Object.assign({},t),{action:"move",dimensionInfo:r.slice()}))},this.onMouseOut=t=>{t&&(this._callback.call(null,Object.assign(Object.assign({},t),{action:"leave",dimensionInfo:this._cacheDimensionInfo?this._cacheDimensionInfo.slice():[]})),this._cacheDimensionInfo=null)}}register(t,e){this._callback=e.callback,this._eventDispatcher.register("pointermove",{query:Object.assign(Object.assign({},e.query),{source:c2.chart}),callback:this.onMouseMove}),this._eventDispatcher.register("pointerout",{query:Object.assign(Object.assign({},e.query),{source:c2.canvas}),callback:this.onMouseOut}),hh(this._mode)&&this._eventDispatcher.register("pointerdown",{query:Object.assign(Object.assign({},e.query),{source:c2.chart}),callback:this.onMouseMove})}unregister(){this._eventDispatcher.unregister("pointermove",{query:null,callback:this.onMouseMove}),hh(this._mode)&&this._eventDispatcher.unregister("pointerdown",{query:null,callback:this.onMouseMove})}},[cQ.dimensionClick]:class t extends d${constructor(){super(...arguments),this.onClick=t=>{if(!t)return;let e=t.event.viewX,i=t.event.viewY,r=this.getTargetDimensionInfo(e,i);r&&this._callback.call(null,Object.assign(Object.assign({},t),{action:"click",dimensionInfo:r.slice()}))}}register(t,e){this._callback=e.callback,this._eventDispatcher.register("pointertap",{query:Object.assign(Object.assign({},e.query),{source:c2.chart}),callback:this.onClick})}unregister(){this._eventDispatcher.unregister("pointertap",{query:null,callback:this.onClick})}}};class dZ{getComposedEventMap(){return this._composedEventMap}constructor(t,e){this._composedEventMap=new Map,this._eventDispatcher=t,this._mode=e}on(t,e,i){let r="function"==typeof e?{query:null,callback:e}:{query:e,callback:i};if(dK[t]){let e=new dK[t](this._eventDispatcher,this._mode);e.register(t,r),this._composedEventMap.set(i,{eventType:t,event:e})}else this._eventDispatcher.register(t,r);return this}off(t,e,i){var r,n;let s=null!=i?i:e;if(dK[t]){if(s)null===(r=this._composedEventMap.get(s))||void 0===r||r.event.unregister(),this._composedEventMap.delete(s);else for(let e of this._composedEventMap.entries())e[1].eventType===t&&(null===(n=this._composedEventMap.get(e[0]))||void 0===n||n.event.unregister(),this._composedEventMap.delete(e[0]))}else if(s){let i={callback:s,query:null,filter:{nodeName:null,type:t,level:null,source:e.source,markName:null,filter:null,userId:null}};this._eventDispatcher.unregister(t,i)}else this._eventDispatcher.unregister(t);return this}emit(t,e,i){return this._eventDispatcher.dispatch(t,e,i),this}prevent(t,e){return this._eventDispatcher.prevent(t,e),this}allow(t){return this._eventDispatcher.allow(t),this}release(){this._eventDispatcher.clear(),this._composedEventMap.clear()}}class dX{constructor(){this._map=new Map,this._levelNodes=new Map,this._levelNodes.set(c3.vchart,[]),this._levelNodes.set(c3.chart,[]),this._levelNodes.set(c3.model,[]),this._levelNodes.set(c3.mark,[])}addHandler(t,e){var i;let r={level:e,handler:t};return null===(i=this._levelNodes.get(e))||void 0===i||i.push(r),this._map.set(t.callback,r),this}removeHandler(t){let e=this._map.get(t.callback);if(!e)return this;this._map.delete(t.callback);let i=this._levelNodes.get(e.level),r=null==i?void 0:i.findIndex(e=>e.handler.callback===t.callback);return void 0!==r&&r>=0&&(null==i||i.splice(r,1)),this}preventHandler(t){return t&&(t.prevented=!0),this}allowHandler(t){return t&&(t.prevented=!1),this}getHandlers(t){var e;return(null===(e=this._levelNodes.get(t))||void 0===e?void 0:e.map(t=>t.handler))||[]}getAllHandlers(){return Array.from(this._map.values()).map(t=>t.handler)||[]}getCount(){return this._map.size}release(){this._map.clear(),this._levelNodes.clear()}}let dq=(t,e,i)=>{let r=eE(e)?e.split("."):e;for(let e=0;e<r.length;e++)t=t?t[r[e]]:void 0;return void 0===t?i:t},dJ=function(t,e,i){let r=!0,n=!0;if("function"!=typeof t)throw TypeError("Expected a function");return nb(i)&&(r="leading"in i?!!i.leading:r,n="trailing"in i?!!i.trailing:n),l3(t,e,{leading:r,trailing:n,maxWait:e})};(cI=c5||(c5={})).enter="enter",cI.update="update",cI.exit="exit",cI.group="group",cI.connectNulls="connectNulls",(cL=c4||(c4={})).enter="enter",cL.update="update",cL.exit="exit",cL.unChange="unChange",(cD=c8||(c8={})).arc="arc",cD.arc3d="arc3d",cD.area="area",cD.image="image",cD.line="line",cD.path="path",cD.rect="rect",cD.rect3d="rect3d",cD.rule="rule",cD.shape="shape",cD.symbol="symbol",cD.text="text",cD.richtext="richtext",cD.polygon="polygon",cD.pyramid3d="pyramid3d",cD.circle="circle",cD.cell="cell",cD.interval="interval",cD.group="group",cD.glyph="glyph",cD.component="component",cD.largeRects="largeRects",cD.largeSymbols="largeSymbols",(cF=c6||(c6={})).axis="axis",cF.grid="grid",cF.legend="legend",cF.slider="slider",cF.label="label",cF.datazoom="datazoom",cF.player="player",cF.title="title",cF.scrollbar="scrollbar",(cj=c9||(c9={}))[cj.player=1]="player",cj[cj.rollUp=2]="rollUp",cj[cj.drillDown=3]="drillDown",cj[cj.slider=4]="slider",cj[cj.datazoom=5]="datazoom",cj[cj.legend=6]="legend",cj[cj.scrollbar=7]="scrollbar",cj[cj.brush=8]="brush",cj[cj.normal=9]="normal",(cN=c7||(c7={})).lineAxis="lineAxis",cN.circleAxis="circleAxis",(cz=pt||(pt={})).lineAxisGrid="lineAxisGrid",cz.circleAxisGrid="circleAxisGrid",(cH=pe||(pe={})).discreteLegend="discreteLegend",cH.colorLegend="colorLegend",cH.sizeLegend="sizeLegend",(cV=pi||(pi={})).lineCrosshair="lineCrosshair",cV.rectCrosshair="rectCrosshair",cV.sectorCrosshair="sectorCrosshair",cV.circleCrosshair="circleCrosshair",cV.polygonCrosshair="polygonCrosshair",cV.ringCrosshair="ringCrosshair",(cW=pr||(pr={})).symbolLabel="symbolLabel",cW.rectLabel="rectLabel",cW.lineLabel="lineLabel",cW.dataLabel="dataLabel",(cG=pn||(pn={})).continuousPlayer="continuousPlayer",cG.discretePlayer="discretePlayer",(cU=ps||(ps={})).before="before",cU.layouting="layouting",cU.reevaluate="reevaluate",cU.after="after",(c$=pa||(pa={})).BEFORE_EVALUATE_DATA="beforeEvaluateData",c$.AFTER_EVALUATE_DATA="afterEvaluateData",c$.BEFORE_EVALUATE_SCALE="beforeEvaluateScale",c$.AFTER_EVALUATE_SCALE="afterEvaluateScale",c$.BEFORE_PARSE_VIEW="beforeParseView",c$.AFTER_PARSE_VIEW="afterParseView",c$.BEFORE_TRANSFORM="beforeTransform",c$.AFTER_TRANSFORM="afterTransform",c$.BEFORE_CREATE_VRENDER_STAGE="beforeCreateVRenderStage",c$.AFTER_CREATE_VRENDER_STAGE="afterCreateVRenderStage",c$.BEFORE_CREATE_VRENDER_LAYER="beforeCreateVRenderLayer",c$.AFTER_CREATE_VRENDER_LAYER="afterCreateVRenderLayer",c$.BEFORE_STAGE_RESIZE="beforeStageResize",c$.AFTER_STAGE_RESIZE="afterStageResize",c$.BEFORE_VRENDER_DRAW="beforeVRenderDraw",c$.AFTER_VRENDER_DRAW="afterVRenderDraw",c$.BEFORE_MARK_JOIN="beforeMarkJoin",c$.AFTER_MARK_JOIN="afterMarkJoin",c$.BEFORE_MARK_UPDATE="beforeMarkUpdate",c$.AFTER_MARK_UPDATE="afterMarkUpdate",c$.BEFORE_MARK_STATE="beforeMarkState",c$.AFTER_MARK_STATE="afterMarkState",c$.BEFORE_MARK_ENCODE="beforeMarkEncode",c$.AFTER_MARK_ENCODE="afterMarkEncode",c$.BEFORE_DO_LAYOUT="beforeDoLayout",c$.AFTER_DO_LAYOUT="afterDoLayout",c$.BEFORE_MARK_LAYOUT_END="beforeMarkLayoutEnd",c$.AFTER_MARK_LAYOUT_END="afterMarkLayoutEnd",c$.BEFORE_DO_RENDER="beforeDoRender",c$.AFTER_DO_RENDER="afterDoRender",c$.BEFORE_MARK_RENDER_END="beforeMarkRenderEnd",c$.AFTER_MARK_RENDER_END="afterMarkRenderEnd",c$.BEFORE_CREATE_VRENDER_MARK="beforeCreateVRenderMark",c$.AFTER_CREATE_VRENDER_MARK="afterCreateVRenderMark",c$.BEFORE_ADD_VRENDER_MARK="beforeAddVRenderMark",c$.AFTER_ADD_VRENDER_MARK="afterAddVRenderMark",c$.AFTER_VRENDER_NEXT_RENDER="afterVRenderNextRender",c$.BEFORE_ELEMENT_UPDATE_DATA="beforeElementUpdateData",c$.AFTER_ELEMENT_UPDATE_DATA="afterElementUpdateData",c$.BEFORE_ELEMENT_STATE="beforeElementState",c$.AFTER_ELEMENT_STATE="afterElementState",c$.BEFORE_ELEMENT_ENCODE="beforeElementEncode",c$.AFTER_ELEMENT_ENCODE="afterElementEncode",c$.ANIMATION_START="animationStart",c$.ANIMATION_END="animationEnd",c$.ELEMENT_ANIMATION_START="elementAnimationStart",c$.ELEMENT_ANIMATION_END="elementAnimationEnd",c$.ALL_ANIMATION_START="allAnimationStart",c$.ALL_ANIMATION_END="allAnimationEnd",(cY=po||(po={})).signal="signal",cY.data="data",cY.scale="scale",cY.coordinate="coordinate",cY.mark="mark",(cK=pl||(pl={})).active="active",cK.selected="selected",cK.highlight="highlight",cK.blur="blur";class dQ{constructor(t,e,i,r){this.channelEncoder={},this.marks=t,e&&this.registerChannelEncoder(e),i&&this.registerDefaultEncoder(i),this.progressiveChannels&&this.registerProgressiveChannels(r)}getMarks(){return this.marks}registerChannelEncoder(t,e){return eE(t)?this.channelEncoder[t]=e:Object.assign(this.channelEncoder,t),this}registerFunctionEncoder(t){return this.functionEncoder=t,this}registerDefaultEncoder(t){return this.defaultEncoder=t,this}registerProgressiveChannels(t){return this.progressiveChannels=om(t),this}getChannelEncoder(){return this.channelEncoder}getFunctionEncoder(){return this.functionEncoder}getDefaultEncoder(){return this.defaultEncoder}getProgressiveChannels(){return this.progressiveChannels}}class d0{static registerPlotMarks(t,e){d0._plotMarks[t]=e}static createPlotMark(t,e){return d0._plotMarks[t]?new d0._plotMarks[t](e):null}static registerMark(t,e){d0._marks[t]=e}static createMark(t,e,i){return d0._marks[t]?new d0._marks[t](e,t,i):null}static hasMark(t){return!!d0._marks[t]}static registerComponent(t,e){d0._components[t]=e}static createComponent(t,e,i,r){let n=d0._components[t];return n?new n(e,i,r):null}static hasComponent(t){return!!d0._components[t]}static registerGraphicComponent(t,e){d0._graphicComponents[t]=e}static createGraphicComponent(t,e,i){let r=d0._graphicComponents[t];return r?r(e,i):null}static registerTransform(t,e,i){d0._transforms[t]=Object.assign(e,{type:t,isBuiltIn:!!i})}static getTransform(t){return d0._transforms[t]}static unregisterRuntimeTransforms(){Object.keys(d0._transforms).forEach(t=>{d0._transforms[t]&&!d0._transforms[t].isBuiltIn&&(d0._transforms[t]=null)})}static registerGrammar(t,e,i){d0._grammars[t]={grammarClass:e,specKey:null!=i?i:t}}static createGrammar(t,e,i){var r;let n=null===(r=d0._grammars[t])||void 0===r?void 0:r.grammarClass;return n?new n(e,i):null}static getGrammars(){return this._grammars}static getGlyph(t){return d0._glyphs[t]}static createInteraction(t,e,i){let r=d0._interactions[t];return r?new r(e,i):null}static hasInteraction(t){return!!d0._interactions[t]}}d0._plotMarks={},d0._marks={},d0._components={},d0._graphicComponents={},d0._transforms={},d0._grammars={},d0._glyphs={},d0._animations={},d0._interactions={},d0._graphics={},d0.registerGlyph=(t,e,i,r,n)=>(d0._glyphs[t]=new dQ(e,i,r,n),d0._glyphs[t]),d0.registerAnimationType=(t,e)=>{d0._animations[t]=e},d0.getAnimationType=t=>d0._animations[t],d0.registerInteraction=(t,e)=>{d0._interactions[t]=e},d0.registerGraphic=(t,e)=>{d0._graphics[t]=e},d0.getGraphicType=t=>d0._graphics[t],d0.createGraphic=(t,e)=>{let i=d0._graphics[t];return i?i(e):null};let d1={cartesianAxis:"axis","cartesianAxis-band":"axis","cartesianAxis-linear":"axis","cartesianAxis-time":"axis",polarAxis:"axis","polarAxis-band":"axis","polarAxis-linear":"axis",discreteLegend:"legend",continuousLegend:"legend",colorLegend:"legend",sizeLegend:"legend",label:"label",markLine:"markLine",markArea:"markArea",markPoint:"markPoint",polarMarkLine:"polarMarkLine",polarMarkArea:"polarMarkArea",polarMarkPoint:"polarMarkPoint",geoMarkPoint:"geoMarkPoint"};class d2{constructor(t,e){this._viewBubbles=new Map,this._windowBubbles=new Map,this._canvasBubbles=new Map,this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this._onDelegate=t=>{var e;let i=this.globalInstance.getChart(),r=eO(t.modelId)&&(null==i?void 0:i.getModelById(t.modelId))||void 0,n=eO(t.markId)&&(null==i?void 0:i.getMarkById(t.markId))||null,s=new Map,a=null===(e=t.item)||void 0===e?void 0:e.mark;for(a&&eO(a.id())&&s.set(a.id(),t.item);null==a?void 0:a.elements;){let t=a.id();eO(t)&&!s.has(t)&&s.set(t,a.elements[0]),a=a.group}let o={event:t.event,item:t.item,datum:t.datum,source:t.source,itemMap:s,chart:i,model:r,mark:null!=n?n:void 0,node:dq(t.event,"target")};this.dispatch(t.type,o)},this._onDelegateInteractionEvent=t=>{let e=this.globalInstance.getChart(),i=t.event,r=null;i.elements&&(r=i.elements);let n={event:t.event,chart:e,items:r,datums:r&&r.map(t=>t.getDatum())};this.dispatch(t.type,n)},this.globalInstance=t,this._compiler=e}register(t,e){var i,r,n,s,a;this._parseQuery(e);let o=this.getEventBubble((null===(i=e.filter)||void 0===i?void 0:i.source)||c2.chart),l=this.getEventListeners((null===(r=e.filter)||void 0===r?void 0:r.source)||c2.chart);if(o.get(t)||o.set(t,new dX),o.get(t).addHandler(e,null===(n=e.filter)||void 0===n?void 0:n.level),this._isValidEvent(t)&&!l.has(t)){let i=this._onDelegate.bind(this);this._compiler.addEventListener(null===(s=e.filter)||void 0===s?void 0:s.source,t,i),l.set(t,i)}else if(this._isInteractionEvent(t)&&!l.has(t)){let i=this._onDelegateInteractionEvent.bind(this);this._compiler.addEventListener(null===(a=e.filter)||void 0===a?void 0:a.source,t,i),l.set(t,i)}return this}unregister(t,e){var i,r,n,s;let a=!1,o=this.getEventBubble((null===(i=null==e?void 0:e.filter)||void 0===i?void 0:i.source)||c2.chart),l=this.getEventListeners((null===(r=null==e?void 0:e.filter)||void 0===r?void 0:r.source)||c2.chart);if(e){let i=o.get(t);null==i||i.removeHandler(e),0===(null==i?void 0:i.getCount())&&(null==i||i.release(),o.delete(t),a=!0),(null===(n=null==e?void 0:e.wrappedCallback)||void 0===n?void 0:n.cancel)&&e.wrappedCallback.cancel()}else{let e=o.get(t);null==e||e.release(),o.delete(t),a=!0}if(a&&this._isValidEvent(t)){let i=l.get(t);this._compiler.removeEventListener((null===(s=null==e?void 0:e.filter)||void 0===s?void 0:s.source)||c2.chart,t,i),l.delete(t)}return this}dispatch(t,e,i){let r=this.getEventBubble(e.source||c2.chart).get(t);if(!r)return this;let n=!1;if(i){let s=r.getHandlers(i);n=this._invoke(s,t,e)}else{let i=r.getHandlers(c3.mark);if(!(n=this._invoke(i,t,e))){let i=r.getHandlers(c3.model);n=this._invoke(i,t,e)}if(!n){let i=r.getHandlers(c3.chart);n=this._invoke(i,t,e)}if(!n){let i=r.getHandlers(c3.vchart);n=this._invoke(i,t,e)}}return this}prevent(t,e){return["canvas","chart","window"].forEach(i=>{let r=this.getEventBubble(i).get(t);r&&r.getAllHandlers().forEach(t=>{e&&t.callback===e||r.preventHandler(t)})}),this}allow(t){return["canvas","chart","window"].forEach(e=>{let i=this.getEventBubble(e).get(t);i&&i.getAllHandlers().forEach(t=>i.allowHandler(t))}),this}clear(){for(let t of this._viewListeners.entries())this._compiler.removeEventListener(c2.chart,t[0],t[1]);for(let t of(this._viewListeners.clear(),this._windowListeners.entries()))this._compiler.removeEventListener(c2.window,t[0],t[1]);for(let t of(this._windowListeners.clear(),this._canvasListeners.entries()))this._compiler.removeEventListener(c2.canvas,t[0],t[1]);for(let t of(this._canvasListeners.clear(),this._viewBubbles.values()))t.release();for(let t of(this._viewBubbles.clear(),this._windowBubbles.values()))t.release();for(let t of(this._windowBubbles.clear(),this._canvasBubbles.values()))t.release();this._canvasBubbles.clear()}release(){this.clear(),this.globalInstance=null,this._compiler=null}_filter(t,e,i){var r,n,s;if(nx(t.filter)&&!t.filter(i)||t.nodeName&&dq(i,"node.name")!==t.nodeName||t.markName&&(null===(r=null==i?void 0:i.mark)||void 0===r?void 0:r.name)!==t.markName)return!1;let a=null===(n=i.model)||void 0===n?void 0:n.type;return d1[a]&&(a=d1[a]),(!t.type||a===t.type)&&!("mark"===t.level&&!t.type&&!(null==i?void 0:i.mark))&&!("model"===t.level&&!t.type&&!(null==i?void 0:i.model))&&(!eO(t.userId)||(null===(s=i.model)||void 0===s?void 0:s.userId)===t.userId)}_prepareParams(t,e){if(t.markName&&e.mark&&e.itemMap){let t=e.mark.getProductId(),i=e.itemMap.get(t),r=null==i?void 0:i.getDatum();return Object.assign(Object.assign({},e),{item:i,datum:r})}return Object.assign({},e)}_invoke(t,e,i){return t.map(t=>{var r,n,s;let a=t.filter;if(!t.prevented&&(!t.query||this._filter(a,e,i))){let e=(t.wrappedCallback||t.callback).call(null,this._prepareParams(a,i)),o=null!=e?e:null===(r=t.query)||void 0===r?void 0:r.consume;return o&&(null===(n=i.event)||void 0===n||n.stopPropagation(),null===(s=i.event)||void 0===s||s.preventDefault()),!!o}}).some(t=>!0===t)}_getQueryLevel(t){return t?t.level?t.level:eO(t.id)?c3.model:c3.vchart:c3.vchart}_parseQuery(t){var e;let i=t.query;(null==i?void 0:i.throttle)?t.wrappedCallback=dJ(t.callback,i.throttle):(null==i?void 0:i.debounce)&&(t.wrappedCallback=l3(t.callback,i.debounce));let r=this._getQueryLevel(i),n=null,s=c2.chart,a=null,o=null,l=null;return(null==i?void 0:i.nodeName)&&(a=i.nodeName),(null==i?void 0:i.markName)&&(o=i.markName),(null==i?void 0:i.type)&&(r===c3.model||r===c3.mark)&&(n=i.type),(null==i?void 0:i.source)&&(s=i.source),eO(null==i?void 0:i.id)&&(l=null==i?void 0:i.id,r=c3.model),t.filter={level:r,markName:o,type:n,source:s,nodeName:a,userId:l,filter:null!==(e=null==i?void 0:i.filter)&&void 0!==e?e:null},t}getEventBubble(t){switch(t){case c2.chart:return this._viewBubbles;case c2.window:return this._windowBubbles;case c2.canvas:return this._canvasBubbles;default:return this._viewBubbles}}getEventListeners(t){switch(t){case c2.chart:return this._viewListeners;case c2.window:return this._windowListeners;case c2.canvas:return this._canvasListeners;default:return this._viewListeners}}_isValidEvent(t){return dY.includes(t)||Object.values(pa).includes(t)}_isInteractionEvent(t){let e;return t&&(e=t.split(":")[0])&&d0.hasInteraction(e)}}function d3(t){return t}function d5(t,e){t&&d8.hasOwnProperty(t.type)&&d8[t.type](t,e)}var d4={Feature:function(t,e){d5(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,r=-1,n=i.length;++r<n;)d5(i[r].geometry,e)}},d8={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,r=-1,n=i.length;++r<n;)t=i[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){d6(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,r=-1,n=i.length;++r<n;)d6(i[r],e,0)},Polygon:function(t,e){d9(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,r=-1,n=i.length;++r<n;)d9(i[r],e)},GeometryCollection:function(t,e){for(var i=t.geometries,r=-1,n=i.length;++r<n;)d5(i[r],e)}};function d6(t,e,i){var r,n=-1,s=t.length-i;for(e.lineStart();++n<s;)r=t[n],e.point(r[0],r[1],r[2]);e.lineEnd()}function d9(t,e){var i=-1,r=t.length;for(e.polygonStart();++i<r;)d6(t[i],e,1);e.polygonEnd()}function d7(t,e){t&&d4.hasOwnProperty(t.type)?d4[t.type](t,e):d5(t,e)}function ct(){return new ce}function ce(){this.reset()}ce.prototype={constructor:ce,reset:function(){this.s=this.t=0},add:function(t){cr(ci,t,this.t),cr(this,ci.s,this.s),this.s?this.t+=ci.t:this.s=ci.t},valueOf:function(){return this.s}};var ci=new ce;function cr(t,e,i){var r=t.s=e+i,n=r-e;t.t=e-(r-n)+(i-n)}var cn=Math.PI,cs=cn/2,ca=cn/4,co=2*cn,cl=180/cn,ch=cn/180,cu=Math.abs,cd=Math.atan,cc=Math.atan2,cp=Math.cos,cg=Math.exp,cf=Math.log,cm=Math.pow,cv=Math.sin,cy=Math.sign||function(t){return t>0?1:t<0?-1:0},c_=Math.sqrt,cb=Math.tan;function cx(t){return t>1?0:t<-1?cn:Math.acos(t)}function cS(t){return t>1?cs:t<-1?-cs:Math.asin(t)}function ck(){}var cA,cw,cM,cC,cT,cE,cO,cP,cR,cB,cI,cL,cD,cF,cj,cN,cz,cH,cV,cW,cG,cU,c$,cY,cK,cZ,cX,cq,cJ,cQ,c0,c1,c2,c3,c5,c4,c8,c6,c9,c7,pt,pe,pi,pr,pn,ps,pa,po,pl,ph,pu,pd,pc,pp=new ce,pg=new ce,pf={point:ck,lineStart:ck,lineEnd:ck,polygonStart:function(){pf.lineStart=pm,pf.lineEnd=p_},polygonEnd:function(){pf.lineStart=pf.lineEnd=pf.point=ck,pp.add(cu(pg)),pg.reset()},result:function(){var t=pp/2;return pp.reset(),t}};function pm(){pf.point=pv}function pv(t,e){pf.point=py,ph=pd=t,pu=pc=e}function py(t,e){pg.add(pc*t-pd*e),pd=t,pc=e}function p_(){py(ph,pu)}var pb=1/0,px=1/0,pS=-1/0,pk=pS;let pA={point:function(t,e){t<pb&&(pb=t),t>pS&&(pS=t),e<px&&(px=e),e>pk&&(pk=e)},lineStart:ck,lineEnd:ck,polygonStart:ck,polygonEnd:ck,result:function(){var t=[[pb,px],[pS,pk]];return pS=pk=-(px=pb=1/0),t}};var pw,pM,pC,pT,pE=0,pO=0,pP=0,pR=0,pB=0,pI=0,pL=0,pD=0,pF=0,pj={point:pN,lineStart:pz,lineEnd:pW,polygonStart:function(){pj.lineStart=pG,pj.lineEnd=pU},polygonEnd:function(){pj.point=pN,pj.lineStart=pz,pj.lineEnd=pW},result:function(){var t=pF?[pL/pF,pD/pF]:pI?[pR/pI,pB/pI]:pP?[pE/pP,pO/pP]:[NaN,NaN];return pE=pO=pP=pR=pB=pI=pL=pD=pF=0,t}};function pN(t,e){pE+=t,pO+=e,++pP}function pz(){pj.point=pH}function pH(t,e){pj.point=pV,pN(pC=t,pT=e)}function pV(t,e){var i=t-pC,r=e-pT,n=c_(i*i+r*r);pR+=n*(pC+t)/2,pB+=n*(pT+e)/2,pI+=n,pN(pC=t,pT=e)}function pW(){pj.point=pN}function pG(){pj.point=p$}function pU(){pY(pw,pM)}function p$(t,e){pj.point=pY,pN(pw=pC=t,pM=pT=e)}function pY(t,e){var i=t-pC,r=e-pT,n=c_(i*i+r*r);pR+=n*(pC+t)/2,pB+=n*(pT+e)/2,pI+=n,pL+=(n=pT*t-pC*e)*(pC+t),pD+=n*(pT+e),pF+=3*n,pN(pC=t,pT=e)}function pK(t){this._context=t}pK.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,co)}},result:ck};var pZ,pX,pq,pJ,pQ,p0=new ce,p1={point:ck,lineStart:function(){p1.point=p2},lineEnd:function(){pZ&&p3(pX,pq),p1.point=ck},polygonStart:function(){pZ=!0},polygonEnd:function(){pZ=null},result:function(){var t=+p0;return p0.reset(),t}};function p2(t,e){p1.point=p3,pX=pJ=t,pq=pQ=e}function p3(t,e){pJ-=t,pQ-=e,p0.add(c_(pJ*pJ+pQ*pQ)),pJ=t,pQ=e}function p5(){this._string=[]}function p4(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function p8(t,e){var i,r,n=4.5;function s(t){return t&&("function"==typeof n&&r.pointRadius(+n.apply(this,arguments)),d7(t,i(r))),r.result()}return s.area=function(t){return d7(t,i(pf)),pf.result()},s.measure=function(t){return d7(t,i(p1)),p1.result()},s.bounds=function(t){return d7(t,i(pA)),pA.result()},s.centroid=function(t){return d7(t,i(pj)),pj.result()},s.projection=function(e){return arguments.length?(i=null==e?(t=null,d3):(t=e).stream,s):t},s.context=function(t){return arguments.length?(r=null==t?(e=null,new p5):new pK(e=t),"function"!=typeof n&&r.pointRadius(n),s):e},s.pointRadius=function(t){return arguments.length?(n="function"==typeof t?t:(r.pointRadius(+t),+t),s):n},s.projection(t).context(e)}p5.prototype={_radius:4.5,_circle:p4(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=p4(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(!this._string.length)return null;var t=this._string.join("");return this._string=[],t}};function p6(t){var e={type:"Feature"};return Object.keys(t).forEach(function(i){switch(i){case"type":case"properties":case"geometry":return;default:e[i]=t[i]}}),e.properties=function t(e){var i={};return e?(Object.keys(e).forEach(function(r){var n=e[r];"object"==typeof n?null===n?i[r]=null:Array.isArray(n)?i[r]=n.map(function(t){return t}):i[r]=t(n):i[r]=n}),i):i}(t.properties),e.geometry=p9(t.geometry),e}function p9(t){var e={type:t.type};return(t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type)?(e.geometries=t.geometries.map(function(t){return p9(t)}),e):(e.coordinates=function t(e){return"object"!=typeof e[0]?e.slice():e.map(function(e){return t(e)})}(t.coordinates),e)}let p7=function(t){if(!t)throw Error("geojson is required");switch(t.type){case"Feature":return p6(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach(function(i){switch(i){case"type":case"features":return;default:e[i]=t[i]}}),e.features=t.features.map(function(t){return p6(t)}),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return p9(t);default:throw Error("unknown GeoJSON type")}};function gt(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ge(t){for(var e,i,r=gt(t),n=0,s=1;s<r.length;)e=i||r[0],n+=((i=r[s])[0]-e[0])*(i[1]+e[1]),s++;return n>0}var gi={centimeters:637100880,centimetres:637100880,degrees:6371008.8/111325,feet:20902260.511392,inches:250826616.45599997,kilometers:6371.0088,kilometres:6371.0088,meters:6371008.8,metres:6371008.8,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:6371008.8/1852,radians:1,yards:6967335.223679999};function gr(t,e,i){void 0===i&&(i={});var r={type:"Feature"};return(0===i.id||i.id)&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.properties=e||{},r.geometry=t,r}function gn(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function gs(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function ga(t,e){var i,r,n,s,a,o,l,h,u,d,c=0,p="FeatureCollection"===t.type,g="Feature"===t.type,f=p?t.features.length:1;for(i=0;i<f;i++){for(n=0,o=p?t.features[i].geometry:g?t.geometry:t,h=p?t.features[i].properties:g?t.properties:{},u=p?t.features[i].bbox:g?t.bbox:void 0,d=p?t.features[i].id:g?t.id:void 0,a=(l=!!o&&"GeometryCollection"===o.type)?o.geometries.length:1;n<a;n++){if(null===(s=l?o.geometries[n]:o)){if(!1===e(null,c,h,u,d))return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(s,c,h,u,d))return!1;break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===e(s.geometries[r],c,h,u,d))return!1;break;default:throw Error("Unknown Geometry Type")}}c++}}function go(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return ga(t,function(t){go(t,e)}),t;case"LineString":return gl(gt(t),e),t;case"Polygon":return gh(gt(t),e),t;case"MultiLineString":return gt(t).forEach(function(t){gl(t,e)}),t;case"MultiPolygon":return gt(t).forEach(function(t){gh(t,e)}),t;case"Point":case"MultiPoint":return t}}function gl(t,e){ge(t)===e&&t.reverse()}function gh(t,e){ge(t[0])!==e&&t[0].reverse();for(var i=1;i<t.length;i++)ge(t[i])===e&&t[i].reverse()}let gu=function(t,e){if(i=e=e||{},i.constructor!==Object)throw Error("options is invalid");var i,r=e.reverse||!1,n=e.mutate||!1;if(!t)throw Error("<geojson> is required");if("boolean"!=typeof r)throw Error("<reverse> must be a boolean");if("boolean"!=typeof n)throw Error("<mutate> must be a boolean");!1===n&&(t=p7(t));var s=[];switch(t.type){case"GeometryCollection":return ga(t,function(t){go(t,r)}),t;case"FeatureCollection":return gs(t,function(t){gs(go(t,r),function(t){s.push(t)})}),gn(s)}return go(t,r)},gd=function(t){if(!t)throw Error("geojson is required");var e,i,r=[];return e=t,i=function(t){r.push(t)},ga(e,function(t,e,r,n,s){var a,o=null===t?null:t.type;switch(o){case null:case"Point":case"LineString":case"Polygon":if(!1===i(gr(t,r,{bbox:n,id:s}),e,0))return!1;return}switch(o){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var l=0;l<t.coordinates.length;l++)if(!1===i(gr({type:a,coordinates:t.coordinates[l]},r),e,l))return!1}),gn(r)},gc=p8(),gp={centroid:!1,name:!1,bbox:!1,rewind:!1},gg=t=>{if(t.geometry.type.startsWith("Multi")){let e=gd(t).features[0];return Object.assign(Object.assign({},e),e.properties)}return Object.assign(Object.assign({},t),t.properties)},gf=t=>{let e=[];return t.forEach(t=>{"FeatureCollection"===t.type?t.features.forEach(t=>{e.push(gg(t))}):e.push(gg(t))}),e},gm=(t,e={},i)=>{i.type=cJ.GEO;let{centroid:r,name:n,bbox:s,rewind:a}=u8(gp,e);if(Array.isArray(t))return gf(t);let o=t.features;return a&&(o=gu(t,{reverse:!nb(a)||a.reverse}).features),o.forEach(t=>{if(r){let e=gc.centroid(t);t.centroidX=e[0],t.centroidY=e[1]}if(n&&(t.name=t.properties.name),s){let e=gc.bounds(t);t.bbox=e}}),t.features=o,t};function gv(t){return t}function gy(t,e){var i=e.id,r=e.bbox,n=null==e.properties?{}:e.properties,s=function(t,e){var i=function(t){if(null==t)return gv;var e,i,r=t.scale[0],n=t.scale[1],s=t.translate[0],a=t.translate[1];return function(t,o){!o&&(e=i=0);var l=2,h=t.length,u=Array(h);for(u[0]=(e+=t[0])*r+s,u[1]=(i+=t[1])*n+a;l<h;)u[l]=t[l],++l;return u}}(t.transform),r=t.arcs;function n(t){return i(t)}function s(t){for(var e=[],n=0,s=t.length;n<s;++n)!function(t,e){e.length&&e.pop();for(var n=r[t<0?~t:t],s=0,a=n.length;s<a;++s)e.push(i(n[s],s));t<0&&!function(t,e){for(var i,r=t.length,n=r-e;n<--r;)i=t[n],t[n++]=t[r],t[r]=i}(e,a)}(t[n],e);return e.length<2&&e.push(e[0]),e}function a(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function o(t){return t.map(a)}return function t(e){var i,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":i=n(e.coordinates);break;case"MultiPoint":i=e.coordinates.map(n);break;case"LineString":i=s(e.arcs);break;case"MultiLineString":i=e.arcs.map(s);break;case"Polygon":i=o(e.arcs);break;case"MultiPolygon":i=e.arcs.map(o);break;default:return null}return{type:r,coordinates:i}}(e)}(t,e);return null==i&&null==r?{type:"Feature",properties:n,geometry:s}:null==r?{type:"Feature",id:i,properties:n,geometry:s}:{type:"Feature",id:i,bbox:r,properties:n,geometry:s}}let g_={},gb=(t,e,i)=>{var r,n;i.type=cJ.GEO;let s=u8(gp,g_,e),{object:a}=s;if(!eE(a))throw TypeError("Invalid object: must be a string!");return gm((r=t,"string"==typeof(n=t.objects[a])&&(n=r.objects[n]),"GeometryCollection"===n.type?{type:"FeatureCollection",features:n.geometries.map(function(t){return gy(r,t)})}:gy(r,n)),s,i)};var gx=i("939"),gS=i.n(gx);let gk={tolerance:.01},gA=(t,e)=>{let{tolerance:i}=u8(gk,e);return gS()(t,i)};function gw(t,e,i){t.getTransform(e)||t.registerTransform(e,i)}function gM(t,e,i){t.getParser(e)||t.registerParser(e,i)}let gC=new Map;function gT(t,e,i={type:"geojson",centroid:!0}){gC.has(t)&&hd(`map type of '${t}' already exists, will be overwritten.`),h||(gM(h=new eA,"geojson",gm),gM(h,"topojson",gb),gw(h,"simplify",gA));let r=new eH(h),n=eF({},{centroid:!0,simplify:!1},i);"topojson"===i.type?r.parse(e,{type:"topojson",options:n}):r.parse(e,{type:"geojson",options:n});let{simplify:s}=i;!0===s?r.transform({type:"simplify"}):nb(s)&&r.transform({type:"simplify",options:s}),gC.set(t,r)}function gE(t){gC.has(t)?gC.delete(t):hd(`map type of '${t}' does not exists.`)}function gO(t,e=!1){let i=e;return t.latestData instanceof eH&&(i=!1),i?eP(t.latestData):t.latestData.slice()}let gP=(t,e)=>0===t.length?[]:1===t.length?gO(t[0],null==e?void 0:e.deep):t.map(t=>gO(t,null==e?void 0:e.deep));function gR(t,e,i){gw(e=e instanceof eA?e:t.dataSet,"copyDataView",gP);let r=new eH(e,i);return r.parse([t],{type:"dataview"}),r.transform({type:"copyDataView",level:ty.copyDataView}),r}function gB(t,e,i=[],r={}){var n,s;let a;if(t instanceof eH)return t;let{id:o,values:l=[],fromDataIndex:h,fromDataId:u,transforms:d=[]}=t,c=t.parser?eP(t.parser):{clone:!0},p=eP(t.fields);c.clone=!1!==c.clone;let g=i.find(t=>t.name===o);if(g)a=g;else{let t={name:o};if(p&&(t.fields=p),a=new eH(e,t),"string"==typeof u){let t=i.find(t=>t.name===u);if(!t)return(null!==(n=r.onError)&&void 0!==n?n:hc)(`no data matches fromDataId ${u}`),null;a.parse([t],{type:"dataview"}),a.transform({type:"copyDataView"})}else if("number"==typeof h){let t=i[h];if(!t)return(null!==(s=r.onError)&&void 0!==s?s:hc)(`no data matches fromDataIndex ${h}`),null;a.parse([t],{type:"dataview"}),a.transform({type:"copyDataView"})}else Array.isArray(l)?a.parse(l,c):eE(l)&&(!c||["csv","dsv","tsv"].includes(c.type))?a.parse(l,null!=c?c:{type:"csv"}):(a.parse([]),hd("values should be array"));d&&d.length&&d.forEach(t=>{e.getTransform(t.type)&&a.transform(t)})}return a}function gI(t,e,i){t&&(e.fields&&t.setFields(e.fields,i),t.parseNewData(e.values,e.parser))}(_=ty||(ty={}))[_.copyDataView=-10]="copyDataView",_[_.treemapFilter=-8]="treemapFilter",_[_.treemapFlatten=-7]="treemapFlatten",_[_.dotObjFlat=-7]="dotObjFlat",_[_.linkDotInfo=-7]="linkDotInfo",_[_.sankeyLayout=-7]="sankeyLayout",_[_.dataZoomFilter=-6]="dataZoomFilter",_[_.legendFilter=-5]="legendFilter";let gL=(t,e)=>{let i={nodes:{}},{fields:r}=e;if(!(null==r?void 0:r.length))return i;let n=r.length-1,s,a=i;return t.forEach(t=>{t.latestData.forEach(t=>{a=i;for(let e=0;e<r.length;e++){let i=t[r[e]];if(ej(i))break;a.nodes[i]||(e===n?a.nodes[i]={values:[]}:(s={nodes:{}},a.nodes[i]=s)),e===n?a.nodes[i].values.push(t):a=a.nodes[i]}})}),i};function gD(t,e){return om(t).reduce((t,i)=>{let r=eE(i)?e.getGrammarById(i):i;return r&&t.push(r),t},[])}(b=t_||(t_={})).appear="appear",b.disappear="disappear",b.enter="enter",b.update="update",b.state="state",b.exit="exit",b.normal="normal",b.none="none";function gF(t,e){var i,r;if(ej(t))return[];if(nx(i=t)||!(null==i?void 0:i.signal)){;if(!nx(r=t)&&(null==r?void 0:r.callback))return gD(t.dependency,e)}else{let i=t.signal;if(eE(i))return om(e.getGrammarById(i));if("signal"===(null==i?void 0:i.grammarType))return[i]}return[]}function gj(t){return nx(t)||(null==t?void 0:t.signal)||!!(null==t?void 0:t.callback)}function gN(t,e,i,r){if(ej(t))return t;if(nx(t))return r?t.call(null,i,r,e):t.call(null,i,e);if(t.signal){let i=t.signal;return eE(i)?null==e?void 0:e[i]:i.output()}return t.callback?r?t.callback.call(null,i,r,e):t.callback.call(null,i,e):t}function gz(t,e){return gH(t)?t.output():e[t]}let gH=t=>t&&!ej(t.grammarType),gV=t=>nx(t)?t:e=>e[t],gW=(t,e)=>gH(t)?t.output():t&&nb(t)?nx(t.callback)?i=>t.callback(i,e):nx(t.value)?t.value(e):t:t,gG=(t,e)=>t?nb(t)?Object.keys(t).reduce((i,r)=>{let n=t[r];return i[r]=gW(n,e),i},{}):t.map(t=>gW(t,e)):t,gU=-1;class g$ extends em(){constructor(t){super(),this.spec={},this.references=new Map,this.targets=[],this.transforms=[],this.view=t,this.uid=++gU}parse(t){return this.id(t.id),this.name(t.name),this.depend(t.dependency),this}depend(t){var e;if(null===(e=this.spec)||void 0===e?void 0:e.dependency){let t=om(this.spec.dependency).map(t=>eE(t)?this.view.getGrammarById(t):t);this.detach(t)}this.spec.dependency=t;let i=om(t).map(t=>eE(t)?this.view.getGrammarById(t):t);return this.attach(i),this.commit(),this}addEventListener(t,e,i){let r=e;return i&&!1===i.trap||((r=e).raw=e),i&&i.target&&(r.target=i.target),this.on(t,r),this}removeEventListener(t,e){return e?this.off(t,e):this.off(t),this}emit(t,...e){var i,r;return null===(r=null===(i=this.view)||void 0===i?void 0:i.emit)||void 0===r||r.call(i,t,...e),super.emit(t,...e)}emitGrammarEvent(t,...e){return super.emit(t,...e)}evaluateTransform(t,e,i){if(!t||!t.length)return e;let r=e,n=0,s=t.length;for(;n<s;){let e=t[n];this.emit(pa.BEFORE_TRANSFORM,e.type),r=e.transform(e.isRawOptions?e.options:gG(e.options,i),r,i,this.view),n++,this.emit(pa.AFTER_TRANSFORM,e.type)}return r}set(t){return!1}id(t){return arguments.length?(this.view.grammars.unrecord(this),this._id=t,this.view.grammars.record(this),this):this._id}name(t){return arguments.length?(this._name=t,this):this._name}attach(t,e=1){return om(t).filter(t=>!ej(t)).forEach(i=>{var r;ej(t)||(i.targets.includes(this)||i.targets.push(this),this.references.set(i,(null!==(r=this.references.get(i))&&void 0!==r?r:0)+e))}),this}detach(t,e=1){return om(t).filter(t=>!ej(t)).forEach(t=>{let i=this.references.get(t)-e;i>0?this.references.set(t,i-1):(this.references.delete(t),t.targets.includes(this)&&(t.targets=t.targets.filter(t=>t!==this)))}),this}detachAll(){this.references.forEach((t,e)=>{this.detach(e,t)})}link(t){this.grammarSource=t}run(){var t;let e=null===(t=this.grammarSource)||void 0===t?void 0:t.output(),i=this.parameters();return this.evaluate(e,i)}commit(){this.view.commit(this)}parameters(){let t={};return this.references.forEach((e,i)=>{eO(i.id())&&(t[i.id()]=i.output())}),t}getSpec(){return this.spec}reuse(t){return this}clear(){this.spec=null,this.view=null}release(){this.clear()}setFunctionSpec(t,e){return ej(this.spec[e])||this.detach(gF(this.spec[e],this.view)),this.spec[e]=t,this.attach(gF(t,this.view)),this.commit(),this}}let gY=(t,e,i)=>{var r,n;if("callback"===t&&nx(e))return{references:[],value:{callback:e,dependency:[]}};if(!ej(e.data)){let t=i.getDataById(e.data);return{references:[t],value:t}}if(!ej(e.customized)){let t=i.getCustomizedById(e.customized);return{references:[t],value:t}}if(!ej(e.scale)){let t=i.getScaleById(e.scale);return{references:[t],value:t}}if((n=e)&&(n.signal||n.callback)){let t=gF(e,i);return{references:t,value:e.callback?{value:e.callback,dependency:t}:null!==(r=null==t?void 0:t[0])&&void 0!==r?r:e}}return{value:e}},gK=(t,e,i)=>{if(ej(e))return{value:e};if(eM(e)){let r=e.map(e=>gY(t,e,i));return{references:r.reduce((t,e)=>(e.references&&t.concat(e.references),t),[]),value:r.map(t=>t.value)}}return gY(t,e,i)},gZ=(t,e)=>{let i=d0.getTransform(t.type);if(!i)return;let r={},n=[];return Object.keys(t).forEach(i=>{var s;if("type"===i)return;let a=t[i];if("dependency"===i)return void((null==a?void 0:a.length)&&(n=n.concat(gD(a,e))));let o=gK(i,a,e);o&&((null===(s=o.references)||void 0===s?void 0:s.length)&&(n=n.concat(o.references)),r[i]=o.value)}),{markPhase:i.markPhase,transform:i.transform,canProgressive:i.canProgressive,type:i.type,options:r,references:n}},gX=(t,e)=>{if(null==t?void 0:t.length){let i=[],r=[];return t.forEach(t=>{var n;let s=gZ(t,e);s&&((null===(n=s.references)||void 0===n?void 0:n.length)&&(r=r.concat(s.references)),i.push(s))}),{transforms:i,refs:r}}return null},gq={csv:u7,dsv:u9,tsv:dt,json:(t,e={},i)=>{if(!eE(t))return om(t);try{return om(JSON.parse(t))}catch(t){return[]}}},gJ=(t,e)=>{if(!e||!gq[e.type])return om(t);let i="dsv"===e.type?{delimiter:e.delimiter}:{};return gq[e.type](t,i,new eH(new eA))};class gQ extends g${constructor(t,e,i){super(t),this.grammarType="data",this.spec={},this._dataIDKey=`VGRAMMAR_DATA_ID_KEY_${this.uid}`,this._loadTasks=[],this._postFilters=[],this.ingest=t=>{let e=function(t,e){if(ej(t))return t;if(nx(t))return t.call(null,e);if(t.signal){let i=t.signal;return eE(i)?null==e?void 0:e[i]:i.output()}return t.callback?t.callback.call(null,e):t}(t.format,this.parameters());return this._input=gJ(t.values,e),this._input},this.load=t=>{if(t.values)return this.ingest(t)},this.relay=t=>t[0],this._loadTasks=[],ej(e)||this.values(e,i)}parse(t){return super.parse(t),this._isLoaded=!1,this.source(t.source,t.format,!1),this.url(t.url,t.format,!1),this.values(t.values,t.format,!1),this.transform(t.transform),this.parseLoad(t),this.commit(),this}parseDataSource(t){let e=[],i=[],r=t.format?gF(t.format,this.view)[0]:null;if(r&&e.push(r),t.values){let r=gF(t.values,this.view)[0];r&&e.push(r),i.push({type:"ingest",transform:this.ingest,isRawOptions:!0,options:{values:t.values,format:t.format}})}else if(t.url){let n=gF(t.url,this.view)[0];n&&e.push(n),i.push({type:"load",transform:this.load,options:{url:null!=n?n:t.url,format:null!=r?r:t.format}})}else if(t.source){let r=[];om(t.source).forEach(t=>{let i=gH(t)?t:this.view.getDataById(t);i&&(e.push(i),r.push(i))}),r.length&&(i.push({type:"relay",transform:this.relay,options:r}),this.grammarSource=r[0])}return{transforms:i,refs:e}}evaluate(t,e){this.view.emit(pa.BEFORE_EVALUATE_DATA);let i=this._isLoaded?this.transforms:this._loadTasks.concat(this.transforms);this.grammarSource&&(this._input=t);let r=this.evaluateTransform(i,this._input,e),n=this._evaluateFilter(r,e);return this.setValues(n),this._isLoaded=!0,this.view.emit(pa.AFTER_EVALUATE_DATA),this}output(){return this._values}getDataIDKey(){return this._dataIDKey}values(t,e,i=!0){let r=Object.assign({},this.spec,{values:t,format:e});return ej(t)||(r.url=void 0,r.source=void 0),i?this.parseLoad(r):this}url(t,e,i=!0){let r=Object.assign({},this.spec,{url:t,format:e});return ej(t)||(r.values=void 0,r.source=void 0),i?this.parseLoad(r):this}source(t,e,i=!0){let r=Object.assign({},this.spec,{source:t,format:e});return ej(t)||(r.values=void 0,r.url=void 0),i?this.parseLoad(r):this}parseLoad(t){this.detach(this.parseDataSource(this.spec).refs),this.spec=t;let e=this.parseDataSource(this.spec);return this.attach(e.refs),this._loadTasks=e.transforms,this._isLoaded=!1,this.commit(),this}setValues(t){this._values=om(t).map((t,e)=>{let i=t===Object(t)?t:{data:t};return i[this._dataIDKey]=e,i})}field(t){return this._values.map(e=>e[t])}transform(t){let e=gX(this.spec.transform,this.view);e&&(this.detach(e.refs),this.transforms=[]),this.spec.transform=t;let i=gX(this.spec.transform,this.view);return i&&(this.attach(i.refs),this.transforms=i.transforms),this.commit(),this}getValue(){return this._values}getInput(){return this._input}addDataFilter(t){return this._postFilters=this._postFilters.concat(om(t)),this._postFilters.sort((t,e)=>{var i,r;return(null!==(i=t.rank)&&void 0!==i?i:0)-(null!==(r=e.rank)&&void 0!==r?r:0)}),this}removeDataFilter(t){let e=om(t);return this._postFilters=this._postFilters.filter(t=>!e.includes(t)),this}_evaluateFilter(t,e){return this._postFilters.reduce((t,i)=>i.filter(t,e),t)}reuse(t){return t.grammarType!==this.grammarType||(this._isLoaded=!1,this._values=t.output()),this}clear(){super.clear(),this._input=null,this._values=null}}let g0="window",g1="view",g2={trap:!1},g3="width",g5="height",g4="viewWidth",g8="viewHeight",g6="padding",g9="viewBox",g7="autoFit";function ft(t,e,i,r){let n,s;let a=t[e];for(;e>i&&(n=t[s=Math.floor((e-1)/2)],a&&n&&0>r(a,n));)t[e]=n,e=s;return t[e]=a}function fe(t,e,i,r){let n=e,s=null!=i?i:t.length,a=t[e],o,l=2*e+1;for(;l<s;)(o=l+1)<s&&r(t[l],t[o])>=0&&(l=o),t[e]=t[l],l=2*(e=l)+1;return t[e]=a,ft(t,e,n,r)}class fi{constructor(t){this.compare=t,this.nodes=[]}size(){return this.nodes.length}last(){return this.nodes[0]}validate(){for(let t=this.nodes.length-1;t>0;t-=1){let e=Math.floor((t-1)/2);if(this.compare(this.nodes[e],this.nodes[t])>0)return!1}return!0}push(t){if(this.nodes.includes(t)){let e=this.nodes.indexOf(t);return ft(this.nodes,e,0,this.compare),fe(this.nodes,e,null,this.compare)}return this.nodes.push(t),ft(this.nodes,this.nodes.length-1,0,this.compare)}remove(t){if(this.nodes.includes(t)){let e=this.nodes.indexOf(t);this.nodes=this.nodes.slice(0,e).concat(this.nodes.slice(e+1)),ft(this.nodes,e,0,this.compare),fe(this.nodes,e,null,this.compare)}}pop(){let t;let e=this.nodes.pop();return this.nodes.length?(t=this.nodes[0],this.nodes[0]=e,fe(this.nodes,0,null,this.compare)):t=e,t}clear(){this.nodes=[]}}let fr=(t,e,i)=>(t.fields=e||[],t.fname=i,t),fn=t=>e=>dq(e,t),fs=t=>{ex.getInstance().error(t)},fa=t=>{let e=[],i=t.length,r,n,s,a=null,o=0,l="";t+="";let h=()=>{e.push(l+t.substring(r,n)),l="",r=n+1};for(r=0,n=0;n<i;n+=1)if("\\"===(s=t[n]))l+=t.substring(r,n)+t.substring(++n,++n),r=n;else if(s===a)h(),a=null,o=-1;else{if(a)continue;r===o&&'"'===s||r===o&&"'"===s?(r=n+1,a=s):"."!==s||o?"["===s?(n>r&&h(),o=r=n+1):"]"===s&&(o||fs("Access path missing open bracket: "+t),o>0&&h(),o=0,r=n+1):n>r?h():r=n+1}return o&&fs("Access path missing closing bracket: "+t),a&&fs("Access path missing closing quote: "+t),n>r&&(n+=1,h()),e},fo=(t,e,i={})=>{if(nx(t))return t;let r=fa(t),n=1===r.length?r[0]:t;return fr((i&&i.get||fn)(r),[n],e||n)},fl=(t,e,i={})=>{if(eM(t)){let r=t.map(t=>fo(t,e,i));return t=>r.map(e=>e(t))}return fo(t,e,i)};fl("id");let fh=fr(function(t){return t},[],"identity"),fu=fr(function(){return 0},[],"zero");fr(function(){return 1},[],"one"),fr(function(){return!0},[],"true"),fr(function(){return!1},[],"false"),fr(function(){return{}},[],"emptyObject");class fd{constructor(t){this.list=[],this.ids={},this.idFunc=t||fh}add(t){let e=this.idFunc(t);return this.ids[e]||(this.ids[e]=1,this.list.push(t)),this}remove(t){let e=this.idFunc(t);return this.ids[e]&&(this.ids[e]=0,this.list=this.list.filter(e=>e!==t)),this}forEach(t,e){e?this.list.slice().reverse().forEach(t):this.list.forEach(t)}filter(t){return this.list.filter(t)}get length(){return this.list.length}getElementByIndex(t){return this.list[t]}}class fc{constructor(){this.grammars=[],this.logger=ex.getInstance(),this._curRank=0,this._committed=new fd(t=>t.uid),this._heap=new fi((t,e)=>(null==t?void 0:t.qrank)-(null==e?void 0:e.qrank)),this._beforeRunner=null,this._afterRunner=null,this._updateCounter=0,this._finishFirstRender=!1}add(t){if(t)return this._setRankOfGrammar(t),this.commit(t),!this.grammars.includes(t)&&(this.grammars.push(t),!0)}remove(t){t&&(this._committed.remove(t),this._heap.remove(t),this.grammars=this.grammars.filter(e=>e!==t))}_setRankOfGrammar(t){t&&(t.rank=++this._curRank)}_reRank(t){let e=[t];for(;e.length;){let i=e.pop();this._setRankOfGrammar(i);let r=i.targets;r&&r.forEach(i=>{e.push(i),i===t&&this.logger.error("Cycle detected in dataflow graph.")})}}_enqueue(t){t&&(t.qrank=t.rank,this._heap.push(t))}_logGrammarRunInfo(t){if(this.logger.canLogError()){let e=[{key:"id",value:t.id()},{key:"name",value:t.name()}].reduce((t,e,i)=>ej(e.value)?t:`${t}${i?" , ":""}${e.key}: ${e.value}`,"");this.logger.debug("Run Operator: ",t,e)}}hasCommitted(){return!!this._committed.length}commit(t){return this._committed.add(t),this}_beforeEvaluate(){this.grammars.forEach(t=>{t.targets.some(e=>(null==e?void 0:e.rank)<(null==t?void 0:t.rank))&&this._reRank(t)}),this._committed.forEach(t=>this._enqueue(t)),this._committed=new fd(t=>t.uid)}_enqueueTargets(t){t.targets&&t.targets.length&&this._finishFirstRender&&t.targets.forEach(t=>this._enqueue(t))}evaluate(){if(this._beforeRunner&&this._beforeRunner(this),!this._committed.length)return this.logger.info("Dataflow invoked, but nothing to do."),!1;this._updateCounter+=1;let t,e,i=0;for(this.logger.canLogInfo()&&(e=Date.now(),this.logger.debug(`-- START PROPAGATION (${this._updateCounter}) -----`)),this._beforeEvaluate();this._heap.size()>0;)(t=this._heap.pop())&&(t.rank===t.qrank?(t.run(),this._logGrammarRunInfo(t),this._enqueueTargets(t),i+=1):this._enqueue(t));return this.logger.canLogInfo()&&(e=Date.now()-e,this.logger.info(`> ${i} grammars updated; ${e} ms`)),this._afterRunner&&this._afterRunner(this),this._finishFirstRender=!0,!0}runBefore(t){this._beforeRunner=t}runAfter(t){this._afterRunner=t}release(){this._heap&&(this._heap.clear(),this._heap=null),this.logger=null,this._committed=null}}let fp=(t,e,i,r,n)=>{let s=t=>{if(n||!t||r&&!r(t)||i.call(null,t),t.markType===c8.group){let i=t[e];i&&i.forEach(t=>{s(t)})}n&&t&&(!r||r(t))&&i.call(null,t)};s(t)},fg="__vgrammar_scene_item__",ff=[c8.line,c8.area],fm=[c8.arc3d,c8.rect3d,c8.pyramid3d],fv=[{}],fy=["key"],f_="VGRAMMAR_IMMEDIATE_ANIMATION",fb="quintInOut",fx={stopWhenStateChange:!1,immediatelyApply:!0},fS="_mo_hide_",fk=t=>void 0===t;class fA extends nk{constructor(){super(...arguments),this.client={x:0,y:0},this.movement={x:0,y:0},this.offset={x:0,y:0},this.global={x:0,y:0},this.screen={x:0,y:0}}get clientX(){return this.client.x}get clientY(){return this.client.y}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,r,n,s,a,o,l,h,u,d,c,p,g){throw Error("Method not implemented.")}}class fw extends fA{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw Error("getPredictedEvents is not supported!")}clone(){var t,e,i;let r=new fw(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null===(t=this.manager)||void 0===t||t.copyPointerData(this,r),null===(e=this.manager)||void 0===e||e.copyMouseData(this,r),null===(i=this.manager)||void 0===i||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();let n=this.composedDetailPath();return r.detailPath=n&&n.slice(),r.type=this.type,r}}class fM extends fA{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}clone(){var t,e,i;let r=new fM(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,null===(t=this.manager)||void 0===t||t.copyWheelData(this,r),null===(e=this.manager)||void 0===e||e.copyMouseData(this,r),null===(i=this.manager)||void 0===i||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();let n=this.composedDetailPath();return r.detailPath=n&&n.slice(),r.type=this.type,r}}fM.DOM_DELTA_PIXEL=0,fM.DOM_DELTA_LINE=1,fM.DOM_DELTA_PAGE=2;let fC="object"==typeof performance&&performance.now?performance:Date;function fT(t){return"mouse"===t||"pen"===t}class fE{constructor(t,e){this.dispatch=new(em()),this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=(t,e)=>{if(!(t instanceof fw))return void ex.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.createPointerEvent(t,t.type,e);if(this.dispatchEvent(i,"pointerdown"),"touch"===i.pointerType)this.dispatchEvent(i,"touchstart");else if(fT(i.pointerType)){let t=2===i.button;this.dispatchEvent(i,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=i.composedPath(),this.freeEvent(i)},this.onPointerMove=(t,e)=>{var i,r;if(!(t instanceof fw))return void ex.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let n=this.createPointerEvent(t,t.type,e),s=fT(n.pointerType),a=this.trackingData(t.pointerId),o=this.findMountedTarget(a.overTargets);if(a.overTargets&&o&&o!==this.rootTarget&&o!==n.target){let e="mousemove"===t.type?"mouseout":"pointerout",i=this.createPointerEvent(t,e,o||void 0);if(this.dispatchEvent(i,"pointerout"),s&&this.dispatchEvent(i,"mouseout"),!n.composedPath().includes(o)){let e=this.createPointerEvent(t,"pointerleave",o||void 0);for(e.eventPhase=e.AT_TARGET;e.target&&!n.composedPath().includes(e.target);)e.currentTarget=e.target,this.notifyTarget(e),s&&this.notifyTarget(e,"mouseleave"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(i)}if(o!==n.target){let e="mousemove"===t.type?"mouseover":"pointerover",i=this.clonePointerEvent(n,e);this.dispatchEvent(i,"pointerover"),s&&this.dispatchEvent(i,"mouseover");let r=null==o?void 0:o.parent;for(;r&&r!==this.rootTarget.parent&&r!==n.target;)r=r.parent;if(!r||r===this.rootTarget.parent){let t=this.clonePointerEvent(n,"pointerenter");t.eventPhase=t.AT_TARGET;let e=t.target,i=new Set,r=o;for(;r&&r!==this.rootTarget;)i.add(r),r=r.parent;for(;e&&e!==o&&e!==this.rootTarget.parent;)i.has(e)||(t.currentTarget=e,this.notifyTarget(t),s&&this.notifyTarget(t,"mouseenter")),e=e.parent;this.freeEvent(t)}this.freeEvent(i)}this.dispatchEvent(n,"pointermove"),"touch"===n.pointerType&&this.dispatchEvent(n,"touchmove"),s&&(this.dispatchEvent(n,"mousemove"),this.cursorTarget=n.target,this.cursor=(null===(r=null===(i=n.target)||void 0===i?void 0:i.attribute)||void 0===r?void 0:r.cursor)||this.rootTarget.getCursor()),a.overTargets=n.composedPath(),this.freeEvent(n)},this.onPointerOver=(t,e)=>{var i,r;if(!(t instanceof fw))return void ex.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let n=this.trackingData(t.pointerId),s=this.createPointerEvent(t,t.type,e),a=fT(s.pointerType);this.dispatchEvent(s,"pointerover"),a&&this.dispatchEvent(s,"mouseover"),"mouse"===s.pointerType&&(this.cursorTarget=s.target,this.cursor=(null===(r=null===(i=s.target)||void 0===i?void 0:i.attribute)||void 0===r?void 0:r.cursor)||this.rootTarget.getCursor());let o=this.clonePointerEvent(s,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),a&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;n.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(o)},this.onPointerOut=(t,e)=>{if(!(t instanceof fw))return void ex.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.trackingData(t.pointerId);if(i.overTargets){let e=fT(t.pointerType),r=this.findMountedTarget(i.overTargets),n=this.createPointerEvent(t,"pointerout",r||void 0);this.dispatchEvent(n),e&&this.dispatchEvent(n,"mouseout");let s=this.createPointerEvent(t,"pointerleave",r||void 0);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),e&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;i.overTargets=[],this.freeEvent(n),this.freeEvent(s)}this.cursorTarget=null,this.cursor=""},this.onPointerUp=(t,e)=>{var i;if(!(t instanceof fw))return void ex.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let r=fC.now(),n=this.createPointerEvent(t,t.type,e);if(this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)this.dispatchEvent(n,"touchend");else if(fT(n.pointerType)){let t=2===n.button;this.dispatchEvent(n,t?"rightup":"mouseup")}let s=this.trackingData(t.pointerId),a=this.findMountedTarget(s.pressTargetsByButton[t.button]),o=a;if(a&&!n.composedPath().includes(a)){let e=a;for(;e&&!n.composedPath().includes(e);){if(n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)this.notifyTarget(n,"touchendoutside");else if(fT(n.pointerType)){let t=2===n.button;this.notifyTarget(n,t?"rightupoutside":"mouseupoutside")}e=e.parent}delete s.pressTargetsByButton[t.button],o=e}if(o){let e=this.clonePointerEvent(n,"click");e.target=o,e.path=[],e.detailPath=[],s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:e.target,timeStamp:r});let a=s.clicksByButton[t.button];a.target===e.target&&r-a.timeStamp<(null!==(i=this._config.clickInterval)&&void 0!==i?i:200)?++a.clickCount:a.clickCount=1,a.target=e.target,a.timeStamp=r,e.detail=a.clickCount,fT(e.pointerType)?(this.dispatchEvent(e,"click"),2===a.clickCount&&this.dispatchEvent(e,"dblclick")):"touch"===e.pointerType&&(this.dispatchEvent(e,"tap"),2===a.clickCount&&this.dispatchEvent(e,"dbltap")),this.dispatchEvent(e,"pointertap"),this.freeEvent(e)}this.freeEvent(n)},this.onPointerUpOutside=(t,e)=>{if(!(t instanceof fw))return void ex.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");let i=this.trackingData(t.pointerId),r=this.findMountedTarget(i.pressTargetsByButton[t.button]),n=this.createPointerEvent(t,t.type,e);if(r){let e=r;for(;e;)n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):fT(n.pointerType)&&this.notifyTarget(n,2===n.button?"rightupoutside":"mouseupoutside"),e=e.parent;delete i.pressTargetsByButton[t.button]}this.freeEvent(n)},this.onWheel=(t,e)=>{if(!(t instanceof fM))return void ex.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event");let i=this.createWheelEvent(t,e);this.dispatchEvent(i),this.freeEvent(i)},this.rootTarget=t,this.mappingTable={},this._config=Object.assign({clickInterval:200},e),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((t,e)=>t.priority-e.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){var e,i,r,n,s,a,o;let l;if(!this.rootTarget)return;let h=this.mappingTable[t.type],u=`${t.canvasX}-${t.canvasY}`;if((null===(e=this._prePointTargetCache)||void 0===e?void 0:e[u])&&(null===(r=null===(i=this._prePointTargetCache)||void 0===i?void 0:i[u])||void 0===r?void 0:r.stage)&&(null===(s=null===(n=this._prePointTargetCache)||void 0===n?void 0:n[u])||void 0===s?void 0:s.stage.renderCount)===(null===(a=this._prePointTargetCache)||void 0===a?void 0:a.stageRenderCount)?l=this._prePointTargetCache[u]:(l=this.pickTarget(t.viewX,t.viewY,t),t.pickParams||(this._prePointTargetCache={[u]:l,stageRenderCount:null!==(o=null==l?void 0:l.stage.renderCount)&&void 0!==o?o:-1})),h)for(let e=0,i=h.length;e<i;e++)h[e].fn(t,l);else ex.getInstance().warn(`[EventManager]: Event mapping not defined for ${t.type}`)}propagate(t,e){if(!t.target)return;let i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,n=i.length-1;r<n;r++)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}propagationPath(t){let e=[t];for(let i=0;i<2048&&t!==this.rootTarget&&t.parent;i++){if(!t.parent)throw Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}notifyTarget(t,e){if(this.pauseNotify)return;e=null!=e?e:t.type;let i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){var r,n;let s=this.allocateEvent(fw);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=i||this.pickTarget(null!==(r=s.viewX)&&void 0!==r?r:s.global.x,null!==(n=s.viewY)&&void 0!==n?n:s.global.y,s),"string"==typeof e&&(s.type=e),s}createWheelEvent(t,e){var i,r;let n=this.allocateEvent(fM);return this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=e||this.pickTarget(null!==(i=n.viewX)&&void 0!==i?i:n.global.x,null!==(r=n.viewY)&&void 0!==r?r:n.global.y,n),n}clonePointerEvent(t,e){let i=this.allocateEvent(fw);i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice();let r=t.composedDetailPath();return i.detailPath=r&&r.slice(),i.type=null!=e?e:i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof fw&&e instanceof fw&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof fA&&e instanceof fA&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach(i=>{e[i].x=t[i].x,e[i].y=t[i].y}))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=fC.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);let i=(null===(e=this.eventPool.get(t))||void 0===e?void 0:e.pop())||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=[],i.detailPath=[],i.target=null,i}freeEvent(t){var e;if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventManager!");let i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),null===(e=this.eventPool.get(i))||void 0===e||e.push(t)}notifyListeners(t,e){let i=t.currentTarget._events[e];if(i){if("fn"in i)i.once&&t.currentTarget.removeEventListener(e,i.fn,{once:!0}),i.fn.call(i.context,t);else for(let r=0,n=i.length;r<n&&!t.propagationImmediatelyStopped;r++)i[r].once&&t.currentTarget.removeEventListener(e,i[r].fn,{once:!0}),i[r].fn.call(i[r].context,t)}this.emitDelegation(t,e)}emitDelegation(t,e){let i=t.currentTarget._events["*"];if(i){if("fn"in i)i.fn.call(i.context,t,e);else for(let r=0,n=i.length;r<n&&!t.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,t,e)}}pickTarget(t,e,i){let r;let n=this.rootTarget.pick(t,e);return r=n&&n.graphic?n.graphic:n&&n.group?n.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,i&&(i.pickParams=n.params),r}release(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}}let fO={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class fP{constructor(t){this.resolution=1,this.onPointerDown=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(!t.cancelable&&"cancelable"in t||t.preventDefault());for(let t=0,i=e.length;t<i;t++){let i=e[t],r=this.bootstrapEvent(this.rootPointerEvent,i);this.manager.mapEvent(r)}this.setCursor(this.manager.cursor,this.manager.cursorTarget)},this.onPointerMove=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType||this.isEventOutsideOfTargetElement(t))return;let e=this.normalizeToPointerData(t);for(let t=0,i=e.length;t<i;t++){let i=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.manager.mapEvent(i)}this.setCursor(this.manager.cursor,this.manager.cursorTarget)},this.onPointerUp=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.isEventOutsideOfTargetViewPort(t)?"outside":"",i=this.normalizeToPointerData(t);for(let t=0,r=i.length;t<r;t++){let r=this.bootstrapEvent(this.rootPointerEvent,i[t]);r.type+=e,this.manager.mapEvent(r)}this.setCursor(this.manager.cursor,this.manager.cursorTarget)},this.onPointerOverOut=t=>{if(this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=this.normalizeToPointerData(t);for(let t=0,i=e.length;t<i;t++){let i=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.manager.mapEvent(i)}this.setCursor(this.manager.cursor,this.manager.cursorTarget)},this.onWheel=t=>{let e=this.normalizeWheelEvent(t);this.manager.mapEvent(e)};let{targetElement:e,resolution:i,rootNode:r,global:n,autoPreventDefault:s=!1,clickInterval:a,supportsTouchEvents:o=n.supportsTouchEvents,supportsPointerEvents:l=n.supportsPointerEvents}=t;this.manager=new fE(r,{clickInterval:a}),this.globalObj=n,this.supportsPointerEvents=l,this.supportsTouchEvents=o,this.supportsMouseEvents=n.supportsMouseEvents,this.applyStyles=n.applyStyles,this.autoPreventDefault=s,this.eventsAdded=!1,this.rootPointerEvent=new fw,this.rootWheelEvent=new fM,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=i,this.setTargetElement(e)}release(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}setCursor(t,e){if(!e&&!this.manager.rootTarget.window._handler.canvas.controled)return;t||(t="default");let{applyStyles:i,domElement:r}=this;if(this.currentCursor===t)return;this.currentCursor=t;let n=this.cursorStyles[t];n?"string"==typeof n&&i?r.style.cursor=n:"function"==typeof n?n(t):"object"==typeof n&&i&&Object.assign(r.style,n):i&&eE(t)&&!nv(this.cursorStyles,t)&&(r.style.cursor=t)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;let{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.getDocument().addEventListener("pointermove",this.onPointerMove,!0),t.getDocument().addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.getDocument().addEventListener("mousemove",this.onPointerMove,!0),t.getDocument().addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;let{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.getDocument().removeEventListener("pointermove",this.onPointerMove,!0),t.getDocument().removeEventListener("pointerup",this.onPointerUp,!0)):(e.removeEventListener("pointermove",this.onPointerMove,!0),e.removeEventListener("pointerup",this.onPointerUp,!0)),e.removeEventListener("pointerdown",this.onPointerDown,!0),e.removeEventListener("pointerleave",this.onPointerOverOut,!0),e.removeEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.getDocument().removeEventListener("mousemove",this.onPointerMove,!0),t.getDocument().removeEventListener("mouseup",this.onPointerUp,!0)):(e.removeEventListener("mousemove",this.onPointerMove,!0),e.removeEventListener("mouseup",this.onPointerUp,!0)),e.removeEventListener("mousedown",this.onPointerDown,!0),e.removeEventListener("mouseout",this.onPointerOverOut,!0),e.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.removeEventListener("touchstart",this.onPointerDown,!0),e.removeEventListener("touchend",this.onPointerUp,!0),e.removeEventListener("touchmove",this.onPointerMove,!0)),e.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapToViewportPoint(t){return this.domElement.pointTransform?this.domElement.pointTransform(t.x,t.y):t}mapToCanvasPoint(t){var e,i;let r=null===(e=this.globalObj)||void 0===e?void 0:e.mapToCanvasPoint(t,this.domElement);if(r)return r;let n=0,s=0;if(t.changedTouches){let e=null!==(i=t.changedTouches[0])&&void 0!==i?i:{};n=e.clientX||0,s=e.clientY||0}else n=t.clientX||0,s=t.clientY||0;let a=this.domElement.getBoundingClientRect();return{x:n-a.left,y:s-a.top}}normalizeToPointerData(t){let e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(let i=0,r=t.changedTouches.length;i<r;i++){let r=t.changedTouches[i];fk(r.button)&&(r.button=0),fk(r.buttons)&&(r.buttons=1),fk(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),fk(r.width)&&(r.width=r.radiusX||1),fk(r.height)&&(r.height=r.radiusY||1),fk(r.tiltX)&&(r.tiltX=0),fk(r.tiltY)&&(r.tiltY=0),fk(r.pointerType)&&(r.pointerType="touch"),fk(r.pointerId)&&(r.pointerId=r.identifier||0),fk(r.pressure)&&(r.pressure=r.force||.5),fk(r.twist)&&(r.twist=0),fk(r.tangentialPressure)&&(r.tangentialPressure=0),fk(r.layerX)&&(r.layerX=r.offsetX=r.clientX),fk(r.layerY)&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else this.globalObj.supportsMouseEvents&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof PointerEvent)||(fk(t.isPrimary)&&(t.isPrimary=!0),fk(t.width)&&(t.width=1),fk(t.height)&&(t.height=1),fk(t.tiltX)&&(t.tiltX=0),fk(t.tiltY)&&(t.tiltY=0),fk(t.pointerType)&&(t.pointerType="mouse"),fk(t.pointerId)&&(t.pointerId=1),fk(t.pressure)&&(t.pressure=.5),fk(t.twist)&&(t.twist=0),fk(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),e.push(t);return e}normalizeWheelEvent(t){let e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;let{x:i,y:r}=this.mapToCanvasPoint(t);e.canvas.x=i,e.canvas.y=r,e.global.x=i,e.global.y=r,e.offset.x=i,e.offset.y=r;let{x:n,y:s}=this.mapToViewportPoint(e);return e.viewport.x=n,e.viewport.y=s,e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);let{x:i,y:r}=this.mapToCanvasPoint(e);t.canvas.x=i,t.canvas.y=r,t.global.x=i,t.global.y=r,t.offset.x=i,t.offset.y=r;let{x:n,y:s}=this.mapToViewportPoint(t);return t.viewport.x=n,t.viewport.y=s,t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=fO[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=fC.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}isEventOutsideOfTargetViewPort(t){if(this.isEventOutsideOfTargetElement(t))return!0;if(this.domElement.getViewBox){let e=this.mapToViewportPoint(this.mapToCanvasPoint(t)),i=this.domElement.getViewBox(),r=i.width(),n=i.height();return!(e.x<r&&e.y<n&&e.x>0&&e.y>0)}return!1}isEventOutsideOfTargetElement(t){let e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}pauseTriggerEvent(){this.manager.pauseNotify=!0}resumeTriggerEvent(){this.manager.pauseNotify=!1}}class fR{constructor(){this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=eV.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t,rj.graphicService.hooks.onAttributeUpdate.tap(this.key,e=>{e.glyphHost&&(e=e.glyphHost),e.stage===t.stage&&null!=e.stage&&e.stage.renderNextFrame()}),rj.graphicService.hooks.onSetStage.tap(this.key,e=>{e.glyphHost&&(e=e.glyphHost),e.stage===t.stage&&null!=e.stage&&e.stage.renderNextFrame()})}deactivate(t){rj.graphicService.hooks.onAttributeUpdate.taps=rj.graphicService.hooks.onAttributeUpdate.taps.filter(t=>t.name!==this.key),rj.graphicService.hooks.onSetStage.taps=rj.graphicService.hooks.onSetStage.taps.filter(t=>t.name!==this.key)}}class fB{constructor(){this.name="ViewTransform3dPlugin",this.activeEvent="onRegister",this._uid=eV.GenAutoIncrementId(),this.key=this.name+this._uid,this.onMouseDown=t=>{this.option3d||(this.option3d=this.pluginService.stage.option3d),this.option3d&&(this.mousedown=!0,this.pageX=t.page.x,this.pageY=t.page.y)},this.onMouseUp=t=>{this.option3d||(this.option3d=this.pluginService.stage.option3d),this.option3d&&(this.mousedown=!1)},this.onMouseMove=t=>{var e,i;let r=this.pluginService.stage;if(this.option3d||(this.option3d=r.option3d),this.option3d&&this.mousedown){if(this.pageX&&this.pageY){let n=t.page.x-this.pageX,s=t.page.y-this.pageY;this.pageX=t.page.x,this.pageY=t.page.y;this.option3d.alpha=(null!==(e=this.option3d.alpha)&&void 0!==e?e:0)+n/100,this.option3d.beta=(null!==(i=this.option3d.beta)&&void 0!==i?i:0)+s/100,r.set3dOptions(this.option3d),r.renderNextFrame()}else this.pageX=t.page.x,this.pageY=t.page.y}}}activate(t){this.pluginService=t;let e=t.stage;this.option3d=e.option3d,e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("mouseup",this.onMouseUp),e.addEventListener("mousemove",this.onMouseMove)}deactivate(t){let e=t.stage;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("mouseup",this.onMouseUp),e.removeEventListener("mousemove",this.onMouseMove)}}class fI{constructor(){this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=eV.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t,rj.graphicService.hooks.onAddIncremental.tap(this.key,(e,i,r)=>{e.glyphHost&&(e=e.glyphHost),e.stage===t.stage&&null!=e.stage&&(this.nextUserParams.startAtId=i._uid,this.renderNextFrame(i))}),rj.graphicService.hooks.onClearIncremental.tap(this.key,(e,i)=>{e.stage===t.stage&&null!=e.stage&&(this.nextUserParams.startAtId=e._uid,this.nextUserParams.restartIncremental=!0,this.renderNextFrame(e))})}deactivate(t){rj.graphicService.hooks.onAddIncremental.taps=rj.graphicService.hooks.onAddIncremental.taps.filter(t=>t.name!==this.key),rj.graphicService.hooks.onClearIncremental.taps=rj.graphicService.hooks.onClearIncremental.taps.filter(t=>t.name!==this.key)}renderNextFrame(t){this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,rj.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){let t=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach(e=>{let i=e.layer;if(!i||!e.layer.subLayers)return;let r=e.layer.subLayers.get(e._uid);r&&r.drawContribution&&r.drawContribution.draw(t.renderService,Object.assign({stage:t,layer:i,viewBox:t.window.getViewBox(),transMatrix:t.window.getViewBoxTransform(),clear:"transparent",renderService:t.renderService,updateBounds:!1,startAtId:e._uid,context:r.layer.getNativeHandler().getContext()},this.nextUserParams))}),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}let fL=(t,e)=>{let{x1:i,x2:r,y1:n,y2:s}=t,a=Math.abs(r-i),o=Math.abs(s-n),l=(i+r)/2,h=(n+s)/2,u=0,d=0;switch(e){case"top":case"inside-top":d=-.5;break;case"bottom":case"inside-bottom":d=.5;break;case"left":case"inside-left":u=-.5;break;case"right":case"inside-right":u=.5;break;case"top-right":u=.5,d=-.5;break;case"top-left":u=-.5,d=-.5;break;case"bottom-right":u=.5,d=.5;break;case"bottom-left":u=-.5,d=.5}return{x:l+=u*a,y:h+=d*o}};class fD{constructor(){this.name="HtmlAttributePlugin",this.activeEvent="onRegister",this._uid=eV.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={},this.renderId=0}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,e=>{e&&e===this.pluginService.stage&&this.drawHTML(t.stage.renderService)})}deactivate(t){t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter(t=>t.name!==this.key),rj.graphicService.hooks.onRemove.unTap(this.key),rj.graphicService.hooks.onRelease.unTap(this.key),this.release()}getWrapContainer(t,e,i){let r;return r=e?"string"==typeof e?rj.global.getElementById(e):e:t.window.getContainer(),{wrapContainer:rj.global.createDom(Object.assign({tagName:"div",parent:r},i)),nativeContainer:r}}parseDefaultStyleFromGraphic(t){return function(t){let e={},i=t=>/^\d+(\.\d+)?$/.test(`${t}`)?`${t}px`:`${t}`;return["textAlign","fontFamily","fontVariant","fontStyle","fontWeight"].forEach(i=>{t[i]&&(e[aC(i)]=t[i])}),["fontSize","lineHeight"].forEach(r=>{let n=aC(r);ej(t[r])||(e[n]=i(t[r]))}),eO(t.maxLineWidth)&&(e["max-width"]=i(t.maxLineWidth)),t.underline?e["text-decoration"]="underline":t.lineThrough&&(e["text-decoration"]="line-through"),t.fill&&eE(t.fill)&&(e.color=t.fill),e}("text"===t.type&&t.attribute?t.attribute:nf(t).text)}getTransformOfText(t){let e=nf(t).text,{textAlign:i=e.textAlign,textBaseline:r=e.textBaseline}=t.attribute,{rotateDeg:n,scaleX:s,scaleY:a}=t.globalTransMatrix.toTransformAttrs(),o={left:"0",start:"0",end:"-100%",center:"-50%",right:"-100%",top:"0",middle:"-50%",bottom:"-100%",alphabetic:"-79%"},l={left:"0",start:"0",end:"100%",center:"50%",right:"100%",top:"0",middle:"50%",bottom:"100%",alphabetic:"79%"};return{textAlign:i,transform:`translate(${o[i]},${o[r]}) rotate(${n}deg) scaleX(${s}) scaleY(${a})`,transformOrigin:`${l[i]} ${l[r]}`}}updateStyleOfWrapContainer(t,e,i,r,n){let{pointerEvents:s}=n,a=this.parseDefaultStyleFromGraphic(t);a.display=!1!==t.attribute.visible?"block":"none",a.pointerEvents=!0===s?"all":s||"none",i.style.position||(i.style.position="absolute",r.style.position="relative");let o=0,l=0,h=t.globalAABBBounds,u=n.anchorType;if(ej(u)&&(u="text"===t.type?"position":"boundsLeftTop"),"boundsLeftTop"===u&&(u="top-left"),"position"===u||h.empty()){let e=t.globalTransMatrix;o=e.e,l=e.f}else{let t=fL(h,u);o=t.x,l=t.y}let d=rj.global.getElementTopLeft(r,!1),c=e.window.getTopLeft(!1),p=e.viewBox,g=o+c.left-d.left+p.x1,f=l+c.top-d.top+p.y1;if(a.left=`${g}px`,a.top=`${f}px`,"text"===t.type&&"position"===u&&(a=Object.assign(Object.assign({},a),this.getTransformOfText(t))),nx(n.style)){let e=n.style({top:f,left:g,width:h.width(),height:h.height()},t,i);e&&(a=Object.assign(Object.assign({},a),e))}else nb(n.style)?a=Object.assign(Object.assign({},a),n.style):eE(n.style)&&n.style&&(a=Object.assign(Object.assign({},a),aM(n.style)));rj.global.updateDom(i,{width:n.width,height:n.width,style:a})}clearCacheContainer(){this.htmlMap&&Object.keys(this.htmlMap).forEach(t=>{this.htmlMap[t]&&this.htmlMap[t].renderId!==this.renderId&&this.removeElement(t)}),this.renderId+=1}drawHTML(t){"browser"===rj.global.env&&(t.renderTreeRoots.sort((t,e)=>{var i,r;return(null!==(i=t.attribute.zIndex)&&void 0!==i?i:rk.zIndex)-(null!==(r=e.attribute.zIndex)&&void 0!==r?r:rk.zIndex)}).forEach(t=>{this.renderGroupHTML(t)}),this.clearCacheContainer())}renderGroupHTML(t){this.renderGraphicHTML(t),t.forEachChildren(t=>{t.isContainer?this.renderGroupHTML(t):this.renderGraphicHTML(t)})}removeElement(t){if(!this.htmlMap||!this.htmlMap[t])return;let{wrapContainer:e}=this.htmlMap[t];e&&rj.global.removeDom(e),this.htmlMap[t]=null}renderGraphicHTML(t){var e;let{html:i}=t.attribute;if(!i)return;let r=t.stage;if(!r)return;let{dom:n,container:s}=i;if(!n)return;let a=ej(i.id)?`${null!==(e=t.id)&&void 0!==e?e:t._uid}_react`:i.id;if(this.htmlMap&&this.htmlMap[a]&&s&&s!==this.htmlMap[a].container&&this.removeElement(a),this.htmlMap&&this.htmlMap[a])"string"==typeof n?this.htmlMap[a].wrapContainer.innerHTML=n:n!==this.htmlMap[a].wrapContainer.firstChild&&(this.htmlMap[a].wrapContainer.removeChild(this.htmlMap[a].wrapContainer.firstChild),this.htmlMap[a].wrapContainer.appendChild(n));else{let{wrapContainer:t,nativeContainer:e}=this.getWrapContainer(r,s);t&&("string"==typeof n?t.innerHTML=n:t.appendChild(n),this.htmlMap||(this.htmlMap={}),this.htmlMap[a]={wrapContainer:t,nativeContainer:e,container:s,renderId:this.renderId})}if(!this.htmlMap||!this.htmlMap[a])return;let{wrapContainer:o,nativeContainer:l}=this.htmlMap[a];this.updateStyleOfWrapContainer(t,r,o,l,i),this.htmlMap[a].renderId=this.renderId}release(){"browser"===rj.global.env&&this.removeAllDom(this.pluginService.stage.defaultLayer)}removeAllDom(t){this.htmlMap&&(Object.keys(this.htmlMap).forEach(t=>{this.removeElement(t)}),this.htmlMap=null)}}let fF=new iI;class fj{constructor(){this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=eV.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,t=>{t&&t===this.pluginService.stage&&t.dirtyBounds.clear()}),rj.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(t,e,i,r)=>{t.glyphHost&&(t=t.glyphHost),e&&e===this.pluginService.stage&&e.renderCount&&(t.isContainer&&!t.shouldSelfChangeUpdateAABBBounds()||i&&(fF.setValue(r.x1,r.y1,r.x2,r.y2),e.dirty(fF,t.parent&&t.parent.globalTransMatrix)))}),rj.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(t,e,i,r,n)=>{e&&e===this.pluginService.stage&&e.renderCount&&(t.isContainer&&!n||e.dirty(r.globalAABBBounds))}),rj.graphicService.hooks.onRemove.tap(this.key,t=>{let e=t.stage;e&&e===this.pluginService.stage&&e.renderCount&&e&&e.dirty(t.globalAABBBounds)})}deactivate(t){rj.graphicService.hooks.beforeUpdateAABBBounds.taps=rj.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(t=>t.name!==this.key),rj.graphicService.hooks.afterUpdateAABBBounds.taps=rj.graphicService.hooks.afterUpdateAABBBounds.taps.filter(t=>t.name!==this.key),t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter(t=>t.name!==this.key),rj.graphicService.hooks.onRemove.taps=rj.graphicService.hooks.onRemove.taps.filter(t=>t.name!==this.key)}}let fN=new iI;class fz{constructor(){this.name="FlexLayoutPlugin",this.activeEvent="onRegister",this.id=eV.GenAutoIncrementId(),this.key=this.name+this.id,this.tempBounds=new iI}pauseLayout(t){this.pause=t}tryLayoutChildren(t){t.firstChild&&this.tryLayout(t.firstChild)}tryLayout(t,e=!0){if(this.pause)return;let i=t.parent;if(!(e||i&&t.needUpdateLayout()))return;let r=nf(i).group,{display:n=r.display}=i.attribute;if("flex"!==n)return;let{flexDirection:s=r.flexDirection,flexWrap:a=r.flexWrap,alignItems:o=r.alignItems,clip:l=r.clip}=i.attribute,{alignContent:h=null!=o?o:r.alignContent}=i.attribute,{width:u,height:d,justifyContent:c=r.justifyContent}=i.attribute,p=i.getChildren();if(null==u||null==d){let t=0,e=0,i=0;if(p.forEach(r=>{let n=this.getAABBBounds(r);n.empty()||("column"===s||"column-reverse"===s?(e+=n.height(),t=Math.max(t,n.width())):(t+=n.width(),e=Math.max(e,n.height())),i+=n.x1+n.y1+n.x2+n.y2)}),!isFinite(i))return;u=t,d=e}null==i.attribute.width?i.attribute.width=u:u=i.attribute.width,null==i.attribute.height?i.attribute.height=d:d=i.attribute.height,this.tempBounds.copy(i._AABBBounds);let g={main:{len:u,field:"x"},cross:{len:d,field:"y"}},f=g.main,m=g.cross;"column"!==s&&"column-reverse"!==s||(f.len=d,m.len=u,f.field="y",m.field="x"),"row-reverse"!==s&&"column-reverse"!==s||("flex-start"===c?c="flex-end":"flex-end"===c?c="flex-start":p.reverse());let v=0,y=0,_=[];p.forEach(t=>{let e=this.getAABBBounds(t);if(e.empty())return;let i="x"===f.field?e.width():e.height(),r="x"===m.field?e.width():e.height();_.push({mainLen:i,crossLen:r}),v+=i,y=Math.max(y,r)});let b=[];if(v>f.len&&"wrap"===a){let t=0,e=0;_.forEach(({mainLen:i,crossLen:r},n)=>{t+i>f.len?0===t?(b.push({idx:n,mainLen:t+i,crossLen:r}),t=0,e=0):(b.push({idx:n-1,mainLen:t,crossLen:e}),t=i,e=r):(t+=i,e=Math.max(e,r))}),b.push({idx:_.length-1,mainLen:t,crossLen:e})}else b.push({idx:_.length-1,mainLen:v,crossLen:y});let x=0;if(b.forEach(t=>{this.layoutMain(i,p,c,f,_,x,t),x=t.idx+1}),y=b.reduce((t,e)=>t+e.crossLen,0),1===b.length){let t={"flex-start":0,"flex-end":m.len,center:m.len/2};this.layoutCross(p,o,m,t,_,b[0],0)}else if("flex-start"===h){x=0;let t=0;b.forEach((e,i)=>{let r={"flex-start":t,"flex-end":t+e.crossLen,center:t+e.crossLen/2};this.layoutCross(p,"flex-start",m,r,_,b[i],x),x=e.idx+1,t+=e.crossLen})}else if("center"===h){x=0;let t=Math.max(0,(m.len-y)/2);b.forEach((e,i)=>{let r={"flex-start":t,"flex-end":t+e.crossLen,center:t+e.crossLen/2};this.layoutCross(p,"center",m,r,_,b[i],x),x=e.idx+1,t+=e.crossLen})}else if("space-around"===h){x=0;let t=Math.max(0,(m.len-y)/b.length/2),e=t;b.forEach((i,r)=>{let n={"flex-start":e,"flex-end":e+i.crossLen,center:e+i.crossLen/2};this.layoutCross(p,"flex-start",m,n,_,b[r],x),x=i.idx+1,e+=i.crossLen+2*t})}else if("space-between"===h){x=0;let t=Math.max(0,(m.len-y)/(2*b.length-2)),e=0;b.forEach((i,r)=>{let n={"flex-start":e,"flex-end":e+i.crossLen,center:e+i.crossLen/2};this.layoutCross(p,"flex-start",m,n,_,b[r],x),x=i.idx+1,e+=i.crossLen+2*t})}p.forEach((t,e)=>{t.addUpdateBoundTag(),t.addUpdatePositionTag(),t.clearUpdateLayoutTag()}),i.addUpdateLayoutTag();let S=this.getAABBBounds(i);l||this.tempBounds.equals(S)||this.tryLayout(i,!1)}getAABBBounds(t){this.skipBoundsTrigger=!0;let e=t.AABBBounds;return this.skipBoundsTrigger=!1,e}updateChildPos(t,e,i){return t+(null!=e?e:0)-i}layoutMain(t,e,i,r,n,s,a){if("flex-start"===i){let t=0;for(let i=s;i<=a.idx;i++){let s=t+function(t,e){return 0}(e[i],r.field),a=this.getAABBBounds(e[i]);a.empty()||(e[i].attribute[r.field]=this.updateChildPos(s,e[i].attribute[r.field],a[`${r.field}1`])),t+=n[i].mainLen}}else if("flex-end"===i){let t=r.len;for(let i=a.idx;i>=s;i--){let s=(t-=n[i].mainLen)+function(t,e){return 0}(e[i],r.field),a=this.getAABBBounds(e[i]);a.empty()||(e[i].attribute[r.field]=this.updateChildPos(s,e[i].attribute[r.field],a[`${r.field}1`]))}}else if("space-around"===i){if(a.mainLen>=r.len){let t=0;for(let i=s;i<=a.idx;i++){let s=t+function(t,e){return 0}(e[i],r.field),a=this.getAABBBounds(e[i]);a.empty()||(e[i].attribute[r.field]=this.updateChildPos(s,e[i].attribute[r.field],a[`${r.field}1`])),t+=n[i].mainLen}}else{let t=a.idx-s+1,i=(r.len-a.mainLen)/t/2,o=i;for(let t=s;t<=a.idx;t++){let s=o+function(t,e){return 0}(e[t],r.field),a=this.getAABBBounds(e[t]);a.empty()||(e[t].attribute[r.field]=this.updateChildPos(s,e[t].attribute[r.field],a[`${r.field}1`])),o+=n[t].mainLen+2*i}}}else if("space-between"===i){if(a.mainLen>=r.len){let t=0;for(let i=s;i<=a.idx;i++){let s=t+function(t,e){return 0}(e[i],r.field),a=this.getAABBBounds(e[i]);a.empty()||(e[i].attribute[r.field]=this.updateChildPos(s,e[i].attribute[r.field],a[`${r.field}1`])),t+=n[i].mainLen}}else{let t=a.idx-s+1,i=(r.len-a.mainLen)/(2*t-2),o=0;for(let t=s;t<=a.idx;t++){let s=o+function(t,e){return 0}(e[t],r.field),a=this.getAABBBounds(e[t]);a.empty()||(e[t].attribute[r.field]=this.updateChildPos(s,e[t].attribute[r.field],a[`${r.field}1`])),o+=n[t].mainLen+2*i}}}else if("center"===i){let t=(r.len-a.mainLen)/2;for(let i=s;i<=a.idx;i++){let s=t+function(t,e){return 0}(e[i],r.field),a=this.getAABBBounds(e[i]);a.empty()||(e[i].attribute[r.field]=this.updateChildPos(s,e[i].attribute[r.field],a[`${r.field}1`])),t+=n[i].mainLen}}}layoutCross(t,e,i,r,n,s,a){var o;for(let l=a;l<=s.idx;l++){let s=t[l],{alignSelf:a}=s.attribute;a&&"auto"!==a||(a=e);let h=this.getAABBBounds(s),u=null!==(o=r[a])&&void 0!==o?o:r["flex-start"];"flex-end"===a?h.empty()||(s.attribute[i.field]=this.updateChildPos(u-n[l].crossLen+function(t,e){return 0}(s,i.field),s.attribute[i.field],h[`${i.field}1`])):"center"===a?h.empty()||(s.attribute[i.field]=this.updateChildPos(u-n[l].crossLen/2+function(t,e){return 0}(s,i.field),s.attribute[i.field],h[`${i.field}1`])):h.empty()||(s.attribute[i.field]=this.updateChildPos(u+function(t,e){return 0}(s,i.field),s.attribute[i.field],h[`${i.field}1`]))}}activate(t){this.pluginService=t,rj.graphicService.hooks.onAttributeUpdate.tap(this.key,t=>{t.glyphHost&&(t=t.glyphHost),t.stage&&t.stage===this.pluginService.stage&&this.tryLayout(t,!1)}),rj.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(t,e,i,r)=>{t.glyphHost&&(t=t.glyphHost),e&&e===this.pluginService.stage&&t.isContainer&&!this.skipBoundsTrigger&&fN.copy(r)}),rj.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(t,e,i,r,n)=>{e&&e===this.pluginService.stage&&t.isContainer&&!this.skipBoundsTrigger&&(fN.equals(i)||this.tryLayout(t,!1))}),rj.graphicService.hooks.onSetStage.tap(this.key,t=>{t.glyphHost&&(t=t.glyphHost),this.tryLayout(t,!1)})}deactivate(t){rj.graphicService.hooks.onAttributeUpdate.taps=rj.graphicService.hooks.onAttributeUpdate.taps.filter(t=>t.name!==this.key),rj.graphicService.hooks.beforeUpdateAABBBounds.taps=rj.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(t=>t.name!==this.key),rj.graphicService.hooks.afterUpdateAABBBounds.taps=rj.graphicService.hooks.afterUpdateAABBBounds.taps.filter(t=>t.name!==this.key),rj.graphicService.hooks.onSetStage.taps=rj.graphicService.hooks.onSetStage.taps.filter(t=>t.name!==this.key)}}function fH(t,e){return 0}class fV{constructor(){this.time=0}static Avaliable(){return!0}avaliable(){return fV.Avaliable()}tick(t,e){this.time=Math.max(0,t+this.time),e(this,{once:!0})}tickTo(t,e){this.time=Math.max(0,t),e(this,{once:!0})}release(){this.timerId>0&&(this.timerId=-1)}getTime(){return this.time}}class fW{static Avaliable(){return!0}avaliable(){return fW.Avaliable()}tick(t,e){this.timerId=setTimeout(()=>{e(this)},t)}release(){this.timerId>0&&(clearTimeout(this.timerId),this.timerId=-1)}getTime(){return Date.now()}}class fG{static Avaliable(){return!!rj.global.getRequestAnimationFrame()}avaliable(){return fG.Avaliable()}tick(t,e){rj.global.getRequestAnimationFrame()(()=>{this.released||e(this)})}release(){this.released=!0}getTime(){return Date.now()}}(x=tb||(tb={}))[x.INITIAL=0]="INITIAL",x[x.RUNNING=1]="RUNNING",x[x.PAUSE=2]="PAUSE";let fU=new class t{set mode(t){this._mode!==t&&(this._mode=t,this.setupTickHandler())}get mode(){return this._mode}constructor(t=[]){this.handleTick=(t,e)=>{let{once:i=!1}=null!=e?e:{};this.ifCanStop()?this.stop():(this._handlerTick(t),i||t.tick(this.interval,this.handleTick))},this._handlerTick=t=>{let e=this.tickerHandler.getTime(),i=0;this.lastFrameTime>=0&&(i=e-this.lastFrameTime),this.lastFrameTime=e,this.status===tb.RUNNING&&(this.tickCounts++,this.timelines.forEach(t=>{t.tick(i)}))},this.init(),this.lastFrameTime=-1,this.tickCounts=0,this.timelines=t,this.autoStop=!0}init(){this.interval=NaN,this.status=tb.INITIAL,rj.global.hooks.onSetEnv.tap("default-ticker",()=>{this.initHandler()}),rj.global.env&&this.initHandler()}addTimeline(t){this.timelines.push(t)}remTimeline(t){this.timelines=this.timelines.filter(e=>e!==t)}initHandler(){if(this._mode)return null;let t=[{mode:"raf",cons:fG},{mode:"timeout",cons:fW},{mode:"manual",cons:fV}];for(let e=0;e<t.length;e++)if(t[e].cons.Avaliable()){this.mode=t[e].mode;break}return null}setupTickHandler(){let t;switch(this._mode){case"raf":t=new fG;break;case"timeout":t=new fW;break;case"manual":t=new fV;break;default:ex.getInstance().warn("\u975E\u6CD5\u7684\u8BA1\u65F6\u5668\u6A21\u5F0F"),t=new fG}return!!t.avaliable()&&(this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0)}setInterval(t){this.interval=t}getInterval(){return this.interval}setFPS(t){this.setInterval(1e3/t)}getFPS(){return 1e3/this.interval}tick(t){this.tickerHandler.tick(t,t=>{this.handleTick(t,{once:!0})})}tickTo(t){this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,t=>{this.handleTick(t,{once:!0})})}pause(){return this.status!==tb.INITIAL&&(this.status=tb.PAUSE,!0)}resume(){return this.status!==tb.INITIAL&&(this.status=tb.RUNNING,!0)}ifCanStop(){return!!this.autoStop&&(!this.timelines.length||0===this.timelines.reduce((t,e)=>t+e.animateCount,0))||!1}start(t=!1){return this.status!==tb.RUNNING&&!!this.tickerHandler&&(!!t||this.status!==tb.PAUSE&&!!this.timelines.length&&0!==this.timelines.reduce((t,e)=>t+e.animateCount,0))&&(this.status=tb.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0)}stop(){this.status=tb.INITIAL,this.setupTickHandler(),this.lastFrameTime=-1}};fU.addTimeline(nC),fU.setFPS(60);class f${constructor(t,e,i=.8){this.dir=t,this.color=e,this.colorRgb=nK.Get(e,lB.Color1),this.ambient=i;let r=ic(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this.formatedDir=[t[0]/r,t[1]/r,t[2]/r]}computeColor(t,e){let i;let r=this.formatedDir,n=iu(ih((t[0]*r[0]+t[1]*r[1]+t[2]*r[2])*(1-this.ambient/2),0)+this.ambient,1);i=eE(e)?nK.Get(e,lB.Color1):e;let s=this.colorRgb;return`rgb(${s[0]*i[0]*n}, ${s[1]*i[1]*n}, ${s[2]*i[2]*n})`}}function fY(t,e,i){let r=e[0],n=e[1],s=e[2],a=e[3],o=e[4],l=e[5],h=e[6],u=e[7],d=e[8],c=e[9],p=e[10],g=e[11],f=e[12],m=e[13],v=e[14],y=e[15],_=i[0],b=i[1],x=i[2],S=i[3];return t[0]=_*r+b*o+x*d+S*f,t[1]=_*n+b*l+x*c+S*m,t[2]=_*s+b*h+x*p+S*v,t[3]=_*a+b*u+x*g+S*y,_=i[4],b=i[5],x=i[6],S=i[7],t[4]=_*r+b*o+x*d+S*f,t[5]=_*n+b*l+x*c+S*m,t[6]=_*s+b*h+x*p+S*v,t[7]=_*a+b*u+x*g+S*y,_=i[8],b=i[9],x=i[10],S=i[11],t[8]=_*r+b*o+x*d+S*f,t[9]=_*n+b*l+x*c+S*m,t[10]=_*s+b*h+x*p+S*v,t[11]=_*a+b*u+x*g+S*y,_=i[12],b=i[13],x=i[14],S=i[15],t[12]=_*r+b*o+x*d+S*f,t[13]=_*n+b*l+x*c+S*m,t[14]=_*s+b*h+x*p+S*v,t[15]=_*a+b*u+x*g+S*y,t}function fK(t,e,i){let r=e[0],n=e[1],s=e[2],a=i[3]*r+i[7]*n+i[11]*s+i[15];return a=a||1,t[0]=(i[0]*r+i[4]*n+i[8]*s+i[12])/a,t[1]=(i[1]*r+i[5]*n+i[9]*s+i[13])/a,t[2]=(i[2]*r+i[6]*n+i[10]*s+i[14])/a,t}class fZ{set params(t){this._params=Object.assign({},t),this._projectionMatrixCached=this.forceGetProjectionMatrix(),this._viewMatrixCached=this.forceGetViewMatrix()}get params(){return Object.assign({},this._params)}constructor(t){this.params=t}getViewMatrix(){return this._viewMatrixCached||(this._viewMatrixCached=av.allocate()),this._viewMatrixCached}forceGetViewMatrix(){this._viewMatrixCached||(this._viewMatrixCached=av.allocate());let{pos:t,center:e,up:i}=this.params.viewParams;return function(t,e,i,r){let n,s,a,o,l,h,u,d,c,p;let g=e[0],f=e[1],m=e[2],v=r[0],y=r[1],_=r[2],b=i[0],x=i[1],S=i[2];1e-12>Math.abs(g-b)&&1e-12>Math.abs(f-x)&&1e-12>Math.abs(m-S)?af.identity(t):(p=1/Math.hypot(u=g-b,d=f-x,c=m-S),u*=p,d*=p,c*=p,(p=Math.hypot(n=y*c-_*d,s=_*u-v*c,a=v*d-y*u))?(n*=p=1/p,s*=p,a*=p):(n=0,s=0,a=0),(p=Math.hypot(o=d*a-c*s,l=c*n-u*a,h=u*s-d*n))?(o*=p=1/p,l*=p,h*=p):(o=0,l=0,h=0),t[0]=n,t[1]=o,t[2]=u,t[3]=0,t[4]=s,t[5]=l,t[6]=d,t[7]=0,t[8]=a,t[9]=h,t[10]=c,t[11]=0,t[12]=-(n*g+s*f+a*m),t[13]=-(o*g+l*f+h*m),t[14]=-(u*g+d*f+c*m),t[15]=1,t)}(this._viewMatrixCached,t,e,i),this._vp||(this._vp=av.allocate()),this._vp=fY(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._viewMatrixCached}getProjectionMatrix(){return this._projectionMatrixCached||(this._projectionMatrixCached=av.allocate()),this._projectionMatrixCached}forceGetProjectionMatrix(){this._projectionMatrixCached||(this._projectionMatrixCached=av.allocate());let{left:t,top:e,right:i,bottom:r}=this._params;return function(t,e,i,r,n,s,a){let o=1/(e-i),l=1/(r-n),h=1/(0- -2e6);t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+i)*o,t[13]=(n+r)*l,t[14]=(a+s)*h,t[15]=1}(this._projectionMatrixCached,t,i,r,e,0,-2e6),this._vp||(this._vp=av.allocate()),this._vp=fY(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._projectionMatrixCached}getField(){let{fieldRatio:t=.8,fieldDepth:e,left:i,right:r}=this._params;return(null!=e?e:r-i)*t}getProjectionScale(t){let e=this.getField();return e/(e+t)}view(t,e,i){let r=[0,0,0];return fK(r,[t,e,i],this._viewMatrixCached),r}vp(t,e,i){let r=[0,0,0],{pos:n}=this._params.viewParams;fK(r,[t,e,i],this._viewMatrixCached),t=r[0],e=r[1],i=r[2];let s=this.getProjectionScale(i);return{x:t*s+n[0],y:e*s+n[1]}}}class fX extends fD{constructor(){super(...arguments),this.name="ReactAttributePlugin",this.activeEvent="onRegister",this._uid=eV.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={}}removeElement(t){if(!this.htmlMap||!this.htmlMap[t])return;let{root:e,wrapContainer:i,unmount:r}=this.htmlMap[t];e?rj.global.getRequestAnimationFrame()(()=>{e.unmount()}):r&&r(),i&&rj.global.removeDom(i),this.htmlMap[t]=null}renderGraphicHTML(t){var e;let{react:i}=t.attribute;if(!i)return;let r=t.stage;if(!r)return;let n=r.params.ReactDOM,{element:s,container:a}=i;if(!s||!n||!n.createRoot&&!n.render)return;let o=ej(i.id)?`${null!==(e=t.id)&&void 0!==e?e:t._uid}_react`:i.id;if(this.htmlMap&&this.htmlMap[o]&&a&&a!==this.htmlMap[o].container&&this.removeElement(o),this.htmlMap&&this.htmlMap[o])n.createRoot?this.htmlMap[o].root.render(s):n.render(s,this.htmlMap[o].wrapContainer);else{let{wrapContainer:t,nativeContainer:e}=this.getWrapContainer(r,a);if(t){if(this.htmlMap||(this.htmlMap={}),n.createRoot){let i=n.createRoot(t);i.render(s),this.htmlMap[o]={root:i,wrapContainer:t,nativeContainer:e,container:a,renderId:this.renderId}}else n.render(s,t),this.htmlMap[o]={wrapContainer:t,nativeContainer:e,container:a,renderId:this.renderId,unmount:()=>{n.unmountComponentAtNode(t)}}}}if(!this.htmlMap||!this.htmlMap[o])return;let{wrapContainer:l,nativeContainer:h}=this.htmlMap[o];this.updateStyleOfWrapContainer(t,r,l,h,i),this.htmlMap[o].renderId=this.renderId}}let fq={BACKGROUND:"white"};class fJ extends sW{set viewBox(t){this.window.setViewBox(t)}get viewBox(){return this.window.getViewBox()}get x(){return this.window.getViewBox().x1}set x(t){let e=this.window.getViewBox();e.translate(t-e.x1,0),this.window.setViewBox(e)}get y(){return this.window.getViewBox().y1}set y(t){let e=this.window.getViewBox();e.translate(0,t-e.y1),this.window.setViewBox(e)}get width(){return this.window.width}set width(t){this.resize(t,this.height)}get viewWidth(){return this.window.getViewBox().width()}set viewWidth(t){this.resizeView(t,this.viewHeight)}get viewHeight(){return this.window.getViewBox().height()}set viewHeight(t){this.resizeView(this.viewWidth,t)}get height(){return this.window.height}set height(t){this.resize(this.width,t)}get dpr(){return this.window.dpr}set dpr(t){this.setDpr(t)}get background(){var t;return null!==(t=this._background)&&void 0!==t?t:fq.BACKGROUND}set background(t){this._background=t}get defaultLayer(){return this.at(0)}get eventSystem(){return this._eventSystem}constructor(t={}){var e;super({}),this._onVisibleChange=t=>{if(!(this._skipRender<0)){if(t){if(this.dirtyBounds){let t=this.window.getViewBox();this.dirtyBounds.setValue(t.x1,t.y1,t.width(),t.height())}this._skipRender>1&&this.renderNextFrame(),this._skipRender=0}else this._skipRender=1}},this.beforeRender=t=>{this._beforeRender&&this._beforeRender(t)},this.afterRender=t=>{this.renderCount++,this._afterRender&&this._afterRender(t),this._afterNextRenderCbs&&this._afterNextRenderCbs.forEach(e=>e(t)),this._afterNextRenderCbs=null},this.params=t,this.theme=new np,this.hooks={beforeRender:new e8(["stage"]),afterRender:new e8(["stage"])},this.global=rj.global,!this.global.env&&hs()&&this.global.setEnv("browser"),this.window=r4.get(nt),this.renderService=r4.get(ah),this.pluginService=r4.get(aH),this.layerService=r4.get(sK),this.pluginService.active(this,t),this.window.create({width:t.width,height:t.height,viewBox:t.viewBox,container:t.container,dpr:t.dpr||this.global.devicePixelRatio,canvasControled:!1!==t.canvasControled,title:t.title||"",canvas:t.canvas}),this.state="normal",this.renderCount=0,this.tryInitEventSystem(),this._background=null!==(e=t.background)&&void 0!==e?e:fq.BACKGROUND,this.appendChild(this.layerService.createLayer(this,{main:!0})),this.nextFrameRenderLayerSet=new Set,this.willNextFrameRender=!1,this.stage=this,this.renderStyle=t.renderStyle,t.autoRender&&this.enableAutoRender(),!1===t.disableDirtyBounds&&this.enableDirtyBounds(),t.enableHtmlAttribute&&this.enableHtmlAttribute(t.enableHtmlAttribute),t.ReactDOM&&this.enableReactAttribute(t.ReactDOM),t.enableLayout&&this.enableLayout(),this.hooks.beforeRender.tap("constructor",this.beforeRender),this.hooks.afterRender.tap("constructor",this.afterRender),this._beforeRender=t.beforeRender,this._afterRender=t.afterRender,this.ticker=t.ticker||fU,this.supportInteractiveLayer=!1!==t.interactiveLayer,this.timeline=new nM,this.ticker.addTimeline(this.timeline),this.timeline.pause(),t.optimize||(t.optimize={}),this.optmize(t.optimize),t.background&&eE(this._background)&&this._background.includes("/")&&this.setAttributes({background:this._background})}pauseRender(){this._skipRender=-1}resumeRender(){this._skipRender=0}tryInitEventSystem(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new fP(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}preventRender(t){t?this._skipRender=-Infinity:!1!==this.params.optimize.skipRenderWithOutRange?this._skipRender=this.window.isVisible()?0:1:this._skipRender=0}optmize(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}optmizeRender(t=!1){t&&(this._skipRender=this._skipRender<0?this._skipRender:this.window.isVisible()?0:1,this.window.onVisibleChange(this._onVisibleChange))}getTimeline(){return this.timeline}get3dOptions(t){let{center:e={x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0},light:i={},alpha:r=0,beta:n=0,camera:s,fieldRatio:a=1,fieldDepth:o}=t;return Object.assign(Object.assign({},t),{center:e,light:i,alpha:r,beta:n,camera:s,fieldRatio:a,fieldDepth:o})}set3dOptions(t){var e,i,r,n,s,a;this.option3d=t;let{light:o,center:l,camera:h,alpha:u,beta:d,fieldRatio:c,fieldDepth:p}=this.get3dOptions(t),{dir:g=[1,1,-1],color:f="white",ambient:m}=o,v=(null!==(e=l.x)&&void 0!==e?e:this.width/2)+(null!==(i=l.dx)&&void 0!==i?i:0),y=(null!==(r=l.y)&&void 0!==r?r:this.height/2)+(null!==(n=l.dy)&&void 0!==n?n:0),_=[v,y,(null!==(s=l.z)&&void 0!==s?s:0)+(null!==(a=l.dz)&&void 0!==a?a:0)],b=0,x=0,S=0;h||(b=Math.sin(u)+v,x=Math.sin(d)+y,S=Math.cos(u)*Math.cos(d)*1),this.light=new f$(g,f,m);let k={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:c,fieldDepth:p,viewParams:{pos:[b,x,S],center:_,up:[0,1,0]}};this.camera?this.camera.params=k:this.camera=new fZ(k),t.enableView3dTransform&&this.enableView3dTransform()}setBeforeRender(t){this._beforeRender=t}setAfterRender(t){this._afterRender=t}afterNextRender(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}enableView3dTransform(){this.view3dTranform||(this.view3dTranform=!0,this.pluginService.register(new fB))}disableView3dTranform(){this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRender(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new fR))}disableAutoRender(){this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableIncrementalAutoRender(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new fI))}disableIncrementalAutoRender(){this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableDirtyBounds(){if(this.dirtyBounds)return;this.dirtyBounds=new iB;let t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new fj,this.pluginService.register(t))}disableDirtyBounds(){this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableLayout(){this._enableLayout||(this._enableLayout=!0,this.pluginService.register(new fz))}disableLayout(){this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableHtmlAttribute(t){this.htmlAttribute||(this.htmlAttribute=t,this.pluginService.register(new fD))}disableHtmlAttribute(){this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableReactAttribute(t){this.reactAttribute||(this.reactAttribute=t,this.pluginService.register(new fX))}disableReactAttribute(){this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}getPluginsByName(t){return this.pluginService.findPluginsByName(t)}tryUpdateAABBBounds(){let t=this.window.getViewBox();return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}combineLayer(t,e){throw Error("\u6682\u4E0D\u652F\u6301")}createLayer(t,e){if("released"===this.releaseStatus)return;let i=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(i),i}sortLayer(t){let e=this.children;e.sort(t),this.removeAllChild(),e.forEach(t=>{this.appendChild(t)})}removeLayer(t){return this.removeChild(this.findChildByUid(t))}tryInitInteractiveLayer(){"released"!==this.releaseStatus&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}clearViewBox(t){this.window.clearViewBox(t)}render(t,e){if("released"===this.releaseStatus)return;this.ticker.start(),this.timeline.resume();let i=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=i,this._skipRender&&this._skipRender++}combineLayersToWindow(){if("harmony"===this.global.env){let t=this.window.getContext().nativeContext;this.forEachChildren((e,i)=>{if(i>0){let i=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();t.transferFromImageBitmap(i)}})}}renderNextFrame(t,e){this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach(t=>{this.nextFrameRenderLayerSet.add(t)}),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){if("released"===this.releaseStatus)return;this.timeline.resume(),this.ticker.start();let t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=t,this._skipRender&&this._skipRender++}renderLayerList(t,e){let i=[];for(let e=0;e<t.length;e++){let r=t[e];"virtual"===r.layerMode&&(r=r.getNativeHandler().mainHandler.layer),i.includes(r)||i.push(r)}i.forEach(t=>{t.renderCount>this.renderCount||(t.renderCount=this.renderCount+1,t.render({renderService:this.renderService,background:t===this.defaultLayer?this.background:void 0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e))}resizeWindow(t,e,i=!0){this.window.resize(t,e),i&&this.render()}resize(t,e,i=!0){"released"!==this.releaseStatus&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.window.resize(t,e),this.forEachChildren(i=>{i.resize(t,e)}),this.camera&&this.option3d&&this.set3dOptions(this.option3d),i&&this.render())}resizeView(t,e,i=!0){"released"!==this.releaseStatus&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren(i=>{i.resizeView(t,e)}),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),i&&this.render())}setViewBox(t,e,i,r,n){let s=!0;"object"==typeof t?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),!1===e&&(s=!1)):(this.viewBox.setValue(t,e,t+i,e+r),!1===n&&(s=!1)),this.forEachChildren(t=>{t.resizeView(this.viewBox.width(),this.viewBox.height())}),s&&this.render()}setDpr(t,e=!0){this.forEachChildren(e=>{e.setDpr(t)}),e&&this.render()}setOrigin(t,e){throw Error("\u6682\u4E0D\u652F\u6301")}export(t){throw Error("\u6682\u4E0D\u652F\u6301")}pick(t,e){if("released"===this.releaseStatus)return;this.pickerService||(this.pickerService=r4.get(ac));let i=this.pickerService.pick(this.children,new iW(t,e),{bounds:this.AABBBounds});return!(!(null==i?void 0:i.graphic)&&!(null==i?void 0:i.group))&&i}startAnimate(t){throw Error("\u6682\u4E0D\u652F\u6301")}setToFrame(t){throw Error("\u6682\u4E0D\u652F\u6301")}release(){super.release(),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach(t=>{t.release()}),this.interactiveLayer&&this.interactiveLayer.release(),this.window.release(),this.ticker.remTimeline(this.timeline),this.renderService.renderTreeRoots=[]}setStage(t){}dirty(t,e){"released"!==this.releaseStatus&&(e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t))}getLayer(t){return this.children.filter(e=>e.name===t)[0]}renderTo(t){"released"!==this.releaseStatus&&this.forEachChildren((e,i)=>{e.drawTo(t,{renderService:this.renderService,viewBox:t.getViewBox(),transMatrix:t.getViewBoxTransform(),background:e===this.defaultLayer?this.background:void 0,clear:0===i,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty())})})}renderToNewWindow(t=!0,e){if("released"===this.releaseStatus)return;let i=r4.get(nt),r=e?-e.x1:0,n=e?-e.y1:0,s=e?e.x2:this.viewWidth,a=e?e.y2:this.viewHeight,o=e?e.width():this.viewWidth,l=e?e.height():this.viewHeight;return i.create({viewBox:{x1:r,y1:n,x2:s,y2:a},width:o,height:l,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(i),i}toCanvas(t=!0,e){if("released"===this.releaseStatus)return;let i=this.renderToNewWindow(t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}setCursor(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}getCursor(){return this._cursor}eventPointTransform(t){let e=this.global.mapToCanvasPoint(t,this.window.getContext().canvas.nativeCanvas);return this.stage.window.pointTransform(e.x,e.y)}pauseTriggerEvent(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}resumeTriggerEvent(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}}class fQ{constructor(t){this.onPointerDown=t=>{let e=t.target,i=this.rootNode,r=e===i;if(e&&!r){let s,a=!1;function n(t){if(a||(t.type="dragstart",null==e||e.dispatchEvent(t),a=!0),t.type="drag",null==e||e.dispatchEvent(t),!r){e.attribute.pickable=!1;let r=(null==i?void 0:i.pick(t.global.x,t.global.y)).graphic;e.attribute.pickable=!0,s!==r&&(s&&(t.type="dragleave",t.target=s,s.dispatchEvent(t)),r&&(t.type="dragenter",t.target=r,r.dispatchEvent(t)),(s=r)&&(t.type="dragover",t.target=s,s.dispatchEvent(t)))}}null==i||i.addEventListener("pointermove",n);let o=function(){a&&(s&&(t.type="drop",t.target=s,s.dispatchEvent(t)),t.type="dragend",e.dispatchEvent(t),a=!1),null==i||i.removeEventListener("pointermove",n)};e.addEventListener("pointerup",o,{once:!0}),e.addEventListener("pointerupoutside",o,{once:!0})}},this.rootNode=t,this.initEvents()}initEvents(){var t;null===(t=this.rootNode)||void 0===t||t.addEventListener("pointerdown",this.onPointerDown)}removeEvents(){var t;null===(t=this.rootNode)||void 0===t||t.removeEventListener("pointerdown",this.onPointerDown)}release(){this.removeEvents(),this.rootNode=null}}let f0=(t,e)=>{let i=e.x-t.x,r=e.y-t.y;return Math.abs(i)>Math.abs(r)?i>0?"right":"left":r>0?"down":"up"},f1=(t,e)=>{let i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return Math.sqrt(i*i+r*r)},f2=t=>{let e=t.length;if(1===e)return{x:Math.round(t[0].x),y:Math.round(t[0].y)};let i=0,r=0,n=0;for(;n<e;)i+=t[n].x,r+=t[n].y,n++;return{x:Math.round(i/e),y:Math.round(r/e)}};class f3 extends em(){constructor(t,e={}){var i,r,n,s,a,o,l,h,u,d;super(),this.cachedEvents=[],this.startPoints=[],this.processEvent={},this.throttleTimer=0,this.emitThrottles=[],this.lastTapTarget=null,this.onStart=t=>{this.reset(),this.startTime=fC.now();let{cachedEvents:e,startPoints:i}=this;t&&e.push(t.clone()),i.length=e.length;for(let t=0;t<e.length;t++){let{x:r,y:n}=e[t],s={x:r,y:n};i[t]=s}if(1!==i.length)this.startDistance=f1(i[0],i[1]),this.center=f2([i[0],i[1]]);else{let t=e[0];this.pressTimeout=setTimeout(()=>{t.direction="none",t.deltaX=0,t.deltaY=0,t.points=i,this.triggerStartEvent("press",t),this.triggerEvent("press",t),this.eventType="press",this.direction="none"},this.config.press.time)}},this.onMove=t=>{this.clearPressTimeout();let{startPoints:e,cachedEvents:i}=this;if(!e.length)return;let r=t.clone(),{x:n,y:s,pointerId:a}=r;for(let t=0,e=i.length;t<e;t++)if(a===i[t].pointerId){i[t]=r;break}let o={x:n,y:s},l=i.map(t=>({x:t.x,y:t.y})),h=fC.now();if(this.prevMoveTime=this.lastMoveTime,this.prevMovePoint=this.lastMovePoint,this.lastMoveTime=h,this.lastMovePoint=o,1===e.length){let t=e[0],i=n-t.x,a=s-t.y,h=this.direction||f0(t,o);this.direction=h;let u=this.getEventType(o);return r.direction=h,r.deltaX=i,r.deltaY=a,r.points=l,this.triggerStartEvent(u,r),void this.triggerEvent(u,r)}let{startDistance:u}=this,d=f1(l[0],l[1]);r.scale=d/u,r.center=this.center,r.points=l,this.triggerStartEvent("pinch",r),this.triggerEvent("pinch",r)},this.onEnd=t=>{let e=t.clone(),{cachedEvents:i,startPoints:r}=this,n=i.map(t=>({x:t.x,y:t.y}));if(e.points=n,this.triggerEndEvent(e),1===i.length){let i=fC.now(),n=this.lastMoveTime;if(i-n<100){let t=n-(this.prevMoveTime||this.startTime);if(t>0){let i=this.prevMovePoint||r[0],n=this.lastMovePoint||r[0],s=f1(i,n),a=s/t;a>this.config.swipe.velocity&&s>this.config.swipe.threshold&&(e.velocity=a,e.direction=f0(i,n),this.triggerEvent("swipe",e))}}i-this.lastTapTime<this.config.tap.interval&&t.target===this.lastTapTarget?this.tapCount++:this.tapCount=1,this.lastTapTime=i,this.lastTapTarget=t.target,1===this.tapCount?this.triggerEvent("tap",e):2===this.tapCount&&(this.triggerEvent("doubletap",e),this.tapCount=0)}for(let t=0,n=i.length;t<n;t++)if(i[t].pointerId===e.pointerId){i.splice(t,1),r.splice(t,1);break}this.reset(),i.length>0&&this.onStart()},this.element=t,this.tapCount=0,this.lastTapTime=0,this.config={press:{time:null!==(r=null===(i=null==e?void 0:e.press)||void 0===i?void 0:i.time)&&void 0!==r?r:251,threshold:null!==(s=null===(n=null==e?void 0:e.press)||void 0===n?void 0:n.threshold)&&void 0!==s?s:9},swipe:{threshold:null!==(o=null===(a=null==e?void 0:e.swipe)||void 0===a?void 0:a.threshold)&&void 0!==o?o:10,velocity:null!==(h=null===(l=null==e?void 0:e.swipe)||void 0===l?void 0:l.velocity)&&void 0!==h?h:.3},tap:{interval:null!==(d=null===(u=null==e?void 0:e.tap)||void 0===u?void 0:u.interval)&&void 0!==d?d:300}},this.initEvents()}initEvents(){let{element:t}=this;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}removeEvents(){let{element:t}=this;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}release(){this.removeEvents(),this.element=null}getEventType(t){let e;let{eventType:i,startTime:r,startPoints:n}=this;return i?i:(e=fC.now()-r>this.config.press.time&&f1(n[0],t)<this.config.press.threshold?"press":"pan",this.eventType=e,e)}enable(t){this.processEvent[t]=!0}isProcess(t){return this.processEvent[t]}pushEvent(t,e){let{emitThrottles:i}=this,r={type:t,ev:e};for(let e=0,n=i.length;e<n;e++)if(i[e].type===t)return void i.splice(e,1,r);i.push(r)}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}reset(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}triggerEvent(t,e){this.pushEvent(t,e);let{throttleTimer:i,emitThrottles:r}=this;i||(this.throttleTimer=rj.global.getRequestAnimationFrame()(()=>{for(let t=0,e=r.length;t<e;t++){let{type:e,ev:i}=r[t];this.emitEvent(e,i)}this.throttleTimer=0,this.emitThrottles.length=0}))}triggerStartEvent(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent(`${t}start`,e))}triggerEndEvent(t){let e=this.processEvent;Object.keys(e).forEach(i=>{this.triggerEvent(`${i}end`,t),"press"===i&&this.triggerEvent(`${i}up`,t),delete e[i]})}emitEvent(t,e){let i=this.element._events["*"];if(i){if("fn"in i)i.fn.call(i.context,e,t);else for(let r=0,n=i.length;r<n&&!e.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,e,t)}this.emit(t,e)}}class f5{constructor(t){this.handleAfterNextRender=()=>{this._stage&&!this._viewOptions.disableDirtyBounds&&this._stage.enableDirtyBounds(),this._view.emit(pa.AFTER_VRENDER_DRAW),this._view.emit(pa.AFTER_VRENDER_NEXT_RENDER)},this._view=t}initialize(t,e,i,r){return this._width=t,this._height=e,this._viewOptions=i,this._eventConfig=r,this.initStage(),this}stage(){var t;return null!==(t=this._stage)&&void 0!==t?t:null}gestureController(){var t;return null!==(t=this._gestureController)&&void 0!==t?t:null}canvas(){return this._stage?this._stage.window.getNativeHandler().nativeCanvas:null}context(){return this._stage?this._stage.window.getContext().nativeContext:null}combineIncrementalLayers(){return this._stage&&(function(t){var e,i,r,n;return e=this,i=void 0,r=void 0,n=function*(){let e=[],i=t.getChildren();yield new Promise(t=>{rj.global.getRequestAnimationFrame()(()=>{t(null)})}),i.forEach(t=>{t.subLayers.size&&t.subLayers.forEach(t=>{t.drawContribution&&t.drawContribution.hooks&&t.drawContribution.rendering&&e.push(new Promise(e=>{t.drawContribution.hooks.completeDraw.tap("outWait",()=>{t.drawContribution.hooks.completeDraw.taps=t.drawContribution.hooks.completeDraw.taps.filter(t=>"outWait"!==t.name),e(null)})}))})}),yield Promise.all(e)},new(r||(r=Promise))(function(t,s){function a(t){try{l(n.next(t))}catch(t){s(t)}}function o(t){try{l(n.throw(t))}catch(t){s(t)}}function l(e){var i;e.done?t(e.value):((i=e.value)instanceof r?i:new r(function(t){t(i)})).then(a,o)}l((n=n.apply(e,i||[])).next())})})(this._stage).then(()=>{this._stage&&this._stage.defaultLayer.combineSubLayer()}),this}background(t){if(this._stage)return this._stage.background=t,this}setDpr(t,e){var i,r;return null===(r=null===(i=this._stage)||void 0===i?void 0:i.setDpr)||void 0===r||r.call(i,t),e&&this.renderNextFrame(),this}shouldResize(t,e){return t!==this._width||e!==this._height}resize(t,e){return this._view.emit(pa.BEFORE_STAGE_RESIZE),this.shouldResize(t,e)&&(this._width=t,this._height=e,this._stage&&this._stage.resize(t,e)),this._view.emit(pa.AFTER_STAGE_RESIZE),this}setViewBox(t,e=!0){return this._stage&&(!t||this._viewBox&&t.x1===this._viewBox.x1&&t.x2===this._viewBox.x2&&t.y1===this._viewBox.y1&&t.y2===this._viewBox.y2||(this._viewBox=t,this._stage.setViewBox(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1,e))),this}render(t=!1){return this._view.emit(pa.BEFORE_VRENDER_DRAW),this.initStage(),this._stage.disableDirtyBounds(),this._stage.afterNextRender(this.handleAfterNextRender),t&&(this._stage.render(),this._view.emit(pa.AFTER_VRENDER_DRAW)),this}renderNextFrame(){return this.initStage(),this._stage.renderNextFrame(),this}toCanvas(){return this._stage?this._stage.toCanvas():null}preventRender(t){this._stage&&this._stage.preventRender(t)}release(){var t;this._view.traverseMarkTree(t=>{t.release()}),this._dragController&&this._dragController.release(),this._gestureController&&this._gestureController.release(),this._stage!==(null===(t=this._viewOptions)||void 0===t?void 0:t.stage)&&this._stage.release(),this._stage=null,this._layer=null,this._dragController=null,this._gestureController=null}createStage(){var t,e,i,r,n;this._view.emit(pa.BEFORE_CREATE_VRENDER_STAGE);let s=this._viewOptions,a=null!==(t=s.stage)&&void 0!==t?t:new fJ({width:this._width,height:this._height,renderStyle:s.renderStyle,viewBox:s.viewBox,dpr:s.dpr,canvas:s.renderCanvas,canvasControled:s.canvasControled,container:s.container,title:s.rendererTitle,beforeRender:s.beforeRender,afterRender:s.afterRender,disableDirtyBounds:!0,autoRender:!0,pluginList:s.pluginList,enableHtmlAttribute:s.enableHtmlAttribute,optimize:s.optimize,ticker:s.ticker,supportsTouchEvents:s.supportsTouchEvents,supportsPointerEvents:s.supportsPointerEvents,ReactDOM:s.ReactDOM});(null===(e=s.options3d)||void 0===e?void 0:e.enable)&&a.set3dOptions(s.options3d),a.enableIncrementalAutoRender(),this._viewBox=s.viewBox,this._view.emit(pa.AFTER_CREATE_VRENDER_STAGE),this._view.emit(pa.BEFORE_CREATE_VRENDER_LAYER);let o=null!==(i=s.layer)&&void 0!==i?i:a.defaultLayer;if(this._view.emit(pa.AFTER_CREATE_VRENDER_LAYER),(null===(r=this._eventConfig)||void 0===r?void 0:r.drag)&&(this._dragController=new fQ(a)),null===(n=this._eventConfig)||void 0===n?void 0:n.gesture){let t=nb(this._eventConfig.gesture)?this._eventConfig.gesture:{};this._gestureController=new f3(a,t)}return{stage:a,layer:o}}initStage(){if(!this._stage){let{stage:t,layer:e}=this.createStage();this._stage=t,this._layer=e;let i=this._view.background();this.background(i)}}}function f4(t){return ej(t.offsetX)?ej(t.x)?t.changedTouches&&t.changedTouches.length?function(t){return{canvasX:t.changedTouches[0].x,canvasY:t.changedTouches[0].y}}(t):{canvasX:0,canvasY:0}:function(t){return{canvasX:t.x,canvasY:t.y}}(t):function(t){return{canvasX:t.offsetX,canvasY:t.offsetY}}(t)}function f8(t,e,i=!0){return l1(e.canvasX)&&Object.defineProperty(t,"canvasX",{value:e.canvasX,writable:!0}),l1(e.canvasY)&&Object.defineProperty(t,"canvasY",{value:e.canvasY,writable:!0}),i&&l1(e.clientX)&&Object.defineProperty(t,"clientX",{value:e.clientX,writable:!0}),i&&l1(e.clientY)&&Object.defineProperty(t,"clientY",{value:e.clientY,writable:!0}),[e.canvasX,e.canvasY]}function f6(t,e,i,r,n){return n===g0&&!function(t){["touches","changedTouches","targetTouches"].forEach(e=>{t[e]&&t[e].length&&Array.from(t[e]).forEach(t=>{f8(t,f4(t),!1)})});let e=f4(t);f8(t,e)}(e.changedTouches?e.changedTouches[0]:e),e.element=i,e}class f9 extends g${constructor(){super(...arguments),this.grammarType="signal",this.spec={value:null,update:null}}parse(t){return super.parse(t),this.value(t.value),this.update(t.update),this.commit(),this}evaluate(t,e){return this._signal=this.spec.update?gN(this.spec.update,e,this._signal):this.spec.value,this.spec.value=this._signal,this}output(){return this._signal}getValue(){return this.output()}set(t){if(eM(t)&&eM(this.value)&&t.length===this.value.length){for(let e=0;e<t.length;e++)if(this.value[e]!==t[e])return this._signal=t,this.spec.value=t,!0;return!1}return this._signal!==t&&(this._signal=t,this.spec.value=t,!0)}update(t){return ej(t)||this.value(void 0),this.setFunctionSpec(t,"update")}value(t){return ej(t)||this.update(void 0),this.spec.value=t,this.commit(),this}reuse(t){return t.grammarType!==this.grammarType||(this._signal=t.output()),this}clear(){super.clear(),this._signal=null}}let f7=-1,mt=[g3,g5,g6,g4,g8,g9,g7],me=(t,e,i)=>{var r,n,s,a,o;return[{id:g3,value:null!==(r=t[g3])&&void 0!==r?r:0},{id:g5,value:null!==(n=t[g5])&&void 0!==n?n:0},{id:g6,value:mi(null!==(a=null!==(s=t[g6])&&void 0!==s?s:e[g6])&&void 0!==a?a:null==i?void 0:i.padding)},{id:g4,update:{callback:(t,e)=>{let i=mi(e[g6]);return e[g3]-i.left-i.right},dependency:[g3,g6]}},{id:g8,update:{callback:(t,e)=>{let i=mi(e[g6]);return e[g5]-i.top-i.bottom},dependency:[g5,g6]}},{id:g9,update:{callback:(t,e)=>{let i=mi(e[g6]);return(t||new iB).setValue(i.left,i.top,i.left+e[g4],i.top+e[g8])},dependency:[g4,g8,g6]}},{id:g7,value:null!==(o=t[g7])&&void 0!==o?o:e[g7]}]},mi=t=>{var e,i,r,n;return ey(t)?{top:t,bottom:t,left:t,right:t}:{top:null!==(e=null==t?void 0:t.top)&&void 0!==e?e:0,bottom:null!==(i=null==t?void 0:t.bottom)&&void 0!==i?i:0,left:null!==(r=null==t?void 0:t.left)&&void 0!==r?r:0,right:null!==(n=null==t?void 0:t.right)&&void 0!==n?n:0}},mr=t=>{var e;let i=(t,e)=>{var r,n;t.group=e;let s=null!==(r=t.id)&&void 0!==r?r:"VGRAMMAR_MARK_"+ ++f7;t.id=s,(null!==(n=t.marks)&&void 0!==n?n:[]).forEach(t=>i(t,s))};return(null!==(e=t.marks)&&void 0!==e?e:[]).forEach(t=>i(t,"root")),t},mn=t=>{var e,i,r,n,s;let{reuse:a=!0,morph:o=!0,morphAll:l=!1,animation:h={},enableExitAnimation:u=!0}=null!=t?t:{};return{reuse:a,morph:o,morphAll:l,animation:{easing:null!==(e=h.easing)&&void 0!==e?e:fb,delay:null!==(i=h.delay)&&void 0!==i?i:0,duration:null!==(r=h.duration)&&void 0!==r?r:1e3,oneByOne:null!==(n=h.oneByOne)&&void 0!==n&&n,splitPath:null!==(s=h.splitPath)&&void 0!==s?s:null},enableExitAnimation:u}},ms=t=>!!c8[t];function ma(t,e,i={}){var r;let n=d0.getGraphicType(e)?d0.createGraphic(e,i):d0.createGraphicComponent(e,i,{skipDefault:null===(r=null==t?void 0:t.spec)||void 0===r?void 0:r.skipTheme});return!n&&ex.getInstance().error(`create ${e} graphic failed!`),n}let mo=t=>{t&&(t[fg]=null,t.release(),t.parent&&t.parent.removeChild(t))},ml=t=>ej(t.markId)?e=>e&&e.mark.id()===t.markId:ej(t.markName)?e=>e&&e.mark.name()===t.markName:ej(t.type)?e=>e&&e.mark.markType===t.type:()=>!0,mh=(t,e)=>e&&e.debounce?l3(t,e.debounce):e&&e.throttle?dJ(t,e.throttle):t,mu=(t,e=g1)=>{let i={},r=t.split(":");if(2===r.length){let[t,n]=r;"#"===t[0]?(i.markId=t.slice(1),i.source=e):"@"===t[0]?(i.markName=t.slice(1),i.source=e):ms(t)?(i.markType=t,i.source=e):i.source=t===g0?g0:e,i.type=n}else 1===r.length&&(i.type=t,i.source=e);return i};function md(t,e){switch(e){case"line":return t.some(t=>["x","y","defined"].includes(t));case"area":return t.some(t=>["x","y","x1","y1","defined"].includes(t));case"largeRects":return t.some(t=>["x","y","width","y1"].includes(t));case"largeSymbols":return t.some(t=>["x","y"].includes(t))}return!1}let mc=["fillOpacity"],mp=(t,e,i)=>{var r;return"fillOpacity"===e?(t.fillOpacity=null!==(r=i.fillOpacity)&&void 0!==r?r:1,["fillOpacity"]):[]},mg={rect3d:[{channels:["x","y","z","x1","y1","width","height","length"],transform:(t,e,i)=>{var r,n,s,a,o,l,h,u,d,c,p,g;l1(e.width)||!l1(e.x1)&&l1(i.width)?(t.x=Math.min(null!==(r=i.x)&&void 0!==r?r:0,null!==(n=i.x1)&&void 0!==n?n:1/0),t.width=i.width):l1(e.x1)||!l1(e.width)&&l1(i.x1)?(t.x=Math.min(i.x,i.x1),t.width=Math.abs(i.x1-i.x)):(t.x=Math.min(null!==(s=i.x)&&void 0!==s?s:0,null!==(a=i.x1)&&void 0!==a?a:1/0),t.width=i.width),l1(e.height)||!l1(e.y1)&&l1(i.height)?(t.y=Math.min(null!==(o=i.y)&&void 0!==o?o:0,null!==(l=i.y1)&&void 0!==l?l:1/0),t.height=i.height):l1(e.y1)||!l1(e.height)&&l1(i.y1)?(t.y=Math.min(i.y,i.y1),t.height=Math.abs(i.y1-i.y)):(t.y=Math.min(null!==(h=i.y)&&void 0!==h?h:0,null!==(u=i.y1)&&void 0!==u?u:1/0),t.height=i.height),l1(e.length)||!l1(e.z1)&&l1(i.length)?(t.z=Math.min(null!==(d=i.z)&&void 0!==d?d:0,null!==(c=i.z1)&&void 0!==c?c:1/0),t.length=i.length):l1(e.z1)||!l1(e.length)&&l1(i.z1)?(t.z=Math.min(i.z,i.z1),t.length=Math.abs(i.z1-i.z)):(t.z=Math.min(null!==(p=i.z)&&void 0!==p?p:0,null!==(g=i.z1)&&void 0!==g?g:1/0),t.length=i.length)},storedAttrs:"sizeAttrs"}],[c8.text]:[{channels:["text","limit","autoLimit","maxLineWidth","textType"],transform:(t,e,i)=>{var r,n;let s=null!==(r=i.limit)&&void 0!==r?r:1/0,a=Math.min(s,null!==(n=i.autoLimit)&&void 0!==n?n:1/0),o=eI(i.text)&&!ej(i.text.text),l=o?i.text.text:i.text;Array.isArray(l),t.maxLineWidth=a===1/0?i.maxLineWidth:a,(o||i.textType)&&("rich"===i.text.type||"rich"===i.textType)?t.textConfig=l:t.text=l},storedAttrs:"limitAttrs"}],[c8.rule]:[{channels:["x","y","x1","y1"],transform:(t,e,i)=>{let r=function(t){let{x:e,y:i,x1:r,y1:n}=t;return l1(e)&&l1(i)&&l1(r)&&l1(n)?[{x:e,y:i},{x:r,y:n}]:[]}(i);t.points=r,t.x=0,t.y=0},storedAttrs:"pointAttrs"}],[c8.symbol]:[{channels:["shape","symbolType"],transform:(t,e,i)=>{var r;t.symbolType=null!==(r=e.shape)&&void 0!==r?r:e.symbolType}},{channels:["image","fill","background"],transform:(t,e,i)=>{e.image?(t.background=e.image,t.fill=!1):i.image?(t.background=i.image,t.fill=!1):(t.fill=i.fill,t.background=i.background)},storedAttrs:"imageAttrs"}]},mf=(t,e,i,r)=>{let n={},s=e?Object.keys(e):[],a=eE(t)?mg[t]:t;if(a&&a.length){let t=[];s.forEach(s=>{let o=!1;a.forEach((a,l)=>{if(a.channels.includes(s)){if(!t[l]){if(a.storedAttrs){let t=function(t,e,i,r,n,s){let a=n.getGraphicAttribute(t,!1,s);if(a)return e.forEach(t=>{t in r&&(a[t]=r[t])}),a;let o={};return e.forEach(t=>{o[t]=r[t]}),i[t]=o,o}(a.storedAttrs,a.channels,n,e,i,r);a.transform(n,e,t)}else a.transform(n,e,null)}t[l]=!0,o=!0}}),o||(mc.includes(s)?mp(n,s,e):n[s]=e[s])})}else s.forEach(t=>{mc.includes(t)?mp(n,t,e):n[t]=e[t]});return n};function mm(t){return Object.prototype.toString.call(t)}function mv(t){return Object.keys(t)}function my(t,e,i){if(t===e)return!0;if(typeof t!=typeof e||null==t||null==e)return!1;if(Number.isNaN(t)&&Number.isNaN(e))return!0;if(mm(t)!==mm(e))return!1;if(nx(t))return!!(null==i?void 0:i.skipFunction);if("object"!=typeof t)return!1;if(eM(t)){if(t.length!==e.length)return!1;for(let r=t.length-1;r>=0;r--)if(!my(t[r],e[r],i))return!1;return!0}if(!eI(t))return!1;let r=mv(t),n=mv(e);if(r.length!==n.length)return!1;r.sort(),n.sort();for(let t=r.length-1;t>=0;t--)if(r[t]!=n[t])return!1;for(let n=r.length-1;n>=0;n--){let s=r[n];if(!my(t[s],e[s],i))return!1}return!0}let m_=t=>({}).toString.call(t).replace(/^\[object /,"").replace(/]$/,""),mb=Object.prototype,mx=function(t){let e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||mb)},mS=Object.prototype.hasOwnProperty,mk=function(t){if(ej(t))return!0;if(eR(t))return!t.length;let e=m_(t);if("Map"===e||"Set"===e)return!t.size;if(mx(t))return!Object.keys(t).length;for(let e in t)if(mS.call(t,e))return!1;return!0},mA=(t,e,i,r=!0)=>{if(e===i)return!0;if(ej(e)||ej(i))return ej(e)&&ej(i);if(!eB(e)&&!eB(i))return e===i;let n=eM(e)?e:e[t],s=eM(i)?i:i[t];return n===s||!1!==r&&(eM(s)?!(!eM(n)||s.length!==n.length||!s.every((t,e)=>t===n[e])):!!nb(s)&&!(!nb(n)||Object.keys(s).length!==Object.keys(n).length||!Object.keys(s).every(t=>mA(t,s,n))))};function mw(t){return!!(null==t?void 0:t.scale)}function mM(t){return!!(null==t?void 0:t.field)}function mC(t,e){if(!t)return[];let i=[];return t.scale&&(i=gH(t.scale)?[t.scale]:om(e.getScaleById(t.scale))),i.concat(gF(t,e))}function mT(t,e,i,r,n){i&&(gj(i)?e.forEach(e=>{let n=gN(i,r,e.datum,t);Object.assign(e.nextAttrs,n)}):Object.keys(i).forEach(s=>{var a,o;let l=i[s],h=n&&!function(t,e){if(["x","y","dx","dy"].includes(e))return!0;switch(t){case c8.arc:return["innerRadius","outerRadius","startAngle","endAngle"].includes(e);case c8.group:case c8.rect:case c8.image:return["width","height","y1"].includes(e);case c8.path:case c8.shape:return["path","customPath"].includes(e);case c8.line:return"defined"===e;case c8.area:return["x1","y1","defined"].includes(e);case c8.rule:return["x1","y1"].includes(e);case c8.symbol:return"size"===e;case c8.polygon:return"points"===e;case c8.text:return"text"===e}return!1}(t.mark.markType,s)?[e[0]]:e;if(mw(l)){let t=gz(l.scale,r),e=null!==(a=null==l?void 0:l.offset)&&void 0!==a?a:0,i=!ej(l.band)&&t.bandwidth?t.bandwidth()*l.band:null,n=eE(null==l?void 0:l.field),u=n?fl(l.field):null,d=n?null:ej(null==l?void 0:l.value)?0:null===(o=t.scale)||void 0===o?void 0:o.call(t,l.value);h.forEach(r=>{var a;n&&(d=null===(a=t.scale)||void 0===a?void 0:a.call(t,u(r.datum))),r.nextAttrs[s]=ey(d)||ey(i)?d+e+i:d})}else if(mM(l)){let t=fl(l.field);h.forEach(e=>{e.nextAttrs[s]=t(e.datum)})}else h.forEach(e=>{e.nextAttrs[s]=gN(l,r,e.datum,t)})}))}function mE(t,e,i,r){if(!t)return null;if(gj(t))return gN(t,r,e,i);let n={};return Object.keys(t).forEach(s=>{var a,o,l;let h=t[s];if(mw(h)){let t=gz(h.scale,r),i=null!==(a=null==h?void 0:h.offset)&&void 0!==a?a:0,u=!ej(h.band)&&t.bandwidth?t.bandwidth()*h.band:null,d=eE(null==h?void 0:h.field),c=d?fl(h.field):null,p=d?null===(o=t.scale)||void 0===o?void 0:o.call(t,c(e)):ej(null==h?void 0:h.value)?0:null===(l=t.scale)||void 0===l?void 0:l.call(t,h.value);n[s]=ey(p)||ey(u)?p+i+u:p}else if(mM(h)){let t=fl(h.field);n[s]=t(e)}else n[s]=gN(h,r,e,i)}),n}let mO=(t,e)=>{var i,r;if(t===e)return!0;let n=null!==(i=t&&t.length)&&void 0!==i?i:0;return n===(null!==(r=e&&e.length)&&void 0!==r?r:0)&&0!==n&&t.every((t,i)=>!t&&!e[i]||t&&e[i]&&t.color===e[i].color&&t.offset===e[i].offset)},mP=(t,e)=>{if(t===e)return!0;if(typeof t!=typeof e||eE(t)||t.gradient!==e.gradient)return!1;let i=Object.keys(t),r=Object.keys(e);return i.length===r.length&&i.every(i=>"stops"===i?mO(t[i],e[i]):t[i]===e[i])},mR=(t,e)=>t.length===e.length&&t.join("-")===e.join("-"),mB=(t,e,i)=>!(!ej(t)||!ej(e))||!ej(t)&&!ej(e)&&("lineDash"===i?mR(t,e):"stroke"===i||"fill"===i?mP(t,e):t===e),mI=["stroke","strokeOpacity","lineDash","lineDashOffset","lineCap","lineJoin","lineWidth","miterLimit"],mL=["fill","fillOpacity","background","texture","texturePadding","textureSize","textureColor"].concat(mI);function mD(t,e,i){var r;if(!t||t.length<=1)return null;let n="area"===(null===(r=null==i?void 0:i.mark)||void 0===r?void 0:r.markType)?mL:mI,s=[],a=null;return t.forEach((t,e)=>{a&&n.every(e=>mB(a[e],t[e],e))||(s.length&&(s[s.length-1].endIndex=e),a=t,s.push({attrs:a,startIndex:e}))}),s.length>=2?s.map(t=>{let i=mF(t.attrs);return i.points=e.slice(t.startIndex,ej(t.endIndex)?e.length:t.endIndex),i}):null}function mF(t){let e={};if(!t)return e;let i=["x","y","x1","y1","defined","size","width","height","context"];return Object.keys(t).forEach(r=>{i.includes(r)||(e[r]=t[r])}),e}class mj{constructor(t){this.data=null,this.states=[],this.diffState=c4.enter,this.isReserved=!1,this.runtimeStatesEncoder=null,this.items=[],this.getStateAttrs=(t,e)=>{var i,r,n,s;let a=!ej(null===(i=this.runtimeStatesEncoder)||void 0===i?void 0:i[t]),o=a?Object.assign(Object.assign({},null===(r=this.mark.getSpec().encode)||void 0===r?void 0:r[t]),this.runtimeStatesEncoder[t]):null===(n=this.mark.getSpec().encode)||void 0===n?void 0:n[t];if(!o)return{};if(nx(o))return o(this.getDatum(),this,t,e);if(!a&&(null===(s=this.graphicItem.states)||void 0===s?void 0:s[t]))return this.graphicItem.states[t];let l=this.items.map(t=>Object.assign({},t,{nextAttrs:{}}));mT(this,l,o,this.mark.parameters());let h=this.transformElementItems(l,this.mark.markType);return this.graphicItem.states?this.graphicItem.states[t]||(this.graphicItem.states[t]=h):this.graphicItem.states={[t]:h},h},this.mark=t}initGraphicItem(t={}){if(this.graphicItem)return;let e=this.mark.getAttributeTransforms();this.graphicItem=this.mark.addGraphicItem(e?mf(e,t,this):t,this.groupKey),this.graphicItem&&(this.graphicItem[fg]=this,e&&(this.graphicItem.onBeforeAttributeUpdate=t=>this.mark?mf(e,t,this):t),this.clearGraphicAttributes(),this.mark.needAnimate()&&(this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(Object.assign({},t)),this.setFinalGraphicAttributes(Object.assign({},t))))}updateGraphicItem(){if(!this.graphicItem)return;this.diffState===c4.exit?this.graphicItem.releaseStatus="willRelease":this.graphicItem.releaseStatus=void 0;let t=this.mark.animate.getAnimationConfigs("state");0!==t.length&&(this.graphicItem.stateAnimateConfig=t[0].originConfig)}getGraphicItem(){return this.graphicItem}removeGraphicItem(){var t,e;this.graphicItem&&(null===(e=null===(t=this.graphicItem.animates)||void 0===t?void 0:t.forEach)||void 0===e||e.call(t,t=>t.stop())),this.graphicItem&&(mo(this.graphicItem),this.graphicItem[fg]=null,this.graphicItem=null)}resetGraphicItem(){this.graphicItem&&(this.graphicItem=null)}getBounds(){var t;return null===(t=this.graphicItem)||void 0===t?void 0:t.AABBBounds}getStates(){return this.states}updateData(t,e,i){var r;this.mark.emit(pa.BEFORE_ELEMENT_UPDATE_DATA,{groupKey:t,data:e,key:i},this),this.data=e;let n=gV(i);return this.items=e.map(t=>({datum:t,key:n(t),view:this.mark.view,nextAttrs:{}})),this.groupKey=t,this.key=this.mark.isCollectionMark()?t:null===(r=this.items)||void 0===r?void 0:r[0].key,this.mark.emit(pa.AFTER_ELEMENT_UPDATE_DATA,{groupKey:t,data:e,key:i},this),this.items}state(t,e){var i;let r=this.mark.isCollectionMark(),n=this.states,s=om(gN(t,e,this.getDatum(),this)),a=null===(i=this.mark.getSpec())||void 0===i?void 0:i.stateSort;a&&s.length&&s.sort(a);let o=s.length!==n.length||s.some((t,e)=>t!==n[e]);this.states=s,!r&&o&&this.diffState===c4.unChange&&(this.diffState=c4.update)}encodeGraphic(t){this.coordinateTransformEncode(this.items);let e=this.transformElementItems(this.items,this.mark.markType);t&&Object.assign(e,t),this.graphicItem?(this.graphicItem.clearStates(),this.graphicItem.states={},this.graphicItem.stateProxy=null,fS in this.graphicItem.attribute&&"visible"in e&&delete this.graphicItem.attribute[fS],this.applyGraphicAttributes(e)):this.initGraphicItem(e),(this.diffState===c4.enter||this.diffState===c4.update)&&this.states.length&&this.useStates(this.states),this.mark.markType===c8.shape&&(this.graphicItem.datum=this.items[0].datum),this.items.forEach(t=>{t.nextAttrs={}}),this._setCustomizedShape()}_setCustomizedShape(){var t;if(!this.graphicItem)return;let e=null===(t=this.mark.getSpec())||void 0===t?void 0:t.setCustomizedShape;e&&(this.graphicItem.pathProxy=t=>e(this.data,t,new rg))}encodeItems(t,e,i=!1,r){let n=this.mark.isCollectionMark(),s=e[c5.update],a=e[c5.enter],o=e[c5.exit],l=this.mark.isLargeMode()||n&&!this.mark.getSpec().enableSegments;this.diffState===c4.enter?(a&&mT(this,t,a,r,l),s&&mT(this,t,s,r,l)):this.diffState===c4.update?((n&&a||i)&&mT(this,t,a,r,l),s&&mT(this,t,s,r,l)):this.diffState===c4.exit&&o&&(i&&mT(this,t,a,r,l),mT(this,t,o,r,l))}coordinateTransformEncode(t){if(!this.mark.coord||"arc"===this.mark.markType||!0===this.mark.disableCoordinateTransform)return;let e=this.mark.coord.output();t.forEach(t=>{let i=t.nextAttrs,r=e.convert(i);Object.assign(i,r)})}clearStates(t){let e=ew(t)?t:0!==this.mark.animate.getAnimationConfigs("state").length;this.states=[],this.graphicItem&&this.graphicItem.clearStates(e),this.runtimeStatesEncoder&&(this.runtimeStatesEncoder={})}_updateRuntimeStates(t,e){this.runtimeStatesEncoder||(this.runtimeStatesEncoder={}),this.runtimeStatesEncoder[t]=e}hasState(t){return this.states&&t&&this.states.includes(t)}updateStates(t){if(!this.graphicItem)return!1;let e=this.states.slice(),i=this.mark.getSpec().encode,r=!1,n=!1;return Object.keys(t).forEach(s=>{var a;if(!s)return;let o=t[s];if(nb(o)&&!my(o,null===(a=this.runtimeStatesEncoder)||void 0===a?void 0:a[s]))e.includes(s)?r=!0:e.push(s),this._updateRuntimeStates(s,o),n=!0;else if(o)!e.includes(s)&&(null==i?void 0:i[s])&&(e.push(s),n=!0);else if(e.length){let t=e.filter(t=>t!==s);t.length!==e.length&&(n=!0,e=t),this.runtimeStatesEncoder&&this.runtimeStatesEncoder[s]&&(this.runtimeStatesEncoder[s]=null)}}),r&&this.graphicItem.clearStates(),!!n&&(this.useStates(e),!0)}addState(t,e){var i;if(!this.graphicItem)return!1;if(e&&eE(t)&&!my(e,null===(i=this.runtimeStatesEncoder)||void 0===i?void 0:i[t])){let i=this.states.slice();return i.includes(t)?this.graphicItem.clearStates():i.push(t),this._updateRuntimeStates(t,e),this.useStates(i),!0}let r=this.mark.getSpec().encode,n=om(t).reduce((t,e)=>(e&&!t.includes(e)&&(null==r?void 0:r[e])&&t.push(e),t),this.states.slice());return n.length!==this.states.length&&(this.useStates(n),!0)}removeState(t){if(!this.graphicItem)return!1;let e=om(t);if(!e.length)return!1;let i=this.states.filter(t=>!e.includes(t));return i.length!==this.states.length&&(this.runtimeStatesEncoder&&e.forEach(t=>{this.runtimeStatesEncoder[t]=null}),this.useStates(i),!0)}useStates(t,e){var i;if(!this.graphicItem)return!1;this.mark.emit(pa.BEFORE_ELEMENT_STATE,{states:t},this);let r=null===(i=this.mark.getSpec())||void 0===i?void 0:i.stateSort;r&&t.sort(r),this.states=t;let n=ew(e)?e:0!==this.mark.animate.getAnimationConfigs("state").length;return this.graphicItem.stateProxy=this.getStateAttrs,this.graphicItem.useStates(this.states,n),this.mark.emit(pa.AFTER_ELEMENT_STATE,{states:t},this),!0}diffAttributes(t){let e={},i=this.getFinalGraphicAttributes();for(let r in t)mA(r,i,t)&&nv(i,r)||(e[r]=t[r]);return e}transformElementItems(t,e,i){var r,n,s,a,o,l,h,u,d,c,p;let g=t[0];if(!g.nextAttrs||0===Object.keys(g.nextAttrs).length)return{};let f=g.nextAttrs;if(l=e,[c8.line,c8.area,c8.largeRects,c8.largeSymbols].includes(l)&&t&&t.length&&ej(null===(r=g.nextAttrs)||void 0===r?void 0:r.points)&&(!0===i||md(Object.keys(g.nextAttrs),this.mark.markType))){let i=this.mark.getSpec(),r=this.getGraphicAttribute("points",!1),l=this.getGraphicAttribute("segments",!1),g=i.enableSegments,m=null===(n=this.mark.getSpec().encode)||void 0===n?void 0:n[c5.connectNulls],v=t.map(t=>t.nextAttrs),y=this.mark.isProgressive();if(f=mF(f),e===c8.line||e===c8.area){;let i=(h=t,u=!0,d=r,c=e===c8.area,h&&h.length&&(1!==h.length||u)?h.some(t=>md(Object.keys(t.nextAttrs),"line"))?h.map((t,e)=>{var i;let r=t.nextAttrs,{x:n,y:s,x1:a,y1:o,defined:l}=null!==(i=null==d?void 0:d[e])&&void 0!==i?i:{};return ej(r.x)&&(r.x=n),ej(r.y)&&(r.y=s),ej(r.defined)&&!1===l&&(r.defined=!1),r.context=t.key,c&&(ej(r.x1)&&(r.x1=a),ej(r.y1)&&(r.y1=o)),r}):null!=d?d:[]:[]);if(y)f.segments=(null!==(o=null===(a=null===(s=this.graphicItem)||void 0===s?void 0:s.attribute)||void 0===a?void 0:a.segments)&&void 0!==o?o:[]).concat([{points:i}]);else if(m){if(f.segments=function(t,e,i){if(!t||t.length<=1)return null;let r=!!i&&i.mark.getSpec().enableSegments,n,s,a=[],o=null;if(t.forEach((t,i)=>{(o=e[i])&&!1!==o.defined?(n||(s={items:[],points:[]},a.push(s)),s.points.push(o),s.items.push(t),!1===n&&(s.isConnect=!0,s={items:[],points:[]},a.push(s)),n=!0):n=!1}),(a=a.filter(t=>t.points.length>0)).length>=2){let t=[];return a.forEach(e=>{if(e.isConnect)return void t.push({points:e.points,isConnect:!0});if(r){let r=mD(e.items,e.points,i);if(r)return void r.forEach(e=>{t.push(e)})}let n=mF(e.items[0]);n.points=e.points,t.push(n)}),t}return r?mD(t,e,i):null}(v,i,this),f.segments&&f.segments.some(t=>t.isConnect)){let t=mE(m,this.getDatum(),this,this.mark.parameters());t&&f.segments.forEach(e=>{e.isConnect&&Object.assign(e,t)})}f.points=i}else if(g){;let t=i&&0!==i.length?i:(p=l)?p.reduce((t,e)=>t.concat(e.points),[]):null,e=mD(v,t,this);e?(f.segments=e,f.points=null):(f.segments=null,f.points=t),f=function(t,e){var i;if(!t||!t.segments||!t.segments.length)return t;let r="area"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.markType)?["fillOpacity","strokeOpacity"]:["strokeOpacity"],n={};return Object.keys(t).forEach(e=>{r.includes(e)||(n[e]=t[e])}),n}(f,this)}else f.points=i,f.segments=null}else e===c8.largeRects?f.points=function(t,e,i=[]){if(!t||!t.length||1===t.length&&!e)return[];let r=new Float32Array(4*t.length);return t.forEach((t,e)=>{var n,s,a,o;let l=t.nextAttrs,h=null!==(n=l.x)&&void 0!==n?n:i[4*e],u=null!==(s=l.y)&&void 0!==s?s:i[4*e+1],d=null!==(a=l.width)&&void 0!==a?a:i[4*e+2],c=null!==(o=l.y1)&&void 0!==o?o:i[4*e+3];r[4*e]=h,r[4*e+1]=u,r[4*e+2]=d,r[4*e+3]=c-u}),r}(t,!0,r):e===c8.largeSymbols&&(f.points=function(t,e,i=[]){if(!t||!t.length||1===t.length&&!e)return[];let r=new Float32Array(2*t.length);return t.forEach((t,e)=>{var n,s;let a=t.nextAttrs,o=null!==(n=a.x)&&void 0!==n?n:i[2*e],l=null!==(s=a.y)&&void 0!==s?s:i[2*e+1];r[2*e]=o,r[2*e+1]=l}),r}(t,!0,r))}return f}applyGraphicAttributes(t){var e,i;if(!mk(t)){if(this.mark.needAnimate()){let r=this.diffAttributes(t),n=null!==(e=this.getPrevGraphicAttributes())&&void 0!==e?e:{},s=null!==(i=this.getFinalGraphicAttributes())&&void 0!==i?i:{};Object.keys(r).forEach(t=>{n[t]=this.getGraphicAttribute(t),s[t]=r[t]}),this.setNextGraphicAttributes(r),this.setPrevGraphicAttributes(n),this.setFinalGraphicAttributes(s);let a=Object.assign({},this.mark.animate.getElementAnimators(this).reduce((t,e)=>Object.assign(t,e.getEndAttributes()),{}),s);this.graphicItem.setAttributes(a)}else this.graphicItem.setAttributes(t)}}getGraphicAttribute(t,e=!1){var i;if(!this.graphicItem)return;if(e){let e;if(!ej(e=dq(this.getPrevGraphicAttributes(),t)))return e}let r=this.mark.getAttributeTransforms(),n=[t];if(r&&r.length){let e=r.find(e=>e.storedAttrs&&e.channels.includes(t));e&&(n=[e.storedAttrs,t])}return dq(null===(i=this.graphicItem)||void 0===i?void 0:i.attribute,n)}setGraphicAttribute(t,e,i=!0){if(!this.graphicItem)return;let r=this.getFinalGraphicAttributes(),n=this.getPrevGraphicAttributes();i&&r&&(r[t]=e),n&&!nv(n,t)&&(n[t]=this.graphicItem.attribute[t]),this.graphicItem.setAttribute(t,e)}setGraphicAttributes(t,e=!0){if(!this.graphicItem)return;let i=this.getFinalGraphicAttributes(),r=this.getPrevGraphicAttributes();Object.keys(t).forEach(n=>{i&&e&&(i[n]=t[n]),r&&!nv(r,n)&&(r[n]=this.graphicItem.attribute[n])}),this.graphicItem.setAttributes(t)}getFinalGraphicAttributes(){return this.graphicItem.finalAttrs}setFinalGraphicAttributes(t){this.graphicItem.finalAttrs=t}getPrevGraphicAttributes(){return this.graphicItem.prevAttrs}setPrevGraphicAttributes(t){this.graphicItem.prevAttrs=t}getNextGraphicAttributes(){return this.graphicItem.nextAttrs}getFinalAnimationAttribute(t){var e,i;return null!==(i=null===(e=this.getFinalGraphicAttributes())||void 0===e?void 0:e[t])&&void 0!==i?i:this.getGraphicAttribute(t)}getFinalAnimationAttributes(){var t;return null!==(t=this.getFinalGraphicAttributes())&&void 0!==t?t:this.graphicItem.attribute}setNextGraphicAttributes(t){this.graphicItem.nextAttrs=t}clearChangedGraphicAttributes(){this.graphicItem&&(this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null))}clearGraphicAttributes(){this.graphicItem&&(this.graphicItem.prevAttrs&&this.setPrevGraphicAttributes(null),this.graphicItem.nextAttrs&&this.setNextGraphicAttributes(null),this.graphicItem.finalAttrs&&this.setFinalGraphicAttributes(null))}remove(){this.graphicItem&&(mo(this.graphicItem),this.graphicItem=null)}release(){this.removeGraphicItem(),this.mark=null,this.data=null,this.items=null}getItemAttribute(t){var e,i;if(null===(e=this.items)||void 0===e?void 0:e.length)return this.mark.isCollectionMark()?ej(t)?this.items.map(t=>t.nextAttrs):this.items.map(e=>{var i;return null===(i=e.nextAttrs)||void 0===i?void 0:i[t]}):ej(t)?this.items[0].nextAttrs:null===(i=this.items[0].nextAttrs)||void 0===i?void 0:i[t]}setItemAttributes(t){var e;(null===(e=this.items)||void 0===e?void 0:e.length)&&(this.mark.isCollectionMark()?eM(t)&&this.items.forEach((e,i)=>{Object.assign(e.nextAttrs,t[i])}):Object.assign(this.items[0].nextAttrs,t))}getItem(){var t,e;return this.mark&&this.mark.isCollectionMark()?null!==(t=this.items)&&void 0!==t?t:[]:null===(e=this.items)||void 0===e?void 0:e[0]}getDatum(){var t,e;return this.mark&&this.mark.isCollectionMark()?null!==(t=this.data)&&void 0!==t?t:[]:null===(e=this.data)||void 0===e?void 0:e[0]}}class mN extends mj{constructor(t){super(t),this.getStateAttrs=(t,e)=>{var i,r,n,s;let a=!ej(null===(i=this.runtimeStatesEncoder)||void 0===i?void 0:i[t]),o=a?Object.assign(Object.assign({},null===(r=this.mark.getSpec().encode)||void 0===r?void 0:r[t]),this.runtimeStatesEncoder[t]):null===(n=this.mark.getSpec().encode)||void 0===n?void 0:n[t],l={};if(!o)return l;if(nx(o))return l.attributes=o(this.getDatum(),this,t,e),l;if(!a&&(null===(s=this.graphicItem.glyphStates)||void 0===s?void 0:s[t]))return this.graphicItem.glyphStates[t];if(o){let e=[Object.assign({},this.items[0],{nextAttrs:{}})];return mT(this,e,o,this.mark.parameters()),this.coordinateTransformEncode(e),l.attributes=e[0].nextAttrs,this.graphicItem.glyphStates?this.graphicItem.glyphStates[t]||(this.graphicItem.glyphStates[t]=l):this.graphicItem.glyphStates={[t]:l},l}return l},this.glyphMeta=this.mark.getGlyphMeta()}getGlyphGraphicItems(){return this.glyphGraphicItems}initGraphicItem(t={}){if(this.graphicItem)return;this.graphicItem=this.mark.addGraphicItem(t,this.groupKey),this.graphicItem[fg]=this,this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!1);let e=this.glyphMeta.getMarks();this.glyphGraphicItems={},this.graphicItem.getSubGraphic().forEach(t=>{let i=e[t.name];this.glyphGraphicItems[t.name]=t,t.onBeforeAttributeUpdate=e=>this.mark?mf(i,e,this,t.name):e}),this.clearGraphicAttributes()}useStates(t,e){if(!this.graphicItem)return!1;this.mark.emit(pa.BEFORE_ELEMENT_STATE,{states:t},this),this.states=t.slice();let i=ew(e)?e:0!==this.mark.animate.getAnimationConfigs("state").length;return this.graphicItem.glyphStateProxy=this.getStateAttrs,this.graphicItem.useStates(this.states,i),this.mark.emit(pa.AFTER_ELEMENT_STATE,{states:t},this),!0}encodeGraphic(){this.coordinateTransformEncode(this.items);let t=this.transformElementItems(this.items,this.mark.markType),e=!this.graphicItem;this.graphicItem||this.initGraphicItem(),this.diffState===c4.enter||e?(this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!0),this.applyGraphicAttributes(t),this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!1)):this.applyGraphicAttributes(t),(this.diffState===c4.enter||this.diffState===c4.update)&&this.states.length&&(Object.values(this.glyphGraphicItems).forEach(t=>{t.states={}}),this.useStates(this.states)),this.items.map(t=>{t.nextAttrs={}})}encodeCustom(t){var e;let i={},r=this.glyphMeta.getChannelEncoder(),n=this.glyphMeta.getFunctionEncoder();if(n&&(i=n.call(null,Object.assign({},null===(e=this.graphicItem)||void 0===e?void 0:e.attribute,t),this.getDatum(),this,this.mark.getGlyphConfig())),r){let e;Object.keys(r).forEach(n=>{var s;if(!ej(t[n])){e||(e=Object.assign({},null===(s=this.graphicItem)||void 0===s?void 0:s.attribute,t));let a=r[n].call(null,n,t[n],e,this.getDatum(),this,this.mark.getGlyphConfig());Object.keys(null!=a?a:{}).forEach(t=>{var e;i[t]=Object.assign(null!==(e=i[t])&&void 0!==e?e:{},a[t])})}})}return i}encodeDefault(){let t={};return this.glyphMeta.getDefaultEncoder()&&Object.assign(t,this.glyphMeta.getDefaultEncoder().call(null,this.getDatum(),this,this.mark.getGlyphConfig())),t}_onGlyphAttributeUpdate(t=!1){return e=>{if(!this.mark)return e;let i=this.glyphMeta.getMarks(),r=mf(this.mark.getAttributeTransforms(),e,this),n=t?this.encodeDefault():null,s=this.encodeCustom(e);return Object.keys(i).forEach(r=>{var a,o,l;let h=i[r],u=this.glyphGraphicItems[r],d=Object.assign({},null==s?void 0:s[r]);if(t){let t=null==n?void 0:n[r];Object.keys(null!=t?t:{}).forEach(e=>{nv(this.items[0].nextAttrs,e)||nv(d,e)||(d[e]=t[e])})}let c=Object.assign({},(a=h,o=e,(null!==(l=mg[a])&&void 0!==l?l:[]).reduce((t,e)=>(e.channels.forEach(e=>{nv(o,e)&&(t[e]=o[e])}),t),{})),d),p=this._generateGlyphItems(h,this.items,c);this.coordinateTransformEncode(p);let g=this.transformElementItems(p,h);this.applyGlyphGraphicAttributes(g,r,u),h===c8.shape&&(u.datum=p[0].datum)}),r}}_generateGlyphItems(t,e,i){let r=e.map(t=>Object.assign({},t,{nextAttrs:i}));return ff.includes(t)&&this.mark.getSpec().enableSegments&&r.forEach((t,r)=>{t.nextAttrs=Object.assign({},e[r].nextAttrs,i)}),r}getGraphicAttribute(t,e=!1,i){if(!this.graphicItem)return;let r=this.getPrevGraphicAttributes(i);return e&&nv(r,t)?r[t]:(i?this.glyphGraphicItems[i]:this.graphicItem).attribute[t]}setGraphicAttribute(t,e,i=!0,r){if(!this.graphicItem)return;let n=r?this.glyphGraphicItems[r]:this.graphicItem,s=this.getFinalGraphicAttributes(r),a=this.getPrevGraphicAttributes(r);i&&(s[t]=e),nv(a,t)||(a[t]=n.attribute[t]),n.setAttribute(t,e)}setGraphicAttributes(t,e=!0,i){if(!this.graphicItem)return;let r=i?this.glyphGraphicItems[i]:this.graphicItem,n=this.getFinalGraphicAttributes(i),s=this.getPrevGraphicAttributes(i);Object.keys(t).forEach(i=>{e&&(n[i]=t[i]),nv(s,i)||(s[i]=r.attribute[i])}),r.setAttributes(t)}diffAttributes(t,e){let i={},r=this.getFinalGraphicAttributes(e);for(let e in t)mA(e,r,t)||(i[e]=t[e]);return i}applyGlyphGraphicAttributes(t,e,i){var r,n;if(this.mark.needAnimate()){let s=this.diffAttributes(t,e),a=null!==(r=this.getPrevGraphicAttributes(e))&&void 0!==r?r:{},o=null!==(n=this.getFinalGraphicAttributes(e))&&void 0!==n?n:{};Object.keys(s).forEach(t=>{a[t]=i.attribute[t],o[t]=s[t]}),this.setNextGraphicAttributes(s,e),this.setPrevGraphicAttributes(a,e),this.setFinalGraphicAttributes(o,e),i.setAttributes(s)}else i.setAttributes(t)}getFinalGraphicAttributes(t){return(t?this.glyphGraphicItems[t]:this.graphicItem).finalAttrs}setFinalGraphicAttributes(t,e){(e?this.glyphGraphicItems[e]:this.graphicItem).finalAttrs=t}getPrevGraphicAttributes(t){return(t?this.glyphGraphicItems[t]:this.graphicItem).prevAttrs}setPrevGraphicAttributes(t,e){(e?this.glyphGraphicItems[e]:this.graphicItem).prevAttrs=t}getNextGraphicAttributes(t){return(t?this.glyphGraphicItems[t]:this.graphicItem).nextAttrs}setNextGraphicAttributes(t,e){(e?this.glyphGraphicItems[e]:this.graphicItem).nextAttrs=t}clearChangedGraphicAttributes(){this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null),Object.keys(this.glyphGraphicItems).forEach(t=>{this.setPrevGraphicAttributes(null,t),this.setNextGraphicAttributes(null,t)})}clearGraphicAttributes(){this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null),this.setFinalGraphicAttributes(null),Object.keys(this.glyphGraphicItems).forEach(t=>{this.setPrevGraphicAttributes(null,t),this.setNextGraphicAttributes(null,t),this.setFinalGraphicAttributes(null,t)})}remove(){this.glyphGraphicItems=null,super.remove()}release(){this.glyphGraphicItems&&(Object.values(this.glyphGraphicItems).forEach(t=>{t[fg]=null}),this.glyphGraphicItems=null),super.release()}}let mz=t=>t.markType===c8.glyph?new mN(t):new mj(t);function mH(t,e,i){let r=new Map;if(!t||0===t.length)return{keys:[],data:r};if(!e)return r.set("key",i?t.slice().sort(i):t.slice()),{keys:fy,data:r};let n=gV(e);if(1===t.length){let e=n(t[0]);return r.set(e,[t[0]]),{keys:[e],data:r}}let s=new Set;return t.forEach(t=>{var e;let i=n(t),a=null!==(e=r.get(i))&&void 0!==e?e:[];a.push(t),r.set(i,a),s.add(i)}),i&&s.forEach(t=>{r.get(t).sort(i)}),{keys:Array.from(s),data:r}}class mV{constructor(t,e,i){this.prevData=(null==t?void 0:t.length)?mH(t,null!=e?e:null,i):null}setCurrentData(t){this.currentData=t}getCurrentData(){return this.currentData}doDiff(){if(this.callback){if(this.currentData&&this.prevData){let t=new Map(this.prevData.data);this.currentData.keys.forEach(e=>{this.callback(e,this.currentData.data.get(e),t.get(e)),t.delete(e)}),this.prevData.keys.forEach(e=>{t.has(e)&&this.callback(e,null,t.get(e))})}else this.currentData?this.currentData.keys.forEach(t=>{this.callback(t,this.currentData.data.get(t),null)}):this.prevData&&this.prevData.keys.forEach(t=>{this.callback(t,null,this.prevData.data.get(t))})}}setCallback(t){this.callback=t}updateToCurrent(){this.prevData=this.currentData,this.currentData=null}reset(){this.prevData=null}}class mW extends nT{constructor(t,e,i,r,n){super(t,e,i,r,n)}getEndProps(){return!1===this.valid?{}:{text:this.to}}onBind(){var t,e,i,r,n,s,a,o;this.fromNumber=ey(null===(t=this.from)||void 0===t?void 0:t.text)?null===(e=this.from)||void 0===e?void 0:e.text:Number.parseFloat(null===(i=this.from)||void 0===i?void 0:i.text),this.toNumber=ey(null===(r=this.to)||void 0===r?void 0:r.text)?null===(n=this.to)||void 0===n?void 0:n.text:Number.parseFloat(null===(s=this.to)||void 0===s?void 0:s.text),Number.isFinite(this.toNumber)||(this.fromNumber=0),Number.isFinite(this.toNumber)||(this.valid=!1),!1!==this.valid&&(this.decimalLength=null!==(o=null===(a=this.params)||void 0===a?void 0:a.fixed)&&void 0!==o?o:Math.max(ib(this.fromNumber),ib(this.toNumber)))}onEnd(){}onUpdate(t,e,i){!1!==this.valid&&(i.text=t?this.toNumber:(this.fromNumber+(this.toNumber-this.fromNumber)*e).toFixed(this.decimalLength))}}(S=tx||(tx={}))[S.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",S[S.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",S[S.TOP_TO_BOTTOM=2]="TOP_TO_BOTTOM",S[S.BOTTOM_TO_TOP=3]="BOTTOM_TO_TOP",S[S.STROKE=4]="STROKE";class mG extends nT{constructor(t,e,i,r,n){var s,a;super(t,e,i,r,n),this.newPointAnimateType=null!==(s=null==n?void 0:n.newPointAnimateType)&&void 0!==s?s:"grow",this.clipRangeByDimension=null!==(a=null==n?void 0:n.clipRangeByDimension)&&void 0!==a?a:"x"}onBind(){var t,e;let i=null===(t=this.from)||void 0===t?void 0:t.points,r=null===(e=this.to)||void 0===e?void 0:e.points;this.fromPoints=i?Array.isArray(i)?i:[i]:[],this.toPoints=r?Array.isArray(r)?r:[r]:[];let n=new Map;this.fromPoints.forEach(t=>{t.context&&n.set(t.context,t)});let s,a,o=1/0,l=-Infinity;for(let t=0;t<this.toPoints.length;t+=1)if(n.has(this.toPoints[t].context)){o=t,s=n.get(this.toPoints[t].context);break}for(let t=this.toPoints.length-1;t>=0;t-=1)if(n.has(this.toPoints[t].context)){l=t,a=n.get(this.toPoints[t].context);break}"clip"===this.newPointAnimateType&&0!==this.toPoints.length&&(Number.isFinite(l)?(this.clipRange=this.toPoints[l][this.clipRangeByDimension]/this.toPoints[this.toPoints.length-1][this.clipRangeByDimension],l1(this.clipRange)?this.clipRange=nL(this.clipRange,0,1):this.clipRange=0):this.clipRange=0);let h=this.toPoints[0];this.interpolatePoints=this.toPoints.map((t,e)=>{let i=n.get(t.context);return i?(h=i,[i,t]):"appear"===this.newPointAnimateType||"clip"===this.newPointAnimateType?[t,t]:e<o&&s?[s,t]:e>l&&a?[a,t]:[h,t]}),this.points=this.interpolatePoints.map(t=>{let e=t[0],i=t[1],r=new iW(e.x,e.y,e.x1,e.y1);return r.defined=i.defined,r.context=i.context,r})}onUpdate(t,e,i){this.points=this.points.map((t,i)=>{let r=sh(this.interpolatePoints[i][0],this.interpolatePoints[i][1],e);return r.context=t.context,r}),this.clipRange&&(i.clipRange=this.clipRange+(1-this.clipRange)*e),i.points=this.points}}class mU extends nT{constructor(t,e,i,r,n){super(null,null,i,r,n),this.clipFromAttribute=t,this.clipToAttribute=e,this._group=null==n?void 0:n.group,this._clipGraphic=null==n?void 0:n.clipGraphic}onBind(){this._group&&this._clipGraphic&&(this._lastClip=this._group.attribute.clip,this._lastPath=this._group.attribute.path,this._group.setAttributes({clip:!0,path:[this._clipGraphic]},!1,{type:lw.ANIMATE_BIND}))}onEnd(){this._group&&this._group.setAttributes({clip:this._lastClip,path:this._lastPath},!1,{type:lw.ANIMATE_END})}onUpdate(t,e,i){if(!this._clipGraphic)return;let r={};Object.keys(this.clipFromAttribute).forEach(t=>{r[t]=this.clipFromAttribute[t]+(this.clipToAttribute[t]-this.clipFromAttribute[t])*e}),this._clipGraphic.setAttributes(r,!1,{type:lw.ANIMATE_UPDATE,animationState:{ratio:e,end:t}})}}class m$ extends mU{constructor(t,e,i,r,n){var s,a,o,l,h,u,d,c,p,g,f,m;let v,y;let _=null!==(a=null===(s=null==n?void 0:n.group)||void 0===s?void 0:s.attribute)&&void 0!==a?a:{},b=null!==(o=_.width)&&void 0!==o?o:0,x=null!==(l=_.height)&&void 0!==l?l:0,S=null!==(h=null==n?void 0:n.animationType)&&void 0!==h?h:"in",k=null!==(u=null==n?void 0:n.startAngle)&&void 0!==u?u:0,A=null!==(d=null==n?void 0:n.orient)&&void 0!==d?d:"clockwise",w=0,M=0;"anticlockwise"===A?(M="in"===S?k+2*Math.PI:k,M=k+2*Math.PI):(w=k,M="out"===S?k+2*Math.PI:k);let C=rj.graphicService.creator.arc({x:null!==(p=null===(c=null==n?void 0:n.center)||void 0===c?void 0:c.x)&&void 0!==p?p:b/2,y:null!==(f=null===(g=null==n?void 0:n.center)||void 0===g?void 0:g.y)&&void 0!==f?f:x/2,outerRadius:null!==(m=null==n?void 0:n.radius)&&void 0!==m?m:(b+x)/2,innerRadius:0,startAngle:w,endAngle:M,fill:!0});"anticlockwise"===A?(v={startAngle:k+2*Math.PI},y={startAngle:k}):(v={endAngle:k},y={endAngle:k+2*Math.PI}),super("in"===S?v:y,"in"===S?y:v,i,r,{group:null==n?void 0:n.group,clipGraphic:C})}}class mY extends mU{constructor(t,e,i,r,n){var s,a,o,l,h,u,d,c,p;let g=null!==(a=null===(s=null==n?void 0:n.group)||void 0===s?void 0:s.attribute)&&void 0!==a?a:{},f=null!==(l=null!==(o=null==n?void 0:n.width)&&void 0!==o?o:g.width)&&void 0!==l?l:0,m=null!==(u=null!==(h=null==n?void 0:n.height)&&void 0!==h?h:g.height)&&void 0!==u?u:0,v=null!==(d=null==n?void 0:n.animationType)&&void 0!==d?d:"in",y=null!==(c=null==n?void 0:n.direction)&&void 0!==c?c:"x",_=null!==(p=null==n?void 0:n.orient)&&void 0!==p?p:"positive",b=rj.graphicService.creator.rect({x:0,y:0,width:"in"===v&&"x"===y?0:f,height:"in"===v&&"y"===y?0:m,fill:!0}),x={},S={};"y"===y?"negative"===_?(x={y:m,height:0},S={y:0,height:m}):(x={height:0},S={height:m}):"negative"===_?(x={x:f,width:0},S={x:0,width:f}):(x={width:0},S={width:f}),super("in"===v?x:S,"in"===v?S:x,i,r,{group:null==n?void 0:n.group,clipGraphic:b})}}class mK extends nT{onStart(){let{center:t,r:e}="function"==typeof this.params?this.params():this.params,i=this.target.getComputedAttribute("x"),r=this.target.getComputedAttribute("y"),n=this.target.getComputedAttribute("z"),s=Math.acos((r-t.y)/e),a=Math.acos((i-t.x)/e/Math.sin(s));n-t.z<0&&(a=is-a),this.theta=a,this.phi=s}onBind(){}onEnd(){}onUpdate(t,e,i){if(null==this.phi||null==this.theta)return;let{center:r,r:n,cb:s}="function"==typeof this.params?this.params():this.params,a=2*Math.PI*e,o=this.theta+a,l=this.phi,h=n*Math.sin(l)*Math.cos(o)+r.x,u=n*Math.cos(l)+r.y,d=n*Math.sin(l)*Math.sin(o)+r.z;for(i.x=h,i.y=u,i.z=d,i.alpha=o+ie/2;i.alpha>is;)i.alpha-=is;i.alpha=is-i.alpha,i.zIndex=-1e4*i.z,s&&s(i)}}class mZ extends nT{getEndProps(){return{}}onBind(){this.target.setTheme({common:{opacity:1}})}onEnd(){this.target.setTheme({common:{opacity:0}})}onUpdate(t,e,i){this.target.setTheme({common:{opacity:1-e}})}}class mX extends nT{constructor(t,e){super(null,null,t,"linear"),this.customAnimates=e}initAnimates(){this.customAnimates.forEach(t=>{t.step=this.step,t.subAnimate=this.subAnimate,t.target=this.target})}getEndProps(){let t={};return this.customAnimates.forEach(e=>{Object.assign(t,e.getEndProps())}),t}onBind(){this.initAnimates(),this.customAnimates.forEach(t=>{t.onBind()})}onEnd(){this.customAnimates.forEach(t=>{t.onEnd()})}onStart(){this.customAnimates.forEach(t=>{t.onStart()})}onUpdate(t,e,i){this.updating||(this.updating=!0,this.customAnimates.forEach(r=>{let n=r.easing;e=("string"==typeof n?nw[n]:n)(e),r.onUpdate(t,e,i)}),this.updating=!1)}}let mq=(t,e)=>{if(!t)return null;if(t.from){let i=t.from,r=Object.keys(i);r.forEach(t=>{ej(i[t])&&delete i[t]});let n=md(r,e.mark.markType)&&!eO(i.segments);if(n){let r=e.items.map(t=>Object.assign({},t,{nextAttrs:Object.assign({},i)}));t.from=e.transformElementItems(r,e.mark.markType,n)}}if(t.to){let i=t.to,r=Object.keys(i);r.forEach(t=>{ej(i[t])&&delete i[t]});let n=md(r,e.mark.markType)&&!eO(i.segments);if(n){let r=e.items.map(t=>Object.assign({},t,{nextAttrs:Object.assign({},i)}));t.to=e.transformElementItems(r,e.mark.markType,n)}}return t},mJ=(t,e,i,r,n)=>nx(i)?i(t.getDatum(),t,n):i;class mQ extends nT{constructor(t,e,i,r,n){super(t,e,i,r,n),this._interpolator=null==n?void 0:n.interpolator,this._element=null==n?void 0:n.element}onBind(){var t,e;this.from=null!==(t=this.from)&&void 0!==t?t:{},this.to=null!==(e=this.to)&&void 0!==e?e:{}}getEndProps(){return this.to}onUpdate(t,e,i){this._interpolator&&this._element&&this._interpolator.call(this,e,this.from,this.to,i,this._element.getDatum(),this._element,this.params.parameters)}}class m0 extends nT{getEndProps(){return this.to}onBind(){var t;let e=null!==(t=this.target.constructor.NOWORK_ANIMATE_ATTR)&&void 0!==t?t:st,i=Object.keys(e).filter(t=>0!==e[t]);this.subAnimate.animate.preventAttrs(i);let r=Object.assign({},this.from),n=Object.assign({},this.to),s=[];Object.keys(n).forEach(t=>{i.includes(t)?(r[t]=n[t],this.from[t]=n[t]):ej(r[t])?r[t]=this.target.getComputedAttribute(t):s.push(t)}),this.target.animates.forEach(t=>{t!==this.subAnimate.animate&&t.preventAttrs(s)}),this._fromAttribute=r,this._toAttribute=n}onStart(){if(this._fromAttribute){let t={};Object.keys(this._fromAttribute).forEach(e=>{this.subAnimate.animate.validAttr(e)&&(t[e]=this._fromAttribute[e])}),this.target.setAttributes(t,!1,{type:lw.ANIMATE_UPDATE,animationState:{ratio:0,end:!1}})}}onEnd(){if(this._toAttribute){let t={};Object.keys(this._toAttribute).forEach(e=>{this.subAnimate.animate.validAttr(e)&&(t[e]=this._toAttribute[e])}),this.target.setAttributes(t,!1,{type:lw.ANIMATE_END})}}update(t,e,i){0===this.updateCount&&this.onFirstRun(),this.updateCount+=1;let r=this.step.getLastProps();Object.keys(r).forEach(t=>{this.subAnimate.animate.validAttr(t)&&(i[t]=r[t])}),this.onUpdate(t,e,i),t&&this.onEnd()}onUpdate(t,e,i){this.target.stepInterpolate(this.subAnimate,this.subAnimate.animate,i,this.step,e,t,this._toAttribute,this._fromAttribute)}}nO.mode|=lC.SET_ATTR_IMMEDIATELY;let m1=0,m2=t=>{var e;if(ej(t)||ej(t.prototype))return!1;let i=null!==(e=t.prototype)&&void 0!==e?e:{};return i instanceof nT||"onBind"in i&&"onStart"in i&&"onEnd"in i&&"onUpdate"in i};class m3{constructor(t,e,i){this.id=m1++,this.isAnimating=!1,this.runnings=[],this.element=t,this.animationOptions=i,this.unit=e}callback(t){return this.callbackFunction=t,this}animate(t,e){return this.isAnimating=!0,this.animateElement(t,e),0===this.runnings.length&&this.animationEnd(),this}stop(t="end",e=!0){return this.runnings.forEach(e=>e.stop(t)),this.animationEnd(e),this}pause(){return this.runnings.forEach(t=>t.pause()),this}resume(){return this.runnings.forEach(t=>t.resume()),this}startAt(t){return this.runnings.forEach(e=>{let i=this.unit.initialDelay;e.startAt(i+t)}),this}getTotalAnimationTime(){var t;let e=this.unit.initialDelay+this.unit.loopDuration*this.unit.loopCount;return null!==(t=this.unit.totalTime)&&void 0!==t?t:e}getEndAttributes(){return this.runnings.reduce((t,e)=>Object.assign(t,e.getEndProps()),{})}animationEnd(t=!0){var e;this.isAnimating=!1,this.runnings=null,t&&(null===(e=this.callbackFunction)||void 0===e||e.call(null))}animateElement(t,e){let i=this.element.getGraphicItem();if(!i)return;let r=i.animate();this.runnings.push(r),r.startAt(this.unit.initialDelay),r.wait(this.unit.loopDelay),this.unit.timeSlices.forEach(i=>{this.animateTimeSlice(r,i,t,e)}),r.wait(this.unit.loopDelayAfter),r.loop(this.unit.loopCount-1),l1(this.unit.totalTime)&&setTimeout(()=>{r&&r.stop("end")},this.unit.totalTime),r.onEnd(()=>{this.runnings=this.runnings.filter(t=>t!==r),0===this.runnings.length&&this.animationEnd()})}animateTimeSlice(t,e,i,r){let n=e.delay,s=e.delayAfter,a=e.duration,o=e.effects;if(n>0&&t.wait(n),o.length<0)t.wait(a);else{let e=o.map((t,e)=>{var n;let s=null!==(n=t.type?function(t,e,i,r){let n=nx(e.options)?e.options.call(null,t.getDatum(),t,r):e.options;return e.type&&d0.getAnimationType(e.type)?mq(d0.getAnimationType(e.type)(t,n,i),t):null}(this.element,t,i,r):t.channel?function(t,e,i,r){let n=e.channel,s=null;return eM(n)?s=n.reduce((e,i)=>(e.from[i]=t.getGraphicAttribute(i,!0),e.to[i]=t.getGraphicAttribute(i,!1),e),{from:{},to:{}}):nb(n)&&(s=Object.keys(n).reduce((e,i)=>{var s,a;let o=!ej(null===(s=n[i])||void 0===s?void 0:s.from),l=!ej(null===(a=n[i])||void 0===a?void 0:a.to);return(o||l)&&(e.from[i]=o?mJ(t,0,n[i].from,0,r):void 0,e.to[i]=l?mJ(t,0,n[i].to,0,r):t.getGraphicAttribute(i,!1)),e},{from:{},to:{}})),mq(s,t)}(this.element,t,0,r):void 0)&&void 0!==n?n:{},o=s.custom||(null==t?void 0:t.custom),l=(null==s?void 0:s.customParameters)||(null==t?void 0:t.customParameters);s.from&&Object.keys(s.from).length&&this.unit&&this.animationOptions.timeline.controlOptions.immediatelyApply&&"component"!==this.element.mark.markType&&this.element.getGraphicItem().setAttributes(s.from);let h=m2(o);return ej(o)||m2(o)?h?new o(s.from,s.to,a,t.easing,l):s.to?new m0(s.from,s.to,a,t.easing):void 0:new mQ(s.from,s.to,a,t.easing,{interpolator:o,element:this.element,parameters:l})}).filter(t=>!ej(t));1===e.length?t.play(e[0]):e.length>1&&t.play(new mX(a,e))}s>0&&t.wait(s)}}function m5(t){let e=[];return Object.keys(t).forEach(i=>{e=e.concat(m4(i,t[i]))}),e}function m4(t,e,i=0){let r=[],n=i;return om(e).forEach(e=>{var i;let s=function(t){var e,i,r,n,s,a,o,l,h,u,d,c;if(ej(t.timeSlices))return{startTime:null!==(e=t.startTime)&&void 0!==e?e:0,totalTime:t.totalTime,oneByOne:null!==(i=t.oneByOne)&&void 0!==i&&i,loop:null!==(r=t.loop)&&void 0!==r&&r,controlOptions:eF({},fx,null!==(n=t.controlOptions)&&void 0!==n?n:{}),timeSlices:[{duration:null!==(s=t.duration)&&void 0!==s?s:1e3,delay:null!==(a=t.delay)&&void 0!==a?a:0,delayAfter:null!==(o=t.delayAfter)&&void 0!==o?o:0,effects:[{type:t.type,channel:t.channel,custom:t.custom,easing:null!==(l=t.easing)&&void 0!==l?l:fb,customParameters:t.customParameters,options:t.options}]}]};let p=om(t.timeSlices).filter(t=>t.effects&&om(t.effects).filter(t=>t.channel||t.type).length);if(p.length)return{startTime:null!==(h=t.startTime)&&void 0!==h?h:0,totalTime:t.totalTime,oneByOne:null!==(u=t.oneByOne)&&void 0!==u&&u,loop:null!==(d=t.loop)&&void 0!==d&&d,controlOptions:eF({},fx,null!==(c=t.controlOptions)&&void 0!==c?c:{}),timeSlices:p.map(t=>{var e,i;return{duration:t.duration,delay:null!==(e=t.delay)&&void 0!==e?e:0,delayAfter:null!==(i=t.delayAfter)&&void 0!==i?i:0,effects:om(t.effects).filter(t=>t.channel||t.type).map(t=>{var e;return{type:t.type,channel:t.channel,custom:t.custom,easing:null!==(e=t.easing)&&void 0!==e?e:fb,customParameters:t.customParameters,options:t.options}})}}),partitioner:t.partitioner,sort:t.sort}}(e);s&&(r.push({state:t,id:null!==(i=s.id)&&void 0!==i?i:`${t}-${n}`,timeline:s,originConfig:e}),n+=1)}),r}function m8(t,e,i){return nx(t)?t.call(null,e.getDatum(),e,i):t}class m6{constructor(t){this.parallelArrangers=[this],this.totalTime=0,this.startTime=0,this.endTime=0,this.animators=t.filter(t=>!ej(t)),this.totalTime=this.animators.reduce((t,e)=>Math.max(t,e.getTotalAnimationTime()),0)}parallel(t){let e=Array.from(new Set(this.parallelArrangers.concat(t.parallelArrangers)));return e.forEach(t=>{t.parallelArrangers=e}),this.arrangeTime(),this}after(t){return this.afterArranger=t,this.arrangeTime(),this}arrangeTime(){let t=this.parallelArrangers.reduce((t,e)=>Math.max(t,e.totalTime),this.totalTime),e=this.parallelArrangers.reduce((t,e)=>{var i,r;return Math.max(t,null!==(r=null===(i=e.afterArranger)||void 0===i?void 0:i.endTime)&&void 0!==r?r:0)},0);this.parallelArrangers.forEach(i=>{i.startTime=e,i.endTime=e+t,i.animators.forEach(t=>{t.startAt(e)})})}}class m9{constructor(t,e){this.state=null,this.immediateConfigs=[],this.isEnabled=!0,this.disabledStates=[],this.animators=new Map,this.elementRecorder=new WeakMap,this.timelineCount={},this.mark=t,this.configs=m5(null!=e?e:{})}getAnimationConfigs(t){var e;return this.isEnabled?(null!==(e=this.configs)&&void 0!==e?e:[]).filter(e=>e.state===t):[]}updateConfig(t){this.configs=m5(null!=t?t:{})}updateState(t){this.state=t}animate(){if(!this.isEnabled||!this.configs||!this.configs.length)return;let t=this.mark.getAllElements(),e=this.mark.parameters();return t.forEach(t=>{var e;t.isReserved&&t.diffState!==c4.exit&&(t.isReserved=!1);let i=null===(e=this.elementRecorder.get(t))||void 0===e?void 0:e.prevState;this.configs.some(e=>i!==t.diffState&&e.state===i&&e.timeline.controlOptions.stopWhenStateChange)&&this.clearElementAnimation(t,!1)}),this.configs.forEach(i=>{this.animateByTimeline(i,t,e)}),this.mark.cleanExitElements(),this}runAnimationByState(t){if(!this.isEnabled)return;let e=this.configs.filter(e=>e.state===t),i=this.mark.getAllElements(),r=this.mark.parameters();return new m6(e.reduce((t,e)=>t.concat(this.animateByTimeline(e,i,r,!0)),[]))}stopAnimationByState(t){let e=this.animators.get(t);return e&&e.forEach(t=>t.stop()),this}pauseAnimationByState(t){let e=this.animators.get(t);return e&&e.forEach(t=>t.pause()),this}resumeAnimationByState(t){let e=this.animators.get(t);return e&&e.forEach(t=>t.resume()),this}run(t){if(!this.isEnabled)return;let e=m4(f_,t,this.immediateConfigs.length);this.immediateConfigs=this.immediateConfigs.concat(e);let i=this.mark.getAllElements(),r=this.mark.parameters();return new m6(e.reduce((t,e)=>t.concat(this.animateByTimeline(e,i,r,!0)),[]))}stop(){return this.animators.forEach(t=>{t.forEach(t=>t.stop())}),this}pause(){return this.animators.forEach(t=>t.forEach(t=>t.pause())),this}resume(){return this.animators.forEach(t=>t.forEach(t=>t.resume())),this}reverse(){return this}restart(){return this}record(){return this}recordEnd(){return this}isAnimating(){let t=!1;return this.animators.forEach(e=>{t=t||e.some(t=>t.isAnimating)}),t}isElementAnimating(t){var e;let i=null===(e=this.elementRecorder.get(t))||void 0===e?void 0:e.count;return ej(i)||Object.values(i).every(t=>0===t)}getAnimatorCount(){let t=0;return this.animators.forEach(e=>t+=e.length),t}getAllAnimators(){let t=[];return this.animators.forEach(e=>{t.push(...e)}),t}getElementAnimators(t,e){var i;let r=om(t),n=[];return e?n=null!==(i=this.animators.get(e))&&void 0!==i?i:[]:this.animators.forEach(t=>{n=n.concat(t)}),n.filter(t=>r.includes(t.element))}enable(){return this.isEnabled=!0,this}disable(){return this.isEnabled=!1,this.stop(),this.animators.clear(),this}enableAnimationState(t){let e=om(t);return this.disabledStates=this.disabledStates.filter(t=>!e.includes(t)),this}disableAnimationState(t){let e=om(t);return this.disabledStates=this.disabledStates.concat(e),this}release(){this.stop(),this.animators.clear(),this.configs=null,this.animators=null,this.elementRecorder=null,this.timelineCount=null}animateByTimeline(t,e,i,r=!1){var n;let s=[],a=e.filter(e=>{let n=!(e.isReserved&&e.diffState===c4.exit),s=this.getAnimationState(e),a=!this.disabledStates.includes(s),o=r||s===t.state,l=!t.timeline.partitioner||t.timeline.partitioner(e.getDatum(),e,i);return n&&a&&o&&l});if(a.length){ej(this.timelineCount[t.id])&&(this.timelineCount[t.id]=0),t.timeline.sort&&a.sort((e,r)=>t.timeline.sort(e.getDatum(),r.getDatum(),e,r,i));let e={width:this.mark.view.width(),height:this.mark.view.height(),group:null!==(n=this.mark.group)&&void 0!==n?n:null,mark:this.mark,view:this.mark.view,elementCount:a.length,elementIndex:0};a.forEach((r,n)=>{e.elementIndex=n;let o=Object.assign({VGRAMMAR_ANIMATION_PARAMETERS:e},i),l=this.getAnimationUnit(t.timeline,r,n,a.length,o);s.push(this.animateElement(t,l,r,e,o))})}return s}animateElement(t,e,i,r,n){var s,a;let o=new m3(i,e,t);if(o.animate(r,n),!o.isAnimating)return;i.diffState===c4.exit&&(i.isReserved=!0);let l=0===this.timelineCount[t.id];this.timelineCount[t.id]+=1;let h=null!==(s=this.elementRecorder.get(i))&&void 0!==s?s:{prevState:t.state,count:{}};h.prevState=t.state,h.count[t.state]=(null!==(a=h.count[t.state])&&void 0!==a?a:0)+1,this.elementRecorder.set(i,h);let u=this.animators.get(t.state);u?u.push(o):this.animators.set(t.state,[o]),o.callback(()=>{this.handleAnimatorEnd(o)});let d={mark:this.mark,animationState:t.state,animationConfig:t.originConfig};return l&&this.mark.emit(pa.ANIMATION_START,d),this.mark.emit(pa.ELEMENT_ANIMATION_START,d,i),o}getAnimationState(t){let e=gN(this.state,this.mark.parameters(),t.getDatum(),t);return null!=e?e:t.diffState}getAnimationUnit(t,e,i,r,n){let s=[],a=m8(t.startTime,e,n),o=m8(t.totalTime,e,n),l=m8(t.oneByOne,e,n),h=m8(t.loop,e,n),u=0;t.timeSlices.forEach(t=>{var i;let a=m8(t.delay,e,n),l=m8(t.delayAfter,e,n),h=null!==(i=m8(t.duration,e,n))&&void 0!==i?i:o/r,d=om(t.effects).map(t=>Object.assign({},t,{customParameters:m8(t.customParameters,e,n)}));s.push({effects:d,duration:h,delay:a,delayAfter:l}),u+=a+h+l});let d=ey(l)?l:!0===l?u:0;return{initialDelay:a,loopCount:ey(h)?h:!0===h?1/0:1,loopDelay:d*i,loopDelayAfter:d*(r-i-1),loopAnimateDuration:u,loopDuration:u+d*(r-1),totalTime:o,timeSlices:s}}clearElementAnimation(t,e=!0){this.animators.forEach(i=>{i.forEach(i=>{i.element===t&&(i.animationOptions.state===c4.exit?i.stop("start",!1):i.stop("end",!1),this.handleAnimatorEnd(i,e))})}),this.elementRecorder.delete(t)}clearAllElements(){let t=this.mark.getAllElements();t&&t.forEach((e,i)=>{this.clearElement(e,i===t.length-1)})}clearElement(t,e=!0){this.clearElementAnimation(t),t.getGraphicItem()&&(t.clearGraphicAttributes(),t.diffState===c4.exit&&(t.isReserved=!1),e&&this.mark.cleanExitElements())}handleAnimatorEnd(t,e=!0){let i=t.element,r=t.animationOptions,n=r.state,s=n===f_,a=this.elementRecorder.get(i).count;a[n]-=1,this.animators.set(n,this.animators.get(n).filter(e=>e!==t)),0===this.animators.get(n).length&&this.animators.delete(n),this.timelineCount[r.id]-=1;let o=0===this.timelineCount[r.id],l=s?this.immediateConfigs.find(t=>t.id===r.id).originConfig:this.configs.find(t=>t.id===r.id).originConfig;o&&(delete this.timelineCount[r.id],s&&(this.immediateConfigs=this.immediateConfigs.filter(t=>t.id!==r.id))),e&&(0===Object.keys(this.timelineCount).length?this.clearAllElements():n===c4.exit&&0===a[c4.exit]&&this.clearElement(i));let h={mark:this.mark,animationState:n,animationConfig:l};o&&this.mark.emit(pa.ANIMATION_END,h),this.mark.emit(pa.ELEMENT_ANIMATION_END,h,i)}}class m7 extends g${constructor(t,e,i){super(t),this.grammarType="mark",this.elements=[],this.elementMap=new Map,this.isUpdated=!0,this._isReentered=!1,this.animate=new m9(this,{}),this.differ=new mV([]),this.markType=e,this.spec.type=e,this.spec.encode={update:{}},this.spec.group=i,i&&(this.group=i,this.attach(i),i.appendChild(this))}parse(t){var e,i,r;if(super.parse(t),this.spec.group){let t=eE(this.spec.group)?this.view.getMarkById(this.spec.group):this.spec.group;this.detach(t)}let n=eE(t.group)?this.view.getMarkById(t.group):t.group;return this.attach(n),this.join(null===(e=t.from)||void 0===e?void 0:e.data,t.key,t.sort,t.groupBy,t.groupSort),this.coordinate(t.coordinate),this.state(t.state,this.spec.stateSort),Object.keys(null!==(i=this.spec.encode)&&void 0!==i?i:{}).forEach(t=>{this.encodeState(t,{},!0)}),Object.keys(null!==(r=t.encode)&&void 0!==r?r:{}).forEach(e=>{this.encodeState(e,t.encode[e])}),this.animation(t.animation),this.animationState(t.animationState),this.morph(t.morph,t.morphKey,t.morphElementKey),this.layout(t.layout),this.configure(t),this.transform(t.transform),this.parseAddition(t),this.spec=t,this.markType=t.type,this.commit(),this}parameters(){var t;return null!==(t=this._finalParameters)&&void 0!==t?t:super.parameters()}parseAddition(t){return this}reuse(t){return t.grammarType!==this.grammarType?this:(this.markType=t.markType,this.coord=t.coord,this.elementMap=t.elementMap,this.elements=t.elements,this.elementMap.forEach(t=>t.mark=this),this.differ=t.differ,this.animate=t.animate,this.animate.mark=this,this._context=t._context,this.graphicItem=t.graphicItem,this.graphicIndex=t.graphicIndex,this.graphicParent=t.graphicParent,this.needClear=t.needClear,this.isUpdated=t.isUpdated,this)}needLayout(){return!ej(this.spec.layout)}handleLayoutEnd(){}handleRenderEnd(){this.needClear&&(this.cleanExitElements(),this.elementMap.forEach(t=>{t.diffState===c4.exit?t.clearGraphicAttributes():t.clearChangedGraphicAttributes()}),this.differ.updateToCurrent(),this.needClear=!1)}evaluateMainTasks(t,e){var i;if(this.needSkipBeforeLayout()&&this.view.getLayoutState()===ps.before)return this;let r=null===(i=this.view.renderer)||void 0===i?void 0:i.stage();this.init(r,e);let n=this.evaluateTransform(this._getTransformsBeforeJoin(),null!=t?t:fv,e),s=(null==n?void 0:n.progressive)?t:n;return this.evaluateGroup(s),this.renderContext=this.parseRenderContext(s,e),this.renderContext.progressive?(this.differ.reset(),this.elementMap.clear(),this.evaluateProgressive()):((null==n?void 0:n.progressive)&&(this.renderContext.parameters=e,this.renderContext.beforeTransformProgressive=n.progressive,s=n.progressive.output()),this.emit(pa.BEFORE_MARK_JOIN),this.evaluateJoin(s),this.emit(pa.AFTER_MARK_JOIN),this.emit(pa.BEFORE_MARK_STATE),this.evaluateState(this.elements,this.spec.state,e),this.emit(pa.AFTER_MARK_STATE),this.emit(pa.BEFORE_MARK_ENCODE),this.evaluateEncode(this.elements,this._getEncoders(),e),this.emit(pa.AFTER_MARK_ENCODE)),this.emit(pa.BEFORE_MARK_UPDATE),this.update(this.spec),this.emit(pa.AFTER_MARK_UPDATE),this}evaluateGroup(t){if(this.markType===c8.group)return;let e=mH(null!=t?t:fv,this.spec.groupBy,this.spec.groupSort),i=e.keys;this._groupKeys=i,this._groupEncodeResult=null,this.differ.setCurrentData(e)}_getTransformsAfterEncodeItems(){return this.transforms&&this.transforms.filter(t=>"afterEncodeItems"===t.markPhase)}_getTransformsAfterEncode(){return this.transforms&&this.transforms.filter(t=>ej(t.markPhase)||"afterEncode"===t.markPhase)}_getTransformsBeforeJoin(){return this.transforms?this.transforms.filter(t=>"beforeJoin"===t.markPhase):[]}evaluate(t,e){var i;return this.evaluateMainTasks(t,e),(null===(i=this.renderContext)||void 0===i?void 0:i.progressive)||this.evaluateTransform(this._getTransformsAfterEncode(),this.elements,e),this}output(){return this}join(t,e,i,r,n){return this.grammarSource&&(this.detach(this.grammarSource),this.grammarSource=null),this.spec.from=null,ej(t)||(eE(t)?this.grammarSource=this.view.getDataById(t):this.grammarSource=t,this.spec.from={data:t},this.attach(this.grammarSource)),this.spec.key=e,this.spec.sort=i,this.spec.groupBy=r,this.spec.groupSort=n,this.commit(),this}coordinate(t){return eE(t)?this.coord=this.view.getCoordinateById(t):this.coord=t,this.attach(this.coord),this.commit(),this}state(t,e){return this.spec.stateSort=e,this.setFunctionSpec(t,"state")}encode(t,e,i){return this.encodeState(c4.update,t,e,i)}encodeState(t,e,i,r){if(t===c4.enter&&(this._isReentered=!0),this.spec.encode[t]){let n=this.spec.encode[t];if(gj(n))this.detach(mC(n,this.view));else{let s=eE(e);s&&r||!s&&i?(Object.keys(n).forEach(t=>{this.detach(mC(n[t],this.view))}),this.spec.encode[t]={}):s?this.detach(mC(n[e],this.view)):Object.keys(e).forEach(t=>{this.detach(mC(n[t],this.view))})}}return e&&(this.spec.encode[t]||(this.spec.encode[t]={}),eE(e)?(this.spec.encode[t][e]=i,this.attach(mC(i,this.view))):gj(e)?(this.spec.encode[t]=e,this.attach(mC(e,this.view))):e&&(Object.assign(this.spec.encode[t],e),Object.values(e).forEach(t=>{this.attach(mC(t,this.view))}))),this.commit(),this}_getEncoders(){var t;return null!==(t=this.spec.encode)&&void 0!==t?t:{}}animation(t){return this.spec.animation=t,this}animationState(t){return this.setFunctionSpec(t,"animationState")}layout(t){return this.spec.layout=t,this.commit(),this}morph(t,e,i){return this.spec.morph=t,this.spec.morphKey=e,this.spec.morphElementKey=i,this}transform(t){let e=gX(this.spec.transform,this.view);e&&(this.detach(e.refs),this.transforms=[]);let i=gX(t,this.view);return i&&(this.attach(i.refs),this.transforms=i.transforms),this.spec.transform=t,this.commit(),this}configure(t){let e=["clip","clipPath","zIndex","interactive","context","setCustomizedShape","large","largeThreshold","progressiveStep","progressiveThreshold","support3d","morph","morphKey","morphElementKey","attributeTransforms","skipTheme","enableSegments","stateSort"];return null===t?e.forEach(t=>{ej(this.spec[t])||(this.spec[t]=void 0)}):e.forEach(e=>{ej(t[e])||(this.spec[e]=t[e])}),this}context(t){return this.spec.context=t,this._context=t,this}isCollectionMark(){return ff.includes(this.markType)}needAnimate(){var t;return!(null===(t=this.renderContext)||void 0===t?void 0:t.progressive)&&!ej(this.spec.animation)}getAllElements(){let t=this.elements.slice();return this.elementMap.forEach(e=>{e.diffState!==c4.exit||t.includes(e)||t.push(e)}),this.spec.sort&&t.sort((t,e)=>this.spec.sort(t.getDatum(),e.getDatum())),t}getScales(){let t={};return this.references.forEach((e,i)=>{i.grammarType===po.scale&&(t[i.id()]=i.output())}),t}getScalesByChannel(){let t=this.spec.encode;if(!t)return{};let e={},i=this.parameters();return Object.keys(t).forEach(r=>{let n=t[r];n&&!gj(n)&&Object.keys(n).forEach(t=>{mw(n[t])&&(e[t]=gz(n[t].scale,i))})}),e}getFieldsByChannel(){let t=this.spec.encode;if(!t)return{};let e={};return Object.keys(t).forEach(i=>{let r=t[i];gj(r)||Object.keys(r).forEach(t=>{mM(r[t])&&(e[t]=r[t].field)})}),e}init(t,e){var i,r,n,s;if(this._delegateEvent||(this._delegateEvent=(t,e)=>{var i;let r=null===(i=t.target)||void 0===i?void 0:i[fg];if((null==r?void 0:r.mark)===this){let i=f6(this.view,t,r,e,g1);this.emitGrammarEvent(e,i,r)}},this.initEvent()),this.animate||(this.animate=new m9(this,this.spec.animation),this.needAnimate()&&this.animate.updateState(this.spec.animationState)),!this.group){let t=gz(this.spec.group,e);this.group=t,t&&t.appendChild(this)}let a=this.group?this.group.getGroupGraphicItem():t.defaultLayer,o=null!==(n=null===(r=null===(i=this.group)||void 0===i?void 0:i.children)||void 0===r?void 0:r.indexOf(this))&&void 0!==n?n:0;if(this.markType!==c8.group){if(!this.graphicItem){let t=ma(this,c8.group,{pickable:!1,zIndex:null!==(s=this.spec.zIndex)&&void 0!==s?s:0});(this.spec.support3d||fm.includes(this.markType))&&t.setMode("3d"),t.name=`${this.id()||this.markType}`,this.graphicItem=t}this.graphicParent=this.graphicItem,a&&(this.graphicIndex!==o||this.graphicItem.parent!==a)&&a.insertIntoKeepIdx(this.graphicItem,o)}else this.graphicParent=a;this.graphicIndex=o}update(t){if(this._context=this.spec.context,this.isUpdated=!0,this.renderContext.progressive||(this.animate.updateConfig(t.animation),this.animate.updateState(t.animationState)),this.markType!==c8.group){if(ej(t.zIndex)||this.graphicItem.setAttribute("zIndex",t.zIndex),ej(t.clip)||this.graphicItem.setAttribute("clip",t.clip),!ej(t.clipPath)){let e=eM(t.clipPath)?t.clipPath:t.clipPath(this.elements);e&&e.length?this.graphicItem.setAttribute("path",e):this.graphicItem.setAttributes({path:e,clip:!1})}this.elementMap.forEach(t=>{t.updateGraphicItem()})}else this.elementMap.forEach(t=>{t.updateGraphicItem()})}evaluateJoin(t){var e,i,r,n;this.needClear=!0;let s=gV(null!==(r=null!==(e=this.spec.key)&&void 0!==e?e:null===(i=this.grammarSource)||void 0===i?void 0:i.getDataIDKey())&&void 0!==r?r:()=>"key"),a=gV(null!==(n=this.spec.groupBy)&&void 0!==n?n:()=>"key"),o=this.spec.sort,l=this.isCollectionMark(),h=new Set(this.elements.filter(t=>t.diffState===c4.enter)),u=[];this.differ.setCallback((t,e,i)=>{let r;if(ej(e))(r=this.elementMap.get(t))&&(r.diffState=c4.exit);else if(ej(i)){(r=this.elementMap.has(t)?this.elementMap.get(t):mz(this)).diffState===c4.exit&&(r.diffState=c4.enter,this.animate.getElementAnimators(r,c4.exit).forEach(t=>t.stop("start"))),r.diffState=c4.enter;let i=l?t:a(e[0]);r.updateData(i,e,s,this.view),this.elementMap.set(t,r),u.push(r)}else if(r=this.elementMap.get(t)){r.diffState=c4.update;let i=l?t:a(e[0]);r.updateData(i,e,s,this.view),u.push(r)}h.delete(r)});let d=null!=t?t:fv;l||this.differ.setCurrentData(mH(d,t=>`${a(t)}-${s(t)}`,void 0)),this.differ.doDiff(),h.forEach(t=>{this.elementMap.delete(l?t.groupKey:`${t.groupKey}-${t.key}`),t.remove(),t.release()}),this.elements=u,o&&this.elements.length>=2&&this.elements.sort((t,e)=>o(t.getDatum(),e.getDatum()))}evaluateState(t,e,i){e&&t.forEach(t=>{t.state(e,i)})}evaluateGroupEncode(t,e,i){if(!this._groupKeys||!e)return;let r={};return this._groupKeys.forEach(n=>{let s=t.find(t=>t.groupKey===n);s&&(r[n]=mE(e,s.items&&s.items[0]&&s.items[0].datum,s,i))}),this._groupEncodeResult=r,r}getChannelsFromConfig(t){let e=this.spec;return ej(e.interactive)?null:{pickable:e.interactive}}evaluateEncode(t,e,i,r){let n=this.getChannelsFromConfig();if(e){this.emit(pa.BEFORE_ELEMENT_ENCODE,{encoders:e,parameters:i},this);let s=r?null:this.evaluateGroupEncode(t,e[c5.group],i);t.forEach(t=>{this.markType===c8.glyph&&this._groupEncodeResult?t.items.forEach(e=>{e.nextAttrs=Object.assign(e.nextAttrs,n,this._groupEncodeResult[t.groupKey])}):(null==s?void 0:s[t.groupKey])&&!this.isCollectionMark()?t.items.forEach(e=>{e.nextAttrs=Object.assign(e.nextAttrs,n,s[t.groupKey])}):n&&t.items.forEach(t=>{t.nextAttrs=Object.assign(t.nextAttrs,n)}),t.encodeItems(t.items,e,this._isReentered,i),this.isCollectionMark()&&(null==s?void 0:s[t.groupKey])&&eO(s[t.groupKey].defined)&&(t.items.forEach(e=>{e.nextAttrs.defined=s[t.groupKey].defined}),delete s[t.groupKey].defined)}),this._isReentered=!1,this.evaluateTransform(this._getTransformsAfterEncodeItems(),t,i),t.forEach(t=>{t.encodeGraphic(this.isCollectionMark()?null==s?void 0:s[t.groupKey]:null)}),this.emit(pa.AFTER_ELEMENT_ENCODE,{encoders:e,parameters:i},this)}else t.forEach(t=>{t.initGraphicItem(n)})}addGraphicItem(t,e,i){var r;let n=null!=i?i:ma(this,this.markType,t);if(n){if(null===(r=this.renderContext)||void 0===r?void 0:r.progressive){let t;if(this._groupKeys){let i=this._groupKeys.indexOf(e);i>=0&&(t=this.graphicParent.getChildAt(i))}else t=this.graphicParent.at(0);this.isCollectionMark()?(n.incremental=1,t.appendChild(n)):t.incrementalAppendChild(n)}else this.graphicParent.appendChild(n);return n}}parseRenderContext(t,e){let i=this.markType!==c8.group&&this.spec.progressiveStep>0&&this.spec.progressiveThreshold>0&&this.spec.progressiveStep<this.spec.progressiveThreshold,r=this.spec.large&&this.spec.largeThreshold>0&&t.length>=this.spec.largeThreshold;if(i){let i=this.differ.getCurrentData();return i&&i.keys&&i.keys.some(t=>i.data.get(t).length>this.spec.progressiveThreshold)?{large:r,parameters:e,progressive:{data:t,step:this.spec.progressiveStep,currentIndex:0,totalStep:i.keys.reduce((t,e)=>Math.max(Math.ceil(i.data.get(e).length/this.spec.progressiveStep),t),1),groupedData:i.data}}:{large:r}}return{large:r}}isProgressive(){return this.renderContext&&(!!this.renderContext.progressive||!!this.renderContext.beforeTransformProgressive)}isDoingProgressive(){return this.renderContext&&(this.renderContext.progressive&&this.renderContext.progressive.currentIndex<this.renderContext.progressive.totalStep||this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.unfinished())}clearProgressive(){this.renderContext&&this.renderContext.progressive&&(this.elements=[],this.graphicParent.children.forEach(t=>{t.incrementalClearChild()}),this.graphicParent.removeAllChild()),this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.release(),this.renderContext=null}restartProgressive(){this.renderContext&&this.renderContext.progressive&&(this.renderContext.progressive.currentIndex=0)}evaluateJoinProgressive(){var t,e,i;let r=this.renderContext.progressive.currentIndex,n=gV(null!==(i=null!==(t=this.spec.key)&&void 0!==t?t:null===(e=this.grammarSource)||void 0===e?void 0:e.getDataIDKey())&&void 0!==i?i:()=>"key"),s=[];if(this.isCollectionMark())return this._groupKeys.forEach((t,e)=>{let i=this.renderContext.progressive.groupedData.get(t),a=this.renderContext.progressive.step,o=i.slice(r*a,(r+1)*a);if(0===r){let e=mz(this);e.diffState=c4.enter,e.updateData(t,o,n,this.view),s.push(e)}else{let i=this.elements[e];i.updateData(t,o,n,this.view),s.push(i)}}),s;let a={};return this._groupKeys.forEach(t=>{let e=this.renderContext.progressive.groupedData.get(t),i=this.renderContext.progressive.step,o=e.slice(r*i,(r+1)*i),l=[];o.forEach(e=>{let i=mz(this);i.diffState=c4.enter,i.updateData(t,[e],n,this.view),l.push(i),s.push(i)}),a[t]=l}),{groupElements:a,elements:s}}evaluateEncodeProgressive(t,e,i){let r=this.renderContext.progressive.currentIndex;if(0===r){if(this.evaluateEncode(t,e,i),0===r&&this._groupEncodeResult&&!this.isCollectionMark()&&this.markType!==c8.glyph){let e=t[0],i=e.getGraphicItem(),r=null==i?void 0:i.parent;r&&this._groupEncodeResult[e.groupKey]&&r.setTheme({common:this._groupEncodeResult[e.groupKey]})}}else this.evaluateEncode(t,e,i,!0)}evaluateProgressive(){var t,e,i;if(null===(t=this.renderContext)||void 0===t?void 0:t.beforeTransformProgressive){this.renderContext.beforeTransformProgressive.progressiveRun();let t=this.renderContext.beforeTransformProgressive.output();return this.emit(pa.BEFORE_MARK_JOIN),this.evaluateJoin(t),this.emit(pa.AFTER_MARK_JOIN),this.emit(pa.BEFORE_MARK_STATE),this.evaluateState(this.elements,this.spec.state,this.renderContext.parameters),this.emit(pa.AFTER_MARK_STATE),this.emit(pa.BEFORE_MARK_ENCODE),this.evaluateEncode(this.elements,this._getEncoders(),this.renderContext.parameters),void this.emit(pa.AFTER_MARK_ENCODE)}if(!(null===(e=this.renderContext)||void 0===e?void 0:e.progressive))return;let r=this.renderContext.parameters;this.emit(pa.BEFORE_MARK_JOIN);let n=this.evaluateJoinProgressive(),s=Array.isArray(n)?n:n.elements;if(this.emit(pa.AFTER_MARK_JOIN),0===this.renderContext.progressive.currentIndex?(this.graphicParent.removeAllChild(),this._groupKeys.forEach(t=>{let e=ma(this,c8.group,{pickable:!1,zIndex:this.spec.zIndex});e.incremental=this.renderContext.progressive.step,this.graphicParent.appendChild(e)}),this.elements=s):this.elements=this.elements.concat(s),this.emit(pa.BEFORE_MARK_STATE),this.evaluateState(s,this.spec.state,r),this.emit(pa.AFTER_MARK_STATE),this.emit(pa.BEFORE_MARK_ENCODE),Array.isArray(n))this.evaluateEncodeProgressive(s,this._getEncoders(),r);else{let t=n.groupElements;Object.keys(t).forEach(e=>{this.evaluateEncodeProgressive(t[e],this._getEncoders(),r)})}this.emit(pa.AFTER_MARK_ENCODE);let a=null===(i=this._getTransformsAfterEncode())||void 0===i?void 0:i.filter(t=>!0===t.canProgressive);(null==a?void 0:a.length)&&this.evaluateTransform(a,this.elements,r),this.renderContext.progressive.currentIndex+=1}isLargeMode(){return this.renderContext&&this.renderContext.large}cleanExitElements(){this.elementMap.forEach((t,e)=>{t.diffState!==c4.exit||t.isReserved||(this.elementMap.delete(e),t.remove(),t.release())})}getGroupGraphicItem(){if(this.elements&&this.elements[0]&&this.elements[0].getGraphicItem)return this.elements[0].getGraphicItem()}getBounds(){var t;return this.graphicItem?this.graphicItem.AABBBounds:null===(t=this.getGroupGraphicItem())||void 0===t?void 0:t.AABBBounds}getMorphConfig(){var t;return{morph:null!==(t=this.spec.morph)&&void 0!==t&&t,morphKey:this.spec.morphKey,morphElementKey:this.spec.morphElementKey}}getAttributeTransforms(){var t;return null!==(t=this.spec.attributeTransforms)&&void 0!==t?t:mg[this.markType]}getContext(){return this._context}needSkipBeforeLayout(){var t,e;if(!0===(null===(t=this.spec.layout)||void 0===t?void 0:t.skipBeforeLayouted))return!0;let i=this.group;for(;i;){if(!0===(null===(e=i.getSpec().layout)||void 0===e?void 0:e.skipBeforeLayouted))return!0;i=i.group}return!1}initEvent(){if(this._delegateEvent){let t=this.view.renderer.stage();t&&t.on("*",this._delegateEvent)}}releaseEvent(){if(this._delegateEvent){let t=this.view.renderer.stage();t&&t.off("*",this._delegateEvent)}}clear(){var t;this.releaseEvent(),this.transforms=null,this.elementMap=null,this.elements=null,this.graphicItem=null,this.animate=null,null===(t=this.group)||void 0===t||t.removeChild(this),this.group=null,super.clear()}prepareRelease(){this.animate.stop(),this.elementMap.forEach(t=>t.diffState=c4.exit),this._finalParameters=this.parameters()}release(){this.releaseEvent(),this.elements.forEach(t=>t.release()),this.elementMap.clear(),this._finalParameters=null,this.animate&&this.animate.release(),this.graphicItem&&mo(this.graphicItem),this.detachAll(),super.release()}}class vt extends m7{constructor(t,e){super(t,c8.group,e),this.children=[]}parseRenderContext(){return{large:!1}}appendChild(t){return this.children.push(t),this}removeChild(t){return this.children=this.children.filter(e=>e!==t),this}includesChild(t,e=!0){return!!this.children.includes(t)||!!e&&this.children.some(e=>e.markType===c8.group&&e.includesChild(t,!0))}updateLayoutChildren(){return this.children.length&&(this.layoutChildren||(this.layoutChildren=[]),this.layoutChildren=this.children.filter(t=>t.needLayout())),this}getAttributeTransforms(){return mg.rect}evaluateJoin(t){if(!this.elements.length){let t=mz(this);t.updateData("key",fv,()=>"",this.view),this.elements=[t],this.elementMap.set("key",t)}}getChannelsFromConfig(t){let e=this.spec,i={};if(ej(e.clip)||(i.clip=e.clip),ej(e.zIndex)||(i.zIndex=e.zIndex),!ej(e.clipPath)){let r=nx(e.clipPath)?e.clipPath([t]):e.clipPath;r&&r.length?i.path=r:(i.path=null,i.clip=!1)}return ej(e.interactive)||(i.pickable=e.interactive),i}evaluateGroupEncode(t,e,i){var r;let n=this.elements[0],s={},a=[Object.assign({},null===(r=n.items)||void 0===r?void 0:r[0],{nextAttrs:s})];return mT(n,a,e,i),this._groupEncodeResult=s,s}evaluateEncode(t,e,i,r){let n=this.getChannelsFromConfig();if(e){this.emit(pa.BEFORE_ELEMENT_ENCODE,{encoders:e,parameters:i},this);let s=r?null:this.evaluateGroupEncode(t,e[c5.group],i);t.forEach(t=>{t.items.forEach(t=>{t.nextAttrs=Object.assign(t.nextAttrs,n,s)}),t.encodeItems(t.items,e,this._isReentered,i)}),this._isReentered=!1,this.evaluateTransform(this._getTransformsAfterEncodeItems(),t,i),t.forEach(t=>{t.encodeGraphic()}),this.emit(pa.AFTER_ELEMENT_ENCODE,{encoders:e,parameters:i},this)}else t.forEach(t=>{t.initGraphicItem(n)})}addGraphicItem(t,e,i){let r=null!=i?i:ma(this,this.markType,t);if(r)return this.emit(pa.BEFORE_ADD_VRENDER_MARK,{graphicItem:r}),r.name=`${this.id()||this.markType}`,this.graphicParent.insertIntoKeepIdx(r,this.graphicIndex),this.emit(pa.AFTER_ADD_VRENDER_MARK,{graphicItem:r}),r}}function ve(t,e){if(l1(t))return t;let i=t.trim();if("auto"===i)return 0;if(i.endsWith("%")){let t=parseFloat(i.substring(0,i.length-1));return l1(t)?t*e:0}return 0}function vi(t,e){return Math.min(t<0?t+e:t-1,e)}function vr(t,e,i){let r=vi(t,i),n=vi(e,i);if(l1(t)||l1(e)?l1(t)?l1(e)||(r=vi(Math.max(0,n-1),i)):n=vi(r+1,i):(r=1,n=2),r>n){let t=n;n=r,r=t}return{start:r,end:n}}let vn=(t,e,i,r)=>{let n=function(t,e,i){var r,n,s,a;let o=null!==(r=t.gridTemplateRows)&&void 0!==r?r:[i],l=null!==(n=t.gridTemplateColumns)&&void 0!==n?n:[e],h=null!==(s=t.gridRowGap)&&void 0!==s?s:0,u=null!==(a=t.gridColumnGap)&&void 0!==a?a:0,d=o.map(t=>ve(t,i)),c=l.map(t=>ve(t,e)),p=Math.max(0,d.reduce((t,e)=>t-e,i)-d.length*h)/o.filter(t=>"auto"===t).length,g=Math.max(0,c.reduce((t,e)=>t-e,e)-c.length*u)/l.filter(t=>"auto"===t).length,f=0,m=d.map((t,e)=>{let i="auto"===o[e]?p:t,r=f;return f+=i+h,r});m.push(f);let v=0,y=c.map((t,e)=>{let i="auto"===l[e]?g:t,r=v;return v+=i+u,r});return y.push(v),{rows:m,columns:y,rowGap:h,columnGap:u}}(t.getSpec().layout,i.width(),i.height());e&&e.forEach(t=>{let e=t.getSpec().layout;t.layoutBounds=function(t,e,i,r,n){let s=t.rows.length,a=t.columns.length,{start:o,end:l}=vr(e,i,s),{start:h,end:u}=vr(r,n,a),d=t.columns[o],c=t.columns[l]-(u===a?0:t.columnGap),p=t.rows[h],g=t.rows[u]-(l===s?0:t.rowGap);return(new iB).set(d,p,c,g)}(n,e.gridRowStart,e.gridRowEnd,e.gridColumnStart,e.gridColumnEnd),t.commit()})},vs=(t,e)=>ej(t)?e:eE(t)?e*parseFloat(t)/100:t,va={[c6.axis]:0,[c6.legend]:1,[c6.slider]:2,[c6.player]:3,[c6.datazoom]:4},vo=t=>{var e,i,r;return null!==(i=null===(e=t.getSpec().layout)||void 0===e?void 0:e.order)&&void 0!==i?i:"component"===t.markType&&null!==(r=va[t.componentType])&&void 0!==r?r:1/0},vl=(t,e,i,r)=>{let n=i.clone(),s=t.getSpec().layout,a=vs(s.maxChildWidth,n.width()),o=vs(s.maxChildHeight,n.width()),l=0,h=0,u=0,d=0;e.forEach(t=>{let e=t.getSpec().layout,s=mi(e.padding),c=r.parseMarkBounds?r.parseMarkBounds(t.getBounds(),t):t.getBounds();if("top"===e.position||"bottom"===e.position){let t=Math.min(c.height()+s.top+s.bottom,o);"top"===e.position?n.y1+=t:n.y2-=t,c.x1<i.x1&&(l=Math.max(l,i.x1-c.x1)),c.x2>i.x2&&(h=Math.max(h,c.x2-i.x2))}if("left"===e.position||"right"===e.position){let t=Math.min(c.width()+s.left+s.right,a);"left"===e.position?n.x1+=t:n.x2-=t,c.y1<i.y1&&(u=Math.max(u,i.y1-c.y1)),c.y2>i.y2&&(d=Math.max(d,c.y2-i.y2))}"outside"===e.position&&(n.x1+=Math.max(i.x1-c.x1,0)+s.left,n.x2-=Math.max(c.x2-i.x2,0)+s.right,n.y1+=Math.max(i.y1-c.y1,0)+s.top,n.y2-=Math.max(c.y2-i.y2)+s.bottom)}),l>n.x1-i.x1&&l<i.width()&&(n.x1=i.x1+l),h>i.x2-n.x2&&h<i.width()&&(n.x2=i.x2-h),u>n.y1-i.y1&&u<i.height()&&(n.y1=i.y1+u),d>i.y2-n.y2&&d<i.height()&&(n.y2=i.y2-d);let c=n.y1,p=n.y2,g=n.x1,f=n.x2,m=e.slice().sort((t,e)=>vo(t)-vo(e));for(let t=0,e=m.length;t<e;t++){let e=m[t],s=e.getSpec().layout,l=mi(s.padding),h=r.parseMarkBounds?r.parseMarkBounds(e.getBounds(),e):e.getBounds();if("top"===s.position||"bottom"===s.position){let t=Math.min(h.height()+l.top+l.bottom,o);if("top"===s.position?(e.layoutBounds=(new iB).set(n.x1,c-t,n.x2,c),c-=t):(e.layoutBounds=(new iB).set(n.x1,p,n.x2,p+t),p+=t),e.relativePosition={top:e.layoutBounds.y1-n.y1,bottom:e.layoutBounds.y1-n.y2},s.align){let t=h.width()+l.left+l.right;t<n.width()&&("center"===s.align?(e.layoutBounds.x1=(n.x1+n.x2)/2-t/2,e.layoutBounds.x2=e.layoutBounds.x1+t,e.relativePosition.left=e.relativePosition.right=(n.width()-t)/2):"right"===s.align?(e.layoutBounds.x1=n.x2-t,e.layoutBounds.x2=n.x2,e.relativePosition.right=0,e.relativePosition.left=n.width()-t):"left"===s.align&&(e.layoutBounds.x1=n.x1,e.layoutBounds.x2=n.x1+t,e.relativePosition.left=0,e.relativePosition.right=n.width()-t))}}else if("left"===s.position||"right"===s.position){let t=Math.min(h.width()+l.left+l.right,a);if("left"===s.position?(e.layoutBounds=(new iB).set(g-t,n.y1,g,n.y2),g-=t):(e.layoutBounds=(new iB).set(f,n.y1,f+t,n.y2),f+=t),e.relativePosition={left:e.layoutBounds.x1-n.x1,right:e.layoutBounds.x1-n.x2},s.align){let i=h.height()+l.top+l.bottom;t<n.width()&&("middle"===s.align?(e.layoutBounds.y1=(n.y1+n.y2)/2-i/2,e.layoutBounds.y2=e.layoutBounds.y1+i,e.relativePosition.top=e.relativePosition.bottom=(n.height()-i)/2):"bottom"===s.align?(e.layoutBounds.y1=n.y2-i,e.layoutBounds.y2=n.y2,e.relativePosition.top=n.height()-i,e.relativePosition.bottom=0):"top"===s.align&&(e.layoutBounds.y1=n.y1,e.layoutBounds.y2=n.y1+i,e.relativePosition.bottom=n.height()-i,e.relativePosition.top=0))}}else"outside"===s.position?(g-=Math.max(i.x1-h.x1,0)+l.left,f-=Math.max(h.x2-i.x2,0)+l.right,c-=Math.max(i.y1-h.y1,0)+l.top,p+=Math.max(h.y2-i.y2)+l.bottom):e.layoutBounds=n}return n},vh=(t,e,i)=>{null==t||t.forEach(t=>{var r;if(t.markType!==c8.group)return;let n=t.layoutChildren,s=t.getSpec().layout,a=null!==(r=t.layoutBounds)&&void 0!==r?r:t.getBounds();if(a){if(nx(s))s.call(null,t,n,a,e);else if(nx(s.callback))s.callback.call(null,t,n,a,e);else if("relative"===s.display){if(s.updateViewSignals){let r=i.getViewBox();r&&a.intersect(r);let s=vl(t,n,a,e),o=s.width(),l=s.height(),h={top:s.y1,right:i.width()-s.x2,left:s.x1,bottom:i.height()-s.y2};i.updateSignal(g4,o),i.updateSignal(g8,l),i.updateSignal(g6,h)}else vl(t,n,a,e)}else"grid"===s.display&&vn(t,n,a,e);vh(n,e,i)}})};class vu extends m7{constructor(t,e,i){super(t,c8.glyph,i),this.glyphType=e,this.glyphMeta=d0.getGlyph(e)}configureGlyph(t){return this.spec.glyphConfig=t,this.commit(),this}getGlyphMeta(){return this.glyphMeta}getGlyphConfig(){return this.spec.glyphConfig}addGraphicItem(t,e){let i=function(t,e,i={}){if(!d0.getGraphicType(c8.glyph))return;let r=d0.createGraphic(c8.glyph,i),n=e.getMarks(),s=Object.keys(n).map(t=>{if(d0.getGraphicType(n[t])){let e=d0.createGraphic(n[t]);if(e)return e.name=t,e}});return r.setSubGraphic(s),r}(0,this.glyphMeta,t);return super.addGraphicItem(t,e,i)}}function vd(t,e,i,r,n,s){let a=(e-t)*n+t,o=(i-e)*n+e,l=(r-i)*n+i,h=(o-a)*n+a,u=(l-o)*n+o,d=(u-h)*n+h;s[0]=t,s[1]=a,s[2]=h,s[3]=d,s[4]=d,s[5]=u,s[6]=l,s[7]=r}function vc(t,e){let i=t||e,r=i.length,n=i[r-2],s=i[r-1],a=[];for(let t=0;t<e.length;t+=2)a[t]=n,a[t+1]=s;return a}function vp(t){let e=0,i=0,r=0,n=t.length;for(let s=0,a=n-2;s<n;a=s,s+=2){let n=t[a],o=t[a+1],l=t[s],h=t[s+1],u=n*h-l*o;e+=u,i+=(n+l)*u,r+=(o+h)*u}return 0===e?[t[0]||0,t[1]||0,0]:[i/e/3,r/e/3,e]}let vg=(t,e,i,r,n)=>{dg(e,r)&&dg(i,n)||t.push(e,i,r,n,r,n)};function vf(t){let e,i,r,n;let s=t.commandList,a=[],o,l=0,h=0,u=0,d=0,c=(t,e)=>{o&&o.length>2&&a.push(o),o=[t,e]};for(let t=0,a=s.length;t<a;t++){let a=s[t],p=0===t;switch(p&&(u=l=a[1],d=h=a[2],[ij.L,ij.C,ij.Q].includes(a[0])&&(o=[u,d])),a[0]){case ij.M:l=u=a[1],h=d=a[2],c(u,d);break;case ij.L:e=a[1],i=a[2],vg(o,l,h,e,i),l=e,h=i;break;case ij.C:o.push(a[1],a[2],a[3],a[4],l=a[5],h=a[6]);break;case ij.Q:e=a[1],i=a[2],r=a[3],n=a[4],o.push(l+2/3*(e-l),h+2/3*(i-h),r+2/3*(e-r),n+2/3*(i-n),r,n),l=r,h=n;break;case ij.A:{let t=a[1],r=a[2],n=a[3],s=a[4],g=a[5],f=!!a[6];e=Math.cos(s)*n+t,i=Math.sin(s)*n+r,p?c(u=e,d=i):vg(o,l,h,e,i),l=Math.cos(g)*n+t,h=Math.sin(g)*n+r;let m=(f?-1:1)*Math.PI/2;for(let e=s;f?e>g:e<g;e+=m){let i=f?Math.max(e+m,g):Math.min(e+m,g);iz(o,e,i,t,r,n,n)}break}case ij.E:{let t=a[1],r=a[2],n=a[3],s=a[4],g=a[5],f=a[6],m=a[7]+f,v=!!a[8],y=!dg(g,0),_=Math.cos(g),b=Math.sin(g),x=Math.cos(f)*n,S=Math.sin(f)*s;y?(e=x*_-S*b+t,i=x*b+S*_+r):(e=x+t,i=S+r),p?c(u=e,d=i):vg(o,l,h,e,i),x=Math.cos(m)*n,S=Math.sin(m)*s,y?(l=x*_-S*b+t,h=x*b+S*_+r):(l=x+t,h=S+r);let k=(v?-1:1)*Math.PI/2;for(let e=f;v?e>m:e<m;e+=k){let i=v?Math.max(e+k,m):Math.min(e+k,m);if(iz(o,e,i,t,r,n,s),y){let e=o.length;for(let i=e-6;i<=e-1;i+=2)x=o[i],S=o[i+1],o[i]=(x-t)*_-(S-r)*b+t,o[i+1]=(x-t)*b+(S-r)*_+r}}break}case ij.R:u=l=a[1],d=h=a[2],e=u+a[3],i=d+a[4],c(e,d),vg(o,e,d,e,i),vg(o,e,i,u,i),vg(o,u,i,u,d),vg(o,u,d,e,d);break;case ij.AT:{let t=a[1],e=a[2],i=a[3],r=a[4],n=a[5],s=iG.distancePP({x:l,y:h},{x:t,y:e}),c=iG.distancePP({x:i,y:r},{x:t,y:e}),p=n/Math.sin(((l-t)*(i-t)+(h-e)*(r-e))/(s*c)/2),g=(l+i-2*t)/2,f=(h+r-2*e)/2,m=iG.distancePP({x:g,y:f},{x:0,y:0}),v=t+p*g/m,y=i+p*f/m,_=Math.sqrt(p*p-n*n);u=t+_*(l-t)/s,d=e+_*(h-e)/s,vg(o,l,h,u,d),l=t+_*(i-t)/c,h=e+_*(r-e)/c;let b=iC({x:v,y:y},{x:u,y:d}),x=iC({x:v,y:y},{x:l,y:h});iz(o,b,x,v,y,n,n);break}case ij.Z:o&&vg(o,l,h,u,d),l=u,h=d}}return o&&o.length>2&&a.push(o),a}function vm(t,e){for(let i=0;i<t.length;i++){let r=t[i];for(let t=0;t<r.length;t+=2){let i=r[t],n=r[t+1],s={x:i,y:n};e.transformPoint({x:i,y:n},s),r[t]=s.x,r[t+1]=s.y}}}let vv=t=>{if(!t)return{x:0,y:0,width:0,height:0};let e=ej(t.width)?t.x1-t.x:t.width,i=ej(t.height)?t.y1-t.y:t.height,r=0,n=0;return e<0?(r=e,e=-e):Number.isNaN(e)&&(e=0),i<0?(n=i,i=-i):Number.isNaN(i)&&(i=0),{x:r,y:n,width:e,height:i}};function vy(t,e,i){let r,n;let s=t/e;t>=e?(n=Math.ceil(Math.sqrt(i*s)),0===(r=Math.floor(i/n))&&(r=1,n=i)):(r=Math.ceil(Math.sqrt(i/s)),0===(n=Math.floor(i/r))&&(n=1,r=i));let a=[];for(let t=0;t<r;t++)a.push(n);let o=i-r*n;if(o>0)for(let t=0;t<o;t+=n)t+n<o?a.push(n):a.push(o-t);return a}let v_=(t,e)=>{let{width:i,height:r}=vv(t.attribute),n=vy(i,r,e),s=[],a=r/n.length;for(let t=0,e=n.length;t<e;t++){let e=n[t],r=i/e;for(let i=0;i<e;i++)s.push({x:0+i*r,y:0+t*a,width:r,height:a})}return s},vb=(t,e)=>{let i=t.getParsedAngle(),r=i.startAngle,n=i.endAngle,s=t.getComputedAttribute("innerRadius"),a=t.getComputedAttribute("outerRadius"),o=Math.abs(r-n),l=Math.abs(a-s),h=vy(o*(s+a)/2,l,e),u=[],d=l/h.length,c=a>=s?1:-1,p=n>=r?1:-1;for(let t=0,e=h.length;t<e;t++){let e=h[t],i=o/e;for(let n=0;n<e;n++)u.push({innerRadius:a-d*t*c,outerRadius:a-d*(t+1)*c,startAngle:r+i*n*p,endAngle:r+i*(n+1)*p})}return u},vx=(t,e)=>{let i=t.getComputedAttribute("startAngle"),r=t.getComputedAttribute("endAngle"),n=t.getComputedAttribute("radius"),s=Math.abs(i-r),a=vy(s*n,n,e),o=[],l=s/a[0],h=n/a.length,u=r>=i?1:-1;for(let t=0,e=a.length;t<e;t++)for(let e=0,r=a[t];e<r;e++)o.push({innerRadius:h*t,outerRadius:h*(t+1),startAngle:i+l*e*u,endAngle:i+l*(e+1)*u});return o},vS=(t,e)=>{let i=t.filter(t=>!1!==t.defined&&ey(t.x)&&ey(t.y));if(0===i.length)return[];if(1===i.length)return Array(e).fill(0).map(t=>i[0]);let r=[];if(e<=i.length){let t=i.length/e,n=0,s=0;for(;n<e;)r.push(i[Math.floor(s)]),s+=t,n++;return r}let n=e-i.length,s=1/(n/(i.length-1)+1),a=0;for(let e=0,i=t.length;e<i;e++)if(r.push(t[e]),e<i-1){let i=s,o=t[e].x,l=t[e].y,h=t[e+1].x,u=t[e+1].y;for(;i<1&&a<n;)r.push({x:o+(h-o)*i,y:l+(u-l)*i}),i+=s,a+=1}return r},vk=(t,e)=>{var i,r;let n=t.attribute,s=n.points,a=n.segments;s||(s=a.reduce((t,e)=>{var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])},[]));let o=s.filter(t=>!1!==t.defined&&ey(t.x)&&ey(t.y));if(!o.length)return[];let l=[];o.forEach(t=>{l.push({x:t.x,y:t.y})});for(let t=o.length-1;t>=0;t--){let e=o[t];l.push({x:null!==(i=e.x1)&&void 0!==i?i:e.x,y:null!==(r=e.y1)&&void 0!==r?r:e.y})}let h=[];return vT(s,e,h),h},vA=(t,e)=>{let i=t.attribute,r=i.points;return r?vS(r,e):i.segments?vS(i.segments.reduce((t,e)=>{var i;return t.concat(null!==(i=e.points)&&void 0!==i?i:[])},[]),e):[]},vw=t=>t.map(t=>({x:t.x,y:t.y})),vM=(t,e,i)=>{let r=t.length,n=[];for(let o=0;o<r;o++){var s,a;let l=t[o],h=o===r-1?t[0]:t[o+1],u=a2([e.x,e.y],[i.x,i.y],[l.x,l.y],[h.x,h.y]);u&&"boolean"!=typeof u&&n.push({dot:(s=[u[0]-e.x,u[1]-e.x],a=[i.x-e.x,i.y-e.x],s[0]*a[1]-s[1]*a[0]),point:{x:u[0],y:u[1]},edgeIndex:o})}if(n.length<2)return[vw(t),vw(t)];n.sort((t,e)=>t.dot-e.dot);let o=n[0],l=n[n.length-1];o.edgeIndex>l.edgeIndex&&([o,l]=[l,o]);let h=o.point,u=l.point,d=[{x:h.x,y:h.y}];for(let e=o.edgeIndex+1;e<=l.edgeIndex;e++)d.push({x:t[e].x,y:t[e].y});d.push({x:u.x,y:u.y});let c=[{x:u.x,y:u.y}];for(let e=l.edgeIndex+1,i=o.edgeIndex+r;e<=i;e++){let i=t[e%r];c.push({x:i.x,y:i.y})}return c.push({x:h.x,y:h.y}),[d,c]},vC=t=>{let e=new iB;t.forEach(t=>{e.add(t.x,t.y)});let i=e.width(),r=e.height();if(i>=r){let r=e.x1+i/2;return vM(t,{x:r,y:e.y1},{x:r,y:e.y2})}let n=e.y1+r/2;return vM(t,{x:e.x1,y:n},{x:e.x2,y:n})},vT=(t,e,i)=>{if(1===e)i.push({points:t});else{let r=Math.floor(e/2),n=vC(t);vT(n[0],r,i),vT(n[1],e-r,i)}},vE=(t,e)=>{let i=t.attribute.points;if(!i||!i.length)return[];if(1===e)return[{points:vw(i)}];let r=[];return vT(i,e,r),r},vO=(t,e)=>{let i=vf(t.getParsedPathShape());if(!i.length||e<0)return[];let r=i.length;if(i.length>=e){let t=[],n=Math.floor(i.length/e);for(let s=0;s<e;s++){let a=i.slice(s*n,s===e-1?r:(s+1)*n);t.push({path:function(t){let e=new rg;for(let i=0;i<t.length;i++){let r=t[i];if(r.length>2){e.moveTo(r[0],r[1]);for(let t=2;t<r.length;t+=6)e.bezierCurveTo(r[t],r[t+1],r[t+2],r[t+3],r[t+4],r[t+5])}}return e}(a)})}return t}let n=[],s=Math.floor(e/r),a=e;for(let t=0;t<r;t++){let e=[];for(let r=2,n=i[t].length;r<n;r+=2)e.push({x:i[0][r],y:i[0][r+1]});vT(e,t===r-1?a:s,n),a-=s}return n},vP=(t,e,i)=>{t.forEach(t=>{if(Number.isFinite(t.to))e[t.key]=t.from+(t.to-t.from)*i;else if("fill"===t.key||"stroke"===t.key){let r=nX(t.from,t.to,i,!1);r&&(e[t.key]=r)}})},vR=(t,e,i)=>{let r=[],n=[];e.clear();for(let s=0;s<t.length;s++){let a=t[s],o=a.from,l=a.to,h=a.rotation*i,u=a.fromCp,d=a.toCp,c=Math.sin(h),p=Math.cos(h);n[0]=u[0]+(d[0]-u[0])*i,n[1]=u[1]+(d[1]-u[1])*i;for(let t=0;t<o.length;t+=2){let e=o[t],s=o[t+1],a=e*(1-i)+l[t]*i,h=s*(1-i)+l[t+1]*i;r[t]=a*p-h*c+n[0],r[t+1]=a*c+h*p+n[1]}let g=r[0],f=r[1];e.moveTo(g,f);for(let t=2;t<o.length;t+=6){let i=r[t],n=r[t+1],s=r[t+2],a=r[t+3],o=r[t+4],l=r[t+5];g===i&&f===n&&s===o&&a===l?e.lineTo(o,l):e.bezierCurveTo(i,n,s,a,o,l),g=o,f=l}}},vB=(t,e,i)=>{let r=t?vf(t):[],n=vf(e);i&&r&&(i.fromTransform&&vm(r,i.fromTransform.clone().getInverse()),vm(r,i.toTransfrom));let[s,a]=function(t,e){let i,r;let n=[],s=[];for(let a=0;a<Math.max(t.length,e.length);a++){let o,l;let h=t[a],u=e[a];h?u?([o,l]=function(t,e){let i=t.length,r=e.length;if(i===r)return[t,e];let n=[],s=[],a=i<r?t:e,o=Math.min(i,r),l=Math.abs(r-i)/6,h=Math.ceil(l/((o-2)/6)),u=[a[0],a[1]],d=l;for(let t=2;t<o;t+=6){let e=a[t-2],i=a[t-1],r=a[t],o=a[t+1],l=a[t+2],c=a[t+3],p=a[t+4],g=a[t+5];if(d<=0){u.push(r,o,l,c,p,g);continue}let f=Math.min(d,h)+1;for(let t=1;t<=f;t++){let a=t/f;vd(e,r,l,p,a,n),vd(i,o,c,g,a,s),e=n[3],i=s[3],u.push(n[1],s[1],n[2],s[2],e,i),r=n[5],o=s[5],l=n[6],c=s[6]}d-=f-1}return a===t?[u,e]:[t,u]}(h,u),i=o,r=l):(l=vc(r,h),o=h):(o=vc(i,u),l=u),n.push(o),s.push(l)}return[n,s]}(r,n);return t?function(t,e,i,r){let n;let s=[];for(let a=0;a<t.length;a++){let o=t[a],l=e[a],h=vp(o),u=vp(l);null==n&&(n=h[2]<0!=u[2]<0);let d=[],c=[],p=0,g=1/0,f=[],m=o.length;n&&(o=function(t){let e=[],i=t.length;for(let r=0;r<i;r+=2)e[r]=t[i-r-2],e[r+1]=t[i-r-1];return e}(o));let v=6*function(t,e,i,r){let n=(t.length-2)/6,s=1/0,a=0,o=t.length,l=o-2;for(let h=0;h<n;h++){let n=6*h,u=0;for(let s=0;s<o;s+=2){let a=0===s?n:(n+s-2)%l+2,o=t[a]-i[0],h=t[a+1]-i[1],d=e[s]-r[0]-o,c=e[s+1]-r[1]-h;u+=d*d+c*c}u<s&&(s=u,a=h)}return a}(o,l,h,u),y=m-2;for(let t=0;t<y;t+=2){let e=(v+t)%y+2;d[t+2]=o[e]-h[0],d[t+3]=o[e+1]-h[1]}d[0]=o[v]-h[0],d[1]=o[v+1]-h[1],!0;{let t=r/i;for(let e=-r/2;e<=r/2;e+=t){let t=Math.sin(e),i=Math.cos(e),r=0;for(let e=0;e<o.length;e+=2){let n=d[e],s=d[e+1],a=l[e]-u[0],o=l[e+1]-u[1],h=a*i-o*t,c=a*t+o*i;f[e]=h,f[e+1]=c;let p=h-n,g=c-s;r+=p*p+g*g}if(r<g){g=r,p=e;for(let t=0;t<f.length;t++)c[t]=f[t]}}}s.push({from:d,to:c,fromCp:h,toCp:u,rotation:-p})}return s}(s,a,10,Math.PI):a.map((t,e)=>({from:s[e],to:t,fromCp:[0,0],toCp:[0,0],rotation:0}))},vI=["fill","fillOpacity","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","lineDashOffset"],vL=(t,e)=>{if(!t||!e)return null;let i=[],r=!1;return Object.keys(t).forEach(n=>{if(!vI.includes(n))return;let s=e[n];ej(s)||ej(t[n])||s===t[n]||("fill"===n||"stroke"===n?i.push({from:"string"==typeof t[n]?nK.Get(t[n],lB.Color255):t[n],to:"string"==typeof s?nK.Get(s,lB.Color255):s,key:n}):i.push({from:t[n],to:s,key:n}),r=!0)}),r?i:null};class vD extends nT{constructor(t,e,i){super(0,1,e,i),this.morphingData=t.morphingData,this.otherAttrs=t.otherAttrs,this.saveOnEnd=t.saveOnEnd}getEndProps(){return{}}onBind(){this.target.createPathProxy(),this.onUpdate(!1,0,this.target.attribute)}onEnd(){}onUpdate(t,e,i){let r=this.target,n="function"==typeof r.pathProxy?r.pathProxy(r.attribute):r.pathProxy;vR(this.morphingData,n,e),this.otherAttrs&&this.otherAttrs.length&&vP(this.otherAttrs,i,e),t&&!this.saveOnEnd&&(this.target.pathProxy=null)}}let vF=(t,e,i,r)=>{var n,s,a;if(t&&(!t.valid||!t.toCustomPath))return __DEV__&&console.error(t," is not validate"),null;if(!e.valid||!e.toCustomPath)return __DEV__&&console.error(e," is not validate"),null;let o=null==t?void 0:t.globalTransMatrix;r&&o&&(o=r.clone().multiply(o.a,o.b,o.c,o.d,o.e,o.f));let l=vB(null===(n=null==t?void 0:t.toCustomPath)||void 0===n?void 0:n.call(t),e.toCustomPath(),{fromTransform:o,toTransfrom:e.globalTransMatrix}),h=vL(null==t?void 0:t.attribute,e.attribute),u=e.animate(i);return(null==i?void 0:i.delay)&&u.wait(i.delay),u.play(new vD({morphingData:l,otherAttrs:h},null!==(s=null==i?void 0:i.duration)&&void 0!==s?s:nI.duration,null!==(a=null==i?void 0:i.easing)&&void 0!==a?a:nI.easing)),u},vj=(t,e,i)=>{var r;let n=e.filter(t=>t&&t.toCustomPath&&t.valid);n.length||__DEV__&&console.error(n," is not validate"),t.valid&&t.toCustomPath||__DEV__&&console.error(t," is not validate");let s=("clone"===(null==i?void 0:i.splitPath)?vV:null!==(r=null==i?void 0:i.splitPath)&&void 0!==r?r:vW)(t,n.length,!1),a=null==i?void 0:i.onEnd,o=n.length,l=()=>{0==--o&&a&&a()};n.forEach((e,r)=>{var a;let o=s[r],h=(null!==(a=null==i?void 0:i.delay)&&void 0!==a?a:0)+((null==i?void 0:i.individualDelay)?i.individualDelay(r,n.length,o,e):0);vF(o,e,Object.assign({},i,{onEnd:l,delay:h}),t.globalTransMatrix)})};class vN extends nT{constructor(t,e,i){super(0,1,e,i),this.morphingData=t.morphingData,this.otherAttrs=t.otherAttrs}getEndProps(){return{}}onBind(){this.addPathProxy()}addPathProxy(){this.target.shadowRoot.forEachChildren(t=>{t.createPathProxy()}),this.onUpdate(!1,0,this.target.attribute)}clearPathProxy(){this.target.shadowRoot.forEachChildren(t=>{t.pathProxy=null})}onEnd(){}onUpdate(t,e,i){this.target.shadowRoot.forEachChildren((t,i)=>{var r;vR(this.morphingData[i],"function"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy,e),(null===(r=this.otherAttrs)||void 0===r?void 0:r[i])&&this.otherAttrs[i].length&&vP(this.otherAttrs[i],t.attribute,e)}),t&&(this.clearPathProxy(),this.morphingData=null)}}let vz=t=>{let e={};return Object.keys(t).forEach(i=>{sc(i)||(e[i]=t[i])}),e},vH=(t,e,i)=>{let r=vz(t.attribute),n=t.attachShadow();if(e.length)n.setTheme({[e[0].type]:r}),e.forEach(t=>{n.appendChild(t)});else{let s=t.AABBBounds,a=s.width(),o=s.height();n.setTheme({rect:r}),Array(i).fill(0).forEach(t=>{let i=rj.graphicService.creator.rect({x:0,y:0,width:a,height:o});n.appendChild(i),e.push(i)})}},vV=(t,e,i)=>{let r=[],n=i?null:vz(t.attribute),s=t.toCustomPath();for(let t=0;t<e;t++){let t={path:(new rg).fromCustomPath2D(s)};r.push(rj.graphicService.creator.path(i?t:Object.assign({},n,t)))}return i&&vH(t,r,e),r},vW=(t,e,i)=>{let r=[],n=i?null:vz(t.attribute);if("rect"===t.type)v_(t,e).forEach(t=>{r.push(rj.graphicService.creator.rect(i?t:Object.assign({},n,t)))});else if("arc"===t.type)vb(t,e).forEach(t=>{r.push(rj.graphicService.creator.arc(i?t:Object.assign({},n,t)))});else if("circle"===t.type)vx(t,e).forEach(t=>{r.push(rj.graphicService.creator.arc(i?t:Object.assign({},n,t)))});else if("line"===t.type){let s=vA(t,e),a={size:10,symbolType:"circle"};s.forEach(t=>{r.push(rj.graphicService.creator.symbol(i?Object.assign({},t,a):Object.assign({},n,t,a)))})}else"polygon"===t.type?vE(t,e).forEach(t=>{r.push(rj.graphicService.creator.polygon(i?t:Object.assign({},n,t)))}):"area"===t.type?vk(t,e).forEach(t=>{r.push(rj.graphicService.creator.polygon(i?t:Object.assign({},n,t)))}):"path"===t.type&&vO(t,e).forEach(t=>{"path"in t?r.push(rj.graphicService.creator.path(i?t:Object.assign({},n,t))):r.push(rj.graphicService.creator.polygon(i?t:Object.assign({},n,t)))});return i&&vH(t,r,e),r},vG=(t,e,i)=>{var r,n,s;let a=t.filter(t=>t.toCustomPath&&t.valid);a.length||__DEV__&&console.error(t," is not validate"),e.valid&&e.toCustomPath||__DEV__&&console.error(e," is not validate");let o=("clone"===(null==i?void 0:i.splitPath)?vV:null!==(r=null==i?void 0:i.splitPath)&&void 0!==r?r:vW)(e,a.length,!0),l=e.attribute;e.setAttribute("visible",!1);let h=a.map((t,e)=>vB(t.toCustomPath(),o[e].toCustomPath(),{fromTransform:t.globalTransMatrix,toTransfrom:o[e].globalTransMatrix})),u=a.map((t,e)=>vL(t.attribute,l));if(null==i?void 0:i.individualDelay){let r=i.onEnd,n=a.length,s=()=>{0==--n&&(e.setAttributes({visible:!0,ratio:null},!1,{type:lw.ANIMATE_END}),e.detachShadow(),r&&r())};o.forEach((e,r)=>{var n,o,l;let d=(null!==(n=i.delay)&&void 0!==n?n:0)+i.individualDelay(r,a.length,t[r],e),c=e.animate(Object.assign({},i,{onEnd:s}));c.wait(d),c.play(new vD({morphingData:h[r],saveOnEnd:!0,otherAttrs:u[r]},null!==(o=i.duration)&&void 0!==o?o:nI.duration,null!==(l=i.easing)&&void 0!==l?l:nI.easing))})}else{let t=null==i?void 0:i.onEnd,r=i?Object.assign({},i):{};r.onEnd=()=>{e.setAttribute("visible",!0,!1,{type:lw.ANIMATE_END}),e.detachShadow(),t&&t()};let a=e.animate(r);(null==i?void 0:i.delay)&&a.wait(i.delay),a.play(new vN({morphingData:h,otherAttrs:u},null!==(n=null==i?void 0:i.duration)&&void 0!==n?n:nI.duration,null!==(s=null==i?void 0:i.easing)&&void 0!==s?s:nI.easing))}},vU=Symbol.for("key");class v${diffGrammar(t,e){return function(t,e,i){let r={enter:[],exit:[],update:[]},n=new mV(t,i);return n.setCallback((t,e,i)=>{ej(e)?r.exit.push({prev:i[0]}):ej(i)?r.enter.push({next:e[0]}):r.update.push({next:e[0],prev:i[0]})}),n.setCurrentData(mH(e,i)),n.doDiff(),r}(t,e,t=>{var e;return null!==(e=t.id())&&void 0!==e?e:Symbol()})}diffMark(t,e,i){let r={enter:[],exit:[],update:[]},n=[],s=[];t.forEach(t=>{t.markType!==c8.group&&(i.morph&&t.getMorphConfig().morph||i.morphAll||i.reuse)?n.push(t):r.exit.push({prev:[t]})}),e.forEach(t=>{t.markType!==c8.group&&(i.morph&&t.getMorphConfig().morph||i.morphAll||i.reuse)?s.push(t):r.enter.push({next:[t]})});let a=this.diffUpdateByGroup(n,s,t=>t.getMorphConfig().morphKey,t=>t.getMorphConfig().morphKey);n=a.prev,s=a.next,r.update=r.update.concat(a.update);let o=this.diffUpdateByGroup(n,s,t=>t.id(),t=>t.id());n=o.prev,s=o.next,r.update=r.update.concat(o.update);let l=mH(n,t=>{var e,i;return null===(i=null===(e=t.group)||void 0===e?void 0:e.id)||void 0===i?void 0:i.call(e)}),h=mH(s,t=>{var e,i;return null===(i=null===(e=t.group)||void 0===e?void 0:e.id)||void 0===i?void 0:i.call(e)});return Object.keys(h).forEach(t=>{let e=l.data.get(t),i=h.data.get(t);if(e&&i){for(let t=0;t<Math.max(e.length,i.length);t+=1){let n=e[t],s=i[t];n&&s?r.update.push({prev:[n],next:[s]}):n?r.exit.push({prev:[n]}):s&&r.enter.push({next:[s]})}n=n.filter(t=>!e.includes(t)),s=s.filter(t=>!i.includes(t))}}),n.forEach(t=>r.exit.push({prev:[t]})),s.forEach(t=>r.enter.push({next:[t]})),r}_appendMorphKeyToElements(t){let e=t.getMorphConfig();if(!ej(e.morphElementKey)){let i=gV(e.morphElementKey);t.elements&&t.elements.forEach(t=>{t.morphKey=i(t.getDatum())})}}morph(t,e,i){let r=t.reduce((t,e)=>(this._appendMorphKeyToElements(e),t.concat(e.elements)),[]),n=function(t,e,i){let r={enter:[],exit:[],update:[]},n=new mV(t,i);return n.setCallback((t,e,i)=>{ej(e)?r.exit.push({prev:i}):ej(i)?r.enter.push({next:e}):r.update.push({next:e,prev:i})}),n.setCurrentData(mH(e,i)),n.doDiff(),r}(r,e.reduce((t,e)=>(this._appendMorphKeyToElements(e),t.concat(e.elements)),[]),t=>{var e;return null!==(e=t.morphKey)&&void 0!==e?e:t.key});t.forEach(t=>{var e,i;return null===(i=null===(e=t.animate)||void 0===e?void 0:e.disable)||void 0===i?void 0:i.call(e)}),e.forEach(t=>{var e,i;return null===(i=null===(e=t.animate)||void 0===e?void 0:e.disable)||void 0===i?void 0:i.call(e)});let s=t.concat(e).reduce((t,e)=>(Object.assign(t,e.parameters()),t),{}),a=0,o=()=>{0==(a-=1)&&e.forEach(t=>{var e,i;null===(i=null===(e=t.animate)||void 0===e?void 0:e.enable)||void 0===i||i.call(e)})};n.enter.forEach(t=>{t.next.forEach(t=>{this.doMorph([],[t],i,o,s)}),a+=1}),n.update.forEach(t=>{let e=Math.min(t.prev.length,t.next.length),r=this.divideElements(t.prev,e),n=this.divideElements(t.next,e);for(let t=0;t<e;t++)this.doMorph(r[t],n[t],i,o,s),a+=1})}diffUpdateByGroup(t,e,i,r){let n=mH(t,t=>{var e;return null!==(e=i(t))&&void 0!==e?e:vU}),s=mH(e,t=>{var e;return null!==(e=r(t))&&void 0!==e?e:vU}),a=t,o=e,l=[];return s.keys.forEach(t=>{if(t!==vU){let e=n.data.get(t),i=s.data.get(t);e&&i&&(l.push({prev:e,next:i}),a=a.filter(t=>!e.includes(t)),o=o.filter(t=>!i.includes(t)))}}),{prev:a,next:o,update:l}}doMorph(t,e,i,r,n){var s,a;let o={prev:t.map(t=>t.getDatum()),next:e.map(t=>t.getDatum())},l={prev:t.slice(),next:e.slice()},h=i.animation.easing,u=gN(i.animation.delay,n,o,l),d=gN(i.animation.duration,n,o,l),c=gN(i.animation.oneByOne,n,o,l),p=gN(i.animation.splitPath,n,o,l),g=l1(c)&&c>0?t=>ey(c)?t*c:!0===c?t*d:0:void 0;1!==t.length&&0!==t.length||1!==e.length?1===t.length&&e.length>1?vj(t[0].getGraphicItem(),e.map(t=>t.getGraphicItem()),{delay:u,duration:d,easing:h,onEnd:r,individualDelay:g,splitPath:p}):t.length>1&&1===e.length&&vG(t.map(t=>t.getGraphicItem()),e[0].getGraphicItem(),{delay:u,duration:d,easing:h,onEnd:r,individualDelay:g,splitPath:p}):vF(null===(a=null===(s=t[0])||void 0===s?void 0:s.getGraphicItem)||void 0===a?void 0:a.call(s),e[0].getGraphicItem(),{delay:u,duration:d,easing:h,onEnd:r})}divideElements(t,e){let i=Math.floor(t.length/e);return Array(e).fill(0).map((r,n)=>t.slice(i*n,n===e-1?t.length:i*(n+1)))}}class vY{constructor(t,e){this._grammars={signal:[],data:[],scale:[],coordinate:[],mark:[],customized:[]},this._grammarMap={signal:{},data:{},scale:{},coordinate:{},mark:{},customized:{}},this._size=0,this._mapKey=eE(t)?e=>e[t]:t,this._warning=e}record(t){var e,i;let r=t.grammarType,n=this._mapKey(t);return this._grammarMap[r]?(this._grammars[r].push(t),ej(n)||(this._grammarMap[r][n]?null===(e=this._warning)||void 0===e||e.call(this,n,t):this._grammarMap[r][n]=t)):(this._grammars.customized.push(t),ej(n)||(this._grammarMap.customized[n]?null===(i=this._warning)||void 0===i||i.call(this,n,t):this._grammarMap.customized[n]=t)),this._size+=1,this}unrecord(t){let e=t.grammarType,i=this._mapKey(t);return this._grammarMap[e]?(this._grammars[e]=this._grammars[e].filter(e=>e!==t),ej(i)||this._grammarMap[e][i]!==t||delete this._grammarMap[e][i]):(this._grammars.customized=this._grammars.customized.filter(e=>e!==t),ej(i)||this._grammarMap.customized[i]!==t||delete this._grammarMap.customized[i]),this._size-=1,this}size(){return this._size}getSignal(t){var e;return null!==(e=this._grammarMap.signal[t])&&void 0!==e?e:null}getData(t){var e;return null!==(e=this._grammarMap.data[t])&&void 0!==e?e:null}getScale(t){var e;return null!==(e=this._grammarMap.scale[t])&&void 0!==e?e:null}getCoordinate(t){var e;return null!==(e=this._grammarMap.coordinate[t])&&void 0!==e?e:null}getMark(t){var e;return null!==(e=this._grammarMap.mark[t])&&void 0!==e?e:null}getCustomized(t){var e;return null!==(e=this._grammarMap.customized[t])&&void 0!==e?e:null}getGrammar(t){return this._grammarMap.data[t]?this._grammarMap.data[t]:this._grammarMap.signal[t]?this._grammarMap.signal[t]:this._grammarMap.scale[t]?this._grammarMap.scale[t]:this._grammarMap.coordinate[t]?this._grammarMap.coordinate[t]:this._grammarMap.mark[t]?this._grammarMap.mark[t]:this._grammarMap.customized[t]?this._grammarMap.customized[t]:null}getAllSignals(){return this._grammars.signal}getAllData(){return this._grammars.data}getAllScales(){return this._grammars.scale}getAllCoordinates(){return this._grammars.coordinate}getAllMarks(){return this._grammars.mark}getAllCustomized(){return this._grammars.customized}traverse(t){var e;Object.values(null!==(e=this._grammars)&&void 0!==e?e:{}).forEach(e=>(null!=e?e:[]).forEach(e=>{t.call(null,e)}))}find(t){let e=null;return this.traverse(i=>!0===t.call(null,i)&&(e=i,!0)),e}filter(t){let e=[];return this.traverse(i=>{!0===t.call(null,i)&&e.push(i)}),e}clear(){this._size=0,this._grammars={signal:[],data:[],scale:[],coordinate:[],mark:[],customized:[]},this._grammarMap={signal:{},data:{},scale:{},coordinate:{},mark:{},customized:{}}}release(){this._size=0,this._grammars=null,this._grammarMap=null}}class vK extends vY{constructor(){super(...arguments),this._markNodes=[]}record(t){if(super.record(t),"mark"===t.grammarType){let e={mark:t,parent:null,children:[]};this._markNodes.forEach(i=>{let r=i.mark;r.markType===c8.group&&r.includesChild(t,!1)?(i.children.push(e),e.parent=i):t.markType===c8.group&&t.includesChild(r,!1)&&(e.children.push(i),i.parent=e)}),this._markNodes.push(e)}return this}unrecord(t){if(super.unrecord(t),"mark"===t.grammarType){let e=this._markNodes.find(e=>e.mark===t);this._markNodes.forEach(i=>{i.mark.markType===c8.group&&i.children.includes(e)?(i.children=i.children.filter(t=>t!==e),e.parent=null):t.markType===c8.group&&e.children.includes(i)&&(e.children=e.children.filter(t=>t!==i),i.parent=null)}),this._markNodes=this._markNodes.filter(t=>t!==e)}return this}getAllMarkNodes(){return this._markNodes}clear(){super.clear(),this._markNodes=[]}release(){super.release(),this._markNodes=null}}class vZ{constructor(t){this._animations=[],this._additionalAnimateMarks=[],this.isEnabled=!0,this._onAnimationStart=t=>{this._additionalAnimateMarks=this._additionalAnimateMarks.filter(t=>{var e;return null===(e=null==t?void 0:t.animate)||void 0===e?void 0:e.isAnimating()}),0===this._animations.length&&0===this._additionalAnimateMarks.length&&this._view.emit(pa.ALL_ANIMATION_START,{}),this._animations=this._animations.concat({config:t.animationConfig,mark:t.mark})},this._onAnimationEnd=t=>{this._additionalAnimateMarks=this._additionalAnimateMarks.filter(t=>{var e;return null===(e=null==t?void 0:t.animate)||void 0===e?void 0:e.isAnimating()}),this._animations=this._animations.filter(e=>e.config!==t.animationConfig||e.mark!==t.mark),0===this._animations.length&&0===this._additionalAnimateMarks.length&&this._view.emit(pa.ALL_ANIMATION_END,{})},this._view=t,this._view.addEventListener(pa.ANIMATION_START,this._onAnimationStart),this._view.addEventListener(pa.ANIMATION_END,this._onAnimationEnd)}stop(){return this._view.traverseMarkTree(t=>{var e,i;t.animate&&(null===(i=(e=t.animate).stop)||void 0===i||i.call(e))}),this._additionalAnimateMarks.forEach(t=>{var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).stop)||void 0===i||i.call(e))}),this._additionalAnimateMarks=[],this}pause(){return this._view.traverseMarkTree(t=>{var e,i;t.animate&&(null===(i=(e=t.animate).pause)||void 0===i||i.call(e))}),this._additionalAnimateMarks.forEach(t=>{var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).pause)||void 0===i||i.call(e))}),this}resume(){return this._view.traverseMarkTree(t=>{var e,i;t.animate&&(null===(i=(e=t.animate).resume)||void 0===i||i.call(e))}),this._additionalAnimateMarks.forEach(t=>{var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).resume)||void 0===i||i.call(e))}),this}enable(){return this.isEnabled=!0,this._view.traverseMarkTree(t=>{var e,i;t.animate&&(null===(i=(e=t.animate).enable)||void 0===i||i.call(e))}),this}disable(){return this.isEnabled=!1,this._view.traverseMarkTree(t=>{var e,i;t.animate&&(null===(i=(e=t.animate).disable)||void 0===i||i.call(e))}),this._additionalAnimateMarks.forEach(t=>{var e,i;t.view&&t.animate&&(null===(i=(e=t.animate).stop)||void 0===i||i.call(e))}),this._additionalAnimateMarks=[],this}enableAnimationState(t){return this._view.traverseMarkTree(e=>{var i,r;e.animate&&(null===(r=(i=e.animate).enableAnimationState)||void 0===r||r.call(i,t))}),this}disableAnimationState(t){return this._view.traverseMarkTree(e=>{var i,r;e.animate&&(null===(r=(i=e.animate).disableAnimationState)||void 0===r||r.call(i,t))}),this}isAnimating(){return 0!==this._animations.length||this._additionalAnimateMarks.some(t=>{var e;return(null===(e=null==t?void 0:t.animate)||void 0===e?void 0:e.isAnimating())||!1})}animate(){return this.isEnabled&&this._view.traverseMarkTree(t=>{t.isUpdated&&t.animate&&t.animate.animate(),t.cleanExitElements(),t.isUpdated=!1},null,!0),this}animateAddition(t){let e=t.animate.animate();return e&&e.isAnimating()&&this._additionalAnimateMarks.push(t),this}release(){this._additionalAnimateMarks=[],this._animations=[],this._view.removeEventListener(pa.ALL_ANIMATION_START,this._onAnimationStart),this._view.removeEventListener(pa.ALL_ANIMATION_END,this._onAnimationEnd),this._view=null}}class vX extends m7{addGraphicItem(t,e){let i=t&&t.limitAttrs,r=ma(this,i&&("rich"===i.textType||i.text&&"rich"===i.text.type)?c8.richtext:c8.text,t);return super.addGraphicItem(t,e,r)}release(){super.release()}}vX.markType=c8.text;let vq={axis:{label:{visible:!0,inside:!1,space:4,style:{fontSize:12,fill:"#89909d",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},items:[],start:{x:0,y:0},end:{x:100,y:0},x:0,y:0},circleAxis:{title:{space:4,padding:[0,0,0,0],textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1},text:"theta"},label:{visible:!0,inside:!1,space:4,style:{fontSize:12,fill:"#6F6F6F",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},items:[],startAngle:0,endAngle:2*Math.PI,radius:100,innerRadius:0,center:{x:0,y:0},x:0,y:0},grid:{style:{stroke:"#f1f2f5"}},circleGrid:{style:{stroke:"#f1f2f5"}},discreteLegend:{layout:"vertical",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:10,spaceRow:10,shape:{space:4,style:{size:10,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8",stroke:"#D8D8D8",fillOpacity:.5}}},label:{space:4,style:{fontSize:12,fill:"black",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8",fillOpacity:.5}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"},state:{selectedHover:{fillOpacity:.7,fill:"gray"},unSelectedHover:{fillOpacity:.2,fill:"gray"}}},focus:!1,focusIconStyle:{size:10,fill:"#333",cursor:"pointer"},visible:!0,padding:{top:2,bottom:2,left:2,right:2}},autoPage:!0,pager:{space:12,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!1,items:[{index:0,id:"",label:"",shape:{fill:"#6690F2",stroke:"#6690F2",symbolType:"circle"}}]},colorLegend:{title:{visible:!1,text:""},colors:[],layout:"horizontal",railWidth:200,railHeight:8,railStyle:{cornerRadius:5}},sizeLegend:{title:{visible:!1,text:""},trackStyle:{fill:"#ccc"},layout:"horizontal",align:"bottom",railWidth:200,railHeight:6,min:0,max:1,value:[0,1]},lineCrosshair:{start:{x:0,y:0},end:{x:0,y:0}},rectCrosshair:{start:{x:0,y:0},end:{x:0,y:0},rectStyle:{width:10,height:10}},sectorCrosshair:{center:{x:0,y:0},radius:100,startAngle:0,endAngle:Math.PI/6},circleCrosshair:{center:{x:0,y:0},radius:100,startAngle:0,endAngle:2*Math.PI},polygonCrosshair:{center:{x:0,y:0},radius:100,startAngle:0,endAngle:2*Math.PI,sides:6},slider:{layout:"horizontal",railWidth:200,railHeight:10,railStyle:{cornerRadius:5},range:{draggableTrack:!0},startText:{visible:!0,text:"",space:8},endText:{visible:!0,text:"",space:8},min:0,max:1,value:[0,1]},dataLabel:{size:{width:400,height:400},dataLabels:[]},pointLabel:{data:[{text:"",fill:"#606773",data:{}}],overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},lineLabel:{type:"line",data:[{text:"",data:{}}],position:"start",overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},areaLabel:{type:"area",data:[{text:"",data:{}}],position:"end",overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},rectLabel:{type:"rect",data:[{text:"",fill:"#606773",data:{}}],position:"top",overlap:{size:{width:1e3,height:1e3},strategy:[{type:"position"}]},smartInvert:!1},symbolLabel:{type:"symbol",data:[{text:"",fill:"#606773",data:{}}],position:"top",overlap:{avoidBaseMark:!0,size:{width:1e3,height:1e3},strategy:[{type:"position"}]},smartInvert:!1},arcLabel:{type:"arc",data:[{text:"",fill:"#606773",data:{}}],width:800,height:600,position:"outside",zIndex:302},lineDataLabel:{type:"line-data",data:[{text:""}],position:"top",overlap:{avoidBaseMark:!1,clampForce:!1},smartInvert:!1},datazoom:{orient:"bottom",showDetail:"auto",brushSelect:!0,start:0,end:1,position:{x:0,y:0},size:{width:500,height:40},previewData:[]},continuousPlayer:{},discretePlayer:{},tooltip:{},title:{textStyle:{fill:"#21252c"},subtextStyle:{fill:"#606773"}},scrollbar:{width:12,height:12,padding:[2,2],railStyle:{fill:"rgba(0, 0, 0, .1)"}}},vJ={symbol:{shape:"circle",size:8},text:{fontSize:14,fill:"#000000"}},vQ=Object.assign({},vq);vQ.axis=Object.assign({},vQ.axis,{label:{style:{fill:"#bbbdc3"}},line:{style:{stroke:"#4b4f54"}},tick:{style:{stroke:"#4b4f54"}},subTick:{style:{stroke:"#4b4f54"}}}),vQ.circleAxis=Object.assign({},vQ.circleAxis,{label:{style:{fill:"#bbbdc3"}},line:{style:{stroke:"#4b4f54"}},tick:{style:{stroke:"#4b4f54"}},subTick:{style:{stroke:"#4b4f54"}}}),vQ.grid=Object.assign({},vQ.grid,{style:{stroke:"#404349"}}),vQ.circleGrid=Object.assign({},vQ.circleGrid,{style:{stroke:"#404349"}}),vQ.rectLabel=Object.assign({},vQ.rectLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),vQ.lineLabel=Object.assign({},vQ.lineLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),vQ.symbolLabel=Object.assign({},vQ.symbolLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),vQ.title=Object.assign({},vQ.title,{textStyle:{fill:"#fdfdfd"},subtextStyle:{fill:"#888c93"}});class v0{static registerTheme(t,e){t&&v0._themes.set(t,e)}static unregisterTheme(t){v0._themes.delete(t)}static getTheme(t){return v0._themes.get(t)}static getDefaultTheme(){return v0.getTheme("default")}}v0._themes=new Map,v0.registerTheme("default",{name:"default",padding:5,palette:{default:["#6690F2","#70D6A3","#B4E6E2","#63B5FC","#FF8F62","#FFDC83","#BCC5FD","#A29BFE","#63C4C7","#F68484"]},marks:vJ,components:vq}),v0.registerTheme("dark",{name:"dark",padding:5,background:"#202226",palette:{default:["#5383F4","#7BCF8E","#FF9D2C","#FFDB26","#7568D9","#80D8FB","#1857A3","#CAB0E8","#FF8867","#B9E493","#2CB4A8","#B9E4E3"]},marks:vJ,components:vQ});class v1 extends m7{constructor(t,e,i,r){super(t,c8.component,i),this._componentDatum={key:0},this.componentType=e,this.spec.type="component",this.spec.componentType=e,this.mode=r,this._updateComponentEncoders()}configureComponent(t){return this.spec.componentConfig=t,this.commit(),this}addGraphicItem(t,e,i){let r=null!=i?i:d0.createGraphicComponent(this.componentType,t,{mode:this.mode,skipDefault:this.spec.skipTheme});return r&&(this.emit(pa.BEFORE_ADD_VRENDER_MARK,{graphicItem:r}),this.graphicParent.appendChild(r),this.emit(pa.AFTER_ADD_VRENDER_MARK,{graphicItem:r})),r}join(t){return super.join(t,"key")}encodeState(t,e,i){return super.encodeState(t,e,i),this._updateComponentEncoders(),this}parseRenderContext(){return{large:!1}}_prepareRejoin(){this._componentDatum.key+=1}evaluateJoin(t){return this.spec.key="key",t?(t.key=this._componentDatum.key,this._componentDatum=t):this._componentDatum={key:this._componentDatum.key},super.evaluateJoin([this._componentDatum])}_updateComponentEncoders(){this._encoders=this.spec.encode}_getEncoders(){var t;return null!==(t=this._encoders)&&void 0!==t?t:{}}}class v2 extends em(){static useRegisters(t){t.forEach(t=>{t()})}constructor(t={},e={}){super(),this._observer=null,this._onResize=l3((...t)=>{let e=this._getContainerSize();e&&this.resize(e.width,e.height)},100),this.delegateEvent=(t,e)=>{var i;let r=null===(i=t.target)||void 0===i?void 0:i[fg],n=f6(this,t,r,e,g1);this.emit(e,n,r)},this.handleProgressiveFrame=()=>{this._progressiveMarks.length&&this._progressiveMarks.forEach(t=>{t.isDoingProgressive()&&t.evaluateProgressive()}),this.doPreProgressive()},this._config=e,this._options=Object.assign({mode:"browser"},t),this.initialize()}getGrammarById(t){return this.grammars.getGrammar(t)}getSignalById(t){return this.grammars.getSignal(t)}getDataById(t){return this.grammars.getData(t)}getScaleById(t){return this.grammars.getScale(t)}getCoordinateById(t){return this.grammars.getCoordinate(t)}getMarkById(t){return this.grammars.getMark(t)}getCustomizedById(t){return this.grammars.getCustomized(t)}getGrammarsByName(t){return this.grammars.filter(e=>e.name()===t)}getGrammarsByType(t){return this.grammars.filter(e=>e.grammarType===t)}getMarksByType(t){return this.grammars.getAllMarks().filter(e=>e.markType===t)}getMarksByName(t){return this.grammars.getAllMarks().filter(e=>e.name()===t)}getMarksBySelector(t){if(!t)return null;let e=om(t),i=[];return e.forEach(t=>{if(gH(t))return void i.push(t);if("#"===t[0]){let e=this.getMarkById(t.slice(1));return void(e&&i.push(e))}let e="@"===t[0]?this.getMarksByName(t.slice(1)):ms(t)?this.getMarksByType(t):null;e&&e.length&&e.forEach(t=>{i.push(t)})}),i}updateSignal(t,e){eE(t)&&(t=this.getSignalById(t)),t.set(e),this.commit(t)}signal(t,e){let i=new f9(this);return arguments.length>=1&&i.value(t),arguments.length>=2&&i.update(e),this.grammars.record(i),this._dataflow.add(i),i}data(t){let e=new gQ(this,t);return this.grammars.record(e),this._dataflow.add(e),e}scale(t){let e=d0.createGrammar("scale",this,t);return e&&(this.grammars.record(e),this._dataflow.add(e)),e}coordinate(t){let e=d0.createGrammar("coordinate",this,t);return e&&(this.grammars.record(e),this._dataflow.add(e)),e}mark(t,e,i){let r;let n=eE(e)?this.getMarkById(e):e;switch(t){case c8.group:r=new vt(this,n);break;case c8.glyph:r=new vu(this,null==i?void 0:i.glyphType,n);break;case c8.component:r=d0.hasComponent(null==i?void 0:i.componentType)?d0.createComponent(null==i?void 0:i.componentType,this,n,null==i?void 0:i.mode):new v1(this,null==i?void 0:i.componentType,n,null==i?void 0:i.mode);break;case c8.text:r=new vX(this,t,n);break;default:r=d0.hasMark(t)?d0.createMark(t,this,n):new m7(this,t,n)}return this.grammars.record(r),this._dataflow.add(r),r}group(t){return this.mark(c8.group,t)}glyph(t,e){return this.mark(c8.glyph,e,{glyphType:t})}component(t,e,i="2d"){return this.mark(c8.component,e,{componentType:t,mode:i})}axis(t,e="2d"){return this.mark(c8.component,t,{componentType:c6.axis,mode:e})}grid(t,e="2d"){return this.mark(c8.component,t,{componentType:c6.grid,mode:e})}legend(t){return this.mark(c8.component,t,{componentType:c6.legend})}slider(t){return this.mark(c8.component,t,{componentType:c6.slider})}label(t){return this.mark(c8.component,t,{componentType:c6.label})}datazoom(t){return this.mark(c8.component,t,{componentType:c6.datazoom})}player(t){return this.mark(c8.component,t,{componentType:c6.player})}title(t){return this.mark(c8.component,t,{componentType:c6.title})}scrollbar(t){return this.mark(c8.component,t,{componentType:c6.scrollbar})}customized(t,e){let i=d0.createGrammar(t,this,null==e?void 0:e.type);if(i)return i.parse(e),this.grammars.record(i),this._dataflow.add(i),i}addGrammar(t){return this.grammars.find(e=>e.uid===t.uid)||(this.grammars.record(t),this._dataflow.add(t),t.parse(t.getSpec()),this._needBuildLayoutTree=!0),this}removeGrammar(t){let e=eE(t)?this.getGrammarById(t):t;return e&&this.grammars.find(t=>t.uid===e.uid)&&("mark"===e.grammarType&&e.prepareRelease(),this._cachedGrammars.record(e),this._dataflow.remove(e),this.grammars.unrecord(e),this._needBuildLayoutTree=!0),this}removeAllGrammars(){return this.grammars.traverse(t=>{"signal"===t.grammarType&&mt.includes(t.id())||"mark"===t.grammarType&&"root"===t.id()||this.removeGrammar(t)}),this}removeAllGraphicItems(){return this.traverseMarkTree(t=>{t.graphicItem&&(mo(t.graphicItem),t.elementMap.forEach(t=>{t.resetGraphicItem()}),t.graphicItem=null)}),this}parseSpec(t){var e,i,r,n,s,a;if(this.emit(pa.BEFORE_PARSE_VIEW),this._spec=t,mr(t),t.theme?this.theme(t.theme):this.theme(v0.getDefaultTheme()),t.width&&this.width(t.width),t.height&&this.height(t.height),this.padding(null!==(i=null!==(e=t.padding)&&void 0!==e?e:this._options.padding)&&void 0!==i?i:this._theme.padding),!this.width()||!this.height()){let t=this._getContainerSize();t&&(this.updateSignal(g3,t.width),this.updateSignal(g5,t.height))}(null===(r=t.signals)||void 0===r?void 0:r.length)&&t.signals.forEach(t=>{this.signal().parse(t)}),(null===(n=t.data)||void 0===n?void 0:n.length)&&t.data.forEach(t=>{this.data(null).parse(t)}),(null===(s=t.coordinates)||void 0===s?void 0:s.length)&&t.coordinates.forEach(t=>{var e;null===(e=this.coordinate(t.type))||void 0===e||e.parse(t)}),(null===(a=t.scales)||void 0===a?void 0:a.length)&&t.scales.forEach(t=>{var e;null===(e=this.scale(t.type))||void 0===e||e.parse(t)});let o=d0.getGrammars();return Object.keys(o).forEach(e=>{let{specKey:i}=o[e];t[i]&&t[i].length&&t[i].forEach(t=>{this.customized(e,t)})}),t.marks&&t.marks.length&&t.marks.forEach(t=>{this.parseMarkSpec(t)}),t.events&&t.events.length&&t.events.forEach(t=>{this.event(t)}),t.interactions&&t.interactions.length&&t.interactions.forEach(t=>{this.interaction(t.type,t)}),!1===t.animation?this.animate.disable():this.animate.enable(),this.emit(pa.AFTER_PARSE_VIEW),this._needBuildLayoutTree=!0,this._layoutState=ps.before,this}updateSpec(t){return this.removeAllInteractions(),this.removeAllGrammars(),this.parseSpec(t)}parseBuiltIn(){me(this._options,this._config,this.getCurrentTheme()).forEach(t=>{let e=this.signal().parse(t);t.value&&e.set(t.value)}),this.parseMarkSpec({id:"root",type:"group",encode:{enter:{x:0,y:0},update:{width:{signal:"width"},height:{signal:"height"}}}}),this.rootMark=this.getMarkById("root")}parseMarkSpec(t){var e;let i=t.type===c8.glyph?{glyphType:t.glyphType}:t.type===c8.component?{componentType:t.componentType,mode:t.mode}:null;this.mark(t.type,t.group,i).parse(t),null===(e=t.marks)||void 0===e||e.forEach(t=>{this.parseMarkSpec(t)})}theme(t){var e,i,r,n,s,a;eE(t)?this._theme=null!==(e=v0.getTheme(t))&&void 0!==e?e:v0.getDefaultTheme():this._theme=t;let{background:o,padding:l}=null!==(i=this._spec)&&void 0!==i?i:{};return this._theme?(this.background(null!==(r=null!=o?o:this._options.background)&&void 0!==r?r:this._theme.background),this.padding(null!==(n=null!=l?l:this._options.padding)&&void 0!==n?n:this._theme.padding),null===(a=null===(s=this.renderer.stage())||void 0===s?void 0:s.setTheme)||void 0===a||a.call(s,Object.assign({},this._theme.marks))):(this.background(null!=o?o:this._options.background),this.padding(null!=l?l:this._options.padding)),this}getCurrentTheme(){return this._theme}setCurrentTheme(t,e=!0){return this.theme(t),this.grammars.getAllMarks().forEach(t=>{t.commit()}),e?(this.evaluate(),this.renderer.render(!0)):this._dataflow.evaluate(),this}background(t){return arguments.length?(this._background=t,this.renderer.background(t),t):this._background}width(t){let e=this.getSignalById(g3);return arguments.length?(this._options.width=t,this.updateSignal(e,t),t):e.output()}height(t){let e=this.getSignalById(g5);return arguments.length?(this._options.height=t,this.updateSignal(e,t),t):e.output()}viewWidth(t){let e=this.getSignalById(g4);if(arguments.length){let e=this.padding();return this.width(t+e.left+e.right),t}return e.output()}viewHeight(t){let e=this.getSignalById(g8);if(arguments.length){let e=this.padding();return this.height(t+e.top+e.bottom),t}return e.output()}padding(t){let e=this.getSignalById(g6);if(arguments.length){let i=mi(t);return this.updateSignal(e,i),i}return mi(e.output())}autoFit(t){let e=this.getSignalById(g7);return arguments.length?(this.updateSignal(e,t),t):e.output()}getViewBox(){let t=this.getSignalById(g9);return null==t?void 0:t.output()}updateLayoutTag(){return this._layoutState=ps.before,this}getLayoutState(){return this._layoutState}buildLayoutTree(){let t={},e=[];this.traverseMarkTree(i=>{t[i.id()]=!0,i.group&&t[i.group.id()]||e.push(i),i.markType===c8.group&&i.updateLayoutChildren()},t=>t.needLayout()),this._layoutMarks=e}doLayout(){var t;let e=this._options.doLayout||vh;e&&(null===(t=this._layoutMarks)||void 0===t?void 0:t.length)&&(this.emit(pa.BEFORE_DO_LAYOUT),e(this._layoutMarks,this._options,this),this.emit(pa.AFTER_DO_LAYOUT))}handleLayoutEnd(){this.emit(pa.BEFORE_MARK_LAYOUT_END),this._layoutMarks.forEach(t=>{fp(t,"layoutChildren",t=>{t.handleLayoutEnd()},e=>e!==t)}),this.emit(pa.AFTER_MARK_LAYOUT_END)}handleRenderEnd(){this.emit(pa.BEFORE_MARK_RENDER_END),fp(this.rootMark,"children",t=>{t.handleRenderEnd()}),this.emit(pa.AFTER_MARK_RENDER_END)}commit(t){return this._dataflow.commit(t),this}run(t){return this.evaluate(t),this}doRender(t){this.emit(pa.BEFORE_DO_RENDER),this.renderer&&(this._progressiveMarks||this.animate.animate(),this.renderer.render(t),this.handleRenderEnd()),this.emit(pa.AFTER_DO_RENDER)}evaluate(t){var e,i;let r=mn(t),n=this._cachedGrammars.size()>0;n&&(this.reuseCachedGrammars(r),this.detachCachedGrammar());let s=this._resizeRenderer(),a=this._dataflow.hasCommitted();return(n||a||this._layoutState||s)&&(this.clearProgressive(),this._dataflow.evaluate(),this._needBuildLayoutTree&&(this.buildLayoutTree(),this._needBuildLayoutTree=!1),this._layoutState&&(this._layoutState=ps.layouting,this.doLayout(),this._dataflow.hasCommitted()&&(this._layoutState=ps.reevaluate,this._dataflow.evaluate()),this._layoutState=ps.after,(null===(e=this._layoutMarks)||void 0===e?void 0:e.length)&&this.handleLayoutEnd()),this._layoutState=null,this.findProgressiveMarks(),this._resizeRenderer(),null===(i=this._willMorphMarks)||void 0===i||i.forEach(t=>{this._morph.morph(t.prev,t.next,r)}),this._willMorphMarks=null,this.releaseCachedGrammars(r),this.doRender(!0),this.doPreProgressive()),this}reuseCachedGrammars(t){if(this._willMorphMarks||(this._willMorphMarks=[]),t.reuse){let t=t=>{t.next.reuse(t.prev),t.prev.detachAll(),t.prev.clear(),this._cachedGrammars.unrecord(t.prev)};this._morph.diffGrammar(this._cachedGrammars.getAllSignals(),this.grammars.getAllSignals().filter(t=>!mt.includes(t.id()))).update.forEach(t),this._morph.diffGrammar(this._cachedGrammars.getAllData(),this.grammars.getAllData()).update.forEach(t),this._morph.diffGrammar(this._cachedGrammars.getAllScales(),this.grammars.getAllScales()).update.forEach(t),this._morph.diffGrammar(this._cachedGrammars.getAllCoordinates(),this.grammars.getAllCoordinates()).update.forEach(t)}this._morph.diffMark(this._cachedGrammars.getAllMarks(),this.grammars.getAllMarks().filter(t=>"root"!==t.id()),t).update.forEach(e=>{let i=1===e.prev.length&&1===e.next.length&&e.prev[0].markType===e.next[0].markType,r=e.prev.every(t=>t.getMorphConfig().morph)&&e.next.every(t=>t.getMorphConfig().morph);i&&t.reuse?(e.next[0].reuse(e.prev[0]),e.prev[0].detachAll(),e.prev[0].clear(),this._cachedGrammars.unrecord(e.prev[0])):(t.morph&&r||t.morphAll)&&this._willMorphMarks.push({prev:e.prev,next:e.next})})}detachCachedGrammar(){this._cachedGrammars.traverse(t=>{var e,i;t.detachAll(),"mark"===t.grammarType&&(null===(i=null===(e=t.group)||void 0===e?void 0:e.removeChild)||void 0===i||i.call(e,t))})}releaseCachedGrammars(t){this._cachedGrammars.traverse(t=>{"mark"!==t.grammarType&&t.release()});let e=this._cachedGrammars.getAllMarkNodes();e.forEach(e=>{e.mark.animate.stop(),t.enableExitAnimation&&this.animate.animateAddition(e.mark)});let i=t=>{if(t.mark.view&&0===t.mark.animate.getAnimatorCount()&&(!t.children||0===t.children.length)){t.mark.release();let e=t.parent;e&&(t.parent.children=t.parent.children.filter(e=>e!==t),t.parent=null,i(e))}};e.forEach(t=>{let e=t.mark;0===e.animate.getAnimatorCount()?i(t):e.addEventListener("animationEnd",()=>{0===e.animate.getAnimatorCount()&&i(t)})}),this._cachedGrammars.clear()}runAfter(t){return this._dataflow.runAfter(()=>{t.call(null,this)}),this}runBefore(t){return this._dataflow.runBefore(()=>{t.call(null,this)}),this}getImageBuffer(){var t,e;if("node"!==this._options.mode)return void this.logger.error(TypeError("getImageBuffer() now only support node environment."));let i=null===(e=null===(t=this.renderer)||void 0===t?void 0:t.stage)||void 0===e?void 0:e.call(t);return i?(i.render(),i.window.getImageBuffer()):(this.logger.error(ReferenceError("render is not defined")),null)}traverseMarkTree(t,e,i){return fp(this.rootMark,"children",t,e,i),this}_bindResizeEvent(){var t,e,i,r,n,s;if(this.autoFit()){let a=null===(n=null===(r=null===(i=null===(e=null===(t=this.renderer)||void 0===t?void 0:t.stage)||void 0===e?void 0:e.call(t))||void 0===i?void 0:i.window)||void 0===r?void 0:r.getContainer)||void 0===n?void 0:n.call(r);if(a){let t=window.ResizeObserver;this._observer=new t(this._onResize),null===(s=this._observer)||void 0===s||s.observe(a)}window.addEventListener("resize",this._onResize)}}_unBindResizeEvent(){this.autoFit()&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))}_getContainerSize(){var t,e,i,r,n,s,a,o,l,h,u;let d=null===(n=null===(r=null===(i=null===(e=null===(t=this.renderer)||void 0===t?void 0:t.stage)||void 0===e?void 0:e.call(t))||void 0===i?void 0:i.window)||void 0===r?void 0:r.getContainer)||void 0===n?void 0:n.call(r);if(d){let{width:t,height:e}=aA(d);return{width:null!==(o=null!==(a=null===(s=this._spec)||void 0===s?void 0:s.width)&&void 0!==a?a:this._options.width)&&void 0!==o?o:t,height:null!==(u=null!==(h=null===(l=this._spec)||void 0===l?void 0:l.height)&&void 0!==h?h:this._options.height)&&void 0!==u?u:e}}return null}resize(t,e,i=!0){let r=!1;return t!==this.width()&&(r=!0,this.updateSignal(g3,t)),e!==this.height()&&(r=!0,this.updateSignal(g5,e)),r&&(i?this.evaluate():this._dataflow.evaluate()),this}_resizeRenderer(){let t=this.width(),e=this.height();return!!this.renderer.shouldResize(t,e)&&(this.renderer.resize(t,e),this.emit("resize",{},{width:t,height:e}),!0)}bindEvents(t){if(this._eventConfig.disable)return;let{type:e,filter:i,callback:r,throttle:n,debounce:s,consume:a,target:o,dependency:l}=t,h=mu(e);if(!h)return;let{source:u,type:d}=h,c=ml(h),p=(Array.isArray(o)&&o.length?o.map(t=>({signal:this.getSignalById(t.target),callback:t.callback})):[{signal:eE(o)?this.getSignalById(o):null,callback:r}]).filter(t=>t.signal||t.callback),g=gD(l,this),f=mh((t,e)=>{let r=u===g1&&function(t,e){let i=t.defaults,r=i.prevent,n=i.allow;return!1!==r&&!0!==n&&(!0===r||!1===n||(r?r[e]:!!n&&!n[e]))}(this._eventConfig,d)||a&&(void 0===t.cancelable||t.cancelable);u===g0&&(t=f6(this,t,e,d,g0));let n=!1;if((!i||i(t))&&(!c||c(e))&&p.length){let e=g.reduce((t,e)=>(t[e.id()]=e.output(),t),{});p.forEach(i=>{i.callback&&i.signal?i.signal.set(i.callback(t,e))&&(this.commit(i.signal),n=!0):i.callback?i.callback(t,e):(this.commit(i.signal),n=!0)})}r&&t.preventDefault(),a&&t.stopPropagation(),n&&this.run()},{throttle:n,debounce:s});if(u===g1){if(function(t,e,i){let r=null==t?void 0:t[e];return!(!1===r||nb(r)&&!r[i])}(this._eventConfig,g1,d))return this.addEventListener(d,f,g2),()=>{this.removeEventListener(d,f)}}else if(u===g0)return lX.addEventListener(d,f),this._eventListeners.push({type:d,source:lX,handler:f}),()=>{lX.removeEventListener(d,f);let t=this._eventListeners.findIndex(t=>t.type===d&&t.source===lX&&t.handler===f);t>=0&&this._eventListeners.splice(t,1)}}event(t){if("between"in t){let e;let[i,r]=t.between,n=`${i.type}-${t.type}-${r.type}`;this.bindEvents(Object.assign({},i,{callback:()=>{if(this._eventCache||(this._eventCache={}),!this._eventCache[n]){let e=this.bindEvents(t);this._eventCache[n]=e}e||(e=this.bindEvents(Object.assign({},r,{callback:()=>{this._eventCache[n]&&(this._eventCache[n](),this._eventCache[n]=null)}})))}}))}else"merge"in t?t.merge.forEach(e=>{let i=Object.assign({},t);eE(e)?i.type=e:nb(e)&&Object.assign(i,e),i.debounce=50,this.bindEvents(i)}):this.bindEvents(t)}interaction(t,e){let i=d0.createInteraction(t,this,e);return i&&(i.bind(),this._boundInteractions||(this._boundInteractions=[]),this._boundInteractions.push(i)),i}removeInteraction(t,e){if(this._boundInteractions){let i=this._boundInteractions.filter(i=>{var r;return ej(e)?eE(t)?i.type===t:t?i===t:void 0:(null===(r=i.options)||void 0===r?void 0:r.id)===e});i.length&&i.forEach(t=>{t.unbind()})}return this}removeAllInteractions(){return this._boundInteractions&&(this._boundInteractions.forEach(t=>{t.unbind()}),this._boundInteractions=null),this}initEvent(){let t=this.renderer.stage();t&&t.on("*",this.delegateEvent)}releaseStageEvent(){let t=this.renderer.stage();t&&t.off("*",this.delegateEvent)}addEventListener(t,e,i){let r=e;return i&&!1===i.trap||((r=e).raw=e),i&&i.target&&(r.target=i.target),this.on(t,r),this}removeEventListener(t,e){return e?this.off(t,e):this.off(t),this}initializeRenderer(){let t=this._options.width,e=this._options.height;this.renderer=new f5(this),this.renderer.initialize(t,e,this._options,this._eventConfig).background(this._background)}initialize(){var t,e;this.grammars=new vY(t=>t.id(),(t,e)=>this.logger.warn(`Grammar id '${t}' has been occupied`,e)),this._cachedGrammars=new vK(t=>t.id()),this._options.logger&&ex.setInstance(this._options.logger),this.logger=ex.getInstance(null!==(t=this._options.logLevel)&&void 0!==t?t:0),this._dataflow=new fc,this.animate=new vZ(this),this._morph=new v$,this._options.hooks&&(Object.keys(this._options.hooks).forEach(t=>{this.on(t,this._options.hooks[t])}),this.hooks=this._options.hooks),this.container=null,this.renderer=null,this._eventListeners=[],this._eventConfig=function(t){let e=Object.assign({defaults:{}},t),i=(t,e)=>{e.forEach(e=>{eM(t[e])&&(t[e]=t[e].reduce((t,e)=>(t[e]=!0,t),{}))})};return i(e.defaults,["prevent","allow"]),i(e,[g1,g0]),e}(this._options.eventConfig),this._theme=this._options.disableTheme?null:v0.getDefaultTheme(),this.parseBuiltIn(),(e=this._options).mode&&lX.setEnv(e.mode,e.modeParams||{}),this.initializeRenderer(),this._eventConfig.disable||this.initEvent(),this._bindResizeEvent(),this._needBuildLayoutTree=!0,this._layoutState=ps.before,this.theme(this._theme)}pauseProgressive(){return!1}resumeProgressive(){return!1}restartProgressive(){return!1}findProgressiveMarks(){let t=[];return this.traverseMarkTree(e=>{t.push(e)},t=>t.markType!==c8.group&&t.isProgressive()),t.length?(this._progressiveMarks=t,this.renderer&&this.renderer.combineIncrementalLayers(),t):(this._progressiveMarks=null,null)}doPreProgressive(){if(this._progressiveMarks&&this._progressiveMarks.some(t=>t.isDoingProgressive())){let t=lX.getRequestAnimationFrame();this._progressiveRafId=t(this.handleProgressiveFrame)}}clearProgressive(){this._progressiveRafId&&lX.getCancelAnimationFrame()(this._progressiveRafId),this._progressiveMarks&&this._progressiveMarks.length&&(this._progressiveMarks.forEach(t=>{t.clearProgressive()}),this._progressiveMarks=null)}release(){var t,e,i;this.removeAllInteractions(),this.releaseStageEvent(),this._unBindResizeEvent(),this.clearProgressive(),d0.unregisterRuntimeTransforms(),ex.setInstance(null),this.animate.stop(),this.grammars.release(),this._cachedGrammars.release(),this._dataflow.release(),this._dataflow=null,null===(e=null===(t=this.renderer)||void 0===t?void 0:t.release)||void 0===e||e.call(t),this.renderer=null,this._boundInteractions=null,this.removeAllListeners(),null===(i=this._eventListeners)||void 0===i||i.forEach(t=>{t.source.removeEventListener(t.type,t.handler)}),this._eventListeners=null}}(k=tS||(tS={})).data="data",k.signal="signal",k.mark="mark";class v3{getVGrammarView(){return this._view}getModel(){return this._model}constructor(t,e){this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this.isInited=!1,this._released=!1,this._model={[tS.signal]:{},[tS.data]:{},[tS.mark]:{}},this._compileChart=null,this.handleStageRender=()=>{var t,e;null===(e=null===(t=this._compileChart)||void 0===t?void 0:t.getEvent())||void 0===e||e.emit(c1.afterRender,{chart:this._compileChart})},this._container=t,this._option=e}getRenderer(){var t;return null===(t=this._view)||void 0===t?void 0:t.renderer}getCanvas(){var t;return null===(t=this._view)||void 0===t?void 0:t.renderer.canvas()}getStage(){var t;return null===(t=this._view)||void 0===t?void 0:t.renderer.stage()}initView(){var t,e,i,r;if(this._released||(this.isInited=!0,this._view))return;let n=new ex(null!==(t=this._option.logLevel)&&void 0!==t?t:lS.Error);(null===(e=this._option)||void 0===e?void 0:e.onError)&&n.addErrorHandler((...t)=>{var e,i;null===(i=null===(e=this._option)||void 0===e?void 0:e.onError)||void 0===i||i.call(e,...t)}),this._view=new v2(Object.assign(Object.assign({width:this._width,height:this._height,container:null!==(i=this._container.dom)&&void 0!==i?i:null,renderCanvas:null!==(r=this._container.canvas)&&void 0!==r?r:null,hooks:this._option.performanceHook},this._option),{mode:function(t){switch(t){case lb["desktop-browser"]:case lb["mobile-browser"]:break;case lb.node:case lb.worker:return"node";case lb.miniApp:case lb["desktop-miniApp"]:return"feishu";case lb.lynx:return"lynx";case lb.wx:return"wx";case lb.tt:return"tt";case lb.harmony:return"harmony"}return"browser"}(this._option.mode),autoFit:!1,eventConfig:{gesture:hh(this._option.mode),disable:!1===this._option.interactive},doLayout:()=>{var t;null===(t=this._compileChart)||void 0===t||t.onLayout(this._view)},logger:n,logLevel:n.level()})),this._setCanvasStyle(),this.getStage().hooks.afterRender.tap("chart-event",this.handleStageRender),!1!==this._option.interactive&&this._viewListeners.forEach(t=>{var e;null===(e=this._view)||void 0===e||e.addEventListener(t.type,t.callback)})}_setCanvasStyle(){if(this._view&&this._container.dom&&!eE(this._container.dom)){this._container.dom.style.display="block",this._container.dom.style.position="relative";let t=this.getCanvas();t&&(t.style.display="block")}}compileInteractions(){var t;if(this._view.removeAllInteractions(),null===(t=this._interactions)||void 0===t?void 0:t.length){let t={};this._interactions.forEach(e=>{var i;if(e.regionId){let r=`${e.regionId}-${e.type}-${null!==(i=e.id)&&void 0!==i?i:""}`,n=t[r];t[r]=n?Object.assign(Object.assign(Object.assign({},n),e),{selector:[...n.selector,...e.selector]}):e}else this._view.interaction(e.type,e)}),Object.keys(t).forEach(e=>{let i=this._view.interaction(t[e].type,t[e]);if(this._compileChart){let r=this._compileChart.getRegionsInIds([t[e].regionId])[0];r&&r.interaction.addVgrammarInteraction(i.getStartState(),i)}})}}compile(t,e){if(this._released)return;let{chart:i}=t;this._compileChart=i,this.initView(),this._view&&(i.compile(),i.afterCompile(),this.updateDepend(),this.compileInteractions())}clearNextRender(){return!!this._nextRafId&&(lX.getCancelAnimationFrame()(this._nextRafId),this._nextRafId=null,!0)}clear(t,e=!1){let{chart:i}=t;this.clearNextRender(),i.clear(),this.releaseGrammar(e)}renderNextTick(t){this._released||this._nextRafId||(this._nextRafId=lX.getRequestAnimationFrame()(()=>{this._nextRafId=null,this.render(t)}))}render(t){var e,i;this._released||(this.initView(),this._view&&(null===(e=this._view)||void 0===e||e.run(t),this.clearNextRender()&&(null===(i=this._view)||void 0===i||i.run(t))))}updateViewBox(t,e=!0){this._view&&this._view.renderer.setViewBox(t,e)}resize(t,e,i=!0){this._view&&(this._width=t,this._height=e,this._view.resize(t,e),i&&this.render({morph:!1}))}setBackground(t){var e;null===(e=this._view)||void 0===e||e.background(t)}setSize(t,e){this._width=t,this._height=e,this._view&&(this._view.width(t),this._view.height(e))}setViewBox(t,e=!0){this._view&&this._view.renderer.setViewBox(t,e)}addEventListener(t,e,i){var r,n;if(!1!==this._option.interactive){if(t===c2.chart){let n=(function(r,n){var s,a,o;let l=null!==(a=null===(s=null==n?void 0:n.mark)||void 0===s?void 0:s.getContext())&&void 0!==a?a:{},h=eO(l.modelId)?l.modelId:null,u=eO(l.markId)?l.markId:null,d=eO(l.modelUserId)?l.modelUserId:null,c=eO(l.markUserId)?l.markUserId:null,p={event:r,type:e,source:t,item:n,datum:(null===(o=null==n?void 0:n.getDatum)||void 0===o?void 0:o.call(n))||null,markId:u,modelId:h,markUserId:c,modelUserId:d};i.call(null,p)}).bind(this);this._viewListeners.set(i,{type:e,callback:n}),null===(r=this._view)||void 0===r||r.addEventListener(e,n)}else if(t===c2.window){let r=(function(r){i.call(null,{event:r,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null})}).bind(this);this._windowListeners.set(i,{type:e,callback:r});let n=this._getGlobalThis();null==n||n.addEventListener(e,r)}else if(t===c2.canvas){let r=(function(r){i.call(null,{event:r,type:e,source:t,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null})}).bind(this);this._canvasListeners.set(i,{type:e,callback:r});let s=null===(n=this.getStage())||void 0===n?void 0:n.window;null==s||s.addEventListener(e,r)}}}removeEventListener(t,e,i){var r,n,s,a,o;if(!1!==this._option.interactive){if(t===c2.chart){let t=null===(r=this._viewListeners.get(i))||void 0===r?void 0:r.callback;t&&(null===(n=this._view)||void 0===n||n.removeEventListener(e,t)),this._viewListeners.delete(i)}else if(t===c2.window){let t=this._getGlobalThis(),r=null===(s=this._windowListeners.get(i))||void 0===s?void 0:s.callback;r&&(null==t||t.removeEventListener(e,r)),this._windowListeners.delete(i)}else if(t===c2.canvas){let t=null===(a=this.getStage())||void 0===a?void 0:a.window,r=null===(o=this._canvasListeners.get(i))||void 0===o?void 0:o.callback;t&&r&&(null==t||t.removeEventListener(e,r)),this._canvasListeners.delete(i)}}}releaseEvent(){let t=this.getStage();t&&t.hooks.afterRender.unTap("chart-event",this.handleStageRender),this._viewListeners.clear(),this._windowListeners.clear(),this._canvasListeners.clear()}release(){var t;this.clearNextRender(),this.releaseEvent(),this._option=this._container=null,this._releaseModel(),null===(t=this._view)||void 0===t||t.release(),this._view=null,this.isInited=!1,this._compileChart=null,this._released=!0}releaseGrammar(t=!1){var e,i;this._releaseModel(),t&&(null===(e=this._view)||void 0===e||e.removeAllGraphicItems()),null===(i=this._view)||void 0===i||i.removeAllGrammars()}_releaseModel(){Object.keys(this._model).forEach(t=>{Object.values(this._model[t]).forEach(t=>{Object.values(t).forEach(t=>{t.removeProduct(!0)})}),this._model[t]={}})}addGrammarItem(t){let e=t.getProduct();if(ej(e))return;let i=e.id(),r=t.grammarType;ej(this._model[r][i])&&(this._model[r][i]={}),this._model[r][i][t.id]=t}removeGrammarItem(t,e){var i;let r=t.getProduct();if(ej(r))return;let n=r.id(),s=t.grammarType,a=this._model[s][n];eO(a)&&(delete a[t.id],0===Object.keys(a).length&&delete this._model[s][n]),e||null===(i=this._view)||void 0===i||i.removeGrammar(r)}addInteraction(t){this._interactions||(this._interactions=[]),this._interactions.push(t)}removeInteraction(t){this._interactions&&(this._interactions=this._interactions.filter(e=>e.seriesId!==t))}updateDepend(t){return eO(t)&&t.length>0?t.every(t=>t.updateDepend()):(Object.values(this._model).forEach(t=>{Object.values(t).forEach(t=>{let e=Object.values(t),i=e[0].getProduct(),r=e.reduce((t,e)=>e.getDepend().length>0?t.concat(e.getDepend()):t,[]).filter(t=>!!t).map(t=>t.getProduct());i.depend(r)})}),!0)}_getGlobalThis(){var t;return hl(this._option.mode)?globalThis:null===(t=this.getStage())||void 0===t?void 0:t.window}}let v5={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},v4={poptip:eF({},v5)};function v8(){v8.__loaded||(v8.__loaded=!0,aj.RegisterGraphicCreator("group",sG))}v8.__loaded=!1;class v6{constructor(t,e,i){this.fontFamily=t,this.textOptions=e,this.textMeasure=i}LayoutBBox(t,e,i){if("left"===e||"start"===e)t.xOffset=0;else if("center"===e)t.xOffset=-(t.width/2);else{if("right"!==e&&"end"!==e)throw Error("\u975E\u6CD5\u7684textAlign");t.xOffset=-t.width}return t.yOffset="top"===i?0:"middle"===i?-(t.height/2):"alphabetic"===i?-.79*t.height:-t.height,t}GetLayout(t,e,i,r,n,s,a,o,l){let h=[],u=[e,i],d=[0,0];for(;t.length>0;){let{str:i}=this.textMeasure.clipTextWithSuffix(t,this.textOptions,e,a,o,l);h.push({str:i,width:this.textMeasure.measureTextWidth(i,this.textOptions)}),t=t.substring(i.length)}"left"===r||"start"===r||("center"===r?d[0]=-(u[0]/2):"right"!==r&&"end"!==r||(d[0]=-u[0])),"top"===n||("middle"===n?d[1]=-(u[1]/2):"bottom"===n&&(d[1]=-u[1]));let c={xOffset:d[0],yOffset:d[1],width:u[0],height:u[1]};return this.layoutWithBBox(c,h,r,n,s)}GetLayoutByLines(t,e,i,r,n="",s,a,o="end"){t=t.map(t=>t.toString());let l=[],h=[0,0];if("number"==typeof a&&a!==1/0){let e;for(let i=0,r=t.length;i<r;i++)e=Math.min(this.textMeasure.measureTextWidth(t[i],this.textOptions),a),l.push({str:this.textMeasure.clipTextWithSuffix(t[i],this.textOptions,e,n,s,o).str,width:e});h[0]=a}else{let e,i;a=0;for(let r=0,n=t.length;r<n;r++)i=t[r],e=this.textMeasure.measureTextWidth(i,this.textOptions),a=Math.max(a,e),l.push({str:i,width:e});h[0]=a}h[1]=l.length*r,h[0]=l.reduce((t,e)=>Math.max(t,e.width),0);let u={xOffset:0,yOffset:0,width:h[0],height:h[1]};return this.LayoutBBox(u,e,i),this.layoutWithBBox(u,l,e,i,r)}layoutWithBBox(t,e,i,r,n){let s=[0,0],a=e.length*n;"top"===r||("middle"===r?s[1]=(t.height-a)/2:"bottom"===r&&(s[1]=t.height-a));for(let a=0;a<e.length;a++)this.lineOffset(t,e[a],i,r,n,s);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:n,textAlign:i,textBaseline:r}}lineOffset(t,e,i,r,n,s){return"left"===i||"start"===i?e.leftOffset=0:"center"===i?e.leftOffset=(t.width-e.width)/2:"right"!==i&&"end"!==i||(e.leftOffset=t.width-e.width),e.topOffset=(n-this.textOptions.fontSize)/2+.79*this.textOptions.fontSize+s[1],s[1]+=n,e}}let v9=["text","maxLineWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp",...n4];class v7 extends se{get font(){let t=nf(this).text;return this._font||(this._font=aT(this.attribute,t)),this._font}get clipedText(){var t;let e=this.attribute,i=nf(this).text;if(!this.isSimplify())return;let{maxLineWidth:r=i.maxLineWidth}=e;return Number.isFinite(r)?(this.tryUpdateAABBBounds(),this.cache.clipedText):(null!==(t=e.text)&&void 0!==t?t:i.text).toString()}get clipedWidth(){if(this.isSimplify())return this.tryUpdateAABBBounds(),this.cache.clipedWidth}get cliped(){let t=nf(this).text,e=this.attribute;if(this.isMultiLine)return;let{maxLineWidth:i=t.maxLineWidth}=e;return!!Number.isFinite(i)&&(this.tryUpdateAABBBounds(),"vertical"===e.direction&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map(t=>t.text).join("")!==e.text.toString():null!=this.clipedText&&this.clipedText!==e.text.toString())}get multilineLayout(){if(this.isMultiLine)return this.tryUpdateAABBBounds(),this.cache.layoutData}isSimplify(){return!this.isMultiLine&&"vertical"!==this.attribute.direction}get isMultiLine(){return Array.isArray(this.attribute.text)||"normal"===this.attribute.whiteSpace}constructor(t={text:"",fontSize:16}){super(t),this.type="text",this.numberType=sj,this.cache={}}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{text:t}=this.attribute;return eM(t)?!t.every(t=>null==t||""===t):null!=t&&""!==t}doUpdateAABBBounds(){let t=nf(this).text;this._AABBBounds.clear();let e=this.attribute,i=rj.graphicService.updateTextAABBBounds(e,t,this._AABBBounds,this),{boundsPadding:r=t.boundsPadding}=this.attribute,n=ss(r);return n&&i.expand(n),this.clearUpdateBoundTag(),i}updateWrapAABBBounds(t){var e,i,r,n;let s=nf(this).text,{fontFamily:a=s.fontFamily,textAlign:o=s.textAlign,textBaseline:l=s.textBaseline,fontSize:h=s.fontSize,ellipsis:u=s.ellipsis,maxLineWidth:d,stroke:c=s.stroke,lineWidth:p=s.lineWidth,wordBreak:g=s.wordBreak,fontWeight:f=s.fontWeight,ignoreBuf:m=s.ignoreBuf,suffixPosition:v=s.suffixPosition,heightLimit:y=0,lineClamp:_}=this.attribute,b=null!==(e=sm(this.attribute.lineHeight,this.attribute.fontSize||s.fontSize))&&void 0!==e?e:this.attribute.fontSize||s.fontSize;if(!this.shouldUpdateShape()&&(null===(i=this.cache)||void 0===i?void 0:i.layoutData)){let t=this.cache.layoutData.bbox;return this._AABBBounds.set(t.xOffset,t.yOffset,t.xOffset+t.width,t.yOffset+t.height),c&&this._AABBBounds.expand(p/2),this._AABBBounds}let x=new v6(a,{fontSize:h,fontWeight:f,fontFamily:a},rj.graphicUtil.textMeasure),S=eM(t)?t.map(t=>t.toString()):[t.toString()],k=[],A=[0,0],w=1/0;if(y>0&&(w=Math.max(Math.floor(y/b),1)),_&&(w=Math.min(w,_)),"number"==typeof d&&d!==1/0){if(d>0)for(let t=0;t<S.length;t++){let e=S[t],i=!0;if(t===w-1){let i=x.textMeasure.clipTextWithSuffix(e,x.textOptions,d,u,!1,v,t!==S.length-1);k.push({str:i.str,width:i.width});break}let s=x.textMeasure.clipText(e,x.textOptions,d,"break-word"===g);if(""!==e&&""===s.str){if(u){let t=x.textMeasure.clipTextWithSuffix(e,x.textOptions,d,u,!1,v);s.str=null!==(r=t.str)&&void 0!==r?r:"",s.width=null!==(n=t.width)&&void 0!==n?n:0}else s.str="",s.width=0;i=!1}if(k.push({str:s.str,width:s.width}),s.str.length===e.length);else if(i){let i=e.substring(s.str.length);S.splice(t+1,0,i)}}let t=0;k.forEach(e=>{t=Math.max(t,e.width)}),A[0]=t}else{let t,e,i=0;for(let r=0,n=S.length;r<n;r++){if(r===w-1){let t=x.textMeasure.clipTextWithSuffix(S[r],x.textOptions,d,u,!1,v);k.push({str:t.str,width:t.width}),i=Math.max(i,t.width);break}e=S[r],i=Math.max(i,t=x.textMeasure.measureTextWidth(e,x.textOptions,"break-word"===g)),k.push({str:e,width:t})}A[0]=i}A[1]=k.length*(b+(m?0:2));let M={xOffset:0,yOffset:0,width:A[0],height:A[1]};x.LayoutBBox(M,o,l);let C=x.layoutWithBBox(M,k,o,l,b);return this.cache.layoutData=C,this.clearUpdateShapeTag(),this._AABBBounds.set(M.xOffset,M.yOffset,M.xOffset+M.width,M.yOffset+M.height),c&&this._AABBBounds.expand(p/2),this._AABBBounds}updateSingallineAABBBounds(t){let e=nf(this).text,{direction:i=e.direction,underlineOffset:r=e.underlineOffset}=this.attribute,n="horizontal"===i?this.updateHorizontalSinglelineAABBBounds(t):this.updateVerticalSinglelineAABBBounds(t);return"horizontal"===i&&r&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+r),n}updateMultilineAABBBounds(t){let e=nf(this).text,{direction:i=e.direction,underlineOffset:r=e.underlineOffset}=this.attribute,n="horizontal"===i?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t);return"horizontal"===i&&r&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+r),n}updateHorizontalSinglelineAABBBounds(t){var e,i;let r,n;let s=nf(this).text,{wrap:a=s.wrap}=this.attribute;if(a)return this.updateWrapAABBBounds([t]);let o=rj.graphicUtil.textMeasure,l=this.attribute,{maxLineWidth:h=s.maxLineWidth,ellipsis:u=s.ellipsis,textAlign:d=s.textAlign,textBaseline:c=s.textBaseline,fontFamily:p=s.fontFamily,fontSize:g=s.fontSize,fontWeight:f=s.fontWeight,stroke:m=s.stroke,lineWidth:v=s.lineWidth,ignoreBuf:y=s.ignoreBuf,whiteSpace:_=s.whiteSpace,suffixPosition:b=s.suffixPosition}=l;if("normal"===_)return this.updateWrapAABBBounds(t);let x=y?0:Math.max(2,.075*g),S=l.fontSize||s.fontSize,k=null!==(e=sm(l.lineHeight,S))&&void 0!==e?e:S+x;if(!this.shouldUpdateShape()&&this.cache){let t=aE(d,r=null!==(i=this.cache.clipedWidth)&&void 0!==i?i:0),e=aO(c,k,g);return this._AABBBounds.set(t,e,t+r,e+k),m&&this._AABBBounds.expand(v/2),this._AABBBounds}if(Number.isFinite(h)){if(u){let e=!0===u?s.ellipsis:u,i=o.clipTextWithSuffix(t.toString(),{fontSize:g,fontWeight:f,fontFamily:p},h,e,!1,b);n=i.str,r=i.width}else{let e=o.clipText(t.toString(),{fontSize:g,fontWeight:f,fontFamily:p},h,!1);n=e.str,r=e.width}this.cache.clipedText=n,this.cache.clipedWidth=r}else r=o.measureTextWidth(t.toString(),{fontSize:g,fontWeight:f,fontFamily:p}),this.cache.clipedText=t.toString(),this.cache.clipedWidth=r;this.clearUpdateShapeTag();let A=aE(d,r),w=k;rj.global&&rj.global.isSafari()&&(w+=.2*g);let M=aO(c,w,g,x);return this._AABBBounds.set(A,M,A+r,M+w),m&&this._AABBBounds.expand(v/2),this._AABBBounds}getBaselineMapAlign(){return v7.baselineMapAlign}getAlignMapBaseline(){return v7.alignMapBaseline}updateVerticalSinglelineAABBBounds(t){var e,i,r;let n;let s=nf(this).text,a=rj.graphicUtil.textMeasure,o=this.attribute,{ignoreBuf:l=s.ignoreBuf}=o,{maxLineWidth:h=s.maxLineWidth,ellipsis:u=s.ellipsis,fontSize:d=s.fontSize,fontWeight:c=s.fontWeight,fontFamily:p=s.fontFamily,stroke:g=s.stroke,lineWidth:f=s.lineWidth,verticalMode:m=s.verticalMode,suffixPosition:v=s.suffixPosition}=o,y=null!==(e=sm(o.lineHeight,o.fontSize||s.fontSize))&&void 0!==e?e:(o.fontSize||s.fontSize)+(l?0:2),{textAlign:_=s.textAlign,textBaseline:b=s.textBaseline}=o;if(!m){let t=_;_=null!==(i=v7.baselineMapAlign[b])&&void 0!==i?i:"left",b=null!==(r=v7.alignMapBaseline[t])&&void 0!==r?r:"top"}if(!this.shouldUpdateShape()&&this.cache){let t=aE(_,n=this.cache.clipedWidth),e=aO(b,y,d);return this._AABBBounds.set(e,t,e+y,t+n),g&&this._AABBBounds.expand(f/2),this._AABBBounds}let x=[sb(t.toString())];if(Number.isFinite(h)){if(u){let t=!0===u?s.ellipsis:u,e=a.clipTextWithSuffixVertical(x[0],{fontSize:d,fontWeight:c,fontFamily:p},h,t,!1,v);x=[e.verticalList],n=e.width}else{let t=a.clipTextVertical(x[0],{fontSize:d,fontWeight:c,fontFamily:p},h,!1);x=[t.verticalList],n=t.width}this.cache.verticalList=x,this.cache.clipedWidth=n}else n=0,x[0].forEach(t=>{let e=t.direction===lL.HORIZONTAL?d:a.measureTextWidth(t.text,{fontSize:d,fontWeight:c,fontFamily:p});n+=e,t.width=e}),this.cache.verticalList=x,this.cache.clipedWidth=n;this.clearUpdateShapeTag();let S=aE(_,n),k=aO(b,y,d);return this._AABBBounds.set(k,S,k+y,S+n),g&&this._AABBBounds.expand(f/2),this._AABBBounds}updateHorizontalMultilineAABBBounds(t){var e,i;let r=nf(this).text,{wrap:n=r.wrap}=this.attribute;if(n)return this.updateWrapAABBBounds(t);let s=this.attribute,{fontFamily:a=r.fontFamily,textAlign:o=r.textAlign,textBaseline:l=r.textBaseline,fontSize:h=r.fontSize,fontWeight:u=r.fontWeight,ellipsis:d=r.ellipsis,maxLineWidth:c,stroke:p=r.stroke,lineWidth:g=r.lineWidth,whiteSpace:f=r.whiteSpace,suffixPosition:m=r.suffixPosition}=s,v=null!==(e=sm(s.lineHeight,s.fontSize||r.fontSize))&&void 0!==e?e:s.fontSize||r.fontSize;if("normal"===f)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(null===(i=this.cache)||void 0===i?void 0:i.layoutData)){let t=this.cache.layoutData.bbox;return this._AABBBounds.set(t.xOffset,t.yOffset,t.xOffset+t.width,t.yOffset+t.height),p&&this._AABBBounds.expand(g/2),this._AABBBounds}let y=new v6(a,{fontSize:h,fontWeight:u,fontFamily:a},rj.graphicUtil.textMeasure).GetLayoutByLines(t,o,l,v,!0===d?r.ellipsis:d||void 0,!1,c,m),{bbox:_}=y;return this.cache.layoutData=y,this.clearUpdateShapeTag(),this._AABBBounds.set(_.xOffset,_.yOffset,_.xOffset+_.width,_.yOffset+_.height),p&&this._AABBBounds.expand(g/2),this._AABBBounds}updateVerticalMultilineAABBBounds(t){var e,i,r;let n;let s=nf(this).text,a=rj.graphicUtil.textMeasure,o=this.attribute,{ignoreBuf:l=s.ignoreBuf}=o,{maxLineWidth:h=s.maxLineWidth,ellipsis:u=s.ellipsis,fontFamily:d=s.fontFamily,fontSize:c=s.fontSize,fontWeight:p=s.fontWeight,stroke:g=s.stroke,lineWidth:f=s.lineWidth,verticalMode:m=s.verticalMode,suffixPosition:v=s.suffixPosition}=o,y=null!==(e=sm(o.lineHeight,o.fontSize||s.fontSize))&&void 0!==e?e:(o.fontSize||s.fontSize)+(l?0:2),{textAlign:_=s.textAlign,textBaseline:b=s.textBaseline}=o;if(!m){let t=_;_=null!==(i=v7.baselineMapAlign[b])&&void 0!==i?i:"left",b=null!==(r=v7.alignMapBaseline[t])&&void 0!==r?r:"top"}if(n=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach(t=>{n=ih(t.reduce((t,e)=>t+e.width,0),n)});let t=aE(_,n),e=this.cache.verticalList.length*y,i=aO(b,e,c);return this._AABBBounds.set(i,t,i+e,t+n),g&&this._AABBBounds.expand(f/2),this._AABBBounds}let x=t.map(t=>sb(t.toString()));x.forEach((t,e)=>{if(Number.isFinite(h)){if(u){let i=!0===u?s.ellipsis:u,r=a.clipTextWithSuffixVertical(t,{fontSize:c,fontWeight:p,fontFamily:d},h,i,!1,v);x[e]=r.verticalList,n=r.width}else{let i=a.clipTextVertical(t,{fontSize:c,fontWeight:p,fontFamily:d},h,!1);x[e]=i.verticalList,n=i.width}}else n=0,t.forEach(t=>{let e=t.direction===lL.HORIZONTAL?c:a.measureTextWidth(t.text,{fontSize:c,fontWeight:p,fontFamily:d});n+=e,t.width=e})}),this.cache.verticalList=x,this.clearUpdateShapeTag(),this.cache.verticalList.forEach(t=>{n=ih(t.reduce((t,e)=>t+e.width,0),n)});let S=aE(_,n),k=this.cache.verticalList.length*y,A=aO(b,k,c);return this._AABBBounds.set(A,S,A+k,S+n),g&&this._AABBBounds.expand(f/2),this._AABBBounds}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}getDefaultAttribute(t){return nf(this).text[t]}needUpdateTags(t,e=v9){return super.needUpdateTags(t,e)}needUpdateTag(t,e=v9){return super.needUpdateTag(t,e)}clone(){return new v7(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return v7.NOWORK_ANIMATE_ATTR}}function yt(t){return new v7(t)}v7.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},st),v7.baselineMapAlign={top:"left",bottom:"right",middle:"center"},v7.alignMapBaseline={left:"top",right:"bottom",center:"middle"};function ye(t){return u||(u=aj.CreateGraphic("text",{})),u.initAttributes(t),u.AABBBounds}let yi=new class t extends o${constructor(){super(...arguments),this.time=lP.beforeFillStroke}drawShape(t,e,i,r,n,s,a,o,l,h,u,d){var c,p,g,f,m,v,y,_,b,x;let S;let{backgroundMode:k=l.backgroundMode,backgroundFit:A=l.backgroundFit}=t.attribute,w,{background:M}=t.attribute;if(!M)return;let C=()=>{"richtext"===t.type&&(e.restore(),e.save(),w&&e.setTransformFromMatrix(w,!0,1))};"richtext"===t.type&&(w=e.currentMatrix.clone(),e.restore(),e.save(),e.setTransformForCurrent());let T=nb(M)&&M.background,E=t.transMatrix.onlyTranslate();if(T){let e=t.AABBBounds,i=(null!==(c=M.x)&&void 0!==c?c:e.x1)+(null!==(p=M.dx)&&void 0!==p?p:0),r=(null!==(g=M.y)&&void 0!==g?g:e.y1)+(null!==(f=M.dy)&&void 0!==f?f:0),n=null!==(m=M.width)&&void 0!==m?m:e.width(),s=null!==(v=M.height)&&void 0!==v?v:e.height();if(S=op.allocate(i,r,i+n,r+s),M=M.background,!E){let t=S.width(),e=S.height();S.set((null!==(y=M.x)&&void 0!==y?y:0)+(null!==(_=M.dx)&&void 0!==_?_:0),(null!==(b=M.y)&&void 0!==b?b:0)+(null!==(x=M.dy)&&void 0!==x?x:0),t,e)}}else S=t.AABBBounds,E||(S=ye(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(t.backgroundImg&&t.resources){let n=t.resources.get(M);if("success"!==n.state||!n.data)return void C();e.highPerformanceSave(),E&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,i,r,l),this.doDrawImage(e,n.data,S,k,A),e.highPerformanceRestore(),e.setTransformForCurrent()}else{let{backgroundCornerRadius:n}=t.attribute;e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,r,l),e.fillStyle=M,n?(oA(e,S.x1,S.y1,S.width(),S.height(),n),e.fill()):e.fillRect(S.x1,S.y1,S.width(),S.height()),e.highPerformanceRestore()}T&&op.free(S),C()}};var yr=function(t,e){return function(i,r){e(i,r,t)}};let yn=class extends oQ{constructor(t){super(),this.textRenderContribitions=t,this.numberType=sj,this.builtinContributions=[yi],this.init(t)}drawShape(t,e,i,r,n,s,a,o){var l,h,u;let d=nf(t,null==s?void 0:s.theme).text,{text:c,underline:p=d.underline,lineThrough:g=d.lineThrough,keepDirIn3d:f=d.keepDirIn3d,direction:m=d.direction,whiteSpace:v=d.whiteSpace,fontSize:y=d.fontSize,verticalMode:_=d.verticalMode,x:b=d.x,y:x=d.y}=t.attribute,{textAlign:S=d.textAlign,textBaseline:k=d.textBaseline}=t.attribute;if(!_&&"vertical"===m){let e=S;S=null!==(l=t.getBaselineMapAlign()[k])&&void 0!==l?l:"left",k=null!==(h=t.getAlignMapBaseline()[e])&&void 0!==h?h:"top"}let A=null!==(u=sm(t.attribute.lineHeight,y))&&void 0!==u?u:y,w=this.valid(t,d,a,o);if(!w)return;let{fVisible:M,sVisible:C,doFill:T,doStroke:E}=w,O=!f,P=this.z||0;e.beginPath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,r,T,E,M,C,d,n,a,o),O&&this.transformUseContext2d(t,d,P,e);let R=(n,s,l,h)=>{let u=i+s,c=r+l;if(h){e.highPerformanceSave(),u+=y;let t=am.allocate(1,0,0,1,0,0);t.rotateByCenter(Math.PI/2,u,c),e.transformFromMatrix(t,!0),am.free(t)}E&&(o?o(e,t.attribute,d):C&&(e.setStrokeStyle(t,t.attribute,b-i,x-r,d),e.strokeText(n,u,c,P))),T&&(a?a(e,t.attribute,d):M&&(e.setCommonStyle(t,t.attribute,b-i,x-r,d),e.fillText(n,u,c,P),this.drawUnderLine(p,g,t,u,c,P,d,e))),h&&(e.highPerformanceRestore(),e.setTransformForCurrent())};if(t.isMultiLine){if(e.setTextStyleWithoutAlignBaseline(t.attribute,d,P),"horizontal"===m){let{multilineLayout:n}=t;if(!n)return void e.highPerformanceRestore();let{xOffset:s,yOffset:l}=n.bbox;E&&(o?o(e,t.attribute,d):C&&(e.setStrokeStyle(t,t.attribute,b-i,x-r,d),n.lines.forEach(t=>{e.strokeText(t.str,(t.leftOffset||0)+s+i,(t.topOffset||0)+l+r,P)}))),T&&(a?a(e,t.attribute,d):M&&(e.setCommonStyle(t,t.attribute,b-i,x-r,d),n.lines.forEach(n=>{var a,o;e.fillText(n.str,(n.leftOffset||0)+s+i,(n.topOffset||0)+l+r,P),this.drawMultiUnderLine(p,g,t,(n.leftOffset||0)+s+i,(n.topOffset||0)+l+r-(a="bottom",o=y,"top"===a?Math.ceil(.79*o):"middle"===a?Math.round(.3*o):"bottom"===a?Math.round(-.21*o):0)-.05*y,P,n.width,d,e)})))}else{t.tryUpdateAABBBounds();let{verticalList:i}=t.cache;e.textAlign="left",e.textBaseline="top";let r=A*i.length,n=0;i.forEach(t=>{n=ih(t.reduce((t,e)=>t+(e.width||0),0),n)});let s=0,a=0;"bottom"===k?a=-r:"middle"===k&&(a=-r/2),"center"===S?s-=n/2:"right"===S&&(s-=n),i.forEach((t,e)=>{let i=t.reduce((t,e)=>t+(e.width||0),0),o=n-i,l=s;"center"===S?l+=o/2:"right"===S&&(l+=o),t.forEach(t=>{let{text:i,width:n,direction:s}=t;R(i,r-(e+1)*A+a,l,s),l+=n})})}}else if("horizontal"===m){e.setTextStyle(t.attribute,d,P);let i=t.clipedText,r=0;A!==y&&("top"===k?r=(A-y)/2:"middle"===k||"bottom"===k&&(r=-(A-y)/2)),R(i,0,r,0)}else{t.tryUpdateAABBBounds();let i=t.cache;if(i){e.setTextStyleWithoutAlignBaseline(t.attribute,d,P);let{verticalList:r}=i,n=0,s=r[0].reduce((t,e)=>t+(e.width||0),0),a=0;"bottom"===k?a=-A:"middle"===k&&(a=-A/2),"center"===S?n-=s/2:"right"===S&&(n-=s),e.textAlign="left",e.textBaseline="top",r[0].forEach(t=>{let{text:e,width:i,direction:r}=t;R(e,a,n,r),n+=i})}}O&&this.restoreTransformUseContext2d(t,d,P,e),this.afterRenderStep(t,e,i,r,T,E,M,C,d,n,a,o)}draw(t,e,i,r){let n=nf(t,null==r?void 0:r.theme).text,{keepDirIn3d:s=n.keepDirIn3d}=t.attribute;this._draw(t,n,!s,i,r)}drawUnderLine(t,e,i,r,n,s,a,o){if(e+t<=0)return;let{textAlign:l=a.textAlign,textBaseline:h=a.textBaseline,fontSize:u=a.fontSize,fill:d=a.fill,opacity:c=a.opacity,underlineOffset:p=a.underlineOffset,underlineDash:g=a.underlineDash,fillOpacity:f=a.fillOpacity}=i.attribute,m=i.clipedWidth,v=aE(l,m),y=aO(h,u,u),_={lineWidth:0,stroke:d,opacity:c,strokeOpacity:f};if(t){_.lineWidth=t,o.setStrokeStyle(i,_,r,n,a),g&&o.setLineDash(g),o.beginPath();let e=n+y+u+p;o.moveTo(r+v,e,s),o.lineTo(r+v+m,e,s),o.stroke()}if(e){_.lineWidth=e,o.setStrokeStyle(i,_,r,n,a),o.beginPath();let t=n+y+u/2;o.moveTo(r+v,t,s),o.lineTo(r+v+m,t,s),o.stroke()}}drawMultiUnderLine(t,e,i,r,n,s,a,o,l){if(e+t<=0)return;let{fontSize:h=o.fontSize,fill:u=o.fill,opacity:d=o.opacity,underlineOffset:c=o.underlineOffset,underlineDash:p=o.underlineDash,fillOpacity:g=o.fillOpacity}=i.attribute,f=aO("alphabetic",h,h),m={lineWidth:0,stroke:u,opacity:d,strokeOpacity:g},v=-3;if(t){m.lineWidth=t,l.setStrokeStyle(i,m,r,n,o),p&&l.setLineDash(p),l.beginPath();let e=n+f+h+v+c;l.moveTo(r+0,e,s),l.lineTo(r+0+a,e,s),l.stroke()}if(v=-1,e){m.lineWidth=e,l.setStrokeStyle(i,m,r,n,o),l.beginPath();let t=n+f+h/2+v;l.moveTo(r+0,t,s),l.lineTo(r+0+a,t,s),l.stroke()}}};yn=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),yr(0,e0(e2)),yr(0,e1(oW)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],yn);let ys=!1,ya=new eW(t=>{ys||(ys=!0,t(ar).to(yn).inSingletonScope(),t(s4).toService(ar),t(oW).toService(oK),e5(t,oW))}),yo=hs(),yl=Symbol.for("MathPickerContribution"),yh=Symbol.for("MathArcPicker"),yu=Symbol.for("MathAreaPicker"),yd=Symbol.for("MathCirclePicker"),yc=Symbol.for("MathImagePicker"),yp=Symbol.for("MathLinePicker"),yg=Symbol.for("MathPathPicker"),yf=Symbol.for("MathRectPicker"),ym=Symbol.for("MathSymbolPicker"),yv=Symbol.for("MathTextPicker"),yy=Symbol.for("MathPolygonPicker"),y_=Symbol.for("MathGlyphPicker"),yb=Symbol.for("CanvasArcPicker"),yx=Symbol.for("CanvasArc3dPicker"),yS=Symbol.for("CanvasAreaPicker"),yk=Symbol.for("CanvasCirclePicker"),yA=Symbol.for("CanvasImagePicker"),yw=Symbol.for("CanvasLinePicker"),yM=Symbol.for("CanvasPathPicker"),yC=Symbol.for("CanvasRectPicker"),yT=Symbol.for("CanvasRect3dPicker"),yE=Symbol.for("CanvasSymbolPicker"),yO=Symbol.for("CanvasTextPicker"),yP=Symbol.for("CanvasPolygonPicker"),yR=Symbol.for("CanvasPyramid3dPicker"),yB=Symbol.for("CanvasRichTextPicker"),yI=Symbol.for("CanvasGlyphPicker"),yL=Symbol.for("CanvasGroupPicker"),yD=Symbol.for("CanvasPickerContribution"),yF=class extends oQ{};yF=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],yF);let yj=class extends yF{constructor(t){super(),this.canvasRenderer=t,this.type="text",this.numberType=sj}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=t.AABBBounds;if(!r.camera)return!!n.containsPoint(e);r.highPerformanceSave();let s=nf(t).text,{keepDirIn3d:a=s.keepDirIn3d}=t.attribute,{x:o,y:l,z:h,lastModelMatrix:u}=this.transform(t,s,r,!a);this.canvasRenderer.z=h;let d=e;if(r.camera){d=e.clone();let i=t.parent.globalTransMatrix;d.x=i.a*e.x+i.c*e.y+i.e,d.y=i.b*e.x+i.d*e.y+i.f}let c=!1;return this.canvasRenderer.drawShape(t,r,o,l,{},null,(e,i,r)=>{if(c)return!0;let{fontSize:n=s.fontSize,textBaseline:a=s.textBaseline,textAlign:u=s.textAlign}=t.attribute,p=t.AABBBounds,g=p.height(),f=p.width(),m=aO(a,g,n),v=aE(u,f);return e.rect(v+o,m+l,f,g,h),c=e.isPointInPath(d.x,d.y)},(t,e,i)=>c),this.canvasRenderer.z=0,r.modelMatrix!==u&&av.free(r.modelMatrix),r.modelMatrix=u,r.highPerformanceRestore(),c}};yj=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(A=0,w=e0(ar),function(t,e){w(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],yj);let yN=!1,yz=new eW((t,e,i,r)=>{yN||(yN=!0,t(yO).to(yj).inSingletonScope(),t(yD).toService(yO))}),yH=class{constructor(){this.type="text",this.numberType=sj}contains(t,e,i){return!!t.AABBBounds.containsPoint(e)}};yH=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],yH);let yV=!1,yW=new eW((t,e,i,r)=>{yV||(yV=!0,t(yv).to(yH).inSingletonScope(),t(yl).toService(yv))});function yG(){yG.__loaded||(yG.__loaded=!0,aj.RegisterGraphicCreator("text",yt),r4.load(ya),r4.load(yo?yz:yW))}yG.__loaded=!1;class yU{bounds(t,e){if(ey(t)){let i=t/2;e.x1=-i,e.x2=i,e.y1=-i,e.y2=i}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}}function y$(t,e,i,r,n){return n?t.arc(i,r,e,0,ir,!1,n):t.arc(i,r,e,0,ir),!1}let yY=new class t extends yU{constructor(){super(...arguments),this.type="circle",this.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0"}draw(t,e,i,r,n){return y$(t,e/2,i,r,n)}drawOffset(t,e,i,r,n,s){return y$(t,e/2+n,i,r,s)}drawToSvgPath(t,e,i,r){let n=t/2;return`M ${e-n}, ${i} a ${n},${n} 0 1,0 ${2*n},0 a ${n},${n} 0 1,0 -${2*n},0`}},yK=new class t extends yU{constructor(){super(...arguments),this.type="cross",this.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z"}draw(t,e,i,r,n){var s,a,o,l,h;return s=t,a=e/6,o=i,l=r,h=n,s.moveTo(-3*a+o,-a+l,h),s.lineTo(-a+o,-a+l,h),s.lineTo(-a+o,-3*a+l,h),s.lineTo(a+o,-3*a+l,h),s.lineTo(a+o,-a+l,h),s.lineTo(3*a+o,-a+l,h),s.lineTo(3*a+o,a+l,h),s.lineTo(a+o,a+l,h),s.lineTo(a+o,3*a+l,h),s.lineTo(-a+o,3*a+l,h),s.lineTo(-a+o,a+l,h),s.lineTo(-3*a+o,a+l,h),s.closePath(),!0}drawOffset(t,e,i,r,n,s){var a,o,l,h,u,d;return a=t,o=e/6,l=i,h=r,u=n,d=s,a.moveTo(-3*o+l-u,-o+h-u,d),a.lineTo(-o+l-u,-o+h-u,d),a.lineTo(-o+l-u,-3*o+h-u,d),a.lineTo(o+l+u,-3*o+h-u,d),a.lineTo(o+l+u,-o+h-u,d),a.lineTo(3*o+l+u,-o+h-u,d),a.lineTo(3*o+l+u,o+h+u,d),a.lineTo(o+l+u,o+h+u,d),a.lineTo(o+l+u,3*o+h+u,d),a.lineTo(-o+l-u,3*o+h+u,d),a.lineTo(-o+l-u,o+h+u,d),a.lineTo(-3*o+l-u,o+h+u,d),a.closePath(),!0}};function yZ(t,e,i,r,n){return t.moveTo(i,r-e,n),t.lineTo(e+i,r,n),t.lineTo(i,r+e,n),t.lineTo(i-e,r,n),t.closePath(),!0}let yX=new class t extends yU{constructor(){super(...arguments),this.type="diamond",this.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z"}draw(t,e,i,r,n){return yZ(t,e/2,i,r,n)}drawFitDir(t,e,i,r,n){return yZ(t,e/2,i,r,n)}drawOffset(t,e,i,r,n,s){return yZ(t,e/2+n,i,r,s)}};function yq(t,e,i,r){let n=2*e;return t.rect(i-e,r-e,n,n),!1}let yJ=new class t extends yU{constructor(){super(...arguments),this.type="square",this.pathStr="M-0.5,-0.5h1v1h-1Z"}draw(t,e,i,r){return yq(t,e/2,i,r)}drawOffset(t,e,i,r,n){return yq(t,e/2+n,i,r)}};class yQ extends yU{constructor(){super(...arguments),this.type="triangleUp",this.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z"}draw(t,e,i,r){var n,s,a,o;return n=t,s=e/2,a=i,o=r,n.moveTo(a+s,s+o),n.lineTo(a-s,s+o),n.lineTo(a,o-s),n.closePath(),!0}drawOffset(t,e,i,r,n){var s,a,o,l,h;return s=t,a=e/2,o=i,l=r,h=n,s.moveTo(o+a+2*h,a+l+h),s.lineTo(o-a-2*h,a+l+h),s.lineTo(o,l-a-2*h),s.closePath(),!0}}let y0=new yQ,y1=new class t extends yQ{constructor(){super(...arguments),this.type="triangle"}},y2=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),y3=Math.sin(ir/10)*y2,y5=-Math.cos(ir/10)*y2;function y4(t,e,i,r){let n=y3*e,s=y5*e;t.moveTo(i,-e+r),t.lineTo(n+i,s+r);for(let a=1;a<5;++a){let o=ir*a/5,l=Math.cos(o),h=Math.sin(o);t.lineTo(h*e+i,-l*e+r),t.lineTo(l*n-h*s+i,h*n+l*s+r)}return t.closePath(),!0}let y8=new class t extends yU{constructor(){super(...arguments),this.type="star",this.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z"}draw(t,e,i,r){return y4(t,e/2,i,r)}drawOffset(t,e,i,r,n){return y4(t,e/2+n,i,r)}},y6=ic(3);function y9(t,e,i,r){let n=e/y6,s=n/5;return t.moveTo(0+i,-e+r),t.lineTo(n/2+i,r),t.lineTo(s/2+i,r),t.lineTo(s/2+i,e+r),t.lineTo(-s/2+i,e+r),t.lineTo(-s/2+i,r),t.lineTo(-n/2+i,r),t.closePath(),!0}let y7=new class t extends yU{constructor(){super(...arguments),this.type="arrow",this.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z"}draw(t,e,i,r){return y9(t,e/2,i,r)}drawOffset(t,e,i,r,n){return y9(t,e/2+n,i,r)}};function _t(t,e,i,r){let n=2*e;return t.moveTo(i,-e+r),t.lineTo(n/3/2+i,e+r),t.lineTo(-n/3/2+i,e+r),t.closePath(),!0}let _e=new class t extends yU{constructor(){super(...arguments),this.type="wedge",this.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z"}draw(t,e,i,r){return _t(t,e/2,i,r)}drawOffset(t,e,i,r,n){return _t(t,e/2+n,i,r)}};function _i(t,e,i,r){return t.moveTo(-e+i,r),t.lineTo(i,e+r),!1}let _r=new class t extends yU{constructor(){super(...arguments),this.type="stroke",this.pathStr=""}draw(t,e,i,r){return _i(t,e/2,i,r)}drawOffset(t,e,i,r,n){return _i(t,e/2+n,i,r)}},_n=ic(3)/2,_s=1/ic(12);function _a(t,e,i,r){let n=e/2,s=e*_s,a=e*_s+e,o=-n;return t.moveTo(n+i,s+r),t.lineTo(n+i,a+r),t.lineTo(o+i,a+r),t.lineTo(-.5*n-_n*s+i,_n*n+-.5*s+r),t.lineTo(-.5*n-_n*a+i,_n*n+-.5*a+r),t.lineTo(-.5*o-_n*a+i,_n*o+-.5*a+r),t.lineTo(-.5*n+_n*s+i,-.5*s-_n*n+r),t.lineTo(-.5*n+_n*a+i,-.5*a-_n*n+r),t.lineTo(-.5*o+_n*a+i,-.5*a-_n*o+r),t.closePath(),!1}let _o=new class t extends yU{constructor(){super(...arguments),this.type="wye",this.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z"}draw(t,e,i,r){return _a(t,e/2,i,r)}drawOffset(t,e,i,r,n){return _a(t,e/2+n,i,r)}},_l=new class t extends yU{constructor(){super(...arguments),this.type="triangleLeft",this.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z"}draw(t,e,i,r){var n,s,a,o;return n=t,s=e/2,a=i,o=r,n.moveTo(-s+a,o),n.lineTo(s+a,s+o),n.lineTo(s+a,o-s),n.closePath(),!0}drawOffset(t,e,i,r,n){var s,a,o,l,h;return s=t,a=e/2,o=i,l=r,h=n,s.moveTo(-a+o-2*h,l),s.lineTo(a+o+h,a+l+2*h),s.lineTo(a+o+h,l-a-2*h),s.closePath(),!0}},_h=new class t extends yU{constructor(){super(...arguments),this.type="triangleRight",this.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z"}draw(t,e,i,r){var n,s,a,o;return n=t,s=e/2,a=i,o=r,n.moveTo(a-s,s+o),n.lineTo(s+a,o),n.lineTo(a-s,o-s),n.closePath(),!0}drawOffset(t,e,i,r,n){var s,a,o,l,h;return s=t,a=e/2,o=i,l=r,h=n,s.moveTo(o-a-h,a+l+2*h),s.lineTo(a+o+2*h,l),s.lineTo(o-a-h,l-a-2*h),s.closePath(),!0}},_u=new class t extends yU{constructor(){super(...arguments),this.type="triangleDown",this.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z"}draw(t,e,i,r){var n,s,a,o;return n=t,s=e/2,a=i,o=r,n.moveTo(a-s,o-s),n.lineTo(a+s,o-s),n.lineTo(a,o+s),n.closePath(),!0}drawOffset(t,e,i,r,n){var s,a,o,l,h;return s=t,a=e/2,o=i,l=r,h=n,s.moveTo(o-a-2*h,l-a-h),s.lineTo(o+a+2*h,l-a-h),s.lineTo(o,l+a+2*h),s.closePath(),!0}},_d=ic(3);function _c(t,e,i,r){let n=e*_d;return t.moveTo(i,r+-n/3*2),t.lineTo(e+i,r+n),t.lineTo(i-e,r+n),t.closePath(),!0}let _p=new class t extends yQ{constructor(){super(...arguments),this.type="thinTriangle",this.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z"}draw(t,e,i,r){return _c(t,e/2/_d,i,r)}drawOffset(t,e,i,r,n){return _c(t,e/2/_d+n,i,r)}};function _g(t,e,i,r){let n=2*e;return t.moveTo(e+i,r-n),t.lineTo(i-e,r),t.lineTo(e+i,n+r),!0}let _f=new class t extends yU{constructor(){super(...arguments),this.type="arrow2Left",this.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5"}draw(t,e,i,r){return _g(t,e/4,i,r)}drawOffset(t,e,i,r,n){return _g(t,e/4+n,i,r)}};function _m(t,e,i,r){let n=2*e;return t.moveTo(i-e,r-n),t.lineTo(i+e,r),t.lineTo(i-e,n+r),!0}let _v=new class t extends yU{constructor(){super(...arguments),this.type="arrow2Right",this.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5"}draw(t,e,i,r){return _m(t,e/4,i,r)}drawOffset(t,e,i,r,n){return _m(t,e/4+n,i,r)}};function _y(t,e,i,r){let n=2*e;return t.moveTo(i-n,r+e),t.lineTo(i,r-e),t.lineTo(i+n,r+e),!0}let __=new class t extends yU{constructor(){super(...arguments),this.type="arrow2Up",this.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25"}draw(t,e,i,r){return _y(t,e/4,i,r)}drawOffset(t,e,i,r,n){return _y(t,e/4+n,i,r)}};function _b(t,e,i,r){let n=2*e;return t.moveTo(i-n,r-e),t.lineTo(i,r+e),t.lineTo(i+n,r-e),!0}let _x=new class t extends yU{constructor(){super(...arguments),this.type="arrow2Down",this.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25"}draw(t,e,i,r){return _b(t,e/4,i,r)}drawOffset(t,e,i,r,n){return _b(t,e/4+n,i,r)}};function _S(t,e,i,r,n){return t.moveTo(i,r-e),t.lineTo(i,r+e),!0}let _k=new class t extends yU{constructor(){super(...arguments),this.type="lineV",this.pathStr="M0,-0.5L0,0.5"}draw(t,e,i,r,n){return _S(t,e/2,i,r,n)}drawOffset(t,e,i,r,n,s){return _S(t,e/2+n,i,r,s)}drawToSvgPath(t,e,i,r){let n=t/2;return`M ${e}, ${i-n} L ${e},${i+n}`}};function _A(t,e,i,r,n){return t.moveTo(i-e,r),t.lineTo(i+e,r),!0}let _w=new class t extends yU{constructor(){super(...arguments),this.type="lineH",this.pathStr="M-0.5,0L0.5,0"}draw(t,e,i,r,n){return _A(t,e/2,i,r,n)}drawOffset(t,e,i,r,n,s){return _A(t,e/2+n,i,r,s)}drawToSvgPath(t,e,i,r){let n=t/2;return`M ${e-n}, ${i} L ${e+n},${i}`}};function _M(t,e,i,r,n){return t.moveTo(i-e,r-e),t.lineTo(i+e,r+e),t.moveTo(i+e,r-e),t.lineTo(i-e,r+e),!0}let _C=new class t extends yU{constructor(){super(...arguments),this.type="close",this.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5"}draw(t,e,i,r,n){return _M(t,e/2,i,r,n)}drawOffset(t,e,i,r,n,s){return _M(t,e/2+n,i,r,s)}drawToSvgPath(t,e,i,r){let n=t/2;return`M ${e-n}, ${i-n} L ${e+n},${i+n} M ${e+n}, ${i-n} L ${e-n},${i+n}`}};function _T(t,e,i,r){return t.rect(i-e[0]/2,r-e[1]/2,e[0],e[1]),!1}function _E(t,e,i,r){let n=e/2;return t.rect(i-e/2,r-n/2,e,n),!1}let _O=new class t extends yU{constructor(){super(...arguments),this.type="rect",this.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z"}draw(t,e,i,r){return ey(e)?_E(t,e,i,r):_T(t,e,i,r)}drawOffset(t,e,i,r,n){return ey(e)?_E(t,e+2*n,i,r):_T(t,[e[0]+2*n,e[1]+2*n],i,r)}},_P={};[yY,yK,yX,yJ,_p,y1,y8,y7,_e,_r,_o,_l,_h,y0,_u,_f,_v,__,_x,_O,_k,_w,_C].forEach(t=>{_P[t.type]=t});let _R={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"},_B=new iI;class _I{constructor(t,e,i=!1){this.pathStr="",this.type=t,eM(e)?this.svgCache=e:this.path=e,this.isSvg=i}drawOffset(t,e,i,r,n,s,a){return this.isSvg?!!this.svgCache&&(this.svgCache.forEach(n=>{t.beginPath(),iV(n.path.commandList,t,i,r,e,e),a&&a(n.path,n.attribute)}),!1):(iV(this.path.commandList,t,i,r,e+n,e+n),!1)}draw(t,e,i,r,n,s){return this.isSvg?!!this.svgCache&&(this.svgCache.forEach(n=>{t.beginPath(),iV(n.path.commandList,t,i,r,e,e),s&&s(n.path,n.attribute)}),!1):(iV(this.path.commandList,t,i,r,e,e),!1)}bounds(t,e){if(this.isSvg){if(!this.svgCache)return;return e.clear(),void this.svgCache.forEach(({path:i})=>{_B.x1=i.bounds.x1*t,_B.y1=i.bounds.y1*t,_B.x2=i.bounds.x2*t,_B.y2=i.bounds.y2*t,e.union(_B)})}this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}class _L{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){"__proto__"===t&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){"__proto__"===t.tagname&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}function _D(t,e,i,r){let n=t.indexOf(e,i);if(-1===n)throw Error(r);return n+e.length-1}function _F(t,e,i,r=">"){let n=function(t,e,i=">"){let r,n="";for(let s=e;s<t.length;s++){let e=t[s];if(r)e===r&&(r="");else if('"'===e||"'"===e)r=e;else if(e===i[0]){if(!i[1]||t[s+1]===i[1])return{data:n,index:s}}else"	"===e&&(e=" ");n+=e}}(t,e+1,r);if(!n)return;let s=n.data,a=n.index,o=s.search(/\s/),l=s,h=!0;-1!==o&&(l=s.substr(0,o).replace(/\s\s*$/,""),s=s.substr(o+1));let u=l;if(i){let t=l.indexOf(":");-1!==t&&(h=(l=l.substr(t+1))!==n.data.substr(t+1))}return{tagName:l,tagExp:s,closeIndex:a,attrExpPresent:h,rawTagName:u}}let _j=RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");class _N{constructor(t){this.currentNode=null,this.options=t,this.tagsNodeStack=[],this.docTypeEntities={}}addChild(t,e,i){let r=e.tagname;"string"==typeof r&&(e.tagname=r),t.addChild(e)}buildAttributesMap(t,e,i){let r={};if(!t)return;let n=function(t,e){let i=[],r=e.exec(t);for(;r;){let n=[];n.startIndex=e.lastIndex-r[0].length;let s=r.length;for(let t=0;t<s;t++)n.push(r[t]);i.push(n),r=e.exec(t)}return i}(t,_j),s=n.length;for(let t=0;t<s;t++){let e=n[t][1],i=n[t][4];e&&(r[e]=void 0===i||(isNaN(i)?i:Number(i)))}return r}parseXml(t){t=t.replace(/\r\n?/g,"\n");let e=new _L("!xml"),i=e,r="",n="";for(let s=0;s<t.length;s++)if("<"===t[s]){if("/"===t[s+1]){let e=_D(t,">",s,"Closing Tag is not closed."),a=n.lastIndexOf(".");n=n.substring(0,a),(i=this.tagsNodeStack.pop())&&i.child&&r&&i.child[i.child.length-1][":@"]&&(i.child[i.child.length-1][":@"].text=r),r="",s=e}else if("?"===t[s+1])s=_F(t,s,!1,"?>").closeIndex+1;else if("!--"===t.substr(s+1,3))s=_D(t,"--\x3e",s+4,"Comment is not closed.");else{let a=_F(t,s,!1),o=a.tagName,l=a.tagExp,h=a.attrExpPresent,u=a.closeIndex;if(o!==e.tagname&&(n+=n?"."+o:o),l.length>0&&l.lastIndexOf("/")===l.length-1){"/"===o[o.length-1]?(o=o.substr(0,o.length-1),n=n.substr(0,n.length-1),l=o):l=l.substr(0,l.length-1);let t=new _L(o);o!==l&&h&&(t[":@"]=this.buildAttributesMap(l,n,o)),this.addChild(i,t,n),n=n.substr(0,n.lastIndexOf("."))}else{let t=new _L(o);this.tagsNodeStack.push(i),o!==l&&h&&(t[":@"]=this.buildAttributesMap(l,n,o)),this.addChild(i,t,n),i=t}r="",s=u}}else r+=t[s];return e.child}}class _z{constructor(t){this.options=Object.assign({},_z.defaultOptions,t)}valid(t){return t.startsWith("<")}parse(t){var e,i;if(!this.valid)return!1;return e=new _N(this.options).parseXml(t),i=this.options,function t(e,i){let r={};for(let n=0;n<e.length;n++){let s=e[n],a=function(t){let e=Object.keys(t);for(let t=0;t<e.length;t++){let i=e[t];if(":@"!==i)return i}}(s),o="";if(o=void 0===i?a:i+"."+a,void 0!==a&&s[a]){let e=t(s[a],o);(function(t){Object.keys(t).length})(e),s[":@"]&&function(t,e,i){if(e){let i=Object.keys(e),r=i.length;for(let n=0;n<r;n++){let r=i[n];t[r]=e[r]}}}(e,s[":@"],o),void 0!==r[a]&&r.hasOwnProperty(a)?(Array.isArray(r[a])||(r[a]=[r[a]]),r[a].push(e)):r[a]=e}}return r}(e)}}_z.defaultOptions={};let _H=new iI,_V=["symbolType","size",...n4];class _W extends se{constructor(t={symbolType:"circle"}){super(t),this.type="symbol",this.numberType=sF}getParsedPath(){return this.shouldUpdateShape()&&(this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{size:t}=this.attribute;return eM(t)?2===t.length&&t.every(this._validNumber):this._validNumber(t)}doUpdateParsedPath(){var t;let e=nf(this).symbol,{symbolType:i=e.symbolType}=this.attribute,r=_P[i];if(r||(r=_W.userSymbolMap[i]))return this._parsedPath=r,r;if(!0===((t=i=_R[i]||i).startsWith("<svg")||t.startsWith("<?xml"))){let{svg:t}=(new _z).parse(i);if(!t)return null;let e=eM(t.path)?t.path:[t.path];_H.clear();let r=[];e.forEach(t=>{let e=(new rg).fromString(t.d),i={};sV.forEach(e=>{t[e]&&(i[sH[e]]=t[e])}),r.push({path:e,attribute:i}),_H.union(e.bounds)});let n=_H.width(),s=1/ih(n,_H.height());return r.forEach(t=>t.path.transform(0,0,s,s)),this._parsedPath=new _I(i,r,!0),_W.userSymbolMap[i]=this._parsedPath,this._parsedPath}let n=(new rg).fromString(i),s=n.bounds.width(),a=1/ih(s,n.bounds.height());return n.transform(0,0,a,a),this._parsedPath=new _I(i,n),_W.userSymbolMap[i]=this._parsedPath,this._parsedPath}doUpdateAABBBounds(t){let e=nf(this).symbol;this._AABBBounds.clear();let i=this.attribute,r=rj.graphicService.updateSymbolAABBBounds(i,nf(this).symbol,this._AABBBounds,t,this),{boundsPadding:n=e.boundsPadding}=i,s=ss(n);return s&&r.expand(s),this.clearUpdateBoundTag(),r}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}getDefaultAttribute(t){return nf(this).symbol[t]}needUpdateTags(t){return super.needUpdateTags(t,_V)}needUpdateTag(t){return super.needUpdateTag(t,_V)}toCustomPath(){let t=this.getParsedPath(),e=this.attribute.size,i=eM(e)?e:[e,e];return t.path?(new rg).fromCustomPath2D(t.path,0,0,i[0],i[1]):(new rg).fromString(t.pathStr,0,0,i[0],i[1])}clone(){return new _W(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return _W.NOWORK_ANIMATE_ATTR}}function _G(t){return new _W(t)}_W.userSymbolMap={},_W.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},st);let _U=new class t{constructor(){this.time=lP.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,a,o,l,h,u,d){let c=t.getParsedPath();if(!c)return;let{outerBorder:p,innerBorder:g}=t.attribute,f=p&&!1!==p.visible,m=g&&!1!==g.visible;if(!f&&!m)return;let{size:v=l.size,opacity:y=l.opacity,x:_=l.x,y:b=l.y,scaleX:x=l.scaleX,scaleY:S=l.scaleY}=t.attribute,k=!(!p||!p.stroke),A=!(!g||!g.stroke);if(f){let{distance:n=l.outerBorder.distance}=p,s=od(e,n,e.dpr);if(e.beginPath(),!1===c.drawOffset(e,v,i,r,s)&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),d)d(e,p,l.outerBorder);else if(k){let n=l.outerBorder.opacity;l.outerBorder.opacity=y,e.setStrokeStyle(t,p,(_-i)/x,(b-r)/S,l.outerBorder),l.outerBorder.opacity=n,e.stroke()}}if(m){let{distance:n=l.innerBorder.distance}=g,s=od(e,n,e.dpr);if(e.beginPath(),!1===c.drawOffset(e,v,i,r,-s)&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),d)d(e,g,l.innerBorder);else if(A){let n=l.innerBorder.opacity;l.innerBorder.opacity=y,e.setStrokeStyle(t,g,(_-i)/x,(b-r)/S,l.innerBorder),l.innerBorder.opacity=n,e.stroke()}}}};var _$=function(t,e){return function(i,r){e(i,r,t)}};let _Y=class extends oQ{constructor(t){super(),this.symbolRenderContribitions=t,this.numberType=sF,this.builtinContributions=[_U,oY,o6],this.init(t)}drawShape(t,e,i,r,n,s,a,o){var l;let h=nf(t,null==s?void 0:s.theme).symbol,{size:u=h.size,x:d=h.x,y:c=h.y,scaleX:p=h.scaleX,scaleY:g=h.scaleY}=t.attribute,f=this.valid(t,h,a,o);if(!f)return;let{fVisible:m,sVisible:v,doFill:y,doStroke:_}=f,b=t.getParsedPath();if(!b)return;let{keepDirIn3d:x=h.keepDirIn3d}=t.attribute,S=null!==(l=this.z)&&void 0!==l?l:0;if(e.beginPath(),x&&e.camera&&e.project){let n=e.project(i,r,S),s=e.camera;e.camera=null,!1===b.draw(e,eM(u)?[u[0]*p,u[1]*g]:u*p,n.x,n.y,void 0,(n,s)=>{var l,u,f;if(t._parsedPath.svgCache){let e=Object.assign({},s);e.fill=null!==(l=s.fill)&&void 0!==l?l:t.attribute.fill,e.opacity=null!==(u=s.fill)&&void 0!==u?u:t.attribute.opacity,e.fillOpacity=t.attribute.fillOpacity,e.stroke=null!==(f=s.stroke)&&void 0!==f?f:t.attribute.stroke,s=e}s.fill&&(a?a(e,t.attribute,h):(e.setCommonStyle(t,s,d-i,c-r,h),e.fill())),s.stroke&&(o?o(e,t.attribute,h):(e.setStrokeStyle(t,s,(d-i)/p,(c-r)/g,h),e.stroke()))})&&e.closePath(),e.camera=s}else!1===b.draw(e,u,i,r,S,(n,s)=>{var l,u,f;if(t._parsedPath.svgCache){let e=Object.assign({},s);e.fill=null!==(l=s.fill)&&void 0!==l?l:t.attribute.fill,e.opacity=null!==(u=s.opacity)&&void 0!==u?u:t.attribute.opacity,e.fillOpacity=t.attribute.fillOpacity,e.stroke=null!==(f=s.stroke)&&void 0!==f?f:t.attribute.stroke,s=e}s.fill&&(a?a(e,t.attribute,h):(e.setCommonStyle(t,s,d-i,c-r,h),e.fill())),s.stroke&&(o?o(e,t.attribute,h):(e.setStrokeStyle(t,s,(d-i)/p,(c-r)/g,h),e.stroke()))})&&e.closePath();e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),this.beforeRenderStep(t,e,i,r,y,_,m,v,h,n,a,o),y&&!b.isSvg&&(a?a(e,t.attribute,h):m&&(e.setCommonStyle(t,t.attribute,d-i,c-r,h),e.fill())),_&&!b.isSvg&&(o?o(e,t.attribute,h):v&&(e.setStrokeStyle(t,t.attribute,(d-i)/p,(c-r)/g,h),e.stroke())),this.afterRenderStep(t,e,i,r,y,_,m,v,h,n,a,o)}draw(t,e,i,r){let n=nf(t,null==r?void 0:r.theme).symbol;this._draw(t,n,!1,i,r)}};_Y=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),_$(0,e0(e2)),_$(0,e1(oV)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],_Y);let _K=!1,_Z=new eW(t=>{_K||(_K=!0,t(_Y).toSelf().inSingletonScope(),t(ai).to(_Y).inSingletonScope(),t(s4).toService(ai),t(oV).toService(oK),e5(t,oV))}),_X=class extends yF{constructor(t){super(),this.canvasRenderer=t,this.type="symbol",this.numberType=sF}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=t.getParsedPath();if(!r.camera){if(!t.AABBBounds.containsPoint(e))return!1;if(n.isSvg||"imprecise"===t.attribute.pickMode)return!0}r.highPerformanceSave();let s=nf(t).symbol,{x:a,y:o,z:l,lastModelMatrix:h}=this.transform(t,s,r),u=e;if(r.camera){u=e.clone();let i=t.parent.globalTransMatrix;u.x=i.a*e.x+i.c*e.y+i.e,u.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=l;let d=!1;return this.canvasRenderer.drawShape(t,r,a,o,{},null,(t,e,i)=>!!d||(d=t.isPointInPath(u.x,u.y)),(t,e,i)=>{if(d)return!0;let n=e.lineWidth||i.lineWidth,s=e.pickStrokeBuffer||i.pickStrokeBuffer;return r.lineWidth=od(r,n+s,r.dpr),d=t.isPointInStroke(u.x,u.y)}),this.canvasRenderer.z=0,r.modelMatrix!==h&&av.free(r.modelMatrix),r.modelMatrix=h,r.highPerformanceRestore(),d}};_X=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(M=0,C=e0(ai),function(t,e){C(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],_X);let _q=!1,_J=new eW((t,e,i,r)=>{_q||(_q=!0,t(yE).to(_X).inSingletonScope(),t(yD).toService(yE))}),_Q=class{constructor(t){this.canvasRenderer=t,this.type="symbol",this.numberType=sF}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).symbol,{x:s=n.x,y:a=n.y}=t.attribute;if(r.highPerformanceSave(),t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let o=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,i,r)=>!!o||(o=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(o)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=s+a,o=t.isPointInStroke(e.x,e.y)}),r.highPerformanceRestore(),o}};_Q=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(T=0,E=e0(ai),function(t,e){E(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],_Q);let _0=!1,_1=new eW((t,e,i,r)=>{_0||(_0=!0,t(ym).to(_Q).inSingletonScope(),t(yl).toService(ym))});function _2(){_2.__loaded||(_2.__loaded=!0,aj.RegisterGraphicCreator("symbol",_G),r4.load(_Z),r4.load(yo?_J:_1))}_2.__loaded=!1;let _3=["width","x1","y1","height","cornerRadius",...n4];class _5 extends se{constructor(t){super(t),this.type="rect",this.numberType=sI}isValid(){return super.isValid()&&this._isValid()}_isValid(){return!0}doUpdateAABBBounds(){let t=nf(this).rect;this._AABBBounds.clear();let e=this.attribute,i=rj.graphicService.updateRectAABBBounds(e,nf(this).rect,this._AABBBounds,this),{boundsPadding:r=t.boundsPadding}=e,n=ss(r);return n&&i.expand(n),this.clearUpdateBoundTag(),i}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}getDefaultAttribute(t){return nf(this).rect[t]}needUpdateTags(t){return super.needUpdateTags(t,_3)}needUpdateTag(t){return super.needUpdateTag(t,_3)}toCustomPath(){let{x:t,y:e,width:i,height:r}=vv(this.attribute),n=new rg;return n.moveTo(t,e),n.rect(t,e,i,r),n}clone(){return new _5(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return _5.NOWORK_ANIMATE_ATTR}}function _4(t){return new _5(t)}_5.NOWORK_ANIMATE_ATTR=st;var _8=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a};class _6{constructor(){this.time=lP.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,a,o,l,h,u,d){let{outerBorder:c,innerBorder:p}=t.attribute,g=c&&!1!==c.visible,f=p&&!1!==p.visible;if(!g&&!f)return;let{cornerRadius:m=l.cornerRadius,opacity:v=l.opacity,x:y=l.x,y:_=l.y,scaleX:b=l.scaleX,scaleY:x=l.scaleY,x1:S,y1:k}=t.attribute,{width:A,height:w}=t.attribute;A=(null!=A?A:S-i)||0,w=(null!=w?w:k-r)||0;let M=!(!c||!c.stroke),C=!(!p||!p.stroke);if(g){let{distance:n=l.outerBorder.distance}=c,s=od(e,n,e.dpr),a=i-s,o=r-s,h=2*s;if(0===m||eM(m)&&m.every(t=>0===t)?(e.beginPath(),e.rect(a,o,A+h,w+h)):(e.beginPath(),oA(e,a,o,A+h,w+h,m)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),d)d(e,c,l.outerBorder);else if(M){let n=l.outerBorder.opacity;l.outerBorder.opacity=v,e.setStrokeStyle(t,c,(y-i)/b,(_-r)/x,l.outerBorder),l.outerBorder.opacity=n,e.stroke()}}if(f){let{distance:n=l.innerBorder.distance}=p,s=od(e,n,e.dpr),a=i+s,o=r+s,h=2*s;if(0===m||eM(m)&&m.every(t=>0===t)?(e.beginPath(),e.rect(a,o,A-h,w-h)):(e.beginPath(),oA(e,a,o,A-h,w-h,m)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),d)d(e,p,l.innerBorder);else if(C){let n=l.innerBorder.opacity;l.innerBorder.opacity=v,e.setStrokeStyle(t,p,(y-i)/b,(_-r)/x,l.innerBorder),l.innerBorder.opacity=n,e.stroke()}}}}let _9=class{constructor(){this.time=lP.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,a,o,l,h,u,d,c){let{stroke:p=l.stroke}=t.attribute;Array.isArray(p)&&p.some(t=>!1===t)&&(c.doStroke=!1)}};_9=_8([eX()],_9);let _7=class{constructor(){this.time=lP.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,a,o,l,h,u,d){let{x1:c,y1:p,x:g=l.x,y:f=l.y,stroke:m=l.stroke}=t.attribute,{width:v,height:y}=t.attribute;if(v=(null!=v?v:c-g)||0,y=(null!=y?y:p-f)||0,Array.isArray(m)&&m.some(t=>!1===t)){if(e.setStrokeStyle(t,t.attribute,i,r,l),e.beginPath(),e.moveTo(i,r),m[0]?e.lineTo(i+v,r):e.moveTo(i+v,r),m[1]?e.lineTo(i+v,r+y):e.moveTo(i+v,r+y),m[2]?e.lineTo(i,r+y):e.moveTo(i,r+y),m[3]){let t=m[0]?r-e.lineWidth/2:r;e.lineTo(i,t)}else e.moveTo(i,r);e.stroke()}}};_7=_8([eX()],_7);let bt=new _6;var be=function(t,e){return function(i,r){e(i,r,t)}};let bi=class extends oQ{constructor(t){super(),this.rectRenderContribitions=t,this.type="rect",this.numberType=sI,this.builtinContributions=[bt,oY,o6],this.init(t)}drawShape(t,e,i,r,n,s,a,o){var l,h,u;let d=null!==(l=this.tempTheme)&&void 0!==l?l:nf(t,null==s?void 0:s.theme).rect,{fill:c=d.fill,background:p,stroke:g=d.stroke,cornerRadius:f=d.cornerRadius,opacity:m=d.opacity,fillOpacity:v=d.fillOpacity,lineWidth:y=d.lineWidth,strokeOpacity:_=d.strokeOpacity,visible:b=d.visible,x1:x,y1:S,x:k=d.x,y:A=d.y}=t.attribute,{width:w,height:M}=t.attribute;w=(null!=w?w:x-k)||0;let C=oT(m,v,w,M=(null!=M?M:S-A)||0,c),T=oO(m,_,w,M),E=(h=c,u=p,!(!h&&!u)),O=oM(g,y);if(!t.valid||!b||!E&&!O||!(C||T||a||o||p))return;0===f||eM(f)&&f.every(t=>0===t)?(e.beginPath(),e.rect(i,r,w,M)):(e.beginPath(),oA(e,i,r,w,M,f));let P={doFill:E,doStroke:O};e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,r,E,O,C,T,d,n,a,o,P),P.doFill&&(a?a(e,t.attribute,d):C&&(e.setCommonStyle(t,t.attribute,k-i,A-r,d),e.fill())),P.doStroke&&(o?o(e,t.attribute,d):T&&(e.setStrokeStyle(t,t.attribute,k-i,A-r,d),e.stroke())),this.afterRenderStep(t,e,i,r,E,O,C,T,d,n,a,o)}draw(t,e,i,r){let n=nf(t,null==r?void 0:r.theme).rect;this.tempTheme=n,this._draw(t,n,!1,i,r),this.tempTheme=null}};bi=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),be(0,e0(e2)),be(0,e1(oH)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],bi);let br=!1,bn=new eW(t=>{br||(br=!0,t(bi).toSelf().inSingletonScope(),t(at).to(bi).inSingletonScope(),t(s4).toService(at),t(_7).toSelf(),t(_9).toSelf(),t(oH).toService(_7),t(oH).toService(_9),t(oH).toService(oK),e5(t,oH))}),bs=new iI,ba=class{constructor(t){this.canvasRenderer=t,this.type="rect",this.numberType=sI}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).rect,{cornerRadius:s=n.cornerRadius}=t.attribute,{x:a=n.x,y:o=n.y}=t.attribute;r.highPerformanceSave();let l=!0;if(t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);a+=e.x,o+=e.y,r.setTransformForCurrent()}else a=0,o=0,l=!1,r.transformFromMatrix(t.transMatrix,!0);let h=!0;if(!l||t.shadowRoot||ey(s,!0)&&0!==s||eM(s)&&s.some(t=>0!==t))h=!1,this.canvasRenderer.drawShape(t,r,a,o,{},null,(t,i,r)=>!!h||(h=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(h)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=od(r,s+a,r.dpr),h=t.isPointInStroke(e.x,e.y)});else{let{fill:i=n.fill,stroke:r=n.stroke,lineWidth:s=n.lineWidth}=t.attribute;if(i)h=!0;else if(r){let i=t.AABBBounds;bs.setValue(i.x1,i.y1,i.x2,i.y2),bs.expand(-s/2),h=!bs.containsPoint(e)}}return r.highPerformanceRestore(),h}};ba=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(O=0,P=e0(at),function(t,e){P(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],ba);let bo=!1,bl=new eW((t,e,i,r)=>{bo||(bo=!0,t(yC).to(ba).inSingletonScope(),t(yD).toService(yC))}),bh=new iI,bu=class{constructor(t){this.canvasRenderer=t,this.type="rect",this.numberType=sI}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).rect,{cornerRadius:s=n.cornerRadius}=t.attribute,{x:a=n.x,y:o=n.y}=t.attribute;r.highPerformanceSave();let l=!0;if(t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);a+=e.x,o+=e.y,r.setTransformForCurrent()}else a=0,o=0,l=!1,r.transformFromMatrix(t.transMatrix,!0);let h=!0;if(!l||ey(s,!0)&&0!==s||eM(s)&&s.some(t=>0!==t))h=!1,this.canvasRenderer.drawShape(t,r,a,o,{},null,(t,i,r)=>!!h||(h=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(h)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=s+a,h=t.isPointInStroke(e.x,e.y)});else if(h){let{fill:i=n.fill,stroke:r=n.stroke,lineWidth:s=n.lineWidth}=t.attribute;if(i)h=!0;else if(r){let i=t.AABBBounds;bh.setValue(i.x1,i.y1,i.x2,i.y2),bh.expand(-s/2),h=!bh.containsPoint(e)}}return r.highPerformanceRestore(),h}};bu=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(R=0,B=e0(at),function(t,e){B(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],bu);let bd=!1,bc=new eW((t,e,i,r)=>{bd||(bd=!0,t(yf).to(bu).inSingletonScope(),t(yl).toService(yf))});function bp(){bp.__loaded||(bp.__loaded=!0,aj.RegisterGraphicCreator("rect",_4),r4.load(bn),r4.load(yo?bl:bc))}bp.__loaded=!1;function bg(t){t.crosshair=om(t.crosshair||{}).map(e=>us({["horizontal"===t.direction?"yField":"xField"]:{visible:!0,line:{visible:!0,type:"rect"}}},e))}function bf(t,e,i){var r;let{width:n,height:s}=t;if(eO(n)&&eO(s))return{width:n,height:s};let a=i.width,o=i.height,l=e.container,h=e.canvas;if(l){let{width:t,height:e}=aA(l,i.width,i.height);a=t,o=e}else if(h&&hl(e.mode)){let{width:t,height:e}=aA(eE(h)?lX.getElementById(h):h,i.width,i.height);a=t,o=e}else if(hu(e.mode)&&(null===(r=e.modeParams)||void 0===r?void 0:r.domref)){let t=e.modeParams.domref;a=t.width,o=t.height}return{width:a=null!=n?n:a,height:o=null!=s?s:o}}function bm(t,...e){let i=i=>e.reduce((t,e)=>t||(null==e?void 0:e[i]),t[i]);return Object.assign(t,{change:i("change"),reCompile:i("reCompile"),reMake:i("reMake"),reRender:i("reRender"),reSize:i("reSize"),reTransformSpec:i("reTransformSpec"),changeTheme:i("changeTheme")}),t}function bv(t,e){return"line"===t||"area"===t||"common"===t&&e.series.every(t=>"area"===t.type||"line"===t.type)?{paddingInner:1,paddingOuter:0}:{paddingOuter:0}}(I=tk||(tk={})).STATE_NORMAL="normal",I.STATE_HOVER="hover",I.STATE_HOVER_REVERSE="hover_reverse",I.STATE_DIMENSION_HOVER="dimension_hover",I.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",I.STATE_SELECTED="selected",I.STATE_SELECTED_REVERSE="selected_reverse",I.STATE_SANKEY_EMPHASIS="selected",I.STATE_SANKEY_EMPHASIS_REVERSE="blur",(L=tA||(tA={})).STATE_HOVER_REVERSE="hover_reverse",L.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",L.STATE_SELECTED_REVERSE="selected_reverse";class by{constructor(){this._children=[],this._markNameMap={},this._infoMap=new Map}getMarkNameMap(){return this._markNameMap}addMark(t,e){ej(t)||(this._children.push(t),this._markNameMap[t.name]=t,this._infoMap.set(t,eF({},by.defaultMarkInfo,e)))}removeMark(t){let e=this._children.findIndex(e=>e.name===t);e>=0&&(this._infoMap.delete(this._children[e]),delete this._markNameMap[t],this._children.splice(e,1))}clear(){this._children=[],this._markNameMap={},this._infoMap.clear()}forEach(t){this._children.forEach(t)}includes(t,e){return this._children.includes(t,e)}get(t){return isNaN(Number(t))?this._markNameMap[t]:this._children[t]}getMarks(){return this._children.slice()}getMarksInType(t){let e=om(t);return this._children.filter(t=>e.includes(t.type))}getMarkInId(t){return this._children.find(e=>e.id===t)}getMarkWithInfo(t){return this._children.find(e=>Object.keys(t).every(i=>t[i]===this._infoMap.get(e)[i]))}}by.defaultMarkInfo={};class b_{get hover(){return this._hover}get select(){return this._select}constructor(t){this._marks=new by,this._markReverse=new by,this.onHover=t=>{switch(t.action){case"enter":this.interaction.getEventElement(tk.STATE_DIMENSION_HOVER).forEach(t=>this.interaction.addEventElement(tk.STATE_DIMENSION_HOVER_REVERSE,t)),this.interaction.clearEventElement(tk.STATE_DIMENSION_HOVER,!1),this.getEventElement(t).forEach(t=>this.interaction.addEventElement(tk.STATE_DIMENSION_HOVER,t)),this.interaction.reverseEventElement(tk.STATE_DIMENSION_HOVER);break;case"leave":this.interaction.clearEventElement(tk.STATE_DIMENSION_HOVER,!0),t=null}},this._option=t,this.event=this._option.model.getOption().getChart().getEvent(),this.interaction=t.interaction,this.initConfig(t.mode)}setStateKeys(t){}registerMark(t){mk(t.stateStyle[tk.STATE_DIMENSION_HOVER])||this._marks.addMark(t),mk(t.stateStyle[tk.STATE_DIMENSION_HOVER_REVERSE])||this._markReverse.addMark(t)}init(){this.initEvent()}release(){this.releaseEvent()}initEvent(){this.event.on(cQ.dimensionHover,this.onHover)}releaseEvent(){this.event.release()}initConfig(t){}getEventElement(t,e=!1){let i=[];return t.dimensionInfo.forEach(t=>{t.data.forEach(t=>{(e?this._markReverse:this._marks).getMarks().filter(e=>e.model===t.series&&e.getVisible()).forEach(r=>{let n=r.getProduct();if(!n||!n.elements)return;let s=n.elements.filter(i=>{let r;let n=i.getDatum();return r=eM(n)?n.every((e,i)=>e===t.datum[i]):t.datum.some(t=>t===n),e?!r:r});i.push(...s)})})}),i}}let bb={};Object.values(tk).forEach(t=>{bb[t]=!0});let bx={[tk.STATE_HOVER]:tk.STATE_HOVER_REVERSE,[tk.STATE_SELECTED]:tk.STATE_SELECTED_REVERSE,[tk.STATE_DIMENSION_HOVER]:tk.STATE_DIMENSION_HOVER_REVERSE};function bS(t){return bx[t]}class bk{constructor(){this._stateMarks=new Map,this._stateElements=new Map,this._vgrammarInteractions=new Map,this._disableTriggerEvent=!1}addVgrammarInteraction(t,e){t&&(this._vgrammarInteractions.get(t)?this._vgrammarInteractions.get(t).push(e):this._vgrammarInteractions.set(t,[e]))}static markStateEnable(t,e){return!mk(t.stateStyle[e])}setDisableActiveEffect(t){this._disableTriggerEvent=t}registerMark(t,e){var i;this._stateMarks.has(t)||this._stateMarks.set(t,[]),null===(i=this._stateMarks.get(t))||void 0===i||i.push(e)}getStateMark(t){return this._stateMarks.get(t)}filterEventMark(t,e){var i;return!(!t.mark||!(null===(i=this._stateMarks.get(e))||void 0===i?void 0:i.includes(t.mark)))}getEventElement(t){var e;return null!==(e=this._stateElements.get(t))&&void 0!==e?e:[]}getEventElementData(t){return this.getEventElement(t).map(t=>t.getDatum())}exchangeEventElement(t,e){var i;if(this._disableTriggerEvent)return;let r=bx[t];null===(i=this._stateElements.get(t))||void 0===i||i.forEach(e=>{e.removeState(t),r&&this.addEventElement(r,e)}),e.getStates().includes(t)||(e.addState(t),r&&e.removeState(r)),this._stateElements.set(t,[e])}removeEventElement(t,e){var i,r;if(this._disableTriggerEvent)return;e.removeState(t);let n=null!==(r=null===(i=this._stateElements.get(t))||void 0===i?void 0:i.filter(t=>t!==e))&&void 0!==r?r:[];this._stateElements.set(t,n);let s=bx[t];s&&(0===n.length?this.clearEventElement(s,!1):this.addEventElement(s,e))}addEventElement(t,e){var i;if(this._disableTriggerEvent)return;e.getStates().includes(t)||e.addState(t);let r=null!==(i=this._stateElements.get(t))&&void 0!==i?i:[];r.push(e),this._stateElements.set(t,r)}clearEventElement(t,e){var i;if(!this._disableTriggerEvent&&(null===(i=this._stateElements.get(t))||void 0===i||i.forEach(e=>{e.removeState(t)}),this._stateElements.set(t,[]),e)){let e=bx[t];e&&this.clearEventElement(e,!1)}}reverseEventElement(t){if(this._disableTriggerEvent)return;let e=bx[t];if(!e)return;let i=this.getStateMark(e);if(!i)return;let r=this.getEventElement(t);r.length&&(this.getEventElement(e).length||(1===r.length?i.forEach(t=>{t.getProduct().elements.filter(t=>t!==r[0]).forEach(t=>{this.addEventElement(e,t)})}):i.forEach(t=>{t.getProduct().elements.filter(t=>!r.includes(t)).forEach(t=>{this.addEventElement(e,t)})})))}startInteraction(t,e){let i=this._vgrammarInteractions.get(t);i&&i.forEach(t=>{t.start(e)})}resetInteraction(t,e){let i=this._vgrammarInteractions.get(t);i&&i.forEach(t=>{t.reset(e)})}}let bA=`${hA}_DEFAULT_DATA_INDEX`,bw=`${hA}_DEFAULT_DATA_KEY`,bM=`${hA}_DEFAULT_DATA_SERIES_FIELD`,bC=`${hA}_DEFAULT_SERIES_STYLE_NAME`;(D=tw||(tw={}))[D.Default=0]="Default",D[D.Theme=1]="Theme",D[D.Chart=2]="Chart",D[D.Base_Series=3]="Base_Series",D[D.Series=4]="Series",D[D.Mark=5]="Mark",D[D.User_Chart=6]="User_Chart",D[D.User_Series=7]="User_Series",D[D.User_Mark=8]="User_Mark",D[D.User_SeriesStyle=9]="User_SeriesStyle",D[D.Built_In=99]="Built_In";let bT=`${hA}_STACK_KEY`,bE=`${hA}_STACK_START`,bO=`${hA}_STACK_END`,bP=`${hA}_STACK_START_PERCENT`,bR=`${hA}_STACK_END_PERCENT`,bB=`${hA}_STACK_START_OffsetSilhouette`,bI=`${hA}_STACK_END_OffsetSilhouette`,bL=`${hA}_STACK_TOTAL`,bD=`${hA}_STACK_TOTAL_PERCENT`,bF=`${hA}_STACK_TOTAL_TOP`,bj=`${hA}_SEGMENT_START`,bN=`${hA}_SEGMENT_END`;(F=tM||(tM={}))[F.Axis_Grid=50]="Axis_Grid",F[F.CrossHair_Grid=100]="CrossHair_Grid",F[F.Region=450]="Region",F[F.Mark=300]="Mark",F[F.Node=400]="Node",F[F.Axis=100]="Axis",F[F.MarkLine=500]="MarkLine",F[F.MarkArea=100]="MarkArea",F[F.MarkPoint=500]="MarkPoint",F[F.DataZoom=500]="DataZoom",F[F.ScrollBar=500]="ScrollBar",F[F.Player=500]="Player",F[F.Legend=500]="Legend",F[F.CrossHair=500]="CrossHair",F[F.Indicator=500]="Indicator",F[F.Title=500]="Title",F[F.Label=500]="Label",F[F.Brush=500]="Brush",F[F.CustomMark=500]="CustomMark",F[F.Interaction=700]="Interaction",(j=tC||(tC={}))[j.Indicator=10]="Indicator",j[j.Region=20]="Region",j[j.Axis=30]="Axis",j[j.DataZoom=40]="DataZoom",j[j.Player=40]="Player",j[j.ScrollBar=40]="ScrollBar",j[j.Legend=50]="Legend",j[j.Title=70]="Title",j[j.CustomMark=70]="CustomMark";let bz=["linear","radial","conical"],bH={linear:{x0:0,y0:0,x1:1,y1:1},radial:{x0:0,y0:0,x1:1,y1:1,r0:0,r1:1},conical:{x:.5,y:.5,startAngle:0,endAngle:2*Math.PI}};class bV{getOption(){return this._option}constructor(t){this._option=t,this.getCompiler=this._option.getCompiler}getVGrammarView(){var t;return null===(t=this.getCompiler())||void 0===t?void 0:t.getVGrammarView()}release(){this._option=null,this.getCompiler=null}}class bW extends bV{constructor(){super(...arguments),this.id=l4(),this._compiledProductId=null,this._depend=[]}getProduct(){if(eO(this._product))return this._product;let t=this.getVGrammarView(),e=this.getProductId();return eO(e)&&eO(t)&&(this._product=this._lookupGrammar(e)),this._product}getProductId(){var t;return null!==(t=this._compiledProductId)&&void 0!==t?t:this.generateProductId()}getDepend(){return this._depend}setDepend(...t){this._depend=t}compile(t){this._compileProduct(t),this._afterCompile(t)}_afterCompile(t){var e;eO(this._product)&&(null===(e=this.getCompiler())||void 0===e||e.addGrammarItem(this))}updateDepend(){if(eO(this._product)){let t=this.getDepend().map(t=>t.getProduct()).filter(eO);return this._product.depend(t),t.length===this.getDepend().length}return!1}release(){this.removeProduct(),super.release(),this._depend=[]}removeProduct(t){this.getCompiler().removeGrammarItem(this,t),this._product=null,this._compiledProductId=null}}class bG extends bW{getValue(){return this._value}getUpdateFunc(){return this._updateFunc}constructor(t,e,i,r){super(t),this.grammarType=tS.signal,this.name=e,this._value=i,this._updateFunc=r}updateSignal(t,e){this._value=t,this._updateFunc=e,this.compile()}_compileProduct(){let t=this.getVGrammarView();if(t){if(!this.getProduct()){let e=this.getProductId();this._product=t.signal().id(e),this._compiledProductId=e}eO(this._value)&&this._product.value(this._value),eO(this._updateFunc)&&this._product.update(this._updateFunc)}}generateProductId(){return this.name}_lookupGrammar(t){var e;return null===(e=this.getCompiler().getVGrammarView())||void 0===e?void 0:e.getSignalById(t)}}class bU extends bV{constructor(){super(...arguments),this._signalMap={}}getSignalMap(){return this._signalMap}getSignal(t){return this._signalMap[t]}updateSignal(t,e,i){this._signalMap[t]?this._signalMap[t].updateSignal(e,i):(this._signalMap[t]=new bG(this._option,t,e,i),this._signalMap[t].compile())}compile(){Object.values(this._signalMap).forEach(t=>{t.compile()})}release(){super.release(),Object.values(this._signalMap).forEach(t=>{t.release()}),this._signalMap={}}}class b$ extends bU{getStateMap(){return this._stateMap}_getDefaultStateMap(){return{}}constructor(t){super(t),t.stateKeyToSignalName?this.stateKeyToSignalName=t.stateKeyToSignalName:this.stateKeyToSignalName=()=>"state_signal",this.initStateMap()}initStateMap(t){this._stateMap=null!=t?t:this._getDefaultStateMap()}compile(t){let e=null!=t?t:this._stateMap;Object.keys(e).forEach(t=>{let i=this.stateKeyToSignalName(t),r=e[t];this.updateSignal(i,r)})}updateState(t,e){if(t&&(eF(this._stateMap,t),this.compile(t),!e))return this.getCompiler().renderNextTick()}}class bY extends b${constructor(){super(...arguments),this.id=l4(),this.stateKeyToSignalName=t=>`${hA}_animate_${this.id}_${t}`}getAnimationStateSignalName(){return this.stateKeyToSignalName("animationState")}updateAnimateState(t,e){t===t_.update?this.updateState({animationState:{callback:(t,e)=>e.diffState}},e):t===t_.appear?this.updateState({animationState:{callback:(t,e)=>"exit"===e.diffState?t_.none:t_.appear}},e):this.updateState({animationState:{callback:(e,i)=>t}},e)}_getDefaultStateMap(){return{animationState:{callback:(t,e)=>"exit"===e.diffState?t_.exit:"update"===e.diffState?t_.update:t_.appear}}}}class bK{constructor(t){this._option=t,this.type=t.type}_initTheme(t,e){return this._theme=this.getTheme(t,e),this._mergeThemeToSpec(t,e)}getTheme(t,e){}transformSpec(t,e,i){this._transformSpecBeforeMergingTheme(t,e,i);let r=this._initTheme(t,e);return this._transformSpecAfterMergingTheme(r.spec,e,i),r}_transformSpecBeforeMergingTheme(t,e,i){}_transformSpecAfterMergingTheme(t,e,i){}_mergeThemeToSpec(t,e){let i=this._theme;if(this._shouldMergeThemeToSpec()){let r=this._getDefaultSpecFromChart(e),n=t=>us({},i,r,t);return eM(t)?{spec:t.map(t=>n(t)),theme:i}:{spec:n(t),theme:i}}return{spec:t,theme:i}}_shouldMergeThemeToSpec(){return!0}_getDefaultSpecFromChart(t){}}let bZ=(t,e,i)=>{if(ej(e))return t;let r=e[0];return ej(r)?t:1===e.length?(t[r]=i,t):(ej(t[r])&&("number"==typeof e[1]?t[r]=[]:t[r]={}),bZ(t[r],e.slice(1),i))},bX=(t,e,i)=>{if(!ej(e))return dq(t,e,i)};class bq extends bV{getSpec(){return this._spec||{}}getSpecPath(){var t;return null===(t=this._option)||void 0===t?void 0:t.specPath}getSpecInfoPath(){var t,e,i;return null!==(e=null===(t=this._option)||void 0===t?void 0:t.specInfoPath)&&void 0!==e?e:null===(i=this._option)||void 0===i?void 0:i.specPath}getData(){return this._data}get layout(){return this._layout}getOption(){return this._option}getMarks(){var t,e;return null!==(e=null===(t=this._marks)||void 0===t?void 0:t.getMarks())&&void 0!==e?e:[]}getMarkNameMap(){var t;return null===(t=this._marks)||void 0===t?void 0:t.getMarkNameMap()}getMarkSet(){return this._marks}getMarkInfoList(){return this.getMarks().map(t=>({type:t.type,name:t.name}))}getChart(){return this._option.getChart()}get _theme(){var t;return null===(t=this.getSpecInfo())||void 0===t?void 0:t.theme}constructor(t,e){var i;super(e),this.transformerConstructor=bK,this.type="null",this.modelType="null",this.userId=void 0,this._data=null,this._layout=null,this.specKey="",this._marks=new by,this._lastLayoutRect=null,this.id=l4(),this.userId=t.id,this._spec=t,this.effect={},this.event=new dZ(e.eventDispatcher,e.mode),null===(i=e.map)||void 0===i||i.set(this.id,this)}_releaseEvent(){this.event.release()}created(){this.setAttrFromSpec()}init(t){}afterInit(){}getVisible(){var t;return!1!==(null===(t=this._spec)||void 0===t?void 0:t.visible)}onLayoutStart(t,e,i){var r;null===(r=this._layout)||void 0===r||r.onLayoutStart(t,e,i)}onLayoutEnd(t){var e;null===(e=this._layout)||void 0===e||e.onLayoutEnd(t),this.getMarks().forEach(t=>t.updateLayoutState(!0,!0))}onEvaluateEnd(t){}onDataUpdate(){}beforeRelease(){}release(){var t;this._releaseEvent(),this._spec=void 0,this.getMarks().forEach(t=>t.release()),null===(t=this._data)||void 0===t||t.release(),this._data=null,this._marks.clear(),super.release()}updateSpec(t){let e=this._compareSpec(t,this._spec);return this._spec=t,e}_compareSpec(t,e){return{change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1}}reInit(t){t&&(this._spec=t),this.setAttrFromSpec()}updateLayoutAttribute(){}setAttrFromSpec(){var t;null===(t=this._layout)||void 0===t||t.setAttrFromSpec(this._spec,this._option.getChartViewRect())}_convertMarkStyle(t){return Object.assign({},t)}setMarkStyle(t,e,i,r){eO(t)&&eO(e)&&t.setStyle(this._convertMarkStyle(e),i,r)}initMarkStyleWithSpec(t,e,i){if(!eO(t)||!eO(e))return;let{style:r,state:n}=e,s=Object.assign({},e);r&&(s.style=this._convertMarkStyle(r)),n&&(s.state={},Object.keys(n).forEach(t=>{s.state[t]=this._convertMarkStyle(n[t])})),t.initStyleWithSpec(s,i)}stateKeyToSignalName(t,e){let i=`${hA}_${this.modelType}_${this.type}_${this.id}_${t}`;return e&&(i+=`_${e}`),i}compileData(){var t;null===(t=this._data)||void 0===t||t.compile()}compileMarks(t){this.getMarks().forEach(e=>{e.compile({group:t})})}_createMark(t,e={}){let{type:i,name:r}=t,n=de.createMark(i,r,Object.assign({model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._option.globalScale},e));return null==n||n.created(),n}_getDataIdKey(){}getColorScheme(){var t,e;return null===(e=(t=this._option).getTheme)||void 0===e?void 0:e.call(t).colorScheme}getSpecInfo(){var t,e,i;return bX(null!==(i=null===(e=(t=this._option).getSpecInfo)||void 0===e?void 0:e.call(t))&&void 0!==i?i:{},this.getSpecInfoPath())}getSpecIndex(){let t=this.getSpecPath();if(!(null==t?void 0:t.length))return 0;let e=Number(t[t.length-1]);return isNaN(e)?0:e}}class bJ{getSpec(){return this._spec||{}}getLayoutStartPoint(){return this._layoutStartPoint}get layoutRectLevelMap(){return this._layoutRectLevelMap}get minWidth(){return this._minWidth}set minWidth(t){this._minWidth=t}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth=t}get minHeight(){return this._minHeight}set minHeight(t){this._minHeight=t}get maxHeight(){return this._maxHeight}set maxHeight(t){this._maxHeight=t}getLastComputeOutBounds(){return this._lastComputeOutBounds}get layoutOrient(){return this._layoutOrient}set layoutOrient(t){this._layoutOrient=t}get model(){return this._model}get type(){return this._model.type}constructor(t,e){var i;this.layoutClip=!1,this.autoIndent=!1,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:0,height:0},this._layoutRectLevelMap={width:0,height:0},this._minWidth=null,this._maxWidth=null,this._minHeight=null,this._maxHeight=null,this._lastComputeRect=null,this._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0},this.getLayoutRect=()=>this._layoutRect,this.layoutType="normal",this._layoutOrient="left",this.layoutPaddingLeft=0,this.layoutPaddingTop=0,this.layoutPaddingRight=0,this.layoutPaddingBottom=0,this.layoutOffsetX=0,this.layoutOffsetY=0,this.layoutLevel=tC.Region,this._model=t,this._option=e,this.layoutLevel=e.layoutLevel,this.layoutType=e.layoutType,e.layoutOrient&&(this.layoutOrient=e.layoutOrient),this._spec=null===(i=null==t?void 0:t.getSpec)||void 0===i?void 0:i.call(t)}_setLayoutAttributeFromSpec(t,e){var i,r,n,s;if(this._spec&&!1!==this._spec.visible){let a=he(hi(t.padding),e,e);this.layoutPaddingLeft=a.left,this.layoutPaddingRight=a.right,this.layoutPaddingTop=a.top,this.layoutPaddingBottom=a.bottom,this._minHeight=ej(t.minHeight)?null!==(i=this._minHeight)&&void 0!==i?i:null:ht(t.minHeight,e.height,e),this._maxHeight=ej(t.maxHeight)?null!==(r=this._maxHeight)&&void 0!==r?r:null:ht(t.maxHeight,e.height,e),this._minWidth=ej(t.minWidth)?null!==(n=this._minWidth)&&void 0!==n?n:null:ht(t.minWidth,e.width,e),this._maxWidth=ej(t.maxWidth)?null!==(s=this._maxWidth)&&void 0!==s?s:null:ht(t.maxWidth,e.width,e),t.width&&this.setLayoutRect({width:ht(t.width,e.width,e)},{width:9}),t.height&&this.setLayoutRect({height:ht(t.height,e.height,e)},{height:9}),ej(t.offsetX)||(this.layoutOffsetX=ht(t.offsetX,e.width,e)),ej(t.offsetY)||(this.layoutOffsetY=ht(t.offsetY,e.height,e)),t.alignSelf&&(this.alignSelf=t.alignSelf)}}setAttrFromSpec(t,e){var i,r,n,s;this._spec=t,this.layoutType=null!==(i=t.layoutType)&&void 0!==i?i:this.layoutType,this.layoutLevel=null!==(r=t.layoutLevel)&&void 0!==r?r:this.layoutLevel,this.layoutOrient=null!==(n=t.orient)&&void 0!==n?n:this.layoutOrient,this._setLayoutAttributeFromSpec(t,e),this.layoutClip=null!==(s=t.clip)&&void 0!==s?s:this.layoutClip}onLayoutStart(t,e,i){this._setLayoutAttributeFromSpec(this._spec,e)}onLayoutEnd(t){}_getAbsoluteSpecValue(t){let e={top:null,bottom:null,left:null,right:null};return["top","bottom","left","right"].forEach(i=>{ej(this._spec[i])||(e[i]=ht(this._spec[i],"top"===i||"bottom"===i?t.height:t.width,t))}),e}absoluteLayoutInRect(t){let{top:e,bottom:i,left:r,right:n}=this._getAbsoluteSpecValue(t),s={width:t.width-this.layoutPaddingLeft-this.layoutPaddingRight,height:t.height-this.layoutPaddingTop-this.layoutPaddingBottom};ej(r)||(s.width-=r),ej(n)||(s.width-=n),ej(e)||(s.height-=e),ej(i)||(s.height-=i),this.setLayoutRect(s);let{width:a,height:o}=this.computeBoundsInRect(this.getLayoutRect());this.setLayoutRect({width:a,height:o});let l={x:t.x,y:t.y};!0===this._spec.center?(l.x=t.x+.5*t.width-.5*a,l.y=t.y+.5*t.height-.5*o):(ej(r)?ej(n)||(l.x=t.x+t.width-this.layoutPaddingRight-n-a):l.x=t.x+r+this.layoutPaddingLeft,ej(e)?ej(i)||(l.y=t.y+t.height-this.layoutPaddingBottom-i-o):l.y=t.y+e+this.layoutPaddingTop),this.setLayoutStartPosition(l)}setLayoutStartPosition(t){var e,i;this._option.transformLayoutPosition&&(t=this._option.transformLayoutPosition(t)),l1(t.x)&&(this._layoutStartPoint.x=t.x),l1(t.y)&&(this._layoutStartPoint.y=t.y),null===(i=(e=this._model).afterSetLayoutStartPoint)||void 0===i||i.call(e,this._layoutStartPoint)}setLayoutRect({width:t,height:e},i){var r,n,s,a;l1(t)&&(null!==(r=null==i?void 0:i.width)&&void 0!==r?r:0)>=this._layoutRectLevelMap.width&&(this._layoutRect.width=t,this._layoutRectLevelMap.width=null!==(n=null==i?void 0:i.width)&&void 0!==n?n:0),l1(e)&&(null!==(s=null==i?void 0:i.height)&&void 0!==s?s:0)>=this._layoutRectLevelMap.height&&(this._layoutRect.height=e,this._layoutRectLevelMap.height=null!==(a=null==i?void 0:i.height)&&void 0!==a?a:0),this.setRectInSpec(this._layoutRect)}getLayout(){return{x:this._layoutStartPoint.x,y:this._layoutStartPoint.y,width:this._layoutRect.width,height:this._layoutRect.height}}mergeLayoutRect({width:t,height:e}){let i={width:t,height:e};return this._layoutRectLevelMap.width>0&&(i.width=this._layoutRect.width),this._layoutRectLevelMap.height>0&&(i.height=this._layoutRect.height),i}getOrientPosAttribute(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"x":"y"}getOrientSizeAttribute(){return"bottom"===this._layoutOrient||"top"===this._layoutOrient?"width":"height"}changeBoundsBySetting(t){return this._layoutRectLevelMap.width>0&&(t.x2=t.x1+this._layoutRect.width),this._layoutRectLevelMap.height>0&&(t.y2=t.y1+this._layoutRect.height),t.x1-=this._layoutStartPoint.x,t.x2-=this._layoutStartPoint.x,t.y1-=this._layoutStartPoint.y,t.y2-=this._layoutStartPoint.y,t}setRectInSpec(t){let e=Object.assign({},t);return this._layoutRectLevelMap.width<9?(ej(this._minWidth)||(e.width=Math.max(e.width,this._minWidth)),ej(this._maxWidth)||(e.width=Math.min(e.width,this._maxWidth))):e.width=this._layoutRect.width,this._layoutRectLevelMap.height<9?(ej(this._minHeight)||(e.height=Math.max(e.height,this._minHeight)),ej(this._maxHeight)||(e.height=Math.min(e.height,this._maxHeight))):e.height=this._layoutRect.height,e}computeBoundsInRect(t){var e,i;if(this._lastComputeRect=t,!("region-relative"!==this.layoutType&&"region-relative-overlap"!==this.layoutType||(9!==this._layoutRectLevelMap.width||"left"!==this.layoutOrient&&"right"!==this.layoutOrient)&&(9!==this._layoutRectLevelMap.height||"bottom"!==this.layoutOrient&&"top"!==this.layoutOrient)))return this._layoutRect;let r=Object.assign({},this._model.getBoundsInRect(this.setRectInSpec(t),t));this.changeBoundsBySetting(r),this.autoIndent&&r.x2-r.x1>0&&r.y2-r.y1>0&&(this._lastComputeOutBounds.x1=Math.ceil(-r.x1),this._lastComputeOutBounds.x2=Math.ceil(r.x2-t.width),this._lastComputeOutBounds.y1=Math.ceil(-r.y1),this._lastComputeOutBounds.y2=Math.ceil(r.y2-t.height));let n=this.setRectInSpec((e=r,i=t,e?{width:Math.ceil(Math.min(e.x2-e.x1,i.width)),height:Math.ceil(Math.min(e.y2-e.y1,i.height))}:{width:0,height:0}));return this._option.transformLayoutRect&&(n=this._option.transformLayoutRect(n)),n}getModelId(){return this._model.id}getModelVisible(){return this._model.getVisible()}}class bQ extends bq{constructor(){super(...arguments),this.layoutType="normal",this.layoutLevel=0,this.layoutZIndex=0,this._forceLayoutTag=!1,this._layout=null,this._orient=null,this._layoutRect={width:0,height:0},this._layoutStartPos={x:0,y:0},this._isLayout=!0,this.getGraphicBounds=()=>this._layout?{x1:this._layout.getLayoutStartPoint().x,y1:this._layout.getLayoutStartPoint().y,x2:this._layout.getLayoutStartPoint().x+this._layout.getLayoutRect().width,y2:this._layout.getLayoutStartPoint().y+this._layout.getLayoutRect().height}:{x1:0,x2:0,y1:0,y2:0},this._transformLayoutRect=null,this._transformLayoutPosition=null}get layoutOrient(){return this._orient}set layoutOrient(t){this._orient=t,this._layout&&(this._layout.layoutOrient=t)}initLayout(){"none"!==this.layoutType&&(this._layout=new bJ(this,{layoutType:this.layoutType,layoutLevel:this.layoutLevel,layoutOrient:this._orient,transformLayoutRect:this._transformLayoutRect,transformLayoutPosition:this._transformLayoutPosition}),this._orient&&"radius"!==this._orient&&"angle"!==this._orient&&this._layout&&(this._layout.layoutOrient=this._orient))}onLayoutStart(t,e,i){this._isLayout=!0,super.onLayoutStart(t,e,i)}onLayoutEnd(t){super.onLayoutEnd(t),this.updateLayoutAttribute();let e=this.getLayoutRect();!this._forceLayoutTag&&my(this._lastLayoutRect,e)||(this._lastLayoutRect=Object.assign({},e)),this._forceLayoutTag=!1,this._isLayout=!1}afterSetLayoutStartPoint(t){}_forceLayout(){var t;this._isLayout||(this._forceLayoutTag=!0,null===(t=this._option.globalInstance.getChart())||void 0===t||t.setLayoutTag(!0))}getLayoutStartPoint(){return this._layout?this._layout.getLayoutStartPoint():this._layoutStartPos}setLayoutStartPosition(t){return this._layout?this._layout.setLayoutStartPosition(t):this._layoutStartPos=eF(this._layoutStartPos,t)}getLayoutRect(){return this._layout?this._layout.getLayoutRect():this._layoutRect}setLayoutRect(t,e){return this._layout?this._layout.setLayoutRect(t):this._lastLayoutRect=eF(this._layoutRect,t)}getLastComputeOutBounds(){var t;return null===(t=this._layout)||void 0===t?void 0:t.getLastComputeOutBounds()}setAttrFromSpec(){var t,e,i,r,n;super.setAttrFromSpec(),this.layoutClip=null!==(t=this._spec.clip)&&void 0!==t?t:this.layoutClip,this.layoutZIndex=null!==(e=this._spec.zIndex)&&void 0!==e?e:this.layoutZIndex,this.layoutType=null!==(i=this._spec.layoutType)&&void 0!==i?i:this.layoutType,this._orient=null!==(r=this._spec.orient)&&void 0!==r?r:this._orient,this.layoutLevel=null!==(n=this._spec.layoutLevel)&&void 0!==n?n:this.layoutLevel}}class b0 extends bK{_initTheme(t,e){return{spec:t,theme:this._theme}}}class b1 extends bQ{getMaxWidth(){return this._layout.maxWidth}setMaxWidth(t){this._layout.maxWidth=t}getMaxHeight(){return this._layout.maxHeight}setMaxHeight(t){this._layout.maxHeight=t}getGroupMark(){return this._groupMark}getInteractionMark(){return this._interactionMark}getStackInverse(){return!0===this._spec.stackInverse}getStackSort(){return!0===this._spec.stackSort}constructor(t,e){var i;super(t,e),this.transformerConstructor=b0,this.modelType="region",this.specKey="region",this.type=b1.type,this._series=[],this.layoutType="region",this.layoutZIndex=tM.Region,this.interaction=new bk,this.seriesDataFilterOver=()=>{this.event.emit(c1.regionSeriesDataFilterOver,{model:this,chart:this.getChart()}),this._series.forEach(t=>{t.getViewDataFilter()&&t.reTransformViewData()})},this.getBoundsInRect=()=>({x1:this._layout.getLayoutStartPoint().x,y1:this._layout.getLayoutStartPoint().y,x2:this._layout.getLayoutStartPoint().x+this._layout.getLayoutRect().width,y2:this._layout.getLayoutStartPoint().y+this._layout.getLayoutRect().height}),this.userId=t.id,this.coordinate=null!==(i=t.coordinate)&&void 0!==i?i:"cartesian",this._option.animation&&(this.animate=new bY({getCompiler:e.getCompiler})),this.interaction.setDisableActiveEffect(this._option.disableTriggerEvent)}_getClipDefaultValue(){var t,e,i,r;let n=this._option.getChart().getSpec(),s=null===(e=null===(t=n.dataZoom)||void 0===t?void 0:t.some)||void 0===e?void 0:e.call(t,t=>{var e;return"axis"===(null!==(e=t.filterMode)&&void 0!==e?e:"filter")}),a=null===(r=null===(i=n.scrollBar)||void 0===i?void 0:i.some)||void 0===r?void 0:r.call(i,t=>{var e;return"axis"===(null!==(e=t.filterMode)&&void 0!==e?e:"axis")});return!(!s&&!a)||this._layout.layoutClip}created(){var t;this.initLayout(),super.created();let e=null!==(t=this._spec.clip)&&void 0!==t?t:this._getClipDefaultValue();this._groupMark=this._createGroupMark("regionGroup",this.userId,this.layoutZIndex),this._interactionMark=this._createGroupMark("regionInteractionGroup",this.userId+"_interaction",tM.Interaction),mk(this._spec.style)||(this._backgroundMark=this._createMark({type:"rect",name:"regionBackground"}),e&&(this._foregroundMark=this._createMark({type:"rect",name:"regionForeground"})),[this._backgroundMark,this._foregroundMark].forEach(t=>{t&&(t.created(),this.setMarkStyle(t,{width:()=>this.getLayoutRect().width,height:()=>this.getLayoutRect().height},"normal",tw.Built_In),this._groupMark.addMark(t))}),this._backgroundMark&&this._backgroundMark.setZIndex(0),this._foregroundMark&&this._foregroundMark.setZIndex(tM.Mark+1)),this.createTrigger()}_createGroupMark(t,e,i){var r,n;let s=this._createMark({type:"group",name:t});s.setUserId(e),s.setZIndex(i);let a=null!==(r=this._spec.clip)&&void 0!==r?r:this._getClipDefaultValue();return this.setMarkStyle(s,{x:()=>this.getLayoutStartPoint().x,y:()=>this.getLayoutStartPoint().y,width:()=>this.getLayoutRect().width,height:()=>this.getLayoutRect().height,clip:a},"normal",tw.Built_In),this.setMarkStyle(s,{cornerRadius:null===(n=this._spec.style)||void 0===n?void 0:n.cornerRadius},"normal",tw.User_Mark),this._marks.addMark(s),s}init(t){super.init(t),this.initMark(),this.initSeriesDataflow(),this.initInteraction(),this.initTrigger()}initMark(){this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()}_initBackgroundMarkStyle(){var t,e;this._backgroundMark&&(this.setMarkStyle(this._backgroundMark,Object.assign({fillOpacity:(null===(t=this._spec.style)||void 0===t?void 0:t.fill)?1:0},this._spec.style),"normal",tw.User_Mark),(null!==(e=this._spec.clip)&&void 0!==e?e:this._getClipDefaultValue())&&this.setMarkStyle(this._backgroundMark,{strokeOpacity:0},"normal",tw.Built_In))}_initForegroundMarkStyle(){this._foregroundMark&&this.setMarkStyle(this._foregroundMark,Object.assign(Object.assign({},this._spec.style),{fillOpacity:0}),"normal",tw.User_Mark)}_compareSpec(t,e){let i=super._compareSpec(t,e);return my(null==e?void 0:e.style,null==t?void 0:t.style)||(i.reMake=!0),i}reInit(t){super.reInit(t),this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()}addSeries(t){t&&(this._series.includes(t)||this._series.push(t))}removeSeries(t){if(!t)return;let e=this._series.findIndex(e=>e===t);e>=0&&this._series.splice(e,1)}getSeries(t={}){return this._series.filter(e=>{var i,r;return(!t.name||(null==e?void 0:e.name)===t.name)&&(!t.userId||om(t.userId).includes(e.userId))&&(!eO(t.specIndex)||om(t.specIndex).includes(e.getSpecIndex()))&&(!t.id||e.id===t.id)&&(!t.type||e.type===t.type)&&(!t.coordinateType||e.coordinate===t.coordinateType)&&(!t.dataName||(null===(r=null===(i=e.getRawData)||void 0===i?void 0:i.call(e))||void 0===r?void 0:r.name)===t.dataName)})}getSeriesInName(t){return this.getSeries({name:t})[0]}getSeriesInUserId(t){return this.getSeries({userId:t})[0]}getSeriesInId(t){return this.getSeries({id:t})[0]}getSeriesInType(t){return this.getSeries({type:t})}getSeriesInCoordinateType(t){return this.getSeries({coordinateType:t})}getSeriesInDataName(t){return this.getSeries({dataName:t})}onRender(t){}initSeriesDataflow(){let t=this._series.map(t=>{var e;return null!==(e=t.getViewDataFilter())&&void 0!==e?e:t.getViewData()}).filter(t=>!!t);this._option.dataSet.multipleDataViewAddListener(t,"change",this.seriesDataFilterOver)}release(){super.release(),this._series=[]}createTrigger(){let t=Object.assign(Object.assign({},this._option),{model:this,interaction:this.interaction});this._trigger=new b_(t)}initTrigger(){this._series.forEach(t=>{t.getMarksWithoutRoot().forEach(t=>{this._trigger.registerMark(t)})}),this._trigger.init()}initInteraction(){this._option.disableTriggerEvent||this._series.forEach(t=>{t.getMarksWithoutRoot().forEach(t=>{for(let e in tA)mk(t.stateStyle[tA[e]])||this.interaction.registerMark(tA[e],t)})})}compileMarks(t){this.getMarks().forEach(e=>{var i;e.compile({group:t}),null===(i=e.getProduct())||void 0===i||i.configure({context:{model:this}}).layout((t,e,i,r)=>{})})}compile(){var t;null===(t=this.animate)||void 0===t||t.compile(),this.compileMarks()}onLayoutEnd(t){this._series.forEach(e=>e.onLayoutEnd(t)),super.onLayoutEnd(t)}}function b2(t){let e=[],i=[],r=[];return t.forEach(t=>{ej(t.getSpec().position)||"start"===t.getSpec().position?e.push(t):"middle"===t.getSpec().position?i.push(t):"end"===t.getSpec().position&&r.push(t)}),{startItems:e,endItems:r,middleItems:i}}function b3(t,e,i){e?t.forEach(t=>{let e=ov(t),r=(i-(e.getLayoutStartPoint().y+e.getLayoutRect().height-t[0].getLayoutStartPoint().y))/2;t.forEach(t=>{t.setLayoutStartPosition({x:t.getLayoutStartPoint().x,y:t.getLayoutStartPoint().y+r})})}):t.forEach(t=>{let e=ov(t),r=(i-(e.getLayoutStartPoint().x+e.getLayoutRect().width-t[0].getLayoutStartPoint().x))/2;t.forEach(t=>{t.setLayoutStartPosition({x:t.getLayoutStartPoint().x+r,y:t.getLayoutStartPoint().y})})})}function b5(t,e,i,r){let n;t.forEach((t,s)=>{t.length>1&&(n=i[s],t.forEach(t=>{if(!t.alignSelf||"start"===t.alignSelf)return;let i=t.getLayoutStartPoint(),s="middle"===t.alignSelf?.5:1,a=e?n-(t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight):n-(t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom);e?t.setLayoutStartPosition({x:i.x+r*a*s,y:i.y}):t.setLayoutStartPosition({x:i.x,y:i.y+r*a*s})}))})}function b4(t,e,i,r,n){if(t.length){let s=0,a="right"===n,o=a?-1:1,l=a?e.rightCurrent:e.leftCurrent,h=e.topCurrent,u=[],d=[],c=[];t.forEach(t=>{let r=e.getItemComputeLayoutRect(t),n=t.computeBoundsInRect(r);t.setLayoutRect(n);let p=n.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=n.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=a?-n.width-t.layoutPaddingRight:t.layoutPaddingLeft;t.setLayoutStartPosition({x:l+t.layoutOffsetX+f,y:h+t.layoutOffsetY+t.layoutPaddingTop}),(h+=p)>i&&d.length?(c.push(s),l+=o*s,s=g,h=e.topCurrent+p,t.setLayoutStartPosition({x:l+t.layoutOffsetX+f,y:e.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),u.push(d),d=[t]):(s=Math.max(s,g),d.push(t))}),c.push(s),u.push(d),b5(u,!0,c,o),r&&b3(u,!0,i),a?e.rightCurrent=l+o*s:e.leftCurrent=l+o*s}}function b8(t,e,i,r){if(t.length){let i=0,n="right"===r,s=n?-1:1,a=n?e.rightCurrent:e.leftCurrent,o=e.bottomCurrent,l=[],h=[],u=[];t.forEach(t=>{let r=e.getItemComputeLayoutRect(t),d=t.computeBoundsInRect(r);t.setLayoutRect(d);let c=d.height+t.layoutPaddingTop+t.layoutPaddingBottom,p=d.width+t.layoutPaddingLeft+t.layoutPaddingRight,g=n?-d.width-t.layoutPaddingRight:t.layoutPaddingLeft;o<c&&h.length?(u.push(i),a+=s*i,i=p,o=e.bottomCurrent,t.setLayoutStartPosition({x:a+t.layoutOffsetX+g,y:o+t.layoutOffsetY-d.height-t.layoutPaddingBottom}),l.push(h),h=[t]):(t.setLayoutStartPosition({x:a+t.layoutOffsetX+g,y:o+t.layoutOffsetY-d.height-t.layoutPaddingBottom}),i=Math.max(i,p),o-=c,h.push(t))}),u.push(i),l.push(h),b5(l,!0,u,s),n?e.rightCurrent=a+s*i:e.leftCurrent=a+s*i}}function b6(t,e,i,r,n){if(t.length){let s="top"===n,a=s?1:-1,o=0,l=e.leftCurrent,h=s?e.topCurrent:e.bottomCurrent,u=[],d=[],c=[];t.forEach(t=>{let r=e.getItemComputeLayoutRect(t),n=t.computeBoundsInRect(r);t.setLayoutRect(n);let p=n.height+t.layoutPaddingTop+t.layoutPaddingBottom,g=n.width+t.layoutPaddingLeft+t.layoutPaddingRight,f=s?t.layoutPaddingTop:-n.height-t.layoutPaddingBottom;t.setLayoutStartPosition({x:l+t.layoutOffsetX+t.layoutPaddingLeft,y:h+t.layoutOffsetY+f}),(l+=g)>i&&d.length?(c.push(o),l=e.leftCurrent+g,h+=a*o,o=p,t.setLayoutStartPosition({x:e.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:h+t.layoutOffsetY+f}),u.push(d),d=[t]):(o=Math.max(o,p),d.push(t))}),c.push(o),u.push(d),b5(u,!1,c,a),r&&b3(u,!1,i),s?e.topCurrent=h+a*o:e.bottomCurrent=h+a*o}}function b9(t,e,i,r){if(t.length){let i="top"===r,n=i?1:-1,s=0,a=e.rightCurrent,o=i?e.topCurrent:e.bottomCurrent,l=[],h=[],u=[];t.forEach(t=>{let r=e.getItemComputeLayoutRect(t),u=t.computeBoundsInRect(r);t.setLayoutRect(u);let d=u.height+t.layoutPaddingTop+t.layoutPaddingBottom,c=u.width+t.layoutPaddingLeft+t.layoutPaddingRight,p=i?t.layoutPaddingTop:-u.height-t.layoutPaddingBottom;a<c&&h.length?(a=e.rightCurrent,o+=n*s,s=d,t.setLayoutStartPosition({x:e.rightCurrent+t.layoutOffsetX-u.width-t.layoutPaddingRight,y:o+t.layoutOffsetY+p}),l.push(h),h=[t]):(h.push(t),t.setLayoutStartPosition({x:a+t.layoutOffsetX-u.width-t.layoutPaddingRight,y:o+t.layoutOffsetY+p}),s=Math.max(s,d),a-=c)}),u.push(s),l.push(h),b5(l,!1,u,n),i?e.topCurrent=o+n*s:e.bottomCurrent=o+n*s}}b1.type="region",b1.transformerConstructor=b0,b1.specKey="region";class b7{constructor(t,e){this.leftCurrent=0,this.topCurrent=0,this.rightCurrent=0,this.bottomCurrent=0,this._onError=null==e?void 0:e.onError}_layoutInit(t,e,i,r){this._chartLayoutRect=i,this._chartViewBox=r,this.leftCurrent=i.x,this.topCurrent=i.y,this.rightCurrent=i.x+i.width,this.bottomCurrent=i.height+i.y,e.sort((t,e)=>e.layoutLevel-t.layoutLevel)}_layoutNormalItems(t){this.layoutNormalInlineItems(t.filter(t=>"normal-inline"===t.layoutType)),this.layoutNormalItems(t.filter(t=>"normal"===t.layoutType))}_groupItems(t){let e=t.filter(t=>"region"===t.layoutType),i=t.filter(t=>"region-relative"===t.layoutType),r=t.filter(t=>"region-relative-overlap"===t.layoutType),n=i.concat(r),s={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}};return r.forEach(t=>{s[t.layoutOrient].items.push(t)}),{regionItems:e,relativeItems:i,relativeOverlapItems:r,allRelatives:n,overlapItems:s}}layoutItems(t,e,i,r){this._layoutInit(t,e,i,r),this._layoutNormalItems(e);let n={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},{regionItems:s,relativeItems:a,relativeOverlapItems:o,allRelatives:l,overlapItems:h}=this._groupItems(e);this.layoutRegionItems(s,a,o,h),this._processAutoIndent(s,a,o,h,l,n),this.layoutAbsoluteItems(e.filter(t=>"absolute"===t.layoutType))}_processAutoIndent(t,e,i,r={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}},n,s){if(n.some(t=>t.autoIndent)){let{top:a,bottom:o,left:l,right:h}=this._checkAutoIndent(n,s);(a||o||l||h)&&(this.topCurrent=s.top+a,this.bottomCurrent=s.bottom-o,this.leftCurrent=s.left+l,this.rightCurrent=s.right-h,this.layoutRegionItems(t,e,i,r))}}layoutNormalItems(t){t.forEach(t=>{let e=this.getItemComputeLayoutRect(t),i=t.computeBoundsInRect(e);t.setLayoutRect(i),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"top"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"right"===t.layoutOrient?(t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX-i.width-t.layoutPaddingRight,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"bottom"===t.layoutOrient&&(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingRight,y:this.bottomCurrent+t.layoutOffsetY-i.height-t.layoutPaddingBottom}),this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom)})}layoutNormalInlineItems(t){let e=t.filter(t=>"left"===t.layoutOrient),i=t.filter(t=>"right"===t.layoutOrient),r=t.filter(t=>"top"===t.layoutOrient),n=t.filter(t=>"bottom"===t.layoutOrient),s=this._chartLayoutRect.width+this._chartLayoutRect.x,a=this._chartLayoutRect.height+this._chartLayoutRect.y;e.length&&function(t,e,i){let{startItems:r,middleItems:n,endItems:s}=b2(t);r.length&&b4(r,e,i,!1,"left"),n.length&&b4(n,e,i,!0,"left"),s.length&&b8(s,e,i,"left")}(e,this,a),r.length&&function(t,e,i){let{startItems:r,middleItems:n,endItems:s}=b2(t);r.length&&b6(r,e,i,!1,"top"),n.length&&b6(n,e,i,!0,"top"),s.length&&b9(s,e,i,"top")}(r,this,s),i.length&&function(t,e,i){let{startItems:r,middleItems:n,endItems:s}=b2(t);r.length&&b4(r,e,i,!1,"right"),n.length&&b4(n,e,i,!0,"right"),s.length&&b8(s,e,i,"right")}(i,this,a),n.length&&function(t,e,i){let{startItems:r,middleItems:n,endItems:s}=b2(t);r.length&&b6(r,e,i,!1,"bottom"),n.length&&b6(n,e,i,!0,"bottom"),s.length&&b9(s,e,i,"bottom")}(n,this,s)}_layoutRelativeOverlap(t,e){e.items.forEach(t=>{let i=this.getItemComputeLayoutRect(t),r=t.computeBoundsInRect(i);e.rect.width=Math.max(r.width+t.layoutPaddingLeft+t.layoutPaddingRight,e.rect.width),e.rect.height=Math.max(r.height+t.layoutPaddingTop+t.layoutPaddingBottom,e.rect.height)}),e.items.forEach(i=>{i.setLayoutRect(e.rect),"left"===t?i.setLayoutStartPosition({x:this.leftCurrent+i.layoutOffsetX}):"right"===t?i.setLayoutStartPosition({x:this.rightCurrent-e.rect.width+i.layoutOffsetX}):"top"===t?i.setLayoutStartPosition({x:this.topCurrent+i.layoutOffsetY}):i.setLayoutStartPosition({x:this.bottomCurrent-e.rect.height+i.layoutOffsetY})}),"left"===t?this.leftCurrent+=e.rect.width:"right"===t?this.rightCurrent-=e.rect.width:"top"===t?this.topCurrent+=e.rect.height:this.bottomCurrent-=e.rect.height}_layoutRelativeItem(t,e){let i=t.computeBoundsInRect(e);"left"===t.layoutOrient||"right"===t.layoutOrient?t.setLayoutRect({width:i.width}):t.setLayoutRect({height:i.height}),"left"===t.layoutOrient?(t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft}),this.leftCurrent+=i.width+t.layoutPaddingLeft+t.layoutPaddingRight):"right"===t.layoutOrient?(this.rightCurrent-=i.width+t.layoutPaddingLeft+t.layoutPaddingRight,t.setLayoutStartPosition({x:this.rightCurrent+t.layoutOffsetX+t.layoutPaddingLeft})):"top"===t.layoutOrient?(t.setLayoutStartPosition({y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop}),this.topCurrent+=i.height+t.layoutPaddingTop+t.layoutPaddingBottom):"bottom"===t.layoutOrient&&(this.bottomCurrent-=i.height+t.layoutPaddingTop+t.layoutPaddingBottom,t.setLayoutStartPosition({y:this.bottomCurrent+t.layoutOffsetY+t.layoutPaddingTop}))}_layoutRegionItem(t,e,i){let r=Math.max(Math.min(e,...t.map(t=>{var e;return null!==(e=t.maxWidth)&&void 0!==e?e:Number.MAX_VALUE})),0),n=Math.max(Math.min(i,...t.map(t=>{var e;return null!==(e=t.maxHeight)&&void 0!==e?e:Number.MAX_VALUE})),0);return t.forEach(t=>{t.setLayoutRect({width:r,height:n}),t.setLayoutStartPosition({x:this.leftCurrent+t.layoutOffsetX+t.layoutPaddingLeft,y:this.topCurrent+t.layoutOffsetY+t.layoutPaddingTop})}),{regionHeight:n,regionWidth:r}}layoutRegionItems(t,e,i,r={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}}){let n=this.rightCurrent-this.leftCurrent,s=this.bottomCurrent-this.topCurrent;e.filter(t=>"left"===t.layoutOrient||"right"===t.layoutOrient).forEach(t=>{this._layoutRelativeItem(t,this.getItemComputeLayoutRect(t))}),this._layoutRelativeOverlap("left",r.left),this._layoutRelativeOverlap("right",r.right),n=this.rightCurrent-this.leftCurrent,e.filter(t=>"top"===t.layoutOrient||"bottom"===t.layoutOrient).forEach(t=>{this._layoutRelativeItem(t,this.getItemComputeLayoutRect(t))}),this._layoutRelativeOverlap("top",r.top),this._layoutRelativeOverlap("bottom",r.bottom),s=this.bottomCurrent-this.topCurrent;let{regionWidth:a,regionHeight:o}=this._layoutRegionItem(t,n,s);e.concat(i).forEach(e=>{if(["left","right"].includes(e.layoutOrient)){let i=this.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({height:i.getLayoutRect().height}),e.setLayoutStartPosition({y:i.getLayoutStartPoint().y+e.layoutOffsetY+e.layoutPaddingTop}),"right"===e.layoutOrient&&e.setLayoutStartPosition({x:e.getLayoutStartPoint().x+a-n})}else if(["top","bottom"].includes(e.layoutOrient)){let i=this.filterRegionsWithID(t,e.layoutBindRegionID[0]);e.setLayoutRect({width:i.getLayoutRect().width}),e.setLayoutStartPosition({x:i.getLayoutStartPoint().x+e.layoutOffsetX+e.layoutPaddingLeft}),"bottom"===e.layoutOrient&&e.setLayoutStartPosition({y:e.getLayoutStartPoint().y+o-s})}})}layoutAbsoluteItems(t){t.forEach(t=>{t.absoluteLayoutInRect(this._chartLayoutRect)})}filterRegionsWithID(t,e){var i;let r=t.find(t=>t.getModelId()===e);return r||(null!==(i=this._onError)&&void 0!==i?i:hc)("can not find target region item, invalid id"),r}getItemComputeLayoutRect(t){return{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight,height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom}}_checkAutoIndent(t,e){let i={top:0,left:0,bottom:0,right:0};return t.forEach(t=>{if(!t.getModelVisible()||!t.autoIndent)return;let r="left"===t.layoutOrient||"right"===t.layoutOrient,n=t.getLastComputeOutBounds(),s=this._getOutInLayout(n,t,e);r?(i.top=Math.max(i.top,s.top),i.bottom=Math.max(i.bottom,s.bottom)):(i.left=Math.max(i.left,s.left),i.right=Math.max(i.right,s.right))}),i}_getOutInLayout(t,e,i){let{x:r,y:n}=e.getLayoutStartPoint(),{width:s,height:a}=e.getLayoutRect();return{left:i.left-(r-t.x1),right:r+s+t.x2-i.right,top:i.top-(n-t.y1),bottom:n+a+t.y2-i.bottom}}}function xt(t,e,i){eO(e)||(e=t,t=0),eO(i)||(i=1);let r=-1,n=0|Math.max(0,Math.ceil((e-t)/i)),s=Array(n);for(;++r<n;)s[r]=t+r*i;return s}b7.type="base";let xe=t=>{let e=null,i=null;return(...r)=>(e&&r.every((t,i)=>t===e[i])||(e=r,i=t(...r)),i)};function xi(t,e,i=0,r){for(ej(r)&&(r=t.length);i<r;){let n=i+r>>>1;dv(t[n],e)>0?r=n:i=n+1}return i}let xr=(t,e)=>xn(0,t.length,i=>e(t[i])),xn=(t,e,i)=>{let r=t,n=e;for(;r<n;){let t=Math.floor((r+n)/2);i(t)>=0?n=t:r=t+1}return r};function xs(t){return t}let xa=t=>t<0?-Math.sqrt(-t):Math.sqrt(t),xo=t=>t<0?-t*t:t*t,xl=t=>-Math.log(-t),xh=t=>-Math.exp(-t),xu=t=>isFinite(t)?Math.pow(10,t):t<0?0:t,xd=t=>10===t?xu:t===Math.E?Math.exp:e=>Math.pow(t,e),xc=t=>t===Math.E?Math.log:10===t?Math.log10:2===t?Math.log2:(t=Math.log(t),e=>Math.log(e)/t),xp=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),xg=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t;function xf(t,e){if(t=Number(t),e=Number(e)-t)return i=>(i-t)/e;let i=Number.isNaN(e)?NaN:.5;return()=>i}function xm(t,e,i){let r,n;let s=t[0],a=t[1],o=e[0],l=e[1];return a<s?(r=xf(a,s),n=i(l,o)):(r=xf(s,a),n=i(o,l)),t=>n(r(t))}function xv(t,e,i){let r;return r=1===t?t+2*i:t-e+2*i,t?r>0?r:1:0}function xy(t,e,i,r){return 1===i&&(i=0),xv(t,i,r)*(e/(1-i))}function x_(t,e){let i=(t[1]-t[0])/(e[1]-e[0]),r=t[0]-i*e[0];return[r,i+r]}function xb(t,e,i){let r=Math.min(t.length,e.length)-1,n=Array(r),s=Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)n[a]=xf(t[a],t[a+1]),s[a]=i(e[a],e[a+1]);return function(e){let i=xi(t,e,1,r)-1;return s[i](n[i](e))}}let xx=(t,e)=>{let i=t.slice(),r=0,n=i.length-1,s=i[r],a=i[n];return a<s&&([r,n]=[n,r],[s,a]=[a,s]),i[r]=e.floor(s),i[n]=e.ceil(a),i},xS=(t,e=!1)=>{let i=Math.floor(Math.log10(t)),r=t/Math.pow(10,i);return(e?r<1.5?1:r<3?2:r<7?5:10:r<=1?1:r<=2?2:r<=5?5:10)*Math.pow(10,i)},xk=(t,e)=>{let i,r;return e[0]<e[1]?(i=e[0],r=e[1]):(i=e[1],r=e[0]),Math.min(Math.max(t,i),r)},xA=Math.sqrt(50),xw=Math.sqrt(10),xM=Math.sqrt(2),xC=[1,2,5,10],xT=(t,e,i)=>{let r=1,n=t,s=Math.floor((e-1)/2),a=Math.abs(t);return t>=0&&t<=Number.MIN_VALUE?n=0:t<0&&t>=-Number.MIN_VALUE?n=-(e-1):!i&&a<1?r=xB(a).step:(i||a>1)&&(n=Math.floor(t)-s*r),r>0?(t>0?n=Math.max(n,0):t<0&&(n=Math.min(n,-(e-1)*r)),xt(0,e).map(t=>n+t*r)):t>0?xO(0,-(e-1)/r,r):xO((e-1)/r,0,r)},xE=xe((t,e,i,r)=>{let n,s,a,o,l=-1;if(i=+i,(t=+t)==(e=+e)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return[t];if((n=e<t)&&(s=t,t=e,e=s),!isFinite(o=xI(t,e,i).step))return[];if(o>0){let i=Math.round(t/o),r=Math.round(e/o);for(i*o<t&&++i,r*o>e&&--r,a=Array(s=r-i+1);++l<s;)a[l]=(i+l)*o}else if(o<0&&(null==r?void 0:r.noDecimals)){o=1;let i=Math.ceil(t),r=Math.floor(e);if(!(i<=r))return[];for(a=Array(s=r-i+1);++l<s;)a[l]=i+l}else{let i=Math.round(t*(o=-o)),r=Math.round(e*o);for(i/o<t&&++i,r/o>e&&--r,a=Array(s=r-i+1);++l<s;)a[l]=(i+l)/o}return n&&a.reverse(),a}),xO=(t,e,i)=>{let r,n,s=-1;if(i>0){let a=Math.floor(t/i),o=Math.ceil(e/i);for((a+1)*i<t&&++a,(o-1)*i>e&&--o,n=Array(r=o-a+1);++s<r;)n[s]=(a+s)*i}else{let a=Math.floor(t*(i=-i)),o=Math.ceil(e*i);for((a+1)/i<t&&++a,(o-1)/i>e&&--o,n=Array(r=o-a+1);++s<r;)n[s]=(a+s)/i}return n},xP=(t,e,i)=>{let r;let n=t[0],s=t[t.length-1],a=e-t.length;if(s<=0){let e=[];for(r=a;r>=1;r--)e.push(n-r*i);return e.concat(t)}if(n>=0){for(r=1;r<=a;r++)t.push(s+r*i);return t}let o=[],l=[];for(r=1;r<=a;r++)r%2==0?o=[n-Math.floor(r/2)*i].concat(o):l.push(s+Math.ceil(r/2)*i);return o.concat(t).concat(l)},xR=xe((t,e,i,r)=>{let n,s,a;if(i=+i,(t=+t)==(e=+e)||Math.abs(t-e)<=Number.MIN_VALUE&&i>0)return xT(t,i,null==r?void 0:r.noDecimals);(n=e<t)&&(a=t,t=e,e=a);let o=xI(t,e,i),l=o.step;if(!isFinite(l))return[];if(l>0){let r=1,{power:n,gap:a}=o,h=10===a?2*10**n:1*10**n;for(;r<=5&&(s=xO(t,e,l)).length>i+1&&i>2;)l+=h,r+=1;i>2&&s.length<i-1&&(s=xP(s,i,l))}else(null==r?void 0:r.noDecimals)&&l<0&&(l=1),s=xO(t,e,l);return n&&s.reverse(),s}),xB=t=>{let e=Math.floor(Math.log(t)/Math.LN10),i=t/10**e,r=1;return i>=xA?r=10:i>=xw?r=5:i>=xM&&(r=2),e>=0?{step:r*10**e,gap:r,power:e}:{step:-(10**-e)/r,gap:r,power:e}};function xI(t,e,i){return xB((e-t)/Math.max(0,i))}function xL(t,e,i){let r;if(i=+i,(t=+t)==(e=+e)&&i>0)return[t];if(i<=0||0===(r=function(t,e,i){return(e-t)/Math.max(1,i-1)}(t,e,i))||!isFinite(r))return[];let n=Array(i);for(let e=0;e<i;e++)n[e]=t+e*r;return n}function xD(t,e,i){let r,n,s=-1;if(i=+i,(n=(e=+e)<(t=+t))&&(r=t,t=e,e=r),!isFinite(i)||e-t<=i)return[t];let a=Math.floor((e-t)/i+1),o=Array(a);for(;++s<a;)o[s]=t+s*i;return n&&o.reverse(),o}function xF(t,e=10){let i,r,n=0,s=t.length-1,a=t[n],o=t[s],l=10;for(o<a&&(r=a,a=o,o=r,r=n,n=s,s=r);l-- >0;){if((r=xI(a,o,e).step)===i)return t[n]=a,t[s]=o,t;if(r>0)a=Math.floor(a/r)*r,o=Math.ceil(o/r)*r;else{if(!(r<0))break;a=Math.ceil(a*r)/r,o=Math.floor(o*r)/r}i=r}}function xj(t,e){let i=ey(e.forceMin),r=ey(e.forceMax),n=null,s=[],a=null,o=i&&r?t=>t>=e.forceMin&&t<=e.forceMax:i?t=>t>=e.forceMin:r?t=>t<=e.forceMax:null;return i?s[0]=e.forceMin:ey(e.min)&&e.min<=Math.min(t[0],t[t.length-1])&&(s[0]=e.min),r?s[1]=e.forceMax:ey(e.max)&&e.max>=Math.max(t[0],t[t.length-1])&&(s[1]=e.max),ey(s[0])&&ey(s[1])?((a=t.slice())[0]=s[0],a[a.length-1]=s[1]):n=ey(s[0])||ey(s[1])?ey(s[0])?"max":"min":"all",{niceType:n,niceDomain:a,niceMinMax:s,domainValidator:o}}let xN=(t,e,i)=>1>Math.abs(e-t)?+i.toFixed(1):Math.round(+i),xz=xe((t,e,i,r,n,s,a)=>{let o=t,l=e,h=l<o;h&&([o,l]=[l,o]);let u,d,c=n(o),p=n(l),g=[];if(!(r%1)&&p-c<i){if(c=Math.floor(c),p=Math.ceil(p),o>0){for(;c<=p;++c)for(u=1;u<r;++u)if(!((d=c<0?u/s(-c):u*s(c))<o)){if(d>l)break;g.push(d)}}else for(;c<=p;++c)for(u=r-1;u>=1;--u)if(!((d=c>0?u/s(-c):u*s(c))<o)){if(d>l)break;g.push(d)}2*g.length<i&&(g=xR(o,l,i))}else g=xR(c,p,Math.min(p-c,i)).map(s);return g=g.filter(t=>0!==t),(null==a?void 0:a.noDecimals)&&(g=Array.from(new Set(g.map(t=>Math.floor(t))))),h?g.reverse():g}),xH=xe((t,e,i,r,n,s)=>{let a=[],o={},l=n(t),h=n(e),u=[];if(Number.isInteger(r))u=xR(l,h,i);else{let t=(h-l)/(i-1);for(let e=0;e<i;e++)u.push(l+e*t)}return u.forEach(i=>{let n=s(i),l=Number.isInteger(r)?xN(t,e,n):xN(t,e,xS(n)),h=xN(t,e,xk(l,[t,e]));o[h]||isNaN(h)||!(u.length>1)||(o[h]=1,a.push(h))}),a}),xV=xe((t,e,i,r,n)=>xL(r(t),r(e),i).map(t=>xS(n(t))));xe((t,e,i,r,n)=>xD(r(t),r(e),i).map(t=>xS(n(t))));class xW{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:eO(this._rangeFactorStart)&&eO(this._rangeFactorEnd)&&2===t.length?(this._wholeRange=x_(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,i){return t?(2===t.length&&t.every(t=>t>=0&&t<=1)&&(this._wholeRange=null,0===t[0]&&1===t[1]?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):eO(this._rangeFactorStart)&&eO(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var i;return ej(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&(ej(this._rangeFactorEnd)||1===this._rangeFactorEnd)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t,this._rangeFactorEnd=null!==(i=this._rangeFactorEnd)&&void 0!==i?i:1)),this)}rangeFactorEnd(t,e){var i;return ej(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,0===t&&(ej(this._rangeFactorStart)||0===this._rangeFactorStart)?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorEnd=t,this._rangeFactorStart=null!==(i=this._rangeFactorStart)&&void 0!==i?i:0)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);let{distortion:e=2,radiusRatio:i=.1,radius:r}=this._fishEyeOptions,n=this.range(),s=n[0],a=n[n.length-1],o=Math.min(s,a),l=Math.max(s,a),h=nL(null!==(t=this._fishEyeOptions.focus)&&void 0!==t?t:0,o,l),u=ej(r)?(l-o)*i:r,d=Math.exp(e);d=d/(d-1)*u;let c=e/u;this._fishEyeTransform=t=>{let e=Math.abs(t-h);return e>=u?t:e<=1e-6?h:h+(t-h)*(d*(1-Math.exp(-e*c))/e*.75+.25)}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}}function xG(t){let e="",i="",r="",n="#"===t[0]?1:0;for(let s=n;s<t.length;s++)"#"!==t[s]&&(s<n+2?e+=t[s]:s<n+4?i+=t[s]:s<n+6&&(r+=t[s]));return[parseInt(e,16),parseInt(i,16),parseInt(r,16)]}function xU(t,e,i){return Number(16777216+(t<<16)+(e<<8)+i).toString(16).slice(1)}function x$(t,e){let i=t.r,r=e.r,n=t.g,s=e.g,a=t.b,o=e.b,l=t.opacity,h=e.opacity;return t=>new nY(Math.round(i*(1-t)+r*t),Math.round(n*(1-t)+s*t),Math.round(a*(1-t)+o*t),l*(1-t)+h*t)}function xY(t,e){return i=>t*(1-i)+e*i}function xK(t,e){return function(i){return Math.round(t*(1-i)+e*i)}}let xZ=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xX=RegExp(xZ.source,"g"),{interpolateRgb:xq}=ep;function xJ(t,e){let i;let r=typeof e;if(ej(e)||"boolean"===r)return()=>e;if("number"===r)return xY(t,e);if("string"===r){if(i=n$.parseColorString(e)){let e=xq(n$.parseColorString(t),i);return t=>e(t).formatRgb()}return xY(Number(t),Number(e))}return e instanceof nY?xq(t,e):e instanceof n$?xq(t.color,e.color):e instanceof Date?function(t,e){let i=t.valueOf(),r=e.valueOf(),n=new Date;return t=>(n.setTime(i*(1-t)+r*t),n)}(t,e):xY(Number(t),Number(e))}function xQ(t,e){let i;return t>e&&(i=t,t=e,e=i),i=>Math.max(t,Math.min(e,i))}class x0 extends xW{constructor(t=xs,e=xs){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=xs,this._piecewise=xm,this._interpolate=xJ}calculateVisibleDomain(t){var e;return eO(this._rangeFactorStart)&&eO(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:null!==(e=this._niceDomain)&&void 0!==e?e:this._domain}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(Number.isNaN(t=Number(t))||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),(null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this.transformer),xY)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var i;if(!t)return(null!==(i=this._niceDomain)&&void 0!==i?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;let r=Array.from(t,dy);return this._domain=r,this.rescale(e)}range(t,e){if(!t)return this._range.slice();let i=Array.from(t);return this._range=i,this.rescale(e)}rangeRound(t,e){let i=Array.from(t);return this._range=i,this._interpolate=xK,this.rescale(e)}rescale(t){var e;if(t)return this;let i=null!==(e=this._niceDomain)&&void 0!==e?e:this._domain,r=i.length,n=this._range.length,s=Math.min(r,n);if(r&&r<n&&this._forceAlign){let t=n-r+1,e=i[r-1],a=r>=2?(e-i[r-2])/t:0;for(let n=1;n<=t;n++)i[r-2+n]=e-a*(t-n);s=n}return this._autoClamp&&(this._clamp=xQ(i[0],i[s-1])),this._piecewise=s>2?xb:xm,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:xs),this.rescale(i)):this._clamp!==xs}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){let e=this.ticks(t);return(null!=e?e:[]).map((t,e)=>({index:e,tick:t,value:(this.scale(t)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return ej(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return ej(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}class x1 extends x0{constructor(){super(...arguments),this.type=c0.Linear}clone(){return(new x1).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}tickFormat(){return()=>{}}d3Ticks(t=10,e){let i=this.calculateVisibleDomain(this._range);return xE(i[0],i[i.length-1],t,e)}ticks(t=10,e){var i;if(eO(this._rangeFactorStart)&&eO(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&2===this._range.length||!this._niceType)return this.d3Ticks(t,e);let r=null!==(i=this._niceDomain)&&void 0!==i?i:this._domain,n=this._domain,s=r[0],a=r[r.length-1],o=xR(n[0],n[n.length-1],t,e);if(!o.length)return o;if(this._domainValidator)o=o.filter(this._domainValidator);else if((o[0]!==s||o[o.length-1]!==a)&&this._niceType){let t=r.slice();if("all"===this._niceType?(t[0]=o[0],t[t.length-1]=o[o.length-1],this._niceDomain=t,this.rescale()):"min"===this._niceType&&o[0]!==s?(t[0]=o[0],this._niceDomain=t,this.rescale()):"max"===this._niceType&&o[o.length-1]!==a&&(t[t.length-1]=o[o.length-1],this._niceDomain=t,this.rescale()),"all"!==this._niceType){let e=Math.min(t[0],t[t.length-1]),i=Math.max(t[0],t[t.length-1]);o=o.filter(t=>t>=e&&t<=i)}}return o}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return xL(e[0],e[e.length-1],t)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return xD(e[0],e[e.length-1],t)}nice(t=10,e){var i,r;let n=this._domain,s=[];if(e){let t=xj(n,e);if(s=t.niceMinMax,this._domainValidator=t.domainValidator,this._niceType=t.niceType,t.niceDomain)return this._niceDomain=t.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){let e=xF(n.slice(),t);"min"===this._niceType?e[e.length-1]=null!==(i=s[1])&&void 0!==i?i:e[e.length-1]:"max"===this._niceType&&(e[0]=null!==(r=s[0])&&void 0!==r?r:e[0]),this._niceDomain=e,this.rescale()}return this}niceMin(t=10){this._niceType="min";let e=this._domain[this._domain.length-1],i=xF(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(t=10){this._niceType="max";let e=this._domain[0],i=xF(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}let x2=Symbol("implicit");class x3 extends xW{specified(t){var e;return t?(this._specified=Object.assign(null!==(e=this._specified)&&void 0!==e?e:{},t),this):Object.assign({},this._specified)}_getSpecifiedValue(t){if(this._specified)return this._specified[t]}constructor(){super(),this.type=c0.Ordinal,this._index=new Map,this._domain=[],this._ordinalRange=[],this._unknown=x2}clone(){let t=(new x3).domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&t.specified(this._specified),t}calculateVisibleDomain(t){return eO(this._rangeFactorStart)&&eO(this._rangeFactorEnd)&&2===t.length?[this.invert(t[0]),this.invert(t[1])]:this._domain}scale(t){let e=`${t}`,i=this._getSpecifiedValue(e);if(void 0!==i)return i;let r=this._index.get(e);if(!r){if(this._unknown!==x2)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}let n=this._ordinalRange[(r-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(n):n}invert(t){let e=0;for(;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}domain(t){if(!t)return this._domain.slice();for(let e of(this._domain=[],this._index=new Map,t)){let t=`${e}`;this._index.has(t)||this._index.set(t,this._domain.push(e))}return this}range(t){if(!t)return this._ordinalRange.slice();let e=Array.from(t);return this._ordinalRange=e,this}index(t){var e;return this._index&&null!==(e=this._index.get(`${t}`))&&void 0!==e?e:-1}}function x5(t,e,i,r){let n=[],s=t;for(;s<=e;)n.push(s),s+=i;return r&&n.reverse(),n}function x4(t,e,i,r){let n,s;if(e=Math.floor(+e),t=Math.floor(+t),!(i=Math.floor(+i)))return[];if(t===e)return[t];if(n=e<t){let i=t;t=e,e=i}let a=xQ(1,e-t+1)(i);if(s=Math.floor((e-t+1)/a),!r)for(;Math.ceil((e-t+1)/s)>i&&a>1;)a-=1,s=Math.floor((e-t)/a);return x5(t,e,s,n)}class x8 extends x3{constructor(t){super(),this.type=c0.Band,this._range=[0,1],this._step=void 0,this._bandwidth=void 0,this._isFixed=!1,this._round=!1,this._paddingInner=0,this._paddingOuter=0,this._align=.5,this._unknown=void 0,delete this.unknown,this.rescale(t)}rescale(t,e){if(t)return this;this._wholeRange=null;let i=this._calculateWholeRange(this._range,e),r=super.domain().length,n=i[1]<i[0],s=i[Number(n)-0],a=i[1-Number(n)],o=xv(r,this._paddingInner,this._paddingOuter);return this._step=(a-s)/Math.max(1,o||1),this._round&&(this._step=Math.floor(this._step)),s+=(a-s-this._step*(r-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(s=Math.round(s),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:n,start:n?s+this._step*(r-1):s,count:r},this.generateFishEyeTransform(),this}scale(t){if(!this._bandRangeState)return;let e=`${t}`,i=this._getSpecifiedValue(e);if(void 0!==i)return i;let r=this._index.get(e);if(!r){if(this._unknown!==x2)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}let{count:n,start:s,reverse:a}=this._bandRangeState,o=s+(r-1)%n*(a?-1:1)*this._step;return this._fishEyeTransform?this._fishEyeTransform(o):o}_calculateWholeRange(t,e){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){var i,r,n,s,a;let e,o,l;if(eO(this._rangeFactorStart)&&eO(this._rangeFactorEnd)&&2===t.length){let i=x_(t,[this._rangeFactorStart,this._rangeFactorEnd]);e=Math.abs(i[1]-i[0])}else e=Math.abs(t[1]-t[0]);let h=(i=super.domain().length,r=e,n=this._paddingInner,s=this._paddingOuter,a=this._round,o=r/Math.max(1,xv(i,n,s)||1),a&&(o=Math.floor(o)),l=o*(1-n),a&&(l=Math.round(l)),l);h<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):h>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=h,this._isFixed=!1)}if(this.isBandwidthFixed()){let i=xy(super.domain().length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),r=Math.min((t[1]-t[0])/i,1);if(eO(this._rangeFactorStart)&&eO(this._rangeFactorEnd)){if(i>0){let e=t[0]-i*this._rangeFactorStart;this._wholeRange=[e,e+i]}else{let e=t[1]+i*(1-this._rangeFactorEnd);this._wholeRange=[e-i,e]}let n=this._rangeFactorStart+r<=1,s=this._rangeFactorEnd-r>=0;"rangeFactorStart"===e&&n?this._rangeFactorEnd=this._rangeFactorStart+r:"rangeFactorEnd"===e&&s?this._rangeFactorStart=this._rangeFactorEnd-r:t[0]<=t[1]?n?this._rangeFactorEnd=this._rangeFactorStart+r:s?this._rangeFactorStart=this._rangeFactorEnd-r:(this._rangeFactorStart=0,this._rangeFactorEnd=r):s?this._rangeFactorStart=this._rangeFactorEnd-r:n?this._rangeFactorEnd=this._rangeFactorStart+r:(this._rangeFactorStart=1-r,this._rangeFactorEnd=1)}else this._rangeFactorStart=0,this._rangeFactorEnd=r,this._wholeRange=[t[0],t[0]+i];return this._wholeRange}return super._calculateWholeRange(t)}calculateWholeRangeSize(){let t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}calculateVisibleDomain(t){let e=this._domain;if(eO(this._rangeFactorStart)&&eO(this._rangeFactorEnd)&&e.length){let i=this._getInvertIndex(t[0]),r=this._getInvertIndex(t[1]);return e.slice(Math.min(i,r),Math.max(i,r)+1)}return e}domain(t,e){return t?(super.domain(t),this.rescale(e)):super.domain()}range(t,e){return t?(this._range=[dy(t[0]),dy(t[1])],this.rescale(e)):this._range}rangeRound(t,e){return this._range=[dy(t[0]),dy(t[1])],this._round=!0,this.rescale(e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return -1===t?e:x4(0,e.length-1,t,!1).map(t=>e[t])}tickData(t=10){return this.ticks(t).map((t,e)=>({index:e,tick:t,value:(this.scale(t)-this._range[0]+this._bandwidth/2)/(this._range[1]-this._range[0])}))}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return x4(0,e.length-1,t,!0).filter(t=>t<e.length).map(t=>e[t])}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return(function(t,e,i){let r;if(i=xQ(1,(e=Math.floor(+e))-(t=Math.floor(+t))+1)(Math.floor(+i)),r=e<t){let i=t;t=e,e=i}return x5(t,e,i,r)})(0,e.length-1,t).map(t=>e[t])}_getInvertIndex(t){let e=0,i=this.step()/2,r=this.bandwidth()/2,n=this._domain.length,s=this.range(),a=s[0]>s[s.length-1];for(e=0;e<n;e++){let s=this.scale(this._domain[e])+r;if(0===e&&(!a&&!df(t,s+i)||a&&!dm(t,s-i))||e===n-1||!dm(t,s-i)&&!df(t,s+i))break}return e>=0&&e<=n-1?e:n-1}invert(t){return this._domain[this._getInvertIndex(t)]}padding(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}paddingInner(t,e){return void 0!==t?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}paddingOuter(t,e){return void 0!==t?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}step(){return this._step}round(t,e){return void 0!==t?(this._round=t,this.rescale(e)):this._round}align(t,e){return void 0!==t?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}rangeFactor(t,e){return t?(super.rangeFactor(t),this.rescale(e)):super.rangeFactor()}rangeFactorStart(t,e){return ej(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this.rescale(e,"rangeFactorStart"))}rangeFactorEnd(t,e){return ej(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this.rescale(e,"rangeFactorEnd"))}bandwidth(t,e){return t?("auto"===t?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}maxBandwidth(t,e){return t?(this._maxBandwidth="auto"===t?void 0:t,this.rescale(e)):this._maxBandwidth}minBandwidth(t,e){return t?(this._minBandwidth="auto"===t?void 0:t,this.rescale(e)):this._minBandwidth}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}isBandwidthFixed(){return this._isFixed&&!!this._bandwidth}_isBandwidthFixedByUser(){return this._isFixed&&this._userBandwidth&&ey(this._userBandwidth)}clone(){var t,e,i;return new x8(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth(null!==(t=this._userBandwidth)&&void 0!==t?t:"auto",!0).maxBandwidth(null!==(e=this._maxBandwidth)&&void 0!==e?e:"auto",!0).minBandwidth(null!==(i=this._maxBandwidth)&&void 0!==i?i:"auto")}}class x6{constructor(){this.type=c0.Threshold,this._range=[0,1],this._domain=[.5],this.n=1}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}scale(t){return!ej(t)&&l1(+t)?this._range[xi(this._domain,t,0,this.n)]:this._unknown}invertExtent(t){let e=this._range.indexOf(t);return[this._domain[e-1],this._domain[e]]}domain(t){return t?(this._domain=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._domain.slice()}range(t){return t?(this._range=Array.from(t),this.n=Math.min(this._domain.length,this._range.length-1),this):this._range.slice()}clone(){return(new x6).domain(this._domain).range(this._range).unknown(this._unknown)}}class x9 extends x3{range(t){return t?(this._range=t,this._resetRange(),this):super.range()}domain(t){return t?(super.domain(t),this._resetRange(),this):super.domain()}_resetRange(){if(!hS(this._range))return void super.range(this._range);let t=hy(this._range,this._domain);super.range(t)}}let x7={linear:x1,band:x8,point:class t extends x8{constructor(t){super(!1),this.type=c0.Point,this._padding=0,this.paddingInner(1,t),this.padding=this.paddingOuter,this.paddingInner=void 0,this.paddingOuter=void 0}},ordinal:x3,threshold:x6,colorOrdinal:x9};function St(t){let e=x7[t];return e?new e:null}function Se(t,e){if(!e)return t;let i=e.range(),r=Math.min(i[0],i[i.length-1]);return Math.min(Math.max(r,t),Math.max(i[0],i[i.length-1]))}function Si(t){return eO(null==t?void 0:t.field)&&eO(null==t?void 0:t.scale)}let Sr=["line","area","trail"];function Sn(t){return Sr.includes(t)}class Ss extends b${getStateInfoList(){return this._stateInfoList}constructor(t,e){super(t),this._stateInfoList=[],this._mark=e}_getDefaultStateMap(){return{markUpdateRank:1}}getStateInfo(t){return this._stateInfoList.find(e=>e.stateValue===t)}addStateInfo(t){if(this.getStateInfo(t.stateValue))return;t.level=t.level||0;let e=!0;for(let i=0;i<this._stateInfoList.length;i++){let r=this._stateInfoList[i].level;if(r&&r>t.level){this._stateInfoList.splice(i,0,t),e=!1;break}}e&&this._stateInfoList.push(t)}_clearStateBeforeSet(t){t.datums=null,t.items=null,t.fields=null,t.filter=null}changeStateInfo(t){let e=this.getStateInfo(t.stateValue);if(e){if(void 0!==t.datums&&(this._clearStateBeforeSet(e),e.datums=t.datums,e.datumKeys=t.datumKeys),void 0!==t.items&&(this._clearStateBeforeSet(e),e.items=t.items),void 0!==t.fields){if(this._clearStateBeforeSet(e),null===t.fields)e.fields=t.fields;else for(let i in e.fields=e.fields||{},t.fields){let r=t.fields[i];e.fields[i]=e.fields[i]||{};let n=e.fields[i];eO(r.domain)&&(n.domain=r.domain),eO(r.type)&&(n.type=r.type)}}t.filter&&(this._clearStateBeforeSet(e),e.filter=t.filter)}else this.addStateInfo(t)}clearStateInfo(t){t.forEach(t=>{this.getStateInfo(t)&&this.changeStateInfo({stateValue:t,datumKeys:null,datums:null,fields:null,items:null,filter:null,cache:{}})})}checkOneState(t,e,i,r){var n;r=ew(Sn)?r:!t.mark||Sn(t.mark.markType);let s=!1,a=!1;if(eO(i.datums)&&i.datums.length>0)s=this.checkDatumState(i,e,r),a=!0;else if(i.items)s=null!==(n=this.checkItemsState(i,t))&&void 0!==n&&n,a=!0;else if(i.fields)s=this.checkFieldsState(i,e,t,r),a=!0;else if(!s&&i.filter){let r={mark:this._mark,renderNode:t,type:t.mark.markType};s=i.filter(e,r),a=!0}return a?s?"in":"out":"skip"}checkState(t,e){let i=t.getStates().filter(t=>!!bb[t]).map(t=>[t,10]),r=!t.mark||Sn(t.mark.markType);for(let n=0;n<this._stateInfoList.length;n++){let s=this._stateInfoList[n],a=this.checkOneState(t,e,s,r);"skip"!==a&&"in"===a&&i.push([s.stateValue,s.level])}return i.map(t=>t[0])}checkDatumState(t,e,i){let r=!1,n=i?e[0]:e;if(eM(t.datums)){let e=t.datumKeys||Object.keys(t.datums[0]).filter(t=>!t.startsWith(hA));r=t.datums.some(t=>i&&eM(null==t?void 0:t.items)?e.every(e=>{var i,r;return(null===(r=null===(i=null==t?void 0:t.items)||void 0===i?void 0:i[0])||void 0===r?void 0:r[e])===(null==n?void 0:n[e])}):e.every(e=>(null==t?void 0:t[e])===(null==n?void 0:n[e])))}else r=nb(t.datums)?(t.datumKeys||Object.keys(t.datums).filter(t=>!t.startsWith(hA))).every(e=>{var r,s;return i?(null===(r=t.datums.items)||void 0===r?void 0:r[0][e])===n[e]:(null===(s=t.datums)||void 0===s?void 0:s[e])===n[e]}):e===t.datums;return r}checkItemsState(t,e){var i;return null===(i=t.items)||void 0===i?void 0:i.includes(e)}checkFieldsState(t,e,i,r){var n;let s=!0;for(let a in t.fields){let o=t.fields[a],l=o.type,h=o.domain,u=r?null===(n=e[0])||void 0===n?void 0:n[a]:e[a];if(dr(l)&&h.length>1){if(this.checkLinearFieldState(h,a,e,i,r)){s=!1;break}s=!0}else{if(!h.some(t=>t===u)){s=!1;break}s=!0}}return s}checkLinearFieldState(t,e,i,r,n){var s;let a=n?null===(s=i[0])||void 0===s?void 0:s[e]:i[e];return a<t[0]||a>t[t.length-1]}updateLayoutState(t){return this._stateMap.markUpdateRank++,this.updateState({markUpdateRank:this._stateMap.markUpdateRank},t)}compileState(t,e){t.state({callback:(t,e)=>this.checkState(e,t)},e)}}class Sa extends bW{getDataView(){return this._data}setDataView(t){this._data=t}getLatestData(){var t;return null===(t=this._data)||void 0===t?void 0:t.latestData}constructor(t,e){super(t),this.grammarType=tS.data,this._data=null,this._data=e}release(){super.release(),this._data=null}updateData(t){let e=this.getProduct(),i=this.getLatestData();if(e&&i&&(e.values(i),!t))return this.getCompiler().renderNextTick()}_compileProduct(){let t=this.getLatestData();ej(t)||(ej(this.getProduct())?this._initProduct(t):this._product.values(t))}_initProduct(t){var e,i;let r=this.getVGrammarView();if(!r||!t)return;let n=this.getProductId();this._product=null===(i=null===(e=null==r?void 0:r.data)||void 0===e?void 0:e.call(r,t))||void 0===i?void 0:i.id(n),this._compiledProductId=n}generateProductId(){var t;return`${null===(t=this.getDataView())||void 0===t?void 0:t.name}`}_lookupGrammar(t){var e,i;return null===(i=null===(e=this.getCompiler().getVGrammarView())||void 0===e?void 0:e.getDataById)||void 0===i?void 0:i.call(e,t)}}class So extends Sa{constructor(t){super(t),this._mark=t.mark}setCompiledProductId(t){this._compiledProductId=t}generateProductId(){let t=super.generateProductId();return eO(t)?t:`${hA}_markData_${this._mark.id}`}_compileProduct(){var t;let e=null===(t=this._data)||void 0===t?void 0:t.latestData;ej(e)||eO(this.getProduct())||this._initProduct(e)}}var Sl=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Sh extends bW{getSkipTheme(){return this._skipTheme}setSkipTheme(t){this._skipTheme=t}getSupport3d(){return this._support3d}setSupport3d(t){this._support3d=t}getFacet(){return this._facet}setFacet(t){this._facet=t}getInteractive(){return this._interactive}setInteractive(t){this._interactive=t}getZIndex(){return this._zIndex}setZIndex(t){this._zIndex=t}getVisible(){return this._visible}setVisible(t){this._visible=t}getUserId(){return this._userId}setUserId(t){eO(t)&&(this._userId=t)}getDataView(){var t;return null===(t=this._data)||void 0===t?void 0:t.getDataView()}setDataView(t,e){ej(this._data)&&this.initMarkData(Object.assign(Object.assign({},this._option),{mark:this})),eO(e)&&this._data.setCompiledProductId(e),this._data.setDataView(t)}getData(){return this._data}setData(t){this._data=t}hasState(t){return t in this.state.getStateMap()}getState(t){return this.state.getStateMap()[t]}getAnimationConfig(){return this._animationConfig}setAnimationConfig(t){this._animationConfig=t}setSkipBeforeLayouted(t){this._skipBeforeLayouted=t}getSkipBeforeLayouted(){return this._skipBeforeLayouted}getMorph(){return this._morph}setMorph(t){this._morph=t}getMorphKey(){return this._morphKey}setMorphKey(t){this._morphKey=t}getMorphElementKey(){return this._morphElementKey}setMorphElementKey(t){this._morphElementKey=t}getGroupKey(){return this._groupKey}setGroupKey(t){this._groupKey=t}getProgressiveConfig(){return this._progressiveConfig}setProgressiveConfig(t){this._progressiveConfig=t}setCustomizedShapeCallback(t){this._setCustomizedShape=t}setEnableSegments(t){this._enableSegments=t}getClip(){return this._clip}setClip(t){this._clip=t}setStateSortCallback(t){this._stateSort=t}constructor(t,e,i){super(t),this.grammarType=tS.mark,this.type=void 0,this.name="mark",this._interactive=!0,this._zIndex=tM.Mark,this._visible=!0,this.stateStyle={},this._unCompileChannel={},this._skipBeforeLayouted=!1,this._morph=!1,this.name=e,this.model=i,this.key=t.key,this.state=new Ss(Object.assign(Object.assign({},t),{stateKeyToSignalName:this.stateKeyToSignalName.bind(this)}),this),this._option.support3d&&this.setSupport3d(!0),this._option.skipTheme&&this.setSkipTheme(!0),this._event=new dZ(i.getOption().eventDispatcher,i.getOption().mode)}setTransform(t){this._transform=t}initMarkData(t){this._data=new So(t)}stateKeyToSignalName(t){return`${hA}_${this.type}_${this.id}_${t}`}getAttribute(t,e,i,r){}_compileProduct(t){let e=this.getProduct();if(!this.getVisible())return void(eO(e)&&this.removeProduct());!eO(e)&&this.getCompiler().isInited&&(this._initProduct(null==t?void 0:t.group),ej(this._product)||(this.compileSignal(),this.compileData(),this.compileState(),this.compileEncode(),this.compileAnimation(),this.compileContext(),this.compileTransform()))}_initProduct(t){let e=this.getVGrammarView(),i=this.getProductId();this._product=e.mark(this.type,null!=t?t:e.rootMark).id(i),this._compiledProductId=i}generateProductId(){return this._userId?`${this._userId}`:`${this.name}_${this.id}`}compileData(){var t;if(ej(this._data))return;this._data.compile();let e=this._data.getProduct();eO(this._product)&&eO(e)&&this._product.join(e,this.key,void 0,null!==(t=this._groupKey)&&void 0!==t?t:this._facet)}updateStaticEncode(){if(!this._product)return;let{enterStyles:t,updateStyles:e}=this._separateStyle();this._product.encodeState("group",t,!0),this._product.encode(e,!0)}_separateStyle(){let t=this.stateStyle,e=tk.STATE_NORMAL,i=t[e],r=(Sl(t,["symbol"==typeof e?e:e+""]),this._option.noSeparateStyle?null:{}),n={};return Object.keys(i).forEach(t=>{this._unCompileChannel[t]||(this._option.noSeparateStyle||function(t,e,i){var r;let n=null===(r=e[t])||void 0===r?void 0:r.style;return!!(function(t,e){return("fill"===t||"stroke"===t)&&(null==e?void 0:e.gradient)&&(null==e?void 0:e.stops)}(t,n)||nx(n))||!(!(null==n?void 0:n.scale)||n.field===i)}(t,i,this.getFacet())?n[t]={callback:this.compileCommonAttributeCallback(t,"normal"),dependency:[this.stateKeyToSignalName("markUpdateRank")]}:r[t]=this.compileCommonAttributeCallback(t,"normal"))}),{enterStyles:r,updateStyles:n}}compileEncode(){let t=this.stateStyle,e=tk.STATE_NORMAL,i=(t[e],Sl(t,["symbol"==typeof e?e:e+""])),{enterStyles:r,updateStyles:n}=this._separateStyle();this._product.encode(n,!0),this._product.encodeState("group",r,!0),Object.keys(i).forEach(t=>{let e={};Object.keys(i[t]).forEach(i=>{this._unCompileChannel[i]||(e[i]={callback:this.compileCommonAttributeCallback(i,t),dependency:[this.stateKeyToSignalName("markUpdateRank")]})}),this._product.encodeState(t,e,!0)}),this._skipBeforeLayouted&&this._product.layout({skipBeforeLayouted:this._skipBeforeLayouted})}compileState(){this.state.compileState(this._product,this._stateSort)}compileAnimation(){var t,e,i,r;if(this._animationConfig){let n;if("component"===this.type)n=null===(t=this.model.animate)||void 0===t?void 0:t.getAnimationStateSignalName();else{let t=null===(i=(e=this.model).getRegion)||void 0===i?void 0:i.call(e);n=null===(r=null==t?void 0:t.animate)||void 0===r?void 0:r.getAnimationStateSignalName()}this._product.animation(this._animationConfig),this._product.animationState({callback:(t,e,i)=>{var r;return null===(r=i[n])||void 0===r?void 0:r.callback(t,e)},dependency:n}),this._animationConfig.normal&&(this._animationConfig.appear?this._event.on(pa.ANIMATION_END,({event:t})=>{t.mark===this.getProduct()&&t.animationState===t_.appear&&this.runAnimationByState(t_.normal)}):this._event.on(pa.AFTER_DO_RENDER,()=>{this.runAnimationByState(t_.normal)}))}}compileContext(){let t={interactive:this.getInteractive(),zIndex:this.getZIndex(),context:{markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId},skipTheme:this.getSkipTheme(),support3d:this.getSupport3d(),enableSegments:!!this._enableSegments,clip:!!this._clip||!1!==this._clip&&void 0,clipPath:this._clip||void 0};this._progressiveConfig&&(t.progressiveStep=this._progressiveConfig.progressiveStep,t.progressiveThreshold=this._progressiveConfig.progressiveThreshold,t.large=this._progressiveConfig.large,t.largeThreshold=this._progressiveConfig.largeThreshold),t.morph=this._morph,t.morphKey=this._morphKey,t.morphElementKey=this._morphElementKey,this._setCustomizedShape&&(t.setCustomizedShape=this._setCustomizedShape),this._product.configure(t)}compileSignal(){this.state.compile()}_computeAttribute(t,e){return(t,e)=>{}}compileCommonAttributeCallback(t,e){let i=this._computeAttribute(t,e),r={mark:null,parent:null,element:null};return(t,e)=>(r.mark=e.mark,r.parent=e.mark.group,r.element=e,i(t,r))}compileTransform(){var t;(null===(t=this._transform)||void 0===t?void 0:t.length)&&this.getProduct().transform(this._transform)}_lookupGrammar(t){var e;return null===(e=this.getCompiler().getVGrammarView())||void 0===e?void 0:e.getMarkById(t)}updateState(t,e){return this.state.updateState(t,e)}updateLayoutState(t,e){return e&&this.getMarks().length>0&&this.getMarks().forEach(t=>t.state.updateLayoutState(!0)),this.state.updateLayoutState(t)}updateMarkState(t){if(!this._product)return;let e=this.state.getStateInfo(t);this._product.elements.forEach(i=>{"in"===this.state.checkOneState(i,i.getDatum(),e)?i.addState(t):i.removeState(t)})}getMarks(){return[]}runAnimationByState(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.runAnimationByState(t)}stopAnimationByState(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.stopAnimationByState(t)}pauseAnimationByState(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.pauseAnimationByState(t)}resumeAnimationByState(t){var e,i;return null===(i=null===(e=this.getProduct())||void 0===e?void 0:e.animate)||void 0===i?void 0:i.resumeAnimationByState(t)}getProductElements(){let t=this.getProduct();if(t)return t.elements}release(){super.release(),this.state.release()}}var Su=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Sd extends Sh{constructor(t,e){var i;super(e,t,e.model),this._extensionChannel={},this._computeExChannel={},this._attributeContext=e.attributeContext,null===(i=e.map)||void 0===i||i.set(this.id,this)}created(){this._initStyle()}initStyleWithSpec(t,e){t&&(eO(t.id)&&(this._userId=t.id),ew(t.interactive)&&(this._interactive=t.interactive),eO(t.zIndex)&&this.setZIndex(t.zIndex),ew(t.visible)&&this.setVisible(t.visible),this._initSpecStyle(t,this.stateStyle,e))}_transformStyleValue(t,e){if(t.scale){let i=t.scale,r=i.range();return i.range(r.map(e)),t}return"function"==typeof t?(...i)=>e(t(...i)):e(t)}convertAngleToRadian(t){return this._transformStyleValue(t,ik)}isUserLevel(t){return[tw.User_Mark,tw.User_Series,tw.User_Chart,tw.User_SeriesStyle].includes(t)}setStyle(t,e="normal",i=0,r=this.stateStyle){if(ej(t))return;void 0===r[e]&&(r[e]={});let n=this.isUserLevel(i);Object.keys(t).forEach(s=>{let a=t[s];ej(a)||(a=this._filterAttribute(s,a,e,i,n,r),this.setAttribute(s,a,e,i,r))})}getStyle(t,e="normal"){var i;return null===(i=this.stateStyle[e][t])||void 0===i?void 0:i.style}_filterAttribute(t,e,i,r,n,s=this.stateStyle){let a=this._styleConvert(e);if(n)switch(t){case"angle":a=this.convertAngleToRadian(a);break;case"innerPadding":case"outerPadding":a=this._transformStyleValue(a,t=>-t);break;case"curveType":a=this._transformStyleValue(a,t=>{var e,i;return e=t,i=this._option.model.direction,"monotone"===e?"horizontal"===i?"monotoneY":"monotoneX":e})}return a}setReferer(t,e,i,r=this.stateStyle){var n;if(t){if(e&&i){let s=null!==(n=r[i])&&void 0!==n?n:{[e]:{}};r[i][e]=Object.assign(Object.assign({},s[e]),{referer:t})}else Object.entries(r).forEach(([e,i])=>{Object.entries(i).forEach(([i,n])=>{r[e][i].referer=t})})}}setPostProcess(t,e,i="normal"){var r;(null===(r=this.stateStyle[i])||void 0===r?void 0:r[t])&&(this.stateStyle[i][t].postProcess=e)}getAttribute(t,e,i="normal",r){return this._computeAttribute(t,i)(e,r)}setAttribute(t,e,i="normal",r=0,n=this.stateStyle){var s;void 0===n[i]&&(n[i]={}),void 0===n[i][t]&&(n[i][t]={level:r,style:e,referer:void 0});let a=null===(s=n[i][t])||void 0===s?void 0:s.level;eO(a)&&a<=r&&us(n[i][t],{style:e,level:r}),"normal"!==i&&t in this._extensionChannel&&this._extensionChannel[t].forEach(t=>{void 0===n[i][t]&&(n[i][t]=n.normal[t])})}_getDefaultStyle(){return{visible:!0,x:0,y:0}}_styleConvert(t){if(!t)return t;if(di[t.type]||t.scale){let e=function(t,e){if("scale"in t&&t.scale)return eE(t.scale)&&(null==e?void 0:e.globalScale)?e.globalScale.registerMarkAttributeScale(t,e.seriesId):t.scale;let i=St(t.type);return i&&function(t,e){t&&e&&(e.domain&&t.domain(e.domain),e.range&&t.range(e.range),e.specified&&t.specified&&t.specified(e.specified))}(i,t),i}(t,{globalScale:this._option.globalScale,seriesId:this._option.seriesId});if(e)return{scale:e,field:t.field,changeDomain:t.changeDomain}}return t}_computeAttribute(t,e){var i;let r=null===(i=this.stateStyle[e])||void 0===i?void 0:i[t];r||(r=this.stateStyle.normal[t]);let n=this._computeStateAttribute(r,t,e),s=nx(null==r?void 0:r.postProcess),a=t in this._computeExChannel;if(s&&a){let i=this._computeExChannel[t];return(s,a)=>{let o=n(s,a);return o=r.postProcess(o,s,this._attributeContext,a,this.getDataView()),i(t,s,e,a,o)}}if(s)return(t,e)=>r.postProcess(n(t,e),t,this._attributeContext,e,this.getDataView());if(a){let i=this._computeExChannel[t];return(r,s)=>i(t,r,e,s,n(r,s))}return n}_computeStateAttribute(t,e,i){var r;return t?t.referer?t.referer._computeAttribute(e,i):t.style?"function"==typeof t.style?(e,i)=>t.style(e,this._attributeContext,i,this.getDataView()):bz.includes(t.style.gradient)?this._computeGradientAttr(t.style):["outerBorder","innerBorder"].includes(e)?this._computeBorderAttr(t.style):di[null===(r=t.style.scale)||void 0===r?void 0:r.type]?(e,i)=>t.style.scale.scale(e[t.style.field]):(e,i)=>t.style:(e,i)=>t.style:(t,e)=>{}}_initStyle(){let t=this._getDefaultStyle();this.setStyle(t,"normal",0)}_initSpecStyle(t,e,i){t.style&&this.setStyle(t.style,"normal",tw.User_Mark,e);let r=t.state;r&&Object.keys(r).forEach(t=>{let i=r[t];if("style"in i){let r=i.style,n={stateValue:t};"level"in i&&(n.level=i.level),"filter"in i&&(n=nx(i.filter)?Object.assign({filter:i.filter},n):Object.assign(Object.assign({},i.filter),n)),this.state.addStateInfo(n),this.setStyle(r,t,tw.User_Mark,e)}else this.setStyle(i,t,tw.User_Mark,e)})}_computeGradientAttr(t){var e,i;let{gradient:r,scale:n,field:s}=t,a=Su(t,["gradient","scale","field"]),o=n,l=s;if(!(n&&s||"series"!==this.model.modelType)){let{scale:t,field:e}=this.model.getColorAttribute();n||(o=t),l||(l=e)}let h=hy(hv(this.model.getColorScheme(),"series"===this.model.modelType?null===(i=(e=this.model).getSpec)||void 0===i?void 0:i.call(e):void 0),this.model.getDefaultColorDomain()),u=Object.assign(Object.assign({},bH[r]),a);return(t,e)=>{let i={},n=this.getDataView();return Object.keys(u).forEach(r=>{let s=u[r];"stops"===r?i.stops=s.map(i=>{let{opacity:r,color:s,offset:a}=i,u=null!=s?s:null==o?void 0:o.scale(t[l]);return nx(s)&&(u=s(t,this._attributeContext,e,n)),eO(r)&&(u=n$.SetOpacity(u,r)),{offset:nx(a)?a(t,this._attributeContext,e,n):a,color:u||h[0]}}):nx(s)?i[r]=s(t,this._attributeContext,e,n):i[r]=s}),i.gradient=r,i}}_computeBorderAttr(t){let{scale:e,field:i}=t,r=Su(t,["scale","field"]);return(t,n)=>{var s,a,o;let l={};if(Object.keys(r).forEach(e=>{let i=r[e];nx(i)?l[e]=i(t,this._attributeContext,n,this.getDataView()):l[e]=i}),"stroke"in l)bz.includes(null===(o=r.stroke)||void 0===o?void 0:o.gradient)&&(l.stroke=this._computeGradientAttr(r.stroke)(t,n));else{let r=hy(hv(this.model.getColorScheme(),"series"===this.model.modelType?null===(a=(s=this.model).getSpec)||void 0===a?void 0:a.call(s):void 0),this.model.getDefaultColorDomain()),n=e,o=i;if(!(e&&i||"series"!==this.model.modelType)){let{scale:i,field:s}=this.model.getColorAttribute();e||(n=i),o||(o=s),l.stroke=(null==n?void 0:n.scale(t[o]))||r[0]}}return l}}}class Sc extends sW{constructor(t){super({x:0,y:0}),this.type="shadowroot",this.shadowHost=t}addUpdateBoundTag(){super.addUpdateBoundTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}addUpdateShapeAndBoundsTag(){super.addUpdateShapeAndBoundsTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){let e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}doUpdateGlobalMatrix(){if(this.shadowHost){let t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}tryUpdateGlobalAABBBounds(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}function Sp(t){return new Sc(t)}function Sg(){Sg.__loaded||(Sg.__loaded=!0,aj.RegisterGraphicCreator("shadowRoot",Sp))}Sg.__loaded=!1;let Sf=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap",...n4];class Sm extends se{constructor(t){super(t),this.type="arc",this.numberType=sk}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{startAngle:t,endAngle:e,outerRadius:i,innerRadius:r}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)&&this._validNumber(r)}getParsedCornerRadius(){let t=nf(this).arc,{cornerRadius:e=t.cornerRadius,innerPadding:i=t.innerPadding,outerPadding:r=t.outerPadding}=this.attribute,{outerRadius:n=t.outerRadius,innerRadius:s=t.innerRadius}=this.attribute;if(n+=r,s-=i,0===e||"0%"===e)return 0;let a=Math.abs(n-s),o=t=>Math.min(ey(t,!0)?t:a*parseFloat(t)/100,a/2);if(eM(e)){let t=e.map(t=>o(t)||0);return 0===t.length?[t[0],t[0],t[0],t[0]]:2===t.length?[t[0],t[1],t[0],t[1]]:(3===t.length&&t.push(0),t)}return o(e)}getParsedAngle(){let t=nf(this).arc,{startAngle:e=t.startAngle,endAngle:i=t.endAngle}=this.attribute,{cap:r=t.cap}=this.attribute,n=i-e>=0?1:-1,s=i-e;if(i=(e=iw(e))+s,r&&ia(s)<is-1e-12){let s=1,a=1;r.length&&(s=Number(r[0]),a=Number(r[1]));let{outerRadius:o=t.outerRadius,innerRadius:l=t.innerRadius}=this.attribute,{outerPadding:h=t.outerPadding,innerPadding:u=t.innerPadding}=this.attribute;o+=h;let d=Math.abs(o-(l-=u))/2,c=d/o;if(d>1e-12&&o>1e-12)return{startAngle:e-n*c*s,endAngle:i+n*c*a,sc:n*c*s,ec:n*c*a}}return{startAngle:e,endAngle:i}}getParsePadAngle(t,e){let i=nf(this).arc,{innerPadding:r=i.innerPadding,outerPadding:n=i.outerPadding,padAngle:s=i.padAngle}=this.attribute,{outerRadius:a=i.outerRadius,innerRadius:o=i.innerRadius}=this.attribute;a+=n,o-=r;let{padRadius:l=ic(a*a+o*o)}=this.attribute,h=ia(e-t),u=t,d=e,c=t,p=e,g=s/2,f=h,m=h;if(g>1e-12&&l>1e-12){let i=e>t?1:-1,r=im(Number(l)/o*id(g)),n=im(Number(l)/a*id(g));return(f-=2*r)>1e-12?(r*=i,c+=r,p-=r):(f=0,c=p=(t+e)/2),(m-=2*n)>1e-12?(n*=i,u+=n,d-=n):(m=0,u=d=(t+e)/2),{outerStartAngle:u,outerEndAngle:d,innerStartAngle:c,innerEndAngle:p,innerDeltaAngle:f,outerDeltaAngle:m}}return{outerStartAngle:u,outerEndAngle:d,innerStartAngle:c,innerEndAngle:p,innerDeltaAngle:f,outerDeltaAngle:m}}doUpdateAABBBounds(t){let e=nf(this).arc;this._AABBBounds.clear();let i=this.attribute,r=rj.graphicService.updateArcAABBBounds(i,nf(this).arc,this._AABBBounds,t,this),{boundsPadding:n=e.boundsPadding}=i,s=ss(n);return s&&r.expand(s),this.clearUpdateBoundTag(),r}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}needUpdateTags(t){return super.needUpdateTags(t,Sf)}needUpdateTag(t){return super.needUpdateTag(t,Sf)}getDefaultAttribute(t){return nf(this).arc[t]}toCustomPath(){let t=this.attribute,{startAngle:e,endAngle:i}=this.getParsedAngle(),r=t.innerRadius-(t.innerPadding||0),n=t.outerRadius-(t.outerPadding||0),s=ia(i-e),a=i>e;if(n<r){let t=n;n=r,r=t}let o=new rg;if(n<=1e-12)o.moveTo(0,0);else if(s>=is-1e-12)o.moveTo(0+n*il(e),0+n*id(e)),o.arc(0,0,n,e,i,!a),r>1e-12&&(o.moveTo(0+r*il(i),0+r*id(i)),o.arc(0,0,r,i,e,a));else{let t=n*il(e),s=n*id(e),l=r*il(i),h=r*id(i);o.moveTo(0+t,0+s),o.arc(0,0,n,e,i,!a),o.lineTo(0+l,0+h),o.arc(0,0,r,i,e,a),o.closePath()}return o}clone(){return new Sm(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Sm.NOWORK_ANIMATE_ATTR}}function Sv(t){return new Sm(t)}Sm.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},st);class Sy{constructor(){this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}clearCache(t,e){let{CLEAN_THRESHOLD:i=this.CLEAN_THRESHOLD,L_TIME:r=this.L_TIME,R_COUNT:n=this.R_COUNT}=e;if(t.size<i)return 0;let s=0,a=e=>{s++,t.delete(e)},o=Date.now();return t.forEach((t,e)=>{if(t.timestamp.length<n)return a(e);let i=0;for(;o-t.timestamp[t.timestamp.length-1-i]<r&&!(++i>=n););if(i<n)return a(e);for(;o-t.timestamp[0]>r;)t.timestamp.shift()}),s}addLimitedTimestamp(t,e,i){let{R_TIMESTAMP_MAX_SIZE:r=this.R_TIMESTAMP_MAX_SIZE}=i;t.timestamp.length>r&&t.timestamp.shift(),t.timestamp.push(e)}clearTimeStamp(t,e){let{L_TIME:i=this.L_TIME}=e,r=Date.now();t.forEach(t=>{for(;r-t.timestamp[0]>i;)t.timestamp.shift()})}clearItemTimestamp(t,e){let{L_TIME:i=this.L_TIME}=e,r=Date.now();for(;r-t.timestamp[0]>i;)t.timestamp.shift()}}class S_{static GetCanvas(){try{return S_.canvas||(S_.canvas=rj.global.createCanvas({})),S_.canvas}catch(t){return null}}static GetCtx(){if(!S_.ctx){let t=S_.GetCanvas();S_.ctx=t.getContext("2d")}return S_.ctx}}class Sb extends Sy{static getInstance(){return Sb._instance||(Sb._instance=new Sb),Sb._instance}constructor(t=[],e=100){super(),this.cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},this.dataMap=new Map;let i=S_.GetCanvas(),r=S_.GetCtx();if(i.width=e,i.height=1,!r)return;if(r.translate(0,0),!r)throw Error("\u83B7\u53D6ctx\u53D1\u751F\u9519\u8BEF");let n=r.createLinearGradient(0,0,e,0);t.forEach(t=>{n.addColorStop(t[0],t[1])}),r.fillStyle=n,r.fillRect(0,0,e,1),this.rgbaSet=r.getImageData(0,0,e,1).data}getColor(t){let e=this.rgbaSet.slice(4*t,4*t+4);return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]/255})`}GetOrCreate(t,e,i,r,n=[],s=100){let a=`${t}${e}${i}${r}`;n.forEach(t=>a+=t.join()),a+=s;let o=this.dataMap.get(a);return!o&&(o={data:new Sb(n,s),timestamp:[]},this.addLimitedTimestamp(o,Date.now(),{}),this.dataMap.set(a,o)),this.clearCache(this.dataMap,this.cacheParams),o.data}}class Sx{static GetSize(t){for(let e=0;e<Sx.ImageSize.length;e++)if(Sx.ImageSize[e]>=t)return Sx.ImageSize[e];return t}static Get(t,e,i,r,n,s,a){let o=Sx.GenKey(t,e,i,r,n),l=Sx.cache[o];if(!l||0===l.length)return null;for(let t=0;t<l.length;t++)if(l[t].width>=s&&l[t].height>=a)return l[t].pattern;return null}static Set(t,e,i,r,n,s,a,o){let l=Sx.GenKey(t,e,i,r,n);Sx.cache[l]?Sx.cache[l].push({width:a,height:o,pattern:s}):Sx.cache[l]=[{width:a,height:o,pattern:s}]}static GenKey(t,e,i,r,n){return`${e},${i},${r},${n},${t.join()}`}}Sx.cache={},Sx.ImageSize=[20,40,80,160,320,640,1280,2560];let SS=new class t{constructor(){this.time=lP.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,a,o,l,h,u,d){let{outerBorder:c,innerBorder:p}=t.attribute,g=c&&!1!==c.visible,f=p&&!1!==p.visible;if(!g&&!f)return;let{innerPadding:m=l.innerPadding,outerPadding:v=l.outerPadding,startAngle:y=l.startAngle,endAngle:_=l.endAngle,opacity:b=l.opacity,x:x=l.x,y:S=l.y,scaleX:k=l.scaleX,scaleY:A=l.scaleY}=t.attribute,{innerRadius:w=l.innerRadius,outerRadius:M=l.outerRadius}=t.attribute;M+=v,w-=m;let C=!(!c||!c.stroke),T=!(!p||!p.stroke);if(g){let{distance:n=l.outerBorder.distance}=c,s=od(e,n,e.dpr),a=n/M;if(t.setAttributes({outerRadius:M+s,innerRadius:w-s,startAngle:y-a,endAngle:_+a}),e.beginPath(),oB(t,e,i,r,M+s,w-s),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),d)d(e,c,l.outerBorder);else if(C){let n=l.outerBorder.opacity;l.outerBorder.opacity=b,e.setStrokeStyle(t,c,(x-i)/k,(S-r)/A,l.outerBorder),l.outerBorder.opacity=n,e.stroke()}}if(f){let{distance:n=l.innerBorder.distance}=p,s=od(e,n,e.dpr),a=n/M;if(t.setAttributes({outerRadius:M-s,innerRadius:w+s,startAngle:y+a,endAngle:_-a}),e.beginPath(),oB(t,e,i,r,M-s,w+s),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),d)d(e,p,l.innerBorder);else if(T){let n=l.innerBorder.opacity;l.innerBorder.opacity=b,e.setStrokeStyle(t,p,(x-i)/k,(S-r)/A,l.innerBorder),l.innerBorder.opacity=n,e.stroke()}}t.setAttributes({outerRadius:M,innerRadius:w,startAngle:y,endAngle:_})}};var Sk=function(t,e){return function(i,r){e(i,r,t)}};let SA=class extends oQ{constructor(t){super(),this.arcRenderContribitions=t,this.numberType=sk,this.builtinContributions=[SS,oY,o6],this.init(t)}drawArcTailCapPath(t,e,i,r,n,s,a,o){let l,h,u,d;let c=o-a,p=t.getParsedAngle(),g=p.startAngle,f=p.endAngle,m=ia((f=o)-g),v=f>g,y=!1;if(n<s){let t=n;n=s,s=t}let _=t.getParsedCornerRadius(),b=eM(_),{outerDeltaAngle:x,innerDeltaAngle:S,outerStartAngle:k,outerEndAngle:A,innerEndAngle:w,innerStartAngle:M}=t.getParsePadAngle(g,f),C=b?_[0]:_,T=b?_[1]:_,E=b?_[2]:_,O=b?_[3]:_,P=Math.max(T,C),R=Math.max(E,O),B=P,I=R,L=n*il(k),D=n*id(k),F=s*il(w),j=s*id(w);if((R>1e-12||P>1e-12)&&(l=n*il(A),h=n*id(A),u=s*il(M),d=s*id(M),m<ie)){let t=oP(L,D,u,d,l,h,F,j);if(t){let e=L-t[0],i=D-t[1],r=l-t[0],a=h-t[1],o=1/id(ig((e*r+i*a)/(ic(e*e+i*i)*ic(r*r+a*a)))/2),u=ic(t[0]*t[0]+t[1]*t[1]);I=iu(R,(s-u)/(o-1)),B=iu(P,(n-u)/(o+1))}}if(B>1e-12){let t=iu(C,B),s=iu(T,B),a=oR(u,d,L,D,n,t,Number(v)),o=oR(l,h,F,j,n,s,Number(v));if(B<P&&t===s)e.moveTo(i+a.cx+a.x01,r+a.cy+a.y01),e.arc(i+a.cx,r+a.cy,B,io(a.y01,a.x01),io(o.y01,o.x01),!v);else{let t=f-c-.03,a=io(o.y11,o.x11);e.arc(i,r,n,t,a,!v),s>0&&e.arc(i+o.cx,r+o.cy,s,io(o.y11,o.x11),io(o.y01,o.x01),!v)}}else e.moveTo(i+L,r+D);if(!(s>1e-12)||S<.001)e.lineTo(i+F,r+j),y=!0;else if(I>1e-12){let t=iu(O,I),n=iu(E,I),a=oR(F,j,l,h,s,-n,Number(v)),o=oR(L,D,u,d,s,-t,Number(v));if(e.lineTo(i+a.cx+a.x01,r+a.cy+a.y01),I<R&&t===n){let t=io(o.y01,o.x01);e.arc(i+a.cx,r+a.cy,I,io(a.y01,a.x01),t,!v)}else{n>0&&e.arc(i+a.cx,r+a.cy,n,io(a.y01,a.x01),io(a.y11,a.x11),!v);let t=io(a.cy+a.y11,a.cx+a.x11),o=f-c-.03;e.arc(i,r,s,t,o,v)}}else e.lineTo(i+s*il(M),r+s*id(M));return y}drawShape(t,e,i,r,n,s,a,o){let l=nf(t,null==s?void 0:s.theme).arc,{fill:h=l.fill,stroke:u=l.stroke,x:d=l.x,y:c=l.y}=t.attribute,p=this.valid(t,l,a,o);if(!p)return;let{fVisible:g,sVisible:f,doFill:m,doStroke:v}=p,{outerPadding:y=l.outerPadding,innerPadding:_=l.innerPadding,cap:b=l.cap,forceShowCap:x=l.forceShowCap}=t.attribute,{outerRadius:S=l.outerRadius,innerRadius:k=l.innerRadius}=t.attribute;S+=y,k-=_;let A=0,w=(ew(b)&&b||b[0])&&"conical"===h.gradient;if(w){let{sc:e,startAngle:i,endAngle:r}=t.getParsedAngle();ia(r-i)<is-1e-12&&(A=e||0,h.startAngle-=A,h.endAngle-=A)}let M=!1,{isFullStroke:C,stroke:T}=sr(u);if((m||C)&&(e.beginPath(),oB(t,e,i,r,S,k),M=!0,e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,r,m,v,g,f,l,n,a,o),m&&(a?a(e,t.attribute,l):g&&(e.setCommonStyle(t,t.attribute,d-i,c-r,l),e.fill())),v&&C&&(o?o(e,t.attribute,l):f&&(e.setStrokeStyle(t,t.attribute,d-i,c-r,l),e.stroke()))),!C&&v&&(e.beginPath(),oB(t,e,i,r,S,k,T),M||this.beforeRenderStep(t,e,i,r,m,v,g,f,l,n,a,o),o?o(e,t.attribute,l):f&&(e.setStrokeStyle(t,t.attribute,i,r,l),e.stroke())),(ew(b)&&b||b[1])&&x){let{startAngle:s,endAngle:h}=t.getParsedAngle();if(ia(h-s)>=is-1e-12){e.beginPath();let s=Math.abs(S-k)/2/S,{endAngle:h=l.endAngle,fill:u=l.fill}=t.attribute;if(this.drawArcTailCapPath(t,e,i,r,S,k,h,h+s),M||this.beforeRenderStep(t,e,i,r,m,v,g,f,l,n,a,o),m&&"conical"===u.gradient){let n=function(t,e,i,r){let{stops:n,startAngle:s,endAngle:a}=r;for(;i<0;)i+=is;for(;i>is;)i-=is;if(i<s||i>a)return n[0].color;let o,l,h=(i-s)/(a-s);for(let t=0;t<n.length;t++)if(n[t].offset>=h){o=n[t-1],l=n[t];break}return h=(h-o.offset)/(l.offset-o.offset),nX(o.color,l.color,h,!1)}(0,0,h,u);a||oC&&(e.setCommonStyle(t,t.attribute,i,r,l),e.fillStyle=n,e.fill())}v&&(o||f&&(e.setStrokeStyle(t,t.attribute,i,r,l),e.stroke()))}}this.afterRenderStep(t,e,i,r,m,v,g,f,l,n,a,o),w&&(h.startAngle+=A,h.endAngle+=A)}draw(t,e,i,r){let n=nf(t,null==r?void 0:r.theme).arc;this._draw(t,n,!1,i,r)}};SA=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),Sk(0,e0(e2)),Sk(0,e1(oI)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],SA);let Sw=!1,SM=new eW(t=>{Sw||(Sw=!0,t(SA).toSelf().inSingletonScope(),t(s1).to(SA).inSingletonScope(),t(s4).toService(s1),t(oI).toService(oK),e5(t,oI))}),SC=class{constructor(t){this.canvasRenderer=t,this.type="arc",this.numberType=sk}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).arc;r.highPerformanceSave();let{x:s=n.x,y:a=n.y}=t.attribute;if(t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let o=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,i,r)=>!!o||(o=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(o)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=od(r,s+a,r.dpr),o=t.isPointInStroke(e.x,e.y)}),r.highPerformanceRestore(),o}};SC=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(N=0,z=e0(s1),function(t,e){z(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],SC);let ST=!1,SE=new eW((t,e,i,r)=>{ST||(ST=!0,t(yb).to(SC).inSingletonScope(),t(yD).toService(yb))}),SO=class{constructor(t){this.canvasRenderer=t,this.type="arc",this.numberType=sk}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).arc;r.highPerformanceSave();let{x:s=n.x,y:a=n.y}=t.attribute;if(t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let o=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,i,r)=>!!o||(o=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(o)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=s+a,o=t.isPointInStroke(e.x,e.y)}),r.highPerformanceRestore(),o}};SO=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(H=0,V=e0(s1),function(t,e){V(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],SO);let SP=!1,SR=new eW((t,e,i,r)=>{SP||(SP=!0,t(yh).to(SO).inSingletonScope(),t(yl).toService(yh))});function SB(){SB.__loaded||(SB.__loaded=!0,aj.RegisterGraphicCreator("arc",Sv),r4.load(SM),r4.load(yo?SE:SR))}SB.__loaded=!1;class SI extends Sm{constructor(t){super(t),this.type="arc3d",this.numberType=sA}doUpdateAABBBounds(){let t=nf(this).arc;this._AABBBounds.clear();let e=this.attribute,i=rj.graphicService.updateArc3dAABBBounds(e,nf(this).polygon,this._AABBBounds,this),{boundsPadding:r=t.boundsPadding}=e,n=ss(r);return n&&i.expand(n),this.clearUpdateBoundTag(),this._AABBBounds}getNoWorkAnimateAttr(){return SI.NOWORK_ANIMATE_ATTR}}function SL(t){return new SI(t)}SI.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},st);let SD=class extends oQ{constructor(){super(...arguments),this.numberType=sA}drawShape(t,e,i,r,n,s,a,o){var l;let h=nf(t,null==s?void 0:s.theme).arc,{fill:u=h.fill}=t.attribute,d=this.valid(t,h,a,o);if(!d)return;let{fVisible:c,sVisible:p,doFill:g,doStroke:f}=d,m=null!==(l=this.z)&&void 0!==l?l:0,{outerPadding:v=h.outerPadding,innerPadding:y=h.innerPadding,height:_=10}=t.attribute,{outerRadius:b=h.outerRadius,innerRadius:x=h.innerRadius}=t.attribute;b+=v,x-=y;let S=nK.Get(u,lB.Color255),{light:k}=n.stage||{},A=n.hack_pieFace,w={top:m,bottom:m+_},M={top:[0,1,0],bottom:[0,-1,0],outside:[1,0,-1],inside:[1,0,-1]};"bottom"===A||"top"===A?(e.beginPath(),function(t,e,i,r,n,s,a){let{startAngle:o,endAngle:l}=t.getParsedAngle(),h=ia(l-o),u=l>o,d=!1;if(s<a){let t=s;s=a,a=t}if(s<=1e-12)e.moveTo(i,r,n);else if(h>=is-1e-12)e.moveTo(i+s*il(o),r+s*id(o),n),e.arc(i,r,s,o,l,!u,n),a>1e-12&&(e.moveTo(i+a*il(l),r+a*id(l),n),e.arc(i,r,a,l,o,u,n));else{let{outerDeltaAngle:h,innerDeltaAngle:c,outerStartAngle:p,outerEndAngle:g,innerEndAngle:f,innerStartAngle:m}=t.getParsePadAngle(o,l),v=s*il(p),y=s*id(p),_=a*il(f),b=a*id(f);h<.001?d=!0:(e.moveTo(i+v,r+y,n),e.arc(i,r,s,p,g,!u,n)),!(a>1e-12)||c<.001?(e.lineTo(i+_,r+b,n),d=!0):(e.lineTo(i+_,r+b,n),e.arc(i,r,a,f,m,u,n))}e.closePath()}(t,e,i,r,w[A],b,x),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),g&&(a?a(e,t.attribute,h):c&&(e.setCommonStyle(t,t.attribute,i,r,h),e.fillStyle=k?k.computeColor(M[A],S):u,e.fill())),f&&(o?o(e,t.attribute,h):p&&(e.setStrokeStyle(t,t.attribute,i,r,h),e.stroke()))):"outside"!==A&&"inside"!==A||("inside"===A&&(e.save(),e.beginPath(),e.arc(i,r,x,0,is,!0,w.top),e.clip()),e.beginPath(),function(t,e,i,r,n,s,a,o){let{startAngle:l,endAngle:h}=t.getParsedAngle(),u=ia(h-l),d=h>l,c=!1;if(a<=1e-12)e.moveTo(i,r,n);else if(u>=is-1e-12)e.moveTo(i+a*il(l),r+a*id(l),n),e.arc(i,r,a,l,h,!d,n),e.lineTo(i+a*il(h),r+a*id(h),s),e.arc(i,r,a,h,l,d,s);else{let{innerouterDeltaAngle:t,innerouterStartAngle:u,innerouterEndAngle:p}=o(l,h),g=a*il(u),f=a*id(u),m=a*il(p),v=a*id(p);t<.001?c=!0:(e.moveTo(i+g,r+f,n),e.arc(i,r,a,u,p,!d,n),e.lineTo(i+m,r+v,s),e.arc(i,r,a,p,u,d,s))}e.closePath()}(t,e,i,r,w.top,w.bottom,"outside"===A?b:x,(e,i)=>{let{outerDeltaAngle:r,innerDeltaAngle:n,outerStartAngle:s,outerEndAngle:a,innerEndAngle:o,innerStartAngle:l}=t.getParsePadAngle(e,i);return"outside"===A?{innerouterDeltaAngle:r,innerouterEndAngle:a,innerouterStartAngle:s}:{innerouterDeltaAngle:n,innerouterEndAngle:o,innerouterStartAngle:l}}),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),g&&(a?a(e,t.attribute,h):c&&(e.setCommonStyle(t,t.attribute,i,r,h),e.fillStyle=k?k.computeColor(M[A],S):u,e.fill())),f&&(o?o(e,t.attribute,h):p&&(e.setStrokeStyle(t,t.attribute,i,r,h),e.stroke())),"inside"===A&&e.restore())}draw(t,e,i,r){let n=nf(t,null==r?void 0:r.theme).arc;this._draw(t,n,!1,i,r)}};SD=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],SD);let SF=!1,Sj=new eW(t=>{SF||(SF=!0,t(s2).to(SD).inSingletonScope(),t(s4).toService(s2))}),SN=class extends yF{constructor(t){super(),this.canvasRenderer=t,this.type="arc3d",this.numberType=sA}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).arc;r.highPerformanceSave();let{x:s,y:a,z:o,lastModelMatrix:l}=this.transform(t,n,r),h=e;if(r.camera){h=e.clone();let i=t.parent.globalTransMatrix;h.x=i.a*e.x+i.c*e.y+i.e,h.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=o;let u=!1;return this.canvasRenderer.drawShape(t,r,s,a,i,null,(t,e,i)=>!!u||(u=t.isPointInPath(h.x,h.y))),this.canvasRenderer.z=0,r.modelMatrix!==l&&av.free(r.modelMatrix),r.modelMatrix=l,r.highPerformanceRestore(),u}};SN=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(W=0,G=e0(s2),function(t,e){G(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],SN);let Sz=!1,SH=new eW((t,e,i,r)=>{Sz||(Sz=!0,t(yx).to(SN).inSingletonScope(),t(yD).toService(yx))});function SV(){SV.__loaded||(SV.__loaded=!0,aj.RegisterGraphicCreator("arc3d",SL),r4.load(Sj),r4.load(SH))}SV.__loaded=!1;let SW=["points","cornerRadius",...n4];class SG extends se{constructor(t){super(t),this.type="polygon",this.numberType=sR}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{points:t}=this.attribute;return t&&t.length>=2}doUpdateAABBBounds(){let t=nf(this).polygon;this._AABBBounds.clear();let e=this.attribute,i=rj.graphicService.updatePolygonAABBBounds(e,nf(this).polygon,this._AABBBounds,this),{boundsPadding:r=t.boundsPadding}=e,n=ss(r);return n&&i.expand(n),this.clearUpdateBoundTag(),this._AABBBounds}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}_interpolate(t,e,i,r,n){"points"===t&&(n.points=su(i,r,e))}getDefaultAttribute(t){return nf(this).polygon[t]}needUpdateTags(t){return super.needUpdateTags(t,SW)}needUpdateTag(t){return super.needUpdateTag(t,SW)}toCustomPath(){let t=this.attribute.points,e=new rg;return t.forEach((t,i)=>{0===i?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y)}),e.closePath(),e}clone(){return new SG(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return SG.NOWORK_ANIMATE_ATTR}}function SU(t){return new SG(t)}SG.NOWORK_ANIMATE_ATTR=st;class S$ extends SG{constructor(t){super(t),this.type="pyramid3d",this.numberType=sB}doUpdateAABBBounds(){let t=nf(this).polygon;this._AABBBounds.clear();let e=this.attribute,i=rj.graphicService.updatePyramid3dAABBBounds(e,nf(this).polygon,this._AABBBounds,this),{boundsPadding:r=t.boundsPadding}=e,n=ss(r);return n&&i.expand(n),this.clearUpdateBoundTag(),this._AABBBounds}findFace(){let{points:t}=this.attribute,e=t.map((e,i)=>{let r=3===i?t[0]:t[i+1],n=e.x-r.x;return 0===n?0:(e.y-r.y)/n}),i=t.map(t=>({p:t,d:0})),r=!1,n=0;for(let t=0;t<e.length-1;t++){for(let s=t+1;s<e.length;s++){if(e[t]===e[s]){r=!0;let e=iG.distancePP(i[t].p,i[t+1].p);i[t].d=e,i[t+1].d=e,n=ih(n,e);let a=iG.distancePP(i[s].p,i[s+1].p);i[s].d=a,i[s+1].d=a,n=ih(n,a)}if(r)break}if(r)break}for(let e=t.length-1;e>=0;e--){let r=t[e];i.unshift({p:r,d:0})}for(let e=0;e<t.length;e++){let r=(n-i[e+t.length].d)/2;i[e].d+=r,i[e+t.length].d+=r}let s={polygons:[],vertices:[],edges:[]};return i.forEach(t=>{s.vertices.push([t.p.x,t.p.y,t.d])}),s.polygons.push({polygon:[0,4,5,1],normal:[0,-1,0]}),s.polygons.push({polygon:[7,6,2,3],normal:[0,1,0]}),s.polygons.push({polygon:[0,4,7,3],normal:[-1,0,0]}),s.polygons.push({polygon:[1,5,6,2],normal:[1,0,0]}),s.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),s.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),s.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],s}_isValid(){return super._isValid()&&4===this.attribute.points.length}getNoWorkAnimateAttr(){return S$.NOWORK_ANIMATE_ATTR}}function SY(t){return new S$(t)}S$.NOWORK_ANIMATE_ATTR=st;let SK=class extends oQ{constructor(){super(...arguments),this.type="pyramid3d",this.numberType=sB}drawShape(t,e,i,r,n,s,a,o){var l;let h=nf(t,null==s?void 0:s.theme).polygon,{fill:u=h.fill,stroke:d=h.stroke,face:c=[!0,!0,!0,!0,!0,!0]}=t.attribute,p=null!==(l=this.z)&&void 0!==l?l:0;if(!this.valid(t,h,a,o))return;let{light:g,camera:f}=n.stage||{},m=t.findFace();if(!1!==u){e.setCommonStyle(t,t.attribute,i,r,h);let n=u;"string"!=typeof n&&(n="black"),this.fill(i,r,p,m,c,n,e,g,f,t,h,a)}!1!==d&&(e.setStrokeStyle(t,t.attribute,i,r,h),this.stroke(i,r,p,m,e))}stroke(t,e,i,r,n){let s=r.vertices;r.edges.forEach(r=>{let a=s[r[0]],o=s[r[1]],l={x:t+a[0],y:e+a[1],z:i+a[2]},h={x:t+o[0],y:e+o[1],z:i+o[2]};n.beginPath(),n.moveTo(l.x,l.y,l.z),n.lineTo(h.x,h.y,h.z),n.stroke()})}fill(t,e,i,r,n,s,a,o,l,h,u,d){let c=nK.Get(s,lB.Color255),p=r.vertices,g=p.map(t=>a.view(t[0],t[1],t[2])[2]),f=[];r.polygons.forEach((t,e)=>{if(!n[e])return;f.push({faceIdx:e,polygon:t});let{polygon:i,normal:r}=t,s=g[i[0]],a=g[i[1]],o=g[i[2]],l=g[i[3]];t.ave_z=s+a+o+l}),f.sort((t,e)=>e.polygon.ave_z-t.polygon.ave_z),f.forEach(r=>{let{polygon:n,normal:l}=r.polygon,g=p[n[0]],f=p[n[1]],m=p[n[2]],v=p[n[3]],y={x:t+g[0],y:e+g[1],z:i+g[2]},_={x:t+f[0],y:e+f[1],z:i+f[2]},b={x:t+m[0],y:e+m[1],z:i+m[2]},x={x:t+v[0],y:e+v[1],z:i+v[2]};a.beginPath(),a.moveTo(y.x,y.y,y.z),a.lineTo(_.x,_.y,_.z),a.lineTo(b.x,b.y,b.z),a.lineTo(x.x,x.y,x.z),a.closePath(),d?d(a,h.attribute,u):(a.fillStyle=o?o.computeColor(l,c):s,a.fill())})}draw(t,e,i){let r=nf(t).polygon;this._draw(t,r,!1,i)}};SK=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],SK);let SZ=!1,SX=new eW(t=>{SZ||(SZ=!0,t(as).to(SK).inSingletonScope(),t(s4).toService(as))}),Sq=class extends yF{constructor(t){super(),this.canvasRenderer=t,this.type="pyramid3d",this.numberType=sB}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).polygon;r.highPerformanceSave();let{x:s,y:a,z:o,lastModelMatrix:l}=this.transform(t,n,r),h=e;if(r.camera){h=e.clone();let i=t.parent.globalTransMatrix;h.x=i.a*e.x+i.c*e.y+i.e,h.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=o;let u=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,e,i)=>!!u||(u=t.isPointInPath(h.x,h.y)),(t,e,i)=>!1),this.canvasRenderer.z=0,r.modelMatrix!==l&&av.free(r.modelMatrix),r.modelMatrix=l,r.highPerformanceRestore(),u}};Sq=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(U=0,$=e0(as),function(t,e){$(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Sq);let SJ=!1,SQ=new eW((t,e,i,r)=>{SJ||(SJ=!0,t(yR).to(Sq).inSingletonScope(),t(yD).toService(yR))});function S0(){S0.__loaded||(S0.__loaded=!0,aj.RegisterGraphicCreator("pyramid3d",SY),r4.load(SX),r4.load(SQ))}S0.__loaded=!1;let S1=["segments","points","curveType","curveTension",...n4];class S2 extends se{constructor(t){super(t),this.type="area",this.numberType=sw}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;let{points:t,segments:e}=this.attribute;return e?0!==e.length:!!t&&0!==t.length}doUpdateAABBBounds(){let t=nf(this).area;this._AABBBounds.clear();let e=this.attribute,i=rj.graphicService.updateAreaAABBBounds(e,nf(this).area,this._AABBBounds,this),{boundsPadding:r=t.boundsPadding}=e,n=ss(r);return n&&i.expand(n),this.clearUpdateBoundTag(),i}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}_interpolate(t,e,i,r,n){"points"===t&&(n.points=su(i,r,e))}getDefaultAttribute(t){return nf(this).area[t]}needUpdateTags(t){return super.needUpdateTags(t,S1)}needUpdateTag(t){return super.needUpdateTag(t,S1)}toCustomPath(){let t=new rg,e=this.attribute,i=e.segments,r=e=>{if(e&&e.length){let i=!0,r=[];if(e.forEach(e=>{var n,s;!1!==e.defined&&(i?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y),r.push({x:null!==(n=e.x1)&&void 0!==n?n:e.x,y:null!==(s=e.y1)&&void 0!==s?s:e.y}),i=!1)}),r.length){for(let e=r.length-1;e>=0;e--)t.lineTo(r[e].x,r[e].y);t.closePath()}}};return e.points?r(e.points):i&&i.length&&i.forEach(t=>{r(t.points)}),t}clone(){return new S2(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return S2.NOWORK_ANIMATE_ATTR}}function S3(t){return new S2(t)}S2.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},st);let S5=!1,S4=new eW(t=>{S5||(S5=!0,t(le).toSelf().inSingletonScope(),t(s3).to(le).inSingletonScope(),t(s4).toService(s3),t(oL).toService(oK),e5(t,oL),t(li).toSelf().inSingletonScope())}),S8=class{constructor(t){this.canvasRenderer=t,this.type="area",this.numberType=sw}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).area,{x:s=n.x,y:a=n.y}=t.attribute,{fillPickable:o=n.fillPickable,strokePickable:l=n.strokePickable}=t.attribute;if(r.highPerformanceSave(),t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let h=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,t=>!!h||!!o&&(h=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(h)return!0;if(!l)return!1;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=od(r,s+a,r.dpr),h=t.isPointInStroke(e.x,e.y)}),r.highPerformanceRestore(),h}};S8=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(Y=0,K=e0(s3),function(t,e){K(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],S8);let S6=!1,S9=new eW((t,e,i,r)=>{S6||(S6=!0,t(yS).to(S8).inSingletonScope(),t(yD).toService(yS))}),S7=class{constructor(t){this.canvasRenderer=t,this.type="area",this.numberType=sw}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).area,{x:s=n.x,y:a=n.y}=t.attribute;if(r.highPerformanceSave(),t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let o=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,t=>!!o||(o=t.isPointInPath(e.x,e.y))),r.highPerformanceRestore(),o}};S7=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(Z=0,X=e0(s3),function(t,e){X(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],S7);let kt=!1,ke=new eW((t,e,i,r)=>{kt||(kt=!0,t(yu).to(S7).inSingletonScope(),t(yl).toService(yu))});function ki(){ki.__loaded||(ki.__loaded=!0,aj.RegisterGraphicCreator("area",S3),r4.load(S4),r4.load(yo?S9:ke))}ki.__loaded=!1;let kr=["width","height","image",...n4];class kn extends se{constructor(t){super(t),this.type="image",this.numberType=sE,this.loadImage(this.attribute.image)}get width(){var t;return null!==(t=this.attribute.width)&&void 0!==t?t:0}set width(t){this.attribute.width===t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}get height(){var t;return null!==(t=this.attribute.height)&&void 0!==t?t:0}set height(t){this.attribute.height===t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}get repeatX(){var t;return null!==(t=this.attribute.repeatX)&&void 0!==t?t:"no-repeat"}set repeatX(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}get repeatY(){var t;return null!==(t=this.attribute.repeatY)&&void 0!==t?t:"no-repeat"}set repeatY(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}get image(){return this.attribute.image}set image(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}imageLoadSuccess(t,e,i){super.imageLoadSuccess(t,e,()=>{this.successCallback&&this.successCallback()})}imageLoadFail(t,e){super.imageLoadFail(t,()=>{this.failCallback&&this.failCallback()})}setAttributes(t,e,i){return t.image&&this.loadImage(t.image),super.setAttributes(t,e,i)}setAttribute(t,e,i,r){return"image"===t&&this.loadImage(e),super.setAttribute(t,e,i,r)}doUpdateAABBBounds(){let t=nf(this).image;this._AABBBounds.clear();let e=this.attribute,i=rj.graphicService.updateImageAABBBounds(e,nf(this).image,this._AABBBounds,this),{boundsPadding:r=t.boundsPadding}=e,n=ss(r);return n&&i.expand(n),this.clearUpdateBoundTag(),i}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}getDefaultAttribute(t){return rD[t]}needUpdateTags(t){return super.needUpdateTags(t,kr)}needUpdateTag(t){return super.needUpdateTag(t,kr)}clone(){return new kn(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return kn.NOWORK_ANIMATE_ATTR}}function ks(t){return new kn(t)}kn.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},st);let ka=new class t extends _6{constructor(){super(...arguments),this.time=lP.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,a,o,l,h,u,d){return super.drawShape(t,e,i,r,n,s,a,o,l,h,u,d)}},ko=new class t extends o${constructor(){super(...arguments),this.time=lP.beforeFillStroke}drawShape(t,e,i,r,n,s,a,o,l,h,u,d){let{background:c,backgroundMode:p=l.backgroundMode,backgroundFit:g=l.backgroundFit}=t.attribute;if(c){if(t.backgroundImg){let i=t.resources.get(c);if("success"!==i.state||!i.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){let i=nf(t.parent).group,{scrollX:r=i.scrollX,scrollY:n=i.scrollY}=t.parent.attribute;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(r,n)}let r=t.AABBBounds;this.doDrawImage(e,i.data,r,p,g),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else if(nb(c)){let{stroke:i,fill:r,lineWidth:n=1,cornerRadius:s=0,expandX:a=0,expandY:o=0}=c;if(!i&&!r)return;e.beginPath();let{x:l,y:h,width:u,height:d}=function(t){let e=ss(t.attribute.boundsPadding),i=t.AABBBounds,r=i.x1,n=i.y1,s=i.width(),a=i.height();return ey(e)?(r+=e,n+=e,s-=2*e,a-=2*e):(r+=e[3],n+=e[0],s-=e[1]+e[3],a-=e[0]+e[2]),{x:r,y:n,width:s,height:a}}(t);s?oA(e,l-a,h-o,u+2*a,d+2*o,s):e.rect(l-a,h-o,u+2*a,d+2*o),e.globalAlpha=1,r&&(e.fillStyle=r,e.fill()),i&&n>0&&(e.lineWidth=n,e.strokeStyle=i,e.stroke())}else{e.beginPath();let n=t.AABBBounds;e.rect(i,r,n.width(),n.height()),e.fillStyle=c,e.globalAlpha=1,e.fill()}}}};var kl=function(t,e){return function(i,r){e(i,r,t)}};let kh=["","repeat-x","repeat-y","repeat"],ku=class extends oQ{constructor(t){super(),this.imageRenderContribitions=t,this.numberType=sE,this.builtinContributions=[ka,ko],this.init(t)}drawShape(t,e,i,r,n,s,a,o){let l=nf(t).image,{width:h=l.width,height:u=l.height,repeatX:d=l.repeatX,repeatY:c=l.repeatY,x:p=l.x,y:g=l.y,cornerRadius:f=l.cornerRadius,image:m}=t.attribute,v=this.valid(t,l,a);if(!v)return;let{fVisible:y,sVisible:_,doFill:b,doStroke:x}=v;if(e.setShadowBlendStyle&&e.setShadowBlendStyle(t,l),this.beforeRenderStep(t,e,i,r,b,!1,y,!1,l,n,a),b){if(a)a(e,t.attribute,l);else if(y){if(!m||!t.resources)return;let n=t.resources.get(m);if("success"!==n.state)return;let s=!1;0===f||eM(f)&&f.every(t=>0===t)||(e.beginPath(),oA(e,i,r,h,u,f),e.save(),e.clip(),s=!0),e.setCommonStyle(t,t.attribute,i,r,l);let a=0;if("repeat"===d&&(a|=1),"repeat"===c&&(a|=2),a){let t=e.createPattern(n.data,kh[a]);e.fillStyle=t,e.translate(i,r,!0),e.fillRect(0,0,h,u),e.translate(-i,-r,!0)}else e.drawImage(n.data,i,r,h,u);s&&e.restore()}}x&&(o?o(e,t.attribute,l):_&&(e.setStrokeStyle(t,t.attribute,p-i,g-r,l),e.stroke())),this.afterRenderStep(t,e,i,r,b,!1,y,!1,l,n,a)}draw(t,e,i){let{image:r}=t.attribute;if(!r||!t.resources)return;let n=t.resources.get(r);if("loading"===n.state&&eE(r))return void n1.improveImageLoading(r);if("success"!==n.state)return;let{context:s}=e.drawParams;if(!s)return;let a=nf(t).image;this._draw(t,a,!1,i)}};ku=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),kl(0,e0(e2)),kl(0,e1(oj)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],ku);let kd=!1,kc=new eW(t=>{kd||(kd=!0,t(ao).to(ku).inSingletonScope(),t(s4).toService(ao),t(oj).toService(oK),e5(t,oj))}),kp=class{constructor(){this.type="image",this.numberType=sE}contains(t,e,i){let{pickContext:r}=null!=i?i:{};return!!r&&!!t.AABBBounds.containsPoint(e)}};kp=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],kp);let kg=!1,kf=new eW((t,e,i,r)=>{kg||(kg=!0,t(yA).to(kp).inSingletonScope(),t(yD).toService(yA))}),km=class{constructor(){this.type="image",this.numberType=sE}contains(t,e,i){let{pickContext:r}=null!=i?i:{};return!!r&&!!t.AABBBounds.containsPoint(e)}};km=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],km);let kv=!1,ky=new eW((t,e,i,r)=>{kv||(kv=!0,t(yc).to(km).inSingletonScope(),t(km).toService(yc))});function k_(){k_.__loaded||(k_.__loaded=!0,aj.RegisterGraphicCreator("image",ks),r4.load(kc),r4.load(yo?kf:ky))}k_.__loaded=!1;let kb=["segments","points","curveType","curveTension",...n4];class kx extends se{constructor(t={}){super(t),this.type="line",this.numberType=sO}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;let{points:t,segments:e}=this.attribute;return e?0!==e.length:!!t&&!(t.length<=1)}_interpolate(t,e,i,r,n){"points"===t&&(n.points=su(i,r,e))}doUpdateAABBBounds(){let t=nf(this).line;this._AABBBounds.clear();let e=this.attribute,i=rj.graphicService.updateLineAABBBounds(e,nf(this).line,this._AABBBounds,this),{boundsPadding:r=t.boundsPadding}=e,n=ss(r);return n&&i.expand(n),this.clearUpdateBoundTag(),i}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}getDefaultAttribute(t){return nf(this).line[t]}needUpdateTags(t){return super.needUpdateTags(t,kb)}needUpdateTag(t){return super.needUpdateTag(t,kb)}toCustomPath(){let t=this.attribute,e=new rg,i=t.segments,r=t=>{if(t&&t.length){let i=!0;t.forEach(t=>{!1!==t.defined&&(i?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y),i=!1)})}};return i&&i.length?i.forEach(t=>{r(t.points)}):t.points&&r(t.points),e}clone(){return new kx(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return kx.NOWORK_ANIMATE_ATTR}}function kS(t){return new kx(t)}kx.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},st);let kk=!1,kA=new eW(t=>{kk||(kk=!0,t(o2).toSelf().inSingletonScope(),t(o3).toSelf().inSingletonScope(),t(s6).to(o2).inSingletonScope(),t(s4).toService(s6))}),kw=class extends yF{constructor(t){super(),this.canvasRenderer=t,this.type="line",this.numberType=sO}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;r.highPerformanceSave();let n=nf(t).line,{x:s,y:a,z:o,lastModelMatrix:l}=this.transform(t,n,r),h=e;if(r.camera){h=e.clone();let i=t.parent.globalTransMatrix;h.x=i.a*e.x+i.c*e.y+i.e,h.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=o;let u=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,t=>!!u||(u=t.isPointInPath(h.x,h.y)),(t,e,i)=>{if(u)return!0;let n=e.lineWidth||i.lineWidth,s=e.pickStrokeBuffer||i.pickStrokeBuffer;return r.lineWidth=od(r,n+s,r.dpr),u=t.isPointInStroke(h.x,h.y)}),this.canvasRenderer.z=0,r.modelMatrix!==l&&av.free(r.modelMatrix),r.modelMatrix=l,r.highPerformanceRestore(),u}};kw=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(q=0,J=e0(s6),function(t,e){J(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],kw);let kM=!1,kC=new eW((t,e,i,r)=>{kM||(kM=!0,t(yw).to(kw).inSingletonScope(),t(yD).toService(yw))}),kT=class{constructor(t){this.canvasRenderer=t,this.type="line",this.numberType=sO}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).line,{x:s=n.x,y:a=n.y}=t.attribute;if(r.highPerformanceSave(),t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let o=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,t=>!!o||(o=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(o)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=s+a,o=t.isPointInStroke(e.x,e.y)}),r.highPerformanceRestore(),o}};kT=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(Q=0,tt=e0(s6),function(t,e){tt(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],kT);let kE=!1,kO=new eW((t,e,i,r)=>{kE||(kE=!0,t(yp).to(kT).inSingletonScope(),t(yl).toService(yp))});function kP(){kP.__loaded||(kP.__loaded=!0,aj.RegisterGraphicCreator("line",kS),r4.load(kA),r4.load(yo?kC:kO))}kP.__loaded=!1;let kR=["path","customPath",...n4];class kB extends se{constructor(t){super(t),this.type="path",this.numberType=sP}get pathShape(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{path:t}=this.attribute;return null!=t&&""!==t}getParsedPathShape(){let t=nf(this).path;if(!this.valid)return t.path;let e=this.attribute;return e.path instanceof rg?e.path:(ej(this.cache)&&this.doUpdatePathShape(),this.cache instanceof rg?this.cache:t.path)}doUpdateAABBBounds(){let t=nf(this).path;this.doUpdatePathShape(),this._AABBBounds.clear();let e=this.attribute,i=rj.graphicService.updatePathAABBBounds(e,nf(this).path,this._AABBBounds,this),{boundsPadding:r=t.boundsPadding}=e,n=ss(r);return n&&i.expand(n),this.clearUpdateBoundTag(),i}doUpdatePathShape(){let t=this.attribute;eE(t.path,!0)?this.cache=(new rg).fromString(t.path):t.customPath&&(this.cache=new rg,t.customPath(this.cache,this))}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}getDefaultAttribute(t){return nf(this).path[t]}needUpdateTags(t){return super.needUpdateTags(t,kR)}needUpdateTag(t){return super.needUpdateTag(t,kR)}toCustomPath(){return(new rg).fromCustomPath2D(this.getParsedPathShape(),0,0)}clone(){return new kB(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return kB.NOWORK_ANIMATE_ATTR}}function kI(t){return new kB(t)}kB.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},st);var kL=function(t,e){return function(i,r){e(i,r,t)}};let kD=class extends oQ{constructor(t){super(),this.pathRenderContribitions=t,this.numberType=sP,this.builtinContributions=[oY,o6],this.init(t)}drawShape(t,e,i,r,n,s,a,o){var l,h,u;let d=null!==(l=this.tempTheme)&&void 0!==l?l:nf(t,null==s?void 0:s.theme).path,{x:c=d.x,y:p=d.y}=t.attribute,g=null!==(h=this.z)&&void 0!==h?h:0,f=this.valid(t,d,a,o);if(!f)return;let{fVisible:m,sVisible:v,doFill:y,doStroke:_}=f;(e.beginPath(),t.pathShape)?iV(t.pathShape.commandList,e,i,r,1,1,g):iV((null!==(u=t.attribute.path)&&void 0!==u?u:d.path).commandList,e,i,r,1,1,g),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,d),this.beforeRenderStep(t,e,i,r,y,_,m,v,d,n,a,o),_&&(o?o(e,t.attribute,d):v&&(e.setStrokeStyle(t,t.attribute,c-i,p-r,d),e.stroke())),y&&(a?a(e,t.attribute,d):m&&(e.setCommonStyle(t,t.attribute,c-i,p-r,d),e.fill())),this.afterRenderStep(t,e,i,r,y,_,m,v,d,n,a,o)}draw(t,e,i,r){let n=nf(t,null==r?void 0:r.theme).path;this.tempTheme=n,this._draw(t,n,!1,i,r),this.tempTheme=null}};kD=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),kL(0,e0(e2)),kL(0,e1(oN)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],kD);let kF=!1,kj=new eW(t=>{kF||(kF=!0,t(kD).toSelf().inSingletonScope(),t(s9).to(kD).inSingletonScope(),t(s4).toService(s9),t(oN).toService(oK),e5(t,oN))}),kN=class extends yF{constructor(t){super(),this.canvasRenderer=t,this.type="path",this.numberType=sP}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).path;r.highPerformanceSave();let{x:s,y:a,z:o,lastModelMatrix:l}=this.transform(t,n,r),h=e;if(r.camera){h=e.clone();let i=t.parent.globalTransMatrix;h.x=i.a*e.x+i.c*e.y+i.e,h.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=o;let u=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,e,i)=>!!u||(u=t.isPointInPath(h.x,h.y)),(t,e,i)=>{if(u)return!0;let n=e.lineWidth||i.lineWidth,s=e.pickStrokeBuffer||i.pickStrokeBuffer;return r.lineWidth=od(r,n+s,r.dpr),u=t.isPointInStroke(h.x,h.y)}),this.canvasRenderer.z=0,r.modelMatrix!==l&&av.free(r.modelMatrix),r.modelMatrix=l,r.highPerformanceRestore(),u}};kN=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(te=0,ti=e0(s9),function(t,e){ti(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],kN);let kz=!1,kH=new eW((t,e,i,r)=>{kz||(kz=!0,t(yM).to(kN).inSingletonScope(),t(yD).toService(yM))}),kV=class{constructor(t){this.canvasRenderer=t,this.type="path",this.numberType=sP}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).path,{x:s=n.x,y:a=n.y}=t.attribute;if(r.highPerformanceSave(),t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let o=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,i,r)=>!!o||(o=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(o)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=s+a,o=t.isPointInStroke(e.x,e.y)}),r.highPerformanceRestore(),o}};kV=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(tr=0,tn=e0(s9),function(t,e){tn(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],kV);let kW=!1,kG=new eW((t,e,i,r)=>{kW||(kW=!0,t(yg).to(kV).inSingletonScope(),t(yl).toService(yg))});function kU(){kU.__loaded||(kU.__loaded=!0,aj.RegisterGraphicCreator("path",kI),r4.load(kj),r4.load(yo?kH:kG))}kU.__loaded=!1;let k$=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]];class kY extends _5{constructor(t){super(t),this.type="rect3d",this.numberType=sL}findFace(){let t={polygons:[],vertices:[],edges:[]},e=nf(this).rect,{x1:i,y1:r,x:n,y:s,length:a=iu(e.width,e.height)}=this.attribute,{width:o,height:l}=this.attribute;o=null!=o?o:i-n,l=null!=l?l:r-s;for(let e=0;e<k$.length;e++){let i=k$[e];t.vertices.push([i[0]*o,i[1]*l,i[2]*a])}return t.polygons.push({polygon:[0,1,5,4],normal:[0,-1,0]}),t.polygons.push({polygon:[2,3,7,6],normal:[0,1,0]}),t.polygons.push({polygon:[4,7,3,0],normal:[-1,0,0]}),t.polygons.push({polygon:[1,2,6,5],normal:[1,0,0]}),t.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),t.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),t.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],t}getNoWorkAnimateAttr(){return kY.NOWORK_ANIMATE_ATTR}}function kK(t){return new kY(t)}kY.NOWORK_ANIMATE_ATTR=st;let kZ=class extends oQ{constructor(){super(...arguments),this.type="rect3d",this.numberType=sL}drawShape(t,e,i,r,n,s,a,o){var l,h;let u=nf(t,null==s?void 0:s.theme).rect,{fill:d=u.fill,stroke:c=u.stroke,x1:p,y1:g,x:f,y:m,opacity:v=u.opacity,fillOpacity:y=u.fillOpacity,lineWidth:_=u.lineWidth,strokeOpacity:b=u.strokeOpacity,visible:x=u.visible}=t.attribute,{width:S,height:k}=t.attribute;S=(null!=S?S:p-f)||0,k=(null!=k?k:g-m)||0;let A=null!==(l=this.z)&&void 0!==l?l:0,w=oT(v,y,S,k,d),M=oO(v,b,S,k),C=!!d,T=oM(c,_);if(!t.valid||!x||!C&&!T||!(w||M||a||o))return;let{light:E,camera:O}=n.stage||{},P=t.findFace();if(!1!==d){e.setCommonStyle(t,t.attribute,i,r,u);let n=d;"string"!=typeof n&&(n="black"),this.fill(i,r,A,P,n,e,E,a)}!1!==c&&(e.setStrokeStyle(t,t.attribute,i,r,u),this.stroke(i,r,A,P,e))}stroke(t,e,i,r,n){let s=r.vertices;r.edges.forEach(r=>{let a=s[r[0]],o={x:t+a[0],y:e+a[1],z:i+a[2]},l=s[r[1]],h={x:t+l[0],y:e+l[1],z:i+l[2]};n.beginPath(),n.moveTo(o.x,o.y,o.z),n.lineTo(h.x,h.y,h.z),n.stroke()})}fill(t,e,i,r,n,s,a,o){let l=nK.Get(n,lB.Color255),h=r.vertices,u=h.map(t=>s.view(t[0],t[1],t[2])[2]),d=[];r.polygons.forEach((t,e)=>{d.push({faceIdx:e,polygon:t});let{polygon:i,normal:r}=t,n=u[i[0]],s=u[i[1]],a=u[i[2]],o=u[i[3]];t.ave_z=n+s+a+o}),d.sort((t,e)=>e.polygon.ave_z-t.polygon.ave_z),d.forEach(r=>{let{polygon:u,normal:d}=r.polygon,c=h[u[0]],p=h[u[1]],g=h[u[2]],f=h[u[3]],m={x:t+c[0],y:e+c[1],z:i+c[2]},v={x:t+p[0],y:e+p[1],z:i+p[2]},y={x:t+g[0],y:e+g[1],z:i+g[2]},_={x:t+f[0],y:e+f[1],z:i+f[2]};s.beginPath(),s.moveTo(m.x,m.y,m.z),s.lineTo(v.x,v.y,v.z),s.lineTo(y.x,y.y,y.z),s.lineTo(_.x,_.y,_.z),s.closePath(),o?o(s,null,null):(s.fillStyle=a?a.computeColor(d,l):n,s.fill())})}draw(t,e,i){let r=nf(t).rect;this._draw(t,r,!1,i)}};kZ=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],kZ);let kX=!1,kq=new eW(t=>{kX||(kX=!0,t(ae).to(kZ).inSingletonScope(),t(s4).toService(ae))});new iI;let kJ=class extends yF{constructor(t){super(),this.canvasRenderer=t,this.type="rect3d",this.numberType=sL}contains(t,e,i){let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).rect;r.highPerformanceSave();let{x:s,y:a,z:o,lastModelMatrix:l}=this.transform(t,n,r),h=e;if(r.camera){h=e.clone();let i=t.parent.globalTransMatrix;h.x=i.a*e.x+i.c*e.y+i.e,h.y=i.b*e.x+i.d*e.y+i.f}this.canvasRenderer.z=o;let u=!1;return this.canvasRenderer.drawShape(t,r,s,a,i,null,(t,e,i)=>!!u||(u=t.isPointInPath(h.x,h.y))),this.canvasRenderer.z=0,r.modelMatrix!==l&&av.free(r.modelMatrix),r.modelMatrix=l,r.highPerformanceRestore(),u}};kJ=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(ts=0,ta=e0(ae),function(t,e){ta(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],kJ);let kQ=!1,k0=new eW((t,e,i,r)=>{kQ||(kQ=!0,t(yT).to(kJ).inSingletonScope(),t(yD).toService(yT))});function k1(){k1.__loaded||(k1.__loaded=!0,aj.RegisterGraphicCreator("rect3d",kK),r4.load(kq),r4.load(k0))}k1.__loaded=!1;class k2{constructor(t,e,i,r,n,s,a,o,l,h,u,d,c,p){this.left=t,this.top=e,this.width=i,this.height=r,this.actualHeight=0,this.bottom=e+r,this.right=t+i,this.ellipsis=n,this.wordBreak=s,this.verticalDirection=a,this.lines=[],this.globalAlign=o,this.globalBaseline=l,this.layoutDirection=h,this.directionKey=rN[this.layoutDirection],this.isWidthMax=u,this.isHeightMax=d,this.singleLine=c,p?(p.clear(),this.icons=p):this.icons=new Map}draw(t,e){let{width:i,height:r}=this.getActualSize(),n=this.isWidthMax?Math.min(this.width,i):this.width||i||0,s=this.isHeightMax?Math.min(this.height,r):this.height||r||0;s=Math.min(s,r);let a=0;switch(this.globalBaseline){case"top":a=0;break;case"middle":a=-s/2;break;case"bottom":a=-s}let o=0;"right"===this.globalAlign||"end"===this.globalAlign?o=-n:"center"===this.globalAlign&&(o=-n/2);let l=this[this.directionKey.height];this.singleLine&&(l=this.lines[0].height+1);let h=!1;if("middle"===this.verticalDirection){if(this.actualHeight>=l&&0!==l)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i];if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+l)break;let s=!1;this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+l&&(s=!0,h=!0),this.lines[i].draw(t,s,this.lines[i][this.directionKey.left]+o,this.lines[i][this.directionKey.top]+a,this.ellipsis,e)}else{let i=Math.floor((l-this.actualHeight)/2);"vertical"===this.layoutDirection?o+=i:a+=i;for(let i=0;i<this.lines.length;i++)this.lines[i].draw(t,!1,this.lines[i][this.directionKey.left]+o,this.lines[i][this.directionKey.top]+a,this.ellipsis,e)}}else if("bottom"===this.verticalDirection&&"vertical"!==this.layoutDirection)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i],s=l-this.lines[i].top-this.lines[i].height;if(0===l)this.lines[i].draw(t,!1,o,s+a,this.ellipsis,e);else{if(s+n>this[this.directionKey.top]+l||s<this[this.directionKey.top])return h;{let r=!1;this.ellipsis&&this.lines[i+1]&&s-this.lines[i+1].height<this[this.directionKey.top]&&(r=!0,h=!0),this.lines[i].draw(t,r,o,s+a,this.ellipsis,e)}}}else{"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&this.singleLine&&this.isWidthMax&&(o+=this.lines[0].height+1);for(let i=0;i<this.lines.length;i++){"bottom"===this.verticalDirection&&"vertical"===this.layoutDirection&&(o-=this.lines[i].height+this.lines[i].top);let{top:r,height:n}=this.lines[i];if(0===l)this.lines[i].draw(t,!1,this.lines[i][this.directionKey.left]+o,this.lines[i][this.directionKey.top]+a,this.ellipsis,e);else{if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+l)return h;{let r=!1;this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+l&&(r=!0,h=!0),this.lines[i].draw(t,r,this.lines[i][this.directionKey.left]+o,this.lines[i][this.directionKey.top]+a,this.ellipsis,e)}}}}return h}getActualSize(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}getRawActualSize(){let t=0,e=0;for(let i=0;i<this.lines.length;i++){let r=this.lines[i];r.actualWidth>t&&(t=r.actualWidth),e+=r.height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}getActualSizeWidthEllipsis(){let t=0,e=0,{width:i,height:r}=this.getRawActualSize();this.width;let n=this.height||r||0;n=Math.min(n,r);let s=this[this.directionKey.height];if(this.singleLine&&(s=this.lines[0].height+1),"middle"===this.verticalDirection){if(this.actualHeight>=s&&0!==s)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i];if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+s);else if(this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+s){let r=!0===this.ellipsis?"...":this.ellipsis||"",n=this.lines[i].getWidthWithEllips(r);n>t&&(t=n),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else{this.actualHeight;for(let i=0;i<this.lines.length;i++)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}}else if("bottom"===this.verticalDirection)for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i],a=s-this.lines[i].top-this.lines[i].height;if(0===s)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height;else if(a+n>this[this.directionKey.top]+s||a<this[this.directionKey.top]);else if(this.ellipsis&&this.lines[i+1]&&a-this.lines[i+1].height<this[this.directionKey.top]){let r=!0===this.ellipsis?"...":this.ellipsis||"",n=this.lines[i].getWidthWithEllips(r);n>t&&(t=n),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}else for(let i=0;i<this.lines.length;i++){let{top:r,height:n}=this.lines[i];if(0===s)this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height;else if(r+n<this[this.directionKey.top]||r+n>this[this.directionKey.top]+s);else if(this.ellipsis&&this.lines[i+1]&&this.lines[i+1].top+this.lines[i+1].height>this[this.directionKey.top]+s){let r=!0===this.ellipsis?"...":this.ellipsis||"",n=this.lines[i].getWidthWithEllips(r);n>t&&(t=n),e+=this.lines[i].height}else this.lines[i].actualWidth>t&&(t=this.lines[i].actualWidth),e+=this.lines[i].height}return{width:"vertical"===this.layoutDirection?e:t,height:"vertical"===this.layoutDirection?t:e}}}class k3{constructor(t,e,i){this.fontSize=i.fontSize||16,this.textBaseline=i.textBaseline||"alphabetic";let r=sm(i.lineHeight,this.fontSize);this.lineHeight="number"==typeof r?r>this.fontSize?r:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;let{ascent:n,height:s,descent:a,width:o}=r$(t,i),l=0,h=0,u=0;this.height>s&&(h=Math.ceil(l=(this.height-s)/2),u=Math.floor(l)),"top"===this.textBaseline?(this.ascent=l,this.descent=s-l):"bottom"===this.textBaseline?(this.ascent=s-l,this.descent=l):"middle"===this.textBaseline?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=n+h,this.descent=a+u),this.length=t.length,this.width=o||0,this.text=t||"",this.newLine=e||!1,this.character=i,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,"vertical"===i.direction&&(this.direction=i.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}updateWidth(){let{width:t}=r$(this.text,this.character);this.width=t,"vertical"===this.direction&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}draw(t,e,i,r,n){let s=this.text,a=this.left+i;e+=this.top;let o=this.direction;if(this.verticalEllipsis)s=this.ellipsisStr,o="vertical",e-=this.ellipsisWidth/2;else{if("hide"===this.ellipsis)return;if("add"===this.ellipsis)s+=this.ellipsisStr,"right"!==n&&"end"!==n||(a-=this.ellipsisWidth);else if("replace"===this.ellipsis){let t=rG(s,("vertical"===o?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,s.length-1);if(s=s.slice(0,t)+this.ellipsisStr,"right"===n||"end"===n){let{width:e}=r$(this.text.slice(t),this.character);"vertical"===o||(a-=this.ellipsisWidth-e)}}}switch(this.character.script){case"super":e-=this.ascent*(1/3);break;case"sub":e+=this.descent/2}"vertical"===o&&(t.save(),t.rotateAbout(Math.PI/2,a,e),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(a,e),a=0,e=0),this.character.stroke&&(function(t,e){let i=e&&e.stroke||rz.stroke;if(!i)return void(t.globalAlpha=0);let{strokeOpacity:r=1,opacity:n=1}=e;t.globalAlpha=r*n,t.lineWidth=e&&"number"==typeof e.lineWidth?e.lineWidth:1,t.strokeStyle=i;let s=e.fontSize||16;switch(e.script){case"super":case"sub":s*=.8}t.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:s,fontFamily:e.fontFamily||"sans-serif"})}(t,this.character),t.strokeText(s,a,e)),function(t,e){let i=e&&e.fill||rz.fill;if(!i)return void(t.globalAlpha=0);let{fillOpacity:r=1,opacity:n=1}=e;t.globalAlpha=r*n,t.fillStyle=i;let s=e.fontSize||16;switch(e.script){case"super":case"sub":s*=.8}t.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:s,fontFamily:e.fontFamily||"sans-serif"})}(t,this.character),this.character.fill&&t.fillText(s,a,e),this.character.fill&&("boolean"==typeof this.character.lineThrough||"boolean"==typeof this.character.underline?(this.character.underline&&t.fillRect(a,1+e,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1),this.character.lineThrough&&t.fillRect(a,1+e-this.ascent/2,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)):"underline"===this.character.textDecoration?t.fillRect(a,1+e,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1):"line-through"===this.character.textDecoration&&t.fillRect(a,1+e-this.ascent/2,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)),"vertical"===o&&t.restore()}getWidthWithEllips(t){let e=this.text,i="vertical"===t?this.height:this.width;if("hide"===this.ellipsis)return i;if("add"===this.ellipsis)return i+this.ellipsisWidth;if("replace"===this.ellipsis){let t=rG(e,i-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,t)+this.ellipsisStr;let{width:r}=r$(this.text.slice(t),this.character);return i+this.ellipsisWidth-r}return i}}class k5 extends kn{constructor(t){if(super(t),this._x=0,this._y=0,this._hovered=!1,this._marginArray=[0,0,0,0],"always"===t.backgroundShowMode&&(this._hovered=!0),t.margin){let e=ss(t.margin);this._marginArray="number"==typeof e?[e,e,e,e]:e}this.onBeforeAttributeUpdate=(t,e,i)=>{if(eM(i)&&-1!==i.indexOf("margin")||"margin"===i){if(e.margin){let t=ss(e.margin);this._marginArray="number"==typeof t?[t,t,t,t]:t}else this._marginArray=[0,0,0,0]}}}get width(){var t;return(null!==(t=this.attribute.width)&&void 0!==t?t:0)+this._marginArray[1]+this._marginArray[3]}get height(){var t;return(null!==(t=this.attribute.height)&&void 0!==t?t:0)+this._marginArray[0]+this._marginArray[2]}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();let{width:t=rD.width,height:e=rD.height}=this.attribute,{backgroundWidth:i=t,backgroundHeight:r=e}=this.attribute;return this._AABBBounds.expand([0,(i-t)/2*2,(r-e)/2*2,0]),this._AABBBounds}setHoverState(t){"hover"===this.attribute.backgroundShowMode&&this._hovered!==t&&(this._hovered=t)}}class k4{constructor(t,e,i,r,n,s,a,o){this.left=t,this.width=e,this.baseline=i,this.ascent=r,this.descent=n,this.top=i-r,this.paragraphs=s.map(t=>t),this.textAlign=(this.paragraphs[0]instanceof k5?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=a,this.directionKey=rN[this.direction],this.actualWidth=0;let l=0;this.paragraphs.forEach((t,e)=>{if(0===e&&t instanceof k3){let e=rW.exec(t.text);0!==(null==e?void 0:e.index)&&(t.text=t.text.slice(null==e?void 0:e.index),t.updateWidth())}this.actualWidth+=t[this.directionKey.width],l=Math.max(t[this.directionKey.height],l)}),this.height=l,this.blankWidth=o?0:this.width-this.actualWidth,this.calcOffset(e,o)}calcOffset(t,e){let i=this.directionKey,r=this.height,n=this.left,s=0;this.actualWidth<t&&!e&&("right"===this.textAlign||"end"===this.textAlign?n=t-this.actualWidth:"center"===this.textAlign?n=(t-this.actualWidth)/2:"justify"===this.textAlign&&(this.paragraphs.length<2?n=(t-this.actualWidth)/2:s=(t-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map(function(t){t instanceof k5?(t["_"+i.x]=n,n+=t[i.width]+s,t["_"+i.y]="top"===t.attribute.textBaseline?0:"bottom"===t.attribute.textBaseline?r-t.height:(r-t.height)/2):(t[i.left]=n,n+=t[i.width]+s)})}draw(t,e,i,r,n,s){if(n&&(e||this.paragraphs.some(t=>t.overflow))){let t=0;for(let i=this.paragraphs.length-1;i>=0;i--){let r=this.paragraphs[i];if(r.overflow)continue;if(r instanceof k5)break;if("vertical"===this.direction&&"vertical"!==r.direction){r.verticalEllipsis=!0;break}let s=!0===n?"...":n||"";r.ellipsisStr=s;let{width:a}=r$(s,r.character),o=a||0;if(o<=this.blankWidth+t){e&&(r.ellipsis="add");break}if(o<=this.blankWidth+t+r.width){r.ellipsis="replace",r.ellipsisWidth=o,r.ellipsisOtherParagraphWidth=this.blankWidth+t;break}r.ellipsis="hide",t+=r.width}}this.paragraphs.map((e,n)=>{if(e instanceof k5)return e.setAttributes({x:i+e._x,y:r+e._y}),void s(e,t,i+e._x,r+e._y,this.ascent);e.draw(t,r+this.ascent,i,0===n,this.textAlign)})}getWidthWithEllips(t){let e=0;for(let i=this.paragraphs.length-1;i>=0;i--){let r=this.paragraphs[i];if(r instanceof k5)break;let{width:n}=r$(t,r.character),s=n||0;if(s<=this.blankWidth+e){r.ellipsis="add",r.ellipsisWidth=s;break}if(s<=this.blankWidth+e+r.width){r.ellipsis="replace",r.ellipsisWidth=s,r.ellipsisOtherParagraphWidth=this.blankWidth+e;break}r.ellipsis="hide",e+=r.width}let i=0;return this.paragraphs.map((t,e)=>{i+=t instanceof k5?t.width:t.getWidthWithEllips(this.direction)}),i}}class k8{constructor(t){this.frame=t,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=t.layoutDirection,this.directionKey=rN[this.direction]}store(t){if(t instanceof k5){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];let e=0,i=0;"top"===t.attribute.textBaseline?(e=0,i=t.height):"bottom"===t.attribute.textBaseline?(e=t.height,i=0):(e=t.height/2,i=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,i)}else this.lineBuffer.push(t),0!==t.text.length?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}send(){if(0===this.lineBuffer.length)return;let t=0===this.maxAscent?this.maxAscentForBlank:this.maxAscent,e=0===this.maxDescent?this.maxDescentForBlank:this.maxDescent,i=new k4(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,"horizontal"===this.direction?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(i),this.frame.actualHeight+=i.height,this.y+=i.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}deal(t){t instanceof k5?"horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):0===this.lineBuffer.length?(this.store(t),this.send()):(this.send(),this.deal(t)):"number"!=typeof this.width||this.width<0||(t.newLine&&this.send(),0!==t.text.length&&("horizontal"===this.direction&&0===this.width||"vertical"===this.direction&&0===this.height||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t)))}cut(t){let e=this[this.directionKey.width]-this.lineWidth||0,i=Math.ceil(e/t[this.directionKey.width]*t.length)||0,r=rG(t.text,e,t.character,i,"break-word"===this.frame.wordBreak);if(0!==r){let[e,i]=function(t,e){let i=t.text.slice(0,e),r=t.text.slice(e);return[new k3(i,t.newLine,t.character),new k3(r,!0,t.character)]}(t,r);this.store(e),this.deal(i)}else 0!==this.lineBuffer.length&&(this.send(),this.deal(t))}}let k6=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection",...n4];class k9 extends se{constructor(t){super(t),this.type="richtext",this._currentHoverIcon=null,this.numberType=sD}get width(){var t;return null!==(t=this.attribute.width)&&void 0!==t?t:rL.width}set width(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}get height(){var t;return null!==(t=this.attribute.height)&&void 0!==t?t:rL.height}set height(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}get maxWidth(){return this.attribute.maxWidth}set maxWidth(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}get maxHeight(){return this.attribute.maxHeight}set maxHeight(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}get ellipsis(){var t;return null!==(t=this.attribute.ellipsis)&&void 0!==t?t:rL.ellipsis}set ellipsis(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}get wordBreak(){var t;return null!==(t=this.attribute.wordBreak)&&void 0!==t?t:rL.wordBreak}set wordBreak(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}get verticalDirection(){var t;return null!==(t=this.attribute.verticalDirection)&&void 0!==t?t:rL.verticalDirection}set verticalDirection(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}get textAlign(){var t;return null!==(t=this.attribute.textAlign)&&void 0!==t?t:rL.textAlign}set textAlign(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}get textBaseline(){var t;return null!==(t=this.attribute.textBaseline)&&void 0!==t?t:rL.textBaseline}set textBaseline(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}get textConfig(){var t;return null!==(t=this.attribute.textConfig)&&void 0!==t?t:rL.textConfig}set textConfig(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}doUpdateAABBBounds(){let t=nf(this).richtext;this._AABBBounds.clear();let e=this.attribute,i=rj.graphicService.updateRichTextAABBBounds(e,nf(this).richtext,this._AABBBounds,this),{boundsPadding:r=t.boundsPadding}=e,n=ss(r);return n&&i.expand(n),this.clearUpdateBoundTag(),i}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}getDefaultAttribute(t){return rL[t]}needUpdateTags(t){return super.needUpdateTags(t,k6)}needUpdateTag(t){return super.needUpdateTag(t,k6)}getFrameCache(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}combinedStyleToCharacter(t){let{fill:e,stroke:i,fontSize:r,fontFamily:n,fontStyle:s,fontWeight:a,lineWidth:o,opacity:l,fillOpacity:h,strokeOpacity:u}=this.attribute;return Object.assign({fill:e,stroke:i,fontSize:r,fontFamily:n,fontStyle:s,fontWeight:a,lineWidth:o,opacity:l,fillOpacity:h,strokeOpacity:u},t)}doUpdateFrameCache(t){var e;let{textConfig:i=[],maxWidth:r,maxHeight:n,width:s,height:a,ellipsis:o,wordBreak:l,verticalDirection:h,textAlign:u,textBaseline:d,layoutDirection:c,singleLine:p,disableAutoWrapLine:g}=this.attribute,f=[],m=null!=t?t:i;for(let t=0;t<m.length;t++)if("image"in m[t]){let e=this.combinedStyleToCharacter(m[t]),i=e.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(e.id);if(i)f.push(i);else{let t=new k5(e);t.successCallback=()=>{var t;this.addUpdateBoundTag(),null===(t=this.stage)||void 0===t||t.renderNextFrame()},t.richtextId=e.id,f.push(t)}}else{let e=this.combinedStyleToCharacter(m[t]);if(ey(e.text)&&(e.text=`${e.text}`),e.text&&e.text.includes("\n")){let t=e.text.split("\n");for(let i=0;i<t.length;i++)f.push(new k3(t[i],0!==i,e))}else e.text&&f.push(new k3(e.text,!1,e))}let v="number"==typeof r&&Number.isFinite(r)&&r>0,y="number"==typeof n&&Number.isFinite(n)&&n>0,_="number"==typeof s&&Number.isFinite(s)&&s>0&&(!v||s<=r),b="number"==typeof a&&Number.isFinite(a)&&a>0&&(!y||a<=n),x=new k2(0,0,(_?s:v?r:0)||0,(b?a:y?n:0)||0,o,l,h,u,d,c||"horizontal",!_&&v,!b&&y,p||!1,null===(e=this._frameCache)||void 0===e?void 0:e.icons),S=new k8(x);if(g){let t=0,e=!1;for(let i=0;i<f.length;i++){let r=f[i];e?(r.overflow=!0,r.left=1/0,r.top=1/0,r.newLine||x.lines[x.lines.length-1].paragraphs.push(r)):S.deal(r),x.lines.length!==t&&(t=x.lines.length,S.lineBuffer.length=0,r.overflow=!0,r.left=1e3,r.top=1e3,x.lines[x.lines.length-1].paragraphs.push(r),e=!0),r.newLine&&(e=!1,S.lineWidth=0)}}else for(let t=0;t<f.length;t++)S.deal(f[t]);if(S.send(),!("horizontal"===x.layoutDirection?_:b)){let t=x.getActualSizeWidthEllipsis(),e="horizontal"===x.layoutDirection?t.width:t.height;("horizontal"===x.layoutDirection?v:y)&&(e=Math.min(e,"horizontal"===x.layoutDirection?r:n)),x.lines.forEach(function(t){t.calcOffset(e,!1)})}this._frameCache=x}clone(){return new k9(Object.assign({},this.attribute))}setStage(t,e){super.setStage(t,e),this.getFrameCache().icons.forEach(i=>{i.setStage(t,e)})}bindIconEvent(){this.addEventListener("pointermove",t=>{var e,i,r,n,s;let a=this.pickIcon(t.global);a&&a===this._currentHoverIcon||(a?(null===(e=this._currentHoverIcon)||void 0===e||e.setHoverState(!1),this._currentHoverIcon=a,this._currentHoverIcon.setHoverState(!0),null===(i=this.stage)||void 0===i||i.setCursor(a.attribute.cursor),null===(r=this.stage)||void 0===r||r.renderNextFrame()):!a&&this._currentHoverIcon&&(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,null===(n=this.stage)||void 0===n||n.setCursor(),null===(s=this.stage)||void 0===s||s.renderNextFrame()))}),this.addEventListener("pointerleave",t=>{var e,i;this._currentHoverIcon&&(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,null===(e=this.stage)||void 0===e||e.setCursor(),null===(i=this.stage)||void 0===i||i.renderNextFrame())})}pickIcon(t){let e;let i=this.getFrameCache(),{e:r,f:n}=this.globalTransMatrix;return i.icons.forEach(i=>{var s,a;i.AABBBounds.containsPoint({x:t.x-r,y:t.y-n})&&((e=i).globalX=(null!==(s=e.attribute.x)&&void 0!==s?s:0)+r,e.globalY=(null!==(a=e.attribute.y)&&void 0!==a?a:0)+n)}),e}getNoWorkAnimateAttr(){return k9.NOWORK_ANIMATE_ATTR}}function k7(t){return new k9(t)}k9.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},st);let At=class extends oQ{constructor(){super(),this.numberType=sD,this.builtinContributions=[yi],this.init()}drawShape(t,e,i,r,n){var s,a,o,l;let h=nf(t).richtext,{strokeOpacity:u=h.strokeOpacity,opacity:d=h.opacity,fillOpacity:c=h.fillOpacity,visible:p=h.visible}=t.attribute;if(!t.valid||!p)return;let g=(s=d,a=c,s*a>0),f=(o=d,l=u,o*l>0);g&&(e.translate(i,r),this.beforeRenderStep(t,e,i,r,g,f,g,f,h,n),t.getFrameCache().draw(e,this.drawIcon),this.afterRenderStep(t,e,i,r,g,f,g,f,h,n))}drawIcon(t,e,i,r,n){var s;let a=nf(t).richtextIcon,{width:o=a.width,height:l=a.height,opacity:h=a.opacity,image:u,backgroundFill:d=a.backgroundFill,backgroundFillOpacity:c=a.backgroundFillOpacity,backgroundStroke:p=a.backgroundStroke,backgroundStrokeOpacity:g=a.backgroundStrokeOpacity,backgroundRadius:f=a.backgroundRadius,margin:m}=t.attribute,{backgroundWidth:v=o,backgroundHeight:y=l}=t.attribute;if(m&&(i+=t._marginArray[3],r+=t._marginArray[0]),t._hovered){let t=(v-o)/2,n=(y-l)/2;0===f?(e.beginPath(),e.rect(i-t,r-n,v,y)):(e.beginPath(),oA(e,i-t,r-n,v,y,f)),d&&(e.globalAlpha=c,e.fillStyle=d,e.fill()),p&&(e.globalAlpha=g,e.strokeStyle=p,e.stroke())}let _=u&&(null===(s=null==t?void 0:t.resources)||void 0===s?void 0:s.get(u));_&&"success"===_.state&&(e.globalAlpha=h,e.drawImage(_.data,i,r,o,l))}draw(t,e,i){let r=nf(t).richtext;this._draw(t,r,!1,i)}};At=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],At);let Ae=!1,Ai=new eW(t=>{Ae||(Ae=!0,t(an).to(At).inSingletonScope(),t(s4).toService(an))}),Ar=class{constructor(t){this.canvasRenderer=t,this.type="richtext",this.numberType=sD}contains(t,e,i){return!!t.AABBBounds.containsPoint(e)}};Ar=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(to=0,tl=e0(an),function(t,e){tl(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Ar);let An=!1,As=new eW((t,e,i,r)=>{An||(An=!0,t(yB).to(Ar).inSingletonScope(),t(yD).toService(yB))}),Aa=!1,Ao=new eW((t,e,i,r)=>{Aa||(Aa=!0,t(yc).to(km).inSingletonScope(),t(km).toService(yc))});function Al(){Al.__loaded||(Al.__loaded=!0,aj.RegisterGraphicCreator("richtext",k7),r4.load(Ai),r4.load(yo?As:Ao))}Al.__loaded=!1;function Ah(t,e,i,r){t.moveTo(e[0].x+i,e[0].y+r);for(let n=1;n<e.length;n++)t.lineTo(e[n].x+i,e[n].y+r)}function Au(t,e){return Math.sqrt(t*t+e*e)}function Ad(t,e,i,r,n){let s=e/i;return{x:t.x-r*s,y:t.y-n*s}}var Ac=function(t,e){return function(i,r){e(i,r,t)}};let Ap=class extends oQ{constructor(t){super(),this.polygonRenderContribitions=t,this.numberType=sR,this.builtinContributions=[oY,o6],this.init(t)}drawShape(t,e,i,r,n,s,a,o){let l=nf(t,null==s?void 0:s.theme).polygon,{points:h=l.points,cornerRadius:u=l.cornerRadius,x:d=l.x,y:c=l.y,closePath:p=l.closePath}=t.attribute,g=this.valid(t,l,a,o);if(!g)return;let{fVisible:f,sVisible:m,doFill:v,doStroke:y}=g;e.beginPath(),u<=0||eM(u)&&u.every(t=>0===t)?Ah(e.camera?e:e.nativeContext,h,i,r):function(t,e,i,r,n,s=!0){var a;if(e.length<3)return void Ah(t,e,i,r);let o=0,l=e.length-1;s||(o+=1,l-=1,t.moveTo(e[0].x+i,e[0].y+r));for(let s=o;s<=l;s++){let o=e[0===s?l:(s-1)%e.length],h=e[s%e.length],u=e[(s+1)%e.length],d=h.x-o.x,c=h.y-o.y,p=h.x-u.x,g=h.y-u.y,f=Math.abs(Math.tan((Math.atan2(c,d)-Math.atan2(g,p))/2)),m=Array.isArray(n)?null!==(a=n[s%e.length])&&void 0!==a?a:0:n,v=m/f,y=Au(d,c),_=Au(p,g),b=Math.min(y,_);v>b&&(v=b,m=b*f);let x=Ad(h,v,y,d,c),S=Ad(h,v,_,p,g),k=2*h.x-x.x-S.x,A=2*h.y-x.y-S.y,w=Au(k,A),M=Ad(h,Au(v,m),w,k,A),C=Math.atan2(x.y-M.y,x.x-M.x),T=Math.atan2(S.y-M.y,S.x-M.x),E=T-C;E<0&&(C=T,E=-E),E>Math.PI&&(E-=Math.PI),0===s?t.moveTo(x.x+i,x.y+r):t.lineTo(x.x+i,x.y+r),E&&t.arcTo(h.x+i,h.y+r,S.x+i,S.y+r,m),t.lineTo(S.x+i,S.y+r)}s||t.lineTo(e[l+1].x+i,e[l+1].y+r)}(e.camera?e:e.nativeContext,h,i,r,u,p),p&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,r,v,y,f,m,l,n,a,o),v&&(a?a(e,t.attribute,l):f&&(e.setCommonStyle(t,t.attribute,d-i,c-r,l),e.fill())),y&&(o?o(e,t.attribute,l):m&&(e.setStrokeStyle(t,t.attribute,d-i,c-r,l),e.stroke())),this.afterRenderStep(t,e,i,r,v,y,f,m,l,n,a,o)}draw(t,e,i,r){let n=nf(t,null==r?void 0:r.theme).polygon;this._draw(t,n,!1,i,r)}};Ap=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),Ac(0,e0(e2)),Ac(0,e1(oz)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Ap);let Ag=!1,Af=new eW(t=>{Ag||(Ag=!0,t(s7).to(Ap).inSingletonScope(),t(s4).toService(s7),t(oz).toService(oK),e5(t,oz))}),Am=class{constructor(t){this.canvasRenderer=t,this.type="polygon",this.numberType=sR}contains(t,e,i){if(!t.AABBBounds.contains(e.x,e.y))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).polygon,{x:s=n.x,y:a=n.y}=t.attribute;if(r.highPerformanceSave(),t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let o=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,i,r)=>!!o||(o=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(o)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=od(r,s+a,r.dpr),o=t.isPointInStroke(e.x,e.y)}),r.highPerformanceRestore(),o}};Am=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(th=0,tu=e0(s7),function(t,e){tu(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Am);let Av=!1,Ay=new eW((t,e,i,r)=>{Av||(Av=!0,t(yP).to(Am).inSingletonScope(),t(yD).toService(yP))}),A_=class{constructor(t){this.canvasRenderer=t,this.type="polygon",this.numberType=sR}contains(t,e,i){if(!t.AABBBounds.contains(e.x,e.y))return!1;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).polygon,{x:s=n.x,y:a=n.y}=t.attribute;if(r.highPerformanceSave(),t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let o=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,i,r)=>!!o||(o=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(o)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=s+a,o=t.isPointInStroke(e.x,e.y)}),r.highPerformanceRestore(),o}};A_=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(td=0,tc=e0(s7),function(t,e){tc(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],A_);let Ab=!1,Ax=new eW((t,e,i,r)=>{Ab||(Ab=!0,t(yy).to(A_).inSingletonScope(),t(yl).toService(yy))});function AS(){AS.__loaded||(AS.__loaded=!0,aj.RegisterGraphicCreator("polygon",SU),r4.load(Af),r4.load(yo?Ay:Ax))}AS.__loaded=!1;class Ak extends se{constructor(t){super(t),this.type="glyph",this.numberType=sC,this.subGraphic=[],this._onInit&&this._onInit(this),this.valid=this.isValid()}setSubGraphic(t){this.detachSubGraphic(),this.subGraphic=t,t.forEach(t=>{t.glyphHost=this,Object.setPrototypeOf(t.attribute,this.attribute)}),this.valid=this.isValid(),this.addUpdateBoundTag()}detachSubGraphic(){this.subGraphic.forEach(t=>{t.glyphHost=null,Object.setPrototypeOf(t.attribute,{})})}getSubGraphic(){return this.subGraphic}onInit(t){this._onInit=t}onUpdate(t){this._onUpdate=t}isValid(){return!0}setAttribute(t,e,i,r){super.setAttribute(t,e,i,r),this.subGraphic.forEach(t=>{t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()})}setAttributes(t,e=!1,i){super.setAttributes(t,e,i),this.subGraphic.forEach(t=>{t.addUpdateShapeAndBoundsTag(),t.addUpdatePositionTag()})}translate(t,e){return super.translate(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}translateTo(t,e){return super.translateTo(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}scale(t,e,i){return super.scale(t,e,i),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}scaleTo(t,e){return super.scaleTo(t,e),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}rotate(t){return super.rotate(t),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}rotateTo(t){return super.rotate(t),this.subGraphic.forEach(t=>{t.addUpdatePositionTag(),t.addUpdateBoundTag()}),this}doUpdateAABBBounds(){this._AABBBounds.clear();let t=rj.graphicService.updateGlyphAABBBounds(this.attribute,nf(this).glyph,this._AABBBounds,this);return this.clearUpdateBoundTag(),t}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}needUpdateTags(t){return!1}needUpdateTag(t){return!1}useStates(t,e){var i;if(!t.length)return void this.clearStates(e);if(!((null===(i=this.currentStates)||void 0===i?void 0:i.length)!==t.length||t.some((t,e)=>this.currentStates[e]!==t)))return;this.stopStateAnimates();let r={},n=this.subGraphic.map(()=>({}));t.forEach(e=>{var i;let s=this.glyphStateProxy?this.glyphStateProxy(e,t):this.glyphStates[e];s&&(Object.assign(r,s.attributes),(null===(i=s.subAttributes)||void 0===i?void 0:i.length)&&n.forEach((t,e)=>{Object.assign(t,s.subAttributes[e])}))}),this.subGraphic.forEach((i,r)=>{i.updateNormalAttrs(n[r]),i.applyStateAttrs(n[r],t,e)}),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}clearStates(t){this.stopStateAnimates(),this.hasState()&&this.normalAttrs?(this.currentStates=[],this.subGraphic.forEach(e=>{e.applyStateAttrs(e.normalAttrs,this.currentStates,t,!0),e.normalAttrs=null}),this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}clone(){let t=new Ak(Object.assign({},this.attribute));return t.setSubGraphic(this.subGraphic.map(t=>t.clone())),t}getNoWorkAnimateAttr(){return Ak.NOWORK_ANIMATE_ATTR}}function AA(t){return new Ak(t)}Ak.NOWORK_ANIMATE_ATTR=st;let Aw=class{constructor(){this.numberType=sC}drawShape(t,e,i,r,n,s,a,o){n.drawContribution&&t.getSubGraphic().forEach(t=>{let l=n.drawContribution.getRenderContribution(t);l&&l.drawShape&&l.drawShape(t,e,i,r,n,s,a,o)})}draw(t,e,i,r){let{context:n}=i;if(!n||(n.highPerformanceSave(),!i.drawContribution))return;let s=nf(t),a=t.getSubGraphic();a.length&&a.forEach(t=>{i.drawContribution.renderItem(t,i,{theme:s})}),n.highPerformanceRestore()}};Aw=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],Aw);let AM=!1,AC=new eW(t=>{AM||(AM=!0,t(aa).to(Aw).inSingletonScope(),t(s4).toService(aa))}),AT=class{constructor(t){this.canvasRenderer=t,this.type="glyph",this.numberType=sC}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=null==i?void 0:i.pickerService;if(n){let r=!1;return t.getSubGraphic().forEach(t=>{if(r)return;let s=n.pickItem(t,e,null,i);r=!(!s||!s.graphic)}),r}return!1}};AT=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(tp=0,tg=e0(aa),function(t,e){tg(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],AT);let AE=!1,AO=new eW((t,e,i,r)=>{AE||(AE=!0,t(yI).to(AT).inSingletonScope(),t(yD).toService(yI))}),AP=class{constructor(t){this.canvasRenderer=t,this.type="glyph",this.numberType=sC}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=null==i?void 0:i.pickerService;if(n){let r=!1;return t.getSubGraphic().forEach(t=>{r||(r=!!n.pickItem(t,e,null,i))}),r}return!1}};AP=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(tf=0,tm=e0(aa),function(t,e){tm(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],AP);let AR=!1,AB=new eW((t,e,i,r)=>{AR||(AR=!0,t(y_).to(AP).inSingletonScope(),t(AP).toService(y_))});function AI(){AI.__loaded||(AI.__loaded=!0,aj.RegisterGraphicCreator("glyph",AA),r4.load(AC),r4.load(yo?AO:AB))}AI.__loaded=!1;let AL=()=>{Sg(),SB(),d0.registerGraphic(c8.arc,Sv)},AD=()=>{Sg(),SV(),d0.registerGraphic(c8.arc3d,SL)},AF=()=>{Sg(),S0(),d0.registerGraphic(c8.pyramid3d,SY)},Aj=()=>{Sg(),ki(),d0.registerGraphic(c8.area,S3)},AN=()=>{Sg(),v8(),d0.registerGraphic(c8.group,sG)},Az=()=>{Sg(),k_(),d0.registerGraphic(c8.image,ks)},AH=()=>{Sg(),kP(),d0.registerGraphic(c8.line,kS)},AV=()=>{Sg(),kU(),d0.registerGraphic(c8.path,kI)},AW=()=>{Sg(),bp(),d0.registerGraphic(c8.rect,_4)},AG=()=>{Sg(),k1(),d0.registerGraphic(c8.rect3d,kK)},AU=()=>{Sg(),kP(),d0.registerGraphic(c8.rule,kS)},A$=()=>{Sg(),_2(),d0.registerGraphic(c8.symbol,_G)},AY=()=>{Sg(),yG(),Al(),d0.registerGraphic(c8.text,yt)},AK=()=>{Sg(),AS(),d0.registerGraphic(c8.polygon,SU)},AZ=()=>{Sg(),Al(),d0.registerGraphic(c8.richtext,k7)},AX=()=>{Sg(),_2(),d0.registerGraphic(c8.cell,_G)},Aq=()=>{Sg(),AI(),d0.registerGraphic(c8.glyph,AA)};class AJ extends Sd{constructor(){super(...arguments),this.type=AJ.type,this._marks=[]}getMarks(){return this._marks}_getDefaultStyle(){return Object.assign({},super._getDefaultStyle())}isMarkExist(t){return void 0!==this._marks.find(e=>e.id===t.id||e.name===t.name)}addMark(t){return this.isMarkExist(t)?(hd("Mark already exists, add mark failed."),!1):(this._marks.push(t),!0)}removeMark(t){let e=this._marks.findIndex(e=>e.id===t.id||e.name===t.name);return -1===e?(hd("Mark does not exists, removeMark failed."),!1):(this._marks.splice(e,1),!0)}getMarkInType(t){return this._marks.filter(e=>e.type===t)}getMarkInId(t){return this._marks.find(e=>e.id===t)}getMarkInName(t){return this._marks.find(e=>e.name===t)}_compileProduct(t){super._compileProduct(t),this._product.configure({zIndex:this.getZIndex()}),(null==t?void 0:t.ignoreChildren)||this.getMarks().forEach(t=>{t.getProduct()&&t.removeProduct(),t.compile({group:this._product})})}}AJ.type="group";let AQ=()=>{AN(),de.registerMark(AJ.type,AJ)},A0=t=>({type:"clipIn",options:{clipDimension:"horizontal"===t.direction?"y":"x"}}),A1={type:"fadeIn"},A2=t=>({type:"horizontal"===t.direction?"growPointsXIn":"growPointsYIn",options:{orient:"horizontal"===t.direction?"positive":"negative"}}),A3=(t,e,i)=>{var r;let n=t.getGraphicAttribute("clipRangeByDimension",!1),s=null!==(r=t.getGraphicAttribute("clipRange",!1))&&void 0!==r?r:1;return e&&e.clipDimension?{from:{clipRange:0,clipRangeByDimension:e.clipDimension},to:{clipRange:s,clipRangeByDimension:n}}:{from:{clipRange:0},to:{clipRange:s}}},A5=(t,e,i)=>{var r;let n=t.getGraphicAttribute("clipRangeByDimension",!0),s=null!==(r=t.getGraphicAttribute("clipRange",!0))&&void 0!==r?r:1;return e&&e.clipDimension?{from:{clipRange:s,clipRangeByDimension:e.clipDimension},to:{clipRange:0,clipRangeByDimension:n}}:{from:{clipRange:s},to:{clipRange:0}}},A4=(t,e,i)=>{var r,n,s,a;let o=null!==(r=t.getFinalAnimationAttributes())&&void 0!==r?r:{};return{from:{opacity:0,fillOpacity:0,strokeOpacity:0},to:{opacity:null!==(n=o.opacity)&&void 0!==n?n:1,fillOpacity:null!==(s=o.fillOpacity)&&void 0!==s?s:1,strokeOpacity:null!==(a=o.strokeOpacity)&&void 0!==a?a:1}}},A8=(t,e,i)=>{var r,n,s;return{from:{opacity:null!==(r=t.getGraphicAttribute("opacity",!0))&&void 0!==r?r:1,fillOpacity:null!==(n=t.getGraphicAttribute("fillOpacity",!0))&&void 0!==n?n:1,strokeOpacity:null!==(s=t.getGraphicAttribute("strokeOpacity",!0))&&void 0!==s?s:1},to:{opacity:0,fillOpacity:0,strokeOpacity:0}}},A6=(t,e,i)=>{switch(null==e?void 0:e.direction){case"x":{let e=t.getFinalAnimationAttribute("x"),i=t.getFinalAnimationAttribute("x1"),r=t.getFinalAnimationAttribute("width");return{from:eO(r)?{x:e+r/2,x1:void 0,width:0}:{x:(e+i)/2,x1:(e+i)/2,width:void 0},to:{x:e,x1:i,width:r}}}case"y":{let e=t.getFinalAnimationAttribute("y"),i=t.getFinalAnimationAttribute("y1"),r=t.getFinalAnimationAttribute("height");return{from:eO(r)?{y:e+r/2,y1:void 0,height:0}:{y:(e+i)/2,y1:(e+i)/2,height:void 0},to:{y:e,y1:i,height:r}}}default:{let e=t.getFinalAnimationAttribute("x"),i=t.getFinalAnimationAttribute("x1"),r=t.getFinalAnimationAttribute("width"),n=t.getFinalAnimationAttribute("y"),s=t.getFinalAnimationAttribute("y1"),a=t.getFinalAnimationAttribute("height"),o={};return eO(r)?(o.x=e+r/2,o.width=0,o.x1=void 0):(o.x=(e+i)/2,o.x1=(e+i)/2,o.width=void 0),eO(a)?(o.y=n+a/2,o.height=0,o.y1=void 0):(o.y=(n+s)/2,o.y1=(n+s)/2,o.height=void 0),{from:o,to:{x:e,y:n,x1:i,y1:s,width:r,height:a}}}}},A9=(t,e,i)=>{switch(null==e?void 0:e.direction){case"x":{let e=t.getFinalAnimationAttribute("x"),i=t.getFinalAnimationAttribute("x1"),r=t.getFinalAnimationAttribute("width");return{to:eO(r)?{x:e+r/2,x1:void 0,width:0}:{x:(e+i)/2,x1:(e+i)/2,width:void 0}}}case"y":{let e=t.getFinalAnimationAttribute("y"),i=t.getFinalAnimationAttribute("y1"),r=t.getFinalAnimationAttribute("height");return{to:eO(r)?{y:e+r/2,y1:void 0,height:0}:{y:(e+i)/2,y1:(e+i)/2,height:void 0}}}default:{let e=t.getFinalAnimationAttribute("x"),i=t.getFinalAnimationAttribute("y"),r=t.getFinalAnimationAttribute("x1"),n=t.getFinalAnimationAttribute("y1"),s=t.getFinalAnimationAttribute("width"),a=t.getFinalAnimationAttribute("height"),o={};return eO(s)?(o.x=e+s/2,o.width=0,o.x1=void 0):(o.x=(e+r)/2,o.x1=(e+r)/2,o.width=void 0),eO(a)?(o.y=i+a/2,o.height=0,o.y1=void 0):(o.y=(i+n)/2,o.y1=(i+n)/2,o.height=void 0),{to:o}}}},A7=(t,e,i)=>{var r;return!1!==(null!==(r=null==e?void 0:e.overall)&&void 0!==r&&r)?function(t,e,i){var r;let n;let s=t.getFinalAnimationAttribute("x"),a=t.getFinalAnimationAttribute("x1"),o=t.getFinalAnimationAttribute("width");return e&&"negative"===e.orient?ey(e.overall)?n=e.overall:i.group?(n=null!==(r=i.groupWidth)&&void 0!==r?r:i.group.getBounds().width(),i.groupWidth=n):n=i.width:n=ey(null==e?void 0:e.overall)?null==e?void 0:e.overall:0,{from:{x:n,x1:ej(a)?void 0:n,width:ej(o)?void 0:0},to:{x:s,x1:a,width:o}}}(t,e,i):function(t,e,i){let r=t.getFinalAnimationAttribute("x"),n=t.getFinalAnimationAttribute("x1"),s=t.getFinalAnimationAttribute("width");if(e&&"negative"===e.orient){let t=eO(s)?Math.max(r,r+s):Math.max(r,n);return{from:{x:t,x1:ej(n)?void 0:t,width:ej(s)?void 0:0},to:{x:r,x1:n,width:s}}}let a=eO(s)?Math.min(r,r+s):Math.min(r,n);return{from:{x:a,x1:ej(n)?void 0:a,width:ej(s)?void 0:0},to:{x:r,x1:n,width:s}}}(t,e,0)},wt=(t,e,i)=>{var r;return!1!==(null!==(r=null==e?void 0:e.overall)&&void 0!==r&&r)?function(t,e,i){var r;let n;let s=t.getFinalAnimationAttribute("x1"),a=t.getFinalAnimationAttribute("width");return e&&"negative"===e.orient?ey(e.overall)?n=e.overall:i.group?(n=null!==(r=i.groupWidth)&&void 0!==r?r:i.group.getBounds().width(),i.groupWidth=n):n=i.width:n=ey(null==e?void 0:e.overall)?e.overall:0,{to:{x:n,x1:ej(s)?void 0:n,width:ej(a)?void 0:0}}}(t,e,i):function(t,e,i){let r=t.getFinalAnimationAttribute("x"),n=t.getFinalAnimationAttribute("x1"),s=t.getFinalAnimationAttribute("width");if(e&&"negative"===e.orient){let t=eO(s)?Math.max(r,r+s):Math.max(r,n);return{to:{x:t,x1:ej(n)?void 0:t,width:ej(s)?void 0:0}}}let a=eO(s)?Math.min(r,r+s):Math.min(r,n);return{to:{x:a,x1:ej(n)?void 0:a,width:ej(s)?void 0:0}}}(t,e,0)},we=(t,e,i)=>{var r;return!1!==(null!==(r=null==e?void 0:e.overall)&&void 0!==r&&r)?function(t,e,i){var r;let n;let s=t.getFinalAnimationAttribute("y"),a=t.getFinalAnimationAttribute("y1"),o=t.getFinalAnimationAttribute("height");return e&&"negative"===e.orient?ey(e.overall)?n=e.overall:i.group?(n=null!==(r=i.groupHeight)&&void 0!==r?r:i.group.getBounds().height(),i.groupHeight=n):n=i.height:n=ey(null==e?void 0:e.overall)?e.overall:0,{from:{y:n,y1:ej(a)?void 0:n,height:ej(o)?void 0:0},to:{y:s,y1:a,height:o}}}(t,e,i):function(t,e,i){let r=t.getFinalAnimationAttribute("y"),n=t.getFinalAnimationAttribute("y1"),s=t.getFinalAnimationAttribute("height");if(e&&"negative"===e.orient){let t=eO(s)?Math.max(r,r+s):Math.max(r,n);return{from:{y:t,y1:ej(n)?void 0:t,height:ej(s)?void 0:0},to:{y:r,y1:n,height:s}}}let a=eO(s)?Math.min(r,r+s):Math.min(r,n);return{from:{y:a,y1:ej(n)?void 0:a,height:ej(s)?void 0:0},to:{y:r,y1:n,height:s}}}(t,e,0)},wi=(t,e,i)=>{var r;return!1!==(null!==(r=null==e?void 0:e.overall)&&void 0!==r&&r)?function(t,e,i){var r;let n;let s=t.getFinalAnimationAttribute("y1"),a=t.getFinalAnimationAttribute("height");return e&&"negative"===e.orient?ey(e.overall)?n=e.overall:i.group?(n=null!==(r=i.groupHeight)&&void 0!==r?r:i.group.getBounds().height(),i.groupHeight=n):n=i.height:n=ey(null==e?void 0:e.overall)?e.overall:0,{to:{y:n,y1:ej(s)?void 0:n,height:ej(a)?void 0:0}}}(t,e,i):function(t,e,i){let r=t.getFinalAnimationAttribute("y"),n=t.getFinalAnimationAttribute("y1"),s=t.getFinalAnimationAttribute("height");if(e&&"negative"===e.orient){let t=eO(s)?Math.max(r,r+s):Math.max(r,n);return{to:{y:t,y1:ej(n)?void 0:t,height:ej(s)?void 0:0}}}let a=eO(s)?Math.min(r,r+s):Math.min(r,n);return{to:{y:a,y1:ej(n)?void 0:a,height:ej(s)?void 0:0}}}(t,e,0)},wr=(t,e,i)=>{let r=t.getFinalAnimationAttributes();return e&&"anticlockwise"===e.orient?{from:{startAngle:null==r?void 0:r.endAngle},to:{startAngle:null==r?void 0:r.startAngle}}:{from:{endAngle:null==r?void 0:r.startAngle},to:{endAngle:null==r?void 0:r.endAngle}}},wn=(t,e,i)=>{let r=t.getFinalAnimationAttributes();if(e&&"anticlockwise"===e.orient){let t=ey(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:t,endAngle:t},to:{startAngle:null==r?void 0:r.startAngle,endAngle:null==r?void 0:r.endAngle}}}let n=ey(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:n,endAngle:n},to:{startAngle:null==r?void 0:r.startAngle,endAngle:null==r?void 0:r.endAngle}}},ws=(t,e,i)=>{var r;return!1!==(null!==(r=null==e?void 0:e.overall)&&void 0!==r&&r)?wn(t,e):wr(t,e)},wa=(t,e,i)=>{let r=t.getFinalAnimationAttributes();return e&&"anticlockwise"===e.orient?{from:{startAngle:t.getGraphicAttribute("startAngle",!0)},to:{startAngle:null==r?void 0:r.endAngle}}:{from:{endAngle:t.getGraphicAttribute("endAngle",!0)},to:{endAngle:null==r?void 0:r.startAngle}}},wo=(t,e,i)=>{if(e&&"anticlockwise"===e.orient){let i=ey(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:t.getGraphicAttribute("startAngle",!0),endAngle:t.getGraphicAttribute("endAngle",!0)},to:{startAngle:i,endAngle:i}}}let r=ey(null==e?void 0:e.overall)?e.overall:0;return{from:{startAngle:t.getGraphicAttribute("startAngle",!0),endAngle:t.getGraphicAttribute("endAngle",!0)},to:{startAngle:r,endAngle:r}}},wl=(t,e,i)=>{var r;return!1!==(null!==(r=null==e?void 0:e.overall)&&void 0!==r&&r)?wo(t,e):wa(t,e)},wh=(t,e,i)=>{let r=t.getFinalAnimationAttributes();return e&&"inside"===e.orient?{from:{innerRadius:null==r?void 0:r.outerRadius},to:{innerRadius:null==r?void 0:r.innerRadius}}:{from:{outerRadius:null==r?void 0:r.innerRadius},to:{outerRadius:null==r?void 0:r.outerRadius}}},wu=(t,e,i)=>{let r=t.getFinalAnimationAttributes(),n=ey(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:n,outerRadius:n},to:{innerRadius:null==r?void 0:r.innerRadius,outerRadius:null==r?void 0:r.outerRadius}}},wd=(t,e,i)=>{var r;return!1!==(null!==(r=null==e?void 0:e.overall)&&void 0!==r&&r)?wu(t,e):wh(t,e)},wc=(t,e,i)=>{let r=t.getFinalAnimationAttributes();return e&&"inside"===e.orient?{from:{innerRadius:t.getGraphicAttribute("innerRadius",!0)},to:{innerRadius:null==r?void 0:r.outerRadius}}:{from:{outerRadius:t.getGraphicAttribute("outerRadius",!0)},to:{outerRadius:null==r?void 0:r.innerRadius}}},wp=(t,e,i)=>{let r=ey(null==e?void 0:e.overall)?e.overall:0;return{from:{innerRadius:t.getGraphicAttribute("innerRadius",!0),outerRadius:t.getGraphicAttribute("outerRadius",!0)},to:{innerRadius:r,outerRadius:r}}},wg=(t,e,i)=>{var r;return!1!==(null!==(r=null==e?void 0:e.overall)&&void 0!==r&&r)?wp(t,e):wc(t,e)},wf=(t,e,i)=>{let r=t.getGraphicAttribute("points",!1),n={x:0,y:0};return r.forEach(t=>{n.x+=t.x,n.y+=t.y}),n.x/=r.length,n.y/=r.length,e&&e.center&&(l1(e.center.x)&&(n.x=e.center.x),l1(e.center.y)&&(n.y=e.center.y)),"area"===t.mark.markType&&(n.x1=n.x,n.y1=n.y),r.map(t=>Object.assign({},t,n))},wm=(t,e,i)=>({from:{points:wf(t,e)},to:{points:t.getGraphicAttribute("points",!1)}}),wv=(t,e,i)=>({from:{points:t.getGraphicAttribute("points",!0)},to:{points:wf(t,e)}}),wy=(t,e,i)=>t.getGraphicAttribute("points",!1).map(t=>{var r;if(e&&"negative"===e.orient){let e=i.width;return i.group&&(e=null!==(r=i.groupWidth)&&void 0!==r?r:i.group.getBounds().width(),i.groupWidth=e),Object.assign(Object.assign({},t),{x:e,y:t.y,x1:e,y1:t.y1,defined:!1!==t.defined})}return Object.assign(Object.assign({},t),{x:0,y:t.y,x1:0,y1:t.y1,defined:!1!==t.defined})}),w_=(t,e,i)=>({from:{points:wy(t,e,i)},to:{points:t.getGraphicAttribute("points",!1)}}),wb=(t,e,i)=>({from:{points:t.getGraphicAttribute("points",!0)},to:{points:wy(t,e,i)}}),wx=(t,e,i)=>t.getGraphicAttribute("points",!1).map(t=>{var r;if(e&&"negative"===e.orient){let e=i.height;return i.group&&(e=null!==(r=i.groupHeight)&&void 0!==r?r:i.group.getBounds().height(),i.groupHeight=e),Object.assign(Object.assign({},t),{x:t.x,y:e,x1:t.x1,y1:e,defined:!1!==t.defined})}return Object.assign(Object.assign({},t),{x:t.x,y:0,x1:t.x1,y1:0,defined:!1!==t.defined})}),wS=(t,e,i)=>({from:{points:wx(t,e,i)},to:{points:t.getGraphicAttribute("points",!1)}}),wk=(t,e,i)=>({from:{points:t.getGraphicAttribute("points",!0)},to:{points:wx(t,e,i)}}),wA=(t,e,i)=>{var r,n;let{offset:s=0,orient:a,direction:o,point:l,excludeChannels:h=[]}=null!=e?e:{},u=0,d=0;"negative"===a&&(i.group?(u=null!==(r=i.groupWidth)&&void 0!==r?r:i.group.getBounds().width(),d=null!==(n=i.groupHeight)&&void 0!==n?n:i.group.getBounds().height(),i.groupWidth=u,i.groupHeight=d):(u=i.width,d=i.height)),u+=s,d+=s;let c=nx(l)?l.call(null,t.getDatum(),t,i):l,p=c&&l1(c.x)?c.x:u,g=c&&l1(c.y)?c.y:d,f=h.includes("x")?t.getGraphicAttribute("x"):t.getFinalAnimationAttribute("x"),m=h.includes("y")?t.getGraphicAttribute("y"):t.getFinalAnimationAttribute("y");switch(o){case"x":return{from:{x:p},to:{x:f}};case"y":return{from:{y:g},to:{y:m}};default:return{from:{x:p,y:g},to:{x:f,y:m}}}},ww=(t,e,i)=>{var r,n;let{offset:s=0,orient:a,direction:o,point:l}=null!=e?e:{},h=i.group?i.group.getBounds():null,u=null!==(r=null==h?void 0:h.width())&&void 0!==r?r:i.width,d=null!==(n=null==h?void 0:h.height())&&void 0!==n?n:i.height,c=nx(l)?l.call(null,t.getDatum(),t,i):l,p=c&&l1(c.x)?c.x:("negative"===a?u:0)+s,g=c&&l1(c.y)?c.y:("negative"===a?d:0)+s;switch(o){case"x":return{from:{x:t.getGraphicAttribute("x",!0)},to:{x:p}};case"y":return{from:{y:t.getGraphicAttribute("y",!0)},to:{y:g}};default:return{from:{x:t.getGraphicAttribute("x",!0),y:t.getGraphicAttribute("y",!0)},to:{x:p,y:g}}}},wM=(t,e,i)=>{var r,n,s,a;let o=t.getFinalAnimationAttributes();switch(null==e?void 0:e.direction){case"x":return{from:{scaleX:0},to:{scaleX:null!==(r=null==o?void 0:o.scaleX)&&void 0!==r?r:1}};case"y":return{from:{scaleY:0},to:{scaleY:null!==(n=null==o?void 0:o.scaleY)&&void 0!==n?n:1}};default:return{from:{scaleX:0,scaleY:0},to:{scaleX:null!==(s=null==o?void 0:o.scaleX)&&void 0!==s?s:1,scaleY:null!==(a=null==o?void 0:o.scaleY)&&void 0!==a?a:1}}}},wC=(t,e,i)=>{var r,n,s,a;switch(null==e?void 0:e.direction){case"x":return{from:{scaleX:null!==(r=t.getGraphicAttribute("scaleX",!0))&&void 0!==r?r:1},to:{scaleX:0}};case"y":return{from:{scaleY:null!==(n=t.getGraphicAttribute("scaleY",!0))&&void 0!==n?n:1},to:{scaleY:0}};default:return{from:{scaleX:null!==(s=t.getGraphicAttribute("scaleX",!0))&&void 0!==s?s:1,scaleY:null!==(a=t.getGraphicAttribute("scaleY",!0))&&void 0!==a?a:1},to:{scaleX:0,scaleY:0}}}},wT={symbol:["_mo_hide_","visible"]},wE=(t,e,i)=>{let r;let n=Object.assign({},t.getPrevGraphicAttributes()),s=Object.assign({},t.getNextGraphicAttributes());e&&om(e.excludeChannels).forEach(t=>{delete n[t],delete s[t]}),t.mark&&t.mark.markType&&(r=wT[t.mark.markType])&&r.forEach(t=>{delete n[t],delete s[t]}),Object.keys(s).forEach(t=>{mA(t,n,s)&&(delete n[t],delete s[t])});let a=t.getFinalGraphicAttributes();return Object.keys(n).forEach(t=>{ej(s[t])&&(ej(a[t])||my(n[t],a[t])?delete n[t]:s[t]=a[t])}),{from:n,to:s}},wO=(t,e,i)=>{var r;let n=null!==(r=t.getFinalAnimationAttribute("angle"))&&void 0!==r?r:0,s=0;return{from:{angle:s=dg(n/(2*Math.PI),0)?Math.round(n/(2*Math.PI))*Math.PI*2:l1(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(n/(2*Math.PI))*Math.PI*2:Math.floor(n/(2*Math.PI))*Math.PI*2},to:{angle:n}}},wP=(t,e,i)=>{var r;let n=null!==(r=t.getGraphicAttribute("angle",!0))&&void 0!==r?r:0,s=0;return s=dg(n/(2*Math.PI),0)?Math.round(n/(2*Math.PI))*Math.PI*2:l1(null==e?void 0:e.angle)?e.angle:"anticlockwise"===(null==e?void 0:e.orient)?Math.ceil(n/(2*Math.PI))*Math.PI*2:Math.floor(n/(2*Math.PI))*Math.PI*2,{from:{angle:n},to:{angle:s}}},wR=()=>{d0.registerAnimationType("clipIn",A3)},wB=()=>{d0.registerAnimationType("clipOut",A5)},wI=()=>{d0.registerAnimationType("fadeIn",A4)},wL=()=>{d0.registerAnimationType("fadeOut",A8)},wD=()=>{d0.registerAnimationType("growCenterIn",A6)},wF=()=>{d0.registerAnimationType("growCenterOut",A9)},wj=()=>{d0.registerAnimationType("growHeightIn",we)},wN=()=>{d0.registerAnimationType("growHeightOut",wi)},wz=()=>{d0.registerAnimationType("growWidthIn",A7)},wH=()=>{d0.registerAnimationType("growWidthOut",wt)},wV=()=>{d0.registerAnimationType("growPointsIn",wm)},wW=()=>{d0.registerAnimationType("growPointsOut",wv)},wG=()=>{d0.registerAnimationType("growPointsXIn",w_)},wU=()=>{d0.registerAnimationType("growPointsXOut",wb)},w$=()=>{d0.registerAnimationType("growPointsYIn",wS)},wY=()=>{d0.registerAnimationType("growPointsYOut",wk)},wK=()=>{d0.registerAnimationType("growAngleIn",ws)},wZ=()=>{d0.registerAnimationType("growAngleOut",wl)},wX=()=>{d0.registerAnimationType("growRadiusIn",wd)},wq=()=>{d0.registerAnimationType("growRadiusOut",wg)},wJ=()=>{d0.registerAnimationType("moveIn",wA)},wQ=()=>{d0.registerAnimationType("moveOut",ww)},w0=()=>{d0.registerAnimationType("scaleIn",wM)},w1=()=>{d0.registerAnimationType("scaleOut",wC)},w2=()=>{d0.registerAnimationType("rotateIn",wO)},w3=()=>{d0.registerAnimationType("rotateOut",wP)},w5=()=>{d0.registerAnimationType("update",wE)},w4={appear:{duration:1e3,easing:"cubicOut"},update:{type:"update",duration:300,easing:"linear"},enter:{duration:300,easing:"linear"},exit:{duration:300,easing:"linear"},disappear:{duration:500,easing:"cubicIn"}},w8={appear:{type:"scaleIn"},enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:{type:"scaleOut"}},w6={appear:{type:"fadeIn"},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}},w9=()=>{de.registerAnimation("scaleInOut",()=>w8)},w7=()=>{de.registerAnimation("fadeInOut",()=>w6)},Mt=()=>{de.registerAnimation("cartesianGroupClip",t=>({appear:{custom:mY,customParameters:(e,i)=>({animationType:"in",group:i.getGraphicItem(),direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()})},disappear:{custom:mY,customParameters:(e,i)=>({animationType:"out",group:i.getGraphicItem(),direction:t.direction(),width:t.width(),height:t.height(),orient:t.orient()})}}))},Me=(t,e)=>({appear:function(t,e){switch(e){case"grow":return A2(t);case"fadeIn":return A1;default:return A0(t)}}(t,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},update:[{type:"update",options:{excludeChannels:["points","defined"]}},{channel:["points"],custom:mG,duration:w4.update.duration,easing:w4.update.easing,customParameters:{clipRangeByDimension:"horizontal"===t.direction?"y":"x"}}],disappear:{type:"clipOut"}}),Mi=()=>{de.registerAnimation("line",Me)},Mr=()=>{de.registerAnimation("area",Me)},Mn=()=>{v2.useRegisters([wj,wN,wz,wH,wD,wF])},Ms=()=>{v2.useRegisters([wX,wq,wK,wZ])},Ma=()=>{v2.useRegisters([wV,wW,wG,wU,w$,wY,wR,wB])},Mo=()=>{v2.useRegisters([wV,wW])},Ml=(t,e,i)=>e.filter(e=>t.callback(e,i)),Mh=(t,e,i)=>{let r=t.callback,n=t.as;if(!t.all)return e.forEach(t=>{let e=r(t,i);if(!ej(n)){if(ej(t))return;t[n]=e}return e}),e;let s=r(e,i);return ej(n)||ej(e)?s:(e[n]=s,e)};function Mu(t){return t.reduce((t,e)=>t+e,0)}let Md={min:o_,max:oy,average:function(t){return 0===t.length?0:Mu(t)/t.length},sum:Mu};function Mc(t,e,i,r){let n=Math.floor(e.length/t),s=[],a=e.length,o,l,h,u=0,d=0;s[d++]=u;for(let t=1;t<a-1;t+=n){let i=Math.min(t+n,a-1),c=Math.min(t+2*n,a),p=(c+i)/2,g=0;for(let t=i;t<c;t++){let i=e[t][r];Number.isNaN(i)||(g+=i)}g/=c-i;let f=t,m=Math.min(t+n,a),v=t-1,y=e[u][r];o=-1,h=f;for(let t=f;t<m;t++){let i=e[t][r];Number.isNaN(r)||(l=Math.abs((v-p)*(i-y)-(v-t)*(g-y)))>o&&(o=l,h=t)}s[d++]=h,u=h}return s[d-1]!==a-1&&(s[d++]=a-1),s.map(t=>i?e[t].i:t)}function Mp(t,e,i,r,n){let s=Math.floor(e.length/t),a=[],o=e.length,l=0,h=[];a.push(l),e[l][n]=e[l][n];for(let t=1;t<o-1;t+=s){s>o-t&&(s=o-t,h.length=s),h=[];for(let i=0;i<s;i++)h.push(e[t+i][n]);let i=Md[r](h);e[l=Math.min(Math.round(t+h.length/2)||0,o-1)][n]=i,a.push(l)}return a.map(t=>i?e[t].i:t)}function Mg(t,e,i,r){return Mp(t,e,i,"min",r)}function Mf(t,e,i,r){return Mp(t,e,i,"max",r)}function Mm(t,e,i,r){return Mp(t,e,i,"average",r)}function Mv(t,e,i,r){return Mp(t,e,i,"sum",r)}let My=(t,e)=>{let i=t.size,r=t.factor||1;if(Array.isArray(i)&&(i=Math.floor(i[1]-i[0])),(i*=r)<=0)return[];if(e.length<=i)return e;if(t.skipfirst)return e.slice(0,1);let{mode:n,yfield:s,groupBy:a}=t,o=null!=s?s:"y",l=Mc;if("min"===n?l=Mg:"max"===n?l=Mf:"average"===n?l=Mm:"sum"===n&&(l=Mv),e.length){let t={};if(a){for(let i=0,r=e.length;i<r;i++){let r=e[i],n=r[a];t[n]||(t[n]=[]),t[n].push({[o]:r[o],i:i})}let r=[];return Object.keys(t).forEach(n=>{let s=t[n];if(s.length<=i){let t=s.map(t=>t.i);r=r.concat(t)}else{let t=l(i,s,!0,o);r=r.concat(t),s.forEach(t=>e[t.i][o]=t[o])}}),r.sort((t,e)=>t-e),r.map(t=>e[t])}return l(i,e,!1,o).map(t=>e[t])}return[]},M_=(t,e)=>{if(!e||0===e.length)return;let{radius:i}=t;ej(i)&&"symbol"===e[0].mark.markType&&(i=!0);let{direction:r,delta:n,deltaMul:s=1,groupBy:a}=t,o=e=>{var a;(a=e).forEach(t=>{t.getGraphicAttribute(fS)&&(t.setGraphicAttribute("visible",!0),t.setGraphicAttribute(fS,!1))});let o=t.sort?e.slice().sort((t,e)=>t.getGraphicAttribute("x")-e.getGraphicAttribute("x")):e;0===r?function(t,e,i,r){if(r){let r=-Infinity,n=-Infinity,s=0,a=0,o=ej(e),l=e;t.forEach(t=>{if(!1===t.getGraphicAttribute("visible"))return;let e=t.getGraphicAttribute("size")/2,h=t.getGraphicAttribute("x"),u=t.getGraphicAttribute("y");o&&(l=(e+s)*i),(a=(r-h)**2+(n-u)**2)<(l+s+e)**2?t.getGraphicAttribute("forceShow")||(t.setGraphicAttribute(fS,!0),t.setGraphicAttribute("visible",!1)):n=u,s=e})}}(o,n,s,i):1===r?function(t,e,i,r){if(r){let r=-Infinity,n=0,s=ej(e),a=e;t.forEach(t=>{if(!1===t.getGraphicAttribute("visible"))return;let e=t.getGraphicAttribute("size")/2,o=t.getGraphicAttribute("x");s&&(a=(e+n)*i),Math.abs(o-r)<a+n+e?t.getGraphicAttribute("forceShow")||(t.setGraphicAttribute(fS,!0),t.setGraphicAttribute("visible",!1)):r=o,n=e})}}(o,n,s,i):function(t,e,i,r){if(r){let r=-Infinity,n=0,s=ej(e),a=e;t.forEach(t=>{if(!1===t.getGraphicAttribute("visible"))return;let e=t.getGraphicAttribute("size")/2,o=t.getGraphicAttribute("y");s&&(a=(e+n)*i),Math.abs(o-r)<a+n+e?t.getGraphicAttribute("forceShow")||(t.setGraphicAttribute(fS,!0),t.setGraphicAttribute("visible",!1)):r=o,n=e})}}(o,n,s,i)};if(a){let t=e.reduce((t,e)=>{let i=e.getDatum()[a];return t[i]?t[i].push(e):t[i]=[e],t},{});Object.keys(t).forEach(e=>{o(t[e])})}else o(e);return e},Mb=()=>{d0.registerTransform("sampling",{transform:My,markPhase:"afterEncode"},!0)},Mx=()=>{d0.registerTransform("markoverlap",{transform:M_,markPhase:"afterEncode"},!0)},MS=-.5*Math.PI,Mk=1.5*Math.PI,MA="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol";(tv=tT||(tT={})).selected="selected",tv.selectedReverse="selected_reverse",tv.hover="hover",tv.hoverReverse="hover_reverse";let Mw={[tT.selectedReverse]:{},[tT.selected]:{},[tT.hover]:{},[tT.hoverReverse]:{}},MM={container:"",width:30,height:30,style:{}},MC=(t,e,i,r)=>new rq(Object.assign({defaultFontParams:Object.assign({fontFamily:MA,fontSize:14},r),getTextBounds:i?void 0:ye,specialCharSet:"-/: .,@%'\"~"+rq.ALPHABET_CHAR_SET+rq.ALPHABET_CHAR_SET.toUpperCase()},null!=e?e:{}),t);function MT(t,e,i={}){if(!t)return{width:0,height:0};let r=ye({text:t,fontFamily:e.fontFamily||i.fontFamily||MA,fontSize:e.fontSize||i.fontSize||12,fontWeight:e.fontWeight||i.fontWeight,textAlign:e.textAlign||"center",textBaseline:e.textBaseline,ellipsis:!!e.ellipsis,maxLineWidth:e.maxLineWidth||1/0,lineHeight:e.fontSize||i.fontSize||12});return{width:r.width(),height:r.height()}}function ME(t,e="type"){var i,r;return nb(t.text)&&"type"in t.text?null!==(i=t.text.type)&&void 0!==i?i:"text":e in t&&null!==(r=t[e])&&void 0!==r?r:"text"}function MO(t){var e,i;return t.width=null!==(e=t.width)&&void 0!==e?e:0,t.height=null!==(i=t.height)&&void 0!==i?i:0,t.maxWidth=t.maxLineWidth,t.textConfig=t.text.text||t.text,t}function MP(t,e="type"){let i=ME(t,e);return"rich"===i?aj.richtext(MO(t)):("html"===i?t=function(t){let{text:e,_originText:i}=t,{text:r}=e;return t.html=r,t.text=i,t.renderable=!1,t}(t):"react"===i&&(t=function(t){let{text:e,_originText:i}=t,{text:r}=e;return t.react=r,t.text=i,t.renderable=!1,t}(t)),aj.text(t))}function MR(t,e,i,r,n){"right"===t?"center"===i?e.setAttribute("x",r-n/2):"right"===i||"end"===i?e.setAttribute("x",r):e.setAttribute("x",r-n):"center"===i?e.setAttribute("x",r+n/2):"right"===i||"end"===i?e.setAttribute("x",r+n):e.setAttribute("x",r)}let MB=(t,e,i)=>MC(t,e,i,{fontFamily:uB.fontFamily,fontSize:uB.fontSize});class MI{static instance(){return MI.instance_||(MI.instance_=new MI),MI.instance_}constructor(){this.functions={}}registerFunction(t,e){t&&e&&(this.functions[t]=e)}unregisterFunction(t){t&&delete this.functions[t]}getFunction(t){return this.functions[t]||null}getFunctionNameList(){return Object.keys(this.functions)}}let ML=500,MD=500,MF=1,Mj=class{get displayWidth(){return this._pixelWidth/this._dpr}get displayHeight(){return this._pixelHeight/this._dpr}get id(){return this._id}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get nativeCanvas(){return this._nativeCanvas}get width(){return this._pixelWidth}set width(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}get height(){return this._pixelHeight}set height(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}getContext(t){return this._context}get visiable(){return this._visiable}set visiable(t){this._visiable=t,t?this.show():this.hide()}get dpr(){return this._dpr}set dpr(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}constructor(t){var e;let{nativeCanvas:i,width:r=ML,height:n=MD,dpr:s=MF,x:a,y:o,id:l,canvasControled:h=!0}=t;this._x=null!=a?a:0,this._y=null!=o?o:0,this._pixelWidth=r*s,this._pixelHeight=n*s,this._visiable=!1!==t.visiable,this.controled=h,this._displayWidth=r,this._displayHeight=n,this._dpr=s,this._nativeCanvas=i,this._id=null!==(e=i.id)&&void 0!==e?e:l,l&&(i.id=l),this.init(t)}getNativeCanvas(){return this._nativeCanvas}hide(){}show(){}applyPosition(){}resetStyle(t){}resize(t,e){}toDataURL(t,e){return""}readPixels(t,e,i,r){return this._context.getImageData(t,e,i,r)}convertToBlob(t){throw Error("\u6682\u672A\u5B9E\u73B0")}transferToImageBitmap(){throw Error("\u6682\u672A\u5B9E\u73B0")}release(...t){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}};Mj.env="browser",Mj=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Mj);let MN=[0,0,0],Mz=(t,e,i,r,n,s,a,o)=>{if(o)for(;i>e;)i-=is;else for(;i<e;)i+=is;let l=ie/3*(i>e?1:-1),h=e,u=h;for(;u!==i;){let e=4*Math.tan(Math.abs((u=l>0?Math.min(u+l,i):Math.max(u+l,i))-h)/4)/3,o=u<h?-1:1,d=Math.cos(h),c=Math.sin(h),p=Math.cos(u),g=Math.sin(u),f=d*s+r,m=c*a+n,v=p*s+r,y=g*a+n,_=s*e*o,b=a*e*o;t.push([f-_*c,m+b*d,v+_*g,y-b*p,v,y]),h=u}},MH=class{set fillStyle(t){this.nativeContext.fillStyle=t}get fillStyle(){return this.nativeContext.fillStyle}set font(t){this.nativeContext.font=t}get font(){return this.nativeContext.font}set globalAlpha(t){this.nativeContext.globalAlpha=t*this.baseGlobalAlpha}get globalAlpha(){return this.nativeContext.globalAlpha}set lineCap(t){this.nativeContext.lineCap=t}get lineCap(){return this.nativeContext.lineCap}set lineDashOffset(t){this.nativeContext.lineDashOffset=t}get lineDashOffset(){return this.nativeContext.lineDashOffset}set lineJoin(t){this.nativeContext.lineJoin=t}get lineJoin(){return this.nativeContext.lineJoin}set lineWidth(t){this.nativeContext.lineWidth=t}get lineWidth(){return this.nativeContext.lineWidth}set miterLimit(t){this.nativeContext.miterLimit=t}get miterLimit(){return this.nativeContext.miterLimit}set shadowBlur(t){this.nativeContext.shadowBlur=t}get shadowBlur(){return this.nativeContext.shadowBlur}set shadowColor(t){this.nativeContext.shadowColor=t}get shadowColor(){return this.nativeContext.shadowColor}set shadowOffsetX(t){this.nativeContext.shadowOffsetX=t}get shadowOffsetX(){return this.nativeContext.shadowOffsetX}set shadowOffsetY(t){this.nativeContext.shadowOffsetY=t}get shadowOffsetY(){return this.nativeContext.shadowOffsetY}set strokeStyle(t){this.nativeContext.strokeStyle=t}get strokeStyle(){return this.nativeContext.strokeStyle}set textAlign(t){this.nativeContext.textAlign=t}get textAlign(){return this.nativeContext.textAlign}set textBaseline(t){this.nativeContext.textBaseline=t}get textBaseline(){return this.nativeContext.textBaseline}get inuse(){return!!this._inuse}set inuse(t){!!this._inuse!==t&&(this._inuse=t,t?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}constructor(t,e){this.fillAttributes=Object.assign(Object.assign({},rv),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},r_),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},rb),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;let i=t.nativeCanvas.getContext("2d");if(!i)throw Error("\u53D1\u751F\u9519\u8BEF\uFF0C\u83B7\u53D62d\u4E0A\u4E0B\u6587\u5931\u8D25");this.nativeContext=i,this.canvas=t,this.matrix=new iE(1,0,0,1,0,0),this.stack=[],this.dpr=e,this.applyedMatrix=new iE(1,0,0,1,0,0),this._clearMatrix=new iE(1,0,0,1,0,0),this.baseGlobalAlpha=1}reset(){this.stack.length&&ex.getInstance().warn("\u53EF\u80FD\u5B58\u5728bug\uFF0Cmatrix\u6CA1\u6709\u6E05\u7A7A"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new iE(1,0,0,1,0,0),this.stack.length=0,this.nativeContext.setTransform(1,0,0,1,0,0)}getCanvas(){return this.canvas}getContext(){return this.nativeContext}setTransformForCurrent(t=!1){!t&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}get currentMatrix(){return this.matrix}cloneMatrix(t){return am.allocateByObj(t)}clear(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}restore(){this.nativeContext.restore(),this.stack.length>0&&(am.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0))}highPerformanceRestore(){this.stack.length>0&&(am.free(this.matrix),this.matrix=this.stack.pop())}rotate(t,e=!0){this.matrix.rotate(t),e&&this.setTransformForCurrent()}save(){let t=this.cloneMatrix(this.matrix);this.stack.push(t),this.nativeContext.save()}highPerformanceSave(){let t=this.cloneMatrix(this.matrix);this.stack.push(t)}scale(t,e,i=!0){this.matrix.scale(t,e),i&&this.setTransformForCurrent()}setScale(t,e,i=!0){this.matrix.setScale(t,e),i&&this.setTransformForCurrent()}scalePoint(t,e,i,r,n=!0){this.translate(i,r,!1),this.scale(t,e,!1),this.translate(-i,-r,!1),n&&this.setTransformForCurrent()}setTransform(t,e,i,r,n,s,a=!0,o=this.dpr){this.matrix.setValue(o*t,o*e,o*i,o*r,o*n,o*s),a&&this.setTransformForCurrent()}setTransformFromMatrix(t,e=!0,i=this.dpr){this.matrix.setValue(t.a*i,t.b*i,t.c*i,t.d*i,t.e*i,t.f*i),e&&this.setTransformForCurrent()}resetTransform(t=!0,e=this.dpr){this.setTransform(e,0,0,e,0,0),t&&this.setTransformForCurrent()}transform(t,e,i,r,n,s,a=!0){this.matrix.multiply(t,e,i,r,n,s),a&&this.setTransformForCurrent()}transformFromMatrix(t,e){this.matrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f),e&&this.setTransformForCurrent()}translate(t,e,i=!0){this.matrix.translate(t,e),i&&this.setTransformForCurrent()}rotateDegrees(t,e=!0){let i=t*Math.PI/180;this.rotate(i,e)}rotateAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotate(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}rotateDegreesAbout(t,e,i,r=!0){this.translate(e,i,!1),this.rotateDegrees(t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}beginPath(){this.disableBeginPath||this.nativeContext.beginPath()}clip(t,e){t?"string"==typeof t?this.nativeContext.clip(t):this.nativeContext.clip(t,e):this.nativeContext.clip()}arc(t,e,i,r,n,s,a){if(a=a||0,this.camera){let o=[];Mz(o,r,n,t,e,i,i,s);for(let t=0;t<o.length;++t){let e=o[t];this.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5],a)}}else this.nativeContext.arc(t,e,i,r,n,s)}arcTo(t,e,i,r,n){this.nativeContext.arcTo(t,e,i,r,n)}bezierCurveTo(t,e,i,r,n,s,a){if(a=a||0,this.camera){let o=a,l=a;this.modelMatrix&&(fK(MN,[t,e,a],this.modelMatrix),t=MN[0],e=MN[1],o=MN[2],fK(MN,[i,r,a],this.modelMatrix),i=MN[0],r=MN[1],l=MN[2],fK(MN,[n,s,a],this.modelMatrix),n=MN[0],s=MN[1],a=MN[2]);let h=this.camera.vp(n,s,a);n=h.x,s=h.y,t=(h=this.camera.vp(t,e,o)).x,e=h.y,i=(h=this.camera.vp(i,r,l)).x,r=h.y}this.nativeContext.bezierCurveTo(t,e,i,r,n,s)}closePath(){this.nativeContext.closePath()}ellipse(t,e,i,r,n,s,a,o){null==o?this.nativeContext.ellipse(t,e,i,r,n,s,a):this.nativeContext.ellipse(t,e,i,r,n,s,a,o)}lineTo(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(fK(MN,[t,e,i],this.modelMatrix),t=MN[0],e=MN[1],i=MN[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.lineTo(t,e)}moveTo(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(fK(MN,[t,e,i],this.modelMatrix),t=MN[0],e=MN[1],i=MN[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.moveTo(t,e)}quadraticCurveTo(t,e,i,r,n){if(n=n||0,this.camera){let s=n;this.modelMatrix&&(fK(MN,[t,e,n],this.modelMatrix),t=MN[0],e=MN[1],s=MN[2],fK(MN,[i,r,n],this.modelMatrix),i=MN[0],r=MN[1],n=MN[2]);let a=this.camera.vp(i,r,n);i=a.x,r=a.y,t=(a=this.camera.vp(t,e,s)).x,e=a.y}this.nativeContext.quadraticCurveTo(t,e,i,r)}rect(t,e,i,r,n){n=n||0,this.camera?(this.moveTo(t,e,n),this.lineTo(t+i,e,n),this.lineTo(t+i,e+r,n),this.lineTo(t,e+r,n),this.closePath()):this.nativeContext.rect(t,e,i,r)}createImageData(){let t=arguments;return 2===t.length?this.nativeContext.createImageData(t[0],t[1]):1===t.length?this.nativeContext.createImageData(t[0]):null}createLinearGradient(t,e,i,r){return this.nativeContext.createLinearGradient(t,e,i,r)}createPattern(t,e){return 0===t.width||0===t.height?null:this.nativeContext.createPattern(t,e)}createRadialGradient(t,e,i,r,n,s){return this.nativeContext.createRadialGradient(t,e,i,r,n,s)}createConicGradient(t,e,i,r){let n,s=!1,a=this;return{stops:[],addColorStop(t,e){this.stops.push([t,e]),s=!0},GetPattern(o,l,h){return s&&(h||(h=r-i),n=function(t,e,i,r,n,s,a,o,l){let h=Math.floor(180*n/Math.PI),u=S_.GetCanvas(),d=S_.GetCtx();if(!d)return null;let c=Sx.GetSize(o),p=Sx.GetSize(l),g=Sx.Get(e,i,r,s,a,c,p);if(g)return g;let f=Math.sqrt(Math.max(Math.max(Math.pow(i,2)+Math.pow(r,2),Math.pow(c-i,2)+Math.pow(r,2)),Math.max(Math.pow(c-i,2)+Math.pow(p-r,2),Math.pow(i,2)+Math.pow(p-r,2)))),m=h+1,v=n/Math.max(1,m-1),y=Sb.getInstance().GetOrCreate(i,r,c,p,e,m),_=2*Math.PI*f/360;u.width=c,u.height=p,d.setTransform(1,0,0,1,0,0),d.clearRect(0,0,c,p),d.translate(i,r),d.rotate(s);for(let t=0,e=m-1;t<e&&!(s+t*v>a);t++){let e=y.getColor(t);d.beginPath(),d.rotate(v),d.moveTo(0,0),d.lineTo(f,-2*_),d.lineTo(f,0),d.fillStyle=e,d.closePath(),d.fill()}let b=d.getImageData(0,0,c,p);return u.width=b.width,u.height=b.height,d.putImageData(b,0,0),(g=t.createPattern(u,"no-repeat"))&&Sx.Set(e,i,r,s,a,g,c,p),g}(a,this.stops,t,e,h,i,r,o,l),s=!1),n}}}fill(t,e){this.disableFill||(t?this.nativeContext.fill(t):this.nativeContext.fill())}fillRect(t,e,i,r){this.nativeContext.fillRect(t,e,i,r)}clearRect(t,e,i,r){this.nativeContext.clearRect(t,e,i,r)}project(t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(fK(MN,[t,e,i],this.modelMatrix),t=MN[0],e=MN[1],i=MN[2]);let r=this.camera.vp(t,e,i);t=r.x,e=r.y}return{x:t,y:e}}view(t,e,i){return i=i||0,this.camera?(this.modelMatrix&&(fK(MN,[t,e,i],this.modelMatrix),t=MN[0],e=MN[1],i=MN[2]),this.camera.view(t,e,i)):[t,e,i]}fillText(t,e,i,r){if(r=r||0,this.camera){this.modelMatrix&&(fK(MN,[e,i,r],this.modelMatrix),e=MN[0],i=MN[1],r=MN[2]);let t=this.camera.vp(e,i,r);e=t.x,i=t.y}this.nativeContext.fillText(t,e,i)}getImageData(t,e,i,r){return this.nativeContext.getImageData(t,e,i,r)}getLineDash(){return this.nativeContext.getLineDash()}isPointInPath(t,e){return this.nativeContext.isPointInPath(t,e)}isPointInStroke(t,e){return this.nativeContext.isPointInStroke(t,e)}measureText(t,e=rj.global.measureTextMethod){var i,r;if(!e||"native"===e)return this.nativeContext.measureText(t);this.mathTextMeasure||(this.mathTextMeasure=rj.graphicUtil.createTextMeasureInstance({},{},()=>this.canvas.nativeCanvas));let n=null!==(i=this.fontFamily)&&void 0!==i?i:rb.fontFamily,s=null!==(r=this.fontSize)&&void 0!==r?r:rb.fontSize;return this.mathTextMeasure.textSpec.fontFamily===n&&this.mathTextMeasure.textSpec.fontSize===s||(this.mathTextMeasure.textSpec.fontFamily=n,this.mathTextMeasure.textSpec.fontSize=s,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(t,e)}putImageData(t,e,i){this.nativeContext.putImageData(t,e,i)}setLineDash(t){let e=arguments,i=this.nativeContext;this.nativeContext.setLineDash?e[0]&&i.setLineDash(e[0]):"mozDash"in i?i.mozDash=e[0]:"webkitLineDash"in i&&(i.webkitLineDash=e[0])}stroke(t){this.disableStroke||(t?this.nativeContext.stroke(t):this.nativeContext.stroke())}strokeRect(t,e,i,r){this.nativeContext.strokeRect(t,e,i,r)}strokeText(t,e,i,r){if(r=r||0,this.camera){this.modelMatrix&&(fK(MN,[e,i,r],this.modelMatrix),e=MN[0],i=MN[1],r=MN[2]);let t=this.camera.vp(e,i,r);e=t.x,i=t.y}this.nativeContext.strokeText(t,e,i)}drawImage(){let t=this.nativeContext,e=arguments;3===e.length?t.drawImage(e[0],e[1],e[2]):5===e.length?t.drawImage(e[0],e[1],e[2],e[3],e[4]):9===e.length&&t.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}setCommonStyle(t,e,i,r,n){if(Array.isArray(n)){if(n.length<=1)return this._setCommonStyle(t,e,i,r,n[0]);let s=Object.create(n[0]);return n.forEach((t,e)=>{0!==e&&Object.assign(s,t)}),this._setCommonStyle(t,e,i,r,s)}return this._setCommonStyle(t,e,i,r,n)}_setCommonStyle(t,e,i,r,n){let s=this.nativeContext;n||(n=this.fillAttributes);let{fillOpacity:a=n.fillOpacity,opacity:o=n.opacity,fill:l=n.fill}=e;a>1e-12&&o>1e-12?(s.globalAlpha=a*o*this.baseGlobalAlpha,s.fillStyle=oc(this,l,t,i,r)):s.globalAlpha=a*o*this.baseGlobalAlpha}setShadowBlendStyle(t,e,i){if(Array.isArray(i)){if(i.length<=1)return this._setShadowBlendStyle(t,i[0]);let r=Object.create(i[0]);return i.forEach((t,e)=>{0!==e&&Object.assign(r,t)}),this._setShadowBlendStyle(t,e,r)}return this._setShadowBlendStyle(t,e,i)}_setShadowBlendStyle(t,e,i){let r=this.nativeContext;i||(i=this.fillAttributes);let{opacity:n=i.opacity,shadowBlur:s=i.shadowBlur,shadowColor:a=i.shadowColor,shadowOffsetX:o=i.shadowOffsetX,shadowOffsetY:l=i.shadowOffsetY,blur:h=i.blur,globalCompositeOperation:u=i.globalCompositeOperation}=e;n<=1e-12||(s||o||l?(r.shadowBlur=s*this.dpr,r.shadowColor=a,r.shadowOffsetX=o*this.dpr,r.shadowOffsetY=l*this.dpr,this._clearShadowStyle=!0):this._clearShadowStyle&&(r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0),h?(r.filter=`blur(${h}px)`,this._clearFilterStyle=!0):this._clearFilterStyle&&(r.filter="blur(0px)",this._clearFilterStyle=!1),u?(r.globalCompositeOperation=u,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(r.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1))}setStrokeStyle(t,e,i,r,n){if(Array.isArray(n)){if(n.length<=1)return this._setStrokeStyle(t,e,i,r,n[0]);let s=Object.create(n[0]);return n.forEach((t,e)=>{0!==e&&Object.assign(s,t)}),this._setStrokeStyle(t,e,i,r,s)}return this._setStrokeStyle(t,e,i,r,n)}_setStrokeStyle(t,e,i,r,n){let s=this.nativeContext;n||(n=this.strokeAttributes);let{strokeOpacity:a=n.strokeOpacity,opacity:o=n.opacity}=e;if(a>1e-12&&o>1e-12){let{lineWidth:l=n.lineWidth,stroke:h=n.stroke,lineJoin:u=n.lineJoin,lineDash:d=n.lineDash,lineCap:c=n.lineCap,miterLimit:p=n.miterLimit}=e;s.globalAlpha=a*o*this.baseGlobalAlpha,s.lineWidth=od(this,l,this.dpr),s.strokeStyle=oc(this,h,t,i,r),s.lineJoin=u,d&&s.setLineDash(d),s.lineCap=c,s.miterLimit=p}}setTextStyleWithoutAlignBaseline(t,e,i){let r=this.nativeContext;e||(e=this.textAttributes);let{scaleIn3d:n=e.scaleIn3d}=t;t.font?r.font=t.font:r.font=aT(t,e,n&&this.camera&&this.camera.getProjectionScale(i));let{fontFamily:s=e.fontFamily,fontSize:a=e.fontSize}=t;this.fontFamily=s,this.fontSize=a,r.textAlign="left",r.textBaseline="alphabetic"}setTextStyle(t,e,i){var r,n;let s=this.nativeContext;e||(e=this.textAttributes),t.font?s.font=t.font:s.font=aT(t,e,this.camera&&this.camera.getProjectionScale(i));let{fontFamily:a=e.fontFamily,fontSize:o=e.fontSize}=t;this.fontFamily=a,this.fontSize=o,s.textAlign=null!==(r=t.textAlign)&&void 0!==r?r:e.textAlign,s.textBaseline=null!==(n=t.textBaseline)&&void 0!==n?n:e.textBaseline}draw(){}clearMatrix(t=!0,e=this.dpr){this.setTransformFromMatrix(this._clearMatrix,t,e)}setClearMatrix(t,e,i,r,n,s){this._clearMatrix.setValue(t,e,i,r,n,s)}onlyTranslate(t=this.dpr){return this.matrix.a===t&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===t}release(...t){this.stack.forEach(t=>am.free(t)),this.stack.length=0}};MH.env="browser",MH=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],MH);let MV=class extends Mj{constructor(t){super(t)}init(t){let{container:e}=t;if("string"==typeof e){let t=rj.global.getElementById(e);t&&(this._container=t)}else this._container=e;this._context=new MH(this,this._dpr),this.initStyle()}initStyle(){if(!this.controled)return;let{nativeCanvas:t}=this;t.width=this._pixelWidth,t.height=this._pixelHeight,t.style&&this.setCanvasStyle(t,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(t),this.visiable||this.hide()}hide(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}show(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}applyPosition(){let t=this._nativeCanvas;t.style.position="absolute",t.style.top=`${this._y}px`,t.style.left=`${this._x}px`}resetStyle(t){if(!this.controled)return;let{width:e=this._displayWidth,height:i=this._displayHeight,dpr:r=this._dpr,x:n=this._x,y:s=this._y}=t,{nativeCanvas:a}=this;a.width=e*r,a.height=i*r,a.style&&this.setCanvasStyle(a,n,s,e,i),t.id&&(a.id=t.id),this.visiable||this.hide()}setCanvasStyle(t,e,i,r,n){this.controled&&(t.style.width=`${r}px`,t.style.height=`${n}px`)}toDataURL(t,e){return"image/jpeg"===t?this._nativeCanvas.toDataURL(t,e):"image/png"===t?this._nativeCanvas.toDataURL(t):this._nativeCanvas.toDataURL(t,e)}resize(t,e){this.controled&&(this._pixelWidth=t*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=t,this._displayHeight=e,this._nativeCanvas.style&&(this._nativeCanvas.style.width=`${t}px`,this._nativeCanvas.style.height=`${e}px`),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}};function MW(t,e){return new eW(i=>{i(r8).toDynamicValue(()=>e=>new t(e)).whenTargetNamed(t.env),i(r6).toDynamicValue(()=>(t,i)=>new e(t,i)).whenTargetNamed(e.env)})}MV.env="browser";let MG=MW(MV=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],MV),MH);var MU=function(t,e){return function(i,r){e(i,r,t)}};let M$=class{constructor(t){this.pickItemInterceptorContributions=t,this.type="default",this.global=rj.global}_init(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((t,e)=>t.order-e.order)}pick(t,e,i){let r,n={graphic:null,group:null};i.pickerService=this;let s=i.bounds.width(),a=i.bounds.height();if(!(new iI).setValue(0,0,s,a).containsPoint(e))return n;this.pickContext&&(this.pickContext.inuse=!0),i.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);let o=new iE(1,0,0,1,0,0);for(let s=t.length-1;s>=0&&!(n=t[s].isContainer?this.pickGroup(t[s],e,o,i):this.pickItem(t[s],e,o,i)).graphic;s--)r||(r=n.group);if(n.graphic||(n.group=r),this.pickContext&&(this.pickContext.inuse=!1),n.graphic){let t=n.graphic;for(;t.parent;)t=t.parent;t.shadowHost&&(n.params={shadowTarget:n.graphic},n.graphic=t.shadowHost)}return n}containsPoint(t,e,i){var r;return!!(null===(r=this.pickItem(t,e,null,null!=i?i:{pickContext:this.pickContext,pickerService:this}))||void 0===r?void 0:r.graphic)}pickGroup(t,e,i,r){let n={group:null,graphic:null};if(!1===t.attribute.visibleAll)return n;let s=r.pickContext,a=s.modelMatrix;if(s.camera){let e=t.transMatrix,i=av.allocate();if(aI(i,e),a){if(i){let t=av.allocate();s.modelMatrix=aL(t,a,i),av.free(i)}}else aI(i,t.globalTransMatrix),s.modelMatrix=i}if(this.InterceptorContributions.length)for(let n=0;n<this.InterceptorContributions.length;n++){let o=this.InterceptorContributions[n];if(o.beforePickItem){let n=o.beforePickItem(t,this,e,r,{parentMatrix:i});if(n)return s.modelMatrix!==a&&av.free(s.modelMatrix),s.modelMatrix=a,n}}let o=t.transMatrix,l=am.allocateByObj(i),h=new iW(e.x,e.y);l.transformPoint(h,h);let u=t.AABBBounds.containsPoint(h);if(!u&&!t.stage.camera)return n;let d=this.pickItem(t,h.clone(),i,r);d&&d.graphic&&(n.graphic=d.graphic,n.params=d.params);let c=!1!==t.attribute.pickable&&u;return l.multiply(o.a,o.b,o.c,o.d,o.e,o.f),!1===t.attribute.childrenPickable||d&&d.graphic||aJ(t,rk.zIndex,s=>{if(s.isContainer){let i=new iW(e.x,e.y),a=nf(t).group,{scrollX:o=a.scrollX,scrollY:h=a.scrollY}=t.attribute;i.x-=o,i.y-=h,n=this.pickGroup(s,i,l,r)}else{let a=new iW(e.x,e.y);l.transformPoint(a,a);let o=nf(t).group,{scrollX:h=o.scrollX,scrollY:u=o.scrollY}=t.attribute;a.x-=h,a.y-=u;let d=this.pickItem(s,a,i,r);d&&d.graphic&&(n.graphic=d.graphic,n.params=d.params)}return!!n.graphic||!!n.group},!0,!!s.camera),s.modelMatrix!==a&&av.free(s.modelMatrix),s.modelMatrix=a,n.graphic||n.group||!c||t.stage.camera||(n.group=t),am.free(l),n}selectPicker(t){return this.pickerMap.get(t.numberType)||null}};M$=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),MU(0,e0(e2)),MU(0,e1(a_)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],M$);var MY=function(t,e){return function(i,r){e(i,r,t)}};let MK=class extends M${constructor(t,e,i){super(i),this.contributions=t,this.drawContribution=e,this.pickItemInterceptorContributions=i,this.global.hooks.onSetEnv.tap("canvas-picker-service",(t,e,i)=>{this.configure(i,e)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(t=>{this.pickerMap.set(t.numberType,t)}),super._init()}configure(t,e){this.pickCanvas=r7.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}pickItem(t,e,i,r){if(!1===t.attribute.pickable)return null;if(this.InterceptorContributions.length)for(let n=0;n<this.InterceptorContributions.length;n++){let s=this.InterceptorContributions[n];if(s.beforePickItem){let n=s.beforePickItem(t,this,e,r,{parentMatrix:i});if(n)return n}}let n=this.pickerMap.get(t.numberType);if(!n)return null;let s=n.contains(t,e,r),a=s?t:null,o={graphic:a,params:s};if(a)return o;if(this.InterceptorContributions.length)for(let n=0;n<this.InterceptorContributions.length;n++){let s=this.InterceptorContributions[n];if(s.afterPickItem){let n=s.afterPickItem(t,this,e,r,{parentMatrix:i});if(n)return n}}return o}};MK=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),MY(0,e0(e2)),MY(0,e1(yD)),MY(1,e0(al)),MY(2,e0(e2)),MY(2,e1(a_)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Object,Object])],MK);let MZ=class{constructor(){this.type="group",this.numberType=sT}contains(t,e,i){return!1}};MZ=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],MZ);let MX=new eW((t,e,i,r)=>{MX.__vloaded||(MX.__vloaded=!0,t(yL).to(MZ).inSingletonScope(),t(yD).toService(yL),e5(t,yD))});MX.__vloaded=!1;let Mq=new eW((t,e,i,r)=>{i(MK)||t(MK).toSelf().inSingletonScope(),i(ac)?r(ac).toService(MK):t(ac).toService(MK)}),MJ=class{constructor(){this._uid=eV.GenAutoIncrementId(),this.viewBox=new iI,this.modelMatrix=new iE(1,0,0,1,0,0)}onChange(t){this._onChangeCb=t}configure(t,e){e.env===this.type&&t.setWindowHandler(this)}release(...t){this.releaseWindow()}isVisible(t){return!0}onVisibleChange(t){}getTopLeft(t){return{top:0,left:0}}setViewBox(t){this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2)}getViewBox(){return this.viewBox}setViewBoxTransform(t,e,i,r,n,s){this.modelMatrix.setValue(t,e,i,r,n,s)}getViewBoxTransform(){return this.modelMatrix}};MJ=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],MJ);let MQ=tE=class extends MJ{get container(){return this.canvas.nativeCanvas.parentElement}static GenerateCanvasId(){return`${tE.idprefix}_${tE.prefix_count++}`}constructor(){super(),this.type="browser",this._canvasIsIntersecting=!0,this.global=rj.global,this.viewBox=new iI,this.modelMatrix=new iE(1,0,0,1,0,0)}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return this.canvas.nativeCanvas.getBoundingClientRect()}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t),this.postInit()}postInit(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch(t){console.error("\u53D1\u751F\u9519\u8BEF\uFF0C\u8BE5\u73AF\u5883\u4E0D\u5B58\u5728IntersectionObserver")}}isElementVisible(t){let e=t.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight;return!(e.right<0||e.bottom<0||e.left>i||e.top>r)}observerCanvas(){this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);let t=new IntersectionObserver((t,e)=>{t.forEach(t=>{this._canvasIsIntersecting!==t.isIntersecting?(this._canvasIsIntersecting=t.isIntersecting,this._onVisibleChangeCb&&this._onVisibleChangeCb(t.isIntersecting)):this._canvasIsIntersecting=t.isIntersecting})});t&&t.observe(this.canvas.nativeCanvas)}createWindowByConfig(t){let e;let i=this.global.createCanvas({width:t.width,height:t.height});if(!(e="string"==typeof t.container?this.global.getElementById(t.container):t.container?t.container:this.global.getRootElement()))throw Error("\u53D1\u751F\u9519\u8BEF\uFF0CcontainerId\u53EF\u80FD\u4F20\u5165\u6709\u8BEF");t.offscreen?e=null:e.appendChild(i);let r={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:i,container:e,id:tE.GenerateCanvasId(),canvasControled:!0};this.canvas=new MV(r)}createWindowByCanvas(t){var e;let i;if("string"==typeof t.canvas){if(!(i=this.global.getElementById(t.canvas)))throw Error("canvasId \u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u8BF7\u786E\u8BA4canvas\u5B58\u5728\u5E76\u63D2\u5165dom")}else i=t.canvas;if(!i)throw Error("\u53D1\u751F\u9519\u8BEF\uFF0C\u4F20\u5165\u7684canvas\u4E0D\u6B63\u786E");let r=t.width,n=t.height;if(null==r||null==n||!t.canvasControled){let t=i.getBoundingClientRect();r=t.width,n=t.height}let s=t.dpr;null==s&&(s=null!==(e=i.getContext("2d").pixelRatio)&&void 0!==e?e:i.width/r),this.canvas=new MV({width:r,height:n,dpr:s,nativeCanvas:i,canvasControled:t.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(t,e,i){return this.canvas.nativeCanvas.addEventListener(t,e,i)}removeEventListener(t,e,i){return this.canvas.nativeCanvas.removeEventListener(t,e,i)}dispatchEvent(t){return this.canvas.nativeCanvas.dispatchEvent(t)}getStyle(){var t;return null!==(t=this.canvas.nativeCanvas.style)&&void 0!==t?t:{}}setStyle(t){this.canvas.nativeCanvas.style=t}getBoundingClientRect(){let t=this.canvas.nativeCanvas,e=this.getWH();return t.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:e.width,height:e.height,left:0,top:0,right:0,bottom:0}}clearViewBox(t){let e=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),t&&(i.fillStyle=t,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}isVisible(t){return this._canvasIsIntersecting}onVisibleChange(t){this._onVisibleChangeCb=t}getTopLeft(t){return this.global.getElementTopLeft(this.canvas.nativeCanvas,t)}};MQ.env="browser",MQ.idprefix="visactor_window",MQ.prefix_count=0,MQ=tE=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],MQ);let M0=new eW(t=>{t(MQ).toSelf(),t(ne).toDynamicValue(t=>t.container.get(MQ)).whenTargetNamed(MQ.env)}),M1=class{configure(t,...e){t.env===this.type&&t.setActiveEnvContribution(this)}getNativeAABBBounds(t){return new iI}removeDom(t){return!1}createDom(t){return null}updateDom(t,e){return!1}getDynamicCanvasCount(){return 999}getStaticCanvasCount(){return 999}getElementById(t){return document.getElementById(t)}getRootElement(){return document.body}loadJson(t){let e=fetch(t).then(t=>t.json());return e.then(t=>({data:t,state:"success"})).catch(()=>({data:null,state:"fail"})),e}loadArrayBuffer(t){return fetch(t).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadBlob(t){return fetch(t).then(t=>t.blob()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}getElementTop(t,e){return 0}getElementLeft(t,e){return 0}getElementTopLeft(t,e){return{top:0,left:0}}};M1=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],M1);class M2{get x1(){return this.dom.getBoundingClientRect().left}get x2(){return this.dom.getBoundingClientRect().right}get y1(){return this.dom.getBoundingClientRect().top}get y2(){return this.dom.getBoundingClientRect().bottom}get width(){return this.dom.getBoundingClientRect().width}get height(){return this.dom.getBoundingClientRect().height}constructor(t){this.dom=t}}function M3(t,e=!1){let i=document.createElement("img");if(i.crossOrigin="anonymous",e){let e=new Blob([t],{type:"image/svg+xml"});t=window.URL.createObjectURL(e)}return(i.src=t,i.complete)?Promise.resolve(i):new Promise((t,e)=>{i.onload=()=>{t(i)},i.onerror=()=>{e(Error("\u52A0\u8F7D\u5931\u8D25"))}})}let M5=class extends M1{constructor(){super(),this.type="browser",this.supportEvent=!0;try{this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(t){this.supportsTouchEvents=!1,this.supportsPointerEvents=!1,this.supportsPointerEvents=!1}this.applyStyles=!0}mapToCanvasPoint(t,e){var i,r;let n=0,s=0,a=0,o=0;if(t.changedTouches){let e=null!==(i=t.changedTouches[0])&&void 0!==i?i:{};n=e.clientX||0,s=e.clientY||0,a=n,o=s}else n=t.clientX||0,s=t.clientY||0,a=t.offsetX||0,o=t.offsetY||0;if(e){let t,i;let a=n,o=s,l=e.getBoundingClientRect(),h=null===(r=e.getNativeHandler)||void 0===r?void 0:r.call(e).nativeCanvas;return h&&(t=l.width/h.offsetWidth,i=l.height/h.offsetHeight),{x:(a-l.left)/(l1(t)?t:1),y:(o-l.top)/(l1(i)?i:1)}}return{x:a,y:o}}getNativeAABBBounds(t){let e=t;return("string"==typeof t&&(e=(new DOMParser).parseFromString(t,"text/html").firstChild).lastChild&&(e=e.lastChild.firstChild),e.getBoundingClientRect)?new M2(e.getBoundingClientRect()):new iI}removeDom(t){return t.parentElement.removeChild(t),!0}updateDom(t,e){let{width:i,height:r,style:n}=e;return n&&(eE(n)?t.setAttribute("style",n):Object.keys(n).forEach(e=>{t.style[e]=n[e]})),null!=i&&(t.style.width=`${i}px`),null!=r&&(t.style.height=`${r}px`),!0}createDom(t){let{tagName:e="div",parent:i}=t,r=document.createElement(e);if(this.updateDom(r,t),i){let t=eE(i)?this.getElementById(i):i;t&&t.appendChild&&t.appendChild(r)}return r}loadImage(t){return M3(t,!1).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(t){return M3(t,!0).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}createCanvas(t){var e,i;let r=document.createElement("canvas");t.id&&(r.id=null!==(e=t.id)&&void 0!==e?e:eV.GenAutoIncrementId().toString());let n=null!==(i=t.dpr)&&void 0!==i?i:window.devicePixelRatio;return t.width&&t.height&&(r.style.width=`${t.width}px`,r.style.height=`${t.height}px`,r.width=t.width*n,r.height=t.height*n),r}createOffscreenCanvas(t){var e;let i=null!==(e=t.dpr)&&void 0!==e?e:window.devicePixelRatio;return new OffscreenCanvas(t.width*i,t.height*i)}releaseCanvas(t){let e;(e="string"==typeof t?document.getElementById(t):t)&&e.parentElement&&e.parentElement.removeChild(e)}getDevicePixelRatio(){return window.devicePixelRatio}getRequestAnimationFrame(){return window.requestAnimationFrame}getCancelAnimationFrame(){return window.cancelAnimationFrame}addEventListener(t,e,i){return document.addEventListener(t,e,i)}removeEventListener(t,e,i){return document.removeEventListener(t,e,i)}dispatchEvent(t){return document.dispatchEvent(t)}getElementById(t){return document.getElementById(t)}getRootElement(){return document.body}getDocument(){return document}release(...t){}getElementTop(t,e){let i=t.offsetTop,r=t.offsetParent;for(;null!==r;)i+=r.offsetTop,r=r.offsetParent;return i}getElementLeft(t,e){let i=t.offsetLeft,r=t.offsetParent;for(;null!==r;)i+=r.offsetLeft,r=r.offsetParent;return i}getElementTopLeft(t,e){let i=t.offsetTop,r=t.offsetLeft,n=t.offsetParent;for(;null!==n;)i+=n.offsetTop,r+=n.offsetLeft,n=n.offsetParent;return{top:i,left:r}}};M5=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],M5);let M4=new eW(t=>{M4.isBrowserBound||(M4.isBrowserBound=!0,t(M5).toSelf().inSingletonScope(),t(e6).toService(M5))});function M8(t,e=!0){var i;M8.__loaded||(M8.__loaded=!0,t.load(M4),t.load(MG),t.load(M0),e&&((i=t).load(MX),i.load(Mq)))}M4.isBrowserBound=!1,M8.__loaded=!1;let M6=class extends MH{constructor(t,e){super(t,e);let i=t.nativeCanvas.getContext("2d");if(!i)throw Error("\u53D1\u751F\u9519\u8BEF\uFF0C\u83B7\u53D62d\u4E0A\u4E0B\u6587\u5931\u8D25");this.nativeContext=i,this.canvas=t,this.matrix=new iE(1,0,0,1,0,0),this.stack=[],this.dpr=null!=e?e:1}release(...t){}};M6.env="node",M6=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object,Number])],M6);let M9=class extends Mj{constructor(t){super(t)}init(){this._context=new M6(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}release(...t){this._nativeCanvas.release&&nx(this._nativeCanvas.release)&&this._nativeCanvas.release()}};M9.env="node";let M7=MW(M9=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],M9),M6),Ct=class extends MJ{get container(){return null}constructor(t){super(),this.global=t,this.type="node"}getTitle(){return""}getWH(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}getXY(){return{x:0,y:0}}createWindow(t){t.canvas?this.createWindowByCanvas(t):this.createWindowByConfig(t)}createWindowByConfig(t){let e=this.global.createCanvas({width:t.width,height:t.height}),i={width:t.width,height:t.height,dpr:t.dpr,nativeCanvas:e,id:eV.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new M9(i)}createWindowByCanvas(t){let e=t.canvas,i=t.width,r=t.height;null!=i&&null!=r&&t.canvasControled||(i=e.width,r=e.height),this.canvas=new M9({width:i,height:r,dpr:1,nativeCanvas:e,canvasControled:t.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(t,e){this.canvas.resize(t,e)}setDpr(t){this.canvas.dpr=t}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}getImageBuffer(t="image/png"){return this.canvas.nativeCanvas.toBuffer(t)}addEventListener(t,e,i){}dispatchEvent(t){return!0}removeEventListener(t,e,i){}getStyle(){}setStyle(t){}getBoundingClientRect(){return null}clearViewBox(t){}};Ct.env="node",Ct=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(tO=0,tP=e0(e9),function(t,e){tP(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Ct);let Ce=new eW(t=>{t(Ct).toSelf(),t(ne).toDynamicValue(t=>t.container.get(Ct)).whenTargetNamed(Ct.env)}),Ci=class extends M1{constructor(){super(...arguments),this.type="node",this._lastTime=0,this.supportEvent=!1}configure(t,e){t.env===this.type&&(t.setActiveEnvContribution(this),this.pkg=e)}getDynamicCanvasCount(){return 0}getStaticCanvasCount(){return 999}loadJson(t){let e=fetch(t).then(t=>t.json());return e.then(t=>({data:t,state:"success"})).catch(()=>({data:null,state:"fail"})),e}loadArrayBuffer(t){return fetch(t).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadImage(t){let{loadImage:e}=this.pkg;return e?e(t).then(t=>({loadState:t?"success":"fail",data:t})).catch(()=>({loadState:"fail",data:null})):Promise.reject(Error("node-canvas loadImage could not be found!"))}loadSvg(t){let e=this.pkg.Resvg;if(!e)return Promise.reject(Error("@resvg/resvg-js svgParser could not be found!"));let i=new e(t).render().asPng();return this.loadImage(i)}createCanvas(t){return this.pkg.createCanvas(t.width,t.height)}releaseCanvas(t){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return function(t){return sf.call(t)}}getCancelAnimationFrame(){return t=>{sf.clear(t)}}addEventListener(t,e,i){}removeEventListener(t,e,i){}getElementById(t){return null}getRootElement(){return null}dispatchEvent(t){}release(...t){}createOffscreenCanvas(t){}};Ci=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],Ci);let Cr=new eW(t=>{Cr.isNodeBound||(Cr.isNodeBound=!0,t(Ci).toSelf().inSingletonScope(),t(e6).toService(Ci))});function Cn(t,e=!0){Cn.__loaded||(Cn.__loaded=!0,t.load(Cr),t.load(M7),t.load(Ce))}Cr.isNodeBound=!1,Cn.__loaded=!1;let Cs=()=>{M8(r4)},Ca=()=>{Cn(r4)},Co={name:"dark",colorScheme:{default:{dataScheme:uu,palette:{backgroundColor:"#202226",borderColor:"#404349",shadowColor:"rgba(0,0,0,0.1)",hoverBackgroundColor:"#404349",sliderRailColor:"#404349",sliderHandleColor:"#202226",sliderTrackColor:"#4284FF",popupBackgroundColor:"#404349",primaryFontColor:"#fdfdfd",secondaryFontColor:"#bbbdc3",tertiaryFontColor:"#888c93",axisLabelFontColor:"#888c93",disableFontColor:"#55595f",axisMarkerFontColor:"#202226",axisGridColor:"#404349",axisDomainColor:"#4b4f54",dataZoomHandleStrokeColor:"#bbbdc3",dataZoomChartColor:"#55595F",playerControllerColor:"#4284FF",scrollBarSliderColor:"rgba(255,255,255,0.3)",axisMarkerBackgroundColor:"#fdfdfd",markLabelBackgroundColor:"#404349",markLineStrokeColor:"#bbbdc3",dangerColor:"#eb4b4b",warningColor:"#f0bd30",successColor:"#14b267",infoColor:"#4284ff",discreteLegendPagerTextColor:"#BBBDC3",discreteLegendPagerHandlerColor:"#BBBDC3",discreteLegendPagerHandlerDisableColor:"#55595F"}}},component:{dataZoom:{selectedBackground:{style:{fillOpacity:.4,outerBorder:{strokeOpacity:.4}}}}}};class Cl{constructor(){this.id=l4(),this._plugins=[]}add(t){if(!t||0===t.length)return null;let e=[];return t.forEach(t=>{this._plugins.find(e=>e.id===t.id)?hd("\u4E0D\u8981\u91CD\u590D\u6DFB\u52A0\u76F8\u540C\u7684plugin"):(this._plugins.push(t),e.push(t),t.onAdd&&t.onAdd(this))}),e}load(t){let e=this.add(t);e&&e.length&&this.activate(t)}activate(t){t.length&&t.forEach(t=>{t.init&&t.init()})}get(t){return this._plugins.find(e=>e.id===t)}getAll(){return this._plugins.slice()}release(t){let e=this.get(t);e&&(e.release(this),this._plugins=this._plugins.filter(t=>t!==e))}releaseAll(){this._plugins.forEach(t=>{t.release(this)}),this._plugins=[]}clear(t){let e=this.get(t);e&&e.clear(this)}clearAll(){this._plugins.forEach(t=>{var e;null===(e=t.clear)||void 0===e||e.call(t,this)})}}class Ch extends Cl{constructor(t){super(),this.globalInstance=t}onInit(t){this._plugins.forEach(e=>{e.onInit&&e.onInit(this,t)})}onBeforeResize(t,e){this._plugins.forEach(i=>{i.onBeforeResize&&i.onBeforeResize(this,t,e)})}onAfterChartSpecTransform(t,e){this._plugins.forEach(i=>{i.onAfterChartSpecTransform&&i.onAfterChartSpecTransform(this,t,e)})}onBeforeInitChart(t,e){this._plugins.forEach(i=>{i.onBeforeInitChart&&i.onBeforeInitChart(this,t,e)})}releaseAll(){super.releaseAll(),this.globalInstance=null}}class Cu{constructor(t,e){this.references=new Map,this.view=t,this.depend(null==e?void 0:e.dependency)}getStartState(){return null}depend(t){this.references.clear(),om(t).map(t=>eE(t)?this.view.getGrammarById(t):t).filter(t=>!ej(t)).forEach(t=>{var e;this.references.set(t,(null!==(e=this.references.get(t))&&void 0!==e?e:0)+1)})}parameters(){let t={};return this.references.forEach((e,i)=>{eO(i.id())&&(t[i.id()]=i.output())}),t}bind(){let t=this.getEvents();(null!=t?t:[]).forEach(t=>{t.type&&t.handler&&(eM(t.type)?t.type.forEach(e=>{e&&"none"!==e&&this.view.addEventListener(e,t.handler)}):"none"!==t.type&&this.view.addEventListener(t.type,t.handler))})}unbind(){let t=this.getEvents();(null!=t?t:[]).forEach(t=>{t.type&&t.handler&&(eM(t.type)?t.type.forEach(e=>{e&&"none"!==e&&this.view.removeEventListener(e,t.handler)}):"none"!==t.type&&this.view.removeEventListener(t.type,t.handler))})}start(t){}reset(t){}dispatchEvent(t,e){this.view.emit(`${this.type}:${t}`,e),"start"===t&&this.options.onStart?this.options.onStart(e):"reset"===t&&this.options.onReset?this.options.onReset(e):"update"===t&&this.options.onUpdate?this.options.onUpdate(e):"end"===t&&this.options.onEnd&&this.options.onEnd(e)}}class Cd extends Cu{constructor(t,e){super(t,e),this.type=Cd.type,this.handleStart=t=>{this.start(t.element)},this.handleReset=t=>{this.reset(t.element)},this.options=Object.assign({},Cd.defaultOptions,e),this._marks=t.getMarksBySelector(this.options.selector)}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}getStartState(){return this.options.state}start(t){t&&this._marks&&this._marks.includes(t.mark)&&t.addState(this.options.state)}reset(t){t&&this._marks&&this._marks.includes(t.mark)&&t.removeState(this.options.state)}}Cd.type="element-active",Cd.defaultOptions={state:pl.active,trigger:"pointerover",triggerOff:"pointerout"};let Cc=t=>t.filterField?e=>{var i;return null===(i=e.getDatum())||void 0===i?void 0:i[t.filterField]}:e=>e[t.filterType],Cp=(t,e)=>{if(!e||!t)return null;let i={};return t.forEach(t=>{let r=t&&t.getSpec(),n=r&&r.encode;n&&e.forEach(e=>{e&&n[e]&&(i[e]||(i[e]=[]),i[e].push(t))})}),i},Cg=t=>{let e=om(t),i=[],r=[];return e.forEach(t=>{"empty"===t?i.push("view"):eE(t)&&"none"!==t?t.includes("view:")?(r.push(t.replace("view:","")),i.push("view")):(r.push(t),i.push("self")):ey(t)&&i.push("timeout")}),{eventNames:r,resetType:i}};class Cf extends Cu{constructor(t,e){super(t,e),this.type=Cf.type,this._resetType=[],this.clearPrevElements=()=>{let{state:t,reverseState:e}=this.options;this._statedElements&&this._statedElements.length&&(this.clearAllStates(t,e),this.dispatchEvent("reset",{elements:this._statedElements,options:this.options}),this._statedElements=[])},this.handleStart=t=>{this.start(t.element)},this.handleReset=t=>{this.reset(t.element)},this.options=Object.assign({},Cf.defaultOptions,e),this._marks=t.getMarksBySelector(this.options.selector),this._stateMarks=Cp(this._marks,[this.options.state,this.options.reverseState])}getStartState(){return this.options.state}getEvents(){let t=this.options.triggerOff,e=this.options.trigger,i=[{type:e,handler:this.handleStart}],{eventNames:r,resetType:n}=Cg(t);return r.forEach(t=>{t&&(eM(e)?!e.includes(t):t!==e)&&i.push({type:t,handler:this.handleReset})}),this._resetType=n,i}start(t){let{state:e,reverseState:i,isMultiple:r}=this.options;if(t&&this._marks&&this._marks.includes(t.mark)){if(t.hasState(e)){if(this._resetType.includes("self")){let r=this._statedElements&&this._statedElements.filter(e=>e!==t);r&&r.length?this._statedElements=this.updateStates(r,this._statedElements,e,i):this.clearPrevElements()}}else this._timer&&clearTimeout(this._timer),t.addState(e),this._statedElements=this.updateStates(r&&this._statedElements?[...this._statedElements,t]:[t],this._statedElements,e,i),this.dispatchEvent("start",{elements:this._statedElements,options:this.options}),this._resetType.includes("timeout")&&(this._timer=setTimeout(()=>{this.clearPrevElements()},this.options.triggerOff))}else this._resetType.includes("view")&&this._statedElements&&this._statedElements.length&&this.clearPrevElements()}reset(t){if(!this._statedElements||!this._statedElements.length)return;let e=t&&this._marks&&this._marks.includes(t.mark);(this._resetType.includes("view")&&!e||this._resetType.includes("self")&&e)&&this.clearPrevElements()}}Cf.type="element-select",Cf.defaultOptions={state:pl.selected,trigger:"click"};class Cm extends Cu{constructor(t,e){super(t,e),this.type=Cm.type,this.handleStart=t=>{this.start(t.element)},this.handleReset=t=>{this.reset(t.element)},this.options=Object.assign({},Cm.defaultOptions,e),this._marks=t.getMarksBySelector(this.options.selector),this._stateMarks=Cp(this._marks,[this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getEvents(){let t=this.options.triggerOff,e=[{type:this.options.trigger,handler:this.handleStart}],i=t;return eE(t)&&t.includes("view:")?(i=t.replace("view:",""),this._resetType="view"):this._resetType="self",e.push({type:i,handler:this.handleReset}),e}clearPrevElements(){let{highlightState:t,blurState:e}=this.options;this._lastElement&&(this.clearAllStates(t,e),this.dispatchEvent("reset",{elements:[this._lastElement],options:this.options}),this._lastElement=null,this._statedElements=null)}start(t){if(t&&this._marks&&this._marks.includes(t.mark)){let{highlightState:e,blurState:i}=this.options;this._lastElement!==t&&(this._statedElements=this.updateStates([t],this._statedElements,e,i),this._lastElement=t,this.dispatchEvent("start",{elements:[t],options:this.options}))}else this._lastElement&&"view"===this._resetType&&this.clearPrevElements()}reset(t){if(!this._statedElements||!this._statedElements.length)return;let e=t&&this._marks&&this._marks.includes(t.mark);"view"!==this._resetType||e?"self"===this._resetType&&e&&this.clearPrevElements():this.clearPrevElements()}}Cm.type="element-highlight",Cm.defaultOptions={highlightState:pl.highlight,blurState:pl.blur,trigger:"pointerover",triggerOff:"pointerout"};class Cv extends Cu{constructor(t,e){super(t,e),this.type=Cv.type,this.handleStart=t=>{this.start(t.element)},this.handleReset=t=>{t.element&&this._marks&&this._marks.includes(t.element.mark)&&this.clearPrevElements()},this.options=Object.assign({},Cv.defaultOptions,e),this._marks=t.getMarksBySelector(this.options.selector)}getStartState(){return this.options.highlightState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}clearPrevElements(){let t=[this.options.highlightState,this.options.blurState];this._marks.forEach(e=>{e.elements.forEach(e=>{e.removeState(t)})})}start(t){if(t&&this._marks&&this._marks.includes(t.mark)){let e=t.key;!ej(e)&&this._marks.forEach(t=>{t.elements.forEach(t=>{t.key===e?t.updateStates({[this.options.blurState]:!1,[this.options.highlightState]:!0}):t.updateStates({[this.options.blurState]:!0,[this.options.highlightState]:!1})})})}}reset(t){if(t&&this._marks&&this._marks.includes(t.mark)){let e=t.key;!ej(e)&&this._marks.forEach(t=>{t.elements.forEach(t=>{t.key===e?t.updateStates({[this.options.blurState]:!1,[this.options.highlightState]:!0}):t.updateStates({[this.options.blurState]:!0,[this.options.highlightState]:!1})})})}}}Cv.type="element-highlight-by-key",Cv.defaultOptions={highlightState:pl.highlight,blurState:pl.blur,trigger:"pointerover",triggerOff:"pointerout"};class Cy extends Cu{constructor(t,e){super(t,e),this.type=Cy.type,this.handleStart=t=>{this.start(t.element)},this.handleReset=t=>{this.reset(t.element)},this.options=Object.assign({},Cy.defaultOptions,e),this._marks=t.getMarksBySelector(this.options.selector)}getStartState(){return this.options.highlightState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}clearPrevElements(){let t=[this.options.highlightState,this.options.blurState];this._marks.forEach(e=>{e.elements.forEach(e=>{e.removeState(t)})})}start(t){if(t&&this._marks&&this._marks.includes(t.mark)){let e=t.groupKey;!ej(e)&&this._marks.forEach(t=>{t.elements.forEach(t=>{t.groupKey===e?t.updateStates({[this.options.blurState]:!1,[this.options.highlightState]:!0}):t.updateStates({[this.options.blurState]:!0,[this.options.highlightState]:!1})})})}}reset(t){t&&this._marks&&this._marks.includes(t.mark)&&this.clearPrevElements()}}Cy.type="element-highlight-by-group",Cy.defaultOptions={highlightState:pl.highlight,blurState:pl.blur,trigger:"pointerover",triggerOff:"pointerout"};(tR=t3||(t3={})).selected="selected",tR.unSelected="unSelected",tR.selectedHover="selectedHover",tR.unSelectedHover="unSelectedHover",tR.focus="focus",(tB=t5||(t5={})).legendItemHover="legendItemHover",tB.legendItemUnHover="legendItemUnHover",tB.legendItemClick="legendItemClick",tB.legendItemAttributeUpdate="legendItemAttributeUpdate",(tI=t4||(t4={})).innerView="innerView",tI.title="legendTitle",tI.item="legendItem",tI.itemShape="legendItemShape",tI.itemLabel="legendItemLabel",tI.itemValue="legendItemValue",tI.focus="legendItemFocus";class C_ extends Cu{constructor(t,e){super(t,e),this.type=C_.type,this.handleStart=t=>{var e,i;this.start(null===(i=null===(e=t.detail)||void 0===e?void 0:e.data)||void 0===i?void 0:i.id)},this.handleReset=t=>{this.reset()},this.options=Object.assign({},C_.defaultOptions,e),this._marks=t.getMarksBySelector(this.options.selector)}getEvents(){return[{type:t5.legendItemHover,handler:this.handleStart},{type:t5.legendItemUnHover,handler:this.handleReset}]}getStartState(){return this.options.state}start(t){if(ej(t))return;let e=Cc(this.options);this._marks.forEach(i=>{i.elements.forEach(i=>{e(i)===t?i.addState(this.options.state):i.removeState(this.options.state)})})}reset(){this._marks.forEach(t=>{t.elements.forEach(t=>{t.removeState(this.options.state)})})}}C_.type="element-active-by-legend",C_.defaultOptions={state:pl.active,filterType:"groupKey"};class Cb extends Cu{constructor(t,e){super(t,e),this.type=Cb.type,this.handleStart=(t,e)=>{var i,r;this.start(null===(r=null===(i=t.detail)||void 0===i?void 0:i.data)||void 0===r?void 0:r.id)},this.handleReset=t=>{this.reset()},this.options=Object.assign({},Cb.defaultOptions,e),this._marks=t.getMarksBySelector(this.options.selector)}getStartState(){return this.options.highlightState}getEvents(){return[{type:t5.legendItemHover,handler:this.handleStart},{type:t5.legendItemUnHover,handler:this.handleReset}]}start(t){if(ej(t))return;let e=Cc(this.options);this._marks.forEach(i=>{i.elements.forEach(i=>{e(i)===t?i.updateStates({[this.options.blurState]:!1,[this.options.highlightState]:!0}):i.updateStates({[this.options.blurState]:!0,[this.options.highlightState]:!1})})})}reset(){let t=[this.options.blurState,this.options.highlightState];this._marks.forEach(e=>{e.elements.forEach(e=>{e.removeState(t)})})}}Cb.type="element-highlight-by-legend",Cb.defaultOptions={highlightState:pl.highlight,blurState:pl.blur,filterType:"groupKey"};class Cx extends Cu{constructor(t,e){super(t,e),this.type=Cx.type,this.handleStart=(t,e)=>{if(this.options.shouldStart?this.options.shouldStart(t):this._filterByName(t)){let i=this._parseTargetKey(t,e);this.start(i)}},this.handleReset=t=>{(this.options.shouldReset?this.options.shouldReset(t):this._filterByName(t))&&this.reset()},this.options=Object.assign({},Cx.defaultOptions,e),this._marks=t.getMarksBySelector(this.options.selector)}getStartState(){return this.options.highlightState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}_filterByName(t){var e;let i=om(this.options.graphicName);return(null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.name)&&i.includes(t.target.name)}_parseTargetKey(t,e){return this.options.parseData?this.options.parseData(t):"text"===t.target.type?t.target.attribute.text:null}start(t){if(ej(t))return;let e=Cc(this.options);this._marks.forEach(i=>{i.elements.forEach(i=>{e(i)===t?i.updateStates({[this.options.blurState]:!1,[this.options.highlightState]:!0}):i.updateStates({[this.options.blurState]:!0,[this.options.highlightState]:!1})})})}reset(){let t=[this.options.blurState,this.options.highlightState];this._marks.forEach(e=>{e.elements.forEach(e=>{e.removeState(t)})})}}Cx.type="element-highlight-by-name",Cx.defaultOptions={trigger:"pointerover",triggerOff:"pointerout",highlightState:pl.highlight,blurState:pl.blur,filterType:"groupKey"};function CS(t,e,i=!0){if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames){let r=Object.getOwnPropertyNames(e);for(let n=0;n<r.length;n++){let s=r[n];"constructor"!==s&&(i?null!=e[s]:null==t[s])&&(t[s]=e[s])}}else!function(t,e,i){let r=function(t){if(!t)return[];if(Object.keys)return Object.keys(t);let e=[];for(let i in t)t.hasOwnProperty(i)&&e.push(i);return e}(e);for(let n=0;n<r.length;n++){let s=r[n];(i?null!=e[s]:null==t[s])&&(t[s]=e[s])};}(t,e,i)}class Ck{updateStates(t,e,i,r){return t&&t.length?(i&&r?e&&e.length?(this.toggleReverseStateOfElements(t,e,r),this.toggleStateOfElements(t,e,i)):this.addBothStateOfElements(t,i,r):i&&(e&&e.length?this.toggleStateOfElements(t,e,i):this.addStateOfElements(t,i)),t):null}toggleReverseStateOfElements(t,e,i){e.forEach(t=>{i&&this._stateMarks[i]&&this._stateMarks[i].includes(t.mark)&&t.addState(i)}),t.forEach(t=>{i&&this._stateMarks[i]&&this._stateMarks[i].includes(t.mark)&&t.removeState(i)})}toggleStateOfElements(t,e,i){e.forEach(t=>{i&&this._stateMarks[i]&&this._stateMarks[i].includes(t.mark)&&t.removeState(i)}),t.forEach(t=>{i&&this._stateMarks[i]&&this._stateMarks[i].includes(t.mark)&&t.addState(i)})}addBothStateOfElements(t,e,i){this._marks.forEach(r=>{let n=i&&this._stateMarks[i]&&this._stateMarks[i].includes(r),s=e&&this._stateMarks[e]&&this._stateMarks[e].includes(r);(n||s)&&r.elements.forEach(r=>{t&&t.includes(r)?s&&r.addState(e):n&&r.addState(i)})})}addStateOfElements(t,e){this._marks.forEach(i=>{let r=e&&this._stateMarks[e]&&this._stateMarks[e].includes(i);r&&i.elements.forEach(i=>{t&&t.includes(i)&&r&&i.addState(e)})})}clearAllStates(t,e){this._statedElements&&this._statedElements.length&&this._marks.forEach(i=>{e&&this._stateMarks[e]&&this._stateMarks[e].includes(i)&&i.elements.forEach(t=>{t.removeState(e)}),t&&this._stateMarks[t]&&this._stateMarks[t].includes(i)&&i.elements.forEach(e=>{this._statedElements.includes(e)&&e.removeState(t)})})}}var CA=function(t,e,i,r){return new(i||(i=Promise))(function(n,s){function a(t){try{l(r.next(t))}catch(t){s(t)}}function o(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(a,o)}l((r=r.apply(t,e||[])).next())})},Cw=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class CM{static useRegisters(t){t.forEach(t=>{"function"==typeof t?t():console.error("Invalid function:",t)})}static useChart(t){t.forEach(t=>de.registerChart(t.type,t))}static useSeries(t){t.forEach(t=>de.registerSeries(t.type,t))}static useComponent(t){t.forEach(t=>de.registerComponent(t.type,t))}static useMark(t){t.forEach(t=>{var e;return de.registerMark(null!==(e=t.constructorType)&&void 0!==e?e:t.type,t)})}static useLayout(t){t.forEach(t=>de.registerLayout(t.type,t))}static registerDataSetTransform(t,e){de.registerTransform(t,e)}static registerFunction(t,e){t&&e&&MI.instance().registerFunction(t,e)}static unregisterFunction(t){t&&MI.instance().unregisterFunction(t)}static getFunction(t){return t?MI.instance().getFunction(t):null}static getFunctionList(){return MI.instance().getFunctionNameList()}static registerMap(t,e,i){let r=de.getImplementInKey("registerMap");r&&r(t,e,i)}static unregisterMap(t){let e=de.getImplementInKey("unregisterMap");e&&e(t)}static getMap(t){var e;return e=t,gC.get(e)}static hideTooltip(t=[]){uY.forEach(t=>{var e;return null===(e=null==t?void 0:t.hideTooltip)||void 0===e?void 0:e.call(t)},t)}static getLogger(){return ex.getInstance()}getSpec(){return this._spec}getSpecInfo(){return this._specInfo}getDataSet(){return this._dataSet}constructor(t,e){var i,r,n,s,a,o;this.id=l4(),this._userEvents=[],this._autoSize=!0,this._option={mode:lb["desktop-browser"],onError:t=>{throw Error(t)},optimize:{disableCheckGraphicWidthOutRange:!0}},this._observer=null,this._context={},this._onResize=l3((...t)=>{this._doResize()},100),this._option=eF(this._option,{animation:!1!==t.animation},e),this._onError=null===(i=this._option)||void 0===i?void 0:i.onError;let l=this._option,{dom:h,renderCanvas:u,mode:d,stage:c,poptip:p}=l,g=Cw(l,["dom","renderCanvas","mode","stage","poptip"]),f=hl(d);f?Cs():"node"===d&&Ca(),f&&h&&(this._container=eE(h)?lX.getElementById(h):h),u&&(this._canvas=u),c&&(this._stage=c),"node"===d||this._container||this._canvas||this._stage?(this._viewBox=this._option.viewBox,this._currentThemeName=uK.getCurrentThemeName(),this._setNewSpec(t),this._updateCurrentTheme(),this._currentSize=this.getCurrentSize(),this._compiler=new v3({dom:null!==(n=this._container)&&void 0!==n?n:"none",canvas:u},Object.assign(Object.assign({mode:this._option.mode,stage:c,pluginList:!1!==p?["poptipForText"]:[]},g),{background:this._getBackground(),onError:this._onError})),this._compiler.setSize(this._currentSize.width,this._currentSize.height),this._eventDispatcher=new d2(this,this._compiler),this._event=new dZ(this._eventDispatcher,d),this._compiler.initView(),this._setFontFamilyTheme(null===(s=this._currentTheme)||void 0===s?void 0:s.fontFamily),this._initDataSet(this._option.dataSet),this._autoSize=!!f&&(null===(o=null!==(a=t.autoFit)&&void 0!==a?a:this._option.autoFit)||void 0===o||o),this._bindResizeEvent(),this._bindVGrammarViewEvent(),this._initChartPlugin(),uY.registerInstance(this)):null===(r=this._option)||void 0===r||r.onError("please specify container or renderCanvas!")}_setNewSpec(t,e){return!!t&&(eE(t)&&(t=JSON.parse(t)),e&&this._originalSpec&&(t=us({},this._originalSpec,t)),this._originalSpec=t,this._spec=this._getSpecFromOriginalSpec(),!0)}_getSpecFromOriginalSpec(){var t;let e=function t(e,i={data:t=>t}){if(!e)return e;if(e.constructor===Object){let r={};for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(i[n]){r[n]=i[n](e[n]);continue}r[n]=t(e[n],i)}return r}return eM(e)?e.map(e=>t(e,i)):e}(this._originalSpec);return e.data=null!==(t=e.data)&&void 0!==t?t:[],e}_initChartSpec(t,e){var i,r;CM.getFunctionList()&&CM.getFunctionList().length&&(t=function t(e,i){if(!e)return e;if(eI(e)){let r={};for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(eE(e[n])&&i.getFunction(e[n])){r[n]=i.getFunction(e[n]);continue}r[n]=t(e[n],i)}return r}return eM(e)?e.map(e=>t(e,i)):e}(t,CM)),this._spec=t,this._chartSpecTransformer||(this._chartSpecTransformer=de.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),null===(i=this._chartSpecTransformer)||void 0===i||i.transformSpec(this._spec),this._chartPluginApply("onAfterChartSpecTransform",this._spec,e),this._specInfo=null===(r=this._chartSpecTransformer)||void 0===r?void 0:r.transformModelSpec(this._spec),this._chartPluginApply("onAfterModelSpecTransform",this._spec,this._specInfo,e)}_updateSpecInfo(){var t;this._chartSpecTransformer||(this._chartSpecTransformer=de.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),this._specInfo=null===(t=this._chartSpecTransformer)||void 0===t?void 0:t.createSpecInfo(this._spec)}_initChart(t){var e,i,r;if(!this._compiler)return void(null===(e=this._option)||void 0===e||e.onError("compiler is not initialized"));if(this._chart)return void(null===(i=this._option)||void 0===i||i.onError("chart is already initialized"));let n=de.createChart(t.type,t,this._getChartOption(t.type));n?(this._chart=n,this._chart.setCanvasRect(this._currentSize.width,this._currentSize.height),this._chart.created(),this._chart.init(),this._event.emit(c1.initialized,{chart:n,vchart:this})):null===(r=this._option)||void 0===r||r.onError("init chart fail")}_releaseData(){this._dataSet&&(this._dataSet.dataViewMap={},this._dataSet=null)}_bindVGrammarViewEvent(){this._compiler&&(this._compiler.getVGrammarView().addEventListener(pa.ALL_ANIMATION_END,()=>{this._event.emit(c1.animationFinished,{chart:this._chart,vchart:this})}),this._compiler.getVGrammarView().addEventListener(pa.AFTER_VRENDER_NEXT_RENDER,()=>{this._event.emit(c1.renderFinished,{chart:this._chart,vchart:this})}))}_bindResizeEvent(){var t;if(this._autoSize){if(this._container){let e=window.ResizeObserver;e&&(this._observer=new e(this._onResize),null===(t=this._observer)||void 0===t||t.observe(this._container))}window.addEventListener("resize",this._onResize)}}_unBindResizeEvent(){this._autoSize&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))}getCurrentSize(){var t,e,i,r;return bf(this._spec,{container:this._container,canvas:this._canvas,mode:this._getMode(),modeParams:this._option.modeParams},{width:null!==(e=null===(t=this._currentSize)||void 0===t?void 0:t.width)&&void 0!==e?e:500,height:null!==(r=null===(i=this._currentSize)||void 0===i?void 0:i.height)&&void 0!==r?r:500})}_doResize(){let{width:t,height:e}=this.getCurrentSize();this._currentSize.width===t&&this._currentSize.height===e||(this._currentSize={width:t,height:e},this.resizeSync(t,e))}_initDataSet(t){for(let e in this._dataSet=t instanceof eA?t:new eA,gM(this._dataSet,"dataview",eC),gM(this._dataSet,"array",eg),gw(this._dataSet,"stackSplit",gL),gw(this._dataSet,"copyDataView",gP),de.transforms)gw(this._dataSet,e,de.transforms[e]);for(let t in de.dataParser)gM(this._dataSet,t,de.dataParser[t])}updateCustomConfigAndRerender(t,e,i={}){if(!this._isReleased&&t)return nx(t)&&(t=t()),t.reAnimate&&(this.stopAnimation(),this._updateAnimateState(!0)),this._reCompile(t),e?this._renderSync(i):this._renderAsync(i)}_updateCustomConfigAndRecompile(t,e={}){return!!t&&(this._reCompile(t),this._beforeRender(e))}_reCompile(t,e){var i,r,n,s,a,o,l,h;if(t.reMake)this._releaseData(),this._initDataSet(),this._chartSpecTransformer=null,null===(i=this._chart)||void 0===i||i.release(),this._chart=null,t.changeTheme&&(this._setCurrentTheme(),this._setFontFamilyTheme(null===(r=this._currentTheme)||void 0===r?void 0:r.fontFamily)),null===(n=this._compiler)||void 0===n||n.releaseGrammar(!1===(null===(s=this._option)||void 0===s?void 0:s.animation)||!1===(null===(a=this._spec)||void 0===a?void 0:a.animation)),this._userEvents.forEach(t=>{var e;return null===(e=this._event)||void 0===e?void 0:e.on(t.eType,t.query,t.handler)}),t.reSize&&this._doResize();else if(t.changeTheme&&(this._setCurrentTheme(),this._setFontFamilyTheme(null===(o=this._currentTheme)||void 0===o?void 0:o.fontFamily)),t.reCompile&&(null===(l=this._compiler)||void 0===l||l.clear({chart:this._chart,vChart:this},!this._option.animation||!this._spec.animation),null===(h=this._compiler)||void 0===h||h.compile({chart:this._chart,vChart:this},{})),t.reSize){let{width:t,height:e}=this.getCurrentSize();this._chart.onResize(t,e,!1),this._compiler.resize(t,e,!1)}}_beforeRender(t={}){var e,i,r,n,s,a,o,l;if(this._isReleased)return!1;if(this._chart)return!0;let{transformSpec:h,actionSource:u}=t;return h&&this._initChartSpec(this._spec,"render"),this._chartPluginApply("onBeforeInitChart",this._spec,u),null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeInitializeChart)||void 0===i||i.call(e),this._initChart(this._spec),null===(n=null===(r=this._option.performanceHook)||void 0===r?void 0:r.afterInitializeChart)||void 0===n||n.call(r),!(!this._chart||!this._compiler)&&(null===(a=null===(s=this._option.performanceHook)||void 0===s?void 0:s.beforeCompileToVGrammar)||void 0===a||a.call(s),this._compiler.compile({chart:this._chart,vChart:this},{performanceHook:this._option.performanceHook}),null===(l=null===(o=this._option.performanceHook)||void 0===o?void 0:o.afterCompileToVGrammar)||void 0===l||l.call(o),!0)}_afterRender(){return!this._isReleased&&(this._updateAnimateState(),this._event.emit(c1.rendered,{chart:this._chart,vchart:this}),!0)}renderSync(t){return this._renderSync({morphConfig:t,transformSpec:!0,actionSource:"render"})}renderAsync(t){return CA(this,void 0,void 0,function*(){return this._renderAsync({morphConfig:t,transformSpec:!0,actionSource:"render"})})}_renderSync(t={}){var e;return this._beforeRender(t)&&(null===(e=this._compiler)||void 0===e||e.render(t.morphConfig),this._afterRender()),this}_renderAsync(t={}){return CA(this,void 0,void 0,function*(){return this._renderSync(t)})}_updateAnimateState(t){var e,i;if(this._option.animation){let r=t?t_.appear:t_.update;null===(e=this._chart)||void 0===e||e.getAllRegions().forEach(t=>{var e;null===(e=t.animate)||void 0===e||e.updateAnimateState(r,!0)}),null===(i=this._chart)||void 0===i||i.getAllComponents().forEach(t=>{var e;null===(e=t.animate)||void 0===e||e.updateAnimateState(r,!0)})}}release(){var t,e,i,r;(null===(t=this._onResize)||void 0===t?void 0:t.cancel)&&this._onResize.cancel(),this._chartPluginApply("releaseAll"),this._chartPlugin=null,this._chartSpecTransformer=null,null===(e=this._chart)||void 0===e||e.release(),null===(i=this._eventDispatcher)||void 0===i||i.release(),null===(r=this._compiler)||void 0===r||r.release(),this._unBindResizeEvent(),this._releaseData(),this._onError=null,this._onResize=null,this._container=null,this._currentTheme=null,this._option=null,this._chart=null,this._compiler=null,this._spec=null,this._specInfo=null,this._originalSpec=null,this._userEvents=null,this._event=null,this._eventDispatcher=null,this._isReleased=!0,uY.unregisterInstance(this)}updateData(t,e,i,r){return CA(this,void 0,void 0,function*(){return this.updateDataSync(t,e,i,r)})}_updateDataById(t,e,i){let r=this._spec.data.find(e=>e.name===t||e.id===t);r?r.id===t?r.values=e:r.name===t&&r.parse(e,i):eM(e)?this._spec.data.push({id:t,values:e}):this._spec.data.push(e)}updateDataInBatches(t){return CA(this,void 0,void 0,function*(){return this._chart?(this._chart.updateFullData(t.map(({id:t,data:e,options:i})=>({id:t,values:e,parser:i}))),this._chart.updateGlobalScaleDomain(),this._compiler.render()):(this._spec.data=om(this._spec.data),t.forEach(({id:t,data:e,options:i})=>{this._updateDataById(t,e,i)})),this})}updateDataSync(t,e,i,r){return ej(this._dataSet)||(this._chart?((null==r?void 0:r.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._chart.updateData(t,e,!0,i),this._compiler.render()):(this._spec.data=om(this._spec.data),this._updateDataById(t,e,i))),this}updateFullDataSync(t,e=!0,i){if(this._chart)return(null==i?void 0:i.reAnimate)&&(this.stopAnimation(),this._updateAnimateState(!0)),this._chart.updateFullData(t),e&&this._compiler.render(),this;let r=om(this._spec.data);return om(t).forEach(t=>{var e;let{id:i,values:n,parser:s,fields:a}=t,o=r.find(t=>t.name===i);if(o)o instanceof eH?(o.setFields(eP(a)),o.parse(n,eP(s))):(o.values=n,eO(s)&&(o.parser=s),eO(a)&&(o.fields=a));else{let i=gB(t,this._dataSet,r,{onError:null===(e=this._option)||void 0===e?void 0:e.onError});eM(this._spec.data)&&this._spec.data.push(i)}}),this}updateFullData(t,e=!0){return CA(this,void 0,void 0,function*(){return this.updateFullDataSync(t,e)})}updateSpec(t,e=!1,i,r){return CA(this,void 0,void 0,function*(){let n=this._updateSpec(t,e,r);return n&&(yield this.updateCustomConfigAndRerender(n,!1,{morphConfig:i,transformSpec:n.reTransformSpec,actionSource:"updateSpec"})),this})}updateSpecSync(t,e=!1,i,r){let n=this._updateSpec(t,e,r);return n&&this.updateCustomConfigAndRerender(n,!0,{morphConfig:i,transformSpec:n.reTransformSpec,actionSource:"updateSpec"}),this}updateSpecAndRecompile(t,e=!1,i={}){let r=this._updateSpec(t,e);return this._updateCustomConfigAndRecompile(r,Object.assign({actionSource:"updateSpecAndRecompile"},i))}_updateSpec(t,e=!1,i){var r,n;let s=this._spec,a={reTransformSpec:!1,change:!1,reMake:!1,reCompile:!1,reSize:!1,changeTheme:!1};if(!this._setNewSpec(t,e))return;my(s.theme,this._spec.theme)||(a.changeTheme=!0);let o=this._shouldChartResize(s);if(a.reSize=o,null===(n=null===(r=this._compiler)||void 0===r?void 0:r.getVGrammarView())||void 0===n||n.updateLayoutTag(),this._spec.type!==s.type)return a.reMake=!0,a.reTransformSpec=!0,a.change=!0,a;this._initChartSpec(this._spec,"render");let l=bm(this._chart.updateSpec(this._spec),a);return i?Object.assign(Object.assign({},l),i):l}updateModelSpec(t,e,i=!1,r){return CA(this,void 0,void 0,function*(){if(!e||!this._spec)return this;if(eE(e)&&(e=JSON.parse(e)),nx(t)||ua(this._spec,t,e,i),this._chart){let n=this._chart.getModelInFilter(t);if(n)return this._updateModelSpec(n,e,!1,i,r)}return this})}updateModelSpecSync(t,e,i=!1,r){if(!e||!this._spec)return this;if(eE(e)&&(e=JSON.parse(e)),nx(t)||ua(this._spec,t,e,i),this._chart){let n=this._chart.getModelInFilter(t);if(n)return this._updateModelSpec(n,e,!0,i,r)}return this}_updateModelSpec(t,e,i=!1,r=!1,n){r&&(e=us({},t.getSpec(),e));let s=t.updateSpec(e);return t.reInit(e),(s.change||s.reCompile||s.reMake||s.reSize||s.reRender)&&this._chart.reDataFlow(),this.updateCustomConfigAndRerender(s,i,{morphConfig:n,transformSpec:!1,actionSource:"updateModelSpec"})}resize(t,e){return CA(this,void 0,void 0,function*(){return this.resizeSync(t,e)})}resizeSync(t,e){var i,r;return this._beforeResize(t,e)?(null===(r=(i=this._compiler).resize)||void 0===r||r.call(i,t,e),this._afterResize()):this}_beforeResize(t,e){var i,r,n,s;if(!this._chart||!this._compiler)return!1;let a=this._chart.getCanvasRect();return(!a||a.width!==t||a.height!==e)&&(this._chartPluginApply("onBeforeResize",t,e),null===(r=null===(i=this._option.performanceHook)||void 0===i?void 0:i.beforeResizeWithUpdate)||void 0===r||r.call(i),this._chart.onResize(t,e,!1),null===(s=null===(n=this._option.performanceHook)||void 0===n?void 0:n.afterResizeWithUpdate)||void 0===s||s.call(n),!0)}_afterResize(){return this._isReleased||this._event.emit(c1.afterResize,{chart:this._chart}),this}updateViewBox(t,e=!0,i=!0){return this._chart&&this._compiler&&(this._viewBox=t,this._chart.updateViewBox(t,i),i&&(this._compiler.render(),this._chart.onEvaluateEnd()),this._compiler.updateViewBox(t,e)),this}on(t,e,i){var r;this._userEvents&&(this._userEvents.push({eType:t,query:"function"==typeof e?null:e,handler:"function"==typeof e?e:i}),null===(r=this._event)||void 0===r||r.on(t,e,i))}off(t,e){var i;if(this._userEvents&&0!==this._userEvents.length){if(e){let r=this._userEvents.findIndex(i=>i.eType===t&&i.handler===e);r>=0&&(this._userEvents.splice(r,1),null===(i=this._event)||void 0===i||i.off(t,e))}else this._userEvents.forEach(e=>{var i;e.eType===t&&(null===(i=this._event)||void 0===i||i.off(t,e.handler))}),this._userEvents=this._userEvents.filter(e=>e.eType!==t)}}updateState(t,e){this._chart&&this._chart.updateState(t,e)}setSelected(t,e,i){this._chart&&this._chart.setSelected(t,e,i)}setHovered(t,e,i){this._chart&&this._chart.setHovered(t,e,i)}clearState(t){this._chart&&this._chart.clearState(t)}clearSelected(){this._chart&&this._chart.clearSelected()}clearHovered(){this._chart&&this._chart.clearHovered()}_updateCurrentTheme(t){var e,i,r;let n=this._option.theme,s=null===(e=this._spec)||void 0===e?void 0:e.theme;if(t&&(this._currentThemeName=t),mk(n)&&mk(s))this._currentTheme=uZ(this._currentThemeName,!0);else if(eE(n)&&(!s||eE(s))||eE(s)&&(!n||eE(n))){let t=uo({},uZ(this._currentThemeName,!0),uZ(n,!0),uZ(s,!0));this._currentTheme=t}else{let t=uo({},uZ(this._currentThemeName),uZ(n),uZ(s));this._currentTheme=uD(t)}r=dq(this._currentTheme,"component.poptip"),eF(v4.poptip,v5,r),null===(i=this._compiler)||void 0===i||i.setBackground(this._getBackground())}_shouldChartResize(t){var e,i;let r=!1;ej(this._spec.width)?ej(t.width)||(this._spec.width=t.width):this._spec.width!==t.width&&(r=!0),ej(this._spec.height)?ej(t.height)||(this._spec.height=t.height):this._spec.height!==t.height&&(r=!0);let n=this._autoSize;return this._autoSize=!!hl(this._option.mode)&&(null===(i=null!==(e=this._spec.autoFit)&&void 0!==e?e:this._option.autoFit)||void 0===i||i),this._autoSize!==n&&(r=!0),r}_getBackground(){return("string"==typeof this._spec.background||nb(this._spec.background)&&this._spec.background.gradient?this._spec.background:null)||this._currentTheme.background||this._option.background}getCurrentTheme(){return uZ(this._currentThemeName)}getCurrentThemeName(){return this._currentThemeName}setCurrentTheme(t){var e;return CA(this,void 0,void 0,function*(){if(!uK.themeExist(t))return this;let i=this._setCurrentTheme(t);return this._setFontFamilyTheme(null===(e=this._currentTheme)||void 0===e?void 0:e.fontFamily),yield this.updateCustomConfigAndRerender(i,!1,{transformSpec:!1,actionSource:"setCurrentTheme"}),this})}setCurrentThemeSync(t){var e;if(!uK.themeExist(t))return this;let i=this._setCurrentTheme(t);return this._setFontFamilyTheme(null===(e=this._currentTheme)||void 0===e?void 0:e.fontFamily),this.updateCustomConfigAndRerender(i,!0,{transformSpec:!1,actionSource:"setCurrentTheme"}),this}_setCurrentTheme(t){var e;return this._updateCurrentTheme(t),this._initChartSpec(this._getSpecFromOriginalSpec(),"setCurrentTheme"),null===(e=this._chart)||void 0===e||e.setCurrentTheme(),{change:!0,reMake:!1}}_setFontFamilyTheme(t){var e;t&&(null===(e=this.getStage())||void 0===e||e.setTheme({text:{fontFamily:t}}))}_getTooltipComponent(){var t;return null===(t=this._chart)||void 0===t?void 0:t.getComponentsByType(lx.tooltip)[0]}setTooltipHandler(t){var e,i;this._context.tooltipHandler=t;let r=this._getTooltipComponent();r&&(null===(i=null===(e=r.tooltipHandler)||void 0===e?void 0:e.release)||void 0===i||i.call(e),r.tooltipHandler=t)}getTooltipHandlerByUser(){var t;return null===(t=this._context)||void 0===t?void 0:t.tooltipHandler}getTooltipHandler(){let t=this._getTooltipComponent();return t?t.tooltipHandler:this._context.tooltipHandler}showTooltip(t,e){var i;let r=this._getTooltipComponent();return null!==(i=eO(t)&&"none"!==(null==r?void 0:r.showTooltip(t,e)))&&void 0!==i&&i}hideTooltip(){var t;let e=this._getTooltipComponent();return null!==(t=null==e?void 0:e.hideTooltip())&&void 0!==t&&t}getLegendDataById(t){var e;let i=null===(e=this._chart)||void 0===e?void 0:e.getComponentByUserId(t);return i?i.getLegendData():[]}getLegendDataByIndex(t=0){var e;let i=null===(e=this._chart)||void 0===e?void 0:e.getComponentsByType(lx.discreteLegend);return i&&i[t]?i[t].getLegendData():[]}getLegendSelectedDataById(t){var e;let i=null===(e=this._chart)||void 0===e?void 0:e.getComponentByUserId(t);return i?i.getSelectedData():[]}getLegendSelectedDataByIndex(t=0){var e;let i=null===(e=this._chart)||void 0===e?void 0:e.getComponentsByType(lx.discreteLegend);return i&&i[t]?i[t].getSelectedData():[]}setLegendSelectedDataById(t,e){var i;let r=null===(i=this._chart)||void 0===i?void 0:i.getComponentByUserId(t);r&&r.setSelectedData(e)}setLegendSelectedDataByIndex(t=0,e){var i;let r=null===(i=this._chart)||void 0===i?void 0:i.getComponentsByType(lx.discreteLegend);r&&r[t]&&r[t].setSelectedData(e)}getDataURL(){var t;return CA(this,void 0,void 0,function*(){let e=this.getStage();if(this._chart&&e){e.render();let t=this._chart.getCanvas();return yield function(t,e){var i,r,n,s,a;return r=this,n=void 0,s=void 0,a=function*(){if(!t)return"";try{if(void 0!==OffscreenCanvas&&t instanceof OffscreenCanvas){var r;return r=t,new Promise(t=>{r.convertToBlob().then(e=>{let i=new FileReader;i.readAsDataURL(e),i.onload=()=>{t(i.result)}})})}}catch(t){(null!==(i=null==e?void 0:e.onError)&&void 0!==i?i:hc)(`getCanvasDataURL error : ${t.toString()}`)}return t.toDataURL()},new(s||(s=Promise))(function(t,e){function i(t){try{l(a.next(t))}catch(t){e(t)}}function o(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var r;e.done?t(e.value):((r=e.value)instanceof s?r:new s(function(t){t(r)})).then(i,o)}l((a=a.apply(r,n||[])).next())})}(t,{onError:this._onError})}return null===(t=this._option)||void 0===t||t.onError(ReferenceError("render is not defined")),null})}exportImg(t){var e,i;return CA(this,void 0,void 0,function*(){if(!hl(this._option.mode))return void(null===(e=this._option)||void 0===e||e.onError(TypeError("non-browser environment can not export img")));let r=yield this.getDataURL();r?function(t="vchart",e){let i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("target","_blank"),i.setAttribute("download",`${t}.png`),i.dispatchEvent(new MouseEvent("click"))}(t,r):null===(i=this._option)||void 0===i||i.onError(ReferenceError("render is not defined"))})}exportCanvas(){var t;let e=this.getStage();if(this._chart&&e)return e.toCanvas();null===(t=this._option)||void 0===t||t.onError(ReferenceError("render is not defined"))}getImageBuffer(){var t,e;if("node"!==this._option.mode)return void(null===(t=this._option)||void 0===t||t.onError(TypeError("getImageBuffer() now only support node environment.")));let i=this.getStage();return i?(i.render(),i.window.getImageBuffer()):(null===(e=this._option)||void 0===e||e.onError(ReferenceError("render is not defined")),null)}setLayout(t){var e;this._option.layout=t,null===(e=this._chart)||void 0===e||e.setLayout(t)}reLayout(){var t;null===(t=this._chart)||void 0===t||t.setLayoutTag(!0)}getCompiler(){return this._compiler}getChart(){return this._chart}getStage(){return this._compiler.getStage()}getCanvas(){var t;return null===(t=this._compiler)||void 0===t?void 0:t.getCanvas()}getContainer(){var t;let e;return eO(this._container)?this._container:eO(e=eE(this._canvas)?lX.getElementById(this._canvas):this._canvas)?e.parentElement:null===(t=this.getCanvas())||void 0===t?void 0:t.parentElement}getComponents(){return this._chart.getAllComponents()}getScale(t){var e;let i=null===(e=this._chart)||void 0===e?void 0:e.getGlobalScale();return null==i?void 0:i.getScale(t)}setDimensionIndex(t,e={}){var i;return null===(i=this._chart)||void 0===i?void 0:i.setDimensionIndex(t,e)}stopAnimation(){var t,e,i;null===(i=null===(e=null===(t=this._compiler)||void 0===t?void 0:t.getVGrammarView())||void 0===e?void 0:e.animate)||void 0===i||i.stop()}pauseAnimation(){var t,e,i;null===(i=null===(e=null===(t=this._compiler)||void 0===t?void 0:t.getVGrammarView())||void 0===e?void 0:e.animate)||void 0===i||i.pause()}resumeAnimation(){var t,e,i;null===(i=null===(e=null===(t=this._compiler)||void 0===t?void 0:t.getVGrammarView())||void 0===e?void 0:e.animate)||void 0===i||i.resume()}convertDatumToPosition(t,e={},i=!1,r){var n;let s;if(!this._chart||mk(t))return null;let{seriesId:a,seriesIndex:o=0}=e;if(eO(a)?s=this._chart.getSeriesInUserId(a):eO(o)&&(s=null===(n=this._chart.getSeriesInIndex([o]))||void 0===n?void 0:n[0]),s){let e;let n=Object.keys(t),a=s.getViewData().latestData.find(e=>n.every(i=>e[i]==t[i])),o=s.getRegion().getLayoutStartPoint();return(e=a?s.dataToPosition(a,r):s.dataToPosition(t,r))?hr(e,o,i):null}return null}convertValueToPosition(t,e,i=!1){var r,n;let s;if(!this._chart||ej(t)||mk(e))return null;if(!eM(t)){let n;let{axisId:s,axisIndex:a}=e;if(eO(s)?n=this._chart.getComponentsByKey("axes").find(t=>t.userId===s):eO(a)&&(n=null===(r=this._chart.getComponentsByKey("axes"))||void 0===r?void 0:r[a]),!n)return hd("Please check whether the `axisId` or `axisIndex` is set!"),null;let o=null==n?void 0:n.valueToPosition(t);if(i){let t=n.getLayoutStartPoint(),e=n.getOrient();return o+("bottom"===e||"top"===e?t.x:t.y)}return o}let{seriesId:a,seriesIndex:o}=e;return eO(a)?s=this._chart.getSeriesInUserId(a):eO(o)&&(s=null===(n=this._chart.getSeriesInIndex([o]))||void 0===n?void 0:n[0]),s?hr(s.valueToPosition(t[0],t[1]),s.getRegion().getLayoutStartPoint(),i):(hd("Please check whether the `seriesId` or `seriesIndex` is set!"),null)}getFunction(t){return MI.instance().getFunction(t)}registerFunction(t,e){t&&e&&MI.instance().registerFunction(t,e)}unregisterFunction(t){t&&MI.instance().unregisterFunction(t)}getFunctionList(){return MI.instance().getFunctionNameList()}setRuntimeSpec(t){this._spec=t,this._updateSpecInfo()}updateIndicatorDataById(t,e){var i;let r=null===(i=this._chart)||void 0===i?void 0:i.getComponentByUserId(t);r&&r.updateDatum(e)}updateIndicatorDataByIndex(t=0,e){var i;let r=null===(i=this._chart)||void 0===i?void 0:i.getComponentsByType(lx.indicator);r&&r[t]&&r[t].updateDatum(e)}geoZoomByIndex(t=0,e,i){var r,n;let s=null===(r=this._chart)||void 0===r?void 0:r.getRegionsInQuerier({regionIndex:t})[0],a=null===(n=this._chart)||void 0===n?void 0:n.getComponentsByType(lx.geoCoordinate),o=null==a?void 0:a.find(t=>{var e;return null===(e=t.getRegions())||void 0===e?void 0:e.includes(s)});o&&o.dispatchZoom(e,i)}geoZoomById(t,e,i){var r,n;let s=null===(r=this._chart)||void 0===r?void 0:r.getRegionsInQuerier({regionId:t})[0],a=null===(n=this._chart)||void 0===n?void 0:n.getComponentsByType(lx.geoCoordinate),o=null==a?void 0:a.find(t=>{var e;return null===(e=t.getRegions())||void 0===e?void 0:e.includes(s)});o&&o.dispatchZoom(e,i)}_initChartPlugin(){let t=de.getChartPlugins();t.length>0&&(this._chartPlugin=new Ch(this),this._chartPlugin.load(t.map(t=>new t)),this._chartPluginApply("onInit",this._spec))}_chartPluginApply(t,...e){this._chartPlugin&&this._chartPlugin[t]&&this._chartPlugin[t].apply(this._chartPlugin,e)}_getMode(){return this._option.mode||lb["desktop-browser"]}_getChartOption(t){return{type:t,globalInstance:this,eventDispatcher:this._eventDispatcher,dataSet:this._dataSet,container:this._container,canvas:this._canvas,map:new Map,mode:this._getMode(),modeParams:this._option.modeParams,getCompiler:()=>this._compiler,performanceHook:this._option.performanceHook,viewBox:this._viewBox,animation:this._option.animation,getTheme:()=>{var t;return null!==(t=this._currentTheme)&&void 0!==t?t:{}},getSpecInfo:()=>{var t;return null!==(t=this._specInfo)&&void 0!==t?t:{}},layout:this._option.layout,onError:this._onError,disableTriggerEvent:!0===this._option.disableTriggerEvent}}}function CC(t,e){for(let i=0;i<e.length;i++){let r=e[i],n=function(t,e){return t.find(t=>t.key===e)}(t,r.key);n?n.operations=[...new Set(n.operations.concat(r.operations))]:t.push(r)}return t}CM.InstanceManager=uY,CM.ThemeManager=uK,CM.globalConfig={uniqueTooltip:!0},CM.Utils={measureText:(t,e,i,r)=>MB(e,i,r).measure(t)},CM.vglobal=lX,de.registerRegion("region",b1),de.registerLayout("base",b7),AQ(),v2.useRegisters([()=>{d0.registerTransform("filter",{transform:Ml,markPhase:"beforeJoin"},!0)},()=>{d0.registerTransform("map",{transform:Mh,markPhase:"beforeJoin"},!0)}]),v2.useRegisters([w0,w1,wI,wL,wJ,wQ,w2,w3,w5]),CS(Cm,Ck),d0.registerInteraction(Cm.type,Cm),CS(Cf,Ck),d0.registerInteraction(Cf.type,Cf),uV(Co.name,Co),ex.getInstance(lS.Error);function CT(t,e){var i;if(!t)return null!=e?e:null;let r=t.getFields();return r&&r[e]?null!==(i=r[e].alias)&&void 0!==i?i:e:null!=e?e:null}function CE(t,e,i){let r=t.getStackSort(),n={},s=null;return r&&(s={},t.getSeries().forEach(t=>{let e=t.getSeriesField();if(e){let i=t.getRawDataStatisticsByField(e);i.values&&(s[e]||(s[e]={lastIndex:0,sort:{}}),i.values.forEach((t,i)=>{t in s[e].sort||(s[e].sort[t]=s[e].lastIndex,s[e].lastIndex++)}))}})),t.getSeries().forEach(t=>{var r;let a=t.getStackData(),o=t.getStackValue(),l=t.getStackValueField(),h=!i||i(t);a&&l&&h&&(n[o]=null!==(r=n[o])&&void 0!==r?r:{nodes:{}},function t(e,i,r,n,s,a,o){if("values"in i){if(s&&i.values.forEach(t=>t[bO]=function(t){if(l1(t))return t;let e=+t;return l1(e)?e:0}(t[n])),r.series.push({s:e,values:i.values}),a){let t=e.getSeriesField();i.values.forEach(i=>{r.sortDatums.push({series:e,datum:i,index:t?a[t].sort[i[t]]:0})})}else r.values.push(...i.values)}else for(let l in i.nodes){let h=o?`${o}_${l}`:l;r.nodes[l]||(r.nodes[l]={values:[],series:[],nodes:{},sortDatums:[],key:h}),t(e,i.nodes[l],r.nodes[l],n,s,a,h)}}(t,a,n[o],l,e,s))}),r?function t(e,i){var r;for(let n in e)(null===(r=e[n].sortDatums)||void 0===r?void 0:r.length)?(e[n].sortDatums.sort((t,e)=>t.index-e.index),e[n].values=e[n].sortDatums.map(t=>t.datum)):t(e[n].nodes,i);return e}(n,s):n}let CO=(t,e)=>{let i=e.beforeCall();return t.forEach((t,r)=>e.call(t,r,i)),i.keyMap&&(i.keyMap.clear(),i.keyMap=null),t};class CP{constructor(){this.activeTriggerSet={mark:new Set,dimension:new Set,group:new Set},this.ignoreTriggerSet={mark:new Set,dimension:new Set,group:new Set}}}let CR=t=>{var e,i,r;if(!1===(null==t?void 0:t.visible))return[];let n={mark:!1!==(null===(e=null==t?void 0:t.mark)||void 0===e?void 0:e.visible),dimension:!1!==(null===(i=null==t?void 0:t.dimension)||void 0===i?void 0:i.visible),group:!1!==(null===(r=null==t?void 0:t.group)||void 0===r?void 0:r.visible)};return eO(null==t?void 0:t.activeType)&&Object.keys(n).forEach(e=>{var i;n[e]=null===(i=null==t?void 0:t.activeType)||void 0===i?void 0:i.includes(e)}),Object.keys(n).filter(t=>n[t])};class CB extends CP{constructor(t){super(),this._getSeriesCacheInfo=()=>{var t,e,i;let{series:r}=this,n=r.getSeriesField();return{seriesFields:eO(n)?om(n):null!==(t=r.getSeriesKeys())&&void 0!==t?t:[],dimensionFields:null!==(e=r.getDimensionField())&&void 0!==e?e:[],measureFields:null!==(i=r.getMeasureField())&&void 0!==i?i:[],type:r.type}},this._getDimensionData=t=>{let{dimensionFields:e}=this._seriesCacheInfo;return e[0]&&(null==t?void 0:t[e[0]])},this._getMeasureData=t=>{let{measureFields:e}=this._seriesCacheInfo;return e[0]&&(null==t?void 0:t[e[0]])},this._getSeriesFieldData=t=>{let{dimensionFields:e,seriesFields:i}=this._seriesCacheInfo;if(eO(i[0])&&(null==t?void 0:t[i[0]]))return null==t?void 0:t[i[0]];let r=e[e.length-1];return e.length>1&&(0===i.length||this.series.getSeriesKeys().length),null==t?void 0:t[r]},this._getSeriesStyle=(t,e,i)=>{var r;for(let i of om(e)){let e=null===(r=this.series.getSeriesStyle(t))||void 0===r?void 0:r(i);if(eO(e))return e}return i},this.markTooltipKeyCallback=(t,e)=>this._getSeriesFieldData(t),this.markTooltipValueCallback=(t,e)=>this._getMeasureData(t),this.shapeTypeCallback=(t,e)=>{var i;return null!==(i=this._getSeriesStyle(t,"shape",null))&&void 0!==i?i:this._getSeriesStyle(t,"symbolType",this.series.getDefaultShapeType())},this.shapeColorCallback=(t,e)=>this._getSeriesStyle(t,["fill","stroke"]),this.shapeStrokeCallback=(t,e)=>this._getSeriesStyle(t,["stroke","fill"]),this.dimensionTooltipTitleCallback=(t,e)=>this._getDimensionData(t),this.groupTooltipTitleCallback=(t,e)=>this._getSeriesFieldData(t),this.groupTooltipKeyCallback=(t,e)=>{let{seriesFields:i}=this._seriesCacheInfo,r=this._seriesCacheInfo.dimensionFields;return i[0]&&(r=r.filter(t=>t!==i[0])),r.map(e=>null==t?void 0:t[e]).join("-")},this.series=t,this.updateTooltipSpec()}updateTooltipSpec(){var t,e,i,r;let n=null!==(e=null===(t=this.series.getSpec())||void 0===t?void 0:t.tooltip)&&void 0!==e?e:{},s=Object.assign(Object.assign({},null!==(r=null===(i=this.series.getChart().getSpec())||void 0===i?void 0:i.tooltip)&&void 0!==r?r:{}),n);["mark","dimension","group"].forEach(t=>{let e=s[t];eO(e)&&(s[t]=Object.assign(Object.assign({},e),{title:CL(e.title,{seriesId:this.series.id},!0),content:CD(e.content,{seriesId:this.series.id},!0)}))}),this.spec=s,this.activeType=CR(s),this._seriesCacheInfo=this._getSeriesCacheInfo()}getDefaultTooltipPattern(t,e){switch(t){case"mark":return{visible:!0,activeType:t,title:{key:void 0,value:this.dimensionTooltipTitleCallback,hasShape:!1},content:[{seriesId:this.series.id,key:this.markTooltipKeyCallback,value:this.markTooltipValueCallback,hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1}]};case"group":return{visible:!0,activeType:t,title:{key:void 0,value:this.groupTooltipTitleCallback,hasShape:!1},content:[{seriesId:this.series.id,key:this.groupTooltipKeyCallback,value:this.markTooltipValueCallback,hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1}]};case"dimension":if(e){let i={key:void 0,value:this.dimensionTooltipTitleCallback,hasShape:!1},r=[];return e.forEach(({data:t})=>t.forEach(({series:t})=>{r.push({seriesId:t.id,key:this.markTooltipKeyCallback,value:this.markTooltipValueCallback,hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1})})),{visible:!0,activeType:t,title:i,content:r}}}return null}}let CI=(t,e,i)=>{let r=nx(e)?e(t):e;return i?Object.assign(Object.assign({},t),r):Object.assign(Object.assign({},r),t)},CL=(t,e,i)=>eO(t)?nx(t)?(...r)=>CI(t(...r),e,i):CI(t,e,i):void 0,CD=(t,e,i)=>eO(t)?om(t).map(t=>nx(t)?(...r)=>om(t(...r)).map(t=>CI(t,e,i)):CI(t,e,i)):void 0,CF={min:t=>t.length?o_(t.map(t=>1*t)):0,max:t=>t.length?oy(t.map(t=>1*t)):0,"array-min":t=>t.length?o_(t.map(t=>1*t)):0,"array-max":t=>t.length?oy(t.map(t=>1*t)):0,values:t=>{let e={},i=[];for(let r of t)e[r]||(i.push(r),e[r]=1);return i}},Cj=(t,e)=>{var i,r;let n=e.fields;if(nx(n)&&(n=n()),!(null==n?void 0:n.length)||!(null==t?void 0:t.length))return{};n=CC([],n);let s="parser"===e.target?"parserData":"latestData",a=t[0][s]?t[0][s]:t||[];return CN(a,n,null===(r=(i=t[0]).getFields)||void 0===r?void 0:r.call(i))},CN=(t,e,i)=>{let r={},n=[],s=[];return e.forEach(e=>{let a=e.key;r[a]={};let o=null==i?void 0:i[a],l=e.operations,h=l.some(t=>"min"===t||"max"===t||"allValid"===t),u=!0;n.length=0,t.forEach(t=>{t&&n.push(t[a])});let d=n.length;if(h){s.length=0,n.forEach((t,e)=>{l8(t)&&s.push(t)});let t=n;n=s,s=t,u=n.length===d}else n=l.some(t=>"array-min"===t||"array-max"===t)?n.reduce((t,e)=>(e&&e.forEach(e=>{l8(e)&&t.push(e)}),t),[]):n.filter(t=>void 0!==t);e.filter&&(n=n.filter(e.filter)),l.forEach(t=>{if(e.customize)r[a][t]=e.customize;else{if(o&&o.lockStatisticsByDomain&&!ej(o.domain)){if("values"===t)return void(r[a][t]=o.domain.slice())}else if("allValid"===t)return;r[a][t]=CF[t](n),"array-max"===t&&(r[a].max=r[a][t]),"array-min"===t&&(r[a].min=r[a][t])}}),h&&(r[a].allValid=u)}),r},Cz=(t,e)=>{let{config:i}=e;if(!i)return t;let{invalidType:r,checkField:n}=i();return"zero"!==r||n&&n.length&&t.forEach(t=>{n.forEach(e=>{l8(t[e])||(t[e]=0)})}),t};class CH extends Sa{_compileProduct(){var t;ej(null===(t=this._data)||void 0===t?void 0:t.latestData)||eO(this.getProduct())||this._initProduct([])}generateProductId(){var t;return null===(t=this._data)||void 0===t?void 0:t.name}}let CV=`${hA}_HIERARCHY_DEPTH`,CW=`${hA}_HIERARCHY_ROOT`,CG=`${hA}_HIERARCHY_ROOT_INDEX`;function CU(){return{keyMap:new Map,needDefaultSeriesField:!this._seriesField,defaultSeriesField:this._seriesField?null:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey)}}function C$(t,e,i){t&&(i.needDefaultSeriesField&&(t[bM]=i.defaultSeriesField),t[bA]=e,t[bw]=i.getKey(t,e,i))}function CY(){return{keyMap:new Map,needDefaultSeriesField:!0,defaultSeriesField:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey),categoryField:this.getCategoryField()}}function CK(t,e,i,r=0,n,s){void 0===s&&(s=e),C$(t,e,i),t[CV]=r,t[CW]=n||t[i.categoryField],t[CG]=s,t.children&&t.children.length&&t.children.forEach((e,r)=>CK(e,r,i,t[CV]+1,t[CW],s))}let CZ=["appear","enter","update","exit","disappear","normal"];function CX(t={},e,i){let r={};for(let n=0;n<CZ.length;n++){let s,a;let o=CZ[n],l=e?e[o]:void 0;if(!1!==l){if("normal"===o){l&&(r.normal=l);continue}("update"===o||l||t[o])&&((s=eM(t[o])?t[o]:[Object.assign(Object.assign({},w4[o]),t[o])],"exit"===o&&s.forEach(t=>{t.controlOptions={stopWhenStateChange:!0}}),l)?(a=eM(l)?l.map((t,e)=>{var r;let n=t;return C1(n)&&delete n.type,n.oneByOne&&(n=CJ(n,null!==(r=null==i?void 0:i.dataIndex)&&void 0!==r?r:CQ,null==i?void 0:i.dataCount)),n}):s.map((t,e)=>{var r;let n=us({},s[e],l);return C1(n)&&delete n.type,n.oneByOne&&(n=CJ(n,null!==(r=null==i?void 0:i.dataIndex)&&void 0!==r?r:CQ,null==i?void 0:i.dataCount)),n}),r[o]=a):r[o]=s)}}return r.state=r.update,r}function Cq(t,e,i){var r,n,s,a,o;let l={};return eO(e.animationAppear)&&(l.appear=null!==(r=e.animationAppear[t])&&void 0!==r?r:e.animationAppear),eO(e.animationDisappear)&&(l.disappear=null!==(n=e.animationDisappear[t])&&void 0!==n?n:e.animationDisappear),eO(e.animationEnter)&&(l.enter=null!==(s=e.animationEnter[t])&&void 0!==s?s:e.animationEnter),eO(e.animationExit)&&(l.exit=null!==(a=e.animationExit[t])&&void 0!==a?a:e.animationExit),eO(e.animationUpdate)&&(l.update=null!==(o=e.animationUpdate[t])&&void 0!==o?o:e.animationUpdate),e.animationNormal&&e.animationNormal[t]&&(l.normal=e.animationNormal[t]),function(t,e){return t&&function t(e,i){if(eM(e))e.forEach((r,n)=>{e[n]=i(e[n],n),t(e[n],i)});else if(nb(e))for(let r in e)e[r]=i(e[r],r),t(e[r],i)}(t=eP(t),t=>{var i;return nx(t)&&(null===(i=t.prototype)||void 0===i?void 0:i.constructor)!==t?(...i)=>t(...i,e):t}),t}(l,i)}function CJ(t,e,i){let{oneByOne:r,duration:n,delay:s,delayAfter:a}=t;return t.delay=(t,i,a)=>{let o=e(t,a),l=nx(n)?n(t,i,a):l1(n)?n:0,h=nx(s)?s(t,i,a):l1(s)?s:0,u=nx(r)?r(t,i,a):r;return!1===u?h:h+o*(l+(u=!0===u?0:u))},t.delayAfter=(t,s,o)=>{let l=e(t,o),h=nx(n)?n(t,s,o):l1(n)?n:0,u=nx(a)?a(t,s,o):l1(a)?a:0,d=nx(r)?r(t,s,o):r;return!1===d?u:(d=!0===d?0:d,u+((i?i():s.mark.elements.length)-l)*(h+d))},delete t.oneByOne,t}function CQ(t,e){var i,r;return null!==(i=null==t?void 0:t[bA])&&void 0!==i?i:null===(r=null==e?void 0:e.VGRAMMAR_ANIMATION_PARAMETERS)||void 0===r?void 0:r.elementIndex}function C0(t,e){var i,r,n,s,a;if(!1===t.animation||!1===(null===(i=t.morph)||void 0===i?void 0:i.enable))return!1;let o=!1!==(null!==(n=null===(r=t.animationAppear)||void 0===r?void 0:r[e])&&void 0!==n?n:t.animationAppear),l=!1!==(null!==(a=null===(s=t.animationUpdate)||void 0===s?void 0:s[e])&&void 0!==a?a:t.animationUpdate);return!(!o||!l)}function C1(t){return!eO(t.timeSlices)&&eO(t.channel)}function C2(t){var e,i,r,n;let s=t.getSpec();if(!1===s.animation||!eO(t.getRegion().animate))return!1;let a=null!==(e=s.animationThreshold)&&void 0!==e?e:Number.MAX_SAFE_INTEGER;return null===(i=t.getMarks())||void 0===i||i.forEach(t=>{let e=t.getProgressiveConfig();e&&(e.large&&e.largeThreshold&&(a=Math.min(a,e.largeThreshold)),e.progressiveThreshold&&(a=Math.min(a,e.progressiveThreshold)))}),!((null===(n=null===(r=t.getRawData())||void 0===r?void 0:r.latestData)||void 0===n?void 0:n.length)>=a)}class C3 extends bK{constructor(){super(...arguments),this.markLabelSpec={}}getLabelSpec(t){return this.markLabelSpec[t]}setLabelSpec(t,e){this.markLabelSpec[t]=om(e)}addLabelSpec(t,e,i=!1){this.markLabelSpec[t]||(this.markLabelSpec[t]=[]),i?this.markLabelSpec[t].unshift(e):this.markLabelSpec[t].push(e)}getTheme(t,e){var i,r,n;let s=hg(t),a=null===(i=this._option)||void 0===i?void 0:i.getTheme(),{markByName:o,mark:l}=a,h=this._option.type,u=uh(dq(a,`series.${h}`),h,l,o),d=dq(a,`series.${h}_${s}`),c=(null!==(n=null!==(r=this.stack)&&void 0!==r?r:null==d?void 0:d.stack)&&void 0!==n?n:null==u?void 0:u.stack)?dq(a,`series.${h}_stack`):void 0;return us({},u,d,c)}transformSpec(t,e,i){this._transformStack(t);let r=super.transformSpec(t,e,i);return this._transformLabelSpec(r.spec),Object.assign(Object.assign({},r),{markLabelSpec:this.markLabelSpec,stack:this.stack})}_transformLabelSpec(t){}_transformStack(t){ew(t.stack)&&(this.stack=t.stack),ew(t.percent)&&(this.stack=t.percent||this.stack),ej(this.stack)&&this._supportStack&&t.seriesField&&(this.stack=!0)}_addMarkLabelSpec(t,e,i="label",r="initLabelMarkStyle",n,s){t&&om(t[i]).forEach(i=>{i&&i.visible&&this.addLabelSpec(e,Object.assign(Object.assign({animation:null!=n?n:t.animation},i),{getStyleHandler:t=>{var e;return null===(e=t[r])||void 0===e?void 0:e.bind(t)}}),s)})}_getDefaultSpecFromChart(t){var e;let i=null!==(e=super._getDefaultSpecFromChart(t))&&void 0!==e?e:{},{outerRadius:r,innerRadius:n,direction:s}=t;return eO(r)&&(i.outerRadius=r),eO(n)&&(i.innerRadius=n),eO(s)&&(i.direction=s),Object.keys(i).length>0?i:void 0}_mergeThemeToSpec(t,e){let i=this._theme;if(this._shouldMergeThemeToSpec()){let r=this._getDefaultSpecFromChart(e),n=t=>{let e=us({},i,r,t),n=i.label;return n&&nb(n)&&eM(e.label)&&(e.label=e.label.map(t=>us({},n,t))),e};return eM(t)?{spec:t.map(t=>n(t)),theme:i}:{spec:n(t),theme:i}}return{spec:t,theme:i}}}class C5 extends bq{getRegion(){return this._region}getLayoutStartPoint(){return this._region.getLayoutStartPoint()}getRootMark(){return this._rootMark}getSeriesMark(){return this._seriesMark}getRawData(){return this._rawData}getViewDataFilter(){return this._viewDataFilter}getViewData(){var t;return null===(t=this._data)||void 0===t?void 0:t.getDataView()}getViewDataProductId(){var t;return null===(t=this._data)||void 0===t?void 0:t.getProductId()}getViewDataStatistics(){return this._viewDataStatistics}getViewStackData(){return this._viewStackData}getSeriesField(){return this._seriesField}setSeriesField(t){eO(t)&&(this._seriesField=t,this.getMarks().filter(t=>t.getDataView()===this.getViewData()).forEach(t=>{t.setFacet(this._seriesField)}))}getGroups(){return this._groups}getStack(){var t;return null===(t=this.getSpecInfo())||void 0===t?void 0:t.stack}getStackValue(){var t;return null!==(t=this._spec.stackValue)&&void 0!==t?t:`${hA}_series_${this.type}`}getPercent(){return this._spec.percent}getStackOffsetSilhouette(){return this._spec.stackOffsetSilhouette}get tooltipHelper(){return this._tooltipHelper||this.initTooltip(),this._tooltipHelper}getInvalidType(){return this._invalidType}setInvalidType(t){var e;this._invalidType=t,null===(e=this.getViewData())||void 0===e||e.reRunAllTransform()}getMarkAttributeContext(){return this._markAttributeContext}constructor(t,e){var i;super(t,e),this.specKey="series",this.type="series",this.layoutType="absolute",this.modelType="series",this.name=void 0,this.transformerConstructor=C3,this.coordinate="none",this._region=null,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:null,height:null},this.getLayoutRect=()=>{var t,e;return{width:null!==(t=this._layoutRect.width)&&void 0!==t?t:this._region.getLayoutRect().width,height:null!==(e=this._layoutRect.height)&&void 0!==e?e:this._region.getLayoutRect().height}},this._rootMark=null,this._seriesMark=null,this._viewDataMap=new Map,this._viewDataFilter=null,this._data=null,this.layoutZIndex=0,this._invalidType="break",this._region=e.region,this._dataSet=e.dataSet,(null===(i=this._spec)||void 0===i?void 0:i.name)&&(this.name=this._spec.name)}created(){super.created(),this._buildMarkAttributeContext(),this.initData(),this.initGroups(),this.initStatisticalData(),this.event.emit(c1.afterInitData,{model:this}),this.initRootMark(),this.initMark();let t=C2(this);this._initExtensionMark({hasAnimation:t}),this.initMarkStyle(),this.initMarkState(),t&&this.initAnimation(),this._option.disableTriggerEvent||this.initInteraction(),this.afterInitMark(),this.initEvent(),this.event.emit(c1.afterInitEvent,{model:this})}_buildMarkAttributeContext(){this._markAttributeContext={vchart:this._option.globalInstance,globalScale:(t,e)=>{var i;return null===(i=this._option.globalScale.getScale(t))||void 0===i?void 0:i.scale(e)},seriesColor:t=>{var e;return ej(t)&&(t=this.getSeriesKeys()[0]),null===(e=this._option.globalScale.getScale("color"))||void 0===e?void 0:e.scale(t)},getRegion:()=>this._region}}setAttrFromSpec(){super.setAttrFromSpec(),this.setSeriesField(this._spec.seriesField),eO(this._spec.invalidType)&&(this._invalidType=this._spec.invalidType)}getInvalidCheckFields(){return[this.getStackValueField()]}initInvalidDataTransform(){var t,e;"zero"===this._invalidType&&(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(gw(this._rawData.dataSet,"invalidTravel",Cz),null===(e=this._rawData)||void 0===e||e.transform({type:"invalidTravel",options:{config:()=>({invalidType:this._invalidType,checkField:this.getInvalidCheckFields()})}},!1))}initData(){var t,e,i,r;let n=null!==(t=this._spec.data)&&void 0!==t?t:this._option.getSeriesData(this._spec.dataId,this._spec.dataIndex);if(n&&(this._rawData=gB(n,this._dataSet,this._option.sourceDataList,{onError:null===(e=this._option)||void 0===e?void 0:e.onError})),null===(r=null===(i=this._rawData)||void 0===i?void 0:i.target)||void 0===r||r.addListener("change",this.rawDataUpdate.bind(this)),this._addDataIndexAndKey(),this._rawData){this.getStack()&&(this._viewDataFilter=gR(this._rawData,this._dataSet,{name:`${this.type}_${this.id}_viewDataFilter`}));let t=gR(this.getStack()?this._viewDataFilter:this._rawData,this._dataSet,{name:`${this.type}_${this.id}_viewData`});this._data=new CH(this._option,t),this.getStack()&&this._viewDataFilter.target.removeListener("change",t.reRunAllTransform)}this.initInvalidDataTransform()}initGroups(){let t=this.getGroupFields();t&&t.length&&(this._groups={fields:t})}initStatisticalData(){this._data&&this._statisticViewData()}getRawDataStatisticsByField(t,e){var i,r,n;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]||e&&(ej(this._rawStatisticsCache[t].min)||ej(this._rawStatisticsCache[t].max))||!e&&ej(this._rawStatisticsCache[t].values)){if(this._viewDataStatistics&&(!this._viewDataFilter||this._viewDataFilter.transformsArr.length<=1)&&this.getViewData().transformsArr.length<=1&&(null===(i=this._viewDataStatistics.latestData)||void 0===i?void 0:i[t]))this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t];else if(this._rawData){let i=null===(r=this._rawData.getFields())||void 0===r?void 0:r[t];if(i&&i.lockStatisticsByDomain&&i.domain)this._rawStatisticsCache[t]={},e?(this._rawStatisticsCache[t].min=o_(i.domain),this._rawStatisticsCache[t].max=oy(i.domain)):this._rawStatisticsCache[t].values=i.domain;else{let i=CN(this._rawData.latestData,[{key:t,operations:e?["min","max"]:["values"]}])[t];this._rawStatisticsCache[t]=eF(null!==(n=this._rawStatisticsCache[t])&&void 0!==n?n:{},i)}}}return this._rawStatisticsCache[t]}_statisticViewData(){gw(this._dataSet,"dimensionStatistics",Cj);let t=`${this.type}_${this.id}_viewDataStatic`;this._viewDataStatistics=new eH(this._dataSet,{name:t}),this._viewDataStatistics.parse([this._data.getDataView()],{type:"dataview"}),this._viewDataStatistics.transform({type:"dimensionStatistics",options:{fields:()=>{let t=this.getStatisticFields();return this._seriesField&&CC(t,[{key:this._seriesField,operations:["values"]}]),t},target:"latest"}},!1),this._data.getDataView().target.removeListener("change",this._viewDataStatistics.reRunAllTransform),this.getStack()&&this.createdStackData()}createStatisticalData(t,e,i){gw(this._dataSet,"dimensionStatistics",Cj);let r=new eH(this._dataSet,{name:t});return r.parse([e],{type:"dataview"}),r.transform({type:"dimensionStatistics",options:{operations:["max","min","values"],fields:()=>{var t;let r=CC(this.getStatisticFields(),null!==(t=null==i?void 0:i(e.name))&&void 0!==t?t:[]);return this._seriesField&&CC(r,[{key:this._seriesField,operations:["values"]}]),r},target:"latest"}},!1),r}createdStackData(){let t=`${this.type}_${this.id}_viewStackData`;this._viewStackData=new eH(this._dataSet,{name:t}),this._viewStackData.parse([this._viewDataFilter],{type:"dataview"}),this._viewStackData.transform({type:"stackSplit",options:{fields:this.getStackGroupFields()}},!1)}_noAnimationDataKey(t,e){return e}generateDefaultDataKey(t){var e;return ej(t)?(t,e,i)=>{if(!1===this._spec.animation){let i=this._noAnimationDataKey(t,e);if(void 0!==i)return i}let{keyMap:r}=i,n=this._getSeriesDataKey(t);return void 0===r.get(n)?(r.set(n,0),n):(r.set(n,r.get(n)+1),`${n}_${r.get(n)}`)}:eE(t)?e=>e[t]:eM(t)&&t.every(t=>eE(t))?e=>t.map(t=>e[t]).join("-"):nx(t)?(e,i)=>t(e,i):(null===(e=this._option)||void 0===e||e.onError(`invalid dataKey: ${t}`),(t,e)=>{})}_addDataIndexAndKey(){var t;(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(gw(this._rawData.dataSet,"addVChartProperty",CO),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:CU.bind(this),call:C$}},!1))}updateRawData(t){this._rawData&&this._rawData.updateRawData(t)}rawDataUpdate(t){var e;null===(e=this._rawDataStatistics)||void 0===e||e.reRunAllTransform(),this._rawStatisticsCache=null,this.event.emit(c1.rawDataUpdate,{model:this})}viewDataFilterOver(t){this.event.emit(c1.viewDataFilterOver,{model:this})}viewDataUpdate(t){var e;this.event.emit(c1.viewDataUpdate,{model:this}),null===(e=this._data)||void 0===e||e.updateData(),this._viewDataStatistics&&this._viewDataStatistics.reRunAllTransform()}viewDataStatisticsUpdate(t){this.event.emit(c1.viewDataStatisticsUpdate,{model:this})}getDatumPositionValue(t,e){return!t||ej(e)?null:t[e]}getDatumPositionValues(t,e){return!t||ej(e)?[]:eE(e)?[t[e]]:e.map(e=>t[e])}setValueFieldToStack(){}setValueFieldToPercent(){}setValueFieldToStackOffsetSilhouette(){}initRootMark(){var t,e;this._rootMark=this._createMark({type:"group",name:`seriesGroup_${this.type}_${this.id}`},{parent:null===(e=(t=this._region).getGroupMark)||void 0===e?void 0:e.call(t),dataView:!1}),this._rootMark.setZIndex(this.layoutZIndex)}_getExtensionMarkNamePrefix(){return`${this.type}_${this.id}_extensionMark`}_initExtensionMark(t){var e;if(!this._spec.extensionMark)return;let i=this.getMarksWithoutRoot();t.depend=i,null===(e=this._spec.extensionMark)||void 0===e||e.forEach((e,i)=>{this._createExtensionMark(e,null,this._getExtensionMarkNamePrefix(),i,t)})}_createExtensionMark(t,e,i,r,n){var s;let a=this._createMark({type:t.type,name:`${i}_${r}`},{skipBeforeLayouted:!0,markSpec:t,parent:e,dataView:!1,customShape:null==t?void 0:t.customShape,componentType:t.componentType,depend:n.depend,key:t.dataKey});if(a){if(n.hasAnimation){let e=CX({},Cq(t.type,t,this._markAttributeContext));a.setAnimationConfig(e)}if("group"===t.type)i=`${i}_${r}`,null===(s=t.children)||void 0===s||s.forEach((t,e)=>{this._createExtensionMark(t,a,i,e,n)});else if(!(e||ej(t.dataId)&&ej(t.dataIndex))){let e=this._option.getSeriesData(t.dataId,t.dataIndex);e===this._rawData?a.setDataView(this.getViewData(),this.getViewDataProductId()):(a.setDataView(e),e.target.addListener("change",()=>{a.getData().updateData()}))}}}_updateExtensionMarkSpec(){var t;null===(t=this._spec.extensionMark)||void 0===t||t.forEach((t,e)=>{let i=this._marks.getMarkWithInfo({name:`${this._getExtensionMarkNamePrefix()}_${e}`});i&&(this.initMarkStyleWithSpec(i,t),i.updateStaticEncode(),i.updateLayoutState())})}getStackData(){var t;return null===(t=this._viewStackData)||void 0===t?void 0:t.latestData}_parseSelectorOfInteraction(t,e){if(!e||!e.length)return[];let i=[];return t.markIds?e.filter(e=>{t.markIds.includes(e.getProductId())&&i.push(`#${e.getProductId()}`)}):t.markNames?e.forEach(e=>{t.markNames.includes(e.name)&&i.push(`#${e.getProductId()}`)}):e.forEach(t=>{i.push(`#${t.getProductId()}`)}),i}_parseDefaultInteractionConfig(t){var e;if(!(null==t?void 0:t.length))return[];let i=(e=this._option.mode)===lb["desktop-browser"]||e===lb["desktop-miniApp"]?{hover:{enable:!0,trigger:"pointermove",triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"pointertap"}}:hh(e)||hu(e)?{hover:{enable:!0,trigger:["pointerdown","pointermove"],triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"tap"}}:null,r=Object.assign({},null==i?void 0:i.hover),n=Object.assign({},null==i?void 0:i.select),s=this._spec.hover;ew(s)?r.enable=s:nb(s)&&(r.enable=!0,r=us(r,s));let a=this._spec.select;ew(a)?n.enable=a:nb(a)&&(n.enable=!0,n=us(n,a));let o=[];if(r.enable){let e=this._parseSelectorOfInteraction(r,t);e.length&&o.push({seriesId:this.id,regionId:this._region.id,selector:e,type:"element-highlight",trigger:r.trigger,triggerOff:r.triggerOff,blurState:tk.STATE_HOVER_REVERSE,highlightState:tk.STATE_HOVER})}if(n.enable){let e=this._parseSelectorOfInteraction(n,t),i="multiple"===n.mode,r=eO(n.triggerOff)?n.triggerOff:i?["empty"]:["empty",n.trigger];e.length&&o.push({type:"element-select",seriesId:this.id,regionId:this._region.id,selector:e,trigger:n.trigger,triggerOff:r,reverseState:tk.STATE_SELECTED_REVERSE,state:tk.STATE_SELECTED,isMultiple:i})}return o}_parseInteractionConfig(t){let e=this.getCompiler();if(!e)return;let{interactions:i}=this._spec,r=this._parseDefaultInteractionConfig(t);r&&r.length&&r.forEach(t=>{e.addInteraction(t)}),i&&i.length&&i.forEach(t=>{let i=this._parseSelectorOfInteraction(t,this.getMarks());i.length&&e.addInteraction(Object.assign(Object.assign({},t),{selector:i,seriesId:this.id,regionId:this._region.id}))})}initInteraction(){let t=this.getMarksWithoutRoot();this._parseInteractionConfig(t)}initAnimation(){}initMarkState(){this.initSeriesStyleState()}initSeriesStyleState(){var t;let e=this._spec.seriesStyle;if(!e||!e.length)return;let i=null!==(t=this._seriesField)&&void 0!==t?t:bM;this.getMarksWithoutRoot().forEach(t=>{let r={},n={},s={};e.forEach(e=>{var i;let a=null===(i=e[t.name])||void 0===i?void 0:i.style;a&&(r[e.name]=!0,s[e.name]=s[e.name]||{},Object.keys(a).forEach(t=>{n[t]=!0,s[e.name][t]=a[t]}))}),t.state.addStateInfo({stateValue:bC,level:-1,filter:t=>Array.isArray(t)?0!==t.length&&!0===r[t[0][i]]:!0===r[t[i]]});let a={};Object.keys(n).forEach(e=>{a[e]=r=>{var n,a;let o;if(Array.isArray(r)){if(0===r.length)return;o=null===(n=s[r[0][i]])||void 0===n?void 0:n[e]}return eO(o=null===(a=s[r[i]])||void 0===a?void 0:a[e])?o:t.getAttribute(e,r)}}),this.setMarkStyle(t,a,bC,tw.User_SeriesStyle)})}afterInitMark(){this.event.emit(c1.afterInitMark,{model:this}),this.setSeriesField(this._spec.seriesField),this.getMarks().forEach(t=>{var e,i;(null===(i=null===(e=t.stateStyle)||void 0===e?void 0:e.normal)||void 0===i?void 0:i.lineWidth)&&t.setAttribute("stroke",this.getColorAttribute(),"normal",tw.Base_Series)})}getMarksWithoutRoot(){return this.getMarks().filter(t=>!t.name.includes("seriesGroup"))}getMarksInType(t){return this._marks.getMarksInType(t)}getMarkInName(t){return this._marks.get(t)}getMarkInId(t){return this.getMarks().find(e=>e.id===t)}initEvent(){var t,e,i;null===(e=null===(t=this._data)||void 0===t?void 0:t.getDataView())||void 0===e||e.target.addListener("change",this.viewDataUpdate.bind(this)),null===(i=this._viewDataStatistics)||void 0===i||i.target.addListener("change",this.viewDataStatisticsUpdate.bind(this))}_releaseEvent(){super._releaseEvent(),this.getCompiler().removeInteraction(this.id)}initTooltip(){this._tooltipHelper=new CB(this)}_compareSpec(t,e,i){var r,n;let s=super._compareSpec(t,e),a=Object.keys(e||{}).sort();return my(a,Object.keys(t||{}).sort())?((i=Object.assign(Object.assign(Object.assign({},hO),hP),i)).invalidType=!0,t.invalidType!==e.invalidType&&(s.reCompile=!0),i.extensionMark=!0,(om(t.extensionMark).length!==om(e.extensionMark).length||(null===(r=e.extensionMark)||void 0===r?void 0:r.some((e,i)=>e.type!==t.extensionMark[i].type||e.id!==t.extensionMark[i].id)))&&(s.reMake=!0),s.reMake||((null===(n=e.extensionMark)||void 0===n?void 0:n.some((e,i)=>e.visible!==t.extensionMark[i].visible))&&(s.reCompile=!0),this._marks.getMarks().some(r=>{var n,s;return i[r.name]=!0,(null===(n=e[r.name])||void 0===n?void 0:n.visible)!==(null===(s=t[r.name])||void 0===s?void 0:s.visible)})&&(s.reCompile=!0),a.some(i=>hP[i]&&!my(t[i],e[i]))&&(s.reCompile=!0),a.some(r=>!i[r]&&!my(t[r],e[r]))&&(s.reMake=!0))):s.reMake=!0,s}_updateSpecData(){!this._rawData||!this._spec.data||this._spec.data instanceof eH||gI(this._rawData,this._spec.data,!0)}reInit(t){super.reInit(t);let e=this.getMarksWithoutRoot();e.forEach(t=>{this._spec[t.name]&&this.initMarkStyleWithSpec(t,this._spec[t.name])}),this.initMarkStyle(),e.forEach(t=>{t.updateStaticEncode(),t.updateLayoutState(!0)}),this._updateExtensionMarkSpec(),this._updateSpecData(),this._tooltipHelper&&this._tooltipHelper.updateTooltipSpec(),C2(this)&&this.initAnimation()}onEvaluateEnd(t){this._data.updateData()}onRender(t){}release(){var t,e,i;super.release(),this._viewDataMap.clear();let r=null===(e=null===(t=this._rawData)||void 0===t?void 0:t.transformsArr)||void 0===e?void 0:e.findIndex(t=>"addVChartProperty"===t.type);r>=0&&this._rawData.transformsArr.splice(r,1),null===(i=this._data)||void 0===i||i.release(),this._dataSet=this._data=this._rawData=this._rawDataStatistics=this._spec=this._region=this._viewDataStatistics=this._viewStackData=null}setLayoutStartPosition(t){l1(t.x)&&(this._layoutStartPoint.x=t.x),l1(t.y)&&(this._layoutStartPoint.y=t.y)}setLayoutRect({width:t,height:e},i){l1(t)&&(this._layoutRect.width=t),l1(e)&&(this._layoutRect.height=e)}getSeriesKeys(){var t,e;return this._seriesField?null!==(e=null===(t=this.getRawDataStatisticsByField(this._seriesField))||void 0===t?void 0:t.values)&&void 0!==e?e:[]:this.name?[this.name]:this.userId?[`${this.userId}`]:[`${this.type}_${this.id}`]}getSeriesStyle(t){return e=>{var i,r;return null!==(r=null===(i=this._seriesMark)||void 0===i?void 0:i.getAttribute(e,t))&&void 0!==r?r:void 0}}_getSeriesInfo(t,e){let i=this.getDefaultShapeType();return e.map(e=>({key:e,originalKey:e,style:this.getSeriesStyle({[t]:e}),shapeType:i}))}getSeriesInfoInField(t){var e,i;return this._getSeriesInfo(t,null!==(i=null===(e=this.getRawDataStatisticsByField(t))||void 0===e?void 0:e.values)&&void 0!==i?i:[])}getSeriesInfoList(){var t;return this._getSeriesInfo(null!==(t=this._seriesField)&&void 0!==t?t:bM,this.getSeriesKeys())}_getDefaultColorScale(){var t,e;let i=this.getDefaultColorDomain(),r=this._getDataScheme();return null===(e=(t=(new x9).domain(i)).range)||void 0===e?void 0:e.call(t,r)}_getDataScheme(){return hv(this.getColorScheme(),this.type)}getDefaultColorDomain(){var t,e;return this._seriesField?null===(e=null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._seriesField])||void 0===e?void 0:e.values:[]}getColorAttribute(){var t,e;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(e=this._seriesField)&&void 0!==e?e:bM}}getDimensionField(){return[]}getMeasureField(){return[]}onMarkPositionUpdate(){this.onMarkTreePositionUpdate(this.getMarksWithoutRoot())}onMarkTreePositionUpdate(t){}_createMark(t,e={}){var i,r,n,s;let{key:a,groupKey:o,skipBeforeLayouted:l,themeSpec:h={},markSpec:u,dataView:d,dataProductId:c,parent:p,isSeriesMark:g,depend:f,progressive:m,support3d:v=this._spec.support3d||!!this._spec.zField,morph:y=!1,clip:_,customShape:b,stateSort:x,noSeparateStyle:S=!1}=e,k=super._createMark(t,{key:null!=a?a:this._getDataIdKey(),support3d:v,seriesId:this.id,attributeContext:this._markAttributeContext,componentType:e.componentType,noSeparateStyle:S});if(eO(k)){this._marks.addMark(k,{name:t.name}),g&&(this._seriesMark=k),ej(p)?null===(i=this._rootMark)||void 0===i||i.addMark(k):!1!==p&&p.addMark(k),ej(d)?(k.setDataView(this.getViewData(),this.getViewDataProductId()),k.setSkipBeforeLayouted(!0)):!1!==d&&k.setDataView(d,c),ew(l)&&k.setSkipBeforeLayouted(l),eO(f)&&k.setDepend(...om(f));let a=this.getSpec()||{};k.setMorph(y),k.setMorphKey((null===(r=a.morph)||void 0===r?void 0:r.morphKey)||`${this.getSpecIndex()}_${this.getMarks().length}`),k.setMorphElementKey(null!==(s=null===(n=a.morph)||void 0===n?void 0:n.morphElementKey)&&void 0!==s?s:e.defaultMorphElementKey),ej(m)||k.setProgressiveConfig(m),ej(o)||k.setGroupKey(o),b&&k.setCustomizedShapeCallback(b),x&&k.setStateSortCallback(x),_&&k.setClip(_),this.initMarkStyleWithSpec(k,us({},h,u||a[k.name]))}return k}_getDataIdKey(){var t;return null!==(t=super._getDataIdKey())&&void 0!==t?t:bw}_getSeriesDataKey(t){let e="";if(!t)return e;let i=this.getDimensionField();e=i.map(e=>t[e]).join("_");let r=this.getSeriesField();return r&&!i.includes(r)&&(e+=`_${t[r]}`),e}addViewDataFilter(t){var e,i;null===(i=null!==(e=this._viewDataFilter)&&void 0!==e?e:this.getViewData())||void 0===i||i.transform(t,!1)}reFilterViewData(){var t,e;null===(e=null!==(t=this._viewDataFilter)&&void 0!==t?t:this.getViewData())||void 0===e||e.reRunAllTransform()}reTransformViewData(){var t,e;null===(e=null===(t=this._data)||void 0===t?void 0:t.getDataView())||void 0===e||e.reRunAllTransform()}fillData(){var t;null===(t=this.getRawData())||void 0===t||t.reRunAllTransform()}compile(){this.compileData()}getDefaultShapeType(){return"circle"}getFieldAlias(t){var e;return t!==bO&&t!==bR&&t!==bE&&t!==bP||(t=this.getStackValueField()),null!==(e=CT(this.getRawData(),t))&&void 0!==e?e:t}getMarkInfoList(){var t;let e=super.getMarkInfoList();return e.length?e:Object.values(null!==(t=ui[this.type])&&void 0!==t?t:{})}_getInvalidConnectType(){return"zero"===this._invalidType?"zero":"link"===this._invalidType?"connect":"none"}_getInvalidDefined(t){let e=this.getInvalidCheckFields();return!e.length||e.every(e=>l8(t[e]))}_getRelatedComponentSpecInfo(t){var e;let i=this.getSpecIndex(),r=null===(e=this._option.getSpecInfo().component[t])||void 0===e?void 0:e.filter(t=>t.seriesIndexes.includes(i));return null!=r?r:[]}_forEachStackGroup(t,e){var i,r;(e=null!=e?e:null===(i=this._viewStackData)||void 0===i?void 0:i.latestData)&&((null===(r=e.values)||void 0===r?void 0:r.length)?t(e):e.nodes&&Object.values(e.nodes).forEach(e=>{this._forEachStackGroup(t,e)}))}isDatumInViewData(t){if(!t)return!1;let e=this.getViewData().latestData;return!!e&&(!!e.includes(t)||e.some(e=>Object.keys(t).every(i=>t[i]===e[i])))}getSeriesFieldValue(t,e){var i;return t[null!==(i=null!=e?e:this.getSeriesField())&&void 0!==i?i:bM]}}C5.mark=hw,C5.transformerConstructor=C3;function C4(t,e,i){let r=t.getScale(0),n="isInverse"in t&&t.isInverse();dr(r.type)?i.sort((t,i)=>(t[e]-i[e])*(n?-1:1)):i.sort((t,i)=>(r.index(t[e])-r.index(i[e]))*(n?-1:1))}function C8(t){return{dataIndex:e=>{var i,r;let n="horizontal"===t.direction?t.fieldY[0]:t.fieldX[0],s=null==e?void 0:e[n],a="horizontal"===t.direction?t.scaleY:t.scaleX;return(null!==(r=null===(i=null==a?void 0:a.domain)||void 0===i?void 0:i.call(a))&&void 0!==r?r:[]).indexOf(s)||0},dataCount:()=>{var e,i,r;let n="horizontal"===t.direction?t.scaleY:t.scaleX;return null!==(r=(null!==(i=null===(e=null==n?void 0:n.domain)||void 0===e?void 0:e.call(n))&&void 0!==i?i:[]).length)&&void 0!==r?r:0}}}class C6 extends C5{constructor(){super(...arguments),this.coordinate="cartesian",this._bandPosition=.5,this._scaleConfig={bandPosition:this._bandPosition},this._direction="vertical",this._sortDataByAxis=!1,this._getPositionXEncoder=()=>{var t;return null===(t=this._positionXEncoder)||void 0===t?void 0:t.bind(this)},this._setPositionXEncoder=t=>{this._positionXEncoder=t.bind(this)},this._getPositionYEncoder=()=>{var t;return null===(t=this._positionYEncoder)||void 0===t?void 0:t.bind(this)},this._setPositionYEncoder=t=>{this._positionYEncoder=t.bind(this)}}_buildScaleConfig(){this._scaleConfig={bandPosition:this._bandPosition}}get fieldX(){return this._fieldX}setFieldX(t){this._fieldX=om(t)}get fieldY(){return this._fieldY}setFieldY(t){this._fieldY=om(t)}get fieldZ(){return this._fieldZ}setFieldZ(t){this._fieldZ=t&&om(t)}get fieldX2(){return this._fieldX2}setFieldX2(t){this._fieldX2=t}get fieldY2(){return this._fieldY2}setFieldY2(t){this._fieldY2=t}get direction(){return this._direction}get scaleX(){return this._scaleX}setScaleX(t){this._scaleX=t}get scaleY(){return this._scaleY}setScaleY(t){this._scaleY=t}get scaleZ(){return this._scaleZ}setScaleZ(t){this._scaleZ=t}getXAxisHelper(){return this._xAxisHelper}setXAxisHelper(t){this._xAxisHelper=t,this.onXAxisHelperUpdate()}getYAxisHelper(){return this._yAxisHelper}setYAxisHelper(t){this._yAxisHelper=t,this.onYAxisHelperUpdate()}getZAxisHelper(){return this._zAxisHelper}setZAxisHelper(t){this._zAxisHelper=t,this.onYAxisHelperUpdate()}get sortDataByAxis(){return this._sortDataByAxis}getStatisticFields(){let t=[];return[{axisHelper:this.getXAxisHelper(),fields:this._fieldX2?[...this._fieldX,this._fieldX2]:this._fieldX},{axisHelper:this.getYAxisHelper(),fields:this._fieldY2?[...this._fieldY,this._fieldY2]:this._fieldY},{axisHelper:this.getZAxisHelper(),fields:this._fieldZ}].forEach(e=>{e.axisHelper&&e.axisHelper.getScale&&e.fields&&e.fields.forEach(i=>{let r={key:i,operations:[]},n=e.axisHelper.getScale(0);dr(n.type)?(r.operations=["max","min"],"log"===n.type&&(r.filter=t=>t>0)):r.operations=["values"],t.push(r)})}),this.getStack()&&t.push({key:this.getStackValueField(),operations:["allValid"]}),t}getGroupFields(){return"vertical"===this.direction?this._fieldX:this._fieldY}getStackGroupFields(){return this.getGroupFields()}getStackValue(){var t,e;let i=null===(t="horizontal"===this.direction?this.getXAxisHelper():this.getYAxisHelper())||void 0===t?void 0:t.getAxisId();return null!==(e=this._spec.stackValue)&&void 0!==e?e:`${hA}_series_${this.type}_${i}`}getStackValueField(){return"horizontal"===this.direction?om(this._spec.xField)[0]:om(this._spec.yField)[0]}setValueFieldToStack(){"horizontal"===this.direction?(this.setFieldX(bO),this.setFieldX2(bE)):(this.setFieldY(bO),this.setFieldY2(bE))}setValueFieldToPercent(){"horizontal"===this.direction?(this.setFieldX(bR),this.setFieldX2(bP)):(this.setFieldY(bR),this.setFieldY2(bP))}setValueFieldToStackOffsetSilhouette(){"horizontal"===this.direction?(this.setFieldX(bI),this.setFieldX2(bB)):(this.setFieldY(bI),this.setFieldY2(bB))}onXAxisHelperUpdate(){this.onMarkPositionUpdate()}onYAxisHelperUpdate(){this.onMarkPositionUpdate()}onZAxisHelperUpdate(){this.onMarkPositionUpdate()}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.setFieldX(this._spec.xField),this.setFieldY(this._spec.yField),this.setFieldZ(this._spec.zField),this._specXField=om(this._spec.xField),this._specYField=om(this._spec.yField),eO(this._spec.direction)&&(this._direction=this._spec.direction),this.setFieldX2(null===(t=this._spec)||void 0===t?void 0:t.x2Field),this.setFieldY2(null===(e=this._spec)||void 0===e?void 0:e.y2Field),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent(),this.getStackOffsetSilhouette()&&this.setValueFieldToStackOffsetSilhouette(),eO(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)}dataToPosition(t,e){return t?e&&!this.isDatumInViewData(t)?null:{x:this.dataToPositionX(t),y:this.dataToPositionY(t)}:null}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToX=this.valueToPositionX.bind(this),this._markAttributeContext.valueToY=this.valueToPositionY.bind(this),this._markAttributeContext.xBandwidth=(t=0)=>{var e,i,r;return null!==(r=null===(i=(e=this.getXAxisHelper()).getBandwidth)||void 0===i?void 0:i.call(e,t))&&void 0!==r?r:0},this._markAttributeContext.yBandwidth=(t=0)=>{var e,i,r;return null!==(r=null===(i=(e=this.getYAxisHelper()).getBandwidth)||void 0===i?void 0:i.call(e,t))&&void 0!==r?r:0},this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this)}valueToPosition(t,e){return{x:this.valueToPositionX(t),y:this.valueToPositionY(e)}}_axisPosition(t,e,i){return this._scaleConfig.datum=i,t.isContinuous?t.valueToPosition(e,this._scaleConfig):t.dataToPosition(om(e),this._scaleConfig)}valueToPositionX(t,e){return this._axisPosition(this._xAxisHelper,t,e)}valueToPositionY(t,e){return this._axisPosition(this._yAxisHelper,t,e)}_dataToPosition(t,e,i,r,n,s){let a=n();if(a)return a(t);if(!e)return s(t=>Number.NaN),Number.NaN;let o=(e.getFields?e.getFields():i).slice(0,r);return o&&0!==o.length?(e.isContinuous?s(t=>(this._scaleConfig.datum=t,e.valueToPosition(this.getDatumPositionValue(t,o[0]),this._scaleConfig))):s(t=>(this._scaleConfig.datum=t,e.dataToPosition(om(this.getDatumPositionValues(t,o)),this._scaleConfig))),n()(t)):(s(t=>null),null)}dataToPositionX(t){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,void 0,this._getPositionXEncoder,this._setPositionXEncoder)}dataToPositionY(t){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,void 0,this._getPositionYEncoder,this._setPositionYEncoder)}dataToPositionZ(t){if(!this._zAxisHelper)return Number.NaN;let{dataToPosition:e}=this._zAxisHelper;return e(this.getDatumPositionValues(t,this._fieldZ),{bandPosition:this._bandPosition})}dataToPositionX1(t){return this._xAxisHelper?this._fieldX2&&this._fieldX2 in t?this.valueToPositionX(this.getDatumPositionValues(t,this._fieldX2)):this.valueToPositionX(0):Number.NaN}dataToPositionY1(t){return this._yAxisHelper?this._fieldY2&&this._fieldY2 in t?this.valueToPositionY(this.getDatumPositionValues(t,this._fieldY2)):this.valueToPositionY(0):Number.NaN}positionToData(t){return t?{x:this.positionToDataX(t.x),y:this.positionToDataY(t.y)}:null}positionToDataX(t){return this._scaleX?this._scaleX.invert(t):null}positionToDataY(t){return this._scaleY?this._scaleY.invert(t):null}getRegionRectLeft(){if(!this._xAxisHelper)return Number.NaN;let{getScale:t}=this._xAxisHelper;return t(0).range()[0]}getRegionRectRight(){if(!this._xAxisHelper)return Number.NaN;let{getScale:t}=this._xAxisHelper;return t(0).range()[1]}afterInitMark(){super.afterInitMark(),this.setFieldX(this._fieldX),this.setFieldY(this._fieldY),this._buildScaleConfig()}getDimensionField(){return"horizontal"===this._direction?this._specYField:this._specXField}getDimensionContinuousField(){return"horizontal"===this._direction?[this.fieldY[0],this.fieldY2]:[this.fieldX[0],this.fieldX2]}getMeasureField(){return"horizontal"===this._direction?this._specXField:this._specYField}initEvent(){super.initEvent(),this.sortDataByAxis&&this.event.on(c1.scaleDomainUpdate,{filter:t=>{var e;return t.model.id===(null===(e="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper)||void 0===e?void 0:e.getAxisId())}},()=>{this._sortDataInAxisDomain()})}_sortDataInAxisDomain(){var t,e,i;(null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.latestData)||void 0===e?void 0:e.length)&&(C4("horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,"horizontal"===this._direction?this._fieldY[0]:this._fieldX[0],this.getViewData().latestData),null===(i=this._data)||void 0===i||i.updateData(!0))}getInvalidCheckFields(){let t=[];return this._xAxisHelper&&this._xAxisHelper.isContinuous&&this._xAxisHelper.getAxisType()!==lx.geoCoordinate&&(this._xAxisHelper.getFields?this._xAxisHelper.getFields():this._specXField).forEach(e=>{t.push(e)}),this._yAxisHelper&&this._yAxisHelper.isContinuous&&this._yAxisHelper.getAxisType()!==lx.geoCoordinate&&(this._yAxisHelper.getFields?this._yAxisHelper.getFields():this._specYField).forEach(e=>{t.push(e)}),t}reInit(t){this._positionXEncoder&&(this._positionXEncoder=null),this._positionYEncoder&&(this._positionYEncoder=null),super.reInit(t)}}let C9="monotone",C7="linear";class Tt{addSamplingCompile(){if(this._spec.sampling){let{width:t,height:e}=this._region.getLayoutRect(),i=[],r=this._fieldY,n=this._fieldX;i.push({type:"sampling",size:"horizontal"===this._direction?e:t,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?n[0]:r[0],groupBy:this._seriesField,mode:this._spec.sampling}),this._data.getProduct().transform(i)}}addOverlapCompile(){var t;if(this._spec.markOverlap){let e=[];e.push({type:"markoverlap",direction:"horizontal"===this._direction&&"cartesian"===this.coordinate?2:1,delta:this._spec.pointDis,deltaMul:this._spec.pointDisMul,groupBy:this._seriesField}),null===(t=this._symbolMark)||void 0===t||t.getProduct().transform(e)}}reCompileSampling(){this._spec.sampling&&this.compile()}initLineMark(t,e){var i,r;return this._lineMark=this._createMark(hI.line,{defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,isSeriesMark:null==e||e,progressive:t,customShape:null===(i=this._spec.line)||void 0===i?void 0:i.customShape,stateSort:null===(r=this._spec.line)||void 0===r?void 0:r.stateSort}),this._lineMark}initLineMarkStyle(t,e){var i,r;let n=this._lineMark;if(n){if(this.setMarkStyle(n,{stroke:this.getColorAttribute()},"normal",tw.Series),"zero"!==this._invalidType&&this.setMarkStyle(n,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",tw.Series),this.event.on(c1.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(n,"defined")}),"polar"===this.coordinate)this.setMarkStyle(n,{lineJoin:"bevel",curveType:C7,closePath:!0},"normal",tw.Series);else{let s=null!=e?e:null===(r=null===(i=this.getSpec().line)||void 0===i?void 0:i.style)||void 0===r?void 0:r.curveType;this.setMarkStyle(n,{curveType:s===C9?"horizontal"===t?"monotoneY":"monotoneX":s},"normal",tw.Built_In)}this.setMarkStyle(n,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",tw.Series)}return n}_getEventElement(t,e=!1){let i=[];return t.dimensionInfo.some(t=>(t.data.some(t=>t.series===this&&(i=t.datum,!0)),!i.length)),i}_dimensionTrigger(t){let e=this._getEventElement(t);switch(t.action){case"enter":this._symbolActiveMark.getDataView().parse(e),this._symbolActiveMark.getData().updateData(!1);break;case"leave":this._symbolActiveMark.getDataView().parse([]),this._symbolActiveMark.getData().updateData(!1)}}initSymbolMark(t,e){let i=this._spec.point||{};if(!1!==i.visible&&(this._symbolMark=this._createMark(hI.point,{morph:C0(this._spec,hI.point.name),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,progressive:t,isSeriesMark:!!e,customShape:i.customShape,stateSort:i.stateSort})),!0===this._spec.activePoint){let t=new eH(this._option.dataSet,{name:`${hA}_series_${this.id}_active_point`});t.parse([]),this._symbolActiveMark=this._createMark({name:`active_point_${this.id}`,type:"symbol"},{morph:!1,groupKey:this._seriesField,isSeriesMark:!1,dataView:t,parent:this._region.getInteractionMark(),customShape:i.customShape,stateSort:i.stateSort}),this._symbolActiveMark.setVisible(!1)}return this._symbolMark}initSymbolMarkStyle(){let t=this._symbolMark;if(!t)return this._initSymbolActiveMarkAlone(),t;if(this._initSymbolMark(t),this._symbolActiveMark&&this._symbolMark.stateStyle.dimension_hover){for(let e in this._symbolActiveMark.setVisible(!0),this.event.on(cQ.dimensionHover,this._dimensionTrigger.bind(this)),this._symbolMark.stateStyle)for(let i in this._symbolActiveMark.stateStyle[e]={},this._symbolMark.stateStyle[e])this._symbolActiveMark.stateStyle[e][i]={style:null,level:tw.Series,referer:t};this._symbolActiveMark.state.changeStateInfo({stateValue:tk.STATE_DIMENSION_HOVER,filter:()=>!0})}return t}_initSymbolMark(t){t&&(this.setMarkStyle(t,{fill:this.getColorAttribute()},"normal",tw.Series),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},"normal",tw.Series),this.event.on(c1.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(t,"visible")}),this.setMarkStyle(t,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",tw.Series))}_initSymbolActiveMarkAlone(){var t,e;let i=this._symbolActiveMark;i&&(this._initSymbolMark(i),i&&(null===(e=null===(t=this._spec[hI.point.name])||void 0===t?void 0:t.state)||void 0===e?void 0:e.dimension_hover)&&(i.setVisible(!0),this.event.on(cQ.dimensionHover,this._dimensionTrigger.bind(this)),this.initMarkStyleWithSpec(i,us({},this._spec[hI.point.name],{visible:!0})),this._symbolActiveMark.state.changeStateInfo({stateValue:tk.STATE_DIMENSION_HOVER,filter:()=>!0})))}initLabelMarkStyle(t){var e;t&&("symbol"!==(null===(e=t.getTarget())||void 0===e?void 0:e.type)&&t.setRule("line-data"),this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null}),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},"normal",tw.Series),this.event.on(c1.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(t,"visible")}))}initLineLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getSeriesField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null})}encodeDefined(t,e){var i,r,n,s;if(!t)return;let a=this._isFieldAllValid();if("zero"===this._invalidType||a){if(!0===(null===(r=null===(i=t.stateStyle.normal)||void 0===i?void 0:i[e])||void 0===r?void 0:r.style))return;this.setMarkStyle(t,{[e]:!0},"normal",tw.Series)}else{if(!0!==(null===(s=null===(n=t.stateStyle.normal)||void 0===n?void 0:n[e])||void 0===s?void 0:s.style))return;this.setMarkStyle(t,{[e]:this._getInvalidDefined.bind(this)},"normal",tw.Series)}t.getProduct()&&t.compileEncode()}_isFieldAllValid(){let t=this.getViewDataStatistics(),e=this.getStackValueField();return!!(t&&t.latestData&&e)&&t.latestData[e]&&t.latestData[e].allValid}}class Te extends Sd{setStyle(t,e="normal",i=0,r=this.stateStyle){if(ej(t))return;void 0===r[e]&&(r[e]={});let n=this._getIgnoreAttributes(),s=["strokeWidth","lineWidth","lineDash","strokeDash","lineJoin","stroke","strokeOpacity","opacity","fill","fillOpacity","texture","texturePadding","textureSize","textureColor"],a=this.isUserLevel(i),o=!1;Object.keys(t).forEach(l=>{let h=t[l];if(ej(h)||n.includes(l))return;a&&s.includes(l)&&(di[null==h?void 0:h.type]||(null==h?void 0:h.scale)||nx(h))&&(o=!0);let u=this._filterAttribute(l,h,e,i,a,r);this.setAttribute(l,u,e,i,r)}),o&&this.setEnableSegments(o)}}class Ti extends Te{constructor(){super(...arguments),this.type=Ti.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:1})}_getIgnoreAttributes(){var t,e;return(null===(t=this.model)||void 0===t?void 0:t.type)===cZ.radar&&"polar"===(null===(e=this.model)||void 0===e?void 0:e.coordinate)?[]:["fill","fillOpacity"]}}Ti.type="line";let Tr=()=>{de.registerMark(Ti.type,Ti),AH(),Ma()};class Tn extends Sd{_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{size:1,symbolType:"circle",fill:void 0,lineWidth:0})}}class Ts extends Tn{constructor(){super(...arguments),this.type=Ts.type}}Ts.type="symbol";let Ta=()=>{de.registerMark(Ts.type,Ts),A$()};class To extends C3{_transformLabelSpec(t){var e,i,r;!1!==(null===(e=t.point)||void 0===e?void 0:e.visible)&&!1!==(null===(r=null===(i=t.point)||void 0===i?void 0:i.style)||void 0===r?void 0:r.visible)?this._addMarkLabelSpec(t,"point"):this._addMarkLabelSpec(t,"line"),this._addMarkLabelSpec(t,"line","lineLabel","initLineLabelMarkStyle",void 0,!0)}}function Tl(t){return 2===t.length&&l1(t[0])&&l1(t[1])&&t[1]>=t[0]}function Th(t,e){let i=e[1]-e[0],r=e[1]*e[0]<0,n=e[0]<=0?0-e[0]:0,s=e[1]>0?e[1]-0:0;0===i?e[0]<0?(n=1,s=0):e[0]>0&&(n=0,s=1):(n/=i,s/=i);let a=t.getDomainSpec();return{total:i,negative:n,positive:s,includeZero:r,domain:e,extendable_min:!l1(a.min),extendable_max:!l1(a.max)}}function Tu(t,e){let{positive:i,negative:r,extendable_min:n,extendable_max:s,domain:a}=t,{positive:o,negative:l,extendable_min:h,extendable_max:u,domain:d}=e;if(o>0){if(!h)return!1;let t=r/i;s&&(t=r/Math.max(i,o),a[1]=-a[0]/t),d[0]=-d[1]*t}else if(l>0){if(!u)return!1;let t=i/r;n&&(t=i/Math.max(r,r),a[0]=-a[1]/t),d[1]=-d[0]*t}return!0}function Td(t,e){let{extendable_min:i,extendable_max:r,domain:n}=t,{positive:s,negative:a,domain:o}=e;return(0!==s||0!==a)&&!(s>0&&!r)&&!(a>0&&!i)&&(n[0]=o[0],n[1]=o[1],!0)}function Tc(t,e){let{positive:i,negative:r,extendable_max:n,domain:s}=t,{positive:a,negative:o,extendable_min:l,domain:h}=e;if(n&&l){let t=Math.max(r,o)/Math.max(i,a);s[1]=-s[0]/t,h[0]=-h[1]*t}else if(l)h[0]=-h[1]*(r/i);else{if(!n)return!1;s[1]=-s[0]/(o/a)}return!0}function Tp(t,e){let{extendable_min:i,domain:r}=t,{extendable_max:n,domain:s}=e;return!(!i||!n)&&(r[0]=-r[1],s[1]=-s[0],!0)}let Tg=(t,e)=>{var i,r,n,s;let a=t.getScale(),o=e.getScale();if(!a||!o)return;let l=null!==(r=null===(i=t.getDomainAfterSpec)||void 0===i?void 0:i.call(t))&&void 0!==r?r:[0,1],h=null!==(s=null===(n=e.getDomainAfterSpec)||void 0===n?void 0:n.call(e))&&void 0!==s?s:[0,1];if(!(l&&h&&Tl(l)&&Tl(h)))return;let u=Th(t,l),d=Th(e,h),{positive:c,negative:p,extendable_min:g,extendable_max:f,includeZero:m}=u,{positive:v,negative:y,extendable_min:_,extendable_max:b,includeZero:x}=d;if(0===c&&0===p){if(!Td(u,d))return}else if(0===v&&0===y){if(!Td(d,u))return}else if(m||x){if(m&&!x){if(!Tu(u,d))return}else if(x&&!m){if(!Tu(d,u))return}else{if(p===y)return;if(p>y){if(!Tc(u,d))return}else if(!Tc(d,u))return}}else{if(0===p&&0===v){if(!Tp(u,d))return}else if(0===y&&0===c&&!Tp(d,u))return;if(0===p&&0===y){if(0===l[0]&&h[0]>0){if(!_)return;h[0]=0}else{if(!(0===h[0]&&l[0]>0)||!g)return;l[0]=0}}if(0===c&&0===v){if(0===l[1]&&h[1]>0){if(!b)return;h[1]=0}else{if(!(0===h[1]&&l[1]>0)||!f)return;l[1]=0}}}a.domain(l),o.domain(h)};function Tf(t,e){t.forEachChildren(t=>{let i=e(t);t.isContainer&&!i&&Tf(t,e)})}let Tm=t=>!ej(t)&&!1!==t.visible;function Tv(t){return t>=0&&t<Math.PI/2||t>3*Math.PI/2&&t<=2*Math.PI}function Ty(t,e,i){return Math.abs(t-e)<i}function T_(t,e,i){return t?{textAlign:"right",textBaseline:"middle"}:{textAlign:e<Math.PI&&i.toLocaleLowerCase().includes("top")||e>Math.PI&&i.toLocaleLowerCase().includes("bottom")?"left":e<Math.PI&&i.toLocaleLowerCase().includes("bottom")||e>Math.PI&&i.toLocaleLowerCase().includes("top")?"right":"center",textBaseline:e<Math.PI&&i.includes("inside")||e>Math.PI&&!i.includes("inside")?"bottom":"top"}}function Tb(t,e){return[t[0]*e,t[1]*e]}let Tx=(t=0)=>{if(t<0)for(;t<0;)t+=ir;else if(t>0)for(;t>ir;)t-=ir;return t};function TS(t,e,i){return!dm(t,e,0,1e-6)&&!df(t,i,0,1e-6)}function Tk(t,e,i,r){let n=ye(Object.assign({text:i},r)),s=n.width(),a=n.height(),o=Tx(Math.atan2(e[1],e[0]))-Math.PI,l=3*Math.PI/4,h=Math.PI/4,u=Math.PI/2,d=t.x,c=0,p=d-(c=TS(o,-l,-h)?((o+l)/u-.5)*s:TS(o,h,l)?(.5-(o-h)/u)*s:Math.cos(o)>=0?.5*s:-(.5*s)),g=t.y,f=0;return{x:p,y:g-(f=TS(o,-l,-h)?-(.5*a):TS(o,h,l)?.5*a:Math.cos(o)>=0?(.5-(h-o)/u)*a:(.5-Tx(o-l)/u)*a)}}function TA(t){let e={};return Tf(t,t=>{"group"!==t.type&&t.id&&(e[t.id]=t)}),e}function Tw(t,e){return{x:t.x+e[0],y:t.y+e[1]}}function TM(t,e,i,r=!1,n=!1){let s=[e.x-i.x,e.y-i.y];return Tb(s,(r?-1:1)*(n?-1:1)*t/function(t){let[e,i]=t;return Math.sqrt(e*e+i*i)}(s))}let TC=t=>t.map((t,e)=>({index:e,value:t})),TT=(t,e,i=0)=>{let r=new iI(t).expand(i/2),n=new iI(e).expand(i/2);return r.intersects(n)};function TE(t,e,i){return i>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2)}let TO=(t,e,i,r)=>i<t?Math.max(t-e/2,i):i>t?Math.min(t-e/2,i-e):i<r?i:i-e,TP=(t,e,i)=>{var r;let{labelStyle:n,axisOrientType:s,labelFlush:a,labelFormatter:o,startAngle:l=0}=i,h=null!==(r=n.angle)&&void 0!==r?r:0;"vertical"===n.direction&&(h+=ik(90));let u=["bottom","top"].includes(s),d=["left","right"].includes(s),c=1,p=0;u||(d?(c=0,p=1):l&&(c=Math.cos(l),p=-Math.sin(l)));let g=MC(n),f=t.range();return e.map((i,r)=>{var s,l;let m=o?o(i):`${i}`,{width:v,height:y}=g.quickMeasure(m),_=Math.max(v,12),b=Math.max(y,12),x=t.scale(i),S=c*x,k=p*x,A,w,M=S,C=k;a&&u&&0===r?M=TO(S,_,f[0],f[f.length-1]):a&&u&&r===e.length-1?M=TO(S,_,f[f.length-1],f[0]):A=null!==(s=n.textAlign)&&void 0!==s?s:"center","right"===A?M-=_:"center"===A&&(M-=_/2),a&&d&&0===r?C=TO(k,b,f[0],f[f.length-1]):a&&d&&r===e.length-1?C=TO(k,b,f[f.length-1],f[0]):w=null!==(l=n.textBaseline)&&void 0!==l?l:"middle","bottom"===w?C-=b:"middle"===w&&(C-=b/2);let T=(new iI).set(M,C,M+_,C+b);return h&&T.rotate(h,S,k),T})},TR=(t,e,i)=>{var r;let{labelStyle:n,getRadius:s,labelOffset:a,labelFormatter:o,inside:l}=i,h=null==s?void 0:s(),u=null!==(r=n.angle)&&void 0!==r?r:0,d=MC(n);return e.map(e=>{var i,r;let s=o?o(e):`${e}`,{width:c,height:p}=d.quickMeasure(s),g=Math.max(c,12),f=Math.max(p,12),m=t.scale(e),v=0,y=0,_=null!==(i=n.textAlign)&&void 0!==i?i:"center",b=null!==(r=n.textBaseline)&&void 0!==r?r:"middle",{x:x,y:S}=function(t,e,i,r,n,s,a){let o=iM({x:0,y:0},i,t),l=Tw(o,TM(r,o,e,n));return Tk(l,TM(r||1,l,e,n),s,a)}(m,{x:0,y:0},h,a,l,s,n);return v=x+("right"===_?-g:"center"===_?-g/2:0),y=S+("bottom"===b?-f:"middle"===b?-f/2:0),(new iI).set(v,y,v+g,y+f).rotate(u,v+g/2,y+f/2)})},TB=t=>["bottom","top","z"].includes(t),TI=(t,e)=>{var i,r,n,s,a;if(!t)return t;let o=null===(i=null==e?void 0:e.targetAxis)||void 0===i?void 0:i.call(e);if(!o)return t;let l=null===(r=null==e?void 0:e.currentAxis)||void 0===r?void 0:r.call(e);if(!l)return t;let h=null===(n=l.getTickData())||void 0===n?void 0:n.getDataView();if(!h||!h.transformsArr.find(t=>"ticks"===t.type))return t;let u=l.getScale();if(!u)return t;let d=null===(a=null===(s=o.getTickData())||void 0===s?void 0:s.getDataView())||void 0===a?void 0:a.latestData;if(!(null==d?void 0:d.length))return t;let c=o.getScale();if(!c)return t;let p=c.domain(),g=p[1]-p[0];if(0===g)return t;let f=u.domain(),m=f[1]-f[0];return 0===g?t:TC(d.map(t=>m*((t.value-p[0])/g)+f[0]))};class TL{constructor(t){this.id=l4(),this.name=`${t}_${this.id}`}onAdd(t){this.service=t}release(){this.service=null}}class TD extends TL{constructor(){super(TD.type),this.type="AxisSyncPlugin"}_checkEnableSync(t){if(!dr(t.getScale().type))return!1;let e=t.getSpec().sync;return!!(null==e?void 0:e.axisId)&&e}_getTargetAxis(t,e){let i=t.getOption().getChart().getComponentByUserId(e.axisId);return(null==i?void 0:i.type.startsWith("cartesianAxis"))?i:null}onInit(t,e){let i=this._checkEnableSync(e);if(!i||!i.zeroAlign)return;let r=this._getTargetAxis(e,i);r&&e.event.on(c1.scaleDomainUpdate,{filter:({model:t})=>t.id===e.id||t.id===r.id},()=>{Tg(r,e)})}onDidCompile(t,e){let i=this._checkEnableSync(e);if(!i)return;let r=this._getTargetAxis(e,i);if(r&&i.tickAlign){gw(e.getOption().dataSet,"tickAlign",TI);e.addTransformToTickData({type:"tickAlign",options:{targetAxis:()=>r,currentAxis:()=>e},level:Number.MAX_SAFE_INTEGER},!1)}}}function TF(t={}){let e=Object.assign({},t);if(nx(t.style)?e.style=(e,i,r,n)=>Tz(t.style(e,i,r,n)):mk(t.style)||(e.style=Tz(t.style)),!mk(t.state)){let i={};Object.keys(t.state).forEach(e=>{nx(t.state[e])?i[e]=(i,r,n,s)=>Tz(t.state[e](i,r,n,s)):mk(t.state[e])||(i[e]=Tz(t.state[e]))}),e.state=i}return e}function Tj(t){if(mk(t))return null;let e={};return Object.keys(t).forEach(i=>{nx(t[i])?e[i]=(e,r,n,s)=>Tz(t[i](e,r,n,s)):mk(t[i])||(e[i]=Tz(t[i]))}),e}TD.pluginType="component",TD.type="AxisSyncPlugin";function TN(t,e){if(mk(t))return null;let i={};return Object.keys(t).forEach(r=>{nx(t[r])?i[r]=t[r](e):i[r]=t[r]}),Tz(i)}function Tz(t){return(null==t?void 0:t.angle)&&(t.angle=ik(t.angle)),t}function TH(t,e){return dq(e,`component.${t}`)}function TV(t,e,i,r){if(t)return{formatFunc:t,args:[i,r]};let n=de.getFormatter();return e&&n?{formatFunc:n,args:[i,r,e]}:{}}let TW={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}};function TG(t){let e=0;return dq(t,"tick.visible")&&(e+=dq(t,"tick.tickSize")),dq(t,"label.visible")&&(e+=dq(t,"label.space")),e}function TU(t,e){var i,r,n,s,a,o;return{min:null!==(n=null!==(i=t.min)&&void 0!==i?i:null===(r=t.range)||void 0===r?void 0:r.min)&&void 0!==n?n:null==e?void 0:e.min,max:null!==(o=null!==(s=t.max)&&void 0!==s?s:null===(a=t.range)||void 0===a?void 0:a.max)&&void 0!==o?o:null==e?void 0:e.max}}function T$(t){let e=null==t?void 0:t.orient;return"top"===e||"bottom"===e||"left"===e||"right"===e||"z"===e}function TY(t){let e=null==t?void 0:t.orient;return"angle"===e||"radius"===e}let TK=(t,e,i)=>{var r;let n=null!==(r="band"===e?TH("axisBand",i):["linear","log","symlog"].includes(e)?TH("axisLinear",i):{})&&void 0!==r?r:{},s=dR(t)?TH("axisX",i):dB(t)?TH("axisY",i):TH("axisZ",i);return us({},TH("axis",i),n,s)},TZ=(t,e,i)=>{var r;let n=null!==(r="band"===e?TH("axisBand",i):"linear"===e?TH("axisLinear",i):{})&&void 0!==r?r:{},s=TH("angle"===t?"axisAngle":"axisRadius",i);return us({},TH("axis",i),n,s)},TX=t=>"band"===t||"ordinal"===t||"point"===t;function Tq(t,e){return{id:t,label:t,value:e,rawValue:t}}let TJ=(t,e)=>{let i;if(!dr(t.type))return TC(t.domain());let r=t.range(),n=Math.abs(r[r.length-1]-r[0]);if(n<2)return TC([t.domain()[0]]);let{tickCount:s,forceTickCount:a,tickStep:o,noDecimals:l=!1,labelStyle:h}=e;if(eO(o))i=t.stepTicks(o);else if(eO(a))i=t.forceTicks(a);else if("d3"===e.tickMode){let e=nx(s)?s({axisLength:n,labelStyle:h}):s;i=t.d3Ticks(null!=e?e:5,{noDecimals:l})}else{let e=nx(s)?s({axisLength:n,labelStyle:h}):s;i=t.ticks(null!=e?e:5,{noDecimals:l})}if(e.sampling&&("cartesian"===e.coordinateType||"polar"===e.coordinateType&&"radius"===e.axisOrientType)){let{labelGap:r=4,labelFlush:n}=e,s=TP(t,i,e).map((t,e)=>({AABBBounds:t,value:i[e]}));for(;s.length>=3&&function(t,e){for(let i,r=1,n=t.length,s=t[0];r<n;s=i,++r)if(i=t[r],TE(s.AABBBounds,i.AABBBounds,e))return!0;return!1}(s,r);)s=TQ.parity(s);let a=s.map(t=>t.value);a.length<3&&n&&(a.length>1&&a.pop(),ov(a)!==ov(i)&&a.push(ov(i))),i=a}return TC(i)},TQ={parity:function(t){return t.filter((t,e)=>e%2==0)}},T0=(t,e,i,r)=>TP(t,e,i).map(t=>r?[t.x1,t.x2,t.width()]:[t.y1,t.y2,t.height()]),T1=(t,e,i=0)=>Math.max(t[0],e[0])-i/2<=Math.min(t[1],e[1])+i/2,T2=(t,e)=>t[1]<e[0]?e[0]-t[1]:e[1]<t[0]?t[0]-e[1]:0,T3=(t,e)=>{var i;let r;let n=t.domain();if(!n.length)return[];let{tickCount:s,forceTickCount:a,tickStep:o,labelGap:l=4,axisOrientType:h,labelStyle:u}=e,d=TB(h),c=t.range(),p=t.calculateWholeRangeSize();if(p<2)return e.labelLastVisible?TC([n[n.length-1]]):TC([n[0]]);if(eO(o))r=t.stepTicks(o);else if(eO(a))r=t.forceTicks(a);else if(eO(s)){let e=nx(s)?s({axisLength:p,labelStyle:u}):s;r=t.ticks(e)}else if(e.sampling){let s=(null!==(i=e.labelStyle.fontSize)&&void 0!==i?i:12)+2,a=o_(c),o=oy(c);if(n.length<=p/s){let i=(o-a)/n.length,s=T0(t,n,e,d),h=Math.min(...s.map(t=>t[2])),u=T5(n,s,l,e.labelLastVisible,Math.floor(h/i),!1);r=t.stepTicks(u.step),e.labelLastVisible&&(u.delCount&&(r=r.slice(0,r.length-u.delCount)),r.push(n[n.length-1]))}else{let i=T0(t,[n[0],n[Math.floor(n.length/2)],n[n.length-1]],e,d),s=null;i.forEach(t=>{s?s[2]<t[2]&&(s=t):s=t});let h=o-a-l>0?Math.ceil(n.length*(l+s[2])/(o-a-l)):n.length-1;r=t.stepTicks(h),!e.labelLastVisible||r.length&&r[r.length-1]===n[n.length-1]||(r.length&&Math.abs(t.scale(r[r.length-1])-t.scale(n[n.length-1]))<s[2]&&(r=r.slice(0,-1)),r.push(n[n.length-1]))}}else r=t.domain();return TC(r)},T5=(t,e,i,r,n,s)=>{let a=0,o=0,l=-1,h=Number.MAX_VALUE,u=r=>{let n=!0,s=0;do s+r<t.length&&T1(e[s],e[s+r],i)&&(n=!1),s+=r;while(n&&s<t.length);return n},d=xn(n,t.length,t=>u(t)?1:-1),c=d;do if(!(c>d)||s||u(c)){if(!r){o=c;break}{let r=t.length-1,n,s=0;n=t.length%c>0?t.length-t.length%c+c:t.length;do{if((n-=c)!==r&&!T1(e[n],e[r],i))break;s++}while(n>0);if(n===r){o=c,a=s;break}{let i=Math.floor(t.length/c)-s+1;if(i<l)break;{l=i;let t=T2(e[n],e[r]),u=n-c>=0?T2(e[n-c],e[n]):t,d=Math.abs(t-u);if(d<h&&(h=d,o=c,a=s),t<=u)break}}}c++}else c++;while(c<=t.length);return{step:o,delCount:a}},T4=(t,e)=>{let i;let{tickCount:r,forceTickCount:n,tickStep:s,getRadius:a,labelOffset:o,labelGap:l=0,labelStyle:h}=e,u=null==a?void 0:a();if(!u)return TC(t.domain());if(eO(s))i=t.stepTicks(s);else if(eO(n))i=t.forceTicks(n);else if(eO(r)){let e=t.range(),n=Math.abs(e[e.length-1]-e[0]),s=nx(r)?r({axisLength:n,labelStyle:h}):r;i=t.ticks(s)}else if(e.sampling){let r=t.domain(),n=t.range(),s=TR(t,r,e),a=o_(n),h=Math.abs(oy(n)-a)*(u+o)/r.length,{step:d,delCount:c}=T8(r,s,l,Math.floor(s.reduce((t,e)=>Math.min(t,e.width(),e.height()),Number.MAX_VALUE)/h));i=(i=t.stepTicks(d)).slice(0,i.length-c)}else i=t.domain();return TC(i)},T8=(t,e,i,r)=>{let n=r;do{let r=!0;n++;let s=0;do s+n<t.length&&TT(e[s],e[s+n],i)&&(r=!1),s+=n;while(r&&s<t.length);if(r)break}while(n<=t.length);let s=0;if(t.length>2){let i=t.length-t.length%n;for(i>=t.length&&(i-=n);i>0&&TT(e[0],e[i]);)s++,i-=n}return{step:n,delCount:s}},T6=(t,e)=>{if(dr(t.type))return TJ(t,e);if(ds(t.type)){if("cartesian"===e.coordinateType)return T3(t,e);if("polar"===e.coordinateType&&"angle"===e.axisOrientType)return T4(t,e)}return TC(t.domain())};class T9 extends Cl{constructor(t){super(),this.component=t}releaseAll(){super.releaseAll(),this.component=null}}function T7(t,e){let{x1:i,y1:r,x2:n,y2:s}=e,{x1:a,y1:o,x2:l,y2:h}=t.AABBBounds,{dx:u=0,dy:d=0}=t.attribute,c=0,p=0;a<i&&(c=i-a),o<r&&(p=r-o),l>n&&(c=n-l),h>s&&(p=s-h),c&&t.setAttribute("dx",c+u),p&&t.setAttribute("dy",p+d)}function Et(t,e,i,r){for(let n=0,s=t.length;n<s;n++){let s=t[n];if(s){let t=s[i],n=s[r||i];if(t<=e&&n>=e)return s}}return null}let Ee=(t,e)=>{var i,r;let n;let s=om(null!==(i=e.axes)&&void 0!==i?i:[]),{bandField:a,linearField:o,xField:l,yField:h}=null!==(r=TH(lx.crosshair,t))&&void 0!==r?r:{},u=s.find(t=>dR(t.orient));n=eO(u)?us({},TX(u.type)?a:o,l):l;let d=s.find(t=>dB(t.orient));return{xField:n,yField:eO(d)?us({},ds(d.type)?a:o,h):h}},Ei=(t,e)=>{var i,r;let n;let s=om(null!==(i=e.axes)&&void 0!==i?i:[]),{bandField:a,linearField:o,categoryField:l,valueField:h}=null!==(r=TH(lx.crosshair,t))&&void 0!==r?r:{},u=s.find(t=>"angle"===t.orient);n=eO(u)?us({},TX(u.type)?a:o,l):l;let d=s.find(t=>"radius"===t.orient);return{categoryField:n,valueField:eO(d)?us({},ds(d.type)?a:o,h):h}},Er=(t,e)=>{var i;let r=null!==(i=t.orient)&&void 0!==i?i:e.orient,n=e[dD(r)],s=us({},e,n);return delete s.horizontal,delete s.vertical,s};class En extends bK{getTheme(t,e){return function(t,e,i,r){switch(t){case lx.cartesianBandAxis:return TK(dL(i,["z"]),"band",e);case lx.cartesianLinearAxis:return TK(dL(i,["z"]),"linear",e);case lx.cartesianLogAxis:return TK(dL(i,["z"]),"log",e);case lx.cartesianSymlogAxis:return TK(dL(i,["z"]),"symlog",e);case lx.cartesianAxis:case lx.cartesianTimeAxis:return TK(dL(i),void 0,e);case lx.polarBandAxis:return TZ(i.orient,"band",e);case lx.polarLinearAxis:return TZ(i.orient,"linear",e);case lx.polarAxis:return TZ(i.orient,void 0,e);case lx.cartesianCrosshair:return Ee(e,r);case lx.polarCrosshair:return Ei(e,r);case lx.colorLegend:case lx.sizeLegend:case lx.discreteLegend:case lx.dataZoom:case lx.scrollBar:return Er(i,TH(t,e));default:return TH(t,e)}}(this.type,this._option.getTheme(),t,e)}_mergeThemeToSpec(t,e){let{spec:i,theme:r}=super._mergeThemeToSpec(t,e);return this._adjustPadding(i),{spec:i,theme:r}}_adjustPadding(t){let{padding:e,noOuterPadding:i=!0,orient:r}=t;i&&e&&r&&(t.padding=Object.assign(Object.assign({},hi(e)),{[r]:0}))}}var Es=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Ea extends bQ{static createComponent(t,e){let{spec:i}=t,r=Es(t,["spec"]);return new this(i,Object.assign(Object.assign({},e),r))}getRegions(){return this._regions}created(){super.created(),this.initLayout(),this.pluginService=new T9(this)}constructor(t,e){super(t,e),this.name="component",this.modelType="component",this.transformerConstructor=En,this._delegateEvent=(t,e,i,r=null,n=null)=>{var s,a;e instanceof nA||this.event.emit(i,{model:this,node:t,event:e,item:r,datum:n,source:c2.chart,chart:null===(a=null===(s=this._option)||void 0===s?void 0:s.globalInstance)||void 0===a?void 0:a.getChart()},"model")},this._option.animation&&(this.animate=new bY({getCompiler:e.getCompiler}))}initLayout(){var t;super.initLayout(),this._regions=null!==(t=this._regions)&&void 0!==t?t:this._option.getRegionsInIndex(),this._layout&&(this._layout.layoutBindRegionID=this._regions.map(t=>null==t?void 0:t.id))}changeRegions(t){throw Error("Method not implemented.")}_getNeedClearVRenderComponents(){throw Error("Method not implemented.")}onRender(t){throw Error("Method not implemented.")}getVRenderComponents(){return this._getNeedClearVRenderComponents()}callPlugin(t){this.pluginService&&this.pluginService.getAll().forEach(e=>t(e))}getContainer(){var t;return this._container||(this._container=null===(t=this._option)||void 0===t?void 0:t.globalInstance.getStage().find(t=>"root"===t.name,!0)),this._container}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reMake=["seriesId","seriesIndex","regionId","regionIndex"].some(i=>!my(null==e?void 0:e[i],t[i]))),(null==e?void 0:e.visible)!==t.visible&&(i.reCompile=!0),i}release(){var t;super.release(),this.clear(),null===(t=this.pluginService)||void 0===t||t.releaseAll(),this.pluginService=null}clear(){var t;let e=this._getNeedClearVRenderComponents();e&&e.length&&e.forEach(t=>{var e;t&&(null===(e=this.getContainer())||void 0===e||e.removeChild(t),t=null)}),this._container=null,null===(t=this.pluginService)||void 0===t||t.clearAll()}compile(){this.compileMarks(),this.reAppendComponents()}compileMarks(t){this.getMarks().forEach(e=>{var i;e.compile({group:t}),null===(i=e.getProduct())||void 0===i||i.configure({context:{model:this}})})}reAppendComponents(){let t=this._getNeedClearVRenderComponents();t&&t.length&&t.forEach(t=>{var e;t&&!t.stage&&(null===(e=this.getContainer())||void 0===e||e.appendChild(t))})}getBoundsInRect(t,e){return{x1:0,x2:0,y1:0,y2:0}}}function Eo(t,e){if(!t||!eI(t))return t;let i={};return Object.keys(t).forEach(r=>{let n=t[r],s=!1;e.forEach(t=>{(eE(t)&&t===r||t instanceof RegExp&&r.match(t))&&(s=!0)}),s||(i[r]=n)}),i}function El(t){if(l1(t))return[t,t,t,t];if(eM(t)){let e=t.length;if(1===e){let e=t[0];return[e,e,e,e]}if(2===e){let[e,i]=t;return[e,i,e,i]}if(3===e){let[e,i,r]=t;return[e,i,r,i]}if(4===e)return t}if(nb(t)){let{top:e=0,right:i=0,bottom:r=0,left:n=0}=t;return[e,i,r,n]}return[0,0,0,0]}Ea.transformerConstructor=En;let Eh=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"];class Eu extends sW{constructor(t,e){super(t),(null==e?void 0:e.mode)&&(this.mode=e.mode,this.setMode(e.mode)),(null==e?void 0:e.skipDefault)&&(this.skipDefault=!0),this.setTheme({common:{strokeBoundsBuffer:0}}),this.attribute=t,this.onSetStage(()=>{this.render(),this.bindEvents()})}setAttribute(t,e,i){eI(this.attribute[t])&&eI(e)&&!nx(this.attribute[t])&&!nx(e)?eF(this.attribute[t],e):this.attribute[t]=e,Eh.includes(t)||this.render(),this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(i||this.needUpdateTag(t))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}setAttributes(t,e){let i=Object.keys(t);this._mergeAttributes(t,i),i.every(t=>Eh.includes(t))||this.render(),this.valid=this.isValid(),!this.updateShapeAndBoundsTagSetted()&&(e||this.needUpdateTags(i))?this.addUpdateShapeAndBoundsTag():this.addUpdateBoundTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}_mergeAttributes(t,e){ej(e)&&(e=Object.keys(t));for(let i=0;i<e.length;i++){let r=e[i];!eI(this.attribute[r])||nx(this.attribute[r])||nx(t[r])?this.attribute[r]=t[r]:eF(this.attribute[r],t[r])}}bindEvents(){}_getNodeId(t){var e;return`${null!==(e=this.id)&&void 0!==e?e:this._uid}-${this.name}-${t}`}_dispatchEvent(t,e){var i;let r=new nA(t,e);r.manager=null===(i=this.stage)||void 0===i?void 0:i.eventSystem.manager,this.dispatchEvent(r)}}function Ed(){v8(),kP(),AS(),_2()}function Ec(){v8(),kP(),SB(),_2()}Ed();class Ep extends Eu{getStartAngle(){return iT(this._startAngle)}getEndAngle(){return iT(this._endAngle)}getMainSegmentPoints(){return this._mainSegmentPoints}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},Ep.defaultAttributes,t)),this.name="segment",this.key="segment",this.lines=[]}render(){this.removeAllChild(!0),this._reset();let{startSymbol:t,endSymbol:e,lineStyle:i,state:r,visible:n=!0,multiSegment:s,mainSegmentIndex:a}=this.attribute;if(!n)return;this._computeLineAngle();let o=this._getMainSegmentPoints(),l=this._renderSymbol(t,o,"start"),h=this._renderSymbol(e,o,"end");if(this.startSymbol=l,this.endSymbol=h,s){let t=[...this.attribute.points];if(l1(a))t[a]=this._clipPoints(t[a]);else{let e=this._clipPoints(oS(t));t[0][0]=e[0],t[t.length-1][t[t.length-1].length-1]=e[e.length-1]}t.forEach((t,e)=>{var n,s;let a=aj.line(Object.assign(Object.assign({points:t},eM(i)?null!==(n=i[e])&&void 0!==n?n:i[i.length-1]:i),{fill:!1}));a.name=`${this.name}-line`,a.id=this._getNodeId("line"+e),mk(null==r?void 0:r.line)||(a.states=eM(r.line)?null!==(s=r.line[e])&&void 0!==s?s:r.line[r.line.length-1]:r.line),this.add(a),this.lines.push(a)})}else{let t=aj.line;om(i)[0].cornerRadius&&(t=aj.polygon);let e=t(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},om(i)[0]),{fill:!1,closePath:!1}));e.name=`${this.name}-line`,e.id=this._getNodeId("line"),mk(null==r?void 0:r.line)||(e.states=[].concat(r.line)[0]),this.add(e),this.lines.push(e)}}_computeStartRotate(t){return t+Math.PI/2}_computeEndRotate(t){return t+Math.PI/2}_renderSymbol(t,e,i){let r;if(!e.length)return;let{autoRotate:n=!0}=t;if(t&&t.visible){let s,a;let o=this.getStartAngle(),l=this.getEndAngle(),{state:h}=this.attribute,u=e[0],d=e[e.length-1],{refX:c=0,refY:p=0,refAngle:g=0,style:f,symbolType:m,size:v=12}=t;"start"===i?(s={x:u.x+(l1(o)?c*Math.cos(o)+p*Math.cos(o-Math.PI/2):0),y:u.y+(l1(o)?c*Math.sin(o)+p*Math.sin(o-Math.PI/2):0)},a=this._computeStartRotate(this._startAngle)):(s={x:d.x+(l1(l)?c*Math.cos(l)+p*Math.cos(l-Math.PI/2):0),y:d.y+(l1(l)?c*Math.sin(l)+p*Math.sin(l-Math.PI/2):0)},a=this._computeEndRotate(this._endAngle)),(r=aj.symbol(Object.assign(Object.assign(Object.assign({},s),{symbolType:m,size:v,angle:n?a+g:0,strokeBoundsBuffer:0}),f))).name=`${this.name}-${i}-symbol`,r.id=this._getNodeId(`${i}-symbol`),mk(null==h?void 0:h.symbol)||(r.states=h.symbol),"start"===i?mk(null==h?void 0:h.startSymbol)||(r.states=h.startSymbol):mk(null==h?void 0:h.endSymbol)||(r.states=h.endSymbol),this.add(r)}return r}_getMainSegmentPoints(){let t;if(this._mainSegmentPoints)return this._mainSegmentPoints;let{points:e,multiSegment:i,mainSegmentIndex:r}=this.attribute;return t=i?l1(r)?e[r]:oS(e):e,this._mainSegmentPoints=t,t}_clipPoints(t){let{startSymbol:e={},endSymbol:i={}}=this.attribute,r=t;if(e.visible){let i=e.clip?e.size||10:0;r=[{x:t[0].x-i/2*(Math.cos(this._startAngle)||0),y:t[0].y-i/2*(Math.sin(this._startAngle)||0)},...r.slice(1)]}if(i.visible){let e=i.clip?i.size||10:0,n={x:t[t.length-1].x-e/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-e/2*(Math.sin(this._endAngle)||0)};r=[...r.slice(0,r.length-1),n]}return r}_computeLineAngle(){let t=this._getMainSegmentPoints();if(t.length<=1)return;let e=t[0],i=t[1],r=t[t.length-2],n=t[t.length-1],s=[e.x-i.x,e.y-i.y],a=Math.atan2(s[1],s[0]),o=[n.x-r.x,n.y-r.y],l=Math.atan2(o[1],o[0]);this._startAngle=a,this._endAngle=l}_reset(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}Ep.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}},(tL=t8||(t8={})).innerView="inner-view",tL.axisContainer="axis-container",tL.labelContainer="axis-label-container",tL.tickContainer="axis-tick-container",tL.tick="axis-tick",tL.subTick="axis-sub-tick",tL.label="axis-label",tL.title="axis-title",tL.gridContainer="axis-grid-container",tL.grid="axis-grid",tL.gridRegion="axis-grid-region",tL.line="axis-line",tL.background="axis-background",tL.axisLabelBackground="axis-label-background",(tD=t6||(t6={})).selected="selected",tD.selectedReverse="selected_reverse",tD.hover="hover",tD.hoverReverse="hover_reverse";let Eg={[t6.selectedReverse]:{},[t6.selected]:{},[t6.hover]:{},[t6.hoverReverse]:{}},Ef={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}};function Em(){v8(),bp(),_2(),Al(),yG()}var Ev=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};Em();class Ey extends Eu{getBgRect(){return this._bgRect}getTextShape(){return this._textShape}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},Ey.defaultAttributes,t)),this.name="tag"}render(){var t,e,i;let r;let{text:n="",textStyle:s={},shape:a={},panel:o={},space:l=4,minWidth:h,maxWidth:u,padding:d=4,visible:c,state:p,type:g,textAlwaysCenter:f,containerTextAlign:m}=this.attribute,v=El(d),y=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group"),_,b=v[1]+v[3],x=v[0]+v[2],S=0,k=0,{visible:A}=a,w=Ev(a,["visible"]);if(ew(A)){let t=(null==w?void 0:w.size)||10,e=ey(t)?t:Math.max(t[0],t[1]);_=y.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:t,strokeBoundsBuffer:0},w),{visible:A,x:e/2,y:e/2}),"symbol"),mk(null==p?void 0:p.shape)||(_.states=p.shape),A&&(k=e+l)}if(b+=k,S+=k,function(t,e="type"){return"rich"===ME(t,e)}({text:n})||"rich"===g){let t=Object.assign(Object.assign(Object.assign({},MO(Object.assign({type:g,text:n},s))),s),{visible:eO(n)&&!1!==c,x:S,y:0});r=y.createOrUpdateChild("tag-text",t,"richtext");let{visible:e}=o,i=Ev(o,["visible"]);if(c&&ew(e)){let t=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},i),{visible:e&&!!n,x:r.AABBBounds.x1,y:r.AABBBounds.y1,width:r.AABBBounds.width(),height:r.AABBBounds.height()}),"rect");if(mk(null==p?void 0:p.panel)||(t.states=p.panel),i.customShape){let e=i.customShape;t.pathProxy=t=>e(r.attribute,t,new rg)}this._bgRect=t}}else{let l=Object.assign(Object.assign({text:nb(n)&&"type"in n&&"text"===n.type?n.text:n,visible:eO(n)&&!1!==c,lineHeight:null==s?void 0:s.fontSize},s),{x:S,y:0});ej(l.lineHeight)&&(l.lineHeight=s.fontSize),r=y.createOrUpdateChild("tag-text",l,"text"),mk(null==p?void 0:p.text)||(r.states=p.text);let d=MT(l.text,s,null===(e=null===(t=this.stage)||void 0===t?void 0:t.getTheme())||void 0===e?void 0:e.text),g=d.width,A=d.height;b+=g;let w=null!==(i=a.size)&&void 0!==i?i:10,M=ey(w)?w:Math.max(w[0],w[1]);x+=Math.max(A,a.visible?M:0);let{textAlign:C,textBaseline:T}=s;(eO(h)||eO(u))&&(eO(h)&&b<h&&(b=h),eO(u)&&b>u&&(b=u,r.setAttribute("maxLineWidth",u-v[1]-v[2])));let E=0,O=0,P=0;"left"===C||"start"===C?P=1:"right"===C||"end"===C?P=-1:"center"===C&&(P=0),P?P<0?(E-=b,_&&_.setAttribute("x",(_.attribute.x||0)-g),y.setAttribute("x",-v[1]-k)):P>0&&y.setAttribute("x",v[3]):(E-=b/2,_&&_.setAttribute("x",(_.attribute.x||0)-g/2),y.setAttribute("x",-k/2));if((m?"center"===m:f)&&P){let t=b-v[1]-v[3],e=g+k,i=1===P?(t-e)/2+k+g/2:v[0]+k-(b/2+e/2-k)+g/2;if(r.setAttributes({x:i,textAlign:"center"}),_){let t=i-g/2-k+M/2;_.setAttributes({x:t})}}if(("left"===m||"start"===m)&&1!==P){let t=b-v[1]-v[3],e=0===P?-t/2+k/2:-b+v[3]+v[1]+k,i=e+k;r.setAttributes({x:i,textAlign:"left"}),_&&_.setAttributes({x:e+M/2})}if(("right"===m||"end"===m)&&-1!==P){let t=b-v[1]-v[3],e=0===P?t/2+k/2:t;if(r.setAttributes({x:e,textAlign:"right"}),_){let t=e-g-k+M/2;_.setAttributes({x:t})}}"middle"===T?(O-=x/2,_&&_.setAttribute("y",0)):"bottom"===T?(O-=x,_&&_.setAttribute("y",-A/2),y.setAttribute("y",-v[2])):"top"===T&&(y.setAttribute("y",v[0]),_&&_.setAttribute("y",A/2));let{visible:R}=o,B=Ev(o,["visible"]);if(c&&ew(R)){let t=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},B),{visible:R&&!!n,x:E,y:O,width:b,height:x}),"rect");if(mk(null==p?void 0:p.panel)||(t.states=p.panel),B.customShape){let e=B.customShape;t.pathProxy=t=>e(r.attribute,t,new rg)}this._bgRect=t}}this._textShape=r}}Ey.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}};let E_=(t,e,i)=>{let r=t.target;return r!==i&&r.name&&!mk(r.states)?(r.addState(tT.hover,!0),Tf(e,t=>{t!==r&&t.name&&!mk(t.states)&&t.addState(tT.hoverReverse,!0)}),r):i},Eb=(t,e,i)=>i?(Tf(e,t=>{t.name&&!mk(t.states)&&(t.removeState(tT.hoverReverse),t.removeState(tT.hover))}),null):i,Ex=(t,e,i)=>{let r=t.target;return i===r&&r.hasState(tT.selected)?(Tf(e,t=>{t.name&&!mk(t.states)&&(t.removeState(tT.selectedReverse),t.removeState(tT.selected))}),null):r.name&&!mk(r.states)?(r.addState(tT.selected,!0),Tf(e,t=>{t!==r&&t.name&&!mk(t.states)&&t.addState(tT.selectedReverse,!0)}),r):i};class ES extends Eu{constructor(){super(...arguments),this.name="axis",this.data=[],this.tickLineItems=[],this.subTickLineItems=[],this.axisLabelLayerSize={},this.axisLabelsContainer=null,this._onHover=t=>{this._lastHover=E_(t,this.axisContainer,this._lastHover)},this._onUnHover=t=>{this._lastHover=Eb(t,this.axisContainer,this._lastHover)},this._onClick=t=>{this._lastSelect=Ex(t,this.axisContainer,this._lastSelect)}}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}getBoundsWithoutRender(t){let e=eP(this.attribute);eF(this.attribute,t);let i=aj.group({x:this.attribute.x,y:this.attribute.y});return this.add(i),this._renderInner(i),this.removeChild(i),this.attribute=e,i.AABBBounds}render(){this._prevInnerView=this._innerView&&TA(this._innerView),this.removeAllChild(!0),this._innerView=aj.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent()}_bindEvent(){if(this.attribute.disableTriggerEvent)return;let{hover:t,select:e}=this.attribute;t&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),e&&this._innerView.addEventListener("pointerdown",this._onClick)}_renderInner(t){let{title:e,label:i,tick:r,line:n,items:s}=this.attribute,a=aj.group({x:0,y:0,zIndex:1});if(a.name=t8.axisContainer,a.id=this._getNodeId("container"),a.setMode(this.mode),this.axisContainer=a,t.add(a),n&&n.visible&&this.renderLine(a),s&&s.length&&(this.data=this._transformItems(s[0]),r&&r.visible&&this.renderTicks(a),i&&i.visible)){let t=aj.group({x:0,y:0,pickable:!1});t.name=t8.labelContainer,t.id=this._getNodeId("label-container"),this.axisLabelsContainer=t,a.add(t),s.forEach((e,i)=>{let r=this.renderLabels(t,e,i),n=r.getChildren();this.beforeLabelsOverlap(n,e,r,i,s.length),this.handleLabelsOverlap(n,e,r,i,s.length),this.afterLabelsOverlap(n,e,r,i,s.length);let a=0,o=0,l="center",h="middle";n.forEach(t=>{var e;let i=t.attribute,r=null!==(e=i.angle)&&void 0!==e?e:0,n=t.AABBBounds,s=n.width(),u=n.height();r&&(s=Math.abs(s*Math.cos(r)),u=Math.abs(u*Math.sin(r))),a=Math.max(a,s),o=Math.max(o,u),l=i.textAlign,h=i.textBaseline}),this.axisLabelLayerSize[i]={width:a,height:o,textAlign:l,textBaseline:h}})}e&&e.visible&&this.renderTitle(a)}renderTicks(t){let e=this.getTickLineItems(),i=aj.group({x:0,y:0,pickable:!1});i.name=t8.tickContainer,i.id=this._getNodeId("tick-container"),t.add(i),e.forEach((t,r)=>{var n;let s=aj.line(Object.assign({},this._getTickLineAttribute("tick",t,r,e)));if(s.name=t8.tick,s.id=this._getNodeId(t.id),mk(null===(n=this.attribute.tick)||void 0===n?void 0:n.state))s.states=Mw;else{let t=this.data[r],e=eF({},Mw,this.attribute.tick.state);Object.keys(e).forEach(i=>{nx(e[i])&&(e[i]=e[i](t.rawValue,r,t,this.data))}),s.states=e}i.add(s)}),this.tickLineItems=e;let{subTick:r}=this.attribute;if(r&&r.visible){let t=this.getSubTickLineItems();t.length&&t.forEach((t,n)=>{let s=aj.line(Object.assign({},this._getTickLineAttribute("subTick",t,n,e)));if(s.name=t8.subTick,s.id=this._getNodeId(`${n}`),mk(r.state))s.states=Mw;else{let i=eF({},Mw,r.state);Object.keys(i).forEach(r=>{nx(i[r])&&(i[r]=i[r](t.value,n,t,e))}),s.states=i}i.add(s)}),this.subTickLineItems=t}}renderLabels(t,e,i){let{dataFilter:r}=this.attribute.label;r&&nx(r)&&(e=r(e,i));let n=this._transformItems(e),s=aj.group({x:0,y:0,pickable:!1});return s.name=`${t8.labelContainer}-layer-${i}`,s.id=this._getNodeId(`label-container-layer-${i}`),t.add(s),n.forEach((t,e)=>{var r;let a=MP(this._getLabelAttribute(t,e,n,i));if(a.name=t8.label,a.id=this._getNodeId(`layer${i}-label-${t.id}`),mk(null===(r=this.attribute.label)||void 0===r?void 0:r.state))a.states=Mw;else{let r=eF({},Mw,this.attribute.label.state);Object.keys(r).forEach(s=>{nx(r[s])&&(r[s]=r[s](t,e,n,i))}),a.states=r}s.add(a)}),s}renderTitle(t){let e=new Ey(Object.assign({},this.getTitleAttribute()));e.name=t8.title,e.id=this._getNodeId("title"),t.add(e)}getVerticalCoord(t,e,i){return Tw(t,this.getVerticalVector(e,i,t))}getTextAlign(t){let e="center";return dg(t[0],0)?dg(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}getTickLineItems(){let{tick:t}=this.attribute,e=this.data,i=[],{alignWithLabel:r,inside:n=!1,length:s,dataFilter:a}=t,o=1;return e.length>=2&&(o=e[1].value-e[0].value),(a&&nx(a)?a(e):e).forEach(t=>{let e=t.point,a=t.value;if(!r){let i=t.value-o/2;if(this.isInValidValue(i))return;e=this.getTickCoord(i),a=i}let l=this.getVerticalCoord(e,s,n);if("3d"===this.mode){let r=this.getVerticalVector(s,n,e),o=0,h=0;ia(r[0])>ia(r[1])?o=ie/2*(l.x>e.x?1:-1):h=ie/2*(l.y>e.y?-1:1),i.push({start:e,end:l,value:a,id:`tick-${t.id}`,anchor:[e.x,e.y],alpha:o,beta:h})}else i.push({start:e,end:l,value:a,id:`tick-${t.id}`})}),i}getSubTickLineItems(){let{subTick:t}=this.attribute,e=[],{count:i=4,inside:r=!1,length:n=2}=t,s=this.tickLineItems,a=s.length;if(a>=2)for(let t=0;t<a-1;t++){let a=s[t],o=s[t+1];for(let t=0;t<i;t++){let s=(t+1)/(i+1),l=(1-s)*a.value+s*o.value,h=this.getTickCoord(l),u=this.getVerticalCoord(h,n,r);e.push({start:h,end:u,value:l,id:`sub-tick-${l}`})}}return e}_getTickLineAttribute(t,e,i,r){let n=dq(this.attribute,`${t}.style`),s=this.data[i];n=nx(n)?eF({},dq(Ef,`${t}.style`),"tick"===t?n(s.rawValue,i,s,this.data):n(e.value,i,e,r)):n;let{start:a,end:o,anchor:l,alpha:h,beta:u}=e;return Object.assign({points:[a,o],anchor:l,alpha:h,beta:u},n)}_getLabelAttribute(t,e,i,r){var n,s;let{space:a=4,inside:o=!1,formatMethod:l,type:h="text",text:u}=this.attribute.label,d=a,c=0;(null===(n=this.attribute.tick)||void 0===n?void 0:n.visible)&&this.attribute.tick.inside===o&&(c=this.attribute.tick.length||4),(null===(s=this.attribute.subTick)||void 0===s?void 0:s.visible)&&this.attribute.subTick.inside===o&&(c=Math.max(c,this.attribute.subTick.length||2)),d+=c;let p=this.getRelativeVector(t.point);r>0&&(0===p[1]?d+=(this.axisLabelLayerSize[r-1].height+dq(this.attribute,"label.space",4))*r:d+=(this.axisLabelLayerSize[r-1].width+dq(this.attribute,"label.space",4))*r);let g=this.getVerticalCoord(t.point,d,o),f=this.getVerticalVector(d||1,o,g),m=l?l(`${t.label}`,t,e,i,r):t.label,{style:v}=this.attribute.label;return v=nx(v)?eF({},Ef.label.style,v(t,e,i,r)):v,nx((v=eF(this.getLabelAlign(f,o,v.angle),v)).text)&&(v.text=v.text({label:t.label,value:t.rawValue,index:t.index,layer:r})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(g,f,m,v)),{text:null!=u?u:m,_originText:t.label,lineHeight:null==v?void 0:v.fontSize,type:h}),v)}getLabelPosition(t,e,i,r){return t}_transformItems(t){let e=[];return t.forEach(t=>{var i;e.push(Object.assign(Object.assign({},t),{point:this.getTickCoord(t.value),id:null!==(i=t.id)&&void 0!==i?i:t.label}))}),e}release(){super.release(),this._prevInnerView=null,this._innerView=null}}function Ek(t){t.forEach(t=>{var e,i,r,n,s;if(t.rotatedBounds||!t.attribute.angle)return;let a=function(t){let e=t.AABBBounds;return{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,centerX:t.attribute.x,centerY:t.attribute.y,angle:t.attribute.angle}}(t),o=(e=a.centerX,i=a.centerY,r=a.angle,n=t.attribute.x,{x:(e-n)*Math.cos(r)+(i-(s=t.attribute.y))*Math.sin(r)+n,y:(e-n)*Math.sin(r)+(s-i)*Math.cos(r)+s}),l=o.x-a.centerX,h=o.y-a.centerY;a.x1+=l,a.x2+=l,a.y1+=h,a.y2+=h,a.centerX+=l,a.centerY+=h,t.rotatedBounds=a})}let EA={parity:function(t){return t.filter((t,e)=>e%2?t.setAttribute("opacity",0):1)},greedy:function(t,e){let i;return t.filter((t,r)=>r&&Ew(i,t,e)?t.setAttribute("opacity",0):(i=t,1))}};function Ew(t,e,i){let r=t.AABBBounds,n=e.AABBBounds;return i>Math.max(n.x1-r.x2,r.x1-n.x2,n.y1-r.y2,r.y1-n.y2)&&(!t.rotatedBounds||!e.rotatedBounds||i>Math.max(e.rotatedBounds.x1-t.rotatedBounds.x2,t.rotatedBounds.x1-e.rotatedBounds.x2,e.rotatedBounds.y1-t.rotatedBounds.y2,t.rotatedBounds.y1-e.rotatedBounds.y2))}function EM(t,e){for(let i,r=1,n=t.length,s=t[0];r<n;s=i,++r)if(Ew(s,i=t[r],e))return!0}function EC(t){let e=t.AABBBounds;return e.width()>1&&e.height()>1}function ET(t=0){if(t<0)for(;t<0;)t+=2*Math.PI;if(t>0)for(;t>=2*Math.PI;)t-=2*Math.PI;return t}function EE(t,e=0){let i,r=["center","left","left","left","center","right","right","right","left"],n=["top","top","middle","bottom","bottom","bottom","middle","top","top"];"top"===t&&(r=["center","right","right","right","center","left","left","left","right"],n=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);let s=(e=ET(e))/(.5*Math.PI);return{textAlign:r[i=s===Math.floor(s)?2*Math.floor(s):2*Math.floor(s)+1],textBaseline:n[i]}}function EO(t,e=0){let i,r=["right","right","center","left","center","left","center","right","right"],n=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];"right"===t&&(r=["left","right","right","right","left","left","left","left","right"],n=["middle","bottom","middle","top","top","top","middle","bottom","bottom"]);let s=(e=ET(e))/(.5*Math.PI);return{textAlign:r[i=s===Math.floor(s)?2*Math.floor(s):2*Math.floor(s)+1],textBaseline:n[i]}}class EP{isInValidValue(t){return t<0||t>1}getTickCoord(t){let{start:e}=this.attribute,i=this.getRelativeVector();return{x:e.x+i[0]*t,y:e.y+i[1]*t}}getRelativeVector(t){let{start:e,end:i}=this.attribute;return[i.x-e.x,i.y-e.y]}getVerticalVector(t,e=!1,i){let{verticalFactor:r=1}=this.attribute,n=function(t){let[e,i]=t,r=e*e+i*i;return r>0&&(r=1/Math.sqrt(r)),[t[0]*r,t[1]*r]}(this.getRelativeVector());return Tb([n[1],-1*n[0]],t*(e?1:-1)*r)}}let ER=["radius","startAngle","endAngle",...n4];class EB extends se{constructor(t={radius:1}){super(t),this.type="circle",this.numberType=sM}isValid(){return super.isValid()&&this._isValid()}_isValid(){let{startAngle:t,endAngle:e,radius:i}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)}doUpdateAABBBounds(t){let e=nf(this).circle;this._AABBBounds.clear();let i=this.attribute,r=rj.graphicService.updateCircleAABBBounds(i,nf(this).circle,this._AABBBounds,t,this),{boundsPadding:n=e.boundsPadding}=i,s=ss(n);return s&&r.expand(s),this.clearUpdateBoundTag(),r}tryUpdateOBBBounds(){throw Error("\u6682\u4E0D\u652F\u6301")}getDefaultAttribute(t){return nf(this).circle[t]}needUpdateTags(t){return super.needUpdateTags(t,ER)}needUpdateTag(t){return super.needUpdateTag(t,ER)}toCustomPath(){var t,e,i;let r=this.attribute,n=null!==(t=r.radius)&&void 0!==t?t:this.getDefaultAttribute("radius"),s=null!==(e=r.startAngle)&&void 0!==e?e:this.getDefaultAttribute("startAngle"),a=null!==(i=r.endAngle)&&void 0!==i?i:this.getDefaultAttribute("endAngle"),o=new rg;return o.arc(0,0,n,s,a),o}clone(){return new EB(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return EB.NOWORK_ANIMATE_ATTR}}function EI(t){return new EB(t)}EB.NOWORK_ANIMATE_ATTR=st;let EL=new class t{constructor(){this.time=lP.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,n,s,a,o,l,h,u,d){let{outerBorder:c,innerBorder:p}=t.attribute,g=c&&!1!==c.visible,f=p&&!1!==p.visible;if(!g&&!f)return;let{radius:m=l.radius,startAngle:v=l.startAngle,endAngle:y=l.endAngle,opacity:_=l.opacity,x:b=l.x,y:x=l.y,scaleX:S=l.scaleX,scaleY:k=l.scaleY}=t.attribute,A=!(!c||!c.stroke),w=!(!p||!p.stroke);if(g){let{distance:n=l.outerBorder.distance}=c,s=od(e,n,e.dpr);if(e.beginPath(),e.arc(i,r,m+s,v,y),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),d)d(e,c,l.outerBorder);else if(A){let n=l.outerBorder.opacity;l.outerBorder.opacity=_,e.setStrokeStyle(t,c,(b-i)/S,(x-r)/k,l.outerBorder),l.outerBorder.opacity=n,e.stroke()}}if(f){let{distance:n=l.innerBorder.distance}=p,s=od(e,n,e.dpr);if(e.beginPath(),e.arc(i,r,m-s,v,y),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),d)d(e,p,l.innerBorder);else if(w){let n=l.innerBorder.opacity;l.innerBorder.opacity=_,e.setStrokeStyle(t,p,(b-i)/S,(x-r)/k,l.innerBorder),l.innerBorder.opacity=n,e.stroke()}}}};var ED=function(t,e){return function(i,r){e(i,r,t)}};let EF=class extends oQ{constructor(t){super(),this.circleRenderContribitions=t,this.numberType=sM,this.builtinContributions=[EL,oY,o6],this.init(t)}drawShape(t,e,i,r,n,s,a,o){let l=nf(t,null==s?void 0:s.theme).circle,{radius:h=l.radius,startAngle:u=l.startAngle,endAngle:d=l.endAngle,x:c=l.x,y:p=l.y}=t.attribute,g=this.valid(t,l,a,o);if(!g)return;let{fVisible:f,sVisible:m,doFill:v,doStroke:y}=g;e.beginPath(),e.arc(i,r,h,u,d),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,l),this.beforeRenderStep(t,e,i,r,v,y,f,m,l,n,a,o),v&&(a?a(e,t.attribute,l):f&&(e.setCommonStyle(t,t.attribute,c-i,p-r,l),e.fill())),y&&(o?o(e,t.attribute,l):m&&(e.setStrokeStyle(t,t.attribute,c-i,p-r,l),e.stroke())),this.afterRenderStep(t,e,i,r,v,y,f,m,l,n,a,o)}draw(t,e,i,r){let n=nf(t,null==r?void 0:r.theme).circle;this._draw(t,n,!1,i,r)}};EF=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),ED(0,e0(e2)),ED(0,e1(oD)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],EF);let Ej=!1,EN=new eW(t=>{Ej||(Ej=!0,t(EF).toSelf().inSingletonScope(),t(s5).to(EF).inSingletonScope(),t(s4).toService(s5),t(oD).toService(oK),e5(t,oD))}),Ez=class{constructor(t){this.canvasRenderer=t,this.type="circle",this.numberType=sM}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).circle,{x:s=n.x,y:a=n.y}=t.attribute;if(r.highPerformanceSave(),t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let o=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,i,r)=>!!o||(o=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(o)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=od(r,s+a,r.dpr),o=t.isPointInStroke(e.x,e.y)}),r.highPerformanceRestore(),o}};Ez=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(tF=0,tj=e0(s5),function(t,e){tj(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],Ez);let EH=!1,EV=new eW((t,e,i,r)=>{EH||(EH=!0,t(yk).to(Ez).inSingletonScope(),t(yD).toService(yk))}),EW=class{constructor(t){this.canvasRenderer=t,this.type="circle",this.numberType=sM}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if("imprecise"===t.attribute.pickMode)return!0;let{pickContext:r}=null!=i?i:{};if(!r)return!1;let n=nf(t).circle,{x:s=n.x,y:a=n.y}=t.attribute;if(r.highPerformanceSave(),t.transMatrix.onlyTranslate()){let e=t.getOffsetXY(n);s+=e.x,a+=e.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let o=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(t,i,r)=>!!o||(o=t.isPointInPath(e.x,e.y)),(t,i,n)=>{if(o)return!0;let s=i.lineWidth||n.lineWidth,a=i.pickStrokeBuffer||n.pickStrokeBuffer;return r.lineWidth=s+a,o=t.isPointInStroke(e.x,e.y)}),r.highPerformanceRestore(),o}};EW=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX(),(tN=0,tz=e0(s5),function(t,e){tz(t,e,0)}),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[Object])],EW);let EG=!1,EU=new eW((t,e,i,r)=>{EG||(EG=!0,t(yd).to(EW).inSingletonScope(),t(yl).toService(yd))});function E$(){E$.__loaded||(E$.__loaded=!0,aj.RegisterGraphicCreator("circle",EI),r4.load(EN),r4.load(yo?EV:EU))}E$.__loaded=!1;function EY(){v8(),kP(),Al(),yG()}var EK=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};EY(),bp();class EZ extends ES{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},EZ.defaultAttributes,t),e)}_renderInner(t){var e;super._renderInner(t);let{panel:i}=this.attribute;if(i&&i.visible){let t=this.axisContainer,r=t.AABBBounds,n=aj.rect(Object.assign({x:r.x1,y:r.y1,width:r.width(),height:r.height()},i.style));n.name=t8.background,n.id=this._getNodeId("background"),n.states=eF({},Eg,null!==(e=i.state)&&void 0!==e?e:{}),t.insertBefore(n,t.firstChild)}}renderLine(t){let{start:e,end:i,line:r}=this.attribute,{startSymbol:n,endSymbol:s,style:a,breakRange:o,breakShape:l,breakShapeStyle:h,state:u}=r,d=Object.assign({points:[e,i],startSymbol:n,endSymbol:s,lineStyle:a},EK(r,["startSymbol","endSymbol","style","breakRange","breakShape","breakShapeStyle","state"]));mk(u)||(d.state={line:eF({},Eg,u),symbol:eF({},Eg,u)});let c=new Ep(d);c.name=t8.line,c.id=this._getNodeId("line"),t.add(c)}getTitleAttribute(){var t,e,i;let r=this.attribute.title,{position:n="middle",space:s=4,textStyle:a={},autoRotate:o=!0,shape:l,background:h,state:u={},maxWidth:d}=r,c=EK(r,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]),p=.5;"start"===n?p=0:"end"===n&&(p=1);let{verticalFactor:g=1}=this.attribute,f=this.getTickCoord(p),m=this.getRelativeVector(),v=0;if((null===(t=this.attribute.label)||void 0===t?void 0:t.visible)&&!1===this.attribute.label.inside){let t=+dq(this.attribute,"label.space",4);v+=t;let e=Object.keys(this.axisLabelLayerSize).length;if(0===m[1]){let i=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(i)?v+=i+(e-1)*t:v=0}else{if(0===m[0]){let i=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.width():0;isFinite(i)?v+=i+(e-1)*t:v=0}else Object.keys(this.axisLabelLayerSize).forEach((e,i)=>{v+=this.axisLabelLayerSize[e].width+(i>0?t:0)});let i=this.axisLabelLayerSize[0].textAlign,r="start"===i||"left"===i,n="center"===i,s=m[1]>0;v=1==-1*g?s?r?v:n?v/2:t:r?t:n?v/2:v:s?r?t:n?v/2:v:r?v:n?v/2:t}}let y=0;(null===(e=this.attribute.tick)||void 0===e?void 0:e.visible)&&!1===this.attribute.tick.inside&&(y=this.attribute.tick.length||4),(null===(i=this.attribute.subTick)||void 0===i?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(y=Math.max(y,this.attribute.subTick.length||2));let _=y+v+s,b=this.getVerticalCoord(f,_,!1),x=this.getVerticalVector(_,!1,{x:0,y:0}),S,k,{angle:A}=c;if(S="start"===n?"start":"end"===n?"end":"center",ej(A)&&o){A=function(t,e,i){var r,n;let s=function(t,e){let[i,r]=t,[n,s]=e,a=Math.sqrt((i*i+r*r)*(n*n+s*s));return Math.acos(Math.min(Math.max(a&&(i*n+r*s)/a,-1),1))}(t,e),a=(r=t,n=e,r[0]*n[1]-n[0]*r[1]>=0);return i?a?2*Math.PI-s:s:a?s:2*Math.PI-s}(m,[1,0],!0);let{verticalFactor:t=1}=this.attribute;k=1==-1*t?"bottom":"top"}else S=this.getTextAlign(x),k=this.getTextBaseline(x,!1);let w=d;if(ej(w)){let{verticalLimitSize:t,verticalMinSize:e,orient:i}=this.attribute,r=Math.min(t||1/0,e||1/0);if(l1(r)){if("bottom"===i||"top"===i){if(A!==Math.PI/2){let t=Math.abs(Math.cos(null!=A?A:0));w=t<1e-6?1/0:this.attribute.end.x/t}else w=r-_}else if(A&&0!==A){let t=Math.abs(Math.sin(A));w=t<1e-6?1/0:this.attribute.end.y/t}else w=r-_}}let M=Object.assign(Object.assign(Object.assign({},b),c),{maxWidth:w,textStyle:Object.assign({textAlign:S,textBaseline:k},a),state:{text:eF({},Eg,u.text),shape:eF({},Eg,u.shape),panel:eF({},Eg,u.background)}});return M.angle=A,l&&l.visible&&(M.shape=Object.assign({visible:!0},l.style),l.space&&(M.space=l.space)),h&&h.visible&&(M.panel=Object.assign({visible:!0},h.style)),M}getTextBaseline(t,e){let i="middle",{verticalFactor:r=1}=this.attribute;return dg(t[1],0)?i=!dg(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":1==(e?1:-1)*r?"bottom":"top":t[1]>0?i="top":t[1]<0&&(i="bottom"),i}getLabelAlign(t,e,i){let r=this.attribute.orient;if(["top","bottom","right","left"].includes(r)||0===t[0]&&0===t[1]){if("top"===r||"bottom"===r)return EE(e?"bottom"===r?"top":"bottom":r,i);if("left"===r||"right"===r)return EO(e?"left"===r?"right":"left":r,i)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}beforeLabelsOverlap(t,e,i,r,n){var s,a,o,l;let{flush:h=!1}=this.attribute.label||{};if(h&&t.length){let{orient:e,start:i,end:r}=this.attribute,n="bottom"===e||"top"===e,h=t[0],u=ov(t),d=n?h.attribute.x>u.attribute.x:h.attribute.y<u.attribute.y;if(n){let t=d?u:h,e=d?h:u,n=i.x,o=r.x,l=t.AABBBounds.x1,c=e.AABBBounds.x2;l<n&&(t.attribute.angle?t.setAttributes({dx:(null!==(s=t.attribute.dx)&&void 0!==s?s:0)+n-l}):t.setAttributes({x:n,textAlign:"left"})),c>o&&(e.attribute.angle?e.setAttributes({dx:(null!==(a=e.attribute.dx)&&void 0!==a?a:0)+o-c}):e.setAttributes({x:o,textAlign:"right"}))}else{let t=d?u:h,e=d?h:u,n=t.AABBBounds.y2,s=e.AABBBounds.y1,a=i.y,c=r.y;s<a&&(e.attribute.angle?e.setAttributes({dy:(null!==(o=e.attribute.dy)&&void 0!==o?o:0)+a-s}):e.setAttributes({y:a,textBaseline:"top"})),n>c&&(t.attribute.angle?t.setAttributes({dy:(null!==(l=t.attribute.dy)&&void 0!==l?l:0)+c-n}):t.setAttributes({y:c,textBaseline:"bottom"}))}}}handleLabelsOverlap(t,e,i,r,n){if(mk(t))return;let{verticalLimitSize:s,label:a,orient:o}=this.attribute,l=this._getAxisLabelLimitLength(s,n),{layoutFunc:h,autoRotate:u,autoRotateAngle:d,autoLimit:c,limitEllipsis:p,autoHide:g,autoHideMethod:f,autoHideSeparation:m,lastVisible:v}=a;if(nx(h))h(t,e,r,this);else{if(u&&function(t,e){if(mk(t))return;let{orient:i,labelRotateAngle:r=[0,45,90]}=e;if(0===r.length||t.some(t=>!!t.attribute.angle))return;let n=0,s=0;for(r&&r.length>0&&(s=r.length);n<s;){let e=r[n++];if(t.forEach(t=>{t.attribute.angle=ik(e)}),function(t,e){"bottom"!==t&&"top"!==t||function(t,e){e.forEach(e=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},EE(t,e.attribute.angle)),{angle:ET(e.attribute.angle)}))})}(t,e),"left"!==t&&"right"!==t||function(t,e){e.forEach((e,i)=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},EO(t,e.attribute.angle)),{angle:ET(e.attribute.angle)}))})}(t,e),Ek(e)}(i,t),!function(t){for(let r=1;r<t.length;r++){var e,i;if(e=t[r-1],i=t[r],a4(e.AABBBounds,i.AABBBounds,!1)&&(!e.rotatedBounds||!i.rotatedBounds||function(t,e,i=!1,r){let n=ot(t,i),s=ot(e,i),a=(t,e)=>[e.x-t.x,e.y-t.y],o=a7(t),l=a7(e);r&&r.fillRect(o.x,o.y,2,2),r&&r.fillRect(l.x,l.y,2,2);let h=a(o,l),u=a(n[0],n[1]),d=a(n[1],n[2]),c=a(s[0],s[1]),p=a(s[1],s[2]),g=i?t.angle:ik(t.angle),f=i?t.angle+ii:ik(90-t.angle),m=i?e.angle:ik(e.angle),v=i?e.angle+ii:ik(90-e.angle);f>is&&(f-=is),v>is&&(v-=is);let y=(t,e,i,r)=>{let n=[Math.cos(e),Math.sin(e)];return t+(a6(n,i)+a6(n,r))/2>a6(n,h)};return y((t.x2-t.x1)/2,g,c,p)&&y((t.y2-t.y1)/2,f,c,p)&&y((e.x2-e.x1)/2,m,u,d)&&y((e.y2-e.y1)/2,v,u,d)}(e.rotatedBounds,i.rotatedBounds,!0)))return!0}return!1}(t))break}}(t,{labelRotateAngle:d,orient:o}),c&&l1(l)&&l>0){let e="left"===o||"right"===o,i=e?Math.abs(this.attribute.start.y-this.attribute.end.y):Math.abs(this.attribute.start.x-this.attribute.end.x),r=e?i/t.length:g||u?1/0:i/t.length;!function(t,e){let{limitLength:i,verticalLimitLength:r,ellipsis:n="...",orient:s,axisLength:a}=e;if(mk(t)||!l1(i))return;let o=Math.sin(Math.PI/10);t.forEach(t=>{var e;let l=t.attribute.angle,h=!ej(l),u=h?Math.cos(l):1,d=h?Math.sin(l):0,c=!h||Math.abs(d)<=o,p=h&&Math.abs(u)<=o,g="top"===s||"bottom"===s;if(g&&(p&&Math.floor(t.AABBBounds.height())<=i||c&&Math.floor(t.AABBBounds.width())<=r))return;let f=t.attribute.direction;if(!g&&("vertical"===f&&Math.floor(t.AABBBounds.height())<=r||"vertical"!==f&&(c&&Math.floor(t.AABBBounds.width())<=i||p&&Math.floor(t.AABBBounds.height())<=r)))return;let m=null;if(c||p)m=g?c?r:i:"vertical"===f||p?r:i;else if(g){let{x1:e,x2:r}=t.AABBBounds,n=d/u;m=n>0&&e<=a&&i/n+e>a?(a-e)/Math.abs(u):n<0&&r>=0&&i/n+r<0?r/Math.abs(u):Math.abs(i/d)}else m=Math.abs(i/u);l1(t.attribute.maxLineWidth)&&(m=l1(m)?Math.min(t.attribute.maxLineWidth,m):t.attribute.maxLineWidth),t.setAttributes({maxLineWidth:m,ellipsis:null!==(e=t.attribute.ellipsis)&&void 0!==e?e:n})})}(t,{limitLength:l,verticalLimitLength:r,ellipsis:p,orient:o,axisLength:i})}g&&function(t,e){var i;let r;if(mk(t))return;let n=t.filter(EC);if(mk(n))return;(i=n).forEach(t=>t.setAttribute("opacity",1)),Ek(r=i);let{method:s="parity",separation:a=0}=e,o=nx(s)?s:EA[s]||EA.parity;if(r.length>=3&&EM(r,a)){do r=o(r,a);while(r.length>=3&&EM(r,a));if(r.length<3||e.lastVisible){let t=ov(n);if(!t.attribute.opacity){let e=r.length;if(e>1){t.setAttribute("opacity",1);for(let i=e-1;i>=0&&Ew(r[i],t,a);i--)r[i].setAttribute("opacity",0)}}}}n.forEach(t=>{t.setAttribute("visible",!!t.attribute.opacity)})}(t,{orient:o,method:f,separation:m,lastVisible:v})}}afterLabelsOverlap(t,e,i,r,n){let{verticalLimitSize:s,orient:a}=this.attribute,o="bottom"===a||"top"===a,l=i.AABBBounds,h=o?l.height():l.width(),{verticalMinSize:u}=this.attribute;if(l1(u)&&(!l1(s)||u<=s)){let t,e;h=Math.max(h,this._getAxisLabelLimitLength(u,n)),"left"===a?(t=l.x2-h,e=l.y1):"right"===a?(t=l.x1,e=l.y1):"top"===a?(t=l.x1,e=l.y2-h):"bottom"===a&&(t=l.x1,e=l.y1);let r=aj.rect({x:t,y:e,width:o?l.width():h,height:o?h:l.height(),pickable:!1});r.name=t8.axisLabelBackground,r.id=this._getNodeId("axis-label-background"),i.insertBefore(r,i.firstChild)}if(eO(this.attribute.label.containerAlign)){let e;"left"===a?e=l.x2:"right"===a?e=l.x1:"top"===a?e=l.y2:"bottom"===a&&(e=l.y1),function(t,e,i,r,n){if("right"===r||"left"===r){if("left"===n){let n="right"===r?0:-1;t.forEach(t=>{t.setAttributes({x:e+i*n,textAlign:"left"})})}else if("right"===n){let n="right"===r?1:0;t.forEach(t=>{t.setAttributes({x:e+i*n,textAlign:"right"})})}else if("center"===n){let n="right"===r?1:-1;t.forEach(t=>{t.setAttributes({x:e+.5*i*n,textAlign:"center"})})}}else if("bottom"===r||"top"===r){if("top"===n){let n="bottom"===r?0:-1;t.forEach(t=>{t.setAttributes({y:e+i*n,textBaseline:"top"})})}else if("bottom"===n){let n="bottom"===r?1:0;t.forEach(t=>{t.setAttributes({y:e+i*n,textBaseline:"bottom"})})}else if("middle"===n){let n="bottom"===r?1:-1;t.forEach(t=>{t.setAttributes({y:e+.5*i*n,textBaseline:"middle"})})}}}(t,e,h,a,this.attribute.label.containerAlign)}}_getAxisLabelLimitLength(t,e){var i,r,n,s,a;let{label:o,title:l,line:h,tick:u}=this.attribute,d=null!==(i=o.space)&&void 0!==i?i:4,c=t,p=0,g=0,f=h&&h.visible?null!==(r=h.style.lineWidth)&&void 0!==r?r:1:0,m=u&&u.visible?null!==(n=u.length)&&void 0!==n?n:4:0;if(l&&l.visible&&"string"==typeof l.text){p=MT(l.text,l.textStyle,null===(a=null===(s=this.stage)||void 0===s?void 0:s.getTheme())||void 0===a?void 0:a.text).height;let t=El(l.padding);g=l.space+t[0]+t[2]}return c&&(c=(c-d-g-p-f-m)/e),c}}EZ.defaultAttributes=Ef,CS(EZ,EP);class EX{isInValidValue(t){let{startAngle:e=MS,endAngle:i=Mk}=this.attribute;return Math.abs(i-e)%(2*Math.PI)==0?t>1:t<0||t>1}getTickCoord(t){let{startAngle:e=MS,endAngle:i=Mk,center:r,radius:n,inside:s=!1,innerRadius:a=0}=this.attribute;return iM(r,s&&a>0?a:n,e+(i-e)*t)}getVerticalVector(t,e=!1,i){return TM(t,i,this.attribute.center,e,this.attribute.inside)}getRelativeVector(t){let{center:e}=this.attribute;return[t.y-e.y,-1*(t.x-e.x)]}}var Eq=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};EY(),E$();class EJ extends ES{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},EJ.defaultAttributes,t))}renderLine(t){let{startAngle:e=MS,endAngle:i=Mk,radius:r,center:n,innerRadius:s=0,line:a={},inside:o=!1}=this.attribute,l=r,h=s;o&&s>0&&(l=s,h=0);let u=Object.assign(Object.assign(Object.assign({},n),{startAngle:e,endAngle:i,radius:l,innerRadius:h}),a.style),d=aj.circle(u);d.name=t8.line,d.id=this._getNodeId("line"),mk(a.state)||(d.states=eF({},Eg,a.state)),t.add(d)}getTitleAttribute(){var t,e,i;let{center:r,radius:n,innerRadius:s=0}=this.attribute,a=this.attribute.title,{space:o=4,textStyle:l={},shape:h,background:u,state:d={}}=a,c=Eq(a,["space","textStyle","shape","background","state"]),p=r,g=0;(null===(t=this.attribute.label)||void 0===t?void 0:t.visible)&&!1===this.attribute.label.inside&&(g=dq(this.attribute.label,"style.fontSize",12)+dq(this.attribute.label,"space",4));let f=0;(null===(e=this.attribute.tick)||void 0===e?void 0:e.visible)&&!1===this.attribute.tick.inside&&(f=this.attribute.tick.length||4),(null===(i=this.attribute.subTick)||void 0===i?void 0:i.visible)&&!1===this.attribute.subTick.inside&&(f=Math.max(f,this.attribute.subTick.length||2));let m=n+f+g+o,v="middle",{position:y}=this.attribute.title;ej(y)&&(y=0===s?"end":"middle"),"start"===y?(v="bottom",p={x:r.x,y:r.y-m}):"end"===y&&(v="top",p={x:r.x,y:r.y+m});let _=Object.assign(Object.assign(Object.assign({},p),c),{textStyle:Object.assign({textBaseline:v,textAlign:"center"},l),state:{text:eF({},Eg,d.text),shape:eF({},Eg,d.shape),panel:eF({},Eg,d.background)}}),{angle:b}=c;return _.angle=b,h&&h.visible&&(_.shape=Object.assign({visible:!0},h.style),h.space&&(_.space=h.space)),u&&u.visible&&(_.panel=Object.assign({visible:!0},u.style)),_}getSubTickLineItems(){var t,e;let{subTick:i}=this.attribute,r=[],{count:n=4,inside:s=!1,length:a=2}=i,o=this.tickLineItems,l=o.length;if(l>=2){let i=this.data[1].value-this.data[0].value,h=null===(e=null===(t=this.attribute)||void 0===t?void 0:t.tick)||void 0===e?void 0:e.alignWithLabel;for(let t=0;t<l;t++){let e=o[t],l=o[t+1];for(let t=0;t<n;t++){let o=(t+1)/(n+1),u=(1-o)*e.value+o*(l?l.value:h?1:e.value+i),d=this.getTickCoord(u),c=this.getVerticalCoord(d,a,s);r.push({start:d,end:c,value:u})}}}return r}getTextBaseline(t){let e="middle";return dg(t[1],0)?e="middle":t[1]>0&&t[1]>Math.abs(t[0])?e="top":t[1]<0&&Math.abs(t[1])>Math.abs(t[0])&&(e="bottom"),e}beforeLabelsOverlap(t,e,i,r,n){}handleLabelsOverlap(t,e,i,r,n){}afterLabelsOverlap(t,e,i,r,n){}getLabelAlign(t,e,i){return{textAlign:"center",textBaseline:"middle"}}getLabelPosition(t,e,i,r){return Tk(t,e,i,r)}}EJ.defaultAttributes=Ef,CS(EJ,EX);class EQ extends v1{parseAddition(t){return super.parseAddition(t),this.scale(t.scale),this}scale(t){if(this.spec.scale){let t=eE(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;this.detach(t),this.spec.scale=void 0}let e=eE(t)?this.view.getScaleById(t):t;return this.spec.scale=e,this.attach(e),this._updateComponentEncoders(),this.commit(),this}getScale(){return eE(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale}}let E0=(t,e,i,r)=>{var n,s,a,o;let l=null!==(s=null===(n=null==e?void 0:e.components)||void 0===n?void 0:n.axis)&&void 0!==s?s:{};return t?eF({},l,{items:[(null!==(o=null===(a=t.tickData)||void 0===a?void 0:a.call(t,r))&&void 0!==o?o:[]).map(t=>({id:t.index,label:t.tick,value:t.value,rawValue:t.tick}))]},null!=i?i:{}):eF({},l,null!=i?i:{})},E1=(t,e,i,r)=>{var n,s,a,o;let l=null!==(s=null===(n=null==e?void 0:e.components)||void 0===n?void 0:n.circleAxis)&&void 0!==s?s:{};return t?eF({},l,{items:[(null!==(o=null===(a=t.tickData)||void 0===a?void 0:a.call(t,r))&&void 0!==o?o:[]).map(t=>({id:t.index,label:t.tick,value:t.value,rawValue:t.tick}))]},null!=i?i:{}):eF({},l,null!=i?i:{})},E2=(t,e,i,r,n,s)=>{var a;let o=t.getCoordinateAxisPosition();n&&"auto"===n.position&&(n.position=i?"content":o);let l=t.getCoordinateAxisPoints(r);if(l){let r={start:l[0],end:l[1],verticalFactor:("top"===o||"left"===o?-1:1)*(i?-1:1)*((null===(a=t.getSpec().range)||void 0===a?void 0:a.reversed)?-1:1)};if(s&&"polar"===e.type){let t=e.angle();r.center=e.origin(),r.startAngle=t[0],r.endAngle=t[1]}return r}let h=e.radius(),u=e.angle();return{center:e.origin(),radius:h[1],innerRadius:h[0],inside:i,startAngle:u[0],endAngle:u[1]}};class E3 extends EQ{constructor(t,e,i){super(t,c6.axis,e),this.spec.componentType=c6.axis,this.mode=i}parseAddition(t){return super.parseAddition(t),this.axisType(t.axisType),this.tickCount(t.tickCount),this.inside(t.inside),this.baseValue(t.baseValue),this}scale(t){return super.scale(t),this._axisComponentType=null,this}axisType(t){return this.spec.axisType=t,this._axisComponentType=null,this._prepareRejoin(),this.commit(),this}addGraphicItem(t,e){let i=eF({x:0,y:0,start:{x:0,y:0},end:{x:0,y:0}},t),r=d0.createGraphicComponent(this._getAxisComponentType(),i,{mode:this.mode,skipDefault:this.spec.skipTheme});return super.addGraphicItem(i,e,r)}tickCount(t){let e=eE(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;return e&&e.tickCount(t),this.setFunctionSpec(t,"tickCount")}inside(t){return this.setFunctionSpec(t,"inside")}baseValue(t){return this.setFunctionSpec(t,"baseValue")}getAxisComponentType(){return this._axisComponentType}_updateComponentEncoders(){let t=eE(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale,e=Object.assign({update:{}},this.spec.encode),i=Object.keys(e).reduce((i,r)=>{let n=e[r];return n&&(i[r]={callback:(e,i,r)=>{var s,a;let o=this.spec.skipTheme?null:this.view.getCurrentTheme(),l=mE(n,e,i,r),h=gN(this.spec.inside,r,e,i),u=gN(this.spec.baseValue,r,e,i),d=null===(s=null==t?void 0:t.getCoordinate)||void 0===s?void 0:s.call(t);d&&(l=Object.assign(E2(t,d,h,u,this.spec.layout),l));let c=null===(a=null==t?void 0:t.getScale)||void 0===a?void 0:a.call(t),p=gN(this.spec.tickCount,r,e,i);switch(this._getAxisComponentType()){case c7.lineAxis:return E0(c,o,l,p);case c7.circleAxis:return E1(c,o,l,p)}return l}}),i},{});this._encoders=i}_getAxisComponentType(){var t;if(this._axisComponentType)return this._axisComponentType;let e=this.spec.axisType;if(ej(e)){let i=eE(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;e=(null===(t=null==i?void 0:i.getCoordinate)||void 0===t?void 0:t.call(i))?i.getCoordinateAxisPoints()?"line":"circle":"line"}return this._axisComponentType="circle"===e?c7.circleAxis:c7.lineAxis,this._axisComponentType}}E3.componentType=c6.axis;let E5=()=>{d0.registerGraphicComponent(c7.lineAxis,(t,e)=>new EZ(t,e)),d0.registerGraphicComponent(c7.circleAxis,t=>new EJ(t)),d0.registerComponent(c6.axis,E3)};function E4(t,e){let i="";return 0===t.length||(t.forEach((t,e)=>{0===e?i=`M${t.x},${t.y}`:i+=`L${t.x},${t.y}`}),e&&(i+="Z")),i}function E8(t,e,i,r){let n="";if(!t||0===e.length)return n;let s=e[0],a=iG.distancePP(t,s),o=i?0:1;return r?n+=`M${t.x},${t.y-a}A${a},${a},0,0,${o},${t.x},${t.y+a}A${a},${a},0,0,${o},${t.x},${t.y-a}Z`:e.forEach((t,e)=>{0===e?n=`M${t.x},${t.y}`:n+=`A${a},${a},0,0,${o},${t.x},${t.y}`}),n}class E6 extends Eu{constructor(){super(...arguments),this.name="axis-grid",this.data=[]}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}render(){this._prevInnerView=this._innerView&&TA(this._innerView),this.removeAllChild(!0),this._innerView=aj.group({x:0,y:0,pickable:!1}),this.add(this._innerView);let{items:t,visible:e}=this.attribute;t&&t.length&&!1!==e&&(this.data=this._transformItems(t),this._renderGrid(this._innerView))}getVerticalCoord(t,e,i){return Tw(t,this.getVerticalVector(e,i,t))}_transformItems(t){let e=[];return t.forEach(t=>{var i;e.push(Object.assign(Object.assign({},t),{point:this.getTickCoord(t.value),id:null!==(i=t.id)&&void 0!==i?i:t.label}))}),e}_renderGrid(t){let{visible:e}=this.attribute.subGrid||{};e&&this._renderGridByType(!0,t),this._renderGridByType(!1,t)}_renderGridByType(t,e){let i=eF({},this.attribute,this.getGridAttribute(t)),{type:r,items:n,style:s,closed:a,alternateColor:o,depth:l=0}=i,h=t?`${t8.grid}-sub`:`${t8.grid}`;if(n.forEach((t,i)=>{let{id:n,points:o}=t,u="";if("line"===r||"polygon"===r)u=E4(o,!!a);else if("circle"===r){let{center:t}=this.attribute;u=E8(t,o,!1,!!a)}let d=aj.path(Object.assign({path:u,z:l},nx(s)?eF({},this.skipDefault?null:E6.defaultAttributes.style,s(t,i)):s));d.name=`${h}-line`,d.id=this._getNodeId(`${h}-path-${n}`),e.add(d)}),l&&"line"===r&&n.forEach((t,i)=>{let{id:r,points:n}=t,o=[];o.push(n[0]);let u=n[1].x-n[0].x,d=n[1].y-n[0].y,c=l/Math.sqrt(u*u+d*d);o.push({x:n[0].x+u*c,y:n[0].y+d*c});let p=E4(o,!!a),g=ia(o[0].x-o[1].x),f=ia(o[0].y-o[1].y),m=aj.path(Object.assign({path:p,z:0,alpha:g>f?(n[1].x-n[0].x>0?-1:1)*ie/2:0,beta:g<f?-ie/2:0,anchor3d:g>f?[o[0].x,0]:[0,o[0].y]},nx(s)?eF({},this.skipDefault?null:E6.defaultAttributes.style,s(t,i)):s));m.name=`${h}-line`,m.id=this._getNodeId(`${h}-path-${r}`),e.add(m)}),n.length>1&&o){let t=eM(o)?o:[o,"transparent"],r=e=>t[e%t.length];for(let t=0;t<n.length-1;t++){let[s,a]=[n[t].points,n[t+1].points],o=function(t,e,i){let{type:r,closed:n}=i,s=e.slice(0).reverse(),a="",o="";if("line"===r&&i.smoothLink&&i.center){let e=t[0],r=s[0],l=i.center;a=E4(t,!!n),o=E4(s,!!n);let h=iG.distancePP(r,l),u=iG.distancePP(e,l);a+=`A${h},${h},0,0,1,${r.x},${r.y}L${r.x},${r.y}`,o+=`A${u},${u},0,0,0,${e.x},${e.y}`}else if("circle"===r){let{center:e}=i;a=E8(e,t,!1,!!n),o=E8(e,s,!0,!!n)}else"line"!==r&&"polygon"!==r||(a=E4(t,!!n),o=E4(s,!!n));return n?a+=o:a+=(o="L"+o.substring(1))+"Z",a}(s,a,i),l=aj.path({path:o,fill:r(t)});l.name=`${h}-region`,l.id=this._getNodeId(`${h}-region-${t}`),e.add(l)}}}_getNodeId(t){return`${this.id}-${t}`}release(){super.release(),this._prevInnerView=null,this._innerView=null}}E6.defaultAttributes={style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]}}};v8(),kU();class E9 extends E6{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},E6.defaultAttributes,t),e)}_getGridPoint(t,e){let i;if("line"===t){let{length:t}=this.attribute;i=[e,this.getVerticalCoord(e,t,!0)]}else if("circle"===t||"polygon"===t){let{center:t,sides:r=6,startAngle:n=MS,endAngle:s=Mk}=this.attribute;i=function(t,e,i,r,n){let s=[],a=n-r;for(let n=0;n<e;n++){let o=r+n*a/e;s.push(iM(t,i,o))}return s}(t,r,iG.distancePP(t,e),n,s)}return i}getGridAttribute(t){let e;let{type:i,alignWithLabel:r=!0}=this.attribute,n=1;this.data.length>=2&&(n=this.data[1].value-this.data[0].value);let s=[];if(t){e=eF({},this.attribute,this.attribute.subGrid);let t=[],{count:a=4}=this.attribute.subGrid||{};if(this.data.length>=2){let e=[];this.data.forEach(t=>{let i=t.value;if(!r){let e=t.value-n/2;if(this.isInValidValue(e))return;i=e}e.push({value:i})});for(let r=0;r<e.length-1;r++){let n=e[r],s=e[r+1];t.push({id:`sub-${r}-0`,points:this._getGridPoint(i,this.getTickCoord(n.value)),datum:{}});for(let e=0;e<a;e++){let o=(e+1)/(a+1),l=(1-o)*n.value+o*s.value,h=this.getTickCoord(l);t.push({id:`sub-${r}-${e+1}`,points:this._getGridPoint(i,h),datum:{}})}r===e.length-2&&t.push({id:`sub-${r}-${a+1}`,points:this._getGridPoint(i,this.getTickCoord(s.value)),datum:{}})}s=t}}else{e=this.attribute;let t=[];this.data.forEach(e=>{let{point:s}=e;if(!r){let t=e.value-n/2;if(this.isInValidValue(t))return;s=this.getTickCoord(t)}t.push({id:e.label,datum:e,points:this._getGridPoint(i,s)})}),s=t}return Object.assign(Object.assign({},e),{items:s})}}CS(E9,EP);var E7=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};v8(),kU();class Ot extends E6{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},E6.defaultAttributes,t),e)}getGridAttribute(t){let e,i=[],r=this.attribute,{radius:n,innerRadius:s=0,startAngle:a=MS,endAngle:o=Mk,center:l,subGrid:h}=r,u=E7(r,["radius","innerRadius","startAngle","endAngle","center","subGrid"]),{alignWithLabel:d=!0}=u||{},c=n-s,p=1;if(this.data.length>=2&&(p=this.data[1].value-this.data[0].value),t){e=eF({},u,h);let t=[],{count:r=4}=h||{},n=this.data.length;if(n>=2){let e=[];this.data.forEach(t=>{let i=t.value;if(!d){let e=t.value-p/2;if(this.isInValidValue(e))return;i=e}e.push({value:i})});for(let i=0;i<n;i++){let n=e[i],s=e[i+1];t.push({id:`sub-${i}-0`,points:[this.getTickCoord(n.value),this.getVerticalCoord(this.getTickCoord(n.value),c,!0)],datum:{}});for(let e=0;e<r;e++){let a=(e+1)/(r+1),o=(1-a)*n.value+a*(s?s.value:d?1:n.value+p),l=this.getTickCoord(o),h=this.getVerticalCoord(l,c,!0);t.push({id:`sub-${i}-${e+1}`,points:[l,h],datum:{}})}}Math.abs(o-a)%(2*Math.PI)==0&&t.push(t[0]),i=t}}else{e=u;let t=[];(Math.abs(o-a)%(2*Math.PI)==0?[...this.data].concat(this.data[0]):this.data).forEach(e=>{let{point:i}=e;if(!d){let t=e.value-p/2;if(this.isInValidValue(t))return;i=this.getTickCoord(t)}let r=this.getVerticalCoord(i,c,!0);t.push({id:e.id,points:[i,r],datum:e})}),i=t}return Object.assign(Object.assign({},e),{items:i,center:l,type:"line"})}}CS(Ot,EX);let Oe=(t,e,i,r)=>{var n,s,a,o;let l=null!==(s=null===(n=null==e?void 0:e.components)||void 0===n?void 0:n.grid)&&void 0!==s?s:{};return t?eF({},l,{items:(null!==(o=null===(a=t.tickData)||void 0===a?void 0:a.call(t,r))&&void 0!==o?o:[]).map(t=>({id:t.index,label:t.tick,value:t.value,rawValue:t.tick}))},null!=i?i:{}):eF({},l,null!=i?i:{})},Oi=(t,e,i,r)=>{var n,s,a,o;let l=null!==(s=null===(n=null==e?void 0:e.components)||void 0===n?void 0:n.circleGrid)&&void 0!==s?s:{};return t?eF({},l,{items:(null!==(o=null===(a=t.tickData)||void 0===a?void 0:a.call(t,r))&&void 0!==o?o:[]).map(t=>({id:t.index,label:t.tick,value:t.value,rawValue:t.tick}))},null!=i?i:{}):eF({},l,null!=i?i:{})};class Or extends EQ{constructor(t,e,i){super(t,c6.grid,e),this.spec.componentType=c6.grid,this.mode=i}parseAddition(t){return super.parseAddition(t),this.target(t.target),this.gridType(t.gridType),this.gridShape(t.gridShape),this}scale(t){return super.scale(t),this._gridComponentType=null,this}gridType(t){return this.spec.gridType=t,this._gridComponentType=null,this._prepareRejoin(),this.commit(),this}gridShape(t){return this.spec.gridShape=t,this.commit(),this}target(t){if(this.spec.target){let t=eE(this.spec.target)?this.view.getMarkById(this.spec.target):this.spec.target;this.detach(t)}this.spec.target=t;let e=eE(t)?this.view.getMarkById(t):t;return this.attach(e),this._targetAxis=e,this._gridComponentType=null,this._updateComponentEncoders(),this.commit(),this}tickCount(t){let e=eE(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;return e&&e.tickCount(t),this.setFunctionSpec(t,"tickCount")}inside(t){return this.setFunctionSpec(t,"inside")}baseValue(t){return this.setFunctionSpec(t,"baseValue")}addGraphicItem(t,e){let i=eF({x:0,y:0,start:{x:0,y:0},end:{x:0,y:0}},t),r=d0.createGraphicComponent(this._getGridComponentType(),i,{mode:this.mode,skipDefault:this.spec.skipTheme});return super.addGraphicItem(i,e,r)}_updateComponentEncoders(){let t=Object.assign({update:{}},this.spec.encode),e=Object.keys(t).reduce((e,i)=>{let r=t[i];return r&&(e[i]={callback:(t,e,i)=>{var n,s,a,o;let l=this.spec.skipTheme?null:this.view.getCurrentTheme(),h,u=mE(r,t,e,i),d=gN(this.spec.baseValue,i,t,e);if(this._targetAxis){let t=null===(n=this._targetAxis.getSpec())||void 0===n?void 0:n.scale;h=eE(t)?this.view.getScaleById(t):t;let e=this._targetAxis.elements[0];if(e)switch(this._getGridComponentType()){case pt.lineAxisGrid:u=Object.assign({x:e.getGraphicAttribute("x"),y:e.getGraphicAttribute("y"),start:e.getGraphicAttribute("start"),end:e.getGraphicAttribute("end"),verticalFactor:null!==(s=e.getGraphicAttribute("verticalFactor"))&&void 0!==s?s:1},u);break;case pt.circleAxisGrid:u=Object.assign({x:e.getGraphicAttribute("x"),y:e.getGraphicAttribute("y"),center:e.getGraphicAttribute("center"),radius:e.getGraphicAttribute("radius"),innerRadius:e.getGraphicAttribute("innerRadius"),inside:e.getGraphicAttribute("inside"),startAngle:e.getGraphicAttribute("startAngle"),endAngle:e.getGraphicAttribute("endAngle")},u)}}else{h=eE(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;let r=gN(this.spec.inside,i,t,e),n=null===(a=null==h?void 0:h.getCoordinate)||void 0===a?void 0:a.call(h);n&&(u=Object.assign(E2(h,n,r,d,this.spec.layout,!0),u))}this._getGridComponentType()===pt.lineAxisGrid&&(u="line"!==this.spec.gridShape&&this.spec.gridShape?Object.assign({center:u.start,closed:!0},u,{type:this.spec.gridShape}):Object.assign({},u,{type:"line"}));let c=null===(o=null==h?void 0:h.getScale)||void 0===o?void 0:o.call(h),p=gN(this.spec.tickCount,i,t,e);switch(this._getGridComponentType()){case pt.lineAxisGrid:return Oe(c,l,u,p);case pt.circleAxisGrid:return Oi(c,l,u,p)}return u}}),e},{});this._encoders=e}_getGridComponentType(){var t;if(this._gridComponentType)return this._gridComponentType;if(this.spec.gridType)"circle"===this.spec.gridType?this._gridComponentType=pt.circleAxisGrid:this._gridComponentType=pt.lineAxisGrid;else if(this._targetAxis)switch(this._targetAxis.getAxisComponentType()){case c7.circleAxis:this._gridComponentType=pt.circleAxisGrid;break;case c7.lineAxis:default:this._gridComponentType=pt.lineAxisGrid}else if(this.spec.scale){let e=eE(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;this._gridComponentType=(null===(t=null==e?void 0:e.getCoordinate)||void 0===t?void 0:t.call(e))?e.getCoordinateAxisPoints()?pt.lineAxisGrid:pt.circleAxisGrid:pt.lineAxisGrid}else this._gridComponentType=pt.lineAxisGrid;return this._gridComponentType}}Or.componentType=c6.grid;let On=()=>{d0.registerGraphicComponent(pt.lineAxisGrid,(t,e)=>new E9(t,e)),d0.registerGraphicComponent(pt.circleAxisGrid,(t,e)=>new Ot(t,e)),d0.registerComponent(c6.grid,Or)};class Os extends Sd{constructor(t,e){super(t,e),this.type="component",this._componentType=e.componentType,this._mode=e.mode}_initProduct(t){let e=this.getVGrammarView(),i=this.getProductId();this._product=e.mark(c8.component,null!=t?t:e.rootMark,{componentType:this._componentType,mode:this._mode}).id(i),this._compiledProductId=i}}Os.type="component";let Oa=()=>{de.registerMark(Os.type,Os)};class Oo extends nT{constructor(t,e,i,r){super(null,null,i,r)}getEndProps(){return{}}onBind(){this.target.setTheme({common:{opacity:0}})}onEnd(){this.target.setTheme({common:{opacity:1}})}onUpdate(t,e,i){this.target.setTheme({common:{opacity:e}})}}class Ol extends nT{constructor(){super(...arguments),this.mode=lC.NORMAL}onBind(){let t=this.target.getInnerView(),e=this.target.getPrevInnerView();e&&(this._newElementAttrMap={},Tf(t,t=>{var i,r,n,s,a,o;if("group"!==t.type&&t.id){let l=e[t.id];if(l){if(!my(t.attribute,l.attribute)){let e=eP(t.attribute);this._newElementAttrMap[t.id]={state:"update",node:t,attrs:Object.assign(Object.assign({},e),{opacity:null!==(i=e.opacity)&&void 0!==i?i:1,fillOpacity:null!==(r=e.fillOpacity)&&void 0!==r?r:1,strokeOpacity:null!==(n=e.strokeOpacity)&&void 0!==n?n:1})},t.setAttributes(l.attribute)}}else{let e={opacity:null!==(s=t.attribute.opacity)&&void 0!==s?s:1,fillOpacity:null!==(a=t.attribute.fillOpacity)&&void 0!==a?a:1,strokeOpacity:null!==(o=t.attribute.strokeOpacity)&&void 0!==o?o:1};this._newElementAttrMap[t.id]={state:"enter",node:t,attrs:e},t.setAttributes({opacity:0,fillOpacity:0,strokeOpacity:0})}}}))}onStart(){let t=this.duration,e=this.easing;Object.keys(this._newElementAttrMap).forEach(i=>{var r;let{node:n,attrs:s,state:a}=this._newElementAttrMap[i];if("enter"===a){let{enter:i={}}=null!==(r=this.params)&&void 0!==r?r:{};t=l1(i.duration)?i.duration:t,e=i.easing?i.easing:e}"path"===n.type?n.animate({interpolate:(t,e,i,r,n)=>"path"===t&&(n.path=(function(t,e){var i,r;let n,s,a,o=xZ.lastIndex=xX.lastIndex=0,l=-1,h=[],u=[];for(t+="",e+="";(n=xZ.exec(t))&&(s=xX.exec(e));)(a=s.index)>o&&(a=e.slice(o,a),h[l]?h[l]+=a:h[++l]=a),(n=n[0])===(s=s[0])?h[l]?h[l]+=s:h[++l]=s:(h[++l]=null,u.push({i:l,x:xY(n,s)})),o=xX.lastIndex;return o<e.length&&(a=e.slice(o),h[l]?h[l]+=a:h[++l]=a),h.length<2?u[0]?(i=u[0].x,function(t){return i(t)+""}):(r=e,function(){return r}):(e=u.length,function(t){for(let i,r=0;r<e;++r)h[(i=u[r]).i]=i.x(t);return h.join("")})})(i,r)(e),!0)}).to(s,t,e):n.animate().to(s,t,e)})}onUpdate(t,e,i){}}let Oh=t=>t;var Ou=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Od extends Ea{getOrient(){return this._orient}getScale(){return this._scale}getScales(){return this._scales}getTickData(t=0){return this._tickData[t]}get visible(){return this._visible}getInverse(){return this._inverse}getCoordinateType(){return this._coordinateType}constructor(t,e){var i;super(t,e),this.specKey="axes",this._scales=[],this._tickData=[],this._visible=!0,this._tick=void 0,this._visible=null===(i=t.visible)||void 0===i||i,this._coordinateType="none"}_getNeedClearVRenderComponents(){return[]}getVRenderComponents(){var t,e;return om(null===(e=null===(t=this._axisMark)||void 0===t?void 0:t.getProduct())||void 0===e?void 0:e.getGroupGraphicItem())}created(){var t,e,i,r,n,s,a,o,l,h,u,d,c,p,g,f,m;if(super.created(),this.setSeriesAndRegionsFromSpec(),this.initEvent(),this.initScales(),this.updateSeriesScale(),this._shouldComputeTickData()&&this._initData(),this._visible){let v=this._createMark({type:"component",name:`axis-${this.getOrient()}`},{componentType:"angle"===this.getOrient()?"circleAxis":"axis",mode:this._spec.mode,noSeparateStyle:!0,skipTheme:!0});if(this._axisMark=v,v.setZIndex(this.layoutZIndex),eO(this._spec.id)&&v.setUserId(this._spec.id),this._marks.addMark(v),null===(t=this._spec.grid)||void 0===t?void 0:t.visible){let t=this._createMark({type:"component",name:`axis-${this.getOrient()}-grid`},{componentType:"angle"===this.getOrient()?pt.circleAxisGrid:pt.lineAxisGrid,mode:this._spec.mode,noSeparateStyle:!0,skipTheme:!0});t.setZIndex(null!==(s=null!==(r=null===(i=null===(e=this._spec.grid)||void 0===e?void 0:e.style)||void 0===i?void 0:i.zIndex)&&void 0!==r?r:null===(n=this._spec.grid)||void 0===n?void 0:n.zIndex)&&void 0!==s?s:tM.Axis_Grid),t.setInteractive(!1),this._marks.addMark(t),this._gridMark=t}if(ew(this._spec.interactive)&&this._marks.forEach(t=>t.setInteractive(this._spec.interactive)),!1!==this._option.animation&&!1!==dq(this._option.getChart().getSpec(),"animation")&&!0===this._spec.animation){let t=CX(null===(a=de.getAnimationInKey("axis"))||void 0===a?void 0:a(),{appear:null!==(l=null!==(o=this._spec.animationAppear)&&void 0!==o?o:dq(this._option.getChart().getSpec(),"animationAppear.axis"))&&void 0!==l?l:dq(this._option.getChart().getSpec(),"animationAppear"),disappear:null!==(u=null!==(h=this._spec.animationDisappear)&&void 0!==h?h:dq(this._option.getChart().getSpec(),"animationDisappear.axis"))&&void 0!==u?u:dq(this._option.getChart().getSpec(),"animationDisappear"),enter:null!==(c=null!==(d=this._spec.animationEnter)&&void 0!==d?d:dq(this._option.getChart().getSpec(),"animationEnter.axis"))&&void 0!==c?c:dq(this._option.getChart().getSpec(),"animationEnter"),exit:null!==(g=null!==(p=this._spec.animationExit)&&void 0!==p?p:dq(this._option.getChart().getSpec(),"animationExit.axis"))&&void 0!==g?g:dq(this._option.getChart().getSpec(),"animationExit"),update:null!==(m=null!==(f=this._spec.animationUpdate)&&void 0!==f?f:dq(this._option.getChart().getSpec(),"animationUpdate.axis"))&&void 0!==m?m:dq(this._option.getChart().getSpec(),"animationUpdate")});t.enter&&(t.update[0].customParameters={enter:t.enter[0]}),this._marks.forEach(e=>e.setAnimationConfig(t))}}}_shouldComputeTickData(){return this.getVisible()||this._spec.forceInitTick}_initData(){let t=this._initTickDataSet(this._tickTransformOption());t.target.addListener("change",this._forceLayout.bind(this)),this._tickData=[new Sa(this._option,t)]}collectData(t,e){let i=[];return dC(this._regions,r=>{var n;let s=this.collectSeriesField(t,r);if(s=eM(s)?dr(this._scale.type)?s:[s[0]]:[s],t||(this._dataFieldText=r.getFieldAlias(s[0])),s){let t=r.getViewData();if(e)s.forEach(t=>{i.push(r.getRawDataStatisticsByField(t,!1))});else if(t&&t.latestData&&t.latestData.length){let t=null===(n=r.getViewDataStatistics)||void 0===n?void 0:n.call(r);s.forEach(e=>{var r;(null===(r=null==t?void 0:t.latestData)||void 0===r?void 0:r[e])&&i.push(t.latestData[e])})}}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),i}isSeriesDataEnable(){let t=!0;return dC(this._regions,e=>{var i;eM(null===(i=e.getViewDataStatistics())||void 0===i?void 0:i.latestData)&&(t=!1)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),t}setSeriesAndRegionsFromSpec(){let{seriesId:t,seriesIndex:e,regionId:i,regionIndex:r}=this._spec;eO(t)&&(this._seriesUserId=om(t)),eO(i)&&(this._regionUserId=om(i)),eO(e)&&(this._seriesIndex=om(e)),eO(r)&&(this._regionIndex=om(r)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionIndex),this.layout.layoutBindRegionID=this._regions.map(t=>t.id)}getBindSeriesFilter(){return{userId:this._seriesUserId,specIndex:this._seriesIndex}}initEvent(){this.event.on(c1.scaleUpdate,{filter:({model:t})=>(null==t?void 0:t.id)===this.id},this.effect.scaleUpdate.bind(this));let t=dT(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}).map(t=>t.getViewDataStatistics()).filter(t=>!!t);t.length>1?this._option.dataSet.multipleDataViewAddListener(t,"change",()=>{this.updateScaleDomain()}):1===t.length&&t[0].target.addListener("change",()=>{this.updateScaleDomain()}),dC(this._regions,t=>{t.event.on(c1.rawDataUpdate,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>{this._clearRawDomain()})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}updateScaleDomain(){}_clearRawDomain(){}onLayoutEnd(t){this.updateScaleRange(),this.event.emit(c1.scaleUpdate,{model:this,value:"range"}),super.onLayoutEnd(t)}computeData(t){!this._tickData||!this._tickData.length||"force"!==t&&my(this._scale.range(),[0,1])||this._tickData.forEach(t=>{t.getDataView().reRunAllTransform(),t.updateData()})}initScales(){this._scales=[this._scale];let t=[];if(dC(this._regions,e=>{let i=e.getGroups();i&&t.push(i)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),0!==t.length){let e=oy(t.map(t=>t.fields.length));for(let t=1;t<e;t++){let t=this._scale.clone();this._scales.push(t)}}}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||(i.reRender=!0,(null==e?void 0:e.type)!==(null==t?void 0:t.type)?i.reMake=!0:i.reMake=["grid","subGrid","tick","subTick","label","domainLine","title"].some(i=>{var r,n;return(null===(r=null==e?void 0:e[i])||void 0===r?void 0:r.visible)!==(null===(n=null==t?void 0:t[i])||void 0===n?void 0:n.visible)})),i}_delegateAxisContainerEvent(t){0===t.listenerCount("*")&&t.addEventListener("*",(e,i)=>this._delegateEvent(t,e,i))}_getAxisAttributes(){var t;let e=this._spec,i={orient:this.getOrient(),select:!0!==this._option.disableTriggerEvent&&e.select,hover:!0!==this._option.disableTriggerEvent&&e.hover};if(e.domainLine&&e.domainLine.visible?i.line=((t=TF(t=e.domainLine)).startSymbol=TF(t.startSymbol),t.endSymbol=TF(t.endSymbol),t):i.line={visible:!1},e.label&&e.label.visible){let t=Eo(e.label,["style","formatMethod","state"]);i.label=t,e.label.style&&(i.label.style=nx(e.label.style)?(t,i,r,n)=>{var s;let a=e.label.style(t.rawValue,i,t,r,n);return Tz(us({},null===(s=this._theme.label)||void 0===s?void 0:s.style,a))}:Tz(e.label.style)),(e.label.formatMethod||e.label.formatter)&&(i.label.formatMethod=this._getLabelFormatMethod()),e.label.state&&(i.label.state=function(t){if(mk(t))return null;let e={};return Object.keys(t).forEach(i=>{nx(t[i])?e[i]=(e,r,n,s)=>Tz(t[i](e.rawValue,r,e,n,s)):mk(t[i])||(e[i]=Tz(t[i]))}),e}(e.label.state))}else i.label={visible:!1};if(e.tick&&e.tick.visible?(i.tick={visible:e.tick.visible,length:e.tick.tickSize,inside:e.tick.inside,alignWithLabel:e.tick.alignWithLabel,dataFilter:e.tick.dataFilter},e.tick.style&&(i.tick.style=nx(e.tick.style)?(t,i,r,n)=>{var s;let a=e.tick.style(t,i,r,n);return Tz(us({},null===(s=this._theme.tick)||void 0===s?void 0:s.style,a))}:Tz(e.tick.style)),e.tick.state&&(i.tick.state=Tj(e.tick.state))):i.tick={visible:!1},e.subTick&&e.subTick.visible?(i.subTick={visible:e.subTick.visible,length:e.subTick.tickSize,inside:e.subTick.inside,count:e.subTick.tickCount},e.subTick.style&&(i.subTick.style=nx(e.subTick.style)?(t,i,r,n)=>{var s;let a=e.subTick.style(t,i,r,n);return Tz(us({},null===(s=this._theme.subTick)||void 0===s?void 0:s.style,a))}:Tz(e.subTick.style)),e.subTick.state&&(i.subTick.state=Tj(e.subTick.state))):i.subTick={visible:!1},e.title&&e.title.visible){let t=e.title,{autoRotate:r,angle:n,style:s={},background:a,state:o,shape:l}=t,h=Ou(t,["autoRotate","angle","style","background","state","shape"]),u,d=n;"left"!==e.orient&&"right"!==e.orient||r&&ej(d)&&(d="left"===e.orient?-90:90,u=TW[e.orient]),i.title=Object.assign(Object.assign({},h),{autoRotate:!1,angle:d?ik(d):null,textStyle:us({},u,Tz(s)),pickable:!1!==s.pickable,childrenPickable:!1!==s.pickable,state:{}}),l&&l.visible?(i.title.shape=Object.assign(Object.assign({},l),{style:Tz(l.style)}),l.state&&(i.title.state.shape=Tj(l.state))):i.title.shape={visible:!1},a&&a.visible?(i.title.background=Object.assign(Object.assign({},a),{style:Tz(a.style)}),a.state&&(i.title.state.background=Tj(a.state))):i.title.background={visible:!1},o&&(i.title.state.text=Tj(o))}else i.title={visible:!1};return e.background&&e.background.visible?(i.panel={visible:!0},e.background.style&&(i.panel.style=Tz(e.background.style)),e.background.state&&(i.panel.state=Tj(e.background.state))):i.panel={visible:!1},i}_getGridAttributes(){let t=this._spec;return{alternateColor:t.grid.alternateColor,alignWithLabel:t.grid.alignWithLabel,style:nx(t.grid.style)?()=>(e,i)=>{var r,n;let s=t.grid.style(null===(r=e.datum)||void 0===r?void 0:r.rawValue,i,e.datum);return Tz(us({},null===(n=this._theme.grid)||void 0===n?void 0:n.style,s))}:Tz(t.grid.style),subGrid:!1===t.subGrid.visible?{visible:!1}:{type:"line",visible:t.subGrid.visible,alternateColor:t.subGrid.alternateColor,style:Tz(t.subGrid.style)}}}_getLabelFormatMethod(){let{formatMethod:t,formatter:e}=this._spec.label,{formatFunc:i}=TV(t,e);return i?(t,r,n)=>i(r.rawValue,r,e):null}_initTickDataSet(t,e=0){return gM(this._option.dataSet,"scale",Oh),gw(this._option.dataSet,"ticks",T6),new eH(this._option.dataSet,{name:`${this.type}_${this.id}_ticks_${e}`}).parse(this._scales[e],{type:"scale"}).transform({type:"ticks",options:t},!1)}_tickTransformOption(){let t=this._tick||{},e=this._spec.label||{},{tickCount:i,forceTickCount:r,tickStep:n,tickMode:s}=t,{style:a,formatMethod:o,minGap:l}=e;return{sampling:!1!==this._spec.sampling,tickCount:i,forceTickCount:r,tickStep:n,tickMode:s,axisOrientType:this._orient,coordinateType:this._coordinateType,labelStyle:a,labelFormatter:o,labelGap:l}}addTransformToTickData(t,e){this._tickData.forEach(i=>{var r;null===(r=null==i?void 0:i.getDataView())||void 0===r||r.transform(t,e)})}dataToPosition(t){return this._scale.scale(t)}}Od.specKey="axes";let Oc=()=>{E5(),On(),Oa(),de.registerAnimation("axis",()=>({appear:{custom:Oo},update:{custom:Ol},exit:{custom:mZ}}))};var Op=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let Og=[TD];class Of extends Od{getOrient(){return this._orient}set autoIndentOnce(t){this._autoIndentOnce=t}getScales(){return this._scales}constructor(t,e){super(t,e),this.type=lx.cartesianAxis,this.name=lx.cartesianAxis,this._defaultBandPosition=.5,this._defaultBandInnerPadding=.1,this._defaultBandOuterPadding=.3,this.layoutType="region-relative",this.layoutZIndex=tM.Axis,this.layoutLevel=tC.Axis,this._orient="left",this._autoIndentOnce=!1,this._hasAutoIndent=!1,this._scales=[],this._tick=void 0,this._layoutCache={width:0,height:0,_lastComputeOutBounds:{x1:0,x2:0,y1:0,y2:0}},this._innerOffset={top:0,bottom:0,left:0,right:0},this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),dC(this._regions,t=>{let e=this.getOrient();dR(e)?t.setXAxisHelper(this.axisHelper()):dB(e)?t.setYAxisHelper(this.axisHelper()):dI(e)&&t.setZAxisHelper(this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._transformLayoutPosition=t=>{let{x:e,y:i}=t;return l1(e)&&(e+=Number("left"===this._orient)*this.getLayoutRect().width),l1(i)&&(i+=Number("top"===this._orient)*this.getLayoutRect().height),{x:e,y:i}},this._transformLayoutRect=t=>{if(!this._visible)return t;let e=this._latestBounds.clone().translate(-this.getLayoutStartPoint().x,-this.getLayoutStartPoint().y);switch(this._layout.layoutOrient){case"left":0===this._layout.layoutRectLevelMap.width&&(t.width=e.x1<0?-e.x1:0);break;case"right":0===this._layout.layoutRectLevelMap.width&&(t.width=e.x2>0?e.x2:0);break;case"top":0===this._layout.layoutRectLevelMap.height&&(t.height=e.y1<0?-e.y1:0);break;case"bottom":0===this._layout.layoutRectLevelMap.height&&(t.height=e.y2>0?e.y2:0)}return t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),this._layout.setRectInSpec(this._layoutCacheProcessing(t))},this._updateAxisLayout=()=>{let t=this.getLayoutStartPoint(),e=this._getUpdateAttribute(!1),{grid:i}=e,r=Op(e,["grid"]),n=this._axisMark.getProduct(),s=us({x:t.x,y:t.y},this._axisStyle,r);n.encode(s),this._gridMark&&this._gridMark.getProduct().encode(us({x:t.x,y:t.y},this._getGridAttributes(),i))},this._fixAxisOnZero=()=>{let{onZero:t,visible:e}=this._spec.domainLine;if(this.visible&&t&&!1!==e){let{onZeroAxisId:t,onZeroAxisIndex:e}=this._spec.domainLine,i=this._option.getComponentsByKey("axes"),r=dR(this.getOrient()),n=t=>{var e;return(r?!dR(t.getOrient()):dR(t.getOrient()))&&dr(t.getScale().type)&&(t.getTickData()?null===(e=t.getTickData().getLatestData())||void 0===e?void 0:e.find(t=>0===t.value):t.getScale().domain()[0]<=0&&t.getScale().domain()[1]>=0)},s=i.filter(t=>n(t));if(s.length){let a;if(eO(t))a=s.find(e=>e.id===t);else if(eO(e)){let t=i[e];n(t)&&(a=t)}else a=s[0];if(a){let t=this._axisMark.getProduct(),e=a.valueToPosition(0);r?t.encode({line:Object.assign(Object.assign({},this._axisStyle.line),{dy:"bottom"===this._orient?-(a.getScale().range()[0]-e):e})}):t.encode({line:Object.assign(Object.assign({},this._axisStyle.line),{dx:"left"===this._orient?e:-(a.getScale().range()[1]-e)})})}}}},this._orient=dL(t,["z"]),dI(this._orient)&&(this.layoutType="absolute"),this._dataSet=e.dataSet,this._coordinateType="cartesian"}static getSpecInfo(t){let e=t[this.specKey];if(!e)return null;let i="horizontal"===t.direction;if(!eM(e)){if(!T$(e))return null;let{axisType:t,componentName:r}=dF(e,i);return e.type=t,[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:r}]}let r=!0;if(e.filter(t=>"z"===t.orient)[0]){let t=e.filter(t=>"bottom"===t.orient)[0],i=e.filter(t=>dB(t.orient))[0];r=3===e.length&&t&&i}let n=e.map((t,e)=>({spec:t,index:e}));r||(n=n.filter(({spec:t})=>"z"!==t.orient));let s=[];return n.forEach(({spec:t,index:e})=>{if(!T$(t))return;let{axisType:r,componentName:n}=dF(t,i);t.type=r,s.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:n})}),s}static createComponent(t,e){let{spec:i}=t,r=Op(t,["spec"]),n=de.getComponentInKey(r.type);return n?new n(i,Object.assign(Object.assign({},e),r)):(e.onError(`Component ${r.type} not found`),null)}initLayout(){super.initLayout(),this._layout.autoIndent=!1!==this._spec.autoIndent,this._layout.layoutOrient=this._orient}setLayout3dBox(t){this.layout3dBox=t}updateScaleRange(){let t=!1,{width:e,height:i}=this.getLayoutRect(),{left:r,right:n,top:s,bottom:a}=this._innerOffset,o=[];dR(this.getOrient())?l1(e)&&(o=this._inverse?[e-n,r]:[r,e-n]):dI(this.getOrient())?l1(e)&&(o=this._inverse?[e-n,r]:[r,e-n],this._scale.range(o)):l1(i)&&(o=this._inverse?[s,i-a]:[i-a,s]);let[l,h]=this._scale.range();return o[0]===l&&o[1]===h||(t=!0,this._scale.range(o)),t}init(t){var e;super.init(t),null===(e=this.pluginService)||void 0===e||e.load(Og.map(t=>new t)),this.callPlugin(t=>{this.pluginService&&t.onInit&&t.onInit(this.pluginService,this)})}setAttrFromSpec(){var t,e,i;let r;if(super.setAttrFromSpec(),this.visible){dR(this.getOrient())?fk(this._spec.maxHeight)&&(this._spec.maxHeight="30%"):fk(this._spec.maxWidth)&&(this._spec.maxWidth="30%");let t=this._getAxisAttributes();t.label.formatMethod=this._getLabelFormatMethod(),t.verticalFactor="top"===this.getOrient()||"right"===this.getOrient()?-1:1,this._axisStyle=t}this._tick=this._spec.tick;let n=null===(t=this._option.getChart())||void 0===t?void 0:t.getSpec();this._inverse=(e=this._spec,i="horizontal"===(null==n?void 0:n.direction),r=e.inverse,i&&!dR(e.orient)&&(r=!eO(e.inverse)||!e.inverse),r)}onLayoutStart(t,e,i){if(super.onLayoutStart(t,e,i),!dI(this.getOrient())&&this._spec.innerOffset){let t=this._spec;dB(this.getOrient())?["top","bottom"].forEach(i=>{this._innerOffset[i]=ht(t.innerOffset[i],e.height,e)}):["left","right"].forEach(i=>{this._innerOffset[i]=ht(t.innerOffset[i],e.width,e)})}}getSeriesStatisticsField(t){let e;return e=dR(this.getOrient())?t.fieldX:dI(this.getOrient())?t.fieldZ:t.fieldY,dr(this._scale.type)?e:[e[0]]}_tickTransformOption(){var t,e,i;return Object.assign(Object.assign({},super._tickTransformOption()),{noDecimals:null===(t=this._tick)||void 0===t?void 0:t.noDecimals,labelLastVisible:null===(e=this._spec.label)||void 0===e?void 0:e.lastVisible,labelFlush:null===(i=this._spec.label)||void 0===i?void 0:i.flush})}axisHelper(){return{isContinuous:dr(this._scale.type),dataToPosition:this.dataToPosition.bind(this),getScale:(t=0)=>this._scales[t],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!0===this._inverse,getSpec:()=>this._spec}}afterCompile(){var t;let e=null===(t=this._axisMark)||void 0===t?void 0:t.getProduct();e&&e.addEventListener(pa.AFTER_ELEMENT_ENCODE,()=>{if(!1===this._isLayout&&(dR(this.getOrient())?this.callPlugin(t=>{this.pluginService&&t.onDidLayoutHorizontal&&t.onDidLayoutHorizontal(this.pluginService,this)}):this.callPlugin(t=>{this.pluginService&&t.onDidLayoutVertical&&t.onDidLayoutVertical(this.pluginService,this)}),this._delegateAxisContainerEvent(e.getGroupGraphicItem()),this._unitText)){let{x:t,y:e}=this.getLayoutStartPoint(),i=dR(this._orient)?{x:oy(this._scale.range())+t,y:e}:{x:t,y:o_(this._scale.range())+e};this._unitText.setAttributes(i)}}),this.callPlugin(t=>{this.pluginService&&t.onDidCompile&&t.onDidCompile(this.pluginService,this)})}onRender(t){}changeRegions(t){}update(t){}resize(t){}collectScale(){let t=[];return dC(this._regions,e=>{t.push("left"===this.getOrient()||"right"===this.getOrient()?e.scaleY:e.scaleX)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),t}collectSeriesField(t,e){var i,r;let n;return t>0?null===(r=null===(i=e.getGroups())||void 0===i?void 0:i.fields)||void 0===r?void 0:r[t]:dR(this.getOrient())?e.getSpec().x2Field?[...e.fieldX,e.fieldX2]:e.fieldX:dI(this.getOrient())?e.fieldZ:e.getSpec().y2Field?[...e.fieldY,e.fieldY2]:e.fieldY}updateSeriesScale(){let t=this.getOrient();dC(this._regions,e=>{dR(t)?(e.setScaleX(this._scale),e.setXAxisHelper(this.axisHelper())):dB(t)?(e.setScaleY(this._scale),e.setYAxisHelper(this.axisHelper())):dI(t)&&(e.setScaleZ(this._scale),e.setZAxisHelper(this.axisHelper()))},{userId:this._seriesUserId,specIndex:this._seriesIndex})}getBoundsInRect(t){var e;let i={x1:0,y1:0,x2:0,y2:0};if(!this._visible)return i;this._verticalLimitSize=dR(this.getOrient())?t.height:t.width,this.setLayoutRect(t),!this.updateScaleRange()&&eM(null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData())||this.computeData("range");let r={skipLayout:!1},n=dR(this.getOrient());this.pluginService&&(n?this.callPlugin(t=>{t.onWillLayoutHorizontal&&t.onWillLayoutHorizontal(this.pluginService,r,this)}):this.callPlugin(t=>{t.onWillLayoutVertical&&t.onWillLayoutVertical(this.pluginService,r,this)}));let s=this._axisMark.getProduct(),a=!1;if(!r.skipLayout){let t=this._getUpdateAttribute(!0),e=s.getGroupGraphicItem(),r=us(Object.assign({},this.getLayoutStartPoint()),this._axisStyle,t,{line:{visible:!1}}),o=e.getBoundsWithoutRender(r);a=!0,this._latestBounds=o,isFinite(o.width())&&(i=this._appendAxisUnit(o,n))}return a||(this._latestBounds=s.getBounds()),i}_getTitleLimit(t){var e,i,r,n,s;if(this._spec.title.visible&&ej(null===(e=this._spec.title.style)||void 0===e?void 0:e.maxLineWidth)){let e=null!==(s=null!==(r=null===(i=this._axisStyle.title)||void 0===i?void 0:i.angle)&&void 0!==r?r:null===(n=this._spec.title.style)||void 0===n?void 0:n.angle)&&void 0!==s?s:0;if(t){let t=this.getLayoutRect().width,i=Math.abs(Math.cos(e));return i<1e-6?1/0:t/i}let a=this.getLayoutRect().height,o=Math.abs(Math.sin(e));return o<1e-6?1/0:a/o}return null}_getUpdateAttribute(t){var e;let i=0,r=0;if(!t){let t=this.getRegions(),{x:e,y:n}=t[0].getLayoutStartPoint(),s=e+t[0].getLayoutRect().width,a=n+t[0].getLayoutRect().height;for(let i=1;i<t.length;i++){let r=t[i],{x:o,y:l}=r.getLayoutStartPoint(),{width:h,height:u}=r.getLayoutRect();e=Math.min(e,o),s=Math.max(s,h+o),n=Math.min(n,l),a=Math.max(a,u+l)}i=Math.abs(a-n),r=Math.abs(s-e)}let{width:n,height:s}=this.getLayoutRect(),a=dR(this._orient),o=dB(this._orient),l=dI(this._orient),h={x:0,y:0},u=0,d=0,c=this.layout3dBox?this.layout3dBox.length:0;if(a?(h={x:n,y:0},u=i,d=n):o&&(h={x:0,y:s},u=r,d=s),l){let r=null!==(e=this.directionStr)&&void 0!==e?e:"r2l",s=this.layout3dBox?this.layout3dBox.width:0,o=[0,0],l=-Math.PI/2,h=0;"l2r"===r&&(h=this.layout3dBox.length,o=[0,0,0],l=Math.PI/2);let u=this.getLabelItems(n),d={start:{x:0,y:0},end:{x:c,y:0},z:h,alpha:l,anchor3d:o,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(a)},items:u};return t||(d.grid={type:"line",start:{x:0,y:0},end:{x:c,y:0},items:u[0],verticalFactor:this._axisStyle.verticalFactor,depth:s,length:i,z:h,alpha:l,anchor3d:o}),d}let p=a?this.layout.minHeight:this.layout.minWidth;(a&&9===this._layout.layoutRectLevelMap.height||o&&9===this._layout.layoutRectLevelMap.width)&&(p=this._verticalLimitSize);let g=this.getLabelItems(d),f={start:{x:0,y:0},end:h,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(a)},items:g,verticalLimitSize:this._verticalLimitSize,verticalMinSize:p};return t||(f.grid={type:"line",start:{x:0,y:0},end:h,items:g[0],verticalFactor:this._axisStyle.verticalFactor,depth:c,length:u}),f}getLabelItems(t){var e;let i=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();return i&&i.length?[i.map(e=>{let i=this._getNormalizedValue([e.value],t);return Tq(e.value,i)}).filter(t=>t.value>=0&&t.value<=1)]:[]}initEvent(){super.initEvent(),this.visible&&(this.event.on(c1.layoutEnd,this._updateAxisLayout),this.event.on(c1.layoutEnd,this._fixAxisOnZero),this.event.on(c1.layoutRectUpdate,()=>{this._clearLayoutCache()}))}_getNormalizedValue(t,e){return 0===e?0:this.dataToPosition(t)/e}_layoutCacheProcessing(t){return["width","height"].forEach(e=>{t[e]<this._layoutCache[e]?t[e]=this._layoutCache[e]:this._layoutCache[e]=t[e]}),this._autoIndentOnce&&this._hasAutoIndent?["x1","x2","y1","y2"].forEach(t=>{this.layout.getLastComputeOutBounds()[t]=this._layoutCache._lastComputeOutBounds[t]}):(this._hasAutoIndent=!0,["x1","x2","y1","y2"].forEach(t=>{this.layout.getLastComputeOutBounds()[t]<this._layoutCache._lastComputeOutBounds[t]?this.layout.getLastComputeOutBounds()[t]=this._layoutCache._lastComputeOutBounds[t]:this._layoutCache._lastComputeOutBounds[t]=this.layout.getLastComputeOutBounds()[t]})),t}_clearLayoutCache(){this._hasAutoIndent=!1,this._layoutCache.width=0,this._layoutCache.height=0,this._layoutCache._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0}}onDataUpdate(){this._clearLayoutCache()}_appendAxisUnit(t,e){var i;if(this._spec.unit&&this._spec.unit.visible){let r,n;let{text:s,style:a}=this._spec.unit,{x:o,y:l}=this.getLayoutStartPoint();e?(r={x:oy(this._scale.range())+o,y:l},n={textAlign:"left",textBaseline:"middle"}):(r={x:o,y:o_(this._scale.range())+l},n={textAlign:"left"===this._orient?"left":"right",textBaseline:"bottom"}),n=Object.assign(Object.assign(Object.assign({},n),a),{x:r.x,y:r.y,text:s}),this._unitText?this._unitText.setAttributes(n):(this._unitText=yt(n),this._unitText.name="axis-unit",null===(i=this.getContainer())||void 0===i||i.add(this._unitText));let h=this._unitText.AABBBounds;e?(t.x2+=h.x2>t.x2?h.x2-t.x2:0,t.y2+=h.y2>t.y2?h.y2-t.y2:0):(t.x1+=h.x1<t.x1?h.x1-t.x1:0,t.y1+=h.y1<t.y1?h.y1-t.y1:0)}return t}_getNeedClearVRenderComponents(){return this._unitText?[this._unitText]:[]}}Of.type=lx.cartesianAxis,Of.specKey="axes";class Om{constructor(){this._rawDomainIndex=[]}_initData(){var t;if(this._spec.showAllGroupLayers&&this._scales.length>1)for(let e=0;e<this._scales.length;e++){let i=(null!==(t=this._spec.layers)&&void 0!==t?t:[])[this._scales.length-1-e]||{};if(!1!==i.visible&&0!==i.tickCount&&0!==i.forceTickCount){let t=this._initTickDataSet(Object.assign(Object.assign({},this._tickTransformOption()),i),e);t.target.addListener("change",this._forceLayout.bind(this));let r=new Sa(this._option,t);this._tickData.push(r),this._tickDataMap||(this._tickDataMap={}),this._tickDataMap[e]=r}}else{let t=this._initTickDataSet(this._tickTransformOption());t.target.addListener("change",this._forceLayout.bind(this));let e=new Sa(this._option,t);this._tickData=[e],this._tickDataMap={0:e}}}dataToPosition(t,e={}){var i,r;if(0===t.length||0===this._scales.length)return 0;let{position:n,bandScale:s}=this.getPosition(t);return n+s.bandwidth()*(null!==(r=null!==(i=e.bandPosition)&&void 0!==i?i:this._spec.bandPosition)&&void 0!==r?r:this._defaultBandPosition)}valueToPosition(t){return this._scale.scale(t)}updateGroupScaleRange(){let t=this._scale;this._scales.forEach((e,i)=>{i>0&&(e.range([0,t.bandwidth()]),t=e)})}getPosition(t){let e=0,i=this._scale;if(1===this._scales.length||1===t.length)e=this.valueToPosition(t[0]);else{let r=Math.min(t.length,this._scales.length);for(let i=0;i<r;i++)e+=this._scales[i].scale(t[i]);i=this._scales[r-1]}return{position:e,bandScale:i}}calcScales(t,e){var i,r;let{bandPadding:n,paddingInner:s,paddingOuter:a}=this._spec,o=eM(n),l=eM(s),h=eM(a);for(let u=0;u<this._scales.length;u++){let d=o?n[u]:n,c=l?s[u]:s,p=h?a[u]:a;this._scales[u].paddingInner(null!==(i=null!=c?c:d)&&void 0!==i?i:t,!0).paddingOuter(null!==(r=null!=p?p:d)&&void 0!==r?r:e,!0)}}computeBandDomain(t){if(!t.length)return[];if(1===t.length)return t[0].values;let e=new Set;for(let i=0;i<t.length;i++)for(let r=0;r<t[i].values.length;r++)e.add(t[i].values[r]);return Array.from(e)}updateScaleDomain(){var t;if(!this.isSeriesDataEnable())return;(null===(t=this._rawDomainIndex)||void 0===t?void 0:t.length)||!this._scales.length||this._updateRawDomain();let e=this._spec.domain;for(let t=0;t<this._scales.length;t++)if(e&&e.length&&0===t)this._scales[t].domain(e);else{let e=this.collectData(t),i=this.computeBandDomain(e);this._scales[t].domain(i.sort((e,i)=>this._rawDomainIndex[t][e]-this._rawDomainIndex[t][i]))}this.transformScaleDomain(),this.event.emit(c1.scaleDomainUpdate,{model:this}),this.event.emit(c1.scaleUpdate,{model:this,value:"domain"})}getLabelItems(t){let e=[],i=[];return this._scales.forEach((r,n)=>{var s;let a=this._tickDataMap[n],o=null===(s=null==a?void 0:a.getLatestData())||void 0===s?void 0:s.length,l=o?a.getLatestData().map(t=>t.value):r.domain();if(l&&l.length){if(i&&i.length){let r=[],n=[];i.forEach(e=>{l.forEach(i=>{let s=om(e).concat(i);if(n.push(s),o){let e=Tq(i,this._getNormalizedValue(s,t));r.push(e)}})}),o&&e.push(r.filter(t=>t.value>=0&&t.value<=1)),i=n}else l.forEach(t=>{i.push(t)}),o&&e.push(a.getLatestData().map(e=>Tq(e.value,this._getNormalizedValue([e.value],t))).filter(t=>t.value>=0&&t.value<=1))}}),e.reverse()}_updateRawDomain(){this._rawDomainIndex=[];let t=this._spec.domain;for(let e=0;e<this._scales.length;e++)if(t&&t.length&&0===e)this._scales[e].domain(t);else{let t=this.collectData(e,!0),i=this.computeBandDomain(t);this._rawDomainIndex[e]={},i.forEach((t,i)=>this._rawDomainIndex[e][t]=i)}}_clearRawDomain(){this._rawDomainIndex=[]}}class Ov extends Of{constructor(){super(...arguments),this.type=lx.cartesianBandAxis,this._scale=new x8}computeDomain(t){return this.computeBandDomain(t)}updateScaleRange(){let t=super.updateScaleRange();return this.updateGroupScaleRange(),t}initScales(){super.initScales(),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)}axisHelper(){let t=(t=0)=>this._scales[t];return{isContinuous:!1,dataToPosition:this.dataToPosition.bind(this),getScale:t,getBandwidth:(e=0)=>t(e).bandwidth(),getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>this._inverse,getSpec:()=>this._spec}}transformScaleDomain(){this.updateFixedWholeLength()}updateFixedWholeLength(){if(this._scale){let{bandSize:t,maxBandSize:e,minBandSize:i}=this._getOuterBandSizeFromSpec();if(t&&this._scale.bandwidth(t),e&&this._scale.maxBandwidth(e),i&&this._scale.minBandwidth(i),this._scale.isBandwidthFixed()&&this._spec.autoRegionSize&&(t||e)){let i=xy(this._scale.domain().length,null!=t?t:e,this._scale.paddingInner(),this._scale.paddingOuter());["bottom","top"].includes(this._orient)?this._regions.forEach(t=>t.setMaxWidth(i)):["left","right"].includes(this._orient)&&this._regions.forEach(t=>t.setMaxHeight(i))}}}_getOuterBandSizeFromSpec(){var t;let{bandSize:e,maxBandSize:i,minBandSize:r,bandSizeLevel:n=0}=this._spec,{gap:s,extend:a=0}=null!==(t=this._spec.bandSizeExtend)&&void 0!==t?t:{};n=Math.min(n,this._scales.length-1);for(let t=n;t>0;t--){let o=this._scales[t],l=o.domain(),h=o.paddingInner(),u=o.paddingOuter(),d=e=>{let i=t===n?a:0;return ej(s)||t<n?xy(l.length,e,h,u)+i:(e+(eE(s)?e*(Number(s.substring(0,s.length-1))/100):s))*l.length/(this._scales[t-1].paddingInner()+1)+i};eO(e)&&(e=d(e)),eO(i)&&(i=d(i)),eO(r)&&(r=d(r))}return{bandSize:e,maxBandSize:i,minBandSize:r}}}Ov.type=lx.cartesianBandAxis,Ov.specKey="axes",CS(Ov,Om);let Oy=()=>{Oc(),de.registerComponent(Ov.type,Ov)},O_=Math.sqrt(50),Ob=Math.sqrt(10),Ox=Math.sqrt(2);class OS{constructor(){this._extend={},this.niceLabelFormatter=null}setExtraAttrFromSpec(){eO(this._spec.nice)&&(this._nice=this._spec.nice),eO(this._spec.zero)&&(this._zero=this._spec.zero),this._expand=this._spec.expand,this._domain=TU(this._spec)}transformScaleDomain(){this.setScaleNice()}setLinearScaleNice(){var t;if(!this._nice)return!1;let e=5,i=this._spec.tick||{};if(l1(i.forceTickCount))e=i.forceTickCount;else if(nx(i.tickCount)){let t=this._scale.range(),r=Math.abs(t[t.length-1]-t[0]);1===r&&this._option&&(r=dR(this._orient)?this._option.getChartViewRect().width:this._option.getChartViewRect().height),e=i.tickCount({rangeSize:r,labelStyle:this._spec.label&&this._spec.label.style})}else e=l1(i.tickCount)?i.tickCount:5;"accurateFirst"===this._spec.niceType&&(e=Math.max(5,e));let{min:r,max:n}=null!==(t=this._domain)&&void 0!==t?t:{};return ej(r)&&ej(n)&&ej(this._softMaxValue)&&ej(this._softMinValue)?this._scale.nice(e):(eO(r)||eO(this._softMinValue))&&ej(n)&&ej(this._softMaxValue)?this._scale.niceMax(e):!(!ej(r)||!ej(this._softMinValue)||!eO(n)&&!eO(this._softMaxValue))&&this._scale.niceMin(e)}setLogScaleNice(){var t;if(!this._nice)return!1;let{min:e,max:i}=null!==(t=this._domain)&&void 0!==t?t:{};return ej(e)&&ej(i)&&ej(this._softMaxValue)&&ej(this._softMinValue)?this._scale.nice():(eO(e)||eO(this._softMinValue))&&ej(i)&&ej(this._softMaxValue)?this._scale.niceMax():!(!ej(e)||!ej(this._softMinValue)||!eO(i)&&!eO(this._softMaxValue))&&this._scale.niceMin()}setScaleNice(){return"log"===this._spec.type?this.setLogScaleNice():this.setLinearScaleNice()}dataToPosition(t,e){return this.valueToPosition(t[0])}valueToPosition(t){return this._scale.scale(t)}computeLinearDomain(t){let e=[];return t.length?t.forEach(t=>{let{min:i,max:r}=t;e[0]=void 0===e[0]?i:Math.min(e[0],i),e[1]=void 0===e[1]?r:Math.max(e[1],r)}):(e[0]=0,e[1]=0),this.setSoftDomainMinMax(e),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e}expandDomain(t){if(!this._expand)return;let e=t[0],i=t[t.length-1];e===i&&(0===i?i=1:i>0?e=0:i<0&&(i=0)),eO(this._expand.min)&&(t[0]=e-(i-e)*this._expand.min),eO(this._expand.max)&&(t[t.length-1]=i+(i-e)*this._expand.max)}niceDomain(t){let{min:e,max:i}=TU(this._spec);if(eO(e)||eO(i)||"linear"!==this._spec.type)return t;if(1e-12>=Math.abs(o_(t)-oy(t))){let e=t[0],i=e>=0?1:-1;if((e=Math.abs(e))<1)t[0]=0,t[1]=1;else{let i=e/5,r=Math.floor(Math.log(i)/Math.LN10),n=i/Math.pow(10,r);i=(n>=O_?10:n>=Ob?5:n>=Ox?2:1)*Math.pow(10,r),t[0]=0,t[1]=10*i}i<0&&(t.reverse(),t[0]*=-1,t[1]*=-1)}return t}includeZero(t){this._zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(t[t.length-1],0))}setExtendDomain(t,e){if(void 0===e)return void delete this._extend[t];this._extend[t]=e;let i=this._scale.domain();this.extendDomain(i),this.includeZero(i),this.setDomainMinMax(i),this.niceDomain(i),this._scale.domain(i,this._nice),this._nice&&(this.setScaleNice()||this._scale.rescale()),this.event.emit(c1.scaleUpdate,{model:this,value:"domain"})}extendDomain(t){let e;let i=t.length-1,r=t[0]-t[i]>0,n=r?i:0,s=r?0:i;for(let i in this._extend)(e=this._extend[i])>t[s]&&(t[s]=e),e<t[n]&&(t[n]=e)}getDomainSpec(){return this._domain}setDomainMinMax(t){if(!this._domain)return;let{min:e,max:i}=this._domain;eO(e)&&(t[0]=e),eO(i)&&(t[1]=i)}setSoftDomainMinMax(t){let{softMin:e,softMax:i}=this._spec;if(eO(e)){let i=nx(e)?e(t):e;ej(i)&&(i=t[0]),i<=t[0]&&(t[0]=i,this._softMinValue=i)}if(eO(i)){let e=nx(i)?i(t):i;ej(e)&&(e=t[1]),e>=t[1]&&(t[1]=e),this._softMaxValue=e}}setZero(t){this._zero!==t&&(this._zero=t,this.updateScaleDomain())}updateScaleDomain(){if(!this.isSeriesDataEnable())return;let t=this.collectData(),e=this.computeLinearDomain(t);this.updateScaleDomainByModel(e)}updateScaleDomainByModel(t){t=null!=t?t:this._scale.domain(),this.extendDomain(t),this.includeZero(t),this.setDomainMinMax(t),this.niceDomain(t),this._scale.domain(t,this._nice),this._nice&&(this.setScaleNice()||this._scale.rescale()),this._updateNiceLabelFormatter(t),this._domainAfterSpec=this._scale.domain(),this.event.emit(c1.scaleDomainUpdate,{model:this}),this.event.emit(c1.scaleUpdate,{model:this,value:"domain"})}getDomainAfterSpec(){return this._domainAfterSpec}_updateNiceLabelFormatter(t){let e=Math.pow(10,Math.max(-Math.floor(Math.log10(Math.abs(t[1]-t[0]))),0)+2);this.niceLabelFormatter=t=>l1(+t)?Math.round(+t*e)/e:t}}class Ok extends Of{constructor(){super(...arguments),this.type=lx.cartesianLinearAxis,this._zero=!0,this._nice=!0,this._extend={},this._scale=new x1}setAttrFromSpec(){super.setAttrFromSpec(),this.setExtraAttrFromSpec()}initScales(){var t,e;super.initScales();let i=[0,1];eO(null===(t=this._domain)||void 0===t?void 0:t.min)&&(i[0]=this._domain.min),eO(null===(e=this._domain)||void 0===e?void 0:e.max)&&(i[1]=this._domain.max),this._scale.domain(i)}computeDomain(t){return this.computeLinearDomain(t)}axisHelper(){let t=super.axisHelper();return t.setExtendDomain=this.setExtendDomain.bind(this),t.valueToPosition=this.valueToPosition.bind(this),t}}Ok.type=lx.cartesianLinearAxis,Ok.specKey="axes",CS(Ok,OS);let OA=()=>{Oc(),de.registerComponent(Ok.type,Ok)};class Ow extends C6{constructor(){super(...arguments),this.type=cZ.line,this.transformerConstructor=To,this._sortDataByAxis=!1}compile(){super.compile(),this.addSamplingCompile(),this.addOverlapCompile()}initMark(){var t;let e={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},i=null!==(t=this._spec.seriesMark)&&void 0!==t?t:"line";this.initLineMark(e,"line"===i),this.initSymbolMark(e,"point"===i)}initTooltip(){super.initTooltip();let{dimension:t,group:e,mark:i}=this._tooltipHelper.activeTriggerSet;this._lineMark&&(t.add(this._lineMark),e.add(this._lineMark)),this._symbolMark&&(i.add(this._symbolMark),e.add(this._symbolMark))}initMarkStyle(){this.initLineMarkStyle(this._direction),this.initSymbolMarkStyle()}initAnimation(){var t,e,i,r;let n={direction:this.direction},s=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;if(this._lineMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("line"))||void 0===i?void 0:i(n,s),Cq("line",this._spec,this._markAttributeContext))),this._symbolMark){let t=C8(this);this._symbolMark.setAnimationConfig(CX(null===(r=de.getAnimationInKey("scaleInOut"))||void 0===r?void 0:r(),Cq("point",this._spec,this._markAttributeContext),t))}}onLayoutEnd(t){super.onLayoutEnd(t),this.reCompileSampling()}getSeriesStyle(t){var e;let i="point"!==(null===(e=this._spec)||void 0===e?void 0:e.seriesMark);return e=>{var r,n;return i&&"fill"===e&&(e="stroke"),null!==(n=null===(r=this._seriesMark)||void 0===r?void 0:r.getAttribute(e,t))&&void 0!==n?n:void 0}}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._lineMark,this._symbolMark]}}Ow.type=cZ.line,Ow.mark=hL,Ow.transformerConstructor=To,CS(Ow,Tt);let OM=()=>{Mb(),Mx(),Tr(),Ta(),Mi(),w9(),Oy(),OA(),de.registerSeries(Ow.type,Ow)},OC=(t,e)=>{var i;let{regionId:r,regionIndex:n}=t.spec;if(eO(r)){let t=om(r);return null===(i=e.region)||void 0===i?void 0:i.filter(({spec:e})=>t.includes(e.id))}if(eO(n))return om(n).map(t=>{var i;return null===(i=e.region)||void 0===i?void 0:i[t]}).filter(eO)},OT=(t,e)=>{var i;let{seriesId:r,seriesIndex:n}=t.spec;if(eO(r)){let t=om(r);return null===(i=e.series)||void 0===i?void 0:i.filter(({spec:e})=>t.includes(e.id))}if(eO(n))return om(n).map(t=>{var i;return null===(i=e.series)||void 0===i?void 0:i[t]}).filter(eO)};class OE{constructor(t){this._option=t,this.type=t.type,this.seriesType=t.seriesType}initChartSpec(t){return this.transformSpec(t),this.transformModelSpec(t)}transformSpec(t){t.region&&0!==t.region.length||(t.region=[{}]),void 0===t.tooltip&&(t.tooltip={}),eO(t.stackInverse)&&t.region.forEach(e=>{eO(e.stackInverse)||(e.stackInverse=t.stackInverse)}),eO(t.stackSort)&&t.region.forEach(e=>{eO(e.stackSort)||(e.stackSort=t.stackSort)})}transformModelSpec(t){return this.createSpecInfo(t,(e,i,r)=>{let{spec:n,specPath:s,specInfoPath:a,type:o}=i,l=new e.transformerConstructor(Object.assign(Object.assign({},this._option),{type:o})).transformSpec(n,t,r);bZ(t,s,l.spec),bZ(r,null!=a?a:s,Object.assign(Object.assign({},i),l))})}createSpecInfo(t,e){var i,r;e||(e=(e,i,r)=>{let{spec:n,specPath:s,specInfoPath:a,type:o}=i,l=new e.transformerConstructor(Object.assign(Object.assign({},this._option),{type:o}));bZ(r,null!=a?a:s,Object.assign(Object.assign({},i),{theme:l.getTheme(n,t)}))});let n={};return this.forEachRegionInSpec(t,e,n),this.forEachSeriesInSpec(t,e,n),null===(i=n.series)||void 0===i||i.forEach((t,e)=>{var i,r;let s=(null!==(r=null!==(i=OC(t,n))&&void 0!==i?i:n.region)&&void 0!==r?r:[])[0];s&&(s.seriesIndexes||(s.seriesIndexes=[]),s.seriesIndexes.push(e),t.regionIndexes=s.regionIndexes.slice())}),this.forEachComponentInSpec(t,e,n),Object.values(null!==(r=n.component)&&void 0!==r?r:{}).forEach(t=>t.forEach((t,e)=>{var i,r,s;if(t){if(!t.regionIndexes){let e=null!==(r=null!==(i=OC(t,n))&&void 0!==i?i:n.region)&&void 0!==r?r:[];t.regionIndexes=e.map(t=>t.regionIndexes[0])}if(!t.seriesIndexes){let e=OT(t,n);if(e)t.seriesIndexes=e.map(({seriesIndexes:t})=>t[0]);else{let e=new Set;(null!==(s=t.regionIndexes)&&void 0!==s?s:[]).forEach(t=>{var i,r;let s=null===(i=n.region)||void 0===i?void 0:i[t];null===(r=null==s?void 0:s.seriesIndexes)||void 0===r||r.forEach(t=>e.add(t))}),t.seriesIndexes=Array.from(e)}}}})),n}_isValidSeries(t){return!0}_getDefaultSeriesSpec(t){var e,i,r,n;return{dataKey:t.dataKey,hover:t.hover,select:t.select,label:t.label,seriesStyle:t.seriesStyle,animation:null!==(e=t.animation)&&void 0!==e?e:this._option.animation,animationThreshold:null!==(i=t.animationThreshold)&&void 0!==i?i:null===(n=(r=this._option).getTheme)||void 0===n?void 0:n.call(r).animationThreshold,animationAppear:t.animationAppear,animationDisappear:t.animationDisappear,animationEnter:t.animationEnter,animationUpdate:t.animationUpdate,animationExit:t.animationExit,animationNormal:t.animationNormal,extensionMark:t.extensionMark,large:t.large,largeThreshold:t.largeThreshold,progressiveStep:t.progressiveStep,progressiveThreshold:t.progressiveThreshold,background:t.seriesBackground,invalidType:t.invalidType,seriesField:t.seriesField,morph:t.morph,interactions:t.interactions}}forEachRegionInSpec(t,e,i){var r;return(null!==(r=t.region)&&void 0!==r?r:[]).map((t,r)=>e(de.getRegionInType("region"),{spec:t,specPath:["region",r],type:"region",regionIndexes:[r]},i))}forEachSeriesInSpec(t,e,i){var r;return(null!==(r=t.series)&&void 0!==r?r:[]).map((t,r)=>e(de.getSeriesInType(t.type),{spec:t,specPath:["series",r],type:t.type,seriesIndexes:[r]},i))}forEachComponentInSpec(t,e,i){var r,n,s;let a,o,l,h;let u=[],d=de.getComponents(),c=[];for(let e=0;e<d.length;e++){let{cmp:i,alwaysCheck:n}=d[e];i.type.startsWith(lx.cartesianAxis)?a=i:i.type.startsWith(lx.polarAxis)?o=i:i.type===lx.geoCoordinate?l=i:(n||t[null!==(r=i.specKey)&&void 0!==r?r:i.type])&&(i.type===lx.tooltip?h=i:c.push(i))}let p=!1;if(a){let r=a.getSpecInfo(t,i);(null==r?void 0:r.length)>0&&(p=!0,r.forEach(t=>{let r=de.getComponentInKey(t.type);u.push(e(r,t,i))}))}if(o&&!p){let r=o.getSpecInfo(t,i);(null==r?void 0:r.length)>0&&(p=!0,r.forEach(t=>{let r=de.getComponentInKey(t.type);u.push(e(r,t,i))}))}return l&&!p&&(null===(n=l.getSpecInfo(t,i))||void 0===n||n.forEach(t=>{u.push(e(l,t,i))})),c.forEach(r=>{var n;null===(n=r.getSpecInfo(t,i))||void 0===n||n.forEach(t=>{u.push(e(r,t,i))})}),null===(s=null==h?void 0:h.getSpecInfo(t,i))||void 0===s||s.forEach(t=>{u.push(e(h,t,i))}),u}transformSeriesSpec(t){let e=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}):t.series=[e]}_findBandAxisBySeries(t,e,i){let r="horizontal"===(null==t?void 0:t.direction)?["left","right"]:["top","bottom"];return i.find(i=>!!r.includes(i.orient)&&(eO(i.seriesId)?om(i.seriesId).includes(null==t?void 0:t.id):eO(i.seriesIndex)?om(i.seriesIndex).includes(e):i.type,!0))}_applyAxisBandSize(t,e,i){let{barMaxWidth:r,barMinWidth:n,barWidth:s,barGapInGroup:a}=i,o=!1;ey(n)?(t.minBandSize=n,o=!0):ey(s)?(t.minBandSize=s,o=!0):ey(r)&&(t.minBandSize=r,o=!0),o&&(t.bandSizeLevel=Number.MAX_VALUE,t.bandSizeExtend={extend:e,gap:eM(a)?a[a.length-1]:a})}}class OO extends OE{needAxes(){return!0}_isValidSeries(t){return!this.seriesType||t===this.seriesType}_getDefaultSeriesSpec(t){let e=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{xField:t.xField,yField:t.yField,zField:t.zField,seriesField:t.seriesField,seriesStyle:t.seriesStyle,direction:t.direction,stack:t.stack,percent:t.percent,stackOffsetSilhouette:t.stackOffsetSilhouette,totalLabel:t.totalLabel,sortDataByAxis:t.sortDataByAxis}),i=this.seriesType;return i&&(e.type=i,e[i]=t[i]),e}transformSpec(t){super.transformSpec(t);let e=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}):t.series=[e],this._transformAxisSpec(t)}_transformAxisSpec(t){if(this.needAxes()){t.axes||(t.axes=[]);let e={x:!1,y:!1,z:!1};t.axes.forEach(i=>{let{orient:r}=i;"top"!==r&&"bottom"!==r||(e.x=!0),"left"!==r&&"right"!==r||(e.y=!0),"z"===r&&(e.z=!0),dq(i,"trimPadding")&&us(i,bv(this.type,t))}),e.x||t.axes.push({orient:"bottom"}),e.y||t.axes.push({orient:"left"}),t.zField&&!e.z&&t.axes.push({orient:"z"})}}}class OP extends OO{_getDefaultSeriesSpec(t){var e;return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{point:t.point,line:t.line,seriesMark:null!==(e=t.seriesMark)&&void 0!==e?e:"line",activePoint:t.activePoint,sampling:t.sampling,samplingFactor:t.samplingFactor,pointDis:t.pointDis,pointDisMul:t.pointDisMul,markOverlap:t.markOverlap,lineLabel:t.lineLabel})}transformSpec(t){super.transformSpec(t),bg(t)}}class OR{get dataList(){return this._dataArr}constructor(t,e){this._dataArr=[],this._onError=e,this._dataSet=t}parseData(t){this._dataArr=[];let e=om(t);for(let t=0;t<e.length;t++)this._dataArr.push(gB(e[t],this._dataSet,this._dataArr,{onError:this._onError}))}updateData(t,e=!1,i=!0){let r=om(t);return(!e||r.length===this._dataArr.length)&&(this._dataValueForEach(r,(t,e)=>{e.markRunning()}),this._dataValueForEach(r,(t,e)=>{gI(e,t,i)}),!0)}_dataValueForEach(t,e){t.forEach((t,i)=>{if(t instanceof eH)return;let r=this.getSeriesData(t.id,i);r&&e(t,r,i)})}getSeriesData(t,e){var i,r;if(!this._dataArr.length)return null;if("string"==typeof t){let e=this._dataArr.filter(e=>e.name===t);return e[0]?e[0]:(null===(i=this._onError)||void 0===i||i.call(this,`no data matches dataId ${t}!`),null)}return"number"==typeof e?this._dataArr[e]?this._dataArr[e]:(null===(r=this._onError)||void 0===r||r.call(this,`no data matches dataIndex ${e}!`),null):this._dataArr[0]}}class OB{constructor(t,e){this._scaleSpecMap=new Map,this._scaleMap=new Map,this._modelScaleSpecMap=new Map,this._markAttributeScaleMap=new Map,this._spec=null,this._chart=null,this.getStatisticalFields=t=>{let e=[];return this._scaleSpecMap.forEach((i,r)=>{l6(i.domain)&&i.domain.forEach(r=>{r.dataId===t&&r.fields.forEach(t=>{CC(e,[{key:t,operations:dr(i.type)?["max","min"]:["values"]}])})})}),this._markAttributeScaleMap.forEach((i,r)=>{let n=this.getScale(r);i.forEach(i=>{this._getSeriesBySeriesId(i.seriesId).getRawData().name===t&&i.field&&CC(e,[{key:i.field,operations:dr(n.type)?["max","min"]:["values"]}])})}),e},this._spec=t,this._chart=e,this._setAttrFromSpec()}_createFromSpec(t){if(!t.id)return null;let e=this._scaleMap.get(t.id);return e||(e="ordinal"===t.type&&"color"===t.id?St("colorOrdinal"):St(t.type)),e?(eM(t.range)&&e.range(t.range),eM(t.domain)&&(l6(t.domain)||e.domain(t.domain)),t.specified&&e.specified&&e.specified(t.specified),e):null}_setAttrFromSpec(){var t;if(!(null===(t=this._spec)||void 0===t?void 0:t.length))return;let e=new Map,i=new Map;this._spec.forEach(t=>{let r=this._createFromSpec(t);r&&(e.set(t.id,r),i.set(t.id,t))}),this._modelScaleSpecMap.forEach(t=>{let r=this._createFromSpec(t);r&&(e.set(t.id,r),i.set(t.id,t))}),this._scaleSpecMap=i,this._scaleMap=e}updateSpec(t){let e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(my(t,this._spec))return e;e.change=!0;for(let i=0;i<t.length;i++){let r=t[i],n=this._scaleMap.get(r.id);if(!n)return e.reMake=!0,e;let s=this._spec.find(t=>t.id===r.id);if(!s.id||s.type!==r.type)return e.reMake=!0,e;r.range&&!my(r.range,n.range())&&(n.range(r.range),e.reRender=!0),l6(r.domain)?e.reRender=!0:my(r.domain,n.domain())||(n.domain(r.domain),e.reRender=!0),this._scaleSpecMap.set(r.id,r)}return this._spec=t,e}registerModelScale(t){let e=this._createFromSpec(t);e&&(this._modelScaleSpecMap.set(t.id,t),this._scaleSpecMap.set(t.id,t),this._scaleMap.set(t.id,e))}removeModelScale(t){this._modelScaleSpecMap.forEach(e=>{t(e)&&(this._modelScaleSpecMap.delete(e.id),this._scaleSpecMap.delete(e.id),this._scaleMap.delete(e.id))})}getScale(t){return this._scaleMap.get(t)}getScaleSpec(t){return this._scaleSpecMap.get(t)}_getSeriesByRawDataId(t){let e=this._chart.getAllSeries();for(let i=0;i<e.length;i++){let r=e[i];if(r.getRawData().name===t)return r}return null}_getSeriesBySeriesId(t){let e=this._chart.getAllSeries();for(let i=0;i<e.length;i++){let r=e[i];if(r.id===t)return r}return null}updateScaleDomain(t){this._scaleSpecMap.forEach((e,i)=>{let r;let n=this._scaleMap.get(i);if(!n)return;if(!l6(e.domain))return e.domain&&0!==e.domain.length||n.domain(t),void this._updateMarkScale(i,n,n.domain().slice());r=dr(e.type)?[null,null]:new Set,e.domain.forEach(t=>{let i=this._getSeriesByRawDataId(t.dataId);if(!i)return;let n=dr(e.type);t.fields.forEach(t=>{let e=i.getRawDataStatisticsByField(t,n);e&&(n?(ej(r[0])?r[0]=e.min:r[0]=Math.min(e.min,r[0]),ej(r[1])?r[1]=e.max:r[1]=Math.max(e.max,r[1])):e.values.forEach(t=>{r.add(t)}))})});let s=r;dr(e.type)||(r=Array.from(r)),n.domain(r),this._updateMarkScale(i,n,s)})}_updateMarkScale(t,e,i){let r=this._markAttributeScaleMap.get(t);r&&0!==r.length&&r.forEach(t=>{if(!t.field||!t.markScale||t.markScale===e)return;if(ej(t.changeDomain)||"none"===t.changeDomain||ej(t.seriesId))return void(dr(e.type)?t.markScale.domain(i):e.domain(Array.from(i)));let r=this._getSeriesBySeriesId(t.seriesId),n=dr(e.type),s=r.getRawDataStatisticsByField(t.field,n);if(!mk(s))return"expand"===t.changeDomain?(n?(i[0]=Math.min(i[0],s.min),i[1]=Math.max(i[1],s.max)):(s.values.forEach(t=>{i.add(t)}),i=Array.from(i)),void t.markScale.domain(i)):void("replace"!==t.changeDomain||(n?t.markScale.domain([s.min,s.max]):t.markScale.domain(s.values)));dr(e.type)?t.markScale.domain(i):e.domain(Array.from(i))})}registerMarkAttributeScale(t,e){let i=this._scaleMap.get(t.scale),r=this._markAttributeScaleMap.get(t.scale);r||(r=[],this._markAttributeScaleMap.set(t.scale,r));let n=i;return!ej(t.field)&&(ej(t.changeDomain)||"none"===t.changeDomain||ej(e))||(n=i.clone()),r.push(Object.assign(Object.assign({},t),{seriesId:e,markScale:n})),n}}class OI{constructor(t){this.stackRegion=({model:t})=>{let e=t.getSeries();if(!e.some(t=>t.getStack()))return;let i=e.some(t=>{var e,i;return null===(i=null===(e=t.getSpec())||void 0===e?void 0:e.totalLabel)||void 0===i?void 0:i.visible}),r=i||e.some(t=>t.getPercent()),n=e.some(t=>t.getStackOffsetSilhouette()),s=CE(t,!0);for(let e in s)for(let i in s[e].nodes)(function t(e,i,r){if(e.values.length>0){let t=0,n=0,s=1,a=0,o=e.values.length;for(let r=0;r<o;r++){let s=e.values[i?o-1-r:r];(a=s[bO])>=0?(s[bE]=t,t+=s[bO],s[bO]=t):(s[bE]=n,n+=s[bO],s[bO]=n),s[bT]=e.key}if(r)for(let r=0;r<o;r++){let l=e.values[i?o-1-r:r],h=(a=l[bO])>=0?t:n;s=a>=0?1:-1,l[bP]=0===h?0:Math.min(1,l[bE]/h)*s,l[bR]=0===h?0:Math.min(1,l[bO]/h)*s}}for(let n in e.nodes)t(e.nodes[n],i,r)})(s[e].nodes[i],t.getStackInverse(),r);if(n)for(let t in s)for(let e in s[t].nodes)(function(t){if(!t.values.length)return;let e=t.values[t.values.length-1][bO]/2;for(let i=0;i<t.values.length;i++)t.values[i][bB]=t.values[i][bE]-e,t.values[i][bI]=t.values[i][bO]-e})(s[t].nodes[e]);i&&t.getSeries().forEach(t=>{let e=t.getStackData(),i=t.getStackValue(),r=t.getStackValueField();e&&r&&function t(e,i){if("values"in e&&e.values.length){let t=dS(e.values,i),r=dx(e.values,bR);e.values.forEach(e=>{e[bL]=t,e[bD]=r,delete e[bF]}),e.values.reduce((t,e)=>e[bO]>t[bO]?e:t)[bF]=!0}else for(let r in e.nodes)t(e.nodes[r],i)}(s[i],r)})},this._chart=t}init(){this._chart.getAllRegions().forEach(t=>{t.event.on(c1.regionSeriesDataFilterOver,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},this.stackRegion)})}stackAll(){this._chart.getAllRegions().forEach(t=>{this.stackRegion({model:t})})}}var OL=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class OD extends bV{getSpec(){return this._spec}setSpec(t){this._spec=t}getOption(){return this._option}getLayoutRect(){return this._layoutRect}getViewRect(){return this._viewRect}getLayoutTag(){return this._layoutTag}setLayoutTag(t,e,i=!0){var r;return this._layoutTag=t,(null===(r=this.getCompiler())||void 0===r?void 0:r.getVGrammarView())&&(this.getCompiler().getVGrammarView().updateLayoutTag(),t&&i&&this.getCompiler().renderNextTick(e)),this._layoutTag}getGlobalScale(){return this._globalScale}getEvent(){return this._event}get chartData(){return this._chartData}constructor(t,e){var i,r,n,s;super(e),this.type="chart",this.id=l4(),this._regions=[],this._series=[],this._components=[],this._layoutRect={x:0,y:0,width:500,height:500},this._viewRect={width:500,height:500},this._viewBox={x1:0,y1:0,x2:500,y2:500},this._layoutTag=!0,this._idMap=new Map,this.state={layoutUpdateRank:1},this.padding={top:0,left:0,right:0,bottom:0},this.getAllSeries=()=>{var t;return null!==(t=this._series)&&void 0!==t?t:[]},this.getRegionsInIndex=t=>t&&0!==t.length?this._regions.filter((e,i)=>t.includes(i)):[this._regions[0]],this.getAllRegions=()=>this._regions,this.getRegionsInIds=t=>t?this._regions.filter(e=>t.includes(e.id)):[],this.getRegionsInQuerier=t=>t?this._regions.filter((e,i)=>om(t).some(t=>eO(t.regionId)&&t.regionId===e.userId||t.regionIndex===i)):this._regions,this.getRegionsInUserId=t=>{if(t)return this._regions.find(e=>e.userId===t)},this.getRegionsInUserIdOrIndex=(t,e)=>this.getAllRegions().filter(i=>(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())),this.getComponents=()=>this._components,this.getSeriesInIndex=t=>t&&0!==t.length?this._series.filter((e,i)=>t.includes(i)):[this._series[0]],this.getSeriesInIds=t=>t?this._series.filter(e=>t.includes(e.id)):[],this.getSeriesInUserId=t=>{if(t)return this._series.find(e=>e.userId===t)},this.getSeriesInUserIdOrIndex=(t,e)=>this.getAllSeries().filter(i=>(null==t?void 0:t.length)?i.userId&&t.includes(i.userId):!(null==e?void 0:e.length)||e.includes(i.getSpecIndex())),this.getComponentByIndex=(t,e)=>{let i=this._components.filter(e=>(e.specKey||e.type)===t);if(i&&0!==i.length)return i[e]},this.getComponentsByKey=t=>this._components.filter(e=>(e.specKey||e.type)===t),this.getComponentByUserId=t=>{let e=this._components.find(e=>e.userId===t);if(e)return e},this.getComponentsByType=t=>this._components.filter(e=>e.type===t),this._paddingSpec=hi(null!==(i=t.padding)&&void 0!==i?i:e.getTheme().padding),this._event=new dZ(e.eventDispatcher,e.mode),this._dataSet=e.dataSet,this._chartData=new OR(this._dataSet,null===(r=this._option)||void 0===r?void 0:r.onError),this._modelOption=Object.assign(Object.assign({},e),{mode:this._option.mode,map:this._idMap,getChartLayoutRect:()=>this._layoutRect,getChartViewRect:()=>this._viewRect,getChart:()=>this,globalScale:this._globalScale,onError:null===(n=this._option)||void 0===n?void 0:n.onError,disableTriggerEvent:!0===(null===(s=this._option)||void 0===s?void 0:s.disableTriggerEvent),getSeriesData:this._chartData.getSeriesData.bind(this._chartData)}),this._spec=t}created(){this._transformer=new this.transformerConstructor(Object.assign(Object.assign({},this._option),{type:this.type,seriesType:this.seriesType})),this._chartData.parseData(this._spec.data),this._createGlobalScale(),this._createBackground(),this._createLayout(),this._transformer.forEachRegionInSpec(this._spec,this._createRegion.bind(this)),this._transformer.forEachSeriesInSpec(this._spec,this._createSeries.bind(this)),this._transformer.forEachComponentInSpec(this._spec,this._createComponent.bind(this),this._option.getSpecInfo())}init(){this._regions.forEach(t=>t.init({})),this._series.forEach(t=>t.init({})),this._components.forEach(t=>t.init({dataSet:this._dataSet})),this._initEvent(),this._canStack&&(this._stack=new OI(this),this._stack.init()),this.reDataFlow()}reDataFlow(){this._series.forEach(t=>{var e;return null===(e=t.getRawData())||void 0===e?void 0:e.markRunning()}),this._series.forEach(t=>t.fillData()),this.updateGlobalScaleDomain()}onResize(t,e,i=!0){this._canvasRect={width:t,height:e},this._updateLayoutRect(this._option.viewBox),this.setLayoutTag(!0,null,i)}updateViewBox(t,e){this._option.viewBox=t,this._updateLayoutRect(t),this.setLayoutTag(!0,null,e)}_createBackground(){let t=this._spec.background;if(!t||"object"!=typeof t||eO(t.gradient))return;let e=Eo(t,["x","y","width","height","x1","y1","image"]);e.background=t.image,this._backgroundMark=de.createMark("group","chart-background",{model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._globalScale}),this._backgroundMark.created(),this._backgroundMark.setStyle(Object.assign(Object.assign({},e),{x:()=>this._viewBox.x1,y:()=>this._viewBox.y1,width:()=>this._viewBox.x2-this._viewBox.x1,height:()=>this._viewBox.y2-this._viewBox.y1}))}_createRegion(t,e){if(!t)return;let{spec:i}=e,r=OL(e,["spec"]),n=new t(i,Object.assign(Object.assign({},this._modelOption),r));n&&(n.created(),this._regions.push(n))}_createSeries(t,e){let i;if(!t)return;let{spec:r}=e,n=OL(e,["spec"]);if(eO(r.regionId)?i=this.getRegionsInUserId(r.regionId):eO(r.regionIndex)&&(i=this.getRegionsInIndex([r.regionIndex])[0]),!i&&!(i=this._regions[0]))return;let s=new t(r,Object.assign(Object.assign(Object.assign({},this._modelOption),n),{type:r.type,region:i,globalScale:this._globalScale,sourceDataList:this._chartData.dataList}));s&&(s.created(),this._series.push(s),i.addSeries(s))}getSeriesById(t){return this._series.find(e=>e.id===t)}_createComponent(t,e){let i=t.createComponent(e,Object.assign(Object.assign({},this._modelOption),{type:t.type,getAllRegions:this.getAllRegions,getRegionsInIndex:this.getRegionsInIndex,getRegionsInIds:this.getRegionsInIds,getRegionsInUserIdOrIndex:this.getRegionsInUserIdOrIndex,getAllSeries:this.getAllSeries,getSeriesInIndex:this.getSeriesInIndex,getSeriesInIds:this.getSeriesInIds,getSeriesInUserIdOrIndex:this.getSeriesInUserIdOrIndex,getAllComponents:this.getComponents,getComponentByIndex:this.getComponentByIndex,getComponentByUserId:this.getComponentByUserId,getComponentsByKey:this.getComponentsByKey,getComponentsByType:this.getComponentsByType}));i&&(i.created(),this._components.push(i))}getAllComponents(){return this._components}getAllModels(){return[].concat(this.getAllSeries(),this.getAllComponents(),this.getAllRegions())}getModelInFilter(t){if(eE(t))return this.getAllModels().find(e=>e.userId===t);if(nx(t))return this.getAllModels().find(e=>t(e));let e=0;return this.getAllModels().find(i=>{var r;if((null!==(r=i.specKey)&&void 0!==r?r:i.type)===t.type){if(e===t.index)return!0;e++}return!1})}_createLayout(){this._updateLayoutRect(this._option.viewBox),this._initLayoutFunc()}setLayout(t){this._option.layout=t,this._initLayoutFunc()}_initLayoutFunc(){var t,e,i;if(this._layoutFunc=this._option.layout,!this._layoutFunc){let r=!1;(this._spec.zField||this._spec.series&&this._spec.series.some(t=>t.zField))&&(r=!0);let n=de.getLayoutInKey(null!==(e=null===(t=this._spec.layout)||void 0===t?void 0:t.type)&&void 0!==e?e:r?"layout3d":"base");if(n){let t=new n(this._spec.layout,{onError:null===(i=this._option)||void 0===i?void 0:i.onError});this._layoutFunc=t.layoutItems.bind(t)}}}layout(t){var e,i,r,n;if(null===(i=null===(e=this._option.performanceHook)||void 0===e?void 0:e.beforeLayoutWithSceneGraph)||void 0===i||i.call(e),this.getLayoutTag()){this._event.emit(c1.layoutStart,{chart:this,vchart:this._option.globalInstance}),this.onLayoutStart(t);let e=this.getLayoutElements();this._layoutFunc(this,e,this._layoutRect,this._viewBox),this._event.emit(c1.afterLayout,{elements:e,chart:this}),this.setLayoutTag(!1),this.onLayoutEnd(t),this._event.emit(c1.layoutEnd,{chart:this,vchart:this._option.globalInstance})}null===(n=null===(r=this._option.performanceHook)||void 0===r?void 0:r.afterLayoutWithSceneGraph)||void 0===n||n.call(r)}onLayoutStart(t){this.getAllModels().forEach(e=>e.onLayoutStart(this._layoutRect,this._viewRect,t))}onLayoutEnd(t){this.getAllModels().forEach(e=>{"series"!==e.modelType&&e.onLayoutEnd(t)})}onEvaluateEnd(t){[...this._components,...this._regions,...this._series].forEach(e=>e.onEvaluateEnd(t))}getLayoutElements(){return this.getAllModels().map(t=>t.layout).filter(t=>!!t)}getModelById(t){let e=this._idMap.get(t);if(e&&e instanceof bq)return e}getModelByUserId(t){let e=this.getSeriesInUserId(t);if(e)return e;let i=this.getRegionsInUserId(t);return i?i:this.getComponentByUserId(t)||void 0}getAllMarks(){return Array.from(this._idMap.values()).filter(t=>t&&t instanceof Sd)}getMarkById(t){let e=this._idMap.get(t);if(e&&e instanceof Sd)return e}updateData(t,e,i=!0,r){let n=this._dataSet.getDataView(t);n&&(n.markRunning(),n.parseNewData(e,r)),i&&this.updateGlobalScaleDomain(),this.getAllModels().forEach(t=>t.onDataUpdate())}updateFullData(t,e=!0){om(t).forEach(t=>{let e=this._dataSet.getDataView(t.id);e&&e.markRunning()}),om(t).forEach(t=>{let e=this._dataSet.getDataView(t.id);e&&gI(e,t,!0)}),e&&this.updateGlobalScaleDomain(),this.getAllModels().forEach(t=>t.onDataUpdate())}onRender(t){}setCanvasRect(t,e){this._canvasRect={width:t,height:e}}getCanvasRect(){return this._canvasRect||(this._canvasRect=bf(this._spec,this._option,{width:500,height:500})),this._canvasRect}getSeriesData(t,e){return this._chartData.getSeriesData(t,e)}_transformSpecScale(){var t;let e=this._spec.scales?[...this._spec.scales]:[],i=e.find(t=>"color"===t.id),r=this.getColorScheme();if(!i&&(i={type:"ordinal",id:"color",domain:null,range:null},e.push(i),this._spec.color)){let t=this._spec.color;eM(t)?i.range=t:(Object.prototype.hasOwnProperty.call(t,"type")&&(i.type=t.type),Object.prototype.hasOwnProperty.call(t,"domain")&&(i.domain=t.domain),Object.prototype.hasOwnProperty.call(t,"range")&&(i.range=t.range),Object.prototype.hasOwnProperty.call(t,"specified")&&(i.specified=t.specified))}return(null===(t=i.range)||void 0===t?void 0:t.length)||(i.range=hv(r),i.rangeTheme=!0),e}_createGlobalScale(){this._globalScale=new OB(this._transformSpecScale(),this),this._modelOption.globalScale=this._globalScale}updateGlobalScaleDomain(){let t=new Set;this._series.forEach(e=>{let i=e.getSeriesKeys();i&&i.forEach(e=>t.add(e))});let e=Array.from(t);this._globalScale.updateScaleDomain(e)}updateGlobalScale(t){bm(t,this._globalScale.updateSpec(this._transformSpecScale()))}updateGlobalScaleTheme(){let t=this._globalScale.getScaleSpec("color"),e=this.getColorScheme();t.rangeTheme&&(t.range=hv(e),this._globalScale.getScale("color").range(t.range))}updateSpec(t){let e={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(this.setLayoutTag(!0,null,!1),t.type!==this.type)return e.reMake=!0,e;let i=Object.keys(this._spec).sort(),r=Object.keys(t).sort();if(JSON.stringify(i)!==JSON.stringify(r))return e.reMake=!0,e;for(let r=0;r<i.length;r++){let n=i[r];if(eM(this._spec[n])&&this._spec[n].length!==t[n].length)return e.reMake=!0,e}let n=this._spec;return this._spec=t,this.updateChartConfig(e,n),e.reMake||(this.updateGlobalScale(e),e.reMake||(this.updateRegionSpec(e),e.reMake||(this.updateComponentSpec(e),e.reMake||(this.updateSeriesSpec(e),e.reMake||(this.reInit(),this.updateDataSpec(),this.updateGlobalScaleDomain()))))),e}updateChartConfig(t,e){var i,r;this._paddingSpec=hi(null!==(i=this._spec.padding)&&void 0!==i?i:null===(r=this._option)||void 0===r?void 0:r.getTheme().padding),this._updateLayoutRect(this._viewBox),my(this._spec.background,e.background)||(t.reMake=!0)}updateDataSpec(){this._spec.data&&this._chartData.updateData(this._spec.data,!1,!0)}updateRegionSpec(t){var e;(null===(e=this._spec)||void 0===e?void 0:e.region)&&(this._spec.region.length===this._regions.length?this._regions.forEach(e=>{bm(t,e.updateSpec(this._spec.region[e.getSpecIndex()]))}):t.reMake=!0)}updateComponentSpec(t){let e={};for(let i in this._components.forEach(i=>{var r,n;if(i.type===lx.label||i.type===lx.totalLabel)return;let s=i.specKey||i.type,a=null!==(r=this._spec[s])&&void 0!==r?r:{};eM(a)?(e[s]=e[s]||{specCount:a.length,componentCount:0},e[s].componentCount++,bm(t,i.updateSpec(null!==(n=a[i.getSpecIndex()])&&void 0!==n?n:{},a))):bm(t,i.updateSpec(a))}),e)if(Object.prototype.hasOwnProperty.call(e,i)){let r=e[i];r.componentCount!==r.specCount&&(t.reMake=!0)}}updateSeriesSpec(t){this._spec.series.length===this._series.length?this._series.forEach(e=>{let i=this._spec.series[e.getSpecIndex()];bm(t,e.updateSpec(i))}):t.reMake=!0}getCanvas(){var t,e;return null!==(e=null===(t=this.getCompiler())||void 0===t?void 0:t.getCanvas())&&void 0!==e?e:null}_updateLayoutRect(t){let e=this.getCanvasRect();if(t){this._viewBox=t;let{x1:i=0,y1:r=0,x2:n,y2:s}=t;e={width:n-i,height:s-r}}else this._viewBox={x1:0,y1:0,x2:e.width,y2:e.height};this._viewRect=e,this.padding=he(this._paddingSpec,e,e),this._layoutRect.width=e.width-this.padding.left-this.padding.right,this._layoutRect.height=e.height-this.padding.top-this.padding.bottom,this._layoutRect.x=this.padding.left,this._layoutRect.y=this.padding.top,this._event.emit(c1.layoutRectUpdate,{chart:this})}setCurrentTheme(){this.updateChartConfig({change:!0,reMake:!1},this._spec),this.setLayoutTag(!0,null,!1),this.updateGlobalScaleTheme(),this.reInit()}reInit(){[...this._regions,...this._series,...this._components].forEach(t=>{let e=t.getSpecInfo();e&&e.spec&&t.reInit(e.spec)})}clear(){this.getAllModels().forEach(t=>{var e;return null===(e=t.clear)||void 0===e?void 0:e.call(t)})}compile(){this.compileBackground(),this.compileLayout(),this.compileRegions(),this.compileSeries(),this.compileComponents()}afterCompile(){this.getAllRegions().forEach(t=>{var e;null===(e=t.afterCompile)||void 0===e||e.call(t)}),this.getAllSeries().forEach(t=>{var e;null===(e=t.afterCompile)||void 0===e||e.call(t)}),this.getAllComponents().forEach(t=>{var e;null===(e=t.afterCompile)||void 0===e||e.call(t)})}compileLayout(){let{width:t,height:e}=this.getCanvasRect();this.getCompiler().setSize(t,e)}compileBackground(){var t;this._backgroundMark&&(this._backgroundMark.compile(),null===(t=this._backgroundMark.getProduct())||void 0===t||t.configure({context:{model:this}}).layout(()=>{}))}compileRegions(){var t,e,i,r;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeRegionCompile)||void 0===e||e.call(t),this.getAllRegions().forEach(t=>{t.compile()}),null===(r=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterRegionCompile)||void 0===r||r.call(i)}compileSeries(){var t,e,i,r;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeSeriesCompile)||void 0===e||e.call(t),this.getAllSeries().forEach(t=>{t.compile()}),null===(r=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterSeriesCompile)||void 0===r||r.call(i)}compileComponents(){var t,e,i,r;null===(e=null===(t=this._option.performanceHook)||void 0===t?void 0:t.beforeComponentCompile)||void 0===e||e.call(t),this.getAllComponents().forEach(t=>{t.compile()}),null===(r=null===(i=this._option.performanceHook)||void 0===i?void 0:i.afterComponentCompile)||void 0===r||r.call(i)}release(){[...this._components,...this._regions,...this._series].forEach(t=>{t.beforeRelease()}),super.release(),this.clear(),[...this._components,...this._regions,...this._series].forEach(t=>{t.release()}),this._components=this._regions=this._series=[],this._spec={},this._dataSet=this._globalScale=this._layoutFunc=null,this._layoutTag=!1,this._idMap.clear()}onLayout(t){let e=t.rootMark;this.layout({group:e,srView:t})}updateState(t,e){let i=this.getAllSeries();for(let r in t){if(mk(t[r]))continue;let n=t[r],s={stateValue:r};s=nx(n.filter)?Object.assign({filter:n.filter},s):Object.assign(Object.assign({},n.filter),s),n.level&&(s.level=n.level),i.forEach(t=>{t.getMarks().forEach(i=>{i.stateStyle[r]&&(e&&!e(t,i,r)||(i.state.changeStateInfo(s),i.updateMarkState(r)))})})}}setSelected(t,e,i){this._setStateInDatum(tk.STATE_SELECTED,!0,t,e,i)}setHovered(t,e,i){this._setStateInDatum(tk.STATE_HOVER,!0,t,e,i)}clearState(t){this.getAllRegions().forEach(e=>{e.interaction.clearEventElement(t,!0),e.interaction.resetInteraction(t,null)})}clearSelected(){this.clearState(tk.STATE_SELECTED)}clearHovered(){this.clearState(tk.STATE_HOVER)}_initEvent(){[c1.dataZoomChange,c1.scrollBarChange].forEach(t=>{this._event.on(t,({value:t})=>{this._disableMarkAnimation(["exit","update"]);let e=()=>{this._enableMarkAnimation(["exit","update"]),this._event.off(pa.AFTER_MARK_RENDER_END,e)};this._event.on(pa.AFTER_MARK_RENDER_END,e)})})}_enableMarkAnimation(t){this.getAllMarks().forEach(e=>{let i=e.getProduct();i&&i.animate&&i.animate.enableAnimationState(t)})}_disableMarkAnimation(t){this.getAllMarks().forEach(e=>{let i=e.getProduct();i&&i.animate&&i.animate.disableAnimationState(t)})}_setStateInDatum(t,e,i,r,n){let s=(i=i?om(i):null)?Object.keys(i[0]):null;this.getRegionsInQuerier(n).forEach(n=>{i?(n.getSeries().forEach(e=>{e.getMarks().forEach(a=>{if(a.getProduct()&&(!r||nx(r)&&r(e,a))){let e=a.getProduct().isCollectionMark(),r=a.getProduct().elements,o=r;if(e)o=r.filter(t=>{let e=t.getDatum();i.every((t,i)=>s.every(r=>t[r]==e[i][r]))});else if(i.length>1){let t=i.slice();o=r.filter(e=>{if(0===t.length)return!1;let i=e.getDatum(),r=t.findIndex(t=>s.every(e=>t[e]==i[e]));return r>=0&&(t.splice(r,1),!0)})}else{let t=r.find(t=>s.every(e=>i[0][e]==t.getDatum()[e]));t&&(o=[t])}o.forEach(e=>{n.interaction.startInteraction(t,e)})}})}),e&&n.interaction.reverseEventElement(t)):n.interaction.clearEventElement(t,!0)})}setDimensionIndex(t,e){var i,r,n;let s=null;Array.from(this._event.getComposedEventMap().values()).forEach(i=>{let{eventType:r,event:n}=i;if(r===cQ.dimensionHover||r===cQ.dimensionClick){let i=n.dispatch(t,e);(null==i?void 0:i.length)&&(s=i)}});let a=ej(t)||!s||s.every(t=>ds(t.axis.getScale().type)&&ej(t.index));if(!1!==e.tooltip){let t=this.getComponentsByType(lx.tooltip)[0];if(null==t?void 0:t.getVisible()){if(a)null===(i=t.hideTooltip)||void 0===i||i.call(t);else{let i={};s.forEach(t=>{let{axis:e,value:r,data:n}=t,s="left"===e.getOrient()||"right"===e.getOrient();n.forEach(t=>{var e,n,a;let o=s?t.series.fieldY[0]:t.series.fieldX[0];i[o]=null!==(a=null===(n=null===(e=t.datum)||void 0===e?void 0:e[0])||void 0===n?void 0:n[o])&&void 0!==a?a:r})}),t.showTooltip(i,e.showTooltipOption)}}}if(!1!==e.crosshair){let t=this.getComponentsByType(lx.cartesianCrosshair)[0];t&&t.clearAxisValue&&t.setAxisValue&&(a?(null===(r=t.clearAxisValue)||void 0===r||r.call(t),null===(n=t.hide)||void 0===n||n.call(t)):s.forEach(e=>{let{axis:i,value:r}=e;t.clearAxisValue(),t.setAxisValue(r,i),t.layoutByValue()}))}}getColorScheme(){var t,e;return null===(e=(t=this._option).getTheme)||void 0===e?void 0:e.call(t).colorScheme}}class OF extends OD{constructor(){super(...arguments),this.transformerConstructor=OP,this.type="line",this.seriesType=cZ.line,this._canStack=!0}}OF.type="line",OF.seriesType=cZ.line,OF.transformerConstructor=OP;class Oj extends Te{constructor(){super(...arguments),this.type=Oj.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0})}_getIgnoreAttributes(){return[]}}Oj.type="area";let ON=()=>{de.registerMark(Oj.type,Oj),Aj(),Ma()};class Oz extends CB{constructor(){super(...arguments),this._getSeriesStyle=(t,e,i)=>{var r,n,s,a;for(let i of om(e)){let e=null===(r=this.series.getSeriesStyle(t))||void 0===r?void 0:r(i);if(!1!==e||"fill"!==i&&"stroke"!==i||(e="fill"===i?null===(s=null===(n=this.series.getSeriesStyle(t))||void 0===n?void 0:n("stroke"))||void 0===s?void 0:s[0]:null===(a=this.series.getSeriesStyle(t))||void 0===a?void 0:a("fill")),eO(e))return e}return i}}}let OH=()=>{Mr(),Mi(),w9()};class OV extends To{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){var e,i,r;super._transformLabelSpec(t),this._addMarkLabelSpec(t,"area","areaLabel","initLineLabelMarkStyle",void 0,!0),!1!==(null===(e=t.point)||void 0===e?void 0:e.visible)&&!1!==(null===(r=null===(i=t.point)||void 0===i?void 0:i.style)||void 0===r?void 0:r.visible)||this._addMarkLabelSpec(t,"area")}_transformSpecAfterMergingTheme(t,e,i){var r,n,s,a,o;super._transformSpecAfterMergingTheme(t,e,i);let{area:l={},line:h={},seriesMark:u}=t,d=!1!==l.visible&&!1!==(null===(r=l.style)||void 0===r?void 0:r.visible),c=!1!==h.visible&&!1!==(null===(n=h.style)||void 0===n?void 0:n.visible);l.support3d=!(!l.support3d&&!h.support3d),l.zIndex=eO(l.zIndex)||eO(h.zIndex)?Math.max(null!==(s=l.zIndex)&&void 0!==s?s:0,null!==(a=h.zIndex)&&void 0!==a?a:0):void 0,l.style&&delete l.style.stroke,l.state&&Object.keys(l.state).forEach(t=>{"style"in l.state[t]?delete l.state[t].style.stroke:delete l.state[t].stroke});let p=l,g=h;("line"===u||c&&!d)&&(p=h,g=l),l.style=us({},g.style,p.style),l.state=us({},g.state,p.state),d||(l.style.fill=!1),c||(l.style.stroke=!1),!1===l.interactive&&(l.style.fillPickable=!1),!1===h.interactive&&(h.style.strokePickable=!1),l.interactive=!(!l.interactive&&null!==(o=h.interactive)&&void 0!==o&&!o),l.visible=!(!d&&!c),t.area=l,t.line=h}}class OW extends C6{constructor(){super(...arguments),this.type=cZ.area,this.transformerConstructor=OV,this._sortDataByAxis=!1}initMark(){var t,e;let i={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},r=this._spec.area||{},n=!1!==r.visible&&!1!==(null===(t=r.style)||void 0===t?void 0:t.visible),s=null!==(e=this._spec.seriesMark)&&void 0!==e?e:"area";this._areaMark=this._createMark(OW.mark.area,{groupKey:this._seriesField,defaultMorphElementKey:this.getDimensionField()[0],progressive:i,isSeriesMark:n&&"point"!==s,customShape:r.customShape,stateSort:r.stateSort}),this.initSymbolMark(i,"point"===s)}initMarkStyle(){this.initAreaMarkStyle(),this.initSymbolMarkStyle()}initAreaMarkStyle(){var t,e,i,r,n;let s=null!==(i=null===(e=null===(t=this.getSpec().area)||void 0===t?void 0:t.style)||void 0===e?void 0:e.curveType)&&void 0!==i?i:null===(n=null===(r=this.getSpec().line)||void 0===r?void 0:r.style)||void 0===n?void 0:n.curveType,a=s===C9?"horizontal"===this._direction?"monotoneY":"monotoneX":s,o=this._areaMark;o&&("horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:t=>{var e,i;return Se(this.dataToPositionX1(t),null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,orient:this._direction},"normal",tw.Series):this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),y1:t=>{var e,i;return Se(this.dataToPositionY1(t),null===(i=null===(e=this._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",tw.Series),this.setMarkStyle(o,{fill:this.getColorAttribute(),stroke:this.getColorAttribute()},"normal",tw.Series),"zero"!==this._invalidType&&this.setMarkStyle(o,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",tw.Series),this.setMarkStyle(o,{curveType:a},"normal",tw.Built_In),Object.keys(o.stateStyle).forEach(t=>{o.stateStyle[t].stroke&&o.setPostProcess("stroke",t=>[t,!1,!1,!1],t)}))}initAnimation(){var t,e,i,r;let n={direction:this.direction},s=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;if(this._lineMark&&this._lineMark.setAnimationConfig(CX(null===(e=de.getAnimationInKey("line"))||void 0===e?void 0:e(n,s),Cq("line",this._spec,this._markAttributeContext))),this._areaMark&&this._areaMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("area"))||void 0===i?void 0:i(n,s),Cq("area",this._spec,this._markAttributeContext))),this._symbolMark){let t=C8(this);this._symbolMark.setAnimationConfig(CX(null===(r=de.getAnimationInKey("scaleInOut"))||void 0===r?void 0:r(),Cq("point",this._spec,this._markAttributeContext),t))}}initTooltip(){this._tooltipHelper=new Oz(this);let{dimension:t,group:e,mark:i}=this._tooltipHelper.activeTriggerSet;this._areaMark&&(t.add(this._areaMark),e.add(this._areaMark)),this._lineMark&&(t.add(this._lineMark),e.add(this._lineMark)),this._symbolMark&&(i.add(this._symbolMark),e.add(this._symbolMark))}viewDataStatisticsUpdate(t){super.viewDataStatisticsUpdate(t),this.encodeDefined(this._areaMark,"defined")}compile(){super.compile(),this.addSamplingCompile(),this.addOverlapCompile()}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._areaMark,this._symbolMark,this._lineMark]}onLayoutEnd(t){super.onLayoutEnd(t),this.reCompileSampling()}getSeriesStyle(t){return e=>{var i,r,n,s,a;let o=null!==(i=this._spec.seriesMark)&&void 0!==i?i:"area",l=null!==(n=null===(r=this._seriesMark)||void 0===r?void 0:r.getAttribute(e,t))&&void 0!==n?n:void 0;return"fill"!==e||l&&"line"!==o||(e="stroke",l=null!==(a=null===(s=this._seriesMark)||void 0===s?void 0:s.getAttribute(e,t))&&void 0!==a?a:void 0),"stroke"===e&&eM(l)?l[0]:l}}}OW.type=cZ.area,OW.mark=hF,OW.transformerConstructor=OV,CS(OW,Tt);let OG=()=>{Mb(),Mx(),Tr(),ON(),Ta(),OH(),Oy(),OA(),de.registerSeries(OW.type,OW)};class OU extends OO{_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{point:t.point,line:t.line,area:t.area,seriesMark:t.seriesMark,activePoint:t.activePoint,sampling:t.sampling,samplingFactor:t.samplingFactor,pointDis:t.pointDis,pointDisMul:t.pointDisMul,markOverlap:t.markOverlap,areaLabel:t.areaLabel})}transformSpec(t){super.transformSpec(t),bg(t)}}class O$ extends OD{constructor(){super(...arguments),this.transformerConstructor=OU,this.type="area",this.seriesType=cZ.area,this._canStack=!0}}O$.type="area",O$.seriesType=cZ.area,O$.transformerConstructor=OU;function OY(t,e=!0){return(i,r,n)=>{let s="vertical"===t.direction?t.yField:t.xField,a=null==i?void 0:i[s];return"vertical"===t.direction?{overall:e?t.growFrom():e,orient:a>0?"negative":"positive"}:{overall:!!e&&t.growFrom(),orient:a>0?"positive":"negative"}}}let OK=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:OY(t,e)}),OZ=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:OY(t,e)}),OX={type:"fadeIn"},Oq={type:"growCenterIn"};function OJ(t,e){if(!1===e)return{};switch(e){case"fadeIn":return OX;case"scaleIn":return Oq;default:return OK(t)}}let OQ=()=>{de.registerAnimation("bar",(t,e)=>({appear:OJ(t,e),enter:OK(t,!1),exit:OZ(t,!1),disappear:OZ(t)}))},O0=()=>{de.registerAnimation("bar3d",(t,e)=>({appear:OJ(t,e),enter:OK(t,!1),exit:OZ(t,!1),disappear:OZ(t)}))};class O1 extends Sd{constructor(){super(...arguments),this.type=O1.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,lineWidth:0})}}O1.type="rect";let O2=()=>{de.registerMark(O1.type,O1),AW(),Mn()};function O3(t,e,i,r,n,s){let a=i.getSpec().barMinHeight,o=i[r.axisHelper].isInverse(),l=Se(i[r.startMethod](t),n),h=Se(i[r.endMethod](t),n);s&&(e=l);let u=Math.abs(l-h);u<a&&(u=a);let d=1;return h<l?d=-1:h===l&&(d=r.isVertical?o?1:-1:o?-1:1),h=e+d*u,t[r.start]=e,t[r.end]=h,h}class O5 extends C3{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){this._addMarkLabelSpec(t,"bar")}}class O4 extends C6{constructor(){super(...arguments),this.type=cZ.bar,this._barMarkName="bar",this._barMarkType="rect",this.transformerConstructor=O5,this._bandPosition=0,this._getBarXStart=(t,e)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!1),t[hM]):this._spec.barMinHeight?this._calculateRectPosition(t,!1):Se(this._dataToPosX(t),e),this._getBarXEnd=(t,e)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!1),t[hC]):Se(this._dataToPosX1(t),e),this._getBarYStart=(t,e)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!0),t[hT]):this._spec.barMinHeight?this._calculateRectPosition(t,!0):Se(this._dataToPosY(t),e),this._getBarYEnd=(t,e)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!0),t[hE]):Se(this._dataToPosY1(t),e),this._getBarBackgroundXStart=t=>{let e=t.range();return Math.min(e[0],e[e.length-1])},this._getBarBackgroundXEnd=t=>{let e=t.range();return Math.max(e[0],e[e.length-1])},this._getBarBackgroundYStart=t=>{let e=t.range();return Math.min(e[0],e[e.length-1])},this._getBarBackgroundYEnd=t=>{let e=t.range();return Math.max(e[0],e[e.length-1])},this._getBarBackgroundPositionXEncoder=()=>{var t;return null===(t=this._barBackgroundPositionXEncoder)||void 0===t?void 0:t.bind(this)},this._setBarBackgroundPositionXEncoder=t=>{this._barBackgroundPositionXEncoder=t.bind(this)},this._getBarBackgroundPositionYEncoder=()=>{var t;return null===(t=this._barBackgroundPositionYEncoder)||void 0===t?void 0:t.bind(this)},this._setBarBackgroundPositionYEncoder=t=>{this._barBackgroundPositionYEncoder=t.bind(this)}}initMark(){var t,e;let i={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._initBarBackgroundMark(i),this._barMark=this._createMark(Object.assign(Object.assign({},O4.mark.bar),{name:this._barMarkName,type:this._barMarkType}),{morph:C0(this._spec,this._barMarkName),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,isSeriesMark:!0,progressive:i,customShape:null===(t=this._spec.bar)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.bar)||void 0===e?void 0:e.stateSort})}_initBarBackgroundMark(t){this._spec.barBackground&&this._spec.barBackground.visible&&(this._barBackgroundMark=this._createMark(O4.mark.barBackground,{dataView:this._barBackgroundViewData.getDataView(),dataProductId:this._barBackgroundViewData.getProductId(),progressive:t,customShape:this._spec.barBackground.customShape,stateSort:this._spec.barBackground.stateSort}))}initMarkStyle(){this._barMark&&this.setMarkStyle(this._barMark,{fill:this.getColorAttribute()},"normal",tw.Series)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null})}initTooltip(){super.initTooltip();let{mark:t,group:e}=this._tooltipHelper.activeTriggerSet;this._barMark&&(t.add(this._barMark),e.add(this._barMark))}_statisticViewData(){var t,e;let i;super._statisticViewData();let r=null!==(t=this._spec.barBackground)&&void 0!==t?t:{};if(!r.visible)return;let n=this._getRelatedComponentSpecInfo("axes").some(t=>t.type===lx.cartesianBandAxis);if(gw(this._option.dataSet,"addVChartProperty",CO),n)gw(this._option.dataSet,"dimensionItems",([t],{scaleDepth:e})=>{var i,r;let n=[{}],s=this.getDimensionField(),a=ej(e)?s.length:Math.min(s.length,e);for(let e=0;e<a;e++){let a=s[e],o=null===(i=t.latestData[a])||void 0===i?void 0:i.values;if(!(null==o?void 0:o.length))continue;let l=[],h=null!==(r=this._spec.dataKey)&&void 0!==r?r:bw;for(let t=0;t<o.length;t++)for(let e=0;e<n.length;e++)l.push(Object.assign(Object.assign({},n[e]),{[a]:o[t],[h]:o[t]}));n=l}return n}),i=new eH(this._option.dataSet).parse([this._viewDataStatistics],{type:"dataview"}).transform({type:"dimensionItems",options:{scaleDepth:ej(r.fieldLevel)?void 0:r.fieldLevel+1}},!1).transform({type:"addVChartProperty",options:{beforeCall:CU.bind(this),call:C$}},!1),null===(e=this._viewDataStatistics)||void 0===e||e.target.addListener("change",i.reRunAllTransform);else{gw(this._option.dataSet,"dimensionItems",([e])=>{let i=[],[r,n]=this.getDimensionContinuousField(),s={};return t.latestData.forEach(t=>{let e=`${t[r]}-${t[n]}`;s[e]||(s[e]={[r]:t[r],[n]:t[n]},i.push(s[e]))}),i});let t=this.getViewData();i=new eH(this._option.dataSet).parse([t],{type:"dataview"}).transform({type:"dimensionItems"},!1).transform({type:"addVChartProperty",options:{beforeCall:CU.bind(this),call:C$}},!1),null==t||t.target.addListener("change",i.reRunAllTransform)}this._barBackgroundViewData=new CH(this._option,i)}init(t){var e,i;super.init(t),"vertical"===this.direction?"band"===(null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle():"band"===(null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale(0).type)?this.initBandRectMarkStyle():this.initLinearRectMarkStyle()}_shouldDoPreCalculate(){let t=this.getRegion();return this.getStack()&&t.getSeries().filter(t=>t.type===this.type&&t.getSpec().barMinHeight).length}_calculateStackRectPosition(t){let e,i,r,n,s;let a=this.getRegion();if(a._bar_series_position_calculated)return;a._bar_series_position_calculated=!0,t?(e=hE,i=hT,r="_dataToPosY1",n="_dataToPosY",s="_yAxisHelper"):(e=hC,i=hM,r="_dataToPosX1",n="_dataToPosX",s="_xAxisHelper");let o=CE(a,!1,t=>t.type===this.type);for(let l in o)for(let h in o[l].nodes)!function t(e,i,r){var n,s;if(e.values.length>0){let t;if(e.sortDatums.length){let a=e.sortDatums;i&&(a=e.sortDatums.slice().reverse());for(let e=0;e<a.length;e++)t=O3(a[e].datum,t,a[e].series,r,null===(s=(n=a[e].series[r.axisHelper]).getScale)||void 0===s?void 0:s.call(n,0),0===e)}else{let n=e.series;i&&(n=n.slice().reverse()),n.forEach(({s:e,values:n},s)=>{var a,o;let l=null===(o=(a=e[r.axisHelper]).getScale)||void 0===o?void 0:o.call(a,0);for(let a=0;a<n.length;a++)t=O3(n[i?n.length-1-a:a],t,e,r,l,0===a&&0===s)})}}for(let n in e.nodes)t(e.nodes[n],i,r)}(o[l].nodes[h],a.getStackInverse(),{isVertical:t,start:e,end:i,startMethod:r,endMethod:n,axisHelper:s})}_calculateRectPosition(t,e){var i,r;let n,s,a;e?(n="_dataToPosY1",s="_dataToPosY",a="_yAxisHelper"):(n="_dataToPosX1",s="_dataToPosX",a="_xAxisHelper");let o=null===(r=(i=this[a]).getScale)||void 0===r?void 0:r.call(i,0),l=this[a].isInverse(),h=this._spec.barMinHeight,u=Se(this[n](t),o),d=Se(this[s](t),o),c=Math.abs(u-d);c<h&&(c=h);let p=1;return d<u?p=-1:d===u&&(p=e?l?1:-1:l?-1:1),u+p*c}_dataToPosX(t){return this.dataToPositionX(t)}_dataToPosX1(t){return this.dataToPositionX1(t)}_dataToPosY(t){return this.dataToPositionY(t)}_dataToPosY1(t){return this.dataToPositionY1(t)}initBandRectMarkStyle(){var t,e,i,r;let n=null===(e=null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale)||void 0===e?void 0:e.call(t,0),s=null===(r=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===r?void 0:r.call(i,0);"horizontal"===this.direction?this.setMarkStyle(this._barMark,{x:t=>this._getBarXStart(t,n),x1:t=>this._getBarXEnd(t,n),y:t=>this._getPosition(this.direction,t),height:()=>this._getBarWidth(this._yAxisHelper),width:()=>{},y1:()=>{}},"normal",tw.Series):this.setMarkStyle(this._barMark,{y:t=>this._getBarYStart(t,s),y1:t=>this._getBarYEnd(t,s),x:t=>this._getPosition(this.direction,t),width:()=>this._getBarWidth(this._xAxisHelper),x1:()=>{},height:()=>{}},"normal",tw.Series),this._initStackBarMarkStyle(),this._initBandBarBackgroundMarkStyle()}_initStackBarMarkStyle(){var t,e,i,r;if(!this._spec.stackCornerRadius)return;let n=null===(e=null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale)||void 0===e?void 0:e.call(t,0),s=null===(r=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===r?void 0:r.call(i,0);this._barMark.setClip(()=>{let t=[];return this._forEachStackGroup(e=>{let i=1/0,r=-Infinity,a=!1,o=1/0,l=-Infinity;e.values.forEach(t=>{let e=t[bE],n=t[bO],s=t[bP],h=t[bR];i=Math.min(i,e,n),r=Math.max(r,e,n),eO(s)&&eO(h)&&(a=!0,o=Math.min(o,s,h),l=Math.max(l,s,h))});let h=Object.assign(Object.assign(Object.assign({},e.values[0]),{[bE]:i,[bO]:r}),a?{[bP]:o,[bR]:l}:void 0);t.push(_4(Object.assign(Object.assign({},"horizontal"===this.direction?{x:this._getBarXStart(h,n),x1:this._getBarXEnd(h,n),y:this._getPosition(this.direction,h),height:this._getBarWidth(this._yAxisHelper)}:{y:this._getBarYStart(h,s),y1:this._getBarYEnd(h,s),x:this._getPosition(this.direction,h),width:this._getBarWidth(this._xAxisHelper)}),{cornerRadius:this._spec.stackCornerRadius,fill:!0})))}),t})}initLinearRectMarkStyle(){var t,e,i,r;let n=null===(e=null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale)||void 0===e?void 0:e.call(t,0),s=null===(r=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===r?void 0:r.call(i,0);if("horizontal"===this.direction){let t=eO(this._fieldY2)?{y:t=>Se(this._dataToPosY(t),s),y1:t=>Se(this._dataToPosY1(t),s)}:{y:t=>Se(this._dataToPosY(t)-this._getBarWidth(this._yAxisHelper)/2,s),height:t=>this._getBarWidth(this._yAxisHelper)};this.setMarkStyle(this._barMark,Object.assign({x:t=>this._getBarXStart(t,n),x1:t=>this._getBarXEnd(t,n)},t),"normal",tw.Series),this.setMarkStyle(this._barBackgroundMark,Object.assign({x:()=>this._getBarBackgroundXStart(n),x1:()=>this._getBarBackgroundXEnd(n)},t),"normal",tw.Series)}else{let t=eO(this._fieldX2)?{x:t=>Se(this._dataToPosX(t),n),x1:t=>Se(this._dataToPosX1(t),n)}:{x:t=>Se(this._dataToPosX(t)-this._getBarWidth(this._xAxisHelper)/2,n),width:t=>this._getBarWidth(this._xAxisHelper)};this.setMarkStyle(this._barMark,Object.assign(Object.assign({},t),{y:t=>this._getBarYStart(t,s),y1:t=>this._getBarYEnd(t,s)}),"normal",tw.Series),this.setMarkStyle(this._barBackgroundMark,Object.assign(Object.assign({},t),{y:()=>this._getBarBackgroundYStart(s),y1:()=>this._getBarBackgroundYEnd(s)}),"normal",tw.Series)}}_initBandBarBackgroundMarkStyle(){var t,e,i,r,n;if(!this._barBackgroundMark)return;let s=null===(e=null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale)||void 0===e?void 0:e.call(t,0),a=null===(r=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===r?void 0:r.call(i,0),o=null!==(n=this._spec.barBackground)&&void 0!==n?n:{},l=ej(o.fieldLevel)?void 0:o.fieldLevel+1;"horizontal"===this.direction?this.setMarkStyle(this._barBackgroundMark,{x:()=>this._getBarBackgroundXStart(s),x1:()=>this._getBarBackgroundXEnd(s),y:t=>this._getPosition(this.direction,t,l,"barBackground"),height:()=>this._getBarWidth(this._yAxisHelper,l),width:()=>{},y1:()=>{}},"normal",tw.Series):this.setMarkStyle(this._barBackgroundMark,{x:t=>this._getPosition(this.direction,t,l,"barBackground"),y:()=>this._getBarBackgroundYStart(a),y1:()=>this._getBarBackgroundYEnd(a),width:()=>this._getBarWidth(this._xAxisHelper,l),x1:()=>{},height:()=>{}},"normal",tw.Series)}initAnimation(){var t,e;let i={yField:this._fieldY[0],xField:this._fieldX[0],direction:this.direction,growFrom:()=>{var t,e;return"horizontal"===this.direction?null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=this._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},r=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset,n=C8(this);this._barMark.setAnimationConfig(CX(null===(e=de.getAnimationInKey("bar"))||void 0===e?void 0:e(i,r),Cq(this._barMarkName,this._spec,this._markAttributeContext),n))}_getBarWidth(t,e){var i,r;let n=this._groups?this._groups.fields.length:1,s=ej(e)?n:Math.min(n,e),a=null!==(r=null===(i=t.getBandwidth)||void 0===i?void 0:i.call(t,s-1))&&void 0!==r?r:6,o=void 0!==this._spec.barWidth&&s===n,l=void 0!==this._spec.barMinWidth,h=void 0!==this._spec.barMaxWidth,u=a;return o&&(u=hn(this._spec.barWidth,a)),l&&(u=Math.max(u,hn(this._spec.barMinWidth,a))),h&&(u=Math.min(u,hn(this._spec.barMaxWidth,a))),u}_getPosition(t,e,i,r){var n,s,a,o,l;let h,u,d;"horizontal"===t?(h=this.getYAxisHelper(),u="height",d="barBackground"===r?this.dataToBarBackgroundPositionY.bind(this):this.dataToPositionY.bind(this)):(h=this.getXAxisHelper(),u="width",d="barBackground"===r?this.dataToBarBackgroundPositionX.bind(this):this.dataToPositionX.bind(this));let c=h.getScale(0),p=this._groups?this._groups.fields.length:1,g=ej(i)?p:Math.min(p,i),f=null!==(s=null===(n=h.getBandwidth)||void 0===n?void 0:n.call(h,g-1))&&void 0!==s?s:6,m=g===p?this._barMark.getAttribute(u,e):f;if(g>1&&eO(this._spec.barGapInGroup)){let t=this._groups.fields,i=om(this._spec.barGapInGroup),r=0,n=0;for(let s=t.length-1;s>=1;s--){let u=t[s],d=null!==(o=null===(a=h.getScale(s))||void 0===a?void 0:a.domain())&&void 0!==o?o:[],c=d.length,p=hn(null!==(l=i[s-1])&&void 0!==l?l:ov(i),f),g=d.indexOf(e[u]);s===t.length-1?(r+=c*m+(c-1)*p,n+=g*(m+p)):(n+=g*(r+p),r+=r+(c-1)*p)}return c.scale(e[t[0]])+h.getBandwidth(0)/2-r/2+n}let v=dr(c.type||"band");return d(e,g)+.5*(f-m)+(v?-f/2:0)}dataToBarBackgroundPositionX(t,e){return this._dataToPosition(t,this._xAxisHelper,this.fieldX,e,this._getBarBackgroundPositionXEncoder,this._setBarBackgroundPositionXEncoder)}dataToBarBackgroundPositionY(t,e){return this._dataToPosition(t,this._yAxisHelper,this.fieldY,e,this._getBarBackgroundPositionYEncoder,this._setBarBackgroundPositionYEncoder)}onLayoutEnd(t){super.onLayoutEnd(t),this.getRegion()._bar_series_position_calculated=!1,this._spec.sampling&&this.compile()}compile(){if(super.compile(),this._spec.sampling){let{width:t,height:e}=this._region.getLayoutRect(),i=[],r=this._fieldY,n=this._fieldX;i.push({type:"sampling",size:"horizontal"===this._direction?e:t,factor:this._spec.samplingFactor,yfield:"horizontal"===this._direction?n[0]:r[0],groupBy:this._seriesField,mode:this._spec.sampling}),this._data.getProduct().transform(i)}}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._barMark]}compileData(){var t;super.compileData(),null===(t=this._barBackgroundViewData)||void 0===t||t.compile()}fillData(){var t,e;super.fillData(),null===(e=null===(t=this._barBackgroundViewData)||void 0===t?void 0:t.getDataView())||void 0===e||e.reRunAllTransform()}viewDataUpdate(t){var e,i,r;super.viewDataUpdate(t),null===(i=null===(e=this._barBackgroundViewData)||void 0===e?void 0:e.getDataView())||void 0===i||i.reRunAllTransform(),null===(r=this._barBackgroundViewData)||void 0===r||r.updateData()}release(){var t;super.release(),null===(t=this._barBackgroundViewData)||void 0===t||t.release(),this._barBackgroundViewData=null}}O4.type=cZ.bar,O4.mark=hR,O4.transformerConstructor=O5;let O8=()=>{Mb(),O2(),OQ(),Oy(),OA(),de.registerSeries(O4.type,O4)};class O6 extends OO{_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{barWidth:t.barWidth,barMaxWidth:t.barMaxWidth,barMinWidth:t.barMinWidth,barGapInGroup:t.barGapInGroup,barMinHeight:t.barMinHeight,sampling:t.sampling,samplingFactor:t.samplingFactor,barBackground:t.barBackground,stackCornerRadius:t.stackCornerRadius})}transformSpec(t){super.transformSpec(t),bg(t)}_transformAxisSpec(t){var e,i;if(super._transformAxisSpec(t),!t.axes)return;let r=t.series.some(t=>"horizontal"===t.direction),n=null!==(e=t.axes.find(t=>"band"===t.type))&&void 0!==e?e:t.axes.find(t=>(r?["left","right"]:["top","bottom"]).includes(t.orient));if(n&&!n.bandSize&&!n.maxBandSize&&!n.minBandSize&&t.autoBandSize){let e=nb(t.autoBandSize)&&null!==(i=t.autoBandSize.extend)&&void 0!==i?i:0,{barMaxWidth:r,barMinWidth:s,barWidth:a,barGapInGroup:o}=t.series.find(t=>"bar"===t.type);this._applyAxisBandSize(n,e,{barMaxWidth:r,barMinWidth:s,barWidth:a,barGapInGroup:o})}}}class O9 extends OD{constructor(){super(...arguments),this.transformerConstructor=O6,this.type="bar",this.seriesType=cZ.bar,this._canStack=!0}}O9.type="bar",O9.seriesType=cZ.bar,O9.transformerConstructor=O6;class O7 extends Sd{constructor(){super(...arguments),this.type=O7.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,length:3})}}O7.type="rect3d";let Pt=()=>{de.registerMark(O7.type,O7),AG(),Mn()};class Pe extends O4{constructor(){super(...arguments),this.type=cZ.bar3d,this._barMarkName="bar3d",this._barMarkType="rect3d"}}Pe.type=cZ.bar3d,Pe.mark=hB;let Pi=()=>{O0(),Pt(),Oy(),OA(),de.registerSeries(Pe.type,Pe)};class Pr extends O6{_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{barWidth:t.barWidth,barMaxWidth:t.barMaxWidth,barMinWidth:t.barMinWidth,barGapInGroup:t.barGapInGroup})}}class Pn extends O9{constructor(){super(...arguments),this.transformerConstructor=Pr,this.type="bar3d",this.seriesType=cZ.bar3d}}Pn.type="bar3d",Pn.seriesType=cZ.bar3d,Pn.transformerConstructor=Pr;let Ps=t=>"string"==typeof t&&!isNaN(Number(t))&&!isNaN(parseFloat(t)),Pa=[10,20],Po=c0.Linear,Pl="circle",Ph=c0.Ordinal,Pu=["circle","square","triangle","diamond","star"],Pd=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"},Pc=()=>{de.registerAnimation("scatter",(t,e)=>Object.assign({appear:Pd(0,e)},w8))};class Pp extends C3{_transformLabelSpec(t){this._addMarkLabelSpec(t,"point")}}class Pg extends C6{constructor(){super(...arguments),this.type=cZ.scatter,this.transformerConstructor=Pp,this._invalidType="zero"}setAttrFromSpec(){super.setAttrFromSpec(),this._size=this._spec.size,this._sizeField=this._spec.sizeField,this._shape=this._spec.shape,this._shapeField=this._spec.shapeField}_getSeriesAttribute(t,e,{defaultScaleType:i,defaultRange:r},n){var s,a,o,l;if(nx(e))return e;if(eM(e)){if(ej(t))return null===(s=this._option)||void 0===s||s.onError(`${n}Field is required.`),e;if("ordinal"!==i&&e.length>2)return null===(a=this._option)||void 0===a||a.onError(`${n} length is invalid, specify up to 2 ${n}s.`),e;let r=`${hA}_series_scatter_${this.id}_scale_${n}`;return this._option.globalScale.registerModelScale({id:r,type:i,domain:[{dataId:this._rawData.name,fields:[t]}],range:e}),{scale:r,field:t}}if(nb(e)){if(ej(t))return null===(o=this._option)||void 0===o||o.onError(`${n}Field is required.`),e;let s=Object.assign({id:`${hA}_series_scatter_${this.id}_scale_${n}`,type:i,domain:[{dataId:this._rawData.name,fields:[t]}],range:r},e);return this._option.globalScale.registerModelScale(s),{scale:s.id,field:t}}return null===(l=this._option)||void 0===l||l.onError(`${n} attribute is invalid.`),e}getSizeAttribute(t,e){return ej(e)?10:ey(e)?e:eE(e)&&Ps(e)?parseFloat(e):this._getSeriesAttribute(t,e,{defaultScaleType:Po,defaultRange:Pa},"size")}getShapeAttribute(t,e){return ej(e)?Pl:eE(e)?e:this._getSeriesAttribute(t,e,{defaultScaleType:Ph,defaultRange:Pu},"shape")}initMark(){var t,e;let i={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._symbolMark=this._createMark(Pg.mark.point,{morph:C0(this._spec,Pg.mark.point.name),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,progressive:i,isSeriesMark:!0,customShape:null===(t=this._spec.point)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.point)||void 0===e?void 0:e.stateSort})}initMarkStyle(){this.initSymbolMarkStyle()}initAnimation(){var t,e,i;let r=C8(this),n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._symbolMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("scatter"))||void 0===i?void 0:i({},n),Cq("point",this._spec,this._markAttributeContext),r))}initSymbolMarkStyle(){let t=this._symbolMark;t&&("zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)}),this.setMarkStyle(t,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,fill:this.getColorAttribute(),size:ey(this._size)||nx(this._size)?this._size:10,symbolType:eE(this._shape)||nx(this._shape)?this._shape:Pl},tk.STATE_NORMAL,tw.Series),(eO(this._sizeField)||eO(this._size))&&this.setMarkStyle(t,{size:this.getSizeAttribute(this._sizeField,this._size)},tk.STATE_NORMAL,tw.User_Mark),(eO(this._shapeField)||eO(this._shape))&&this.setMarkStyle(t,{symbolType:this.getShapeAttribute(this._shapeField,this._shape)},tk.STATE_NORMAL,tw.User_Mark))}initTooltip(){super.initTooltip(),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)}viewDataStatisticsUpdate(t){super.viewDataStatisticsUpdate(t);let e=[this.getDimensionField()[0],this.getStackValueField()].every(t=>{var e,i,r;return t&&(null===(r=null===(i=null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i[t])||void 0===r?void 0:r.allValid)});"zero"===this._invalidType||e?this.setMarkStyle(this._symbolMark,{visible:!0},"normal",tw.Series):this.setMarkStyle(this._symbolMark,{visible:this._getInvalidDefined.bind(this)},"normal",tw.Series),this._symbolMark.getProduct()&&this._symbolMark.compileEncode()}initLabelMarkStyle(t){t&&(this._labelMark=t,this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null},tk.STATE_NORMAL,tw.Series),"zero"!==this._invalidType&&this.setMarkStyle(t,{visible:this._getInvalidDefined.bind(this)},tk.STATE_NORMAL,tw.Series))}handleZoom(t){var e,i;this.getMarksWithoutRoot().forEach(t=>{let e=t.getProduct();e&&e.elements&&e.elements.length&&e.elements.forEach((t,e)=>{let i=t.getGraphicItem(),r=t.getDatum(),n=this.dataToPosition(r);n&&i&&i.translateTo(n.x,n.y)})});let r=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getProduct();r&&r.evaluate(null,null)}handlePan(t){var e,i;this.getMarksWithoutRoot().forEach(t=>{let e=t.getProduct();e&&e.elements&&e.elements.length&&e.elements.forEach((t,e)=>{let i=t.getGraphicItem(),r=t.getDatum(),n=this.dataToPosition(r);n&&i&&i.translateTo(n.x,n.y)})});let r=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getProduct();r&&r.evaluate(null,null)}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._symbolMark]}}Pg.type=cZ.scatter,Pg.mark=hD,Pg.transformerConstructor=Pp;let Pf=()=>{Ta(),Pc(),Oy(),OA(),de.registerSeries(Pg.type,Pg)};class Pm extends OO{_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{point:t.point,size:t.size,sizeField:t.sizeField,shape:t.shape,shapeField:t.shapeField})}}class Pv extends OD{constructor(){super(...arguments),this.transformerConstructor=Pm,this.type="scatter",this.seriesType=cZ.scatter,this._canStack=!0}}Pv.type="scatter",Pv.seriesType=cZ.scatter,Pv.transformerConstructor=Pm;function Py(){var t,e=[];return{point:function(e,i,r){t.push([e,i,r])},lineStart:function(){e.push(t=[])},lineEnd:ck,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function P_(t,e){return 1e-6>cu(t[0]-e[0])&&1e-6>cu(t[1]-e[1])}function Pb(t,e,i,r){this.x=t,this.z=e,this.o=i,this.e=r,this.v=!1,this.n=this.p=null}function Px(t,e,i,r,n){var s,a,o=[],l=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,i,r=t[0],a=t[e];if(P_(r,a)){if(!r[2]&&!a[2]){for(n.lineStart(),s=0;s<e;++s)n.point((r=t[s])[0],r[1]);n.lineEnd();return}a[0]+=2e-6}o.push(i=new Pb(r,t,null,!0)),l.push(i.o=new Pb(r,null,i,!1)),o.push(i=new Pb(a,t,null,!1)),l.push(i.o=new Pb(a,null,i,!0))}}),o.length){for(l.sort(e),PS(o),PS(l),s=0,a=l.length;s<a;++s)l[s].e=i=!i;for(var h,u,d=o[0];;){for(var c=d,p=!0;c.v;)if((c=c.n)===d)return;h=c.z,n.lineStart();do{if(c.v=c.o.v=!0,c.e){if(p)for(s=0,a=h.length;s<a;++s)n.point((u=h[s])[0],u[1]);else r(c.x,c.n.x,1,n);c=c.n}else{if(p)for(s=(h=c.p.z).length-1;s>=0;--s)n.point((u=h[s])[0],u[1]);else r(c.x,c.p.x,-1,n);c=c.p}h=(c=c.o).z,p=!p}while(!c.v);n.lineEnd()}}}function PS(t){if(e=t.length){for(var e,i,r=0,n=t[0];++r<e;)n.n=i=t[r],i.p=n,n=i;n.n=i=t[0],i.p=n}}function Pk(t){return[cc(t[1],t[0]),cS(t[2])]}function PA(t){var e=t[0],i=t[1],r=cp(i);return[r*cp(e),r*cv(e),cv(i)]}function Pw(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function PM(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function PC(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function PT(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function PE(t){var e=c_(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var PO=new ce;function PP(t){return cu(t[0])<=cn?t[0]:cy(t[0])*((cu(t[0])+cn)%co-cn)}function PR(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var PB=(1===(tH=PR).length&&(tH=function(t){return function(e,i){return PR(t(e),i)}}(tH)),{left:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){var n=i+r>>>1;0>tH(t[n],e)?i=n+1:r=n}return i},right:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){var n=i+r>>>1;tH(t[n],e)>0?r=n:i=n+1}return i}});PB.right,PB.left;var PI=Array.prototype;function PL(t){for(var e,i,r,n=t.length,s=-1,a=0;++s<n;)a+=t[s].length;for(i=Array(a);--n>=0;)for(e=(r=t[n]).length;--e>=0;)i[--a]=r[e];return i}function PD(t,e,i,r){return function(n){var s,a,o,l=e(n),h=Py(),u=e(h),d=!1,c={point:p,lineStart:f,lineEnd:m,polygonStart:function(){c.point=v,c.lineStart=y,c.lineEnd=_,a=[],s=[]},polygonEnd:function(){c.point=p,c.lineStart=f,c.lineEnd=m,a=PL(a);var t=function(t,e){var i=PP(e),r=e[1],n=cv(r),s=[cv(i),-cp(i),0],a=0,o=0;PO.reset(),1===n?r=cs+1e-6:-1===n&&(r=-cs-1e-6);for(var l=0,h=t.length;l<h;++l)if(d=(u=t[l]).length){for(var u,d,c=u[d-1],p=PP(c),g=c[1]/2+ca,f=cv(g),m=cp(g),v=0;v<d;++v,p=_,f=x,m=S,c=y){var y=u[v],_=PP(y),b=y[1]/2+ca,x=cv(b),S=cp(b),k=_-p,A=k>=0?1:-1,w=A*k,M=w>cn,C=f*x;if(PO.add(cc(C*A*cv(w),m*S+C*cp(w))),a+=M?k+A*co:k,M^p>=i^_>=i){var T=PM(PA(c),PA(y));PE(T);var E=PM(s,T);PE(E);var O=(M^k>=0?-1:1)*cS(E[2]);(r>O||r===O&&(T[0]||T[1]))&&(o+=M^k>=0?1:-1)}}}return(a<-.000001||a<1e-6&&PO<-.000001)^1&o}(s,r);a.length?(!d&&(n.polygonStart(),d=!0),Px(a,Pj,t,i,n)):t&&(!d&&(n.polygonStart(),d=!0),n.lineStart(),i(null,null,1,n),n.lineEnd()),d&&(n.polygonEnd(),d=!1),a=s=null},sphere:function(){n.polygonStart(),n.lineStart(),i(null,null,1,n),n.lineEnd(),n.polygonEnd()}};function p(e,i){t(e,i)&&n.point(e,i)}function g(t,e){l.point(t,e)}function f(){c.point=g,l.lineStart()}function m(){c.point=p,l.lineEnd()}function v(t,e){o.push([t,e]),u.point(t,e)}function y(){u.lineStart(),o=[]}function _(){v(o[0][0],o[0][1]),u.lineEnd();var t,e,i,r,l=u.clean(),c=h.result(),p=c.length;if(o.pop(),s.push(o),o=null,p){if(1&l){if((e=(i=c[0]).length-1)>0){for(!d&&(n.polygonStart(),d=!0),n.lineStart(),t=0;t<e;++t)n.point((r=i[t])[0],r[1]);n.lineEnd()}return}p>1&&2&l&&c.push(c.pop().concat(c.shift())),a.push(c.filter(PF))}}return c}}function PF(t){return t.length>1}function Pj(t,e){return((t=t.x)[0]<0?t[1]-cs-1e-6:cs-t[1])-((e=e.x)[0]<0?e[1]-cs-1e-6:cs-e[1])}PI.slice,PI.map;let PN=PD(function(){return!0},function(t){var e,i=NaN,r=NaN,n=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(s,a){var o=s>0?cn:-cn,l=cu(s-i);1e-6>cu(l-cn)?(t.point(i,r=(r+a)/2>0?cs:-cs),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),t.point(s,r),e=0):n!==o&&l>=cn&&(1e-6>cu(i-n)&&(i-=1e-6*n),1e-6>cu(s-o)&&(s-=1e-6*o),r=function(t,e,i,r){var n,s,a=cv(t-i);return cu(a)>1e-6?cd((cv(e)*(s=cp(r))*cv(i)-cv(r)*(n=cp(e))*cv(t))/(n*s*a)):(e+r)/2}(i,r,s,a),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),e=0),t.point(i=s,r=a),n=o},lineEnd:function(){t.lineEnd(),i=r=NaN},clean:function(){return 2-e}}},function(t,e,i,r){var n;if(null==t)n=i*cs,r.point(-cn,n),r.point(0,n),r.point(cn,n),r.point(cn,0),r.point(cn,-n),r.point(0,-n),r.point(-cn,-n),r.point(-cn,0),r.point(-cn,n);else if(cu(t[0]-e[0])>1e-6){var s=t[0]<e[0]?cn:-cn;n=i*s/2,r.point(-s,n),r.point(0,n),r.point(s,n)}else r.point(e[0],e[1])},[-cn,-cs]);function Pz(t,e){e=PA(e),e[0]-=t,PE(e);var i=cx(-e[1]);return((0>-e[2]?-i:i)+co-1e-6)%co}var PH=-1e9;function PV(t,e,i,r){function n(n,s){return t<=n&&n<=i&&e<=s&&s<=r}function s(n,s,o,h){var u=0,d=0;if(null==n||(u=a(n,o))!==(d=a(s,o))||0>l(n,s)^o>0)do h.point(0===u||3===u?t:i,u>1?r:e);while((u=(u+o+4)%4)!==d);else h.point(s[0],s[1])}function a(r,n){return 1e-6>cu(r[0]-t)?n>0?0:3:1e-6>cu(r[0]-i)?n>0?2:1:1e-6>cu(r[1]-e)?n>0?1:0:n>0?3:2}function o(t,e){return l(t.x,e.x)}function l(t,e){var i=a(t,1),r=a(e,1);return i!==r?i-r:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(a){var l,h,u,d,c,p,g,f,m,v,y,_=a,b=Py(),x={point:S,lineStart:function(){x.point=k,h&&h.push(u=[]),v=!0,m=!1,g=f=NaN},lineEnd:function(){l&&(k(d,c),p&&m&&b.rejoin(),l.push(b.result())),x.point=S,m&&_.lineEnd()},polygonStart:function(){_=b,l=[],h=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,n=h.length;i<n;++i)for(var s,a,o=h[i],l=1,u=o.length,d=o[0],c=d[0],p=d[1];l<u;++l)s=c,a=p,c=(d=o[l])[0],p=d[1],a<=r?p>r&&(c-s)*(r-a)>(p-a)*(t-s)&&++e:p<=r&&(c-s)*(r-a)<(p-a)*(t-s)&&--e;return e}(),i=y&&e,n=(l=PL(l)).length;(i||n)&&(a.polygonStart(),i&&(a.lineStart(),s(null,null,1,a),a.lineEnd()),n&&Px(l,o,e,s,a),a.polygonEnd()),_=a,l=h=u=null}};function S(t,e){n(t,e)&&_.point(t,e)}function k(s,a){var o=n(s,a);if(h&&u.push([s,a]),v)d=s,c=a,p=o,v=!1,o&&(_.lineStart(),_.point(s,a));else if(o&&m)_.point(s,a);else{var l=[g=Math.max(PH,Math.min(1e9,g)),f=Math.max(PH,Math.min(1e9,f))],b=[s=Math.max(PH,Math.min(1e9,s)),a=Math.max(PH,Math.min(1e9,a))];(function(t,e,i,r,n,s){var a,o=t[0],l=t[1],h=e[0],u=e[1],d=0,c=1,p=h-o,g=u-l;if(a=i-o,!p&&a>0)return;if(a/=p,p<0){if(a<d)return;a<c&&(c=a)}else if(p>0){if(a>c)return;a>d&&(d=a)}if(a=n-o,!p&&a<0)return;if(a/=p,p<0){if(a>c)return;a>d&&(d=a)}else if(p>0){if(a<d)return;a<c&&(c=a)}if(a=r-l,!!g||!(a>0)){if(a/=g,g<0){if(a<d)return;a<c&&(c=a)}else if(g>0){if(a>c)return;a>d&&(d=a)}if(a=s-l,g||!(a<0)){if(a/=g,g<0){if(a>c)return;a>d&&(d=a)}else if(g>0){if(a<d)return;a<c&&(c=a)}return d>0&&(t[0]=o+d*p,t[1]=l+d*g),c<1&&(e[0]=o+c*p,e[1]=l+c*g),!0}}})(l,b,t,e,i,r)?(!m&&(_.lineStart(),_.point(l[0],l[1])),_.point(b[0],b[1]),!o&&_.lineEnd(),y=!1):o&&(_.lineStart(),_.point(s,a),y=!1)}g=s,f=a,m=o}return x}}function PW(t,e){function i(i,r){return e((i=t(i,r))[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,r){return(i=e.invert(i,r))&&t.invert(i[0],i[1])}),i}function PG(t,e){return[cu(t)>cn?t+Math.round(-t/co)*co:t,e]}function PU(t,e,i){return(t%=co)?e||i?PW(PY(t),PK(e,i)):PY(t):e||i?PK(e,i):PG}function P$(t){return function(e,i){return[(e+=t)>cn?e-co:e<-cn?e+co:e,i]}}function PY(t){var e=P$(t);return e.invert=P$(-t),e}function PK(t,e){var i=cp(t),r=cv(t),n=cp(e),s=cv(e);function a(t,e){var a=cp(e),o=cp(t)*a,l=cv(t)*a,h=cv(e),u=h*i+o*r;return[cc(l*n-u*s,o*i-h*r),cS(u*n+l*s)]}return a.invert=function(t,e){var a=cp(e),o=cp(t)*a,l=cv(t)*a,h=cv(e),u=h*n-l*s;return[cc(l*n+h*s,o*i+u*r),cS(u*i-o*r)]},a}PG.invert=PG;function PZ(t){return function(e){var i=new PX;for(var r in t)i[r]=t[r];return i.stream=e,i}}function PX(){}function Pq(t,e,i){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),d7(i,t.stream(pA)),e(pA.result()),null!=r&&t.clipExtent(r),t}function PJ(t,e,i){return Pq(t,function(i){var r=e[1][0]-e[0][0],n=e[1][1]-e[0][1],s=Math.min(r/(i[1][0]-i[0][0]),n/(i[1][1]-i[0][1])),a=+e[0][0]+(r-s*(i[1][0]+i[0][0]))/2,o=+e[0][1]+(n-s*(i[1][1]+i[0][1]))/2;t.scale(150*s).translate([a,o])},i)}function PQ(t,e,i){return PJ(t,[[0,0],e],i)}function P0(t,e,i){return Pq(t,function(i){var r=+e,n=r/(i[1][0]-i[0][0]),s=(r-n*(i[1][0]+i[0][0]))/2,a=-n*i[0][1];t.scale(150*n).translate([s,a])},i)}function P1(t,e,i){return Pq(t,function(i){var r=+e,n=r/(i[1][1]-i[0][1]),s=-n*i[0][0],a=(r-n*(i[1][1]+i[0][1]))/2;t.scale(150*n).translate([s,a])},i)}PX.prototype={constructor:PX,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var P2=cp(30*ch);function P3(t,e){return+e?function(t,e){function i(r,n,s,a,o,l,h,u,d,c,p,g,f,m){var v=h-r,y=u-n,_=v*v+y*y;if(_>4*e&&f--){var b=a+c,x=o+p,S=l+g,k=c_(b*b+x*x+S*S),A=cS(S/=k),w=1e-6>cu(cu(S)-1)||1e-6>cu(s-d)?(s+d)/2:cc(x,b),M=t(w,A),C=M[0],T=M[1],E=C-r,O=T-n,P=y*E-v*O;(P*P/_>e||cu((v*E+y*O)/_-.5)>.3||a*c+o*p+l*g<P2)&&(i(r,n,s,a,o,l,C,T,w,b/=k,x/=k,S,f,m),m.point(C,T),i(C,T,w,b,x,S,h,u,d,c,p,g,f,m))}}return function(e){var r,n,s,a,o,l,h,u,d,c,p,g,f={point:m,lineStart:v,lineEnd:_,polygonStart:function(){e.polygonStart(),f.lineStart=b},polygonEnd:function(){e.polygonEnd(),f.lineStart=v}};function m(i,r){i=t(i,r),e.point(i[0],i[1])}function v(){u=NaN,f.point=y,e.lineStart()}function y(r,n){var s=PA([r,n]),a=t(r,n);i(u,d,h,c,p,g,u=a[0],d=a[1],h=r,c=s[0],p=s[1],g=s[2],16,e),e.point(u,d)}function _(){f.point=m,e.lineEnd()}function b(){v(),f.point=x,f.lineEnd=S}function x(t,e){y(r=t,e),n=u,s=d,a=c,o=p,l=g,f.point=y}function S(){i(u,d,h,c,p,g,n,s,r,a,o,l,16,e),f.lineEnd=_,_()}return f}}(t,e):function(t){return PZ({point:function(e,i){e=t(e,i),this.stream.point(e[0],e[1])}})}(t)}var P5=PZ({point:function(t,e){this.stream.point(t*ch,e*ch)}});function P4(t,e,i,r,n,s){var a=cp(s),o=cv(s),l=a*t,h=o*t,u=a/t,d=o/t,c=(o*i-a*e)/t,p=(o*e+a*i)/t;function g(t,s){return[l*(t*=r)-h*(s*=n)+e,i-h*t-l*s]}return g.invert=function(t,e){return[r*(u*t-d*e+c),n*(p-d*t-u*e)]},g}function P8(t){return P6(function(){return t})()}function P6(t){var e,i,r,n,s,a,o,l,h,u,d=150,c=480,p=250,g=0,f=0,m=0,v=0,y=0,_=0,b=1,x=1,S=null,k=PN,A=null,w=d3,M=.5;function C(t){return l(t[0]*ch,t[1]*ch)}function T(t){return(t=l.invert(t[0],t[1]))&&[t[0]*cl,t[1]*cl]}function E(){var t=P4(d,0,0,b,x,_).apply(null,e(g,f)),r=(_?P4:function(t,e,i,r,n){function s(s,a){return[e+t*(s*=r),i-t*(a*=n)]}return s.invert=function(s,a){return[(s-e)/t*r,(i-a)/t*n]},s})(d,c-t[0],p-t[1],b,x,_);return i=PU(m,v,y),o=PW(e,r),l=PW(i,o),a=P3(o,M),O()}function O(){return h=u=null,C}return C.stream=function(t){var e;return h&&u===t?h:h=P5((e=i,PZ({point:function(t,i){var r=e(t,i);return this.stream.point(r[0],r[1])}}))(k(a(w(u=t)))))},C.preclip=function(t){return arguments.length?(k=t,S=void 0,O()):k},C.postclip=function(t){return arguments.length?(w=t,A=r=n=s=null,O()):w},C.clipAngle=function(t){return arguments.length?(k=+t?function(t){var e=cp(t),i=6*ch,r=e>0,n=cu(e)>1e-6;function s(t,i){return cp(t)*cp(i)>e}function a(t,i,r){var n=PA(t),s=PA(i),a=[1,0,0],o=PM(n,s),l=Pw(o,o),h=o[0],u=l-h*h;if(!u)return!r&&t;var d=PM(a,o),c=PT(a,e*l/u);PC(c,PT(o,-e*h/u));var p=Pw(c,d),g=Pw(d,d),f=p*p-g*(Pw(c,c)-1);if(!(f<0)){var m=c_(f),v=PT(d,(-p-m)/g);if(PC(v,c),v=Pk(v),!r)return v;var y,_=t[0],b=i[0],x=t[1],S=i[1];b<_&&(y=_,_=b,b=y);var k=b-_,A=1e-6>cu(k-cn);if(!A&&S<x&&(y=x,x=S,S=y),A||k<1e-6?A?x+S>0^v[1]<(1e-6>cu(v[0]-_)?x:S):x<=v[1]&&v[1]<=S:k>cn^(_<=v[0]&&v[0]<=b)){var w=PT(d,(-p+m)/g);return PC(w,c),[v,Pk(w)]}}}function o(e,i){var n=r?t:cn-t,s=0;return e<-n?s|=1:e>n&&(s|=2),i<-n?s|=4:i>n&&(s|=8),s}return PD(s,function(t){var e,i,l,h,u;return{lineStart:function(){h=l=!1,u=1},point:function(d,c){var p,g,f=[d,c],m=s(d,c),v=r?m?0:o(d,c):m?o(d+(d<0?cn:-cn),c):0;!e&&(h=l=m)&&t.lineStart(),m!==l&&(!(g=a(e,f))||P_(e,g)||P_(f,g))&&(f[2]=1),m!==l?(u=0,m?(t.lineStart(),g=a(f,e),t.point(g[0],g[1])):(g=a(e,f),t.point(g[0],g[1],2),t.lineEnd()),e=g):n&&e&&r^m&&!(v&i)&&(p=a(f,e,!0))&&(u=0,r?(t.lineStart(),t.point(p[0][0],p[0][1]),t.point(p[1][0],p[1][1]),t.lineEnd()):(t.point(p[1][0],p[1][1]),t.lineEnd(),t.lineStart(),t.point(p[0][0],p[0][1],3))),m&&(!e||!P_(e,f))&&t.point(f[0],f[1]),e=f,l=m,i=v},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return u|(h&&l)<<1}}},function(e,r,n,s){!function(t,e,i,r,n,s){if(i){var a=cp(e),o=cv(e),l=r*i;null==n?(n=e+r*co,s=e-l/2):(n=Pz(a,n),s=Pz(a,s),(r>0?n<s:n>s)&&(n+=r*co));for(var h,u=n;r>0?u>s:u<s;u-=l)h=Pk([a,-o*cp(u),-o*cv(u)]),t.point(h[0],h[1])}}(s,t,i,n,e,r)},r?[0,-t]:[-cn,t-cn])}(S=t*ch):(S=null,PN),O()):S*cl},C.clipExtent=function(t){return arguments.length?(w=null==t?(A=r=n=s=null,d3):PV(A=+t[0][0],r=+t[0][1],n=+t[1][0],s=+t[1][1]),O()):null==A?null:[[A,r],[n,s]]},C.scale=function(t){return arguments.length?(d=+t,E()):d},C.translate=function(t){return arguments.length?(c=+t[0],p=+t[1],E()):[c,p]},C.center=function(t){return arguments.length?(g=t[0]%360*ch,f=t[1]%360*ch,E()):[g*cl,f*cl]},C.rotate=function(t){return arguments.length?(m=t[0]%360*ch,v=t[1]%360*ch,y=t.length>2?t[2]%360*ch:0,E()):[m*cl,v*cl,y*cl]},C.angle=function(t){return arguments.length?(_=t%360*ch,E()):_*cl},C.reflectX=function(t){return arguments.length?(b=t?-1:1,E()):b<0},C.reflectY=function(t){return arguments.length?(x=t?-1:1,E()):x<0},C.precision=function(t){return arguments.length?(a=P3(o,M=t*t),O()):c_(M)},C.fitExtent=function(t,e){return PJ(C,t,e)},C.fitSize=function(t,e){return PQ(C,t,e)},C.fitWidth=function(t,e){return P0(C,t,e)},C.fitHeight=function(t,e){return P1(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&T,E()}}function P9(t){var e=0,i=cn/3,r=P6(t),n=r(e,i);return n.parallels=function(t){return arguments.length?r(e=t[0]*ch,i=t[1]*ch):[e*cl,i*cl]},n}function P7(t,e){var i=cv(t),r=(i+cv(e))/2;if(1e-6>cu(r))return function(t){var e=cp(t);function i(t,i){return[t*e,cv(i)/e]}return i.invert=function(t,i){return[t/e,cS(i*e)]},i}(t);var n=1+i*(2*r-i),s=c_(n)/r;function a(t,e){var i=c_(n-2*r*cv(e))/r;return[i*cv(t*=r),s-i*cp(t)]}return a.invert=function(t,e){var i=s-e,a=cc(t,cu(i))*cy(i);return i*r<0&&(a-=cn*cy(t)*cy(i)),[a/r,cS((n-(t*t+i*i)*r*r)/(2*r))]},a}function Rt(){return P9(P7).scale(155.424).center([0,33.6442])}function Re(){return Rt().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Ri(t){return function(e,i){var r=cp(e),n=cp(i),s=t(r*n);return[s*n*cv(e),s*cv(i)]}}function Rr(t){return function(e,i){var r=c_(e*e+i*i),n=t(r),s=cv(n);return[cc(e*s,r*cp(n)),cS(r&&i*s/r)]}}var Rn=Ri(function(t){return c_(2/(1+t))});Rn.invert=Rr(function(t){return 2*cS(t/2)});var Rs=Ri(function(t){return(t=cx(t))&&t/cv(t)});Rs.invert=Rr(function(t){return t});function Ra(t,e){return[t,cf(cb((cs+e)/2))]}Ra.invert=function(t,e){return[t,2*cd(cg(e))-cs]};function Ro(t){var e,i,r,n=P8(t),s=n.center,a=n.scale,o=n.translate,l=n.clipExtent,h=null;function u(){var s=cn*a(),o=n((function(t){function e(e){return e=t(e[0]*ch,e[1]*ch),e[0]*=cl,e[1]*=cl,e}return t=PU(t[0]*ch,t[1]*ch,t.length>2?t[2]*ch:0),e.invert=function(e){return e=t.invert(e[0]*ch,e[1]*ch),e[0]*=cl,e[1]*=cl,e},e})(n.rotate()).invert([0,0]));return l(null==h?[[o[0]-s,o[1]-s],[o[0]+s,o[1]+s]]:t===Ra?[[Math.max(o[0]-s,h),e],[Math.min(o[0]+s,i),r]]:[[h,Math.max(o[1]-s,e)],[i,Math.min(o[1]+s,r)]])}return n.scale=function(t){return arguments.length?(a(t),u()):a()},n.translate=function(t){return arguments.length?(o(t),u()):o()},n.center=function(t){return arguments.length?(s(t),u()):s()},n.clipExtent=function(t){return arguments.length?(null==t?h=e=i=r=null:(h=+t[0][0],e=+t[0][1],i=+t[1][0],r=+t[1][1]),u()):null==h?null:[[h,e],[i,r]]},u()}function Rl(t){return cb((cs+t)/2)}function Rh(t,e){var i=cp(t),r=t===e?cv(t):cf(i/cp(e))/cf(Rl(e)/Rl(t)),n=i*cm(Rl(t),r)/r;if(!r)return Ra;function s(t,e){n>0?e<-cs+1e-6&&(e=-cs+1e-6):e>cs-1e-6&&(e=cs-1e-6);var i=n/cm(Rl(e),r);return[i*cv(r*t),n-i*cp(r*t)]}return s.invert=function(t,e){var i=n-e,s=cy(r)*c_(t*t+i*i),a=cc(t,cu(i))*cy(i);return i*r<0&&(a-=cn*cy(t)*cy(i)),[a/r,2*cd(cm(n/s,1/r))-cs]},s}function Ru(t,e){return[t,e]}Ru.invert=Ru;function Rd(t,e){var i=cp(t),r=t===e?cv(t):(i-cp(e))/(e-t),n=i/r+t;if(1e-6>cu(r))return Ru;function s(t,e){var i=n-e,s=r*t;return[i*cv(s),n-i*cp(s)]}return s.invert=function(t,e){var i=n-e,s=cc(t,cu(i))*cy(i);return i*r<0&&(s-=cn*cy(t)*cy(i)),[s/r,n-cy(r)*c_(t*t+i*i)]},s}var Rc=c_(3)/2;function Rp(t,e){var i=cS(Rc*cv(e)),r=i*i,n=r*r*r;return[t*cp(i)/(Rc*(1.340264+-.24331799999999998*r+n*(.0062510000000000005+.034164*r))),i*(1.340264+-.081106*r+n*(893e-6+.003796*r))]}Rp.invert=function(t,e){for(var i=e,r=i*i,n=r*r*r,s,a,o=0;o<12&&(a=i*(1.340264+-.081106*r+n*(893e-6+.003796*r))-e,i-=s=a/(1.340264+-.24331799999999998*r+n*(.0062510000000000005+.034164*r)),n=(r=i*i)*r*r,!(1e-12>cu(s)));++o);return[Rc*t*(1.340264+-.24331799999999998*r+n*(.0062510000000000005+.034164*r))/cp(i),cS(cv(i)/Rc)]};function Rg(t,e){var i=cp(e),r=cp(t)*i;return[i*cv(t)/r,cv(e)/r]}Rg.invert=Rr(cd);function Rf(t,e){var i=e*e,r=i*i;return[t*(.8707-.131979*i+r*(-.013791+r*(.003971*i-.001529*r))),e*(1.007226+i*(.015085+r*(-.044475+.028874*i-.005916*r)))]}Rf.invert=function(t,e){var i,r=e,n=25;do{var s=r*r,a=s*s;r-=i=(r*(1.007226+s*(.015085+a*(-.044475+.028874*s-.005916*a)))-e)/(1.007226+s*(.045255+a*(-.311325+.259866*s-.005916*11*a)))}while(cu(i)>1e-6&&--n>0);return[t/(.8707+(s=r*r)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),r]};function Rm(t,e){return[cp(e)*cv(t),cv(e)]}Rm.invert=Rr(cS);function Rv(t,e){var i=cp(e),r=1+cp(t)*i;return[i*cv(t)/r,cv(e)/r]}Rv.invert=Rr(function(t){return 2*cd(t)});function Ry(t,e){return[cf(cb((cs+e)/2)),-t]}Ry.invert=function(t,e){return[-e,2*cd(cg(t))-cs]};p8();let R_={},Rb=["clipAngle","clipExtent","scale","translate","center","rotate","precision","reflectX","reflectY","parallels","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Rx(t,e){var i,r;t&&eE(t)||fs("Projection type must be a name string.");let n=t.toLowerCase();return arguments.length>1&&(R_[n]=(i=n,r=e,function t(){let e=r();return e.type=i,e.path=p8().projection(e),e.copy=e.copy||function(){let i=t();return Rb.forEach(t=>{e[t]&&i[t](e[t]())}),i.path.pointRadius(e.path.pointRadius()),i},e})),R_[n]||null}let RS={albers:Re,albersusa:function(){var t,e,i,r,n,s,a=Re(),o=Rt().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Rt().rotate([157,0]).center([-3,19.9]).parallels([8,18]),h={point:function(t,e){s=[t,e]}};function u(t){var e=t[0],a=t[1];return s=null,i.point(e,a),s||(r.point(e,a),s)||(n.point(e,a),s)}function d(){return t=e=null,u}return u.invert=function(t){var e=a.scale(),i=a.translate(),r=(t[0]-i[0])/e,n=(t[1]-i[1])/e;return(n>=.12&&n<.234&&r>=-.425&&r<-.214?o:n>=.166&&n<.234&&r>=-.214&&r<-.115?l:a).invert(t)},u.stream=function(i){var r,n;return t&&e===i?t:(n=(r=[a.stream(e=i),o.stream(i),l.stream(i)]).length,t={point:function(t,e){for(var i=-1;++i<n;)r[i].point(t,e)},sphere:function(){for(var t=-1;++t<n;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<n;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<n;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<n;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<n;)r[t].polygonEnd()}})},u.precision=function(t){return arguments.length?(a.precision(t),o.precision(t),l.precision(t),d()):a.precision()},u.scale=function(t){return arguments.length?(a.scale(t),o.scale(.35*t),l.scale(t),u.translate(a.translate())):a.scale()},u.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),s=+t[0],u=+t[1];return i=a.translate(t).clipExtent([[s-.455*e,u-.238*e],[s+.455*e,u+.238*e]]).stream(h),r=o.translate([s-.307*e,u+.201*e]).clipExtent([[s-.425*e+1e-6,u+.12*e+1e-6],[s-.214*e-1e-6,u+.234*e-1e-6]]).stream(h),n=l.translate([s-.205*e,u+.212*e]).clipExtent([[s-.214*e+1e-6,u+.166*e+1e-6],[s-.115*e-1e-6,u+.234*e-1e-6]]).stream(h),d()},u.fitExtent=function(t,e){return PJ(u,t,e)},u.fitSize=function(t,e){return PQ(u,t,e)},u.fitWidth=function(t,e){return P0(u,t,e)},u.fitHeight=function(t,e){return P1(u,t,e)},u.scale(1070)},azimuthalequalarea:function(){return P8(Rn).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return P8(Rs).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return P9(Rh).scale(109.5).parallels([30,30])},conicequalarea:Rt,conicequidistant:function(){return P9(Rd).scale(131.154).center([0,13.9389])},equalEarth:function(){return P8(Rp).scale(177.158)},equirectangular:function(){return P8(Ru).scale(152.63)},gnomonic:function(){return P8(Rg).scale(144.049).clipAngle(60)},identity:function(){var t,e,i,r,n,s,a,o=1,l=0,h=0,u=1,d=1,c=0,p=null,g=1,f=1,m=PZ({point:function(t,e){var i=_([t,e]);this.stream.point(i[0],i[1])}}),v=d3;function y(){return g=o*u,f=o*d,s=a=null,_}function _(i){var r=i[0]*g,n=i[1]*f;if(c){var s=n*t-r*e;r=r*t+n*e,n=s}return[r+l,n+h]}return _.invert=function(i){var r=i[0]-l,n=i[1]-h;if(c){var s=n*t+r*e;r=r*t-n*e,n=s}return[r/g,n/f]},_.stream=function(t){return s&&a===t?s:s=m(v(a=t))},_.postclip=function(t){return arguments.length?(v=t,p=i=r=n=null,y()):v},_.clipExtent=function(t){return arguments.length?(v=null==t?(p=i=r=n=null,d3):PV(p=+t[0][0],i=+t[0][1],r=+t[1][0],n=+t[1][1]),y()):null==p?null:[[p,i],[r,n]]},_.scale=function(t){return arguments.length?(o=+t,y()):o},_.translate=function(t){return arguments.length?(l=+t[0],h=+t[1],y()):[l,h]},_.angle=function(i){return arguments.length?(e=cv(c=i%360*ch),t=cp(c),y()):c*cl},_.reflectX=function(t){return arguments.length?(u=t?-1:1,y()):u<0},_.reflectY=function(t){return arguments.length?(d=t?-1:1,y()):d<0},_.fitExtent=function(t,e){return PJ(_,t,e)},_.fitSize=function(t,e){return PQ(_,t,e)},_.fitWidth=function(t,e){return P0(_,t,e)},_.fitHeight=function(t,e){return P1(_,t,e)},_},mercator:function(){return Ro(Ra).scale(961/co)},naturalEarth1:function(){return P8(Rf).scale(175.295)},orthographic:function(){return P8(Rm).scale(249.5).clipAngle(90.000001)},stereographic:function(){return P8(Rv).scale(250).clipAngle(142)},transversemercator:function(){var t=Ro(Ry),e=t.center,i=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?i([t[0],t[1],t.length>2?t[2]+90:90]):[(t=i())[0],t[1],t[2]-90]},i([0,0,90]).scale(159.155)}};Object.keys(RS).forEach(t=>{Rx(t,RS[t])});let Rk="Feature",RA="FeatureCollection",Rw=Rb.concat(["pointRadius","fit","extent","size"]);function RM(t,e){let i=[];return t&&Object.keys(t).forEach(r=>{Rw.includes(r)&&(i=i.concat(gF(t[r],e)))}),i}class RC extends g${constructor(t){super(t),this.grammarType="projection"}parse(t){return super.parse(t),this.pointRadius(t.pointRadius),this.size(t.size),this.extent(t.extent),this.fit(t.fit),this.configure(t),this.commit(),this}pointRadius(t){return ej(this.spec.pointRadius)||this.detach(gF(this.spec.pointRadius,this.view)),this.spec.pointRadius=t,this.attach(gF(t,this.view)),this.commit(),this}size(t){return ej(this.spec.size)||this.detach(gF(this.spec.size,this.view)),this.spec.size=t,this.attach(gF(t,this.view)),this.commit(),this}extent(t){return ej(this.spec.extent)||this.detach(gF(this.spec.extent,this.view)),this.spec.extent=t,this.attach(gF(t,this.view)),this.commit(),this}fit(t){return ej(this.spec.fit)||this.detach(gF(this.spec.fit,this.view)),this.spec.fit=t,this.attach(gF(t,this.view)),this.commit(),this}configure(t){return this.detach(RM(this.spec,this.view)),ej(t)?this.spec={type:this.spec.type,fit:this.spec.fit,extent:this.spec.extent,size:this.spec.size,pointRadius:this.spec.pointRadius}:(Object.assign(this.spec,t),this.attach(RM(this.spec,this.view))),this.commit(),this}evaluate(t,e){if(this.projection&&this.projection.type===this.spec.type||(this.projection=function(t){let e=Rx((t||"mercator").toLowerCase());return e||fs("Unrecognized projection type: "+t),e()}(this.spec.type),this.projection.type=this.spec.type),Rb.forEach(t=>{var i,r,n;ej(this.spec[t])||(i=this.projection,r=t,n=gN(this.spec[t],e,Rx),nx(i[r])&&i[r](n))}),ej(this.spec.pointRadius)||this.projection.path.pointRadius(gN(this.spec.pointRadius,e,Rx)),!(ej(this.spec.fit)||ej(this.spec.extent)&&ej(this.spec.size))){let t=function(t){let e=om(t);return 1===e.length?e[0]:{type:RA,features:e.reduce((t,e)=>{var i;return t.concat((i=e).type===RA?i.features:om(i).filter(t=>!ej(t)).map(t=>t.type===Rk?t:{type:Rk,geometry:t}))},[])}}(gN(this.spec.fit,e,Rx));this.spec.extent?this.projection.fitExtent(gN(this.spec.extent,e,Rx),t):this.spec.size&&this.projection.fitSize(gN(this.spec.size,e,Rx),t)}return this.projection}output(){return this.projection}}let RT=()=>{d0.registerGrammar("projection",RC,"projections")},RE=(t,e)=>{let i;if(!e.from||!e.from())return t;let r=e.fields,n=e.key,s=e.values,a=e.default,o=e.as||[r],l=e.from().reduce(function(t,e){return e[r]&&t.set(e[r],e),t},new Map);if(nx(e.set))i=function(t){let i=l.get(t[n]);e.set(t,i)};else if(s){let t=s.length;i=function(e){let i=l.get(e[n]);if(ej(i))for(let i=0;i<t;++i)e[o[i]]=a;else for(let r=0;r<t;++r)e[o[r]]=i[s[r]]}}else i=function(t){let e=l.get(t[n]);t[o[0]]=eO(e)?e:a};return 0===t.length?[]:t.map(t=>(i(t),t))};class RO extends C5{constructor(){super(...arguments),this.type=cZ.geo,this.coordinate="geo",this._nameProperty="name"}getMapViewData(){var t;return null===(t=this._mapViewData)||void 0===t?void 0:t.getDataView()}get nameField(){return this._nameField}set nameField(t){this._nameField=t}get valueField(){return this._valueField}set valueField(t){this._valueField=t}getNameProperty(){return this._nameProperty}getCentroidProperty(){return this._centroidProperty}getCoordinateHelper(){return this._coordinateHelper}setCoordinateHelper(t){this._coordinateHelper=t}getStatisticFields(){let t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}getGroupFields(){return null}dataToPosition(t,e){var i;let r=null;if(!t||e&&!this.isDatumInViewData(t))return r;let{dataToPosition:n,latitudeField:s,longitudeField:a}=this._coordinateHelper;if(null===(r=this.nameToPosition(t))){let e=a?null==t?void 0:t[a]:Number.NaN,o=s?null==t?void 0:t[s]:Number.NaN;r=null!==(i=null==n?void 0:n([e,o]))&&void 0!==i?i:null}return r}nameToPosition(t){let e=this.getDatumName(t);return ej(e)?null:this.nameValueToPosition(e)}nameValueToPosition(t){var e,i;let r=null===(i=null===(e=this.getMapViewData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.filter(e=>this.getDatumName(e)===t)[0];if(ej(r))return null;let{dataToPosition:n}=this._coordinateHelper,s=this.getDatumCenter(r),a=null==n?void 0:n(s);return ej(a)||isNaN(a.x)||isNaN(a.y)?null:a}dataToLatitude(t){if(!this._coordinateHelper)return Number.NaN;let{dataToLatitude:e}=this._coordinateHelper;return e(t)}dataToLongitude(t){if(!this._coordinateHelper)return Number.NaN;let{dataToLatitude:e}=this._coordinateHelper;return e(t)}valueToPosition(t,e){return{x:this.dataToLongitude(t),y:this.dataToLatitude(e)}}positionToData(t){}latitudeToData(t){}longitudeToData(t){}dataToPositionX(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0}dataToPositionY(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0}dataToPositionZ(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0}release(){super.release(),this._mapViewData.release(),this._mapViewData=this._mapViewDataStatistics=null}getStackGroupFields(){return[this._nameField]}getStackValueField(){return this._spec.valueField}compileData(){var t;null===(t=this._mapViewData)||void 0===t||t.compile()}initStatisticalData(){if(super.initStatisticalData(),this._mapViewData){let t=`${hA}_series_${this.id}_mapViewDataStatic`;this._mapViewDataStatistics=this.createStatisticalData(t,this._mapViewData.getDataView()),this._mapViewData.getDataView().target.removeListener("change",this._mapViewDataStatistics.reRunAllTransform)}}getSeriesKeys(){var t,e,i,r,n;return this._seriesField?null!==(n=null!==(e=null===(t=this.getRawDataStatisticsByField(this._seriesField))||void 0===t?void 0:t.values)&&void 0!==e?e:null===(r=null===(i=this._mapViewDataStatistics)||void 0===i?void 0:i.latestData[this._seriesField])||void 0===r?void 0:r.values)&&void 0!==n?n:[]:this.name?[this.name]:this.userId?[`${this.userId}`]:[`${this.type}_${this.id}`]}fillData(){var t,e;super.fillData(),null===(t=this._mapViewData.getDataView())||void 0===t||t.reRunAllTransform(),null===(e=this._mapViewDataStatistics)||void 0===e||e.reRunAllTransform()}getActiveMarks(){return[]}}let RP=`${hA}_MAP_LOOK_UP_KEY`,RR=(t,e)=>(t.features&&t.features.forEach((t,i)=>{var r;t[bA]=i;let n=null===(r=t.properties)||void 0===r?void 0:r[e.nameProperty];e.nameMap&&e.nameMap[n]?t[RP]=e.nameMap[n]:t[RP]=n}),t.features);class RB extends CB{constructor(){super(...arguments),this.dimensionTooltipTitleCallback=t=>{var e;let i=this.series;return null!==(e=this._getDimensionData(t))&&void 0!==e?e:i.getDatumName(t)}}}class RI extends Sd{constructor(){super(...arguments),this.type=RI.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0,path:""})}}RI.type="path";let RL=()=>{de.registerMark(RI.type,RI),AV()};class RD{constructor(t){this.projection=Rx(t.type)()}fit(t,e,i){this.projection.fitExtent([t,e],{type:"FeatureCollection",features:i})}center(t){var e,i;null===(i=null===(e=this.projection)||void 0===e?void 0:e.center)||void 0===i||i.call(e,t)}project(t){var e;return null===(e=this.projection)||void 0===e?void 0:e.call(this,t)}shape(t){var e,i;return null===(i=null===(e=this.projection)||void 0===e?void 0:e.path)||void 0===i?void 0:i.call(e,t)}invert(t){var e,i;return null===(i=null===(e=this.projection)||void 0===e?void 0:e.invert)||void 0===i?void 0:i.call(e,t)}scale(t){var e;if(null===(e=this.projection)||void 0===e?void 0:e.scale){if(void 0===t)return this.projection.scale();this.projection.scale(t)}}translate(t){var e;if(null===(e=this.projection)||void 0===e?void 0:e.scale){if(void 0===t)return this.projection.translate();this.projection.translate(t)}}evaluate(t,e,i){let r=this.projection.copy();return null==r?void 0:r.fitExtent([t,e],{type:"FeatureCollection",features:i})}}class RF{parserScrollEvent(t){return t?!(t.ctrlKey||0===t.deltaY&&0===t.deltaX)&&(t.scrollX=t.deltaX,t.scrollY=t.deltaY,t):t}parserZoomEvent(t){if(!t)return t;let e=Math.pow(1.0005,-t.deltaY*Math.pow(16,t.deltaMode));return t.zoomDelta=e,t.zoomX=t.canvasX,t.zoomY=t.canvasY,t}clearZoom(){}clearScroll(){}clearDrag(){}parserDragEvent(){return!0}}class Rj{constructor(){this._lastScale=0}clearZoom(){this._lastScale=0,this.pointerId=null}parserDragEvent(t){return!0}parserZoomEvent(t){let e=t.scale;if(0===this._lastScale)return this._lastScale=e,t;t.zoomDelta=e/this._lastScale;let i=t.center;return t.zoomX=i.x,t.zoomY=i.y,this._lastScale=e,t}parserScrollEvent(t){return t}clearScroll(){}clearDrag(){}}function RN(t){return t===lb["desktop-browser"]||t===lb["desktop-miniApp"]?{start:"pointerdown",move:"pointermove",end:"pointerup",zoom:"wheel",zoomEnd:"pointerup",scroll:"wheel",trigger:RF}:hh(t)||hu(t)?{start:"pointerdown",move:"pointermove",end:"pointerup",zoom:"pinch",zoomEnd:"pinchend",scroll:"pan",scrollEnd:"panend",trigger:Rj}:null}let Rz={debounce:l3,throttle:dJ};class RH{constructor(){this._isGestureListener=!1}initZoomable(t,e=lb["desktop-browser"]){this._eventObj=t,this._renderMode=e,this._gestureController=this._option.getChart().getVGrammarView().renderer._gestureController,this._isGestureListener=hh(this._renderMode)||hu(this._renderMode),RN(this._renderMode)&&(this._clickEnable=!0,this._zoomableTrigger=new(this._getZoomTriggerEvent("trigger")))}_getZoomTriggerEvent(t){return RN(this._renderMode)[t]}_zoomEventDispatch(t,e,i){if(!this._isGestureListener&&!t.event)return;let r=this._isGestureListener?t:t.event.clone();this._zoomableTrigger.parserZoomEvent(r);let{zoomDelta:n,zoomX:s,zoomY:a}=r;if(ej(n)||!a8({x:s,y:a},this._getRegionOrSeriesLayout(e),!1))return;let o={};i&&(o=i({zoomDelta:n,zoomX:s,zoomY:a},r)),this._eventObj.emit("zoom",Object.assign(Object.assign({scale:r.zoomDelta,scaleCenter:{x:r.zoomX,y:r.zoomY}},o),{model:this}))}_getRegionOrSeriesLayout(t){"region"!==t.type&&(t=t.getRegion());let{x:e,y:i,width:r,height:n}=t.layout.getLayout();return{x1:e,y1:i,x2:e+r,y2:i+n}}_bindZoomEventAsRegion(t,e,i,r){var n,s;let a=null!==(n=null==r?void 0:r.delayType)&&void 0!==n?n:"throttle",o=null!==(s=null==r?void 0:r.delayTime)&&void 0!==s?s:0,l=this._isGestureListener?this._gestureController:t,h=this._isGestureListener?[this._getZoomTriggerEvent("zoom")]:[this._getZoomTriggerEvent("zoom"),{level:c3.chart,consume:!0}],u=this._isGestureListener?[this._getZoomTriggerEvent("zoomEnd")]:[this._getZoomTriggerEvent("zoomEnd"),{level:c3.chart,consume:!1}];l.on(...u,Rz[a](t=>{this._zoomableTrigger.clearZoom()},o)),l.on(...h,Rz[a](t=>{this._zoomEventDispatch(t,e,i)},o))}initZoomEventOfSeries(t,e,i){this._option.disableTriggerEvent||RN(this._renderMode)&&this._bindZoomEventAsRegion(t.event,t,e,i)}initZoomEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||RN(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&this._bindZoomEventAsRegion(t.event,t,i,r)}):this._bindZoomEventAsRegion(this._eventObj,t,i,r)})}_scrollEventDispatch(t,e,i){let r=!1;if(!this._isGestureListener&&(!t.event||this._option.disableTriggerEvent))return r;let n=this._isGestureListener?t:t.event;this._zoomableTrigger.parserScrollEvent(n);let{scrollX:s,scrollY:a,canvasX:o,canvasY:l}=n;return ej(s)&&ej(a)||a8({x:o,y:l},this._getRegionOrSeriesLayout(e),!1)&&(i&&(r=i({scrollX:s,scrollY:a},n)),this._eventObj.emit("scroll",{scrollX:s,scrollY:a,model:this})),r}_bindScrollEventAsRegion(t,e,i,r){var n,s;let a=null!==(n=null==r?void 0:r.delayType)&&void 0!==n?n:"throttle",o=null!==(s=null==r?void 0:r.delayTime)&&void 0!==s?s:0,l=this._isGestureListener?this._gestureController:t,h=this._isGestureListener?[this._getZoomTriggerEvent("scroll")]:[this._getZoomTriggerEvent("scroll"),{level:c3.chart,consume:!0}],u=this._isGestureListener?[this._getZoomTriggerEvent("scrollEnd")]:[this._getZoomTriggerEvent("scrollEnd"),{level:c3.chart,consume:!1}];l.on(...u,Rz[a](t=>{this._zoomableTrigger.clearScroll()},o)),l.on(...h,Rz[a](t=>this._scrollEventDispatch(t,e,i),o))}initScrollEventOfSeries(t,e,i){RN(this._renderMode)&&this._bindScrollEventAsRegion(t.event,t,e,i)}initScrollEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||RN(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&this._bindScrollEventAsRegion(t.event,t,i,r)}):this._bindScrollEventAsRegion(this._eventObj,t,i,r)})}_bindDragEventAsRegion(t,e,i,r){t.on(this._getZoomTriggerEvent("start"),{level:c3.chart},t=>{if(!t.event)return;let{event:n}=t;a8({x:n.canvasX,y:n.canvasY},this._getRegionOrSeriesLayout(e),!1)&&this._handleDrag(t,i,r)}),t.on("click",{level:c3.chart},()=>!this._clickEnable)}initDragEventOfSeries(t,e,i){this._option.disableTriggerEvent||RN(this._renderMode)&&t.event.on(this._getZoomTriggerEvent("start"),{level:c3.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},t=>{this._handleDrag(t,e,i)})}initDragEventOfRegions(t,e,i,r){this._option.disableTriggerEvent||RN(this._renderMode)&&t.forEach(t=>{e?t.getSeries().forEach(t=>{e(t)&&(t.event.on(this._getZoomTriggerEvent("start"),{level:c3.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},t=>{this._handleDrag(t,i)}),t.event.on("click",{level:c3.model,filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>!this._clickEnable))}):this._bindDragEventAsRegion(this._eventObj,t,i,r)})}_handleDrag(t,e,i){var r,n,s;if(this._option.disableTriggerEvent||(this._clickEnable=!1,!this._zoomableTrigger.parserDragEvent(t.event)))return;let a=null!==(r=null==i?void 0:i.delayType)&&void 0!==r?r:"throttle",o=null!==(n=null==i?void 0:i.delayTime)&&void 0!==n?n:0,l=null===(s=null==i?void 0:i.realTime)||void 0===s||s,h=this._getZoomTriggerEvent("move"),u=this._getZoomTriggerEvent("end"),d=t.event,c=d.canvasX,p=d.canvasY,g=d.canvasX,f=d.canvasY,m=Rz[a](t=>{this._clickEnable=!0;let i=t.event,r=[i.canvasX-g,i.canvasY-f];g=i.canvasX,f=i.canvasY,!l&&e&&e(r,t.event),this._eventObj.emit("panend",{delta:r,model:this}),this._zoomableTrigger.pointerId=null,this._eventObj.off(h,{level:c3.chart,source:c2.chart},v),this._eventObj.off(u,{level:c3.chart,source:c2.window},m),this._eventObj.allow(u)},o),v=Rz[a](t=>{if(!this._zoomableTrigger.parserDragEvent(t.event))return;this._clickEnable=!1,this._eventObj.prevent(u,m);let i=t.event,r=[i.canvasX-c,i.canvasY-p];c=i.canvasX,p=i.canvasY,l&&e&&e(r,t.event),this._eventObj.emit("panmove",{delta:r,model:this})},o);this._eventObj.on(h,{level:c3.chart,source:c2.chart},v),this._eventObj.on(u,{level:c3.chart,source:c2.chart},m)}}class RV extends Ea{constructor(){var t,e;super(...arguments),this.type=lx.geoCoordinate,this.name=lx.geoCoordinate,this.layoutType="none",this.layoutZIndex=tM.Mark,this._projectionSpec={name:(t=this.type,e=this.id,`${hA}_${e}_${t}`),type:"mercator"},this._actualScale=1,this._initialScale=1,this.effect={scaleUpdate:()=>{this.coordinateHelper()}},this._handleChartZoom=(t,e)=>{var i,r,n,s,a,o;let l=t.zoomDelta,h=this._actualScale;return this._actualScale*=l,this._actualScale<(null===(i=this._spec.zoomLimit)||void 0===i?void 0:i.min)?(this._actualScale=null===(r=this._spec.zoomLimit)||void 0===r?void 0:r.min,l=(null===(n=this._spec.zoomLimit)||void 0===n?void 0:n.min)/h):this._actualScale>(null===(s=this._spec.zoomLimit)||void 0===s?void 0:s.max)&&(this._actualScale=null===(a=this._spec.zoomLimit)||void 0===a?void 0:a.max,l=(null===(o=this._spec.zoomLimit)||void 0===o?void 0:o.max)/h),this.zoom(l,[t.zoomX,t.zoomY]),{scale:l,totalScale:this._actualScale}},this.pan=(t=[0,0])=>{var e,i,r;let n=null!==(i=null===(e=this._projection)||void 0===e?void 0:e.translate())&&void 0!==i?i:[0,0],s=n[0],a=n[1];s+=t[0],a+=t[1],null===(r=this._projection)||void 0===r||r.translate([s,a])}}get longitudeField(){return this._longitudeField}get latitudeField(){return this._latitudeField}get projectionSpec(){return this._projectionSpec}setProjection(t){this._projectionSpec=Object.assign(Object.assign({},t),{name:this._projectionSpec.name})}getZoom(){return this._actualScale}static getSpecInfo(t){if(ej(t))return null;let e=[];return t.region.forEach((t,i)=>{if("geo"===t.coordinate){let r=Object.assign(Object.assign({},t),{padding:0});e.push({spec:r,regionIndex:i,type:lx.geoCoordinate,specInfoPath:["component","geoCoordinate",i]})}}),e}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec(),this._spec.roam&&this.initZoomable(this.event,this._option.mode),this._projectionSpec=us(this._projectionSpec,this._spec.projection),this._projectionSpec.zoom>(null===(t=this._spec.zoomLimit)||void 0===t?void 0:t.max)&&(this._projectionSpec.zoom=this._spec.zoomLimit.max),this._projectionSpec.zoom<(null===(e=this._spec.zoomLimit)||void 0===e?void 0:e.min)&&(this._projectionSpec.zoom=this._spec.zoomLimit.min),this._actualScale=null!==(i=this._projectionSpec.zoom)&&void 0!==i?i:1,this._initialScale=this._actualScale,this._longitudeField=this._spec.longitudeField,this._latitudeField=this._spec.latitudeField}created(){super.created(),this._regions=this._option.getRegionsInIndex([this._option.regionIndex]),this.initProjection(),this.coordinateHelper(),this.initEvent(),this._initCenterCache()}dispatchZoom(t,e){let i=e||{x:this.getLayoutStartPoint().x+this.getLayoutRect().width/2,y:this.getLayoutStartPoint().y+this.getLayoutRect().height/2},{scale:r,totalScale:n}=this._handleChartZoom({zoomDelta:t,zoomX:i.x,zoomY:i.y});1!==r&&this.event.emit("zoom",{scale:r,scaleCenter:i,totalScale:n,model:this})}initEvent(){this.event.on(c1.scaleUpdate,{filter:({model:t})=>(null==t?void 0:t.id)===this.id},this.effect.scaleUpdate.bind(this)),this._spec.roam&&(this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom),this.initDragEventOfRegions(this._regions,()=>!0,this.pan),this._regions.forEach(t=>{t.getSeries().forEach(t=>{t.event.on("zoom",e=>(t.handleZoom(e),!0)),t.event.on("panmove",e=>(t.handlePan(e),!0))})}))}initProjection(){var t;this._projection=new RD(this._projectionSpec),null!==this._projection.projection||null===(t=this._option)||void 0===t||t.onError("unsupported projection type!")}coordinateHelper(){let t={longitudeField:this._longitudeField,latitudeField:this._latitudeField,dataToPosition:this.dataToPosition.bind(this),dataToLongitude:this.dataToLongitude.bind(this),dataToLatitude:this.dataToLatitude.bind(this),shape:this.shape.bind(this),getCoordinateId:()=>this.id};this._regions.forEach(e=>{e.getSeries().forEach(e=>{e.type===cZ.map?e.setCoordinateHelper(t):(e.setXAxisHelper(Object.assign(Object.assign({},t),{isContinuous:!0,dataToPosition:(t,i)=>{var r;let n=t[0];if(ej(n)&&(null==i?void 0:i.datum)){let t=i.datum[e.getDimensionField()[0]];n=null===(r=this._centerCache.get(t))||void 0===r?void 0:r.x}return this.dataToLongitude(n)},valueToPosition:(t,i)=>{var r;if(ej(t)&&(null==i?void 0:i.datum)){let n=i.datum[e.getDimensionField()[0]];t=null===(r=this._centerCache.get(n))||void 0===r?void 0:r.x}return this.dataToLongitude(t)},getFields:()=>[this._longitudeField],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!1})),e.setYAxisHelper(Object.assign(Object.assign({},t),{isContinuous:!0,dataToPosition:(t,i)=>{var r;let n=t[0];if(ej(n)&&(null==i?void 0:i.datum)){let t=i.datum[e.getDimensionField()[0]];n=null===(r=this._centerCache.get(t))||void 0===r?void 0:r.y}return this.dataToLatitude(n)},valueToPosition:(t,i)=>{var r;if(ej(t)&&(null==i?void 0:i.datum)){let n=i.datum[e.getDimensionField()[0]];t=null===(r=this._centerCache.get(n))||void 0===r?void 0:r.y}return this.dataToLatitude(t)},getFields:()=>[this._latitudeField],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!1})))})})}onLayoutEnd(t){this.setLayoutRect(this._regions[0].getLayoutRect()),this.setLayoutStartPosition(this._regions[0].getLayoutStartPoint());let{width:e,height:i}=this.getLayoutRect(),{translate:r,scale:n,center:s}=this.evaluateProjection([0,0],[e,i]);r&&this._projection.translate(r),n&&this._projection.scale(n),s&&this._projection.center(s),dC(this._regions,t=>{var e;if(t.type===cZ.map){t.areaPath.clear();let i=null===(e=t.getRootMark().getProduct())||void 0===e?void 0:e.getGroupGraphicItem();i&&i.attribute.postMatrix&&i.setAttributes({postMatrix:new iE})}}),this._actualScale=this._initialScale,super.onLayoutEnd(t)}onRender(t){}changeRegions(t){}_getNeedClearVRenderComponents(){return[]}collectFeatures(){let t=[];return this._regions.forEach(e=>{e.getSeries().forEach(e=>{var i,r;e.type===cZ.map&&t.push(...null!==(r=null===(i=e.getMapViewData())||void 0===i?void 0:i.latestData)&&void 0!==r?r:[])})}),t}dataToPosition(t=[]){var e;let i=null===(e=this._projection)||void 0===e?void 0:e.project([t[0],t[1]]);return{x:null==i?void 0:i[0],y:null==i?void 0:i[1]}}dataToLatitude(t){var e;let i=null===(e=this._projection)||void 0===e?void 0:e.project([0,t]);return null==i?void 0:i[1]}dataToLongitude(t){var e;let i=null===(e=this._projection)||void 0===e?void 0:e.project([t,0]);return null==i?void 0:i[0]}zoom(t,e=[0,0]){var i,r,n,s,a,o;let l=null!==(r=null===(i=this._projection)||void 0===i?void 0:i.scale())&&void 0!==r?r:0,h=null!==(s=null===(n=this._projection)||void 0===n?void 0:n.translate())&&void 0!==s?s:[0,0],u=h[0],d=h[1];l*=t,u-=(e[0]-u)*(t-1),d-=(e[1]-d)*(t-1),null===(a=this._projection)||void 0===a||a.scale(l),null===(o=this._projection)||void 0===o||o.translate([u,d])}shape(t){return this._projection.shape(t)}invert(t){return this._projection.invert(t)}evaluateProjection(t,e){var i;let r=this._projection.evaluate(t,e,this.collectFeatures()),n=r.translate(),s=r.scale()*this._initialScale,a=null!==(i=this._projectionSpec.center)&&void 0!==i?i:r.invert([e[0]/2,e[1]/2]);return a&&(n=[e[0]/2,e[1]/2]),{translate:n,scale:s,center:a}}_initCenterCache(){this._centerCache||(this._centerCache=new Map),this._regions.forEach(t=>{t.getSeries().forEach(t=>{var e,i;"map"===t.type&&(null!==(i=null===(e=t.getMapViewData())||void 0===e?void 0:e.latestData)&&void 0!==i?i:[]).forEach((e={})=>{let i=e[t.getDimensionField()[0]]||e[RP],r=t.getDatumCenter(e);i&&eO(r)&&this._centerCache.set(i,{x:r[0],y:r[1]})})})})}release(){super.release(),this._centerCache&&this._centerCache.clear(),this._centerCache=null}}RV.type=lx.geoCoordinate,CS(RV,RH);let RW=()=>{de.registerComponent(RV.type,RV)};class RG extends C3{_transformLabelSpec(t){this._addMarkLabelSpec(t,"area",void 0,void 0,!1)}}class RU extends RO{constructor(){super(...arguments),this.type=cZ.map,this.transformerConstructor=RG,this._areaCache=new Map}getNameMap(){return this._nameMap}get areaPath(){return this._areaCache}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.map=this._spec.map,this._nameMap=this._spec.nameMap,this._nameField=this._spec.nameField,this._valueField=this._spec.valueField,this._spec.nameProperty&&(this._nameProperty=this._spec.nameProperty),this._spec.centroidProperty&&(this._centroidProperty=this._spec.centroidProperty),this.map||null===(t=this._option)||void 0===t||t.onError(`map type '${this.map}' is not specified !`),gC.get(this.map)||null===(e=this._option)||void 0===e||e.onError(`'${this.map}' data is not registered !`)}initData(){var t,e;super.initData(),gw(this._dataSet,"copyDataView",gP),gw(this._dataSet,"map",RR),gw(this._dataSet,"lookup",RE);let i=gC.get(this.map);i||null===(t=this._option)||void 0===t||t.onError("no valid map data found!");let r=new eH(this._dataSet,{name:`map_${this.id}_data`});r.parse([i],{type:"dataview"}).transform({type:"copyDataView",options:{deep:!0},level:ty.copyDataView}).transform({type:"map",options:{nameMap:this._nameMap,nameProperty:this._nameProperty}}).transform({type:"lookup",options:{from:()=>{var t;return null===(t=this._data)||void 0===t?void 0:t.getLatestData()},key:RP,fields:this._nameField,set:(t,e)=>{e&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}}}),null===(e=this._data)||void 0===e||e.getDataView().target.addListener("change",r.reRunAllTransform),this._mapViewData=new CH(this._option,r)}initMark(){this._pathMark=this._createMark(RU.mark.area,{morph:C0(this._spec,RU.mark.area.name),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this.getDimensionField()[0],isSeriesMark:!0,skipBeforeLayouted:!0,dataView:this._mapViewData.getDataView(),dataProductId:this._mapViewData.getProductId()})}initMarkStyle(){let t=this._pathMark;t&&(this.setMarkStyle(t,{fill:t=>{var e,i,r,n;return eO(t[null!==(e=this._seriesField)&&void 0!==e?e:bM])?(null!==(i=this._option.globalScale.getScale("color"))&&void 0!==i?i:this._getDefaultColorScale()).scale(t[null!==(r=this._seriesField)&&void 0!==r?r:bM]):null===(n=this._spec)||void 0===n?void 0:n.defaultFillColor},path:this.getPath.bind(this)},"normal",tw.Series),t.setPostProcess("fill",t=>eO(t)?t:this._spec.defaultFillColor),this.setMarkStyle(t,{smoothScale:!0},"normal",tw.Built_In))}initLabelMarkStyle(t){t&&(this._labelMark=t,this.setMarkStyle(t,{text:t=>this.getDatumName(t),x:t=>{var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.x},y:t=>{var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.y}}))}initAnimation(){var t;this._pathMark.setAnimationConfig(CX(null===(t=de.getAnimationInKey("fadeInOut"))||void 0===t?void 0:t(),Cq("area",this._spec,this._markAttributeContext)))}initTooltip(){this._tooltipHelper=new RB(this),this._pathMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pathMark)}getPath(t){var e;let i=this._areaCache.get(t[bA]);if(i)return i.shape;let r=null===(e=this._coordinateHelper)||void 0===e?void 0:e.shape(t);return this._areaCache.set(t[bA],{shape:r}),r}onEvaluateEnd(){this._mapViewData.updateData()}getDimensionField(){return[this.nameField]}getMeasureField(){return[this.valueField]}release(){super.release(),this._areaCache.clear(),this._nameMap={},this._mapViewData=null}handleZoom(t){var e,i,r;let{scale:n,scaleCenter:s}=t;if(1===n)return;let a=null===(e=this.getRootMark().getProduct())||void 0===e?void 0:e.getGroupGraphicItem();a&&(a.attribute.postMatrix||a.setAttributes({postMatrix:new iE}),a.scale(n,n,s));let o=null===(r=null===(i=this._labelMark)||void 0===i?void 0:i.getComponent())||void 0===r?void 0:r.getProduct();o&&o.evaluate(null,null)}handlePan(t){var e,i,r;let{delta:n}=t;if(0===n[0]&&0===n[1])return;let s=null===(e=this.getRootMark().getProduct())||void 0===e?void 0:e.getGroupGraphicItem();s&&(s.attribute.postMatrix||s.setAttributes({postMatrix:new iE}),s.translate(n[0],n[1]));let a=null===(r=null===(i=this._labelMark)||void 0===i?void 0:i.getComponent())||void 0===r?void 0:r.getProduct();a&&a.evaluate(null,null)}getDatumCenter(t){var e,i,r,n;return this._centroidProperty&&(null===(e=t.properties)||void 0===e?void 0:e[this._centroidProperty])?null===(i=t.properties)||void 0===i?void 0:i[this._centroidProperty]:l1(t.centroidX*t.centroidY)?[t.centroidX,t.centroidY]:(null===(r=t.properties)||void 0===r?void 0:r.center)?t.properties.center:(null===(n=t.properties)||void 0===n?void 0:n.centroid)?t.properties.centroid:[Number.NaN,Number.NaN]}getDatumName(t){var e;if(t[this.nameField])return t[this.nameField];let i=null===(e=t.properties)||void 0===e?void 0:e[this._nameProperty];if(i){if(this._spec.nameMap&&this._spec.nameMap[i])return this._spec.nameMap[i];if(this._spec.showDefaultName||!this._spec.nameMap)return i}return""}dataToPositionX(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0}dataToPositionY(t){var e;return null===(e=this._option)||void 0===e||e.onError("Method not implemented."),0}viewDataUpdate(t){var e,i,r;super.viewDataUpdate(t),null===(i=null===(e=this._mapViewData)||void 0===e?void 0:e.getDataView())||void 0===i||i.reRunAllTransform(),null===(r=this._mapViewData)||void 0===r||r.updateData()}_getDataIdKey(){return bA}getActiveMarks(){return[this._pathMark]}}RU.type=cZ.map,RU.mark=hV,RU.transformerConstructor=RG;let R$=()=>{RT(),RW(),RL(),de.registerSeries(RU.type,RU),de.registerImplement("registerMap",gT),de.registerImplement("unregisterMap",gE),w7()};class RY extends OE{_isValidSeries(t){return t===cZ.map}_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{type:t.type,nameField:t.nameField,valueField:t.valueField,seriesField:t.seriesField,map:t.map,nameProperty:t.nameProperty,centroidProperty:t.centroidProperty,nameMap:t.nameMap,area:t.area,defaultFillColor:t.defaultFillColor,showDefaultName:t.showDefaultName})}transformSpec(t){super.transformSpec(t),t.region.forEach(t=>{t.coordinate="geo"});let e=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}):t.series=[e]}}class RK extends OD{constructor(){super(...arguments),this.transformerConstructor=RY,this.type="map",this.seriesType=cZ.map}}RK.type="map",RK.seriesType=cZ.map,RK.transformerConstructor=RY;let RZ=`${hA}_LABEL_VISIBLE`;function RX(t){return function(e){let i;return eM(t)?t.reduce((t,e)=>null==t?void 0:t[e],e):null==e?void 0:e[t]}}class Rq extends C5{constructor(){super(...arguments),this.coordinate="polar",this._outerRadius=.6,this._innerRadius=0,this._angleField=[],this._radiusField=[],this._sortDataByAxis=!1}get outerRadius(){return this._outerRadius}get innerRadius(){return this._innerRadius}getAngleField(){return this._angleField}setAngleField(t){return this._angleField=eO(t)?om(t):[],this._angleField}getRadiusField(){return this._radiusField}setRadiusField(t){return this._radiusField=eO(t)?om(t):[],this._radiusField}get innerRadiusField(){return this._innerRadiusField}setInnerRadiusField(t){return this._innerRadiusField=om(t),this._innerRadiusField}get radiusScale(){return this._radiusScale}setRadiusScale(t){return this._radiusScale=t,t}get angleScale(){return this._angleScale}setAngleScale(t){return this._angleScale=t,t}get angleAxisHelper(){return this._angleAxisHelper}set angleAxisHelper(t){this._angleAxisHelper=t,this.onAngleAxisHelperUpdate()}get radiusAxisHelper(){return this._radiusAxisHelper}set radiusAxisHelper(t){this._radiusAxisHelper=t,this.onRadiusAxisHelperUpdate()}get sortDataByAxis(){return this._sortDataByAxis}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getCenter=()=>this.angleAxisHelper.center(),this._markAttributeContext.getLayoutRadius=()=>this._computeLayoutRadius()}valueToPosition(t,e){if(ej(t)||ej(e)||!this.angleAxisHelper||!this.radiusAxisHelper)return{x:Number.NaN,y:Number.NaN};let i=this.angleAxisHelper.dataToPosition(om(t)),r=this.radiusAxisHelper.dataToPosition(om(e));return this.angleAxisHelper.coordToPoint({angle:i,radius:r})}dataToPosition(t,e){return t&&this.angleAxisHelper&&this.radiusAxisHelper?e&&!this.isDatumInViewData(t)?null:this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getDatumPositionValues(t,this._radiusField)):null}dataToPositionX(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.x}dataToPositionY(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.y}dataToPositionZ(t){return 0}positionToData(t){}radiusToData(t){}angleToData(t){}getStatisticFields(){var t,e;let i=[];return(null===(t=this.radiusAxisHelper)||void 0===t?void 0:t.getScale)&&this._radiusField.forEach(t=>{let e={key:t,operations:[]};dr(this.radiusAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],i.push(e)}),(null===(e=this.angleAxisHelper)||void 0===e?void 0:e.getScale)&&this._angleField.forEach(t=>{let e={key:t,operations:[]};dr(this.angleAxisHelper.getScale(0).type)?e.operations=["max","min"]:e.operations=["values"],i.push(e)}),i}setAttrFromSpec(){super.setAttrFromSpec(),eO(this._spec.outerRadius)&&(this._outerRadius=this._spec.outerRadius),eO(this._spec.radius)&&(this._outerRadius=this._spec.radius),eO(this._spec.innerRadius)&&(this._innerRadius=this._spec.innerRadius),eO(this._spec.sortDataByAxis)&&(this._sortDataByAxis=!0===this._spec.sortDataByAxis)}onRadiusAxisHelperUpdate(){this.onMarkPositionUpdate()}onAngleAxisHelperUpdate(){this.onMarkPositionUpdate()}afterInitMark(){super.afterInitMark()}_computeLayoutRadius(){let t=this._angleAxisHelper||this._radiusAxisHelper;if(t)return t.layoutRadius();let{width:e,height:i}=this._region.getLayoutRect();return Math.min(e/2,i/2)}initEvent(){super.initEvent(),this.sortDataByAxis&&this.event.on(c1.scaleDomainUpdate,{filter:t=>{var e;return t.model.id===(null===(e=this._angleAxisHelper)||void 0===e?void 0:e.getAxisId())}},()=>{this._sortDataInAxisDomain()})}_sortDataInAxisDomain(){var t,e;(null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.latestData)||void 0===e?void 0:e.length)&&C4(this.angleAxisHelper,this._angleField[0],this.getViewData().latestData)}getInvalidCheckFields(){let t=[];return this.angleAxisHelper.isContinuous&&this._angleField.forEach(e=>{t.push(e)}),this.radiusAxisHelper.isContinuous&&this._radiusField.forEach(e=>{t.push(e)}),t}}let RJ=(t,e)=>{let i=t.map(t=>Object.assign({},t));if(!i||0===i.length)return i;let{angleField:r,startAngle:n,endAngle:s,minAngle:a,asStartAngle:o,asEndAngle:l,asMiddleAngle:h,asRadian:u,asRatio:d,asQuadrant:c,asK:p}=e,g=(t,e,i)=>{var r;t[o]=e,t[l]=e+i,t[h]=e+i/2,t[u]=i,t[c]=(r=iT(r=e+i/2))>0&&r<=Math.PI/2?2:r>Math.PI/2&&r<=Math.PI?3:r>Math.PI&&r<=3*Math.PI/2?4:1},f=0,m=-Infinity;for(let t=0;t<i.length;t++){var v;let e=l8(v=i[t][r])?Number.parseFloat(v):0;f+=e,m=Math.max(e,m),i[t][uc]=e}let y=i.map(t=>Number(t[r])),_=s-n,b=n,x=_,S=0,k=function(t,e=2){let i=t.reduce((t,e)=>t+(isNaN(e)?0:e),0);if(0===i)return 0;let r=Math.pow(10,e),n=t.map(t=>(isNaN(t)?0:t)/i*r*100),s=100*r,a=n.map(t=>Math.floor(t)),o=a.reduce((t,e)=>t+e,0),l=n.map((t,e)=>t-a[e]);for(;o<s;){let t=Number.NEGATIVE_INFINITY,e=null;for(let i=0;i<l.length;i++)l[i]>t&&(t=l[i],e=i);++a[e],l[e]=0,++o}return a.map(t=>t/r)}(y);if(i.forEach((t,e)=>{let i=t[uc],r=f?i/f:0,n=r*_;n<a?(n=a,x-=a):S+=i;let s=b,o=b+n;t[d]=r,t[p]=m?i/m:0,t._percent_=k[e],g(t,s,n),b=o}),x<_){if(x<=.001){let t=_/i.length;i.forEach((e,i)=>{g(e,n+i*t,t)})}else{let t=x/S;b=n,i.forEach(e=>{let i=e[u]===a?a:e[uc]*t;g(e,b,i),b+=i})}}return 0!==f&&(i[i.length-1][l]=s),i};function RQ(t,e,i){return(r,n,s)=>e?"radius"===t.growField?{overall:0}:{overall:t.growFrom(r,n,i)}:{overall:!1}}let R0=t=>({type:"radius"===t.growField?"growRadiusIn":"growAngleIn",options:RQ(t,!0,t_.appear)}),R1={type:"fadeIn"},R2=t=>({type:"radius"===t.growField?"growRadiusIn":"growAngleIn",easing:"linear",options:RQ(t,!0,t_.enter)}),R3=t=>({type:"radius"===t.growField?"growRadiusOut":"growAngleOut",easing:"linear",options:RQ(t,!0,t_.exit)}),R5=t=>({type:"radius"===t.growField?"growRadiusOut":"growAngleOut",options:RQ(t,!0,t_.exit)});function R4(t,e){if(!1===e)return{};switch(e){case"fadeIn":return R1;case"growRadius":return R0(Object.assign(Object.assign({},t),{growField:"radius"}));default:return R0(Object.assign(Object.assign({},t),{growField:"angle"}))}}let R8=()=>{de.registerAnimation("pie",(t,e)=>({appear:R4(t,e),enter:R2(t),exit:R3(t),disappear:R5(t)}))},R6=()=>{de.registerAnimation("pie3d",(t,e)=>({appear:R4(t,e),enter:R2(t),exit:R3(t),disappear:R5(t)}))};class R9 extends Sd{constructor(t,e){super(t,e),this.type=R7.type,this._unCompileChannel={centerOffset:!0,radiusOffset:!0},this.computeOuterRadius=(t,e,i="normal",r,n)=>{var s;return n+(null!==(s=this.getAttribute("radiusOffset",e,i,r))&&void 0!==s?s:0)},this.computeCenter=(t,e,i="normal",r,n)=>iM({x:0,y:0},this.getAttribute("centerOffset",e,i,r),e[uv])[t]+n,this._computeExChannel.x=this.computeCenter,this._computeExChannel.y=this.computeCenter,this._computeExChannel.outerRadius=this.computeOuterRadius,this._extensionChannel.centerOffset=["x","y"],this._extensionChannel.radiusOffset=["outerRadius"]}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{startAngle:0,endAngle:0,outerRadius:0,innerRadius:0,cornerRadius:0,lineWidth:0,innerPadding:0,outerPadding:0})}}class R7 extends R9{constructor(){super(...arguments),this.type=R7.type}}R7.type="arc";let Bt=()=>{AL(),Ms(),de.registerMark(R7.type,R7)};class Be extends C3{_transformLabelSpec(t){this._addMarkLabelSpec(t,"pie")}_mergeThemeToSpec(t,e){let i=this._theme,r=t;if(this._shouldMergeThemeToSpec()){let i=this._getDefaultSpecFromChart(e);r=us({},this._theme,i,t);let n=(t,e)=>us({},"inside"===t?this._theme.innerLabel:this._theme.outerLabel,e);eM(r.label)?r.label=r.label.map(t=>n(t.position,t)):r.label=n(r.label.position,r.label)}return{spec:r,theme:i}}_getDefaultSpecFromChart(t){var e;let i=null!==(e=super._getDefaultSpecFromChart(t))&&void 0!==e?e:{},{centerX:r,centerY:n}=t;return eO(r)&&(i.centerX=r),eO(n)&&(i.centerY=n),Object.keys(i).length>0?i:void 0}}class Bi extends Rq{constructor(){super(...arguments),this.transformerConstructor=Be,this._pieMarkName="pie",this._pieMarkType="arc",this._startAngle=ub,this._endAngle=ux,this._pieMark=null,this._labelMark=null,this._labelLineMark=null,this.dataToCentralPosition=t=>{let e=t[uv];if(ej(e))return null;let i=this.computeDatumRadius(t),r=this.computeDatumInnerRadius(t);return iM(this.computeCenter(t),(i+r)/2,e)}}getCenter(){var t,e,i,r;let{width:n,height:s}=this._region.getLayoutRect();return{x:null!==(e=null===(t=this._spec)||void 0===t?void 0:t.centerX)&&void 0!==e?e:n/2,y:null!==(r=null===(i=this._spec)||void 0===i?void 0:i.centerY)&&void 0!==r?r:s/2}}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getCenter=()=>({x:()=>this.getCenter().x,y:()=>this.getCenter().y}),this._markAttributeContext.startAngleScale=t=>this.startAngleScale(t),this._markAttributeContext.endAngleScale=t=>this.endAngleScale(t)}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this._centerOffset=null!==(t=this._spec.centerOffset)&&void 0!==t?t:0,this._cornerRadius=null!==(e=this._spec.cornerRadius)&&void 0!==e?e:0;let i=function(t,e){let i=0,r=2*Math.PI,n=eO(t),s=eO(e);for(n||s?s?(n?i=t:i=e-2*Math.PI,r=e):(i=t,r=t+2*Math.PI):(i=0,r=2*Math.PI);r<=i;)r+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI,r-=2*Math.PI;for(;r<0;)i+=2*Math.PI,r+=2*Math.PI;return{startAngle:i,endAngle:r}}(eO(this._spec.startAngle)?ik(this._spec.startAngle):this._startAngle,eO(this._spec.endAngle)?ik(this._spec.endAngle):this._endAngle);this._startAngle=i.startAngle,this._endAngle=i.endAngle,this._padAngle=eO(this._spec.padAngle)?ik(this._spec.padAngle):0,this.setAngleField(this._spec.valueField||this._spec.angleField),this._spec.categoryField&&this.setSeriesField(this._spec.categoryField),this._radiusField=[],this._specAngleField=this._angleField.slice(),this._specRadiusField=[]}initData(){super.initData();let t=this.getViewData();if(!t)return;gw(this._dataSet,"pie",RJ),t.transform({type:"pie",options:{angleField:this._angleField[0],startAngle:this._startAngle,endAngle:this._endAngle,minAngle:eO(this._spec.minAngle)?ik(this._spec.minAngle):0,asStartAngle:ug,asEndAngle:uf,asRatio:up,asMiddleAngle:uv,asRadian:u_,asQuadrant:uy,asK:um}},!1);let e=new eH(this._dataSet,{name:`${hA}_series_${this.id}_viewDataLabel`});e.parse([this.getViewData()],{type:"dataview"}),this._viewDataLabel=new CH(this._option,e)}initMark(){var t,e;this._pieMark=this._createMark(Object.assign(Object.assign({},Bi.mark.pie),{name:this._pieMarkName,type:this._pieMarkType}),{morph:C0(this._spec,this._pieMarkName),defaultMorphElementKey:this._seriesField,key:bw,groupKey:this._seriesField,skipBeforeLayouted:!0,isSeriesMark:!0,customShape:null===(t=this._spec.pie)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.pie)||void 0===e?void 0:e.stateSort})}startAngleScale(t){return RX(ug)(t)}endAngleScale(t){return RX(uf)(t)}initMarkStyle(){let t=this._pieMark;t&&this.setMarkStyle(t,{x:()=>this.getCenter().x,y:()=>this.getCenter().y,fill:this.getColorAttribute(),outerRadius:Si(this._outerRadius)?this._outerRadius:()=>this._computeLayoutRadius()*this._outerRadius,innerRadius:Si(this._innerRadius)?this._innerRadius:()=>this._computeLayoutRadius()*this._innerRadius,cornerRadius:()=>this._computeLayoutRadius()*this._cornerRadius,startAngle:t=>this.startAngleScale(t),endAngle:t=>this.endAngleScale(t),padAngle:this._padAngle,centerOffset:this._centerOffset},"normal",tw.Series)}initInteraction(){this._parseInteractionConfig(this._pieMark?[this._pieMark]:[])}initTooltip(){super.initTooltip(),this._pieMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pieMark)}initMarkStyleWithSpec(t,e,i){if(super.initMarkStyleWithSpec(t,e,i),t.name===this._pieMarkName){let e=this.getSpec()[t.name];if(e)for(let i in e.state||{})this.setMarkStyle(t,this.generateRadiusStyle(e.state[i]),i,tw.User_Mark)}}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{visible:RX(RZ).bind(this),text:t=>t[this.getDimensionField()[0]],fill:this.getColorAttribute(),z:this.dataToPositionZ.bind(this)})}afterInitMark(){super.afterInitMark()}initEvent(){var t;super.initEvent(),null===(t=this._viewDataLabel.getDataView())||void 0===t||t.target.addListener("change",this.viewDataLabelUpdate.bind(this))}initGroups(){}onLayoutEnd(t){this._viewDataLabel.getDataView().reRunAllTransform(),this.onMarkPositionUpdate(),super.onLayoutEnd(t)}getDimensionField(){return this._seriesField?[this._seriesField]:[]}getMeasureField(){return this._specAngleField}viewDataLabelUpdate(){this.event.emit(c1.viewDataLabelUpdate,{model:this}),this._viewDataLabel.updateData()}generateRadiusStyle(t){if(!t)return;let e={};return t.outerRadius&&(e.outerRadius=()=>this._computeLayoutRadius()*t.outerRadius),t.innerRadius&&(e.innerRadius=()=>this._computeLayoutRadius()*t.innerRadius),t.cornerRadius&&(e.cornerRadius=()=>this._computeLayoutRadius()*t.cornerRadius),e}computeCenter(t){return{x:this._pieMark.getAttribute("x",t,"normal"),y:this._pieMark.getAttribute("y",t,"normal")}}getRadius(t="normal"){var e,i,r,n,s,a,o;let l="normal"===t?null===(r=null===(i=this.getSpec()[(null===(e=this._pieMark)||void 0===e?void 0:e.name)||"pie"])||void 0===i?void 0:i.style)||void 0===r?void 0:r.outerRadius:null===(o=null===(a=null===(s=this.getSpec()[(null===(n=this._pieMark)||void 0===n?void 0:n.name)||"pie"])||void 0===s?void 0:s.state)||void 0===a?void 0:a[t])||void 0===o?void 0:o.outerRadius;return null!=l?l:this._outerRadius}getInnerRadius(t="normal"){var e,i,r,n,s,a,o;let l="normal"===t?null===(r=null===(i=this.getSpec()[(null===(e=this._pieMark)||void 0===e?void 0:e.name)||"pie"])||void 0===i?void 0:i.style)||void 0===r?void 0:r.innerRadius:null===(o=null===(a=null===(s=this.getSpec()[(null===(n=this._pieMark)||void 0===n?void 0:n.name)||"pie"])||void 0===s?void 0:s.state)||void 0===a?void 0:a[t])||void 0===o?void 0:o.innerRadius;return null!=l?l:this._innerRadius}computeRadius(t,e){return this._computeLayoutRadius()*t*(ej(e)?1:e)+this._centerOffset}computeDatumRadius(t,e){return this._computeLayoutRadius()*this.getRadius(e)+this._centerOffset}_compareSpec(t,e,i){(i=null!=i?i:{data:!0}).centerX=!0,i.centerX=!0,i.centerY=!0,i.centerOffset=!0,i.radius=!0,i.innerRadius=!0,i.cornerRadius=!0,i.startAngle=!0,i.endAngle=!0,i.padAngle=!0;let{centerX:r,centerY:n,centerOffset:s,radius:a,innerRadius:o,cornerRadius:l,startAngle:h,endAngle:u,padAngle:d}=e,c=super._compareSpec(t,e,i);return(t=null!=t?t:{}).centerY===n&&t.centerX===r&&t.centerOffset===s&&t.radius===a&&t.innerRadius===o&&t.cornerRadius===l&&t.startAngle===h&&t.endAngle===u&&t.padAngle===d||(c.reRender=!0,c.change=!0),c}computeDatumInnerRadius(t,e){return this._computeLayoutRadius()*this.getInnerRadius(e)+this._centerOffset}dataToPosition(t,e){let i=t[uv];if(ej(i)||e&&!this.isDatumInViewData(t))return null;let r=this.computeDatumRadius(t);return iM(this.computeCenter(t),r,i)}initAnimation(){var t,e;let i=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;if(this._pieMark){let t=CX(null===(e=de.getAnimationInKey("pie"))||void 0===e?void 0:e({growFrom:(t,e,i)=>{var r;if(i===t_.appear)return this._startAngle;if(i===t_.disappear)return this._endAngle;let n=[t_.disappear,t_.exit],s=e.mark.elements,a=null==t?void 0:t[bA];if(void 0===s.find(t=>{var e;return(null===(e=t.data[0])||void 0===e?void 0:e[bA])<a}))return this._startAngle;if(void 0===s.find(t=>{var e;return(null===(e=t.data[0])||void 0===e?void 0:e[bA])>a}))return this._endAngle;let o=[...s].reverse().find(t=>{var e;return(null===(e=t.data[0])||void 0===e?void 0:e[bA])<a});return n.includes(i)?null===(r=null==o?void 0:o.getNextGraphicAttributes())||void 0===r?void 0:r.endAngle:null==o?void 0:o.getGraphicAttribute("endAngle",!0)}},i),Cq("pie",this._spec,this._markAttributeContext));t.normal&&t.normal.type&&(t.normal=function(t,e){var i,r,n,s;let a=null!==(r=null===(i=e.options)||void 0===i?void 0:i.distance)&&void 0!==r?r:10,o=l1(e.duration)?e.duration/2:1e3,l=null!==(n=e.options.easing)&&void 0!==n?n:"cubicOut";return{oneByOne:e.oneByOne,loop:null!==(s=e.loop)&&void 0!==s&&s,timeSlices:[{duration:o,effects:{easing:l,channel:{x:{from:e=>t.getAttribute("x",e),to:e=>t.getAttribute("x",e)+iM({x:0,y:0},a,e[uv]).x},y:{from:e=>t.getAttribute("y",e),to:e=>t.getAttribute("y",e)+iM({x:0,y:0},a,e[uv]).y}}}},{duration:o,effects:{easing:l,channel:{x:{to:e=>t.getAttribute("x",e),from:e=>t.getAttribute("x",e)+iM({x:0,y:0},a,e[uv]).x},y:{to:e=>t.getAttribute("y",e),from:e=>t.getAttribute("y",e)+iM({x:0,y:0},a,e[uv]).y}}}}]}}(this._pieMark,t.normal)),this._pieMark.setAnimationConfig(t)}}getDefaultShapeType(){return"circle"}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}_noAnimationDataKey(t,e){return e}getActiveMarks(){return[this._pieMark]}}Bi.transformerConstructor=Be,Bi.mark=hN;class Br extends Bi{constructor(){super(...arguments),this.type=cZ.pie}}Br.type=cZ.pie;let Bn=()=>{Bt(),R8(),de.registerSeries(Br.type,Br)};class Bs extends OE{_isValidSeries(t){return!this.seriesType||t===this.seriesType}getIndicatorSpec(t){var e,i,r;let n=om(t.indicator),s=null!==(e=t.innerRadius)&&void 0!==e?e:null===(r=null===(i=t.series)||void 0===i?void 0:i[0])||void 0===r?void 0:r.innerRadius;return eO(s)&&n.forEach(t=>{ej(t.limitRatio)&&(t.limitRatio=s)}),n}_getDefaultSeriesSpec(t){let e=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{radius:t.radius,outerRadius:t.outerRadius,innerRadius:t.innerRadius,startAngle:t.startAngle,endAngle:t.endAngle,sortDataByAxis:t.sortDataByAxis}),i=this.seriesType;return i&&(e.type=i,e[i]=t[i]),e}transformSpec(t){super.transformSpec(t),eM(t.dataZoom)&&t.dataZoom.length>0&&t.dataZoom.forEach(t=>{"axis"===t.filterMode&&(t.filterMode="filter")}),this.transformSeriesSpec(t),eO(t.indicator)&&(t.indicator=this.getIndicatorSpec(t))}}class Ba extends Bs{needAxes(){return!1}_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{categoryField:t.categoryField||t.seriesField,valueField:t.valueField||t.angleField,center:t.center,centerOffset:t.centerOffset,cornerRadius:t.cornerRadius,padAngle:t.padAngle,minAngle:t.minAngle})}}class Bo extends OD{constructor(){super(...arguments),this.transformerConstructor=Ba}}Bo.transformerConstructor=Ba;class Bl extends Bo{constructor(){super(...arguments),this.transformerConstructor=Ba,this.type="pie",this.seriesType=cZ.pie}}Bl.type="pie",Bl.seriesType=cZ.pie,Bl.transformerConstructor=Ba;class Bh extends R9{constructor(){super(...arguments),this.type=Bh.type,this._support3d=!0}}Bh.type="arc3d";let Bu=()=>{Ms(),AD(),de.registerMark(Bh.type,Bh)};class Bd extends Be{_transformLabelSpec(t){this._addMarkLabelSpec(t,"pie3d")}}class Bc extends Bi{constructor(){super(...arguments),this.type=cZ.pie3d,this._pieMarkName="pie3d",this._pieMarkType="arc3d",this.transformerConstructor=Bd}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this._angle3d=null!==(e=null===(t=this._spec)||void 0===t?void 0:t.angle3d)&&void 0!==e?e:-Math.PI/3}initMarkStyle(){super.initMarkStyle();let t=this._pieMark;t&&this.setMarkStyle(t,{beta:()=>this._angle3d},"normal",tw.Series)}initLabelMarkStyle(t,e={}){if(!t)return;super.initLabelMarkStyle(t);let i={};t.setSupport3d(!0),i.beta=this._angle3d,i.anchor3d=t=>{let{x:e,y:i}=this.getCenter();return[e,i]},i.angle=t=>{let i=t[uv];return"inside"===e.position?iA(i):0},this.setMarkStyle(t,Object.assign(Object.assign({},i),{z:100}),void 0,tw.Mark)}}Bc.type=cZ.pie3d,Bc.mark=hz,Bc.transformerConstructor=Bd;let Bp=()=>{R6(),Bu(),de.registerSeries(Bc.type,Bc)};class Bg extends Ba{transformSpec(t){super.transformSpec(t),t.series.forEach(e=>{"pie3d"===e.type&&(e.angle3d=t.angle3d)})}}class Bf extends Bo{constructor(){super(...arguments),this.transformerConstructor=Bg,this.type="pie3d",this.seriesType=cZ.pie3d}}Bf.type="pie3d",Bf.seriesType=cZ.pie3d,Bf.transformerConstructor=Bg;let Bm=t=>{let e="angle"===t.growField?0:t.innerRadius;return"angle"===t.growField?{type:"angle"===t.growField?"growAngleIn":"growRadiusIn"}:{channel:{innerRadius:{from:e,to:(t,e)=>{var i;return null===(i=e.getFinalGraphicAttributes())||void 0===i?void 0:i.innerRadius}},outerRadius:{from:e,to:(t,e)=>{var i;return null===(i=e.getFinalGraphicAttributes())||void 0===i?void 0:i.outerRadius}}}}},Bv={type:"fadeIn"},By=t=>({type:"angle"===t.growField?"growAngleIn":"growRadiusIn"}),B_=t=>({type:"angle"===t.growField?"growAngleOut":"growRadiusOut"}),Bb=t=>({type:"angle"===t.growField?"growAngleOut":"growRadiusOut"}),Bx=()=>{de.registerAnimation("rose",(t,e)=>({appear:function(t,e){if(!1===e)return{};switch(e){case"fadeIn":return Bv;case"growAngle":return Bm(Object.assign(Object.assign({},t),{growField:"angle"}));default:return Bm(Object.assign(Object.assign({},t),{growField:"radius"}))}}(t,e),enter:By(t),exit:B_(t),disappear:Bb(t)}))};class BS extends Rq{getStackGroupFields(){return this._angleField}getStackValueField(){return om(this._spec.valueField)[0]||om(this._spec.radiusField)[0]}getGroupFields(){return this._angleField}setAttrFromSpec(){super.setAttrFromSpec(),this.setAngleField(this._spec.categoryField||this._spec.angleField),this.setRadiusField(this._spec.valueField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice(),this.setInnerRadiusField(this._spec.valueField||this._spec.radiusField),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent()}setValueFieldToStack(){this.setRadiusField(bO),this.setInnerRadiusField(bE)}setValueFieldToPercent(){this.setRadiusField(bR),this.setInnerRadiusField(bP)}getDimensionField(){return this._specAngleField}getMeasureField(){return this._specRadiusField}getDefaultShapeType(){return"square"}}class Bk extends C3{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(t){this._addMarkLabelSpec(t,"rose")}}let BA=(t,e)=>{var i,r,n,s,a,o;let l=null!==(i=t.type)&&void 0!==i?i:"angle"===t.orient?"band":"linear",h=`${lx.polarAxis}-${l}`,u=null!==(r=t.startAngle)&&void 0!==r?r:e.startAngle,d=null!==(n=t.endAngle)&&void 0!==n?n:e.endAngle;return{axisType:l,componentName:h,startAngle:null!=u?u:-90,endAngle:null!=d?d:eO(u)?u+360:270,center:eO(e.center)?e.center:eO(null==e?void 0:e.centerX)||eO(null==e?void 0:e.centerY)?{x:null==e?void 0:e.centerX,y:null==e?void 0:e.centerY}:void 0,outerRadius:null!==(o=null!==(a=null!==(s=t.radius)&&void 0!==s?s:e.outerRadius)&&void 0!==a?a:e.radius)&&void 0!==o?o:.6,layoutRadius:e.layoutRadius}};var Bw=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class BM extends Od{get center(){return this._center}get startAngle(){return this._startAngle}get endAngle(){return this._endAngle}getOrient(){return this._orient}getGroupScales(){return this._groupScales}static getSpecInfo(t){let e;let i=t[this.specKey];if(!i)return null;if(!eM(i)){if(!TY(i))return null;let{axisType:e,componentName:r,startAngle:n,endAngle:s,center:a,outerRadius:o,layoutRadius:l}=BA(i,t);return i.center=a,i.startAngle=n,i.endAngle=s,i.outerRadius=o,i.type=e,i.layoutRadius=l,[{spec:i,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:r}]}let r=[],n=[];return i.forEach((i,s)=>{if(!TY(i))return;let{axisType:a,componentName:o,startAngle:l,endAngle:h,center:u,outerRadius:d,layoutRadius:c}=BA(i,t);i.center=u,i.startAngle=l,i.endAngle=h,i.outerRadius=d,i.type=a,i.layoutRadius=c;let p={spec:i,specPath:[this.specKey,s],specInfoPath:["component",this.specKey,s],type:o};r.push(p),"radius"===i.orient?n.push(p):e=s}),n.forEach(t=>{t.angleAxisIndex=e}),r}static createComponent(t,e){let{spec:i}=t,r=Bw(t,["spec"]),n=de.getComponentInKey(r.type);return n?new n(i,Object.assign(Object.assign({},e),r)):(e.onError(`Component ${r.type} not found`),null)}constructor(t,e){super(t,e),this.type=lx.polarAxis,this.name=lx.polarAxis,this._defaultBandPosition=0,this._defaultBandInnerPadding=0,this._defaultBandOuterPadding=0,this.layoutType="absolute",this.layoutZIndex=tM.Axis,this._tick=void 0,this._center=null,this._startAngle=ub,this._endAngle=ux,this._orient="radius",this._groupScales=[],this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),dC(this._regions,t=>{"radius"===this.getOrient()?t.radiusAxisHelper=this.axisHelper():t.angleAxisHelper=this.axisHelper()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._transformLayoutPosition=t=>{var e;let i=null===(e=this.getRegions())||void 0===e?void 0:e[0];return i?i.getLayoutStartPoint():t},this._coordinateType="polar"}setAttrFromSpec(){super.setAttrFromSpec(),this.visible&&(this._axisStyle=this._getAxisAttributes(),this._gridStyle=this._getGridAttributes()),this._tick=this._spec.tick,this._orient="angle"===this._spec.orient?"angle":"radius",this._center=this._spec.center,this._startAngle=ik(this._spec.startAngle),this._endAngle=ik(this._spec.endAngle),this._inverse=this._spec.inverse}onRender(t){}changeRegions(){}_tickTransformOption(){var t;return Object.assign(Object.assign({},super._tickTransformOption()),{noDecimal:null===(t=this._tick)||void 0===t?void 0:t.noDecimals,startAngle:this.startAngle,labelOffset:TG(this._spec),getRadius:()=>this.getOuterRadius(),inside:this._spec.inside})}afterCompile(){var t;let e=null===(t=this._axisMark)||void 0===t?void 0:t.getProduct();e&&e.addEventListener(pa.AFTER_ELEMENT_ENCODE,()=>{!1===this._isLayout&&this._delegateAxisContainerEvent(e.getGroupGraphicItem())})}updateScaleRange(){let t;let e=this._scale.range();return t="radius"===this.getOrient()?this._inverse?[this.computeLayoutOuterRadius(),this.computeLayoutInnerRadius()]:[this.computeLayoutInnerRadius(),this.computeLayoutOuterRadius()]:this._inverse?[this._endAngle,this._startAngle]:[this._startAngle,this._endAngle],(!e||!t||e[0]!==t[0]||e[1]!==t[1])&&(this._scale.range(t),!0)}collectSeriesField(t,e){var i,r;let n;return t>0?null===(r=null===(i=e.getGroups())||void 0===i?void 0:i.fields)||void 0===r?void 0:r[t]:"radius"===this.getOrient()?e.getRadiusField():e.getAngleField()}updateSeriesScale(){dC(this._regions,t=>{"radius"===this.getOrient()?(t.setRadiusScale(this._scale),t.radiusAxisHelper=this.axisHelper()):(t.setAngleScale(this._scale),t.angleAxisHelper=this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}getSeriesStatisticsField(t){let e="radius"===this.getOrient()?t.getRadiusField():t.getAngleField();return dr(this._scale.type)?e:[e[0]]}initGroupScales(){}axisHelper(){return{isContinuous:dr(this._scale.type),dataToPosition:this.dataToPosition.bind(this),coordToPoint:this.coordToPoint.bind(this),pointToCoord:this.pointToCoord.bind(this),center:this.getCenter.bind(this),layoutRadius:this.computeLayoutRadius.bind(this),getScale:(t=0)=>this._scales[t],getAxisId:()=>this.id,getSpec:()=>this._spec}}positionToData(t){let e=this.pointToCoord(t);return"radius"===this.getOrient()?this.invert(e.radius):this.invert(e.angle)}coordToPoint(t){return iM(this.getCenter(),t.radius,t.angle)}pointToCoord(t){let{x:e,y:i}=this.getCenter(),r=t.x-e,n=t.y-i,s=this._startAngle,a=this._endAngle,o=Math.sqrt(r*r+n*n);r/=o;let l=Math.atan2(n/=o,r);if(l<s)for(;l<=s;)l+=2*Math.PI;if(l>a)for(;l>=a;)l-=2*Math.PI;return{radius:o,angle:l}}getCenter(){var t,e;let i=this.getRefLayoutRect(),{width:r,height:n}=i;return{x:ht(null===(t=this._center)||void 0===t?void 0:t.x,r,i,r/2),y:ht(null===(e=this._center)||void 0===e?void 0:e.y,n,i,n/2)}}getOuterRadius(){return this.computeLayoutOuterRadius()}getInnerRadius(){return this.computeLayoutInnerRadius()}updateLayoutAttribute(){this._visible&&("radius"===this.getOrient()?this._layoutRadiusAxis():this._layoutAngleAxis()),super.updateLayoutAttribute()}_getNormalizedValue(t,e){return 0===e?0:(this.dataToPosition(t)-this._getStartValue())/e}getLabelItems(t){var e;let i=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();return i&&i.length?[i.map(e=>Tq(e.value,this._getNormalizedValue([e.value],t)))]:[]}_getStartValue(){return"radius"===this.getOrient()?this.computeLayoutInnerRadius():this._startAngle}_layoutAngleAxis(){let t=this.getCenter(),e=this.computeLayoutOuterRadius(),i=this.computeLayoutInnerRadius(),r=this._endAngle-this._startAngle,n=this.getLabelItems(r),s=Object.assign(Object.assign({},this.getLayoutStartPoint()),{inside:this._spec.inside,center:t,radius:e,innerRadius:i,startAngle:this._startAngle,endAngle:this._endAngle}),a=Object.assign(Object.assign({},s),{title:{text:this._spec.title.text||this._dataFieldText},items:n,orient:"angle"});this._spec.grid.visible&&(a.grid=Object.assign({type:"line",smoothLink:!0,items:n[0]},s)),this._update(a)}_layoutRadiusAxis(){var t,e,i;let r=this.getCenter(),n=this.computeLayoutOuterRadius(),s=this.computeLayoutInnerRadius(),a=this.coordToPoint({angle:this._startAngle,radius:n}),o=this.coordToPoint({angle:this._startAngle,radius:s}),l=iG.distancePP(o,a),h=this.getLabelItems(l),u=Object.assign(Object.assign({},this.getLayoutStartPoint()),{start:o,end:a,verticalFactor:-1}),d=Object.assign(Object.assign({},u),{title:{text:this._spec.title.text||this._dataFieldText},items:h,orient:"radius"});(null===(t=this._spec.grid)||void 0===t?void 0:t.visible)&&(d.grid=Object.assign({items:h[0],type:(null===(e=this._spec.grid)||void 0===e?void 0:e.smooth)?"circle":"polygon",center:r,closed:!0,sides:null===(i=this._getRelatedAngleAxis())||void 0===i?void 0:i.getScale().domain().length,startAngle:this._startAngle,endAngle:this._endAngle},u)),this._update(d)}_getRelatedAngleAxis(){let t=this._option.angleAxisIndex;if(eO(t))return this._option.getComponentByIndex(this.specKey,t)}computeLayoutRadius(){let t=this.getRefLayoutRect();if(ey(this._spec.layoutRadius))return this._spec.layoutRadius;if(nx(this._spec.layoutRadius))return this._spec.layoutRadius(t,this.getCenter());let{width:e,height:i}=t;return"auto"===this._spec.layoutRadius&&e>0&&i>0?function(t,e,i,r){let{x:n,y:s}=e,a=function(t,e){let i=Math.abs(e-t);if(i>=2*Math.PI||2*Math.PI-i<1e-6)return[0,Math.PI/2,Math.PI,1.5*Math.PI];let r=iT(Math.min(t,e)),n=r+i,s=[r,n],a=Math.floor(r/Math.PI)*Math.PI/2;for(;a<n;)a>r&&s.push(a),a+=Math.PI/2;return s}(i,r),{width:o,height:l}=t,h=[];return a.forEach(t=>{let e=Math.sin(t),i=Math.cos(t);1===e?h.push(l-s):-1===e?h.push(s):1===i?h.push(o-n):-1===i?h.push(n):(e>0?h.push(Math.abs((l-s)/i)):h.push(Math.abs(s/i)),i>0?h.push(Math.abs((o-n)/e)):h.push(Math.abs(n/e)))}),Math.min.apply(null,h)}(t,this.getCenter(),this._startAngle,this._endAngle):Math.min(e/2,i/2)}computeLayoutOuterRadius(){var t;let e=null!==(t=this._spec.outerRadius)&&void 0!==t?t:this._spec.radius,i=null!=e?e:this.getRefSeriesRadius().outerRadius;return this.computeLayoutRadius()*i}computeLayoutInnerRadius(){var t;let e=null!==(t=this._spec.innerRadius)&&void 0!==t?t:this.getRefSeriesRadius().innerRadius;return this.computeLayoutRadius()*e}getRefLayoutRect(){return this.getRegions()[0].getLayoutRect()}getRefSeriesRadius(){let t=.6,e=0,i=this.getChart().getSpec();return dC(this.getRegions(),r=>{var n;if(n=r.type,[cZ.rose,cZ.radar,cZ.circularProgress].includes(n)){let{outerRadius:n=i.outerRadius,innerRadius:s=i.innerRadius}=r;l1(n)&&(t=n),l1(s)&&(e=s)}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),{outerRadius:t,innerRadius:e}}_update(t){let{grid:e}=t,i=Bw(t,["grid"]);this._axisMark.getProduct().encode(us({},this._axisStyle,i)),this._gridMark&&this._gridMark.getProduct().encode(us({},this._gridStyle,e))}invert(t){var e;if("angle"===this.getOrient()&&"band"===this._scale.type){let i=this._scale.range(),r=i[i.length-1]-i[0],n=.5===(null!==(e=this.getSpec().bandPosition)&&void 0!==e?e:this._defaultBandPosition)?0:this._scale.bandwidth()/2;if(i[0]<0){let e=(t+n+Math.abs(i[0]))%r-Math.abs(i[0]);return this._scale.invert(e)}return this._scale.invert((t+n)%r)}return this._scale.invert(t)}}BM.type=lx.polarAxis,BM.specKey="axes";class BC extends BM{constructor(){super(...arguments),this.type=lx.polarBandAxis,this._scale=new x8}computeDomain(t){return this.computeBandDomain(t)}updateScaleRange(){let t=super.updateScaleRange();return this.updateGroupScaleRange(),t}axisHelper(){let t=super.axisHelper();return Object.assign(Object.assign({},t),{getBandwidth:e=>t.getScale(e).bandwidth()})}initScales(){super.initScales(),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)}transformScaleDomain(){}}BC.type=lx.polarBandAxis,BC.specKey="axes",CS(BC,Om);let BT=()=>{Oc(),de.registerComponent(BC.type,BC)};class BE extends BM{constructor(){super(...arguments),this.type=lx.polarLinearAxis,this._zero=!0,this._nice=!0,this._extend={},this._scale=new x1}setAttrFromSpec(){super.setAttrFromSpec(),this.setExtraAttrFromSpec()}initScales(){super.initScales(),this.setScaleNice()}computeDomain(t){return this.computeLinearDomain(t)}axisHelper(){let t=super.axisHelper();return t.setExtendDomain=this.setExtendDomain.bind(this),t}}BE.type=lx.polarLinearAxis,BE.specKey="axes",CS(BE,OS);let BO=()=>{Oc(),de.registerComponent(BE.type,BE)};class BP extends BS{constructor(){super(...arguments),this.type=cZ.rose,this.transformerConstructor=Bk,this._roseMark=null,this._labelMark=null}initMark(){this.initRoseMark()}initMarkStyle(){this.initRoseMarkStyle()}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getCenter=()=>({x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y}),this._markAttributeContext.startAngleScale=t=>this.startAngleScale(t),this._markAttributeContext.endAngleScale=t=>this.endAngleScale(t)}initRoseMark(){var t,e;this._roseMark=this._createMark(BP.mark.rose,{morph:C0(this._spec,BP.mark.rose.name),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,isSeriesMark:!0,customShape:null===(t=this._spec.rose)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.rose)||void 0===e?void 0:e.stateSort})}getRoseAngle(){var t,e,i;return null!==(i=null===(e=(t=this.angleAxisHelper).getBandwidth)||void 0===e?void 0:e.call(t,this._groups?this._groups.fields.length-1:0))&&void 0!==i?i:.5}startAngleScale(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)}endAngleScale(t){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+this.getRoseAngle()-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)}initRoseMarkStyle(){let t=this._roseMark;t&&this.setMarkStyle(t,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:t=>this.startAngleScale(t),endAngle:t=>this.endAngleScale(t),fill:this.getColorAttribute(),outerRadius:t=>Se(this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]]),this.radiusAxisHelper.getScale(0)),innerRadius:t=>{var e;if(!this.getStack())return 0;let i=Se(this.radiusAxisHelper.dataToPosition([t[this._innerRadiusField[0]]]),this.radiusAxisHelper.getScale(0));return i<=Number.MIN_VALUE?this._computeLayoutRadius()*(null!==(e=this._spec.innerRadius)&&void 0!==e?e:0):i}})}initTooltip(){super.initTooltip(),this._roseMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._roseMark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{text:t=>t[this.getDimensionField()[0]],fill:this.getColorAttribute(),z:0})}initAnimation(){var t,e,i;let r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._roseMark&&this._roseMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("rose"))||void 0===i?void 0:i({innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!==(t=this._spec.innerRadius)&&void 0!==t?t:0)}},r),Cq("rose",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._roseMark]}}BP.type=cZ.rose,BP.mark=hH,BP.transformerConstructor=Bk;let BR=()=>{de.registerSeries(BP.type,BP),Bt(),Bx(),BT(),BO()};class BB extends Bs{needAxes(){return!0}_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{categoryField:t.categoryField||t.angleField,valueField:t.valueField||t.radiusField})}transformSpec(t){var e;if(super.transformSpec(t),this.needAxes()){t.axes||(t.axes=[]);let i={radius:!1,angle:!1};(null!==(e=t.axes)&&void 0!==e?e:[]).forEach(t=>{let{orient:e}=t;"radius"===e&&(i.radius=!0),"angle"===e&&(i.angle=!0)}),i.angle||t.axes.push({orient:"angle"}),i.radius||t.axes.push({orient:"radius"})}}}class BI extends BB{_getDefaultSeriesSpec(t){var e,i,r;return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{radius:null!==(e=t.radius)&&void 0!==e?e:.6,outerRadius:null!==(i=t.outerRadius)&&void 0!==i?i:.6,innerRadius:null!==(r=t.innerRadius)&&void 0!==r?r:0,seriesField:t.seriesField,stack:t.stack,percent:t.percent})}transformSpec(t){var e;super.transformSpec(t),(null!==(e=t.axes)&&void 0!==e?e:[]).forEach(t=>{["domainLine","grid","label","tick"].forEach(e=>{t[e]||(t[e]={visible:!1})}),"angle"===t.orient&&ej(t.bandPosition)&&(t.bandPosition=.5)}),t.crosshair=om(t.crosshair||{}).map(t=>us({categoryField:{visible:!0,line:{visible:!0,type:"rect"}}},t))}}class BL extends OD{constructor(){super(...arguments),this.transformerConstructor=BI,this.type="rose",this.seriesType=cZ.rose,this._canStack=!0}}BL.type="rose",BL.seriesType=cZ.rose,BL.transformerConstructor=BI;class BD extends nT{constructor(t,e,i,r,n){super(t,e,i,r,n);let s=this.params.pointToCoord,a=this.params.coordToPoint;nx(s)&&nx(a)||(this.valid=!1),this._pointToCoord=s,this._coordToPoint=a}getEndProps(){return!1===this.valid?{}:this._coordToPoint({angle:this._toAngle,radius:this._toRadius})}onBind(){let{angle:t,radius:e}=this._pointToCoord(this.from),{angle:i,radius:r}=this._pointToCoord(this.to);l1(i*r)||(this.valid=!1),this._fromAngle=l1(t)?t:i,this._fromRadius=l1(e)?e:r,this._toAngle=i,this._toRadius=r,dg(this._fromAngle,this._toAngle)&&dg(this._fromRadius,this._toRadius)&&(this.valid=!1)}onUpdate(t,e,i){if(!1===this.valid)return i.x=this.to.x,void(i.y=this.to.y);if(t){let{x:t,y:e}=this.getEndProps();i.x=t,i.y=e}else{let{x:t,y:r}=this._coordToPoint({angle:this._fromAngle+(this._toAngle-this._fromAngle)*e,radius:this._fromRadius+(this._toRadius-this._fromRadius)*e});i.x=t,i.y=r}}}class BF extends mG{constructor(t,e,i,r,n){super(t,e,i,r,n);let s=this.params.pointToCoord,a=this.params.coordToPoint;this._pointToCoord=s,this._coordToPoint=a}onUpdate(t,e,i){this.points=this.points.map((t,i)=>{let r=this.polarPointInterpolation(this.interpolatePoints[i][0],this.interpolatePoints[i][1],e);return r.context=t.context,r}),i.points=this.points}polarPointInterpolation(t,e,i){let r=this._pointToCoord(t),n=this._pointToCoord({x:t.x1,y:t.y1}),s=iT(r.angle),a=iT(n.angle),o=this._pointToCoord(e),l=this._pointToCoord({x:e.x1,y:e.y1}),h=iT(o.angle),u=iT(l.angle);!l1(s)&&l1(h)&&(s=h),l1(s)&&!l1(h)&&(h=s),!l1(a)&&l1(u)&&(a=u),l1(a)&&!l1(u)&&(u=a);let d=s+(h-s)*i,c=r.radius+(o.radius-r.radius)*i,p=a+(u-a)*i,g=n.radius+(l.radius-n.radius)*i,{x:f,y:m}=this._coordToPoint({angle:d,radius:c}),{x:v,y:y}=this._coordToPoint({angle:p,radius:g}),_=new iW(f,m,v,y);return _.defined=e.defined,_}}let Bj=t=>({type:"in"===t?"fadeIn":"fadeOut"}),BN=(t,e)=>({type:"in"===e?"growPointsIn":"growPointsOut",options:()=>({center:t.center()})});function Bz(t,e,i){return"fadeIn"===e?Bj(i):BN(t,i)}let BH=(t,e)=>{let i=()=>{var e;return null===(e=t.center())||void 0===e?void 0:e.x},r=(t,e)=>e.getGraphicAttribute("x"),n=()=>{var e;return null===(e=t.center())||void 0===e?void 0:e.y},s=(t,e)=>e.getGraphicAttribute("y");return"in"===e?{channel:{x:{from:i,to:r},y:{from:n,to:s}}}:{channel:{x:{from:r,to:i},y:{from:s,to:n}}}};function BV(t,e,i){return"fadeIn"===e?Bj(i):BH(t,i)}let BW=(t,e)=>({custom:m$,customParameters:(i,r)=>{var n;return{group:r.getGraphicItem(),startAngle:null!==(n=t.startAngle)&&void 0!==n?n:Math.PI/2,orient:"clockwise",center:t.center(),radius:t.radius(),animationType:e}}}),BG=()=>{de.registerAnimation("radar",(t,e)=>({appear:"clipIn"===e?void 0:Bz(t,e,"in"),enter:Bz(t,e,"in"),exit:Bz(t,e,"out"),disappear:"clipIn"===e?void 0:Bz(t,e,"out"),update:[{options:{excludeChannels:["points","defined"]}},{channel:["points"],custom:BF,customParameters:t,duration:w4.update.duration,easing:w4.update.easing}]})),de.registerAnimation("radarSymbol",(t,e)=>({appear:"clipIn"===e?void 0:BV(t,e,"in"),enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:"clipIn"===e?void 0:BV(t,e,"out"),update:[{options:{excludeChannels:["x","y"]}},{channel:["x","y"],custom:BD,customParameters:t,duration:w4.update.duration,easing:w4.update.easing}]})),de.registerAnimation("radarGroup",(t,e)=>({appear:BW(t,"in"),disappear:BW(t,"out")})),SB()};class BU extends BS{constructor(){super(...arguments),this.type=cZ.radar,this.transformerConstructor=To,this._sortDataByAxis=!1}initGroups(){}compile(){super.compile(),this.addOverlapCompile()}initMark(){var t,e,i,r;let n={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},s=!1!==(null===(t=this._spec.area)||void 0===t?void 0:t.visible)&&!1!==(null===(i=null===(e=this._spec.area)||void 0===e?void 0:e.style)||void 0===i?void 0:i.visible),a=null!==(r=this._spec.seriesMark)&&void 0!==r?r:"area";this.initAreaMark(n,s&&"area"===a),this.initLineMark(n,"line"===a||"area"===a&&!s),this.initSymbolMark(n,"point"===a)}initMarkStyle(){this.initAreaMarkStyle(),this.initLineMarkStyle(),this.initSymbolMarkStyle()}initAreaMark(t,e){var i,r;this._areaMark=this._createMark(BU.mark.area,{progressive:t,isSeriesMark:e,customShape:null===(i=this._spec.area)||void 0===i?void 0:i.customShape,stateSort:null===(r=this._spec.area)||void 0===r?void 0:r.stateSort})}initAreaMarkStyle(){let t=this._areaMark;t&&(this.setMarkStyle(t,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),x1:t=>t&&this.angleAxisHelper&&this.radiusAxisHelper?this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getStack()?this.getDatumPositionValues(t,this._innerRadiusField):this.radiusScale.domain()[0]).x:Number.NaN,y1:t=>t&&this.angleAxisHelper&&this.radiusAxisHelper?this.valueToPosition(this.getDatumPositionValues(t,this._angleField),this.getStack()?this.getDatumPositionValues(t,this._innerRadiusField):this.radiusScale.domain()[0]).y:Number.NaN,fill:this.getColorAttribute(),curveType:C7,closePath:!0},"normal",tw.Series),"zero"!==this._invalidType&&this.setMarkStyle(t,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",tw.Series),this.event.on(c1.viewDataStatisticsUpdate,{filter:t=>t.model===this},()=>{this.encodeDefined(t,"defined")}))}initTooltip(){super.initTooltip();let{dimension:t,group:e,mark:i}=this._tooltipHelper.activeTriggerSet;this._lineMark&&(t.add(this._lineMark),e.add(this._lineMark)),this._areaMark&&(t.add(this._areaMark),e.add(this._areaMark)),this._symbolMark&&(i.add(this._symbolMark),e.add(this._symbolMark))}initAnimation(){var t,e,i,r;let n={center:()=>{var t;return null===(t=this.angleAxisHelper)||void 0===t?void 0:t.center()},radius:()=>{let t=this.getLayoutRect();return Math.min(t.width,t.height)},startAngle:eO(this._spec.startAngle)?ik(this._spec.startAngle):ub,pointToCoord:t=>{var e;return null===(e=this.angleAxisHelper)||void 0===e?void 0:e.pointToCoord(t)},coordToPoint:t=>this.angleAxisHelper.coordToPoint(t)},s=null!==(i=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset)&&void 0!==i?i:"clipIn";"clipIn"===s&&this._rootMark&&this._rootMark.setAnimationConfig(CX(null===(r=de.getAnimationInKey("radarGroup"))||void 0===r?void 0:r(n,s),Cq("group",this._spec,this._markAttributeContext))),[[this._areaMark,"radar"],[this._lineMark,"radar"],[this._symbolMark,"radarSymbol"]].forEach(([t,e])=>{if(eO(t)){let i=de.getAnimationInKey(e);t.setAnimationConfig(CX(null==i?void 0:i(n,s),Cq(t.name,this._spec,this._markAttributeContext)))}})}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._areaMark,this._symbolMark,this._lineMark]}getSeriesStyle(t){return e=>{var i,r,n,s;let a=null!==(r=null===(i=this._seriesMark)||void 0===i?void 0:i.getAttribute(e,t))&&void 0!==r?r:void 0;return"fill"!==e||a||(e="stroke",a=null!==(s=null===(n=this._seriesMark)||void 0===n?void 0:n.getAttribute(e,t))&&void 0!==s?s:void 0),"stroke"===e&&eM(a)?a[0]:a}}}BU.type=cZ.radar,BU.mark=hj,BU.transformerConstructor=To,CS(BU,Tt);let B$=()=>{de.registerSeries(BU.type,BU),Mx(),ON(),Tr(),Ta(),BG(),BT(),BO()};class BY extends BB{_getDefaultSeriesSpec(t){var e;return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{seriesField:t.seriesField,line:t.line,point:t.point,stack:t.stack,percent:t.percent,area:us({visible:!1},t.area),seriesMark:null!==(e=t.seriesMark)&&void 0!==e?e:"area",activePoint:t.activePoint,pointDis:t.pointDis,pointDisMul:t.pointDisMul,markOverlap:t.markOverlap})}transformSpec(t){var e;super.transformSpec(t),(null!==(e=t.axes)&&void 0!==e?e:[]).forEach(t=>{"radius"===t.orient&&(["domainLine","label","tick"].forEach(e=>{t[e]||(t[e]={visible:!1})}),t.grid||(t.grid={visible:!0}))}),t.crosshair=om(t.crosshair||{}).map(t=>us({categoryField:{visible:!0,line:{visible:!0,type:"line"}}},t))}}class BK extends OD{constructor(){super(...arguments),this.transformerConstructor=BY,this.type="radar",this.seriesType=cZ.radar,this._canStack=!0}}BK.type="radar",BK.seriesType=cZ.radar,BK.transformerConstructor=BY;class BZ extends OE{_getDefaultSeriesSpec(t){let e=super._getDefaultSeriesSpec(t);return delete e.data,e}_transformAxisSpec(t){t.axes&&t.autoBandSize&&t.series.forEach((e,i)=>{var r;if("bar"===e.type){let n=this._findBandAxisBySeries(e,i,t.axes);if(n&&!n.bandSize&&!n.maxBandSize&&!n.minBandSize){let t=nb(e.autoBandSize)&&null!==(r=e.autoBandSize.extend)&&void 0!==r?r:0,{barMaxWidth:i,barMinWidth:s,barWidth:a,barGapInGroup:o}=e;this._applyAxisBandSize(n,t,{barMaxWidth:i,barMinWidth:s,barWidth:a,barGapInGroup:o})}}})}transformSpec(t){if(super.transformSpec(t),t.series&&t.series.length){let e=this._getDefaultSeriesSpec(t);t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})})}t.axes&&t.axes.length&&t.axes.forEach(e=>{dq(e,"trimPadding")&&us(e,bv(this.type,t))}),this._transformAxisSpec(t)}}class BX extends OD{constructor(){super(...arguments),this.transformerConstructor=BZ,this.type="common",this._canStack=!0}}BX.type="common",BX.transformerConstructor=BZ;class Bq{static getInstance(){return Bq.instance||(Bq.instance=new Bq),Bq.instance}constructor(){this.locale_shortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.locale_periods=["AM","PM"],this.locale_weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.locale_shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.numberRe=/^\s*\d+/,this.pads={"-":"",_:" ",0:"0"},this.requoteRe=/[\\^$*+?|[\]().{}]/g,this.locale_months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.formatShortWeekday=t=>this.locale_shortWeekdays[t.getDay()],this.formatWeekday=t=>this.locale_weekdays[t.getDay()],this.formatShortMonth=t=>this.locale_shortMonths[t.getMonth()],this.formatMonth=t=>this.locale_months[t.getMonth()],this.formatDayOfMonth=(t,e)=>this.pad(t.getDate(),e,2),this.formatHour24=(t,e)=>this.pad(t.getHours(),e,2),this.formatHour12=(t,e)=>this.pad(t.getHours()%12||12,e,2),this.formatMilliseconds=(t,e)=>this.pad(t.getMilliseconds(),e,3),this.formatMonthNumber=(t,e)=>this.pad(t.getMonth()+1,e,2),this.formatMinutes=(t,e)=>this.pad(t.getMinutes(),e,2),this.formatPeriod=t=>this.locale_periods[+(t.getHours()>=12)],this.formatSeconds=(t,e)=>this.pad(t.getSeconds(),e,2),this.formatFullYear=(t,e)=>this.pad(t.getFullYear()%1e4,e,4),this.formatUTCShortWeekday=t=>this.locale_shortWeekdays[t.getUTCDay()],this.formatUTCWeekday=t=>this.locale_weekdays[t.getUTCDay()],this.formatUTCShortMonth=t=>this.locale_shortMonths[t.getUTCMonth()],this.formatUTCMonth=t=>this.locale_months[t.getUTCMonth()],this.formatUTCDayOfMonth=(t,e)=>this.pad(t.getUTCDate(),e,2),this.formatUTCHour24=(t,e)=>this.pad(t.getUTCHours(),e,2),this.formatUTCHour12=(t,e)=>this.pad(t.getUTCHours()%12||12,e,2),this.formatUTCMilliseconds=(t,e)=>this.pad(t.getUTCMilliseconds(),e,3),this.formatUTCMonthNumber=(t,e)=>this.pad(t.getUTCMonth()+1,e,2),this.formatUTCMinutes=(t,e)=>this.pad(t.getUTCMinutes(),e,2),this.formatUTCPeriod=t=>this.locale_periods[+(t.getUTCHours()>=12)],this.formatUTCSeconds=(t,e)=>this.pad(t.getUTCSeconds(),e,2),this.formatUTCFullYear=(t,e)=>this.pad(t.getUTCFullYear()%1e4,e,4),this.formats={a:this.formatShortWeekday,A:this.formatWeekday,b:this.formatShortMonth,B:this.formatMonth,d:this.formatDayOfMonth,e:this.formatDayOfMonth,H:this.formatHour24,I:this.formatHour12,L:this.formatMilliseconds,m:this.formatMonthNumber,M:this.formatMinutes,p:this.formatPeriod,S:this.formatSeconds,Y:this.formatFullYear},this.utcFormats={a:this.formatUTCShortWeekday,A:this.formatUTCWeekday,b:this.formatUTCShortMonth,B:this.formatUTCMonth,d:this.formatUTCDayOfMonth,e:this.formatUTCDayOfMonth,H:this.formatUTCHour24,I:this.formatUTCHour12,L:this.formatUTCMilliseconds,m:this.formatUTCMonthNumber,M:this.formatUTCMinutes,p:this.formatUTCPeriod,S:this.formatUTCSeconds,Y:this.formatUTCFullYear},this.parseShortWeekday=(t,e,i)=>{let r=this.shortWeekdayRe.exec(e.slice(i));return r?(t.w=this.shortWeekdayLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseWeekday=(t,e,i)=>{let r=this.weekdayRe.exec(e.slice(i));return r?(t.w=this.weekdayLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseShortMonth=(t,e,i)=>{let r=this.shortMonthRe.exec(e.slice(i));return r?(t.m=this.shortMonthLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseMonth=(t,e,i)=>{let r=this.monthRe.exec(e.slice(i));return r?(t.m=this.monthLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseDayOfMonth=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.d=+r[0],i+r[0].length):-1},this.parseHour24=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.H=+r[0],i+r[0].length):-1},this.parseMilliseconds=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+3));return r?(t.L=+r[0],i+r[0].length):-1},this.parseMonthNumber=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.m=r-1,i+r[0].length):-1},this.parseMinutes=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.M=+r[0],i+r[0].length):-1},this.parsePeriod=(t,e,i)=>{let r=this.periodRe.exec(e.slice(i));return r?(t.p=this.periodLookup.get(r[0].toLowerCase()),i+r[0].length):-1},this.parseSeconds=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+2));return r?(t.S=+r[0],i+r[0].length):-1},this.parseFullYear=(t,e,i)=>{let r=this.numberRe.exec(e.slice(i,i+4));return r?(t.y=+r[0],i+r[0].length):-1},this.parses={a:this.parseShortWeekday,A:this.parseWeekday,b:this.parseShortMonth,B:this.parseMonth,d:this.parseDayOfMonth,e:this.parseDayOfMonth,H:this.parseHour24,I:this.parseHour24,L:this.parseMilliseconds,m:this.parseMonthNumber,M:this.parseMinutes,p:this.parsePeriod,S:this.parseSeconds,Y:this.parseFullYear},this.timeFormat=(t,e)=>this.newFormat(t,this.formats)(new Date(this.getFullTimeStamp(e))),this.timeUTCFormat=(t,e)=>this.newFormat(t,this.utcFormats)(new Date(this.getFullTimeStamp(e))),this.timeParse=(t,e)=>this.newParse(t,!1)(e+""),this.requoteF=this.requote.bind(this),this.periodRe=this.formatRe(this.locale_periods),this.periodLookup=this.formatLookup(this.locale_periods),this.weekdayRe=this.formatRe(this.locale_weekdays),this.weekdayLookup=this.formatLookup(this.locale_weekdays),this.shortWeekdayRe=this.formatRe(this.locale_shortWeekdays),this.shortWeekdayLookup=this.formatLookup(this.locale_shortWeekdays),this.monthRe=this.formatRe(this.locale_months),this.monthLookup=this.formatLookup(this.locale_months),this.shortMonthRe=this.formatRe(this.locale_shortMonths),this.shortMonthLookup=this.formatLookup(this.locale_shortMonths)}requote(t){return t.replace(this.requoteRe,"\\$&")}localDate(t){if(0<=t.y&&t.y<100){let e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}utcDate(t){if(0<=t.y&&t.y<100){let e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}newDate(t,e,i){return{y:t,m:e,d:i,H:0,M:0,S:0,L:0}}formatRe(t){return RegExp("^(?:"+t.map(this.requoteF).join("|")+")","i")}formatLookup(t){return new Map(t.map((t,e)=>[t.toLowerCase(),e]))}pad(t,e,i){let r=t<0?"-":"",n=(r?-t:t)+"",s=n.length;return r+(s<i?Array(i-s+1).join(e)+n:n)}parseSpecifier(t,e,i,r){let n,s,a=0,o=e.length,l=i.length;for(;a<o;){if(r>=l)return -1;if(37===(n=e.charCodeAt(a++))){if(n=e.charAt(a++),!(s=this.parses[n in this.pads?e.charAt(a++):n])||(r=s(t,i,r))<0)return -1}else if(n!==i.charCodeAt(r++))return -1}return r}newParse(t,e){let i=this;return function(r){let n=i.newDate(1900,void 0,1);return i.parseSpecifier(n,t,r+="",0)!==r.length?null:"Q"in n?new Date(n.Q):"s"in n?new Date(1e3*n.s+("L"in n?n.L:0)):(!e||"Z"in n||(n.Z=0),"p"in n&&(n.H=n.H%12+12*n.p),void 0===n.m&&(n.m="q"in n?n.q:0),"Z"in n?(n.H+=n.Z/100|0,n.M+=n.Z%100,i.utcDate(n)):i.localDate(n))}}newFormat(t,e){let i=this;return function(r){let n,s;let a=[],o=-1,l=0,h=t.length;for(r instanceof Date||(r=new Date(+r));++o<h;)37===t.charCodeAt(o)&&(a.push(t.slice(l,o)),(s=i.pads[n=t.charAt(++o)])?n=t.charAt(++o):s="e"===n?" ":"0",a.push(n=(0,e[n])(r,s)),l=o+1);return a.push(t.slice(l,o)),a.join("")}}getFullTimeStamp(t){let e=parseInt(t+"",10);return 10===String(e).length?1e3*e:e}}class BJ extends CB{getDefaultTooltipPattern(t){return"mark"===t?{visible:!0,activeType:t,title:{key:"link info",value:"link info"},content:[{hasShape:!0,shapeType:"square",shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,key:"time",value:t=>Bq.getInstance().timeFormat("%Y%m%d %H:%M",t.from.split("_")[1])},{hasShape:!0,shapeType:"square",shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,key:"type",value:t=>t.action_type},{hasShape:!0,shapeType:"square",shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,key:"from",value:t=>t.from},{hasShape:!0,shapeType:"square",shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,key:"to",value:t=>t.to}]}:null}}class BQ extends Sd{constructor(){super(...arguments),this.type=BQ.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x1:0,y1:0})}}BQ.type="rule";let B0=()=>{de.registerMark(BQ.type,BQ),AU()},B1=(t,e)=>{let{infoKey:i,fields:r,linkData:n,dotData:s}=e,{fromField:a,toField:o,xField:l,yField:h}=r(),u=n(),d=s(),c={};return d.forEach(t=>{let e={};for(let r in t)r!==i&&(e[r]=t[r]);let r=t[i];null==r||r.forEach(t=>{c[t.node_name]=Object.assign({},e,t)})}),u.forEach(t=>{var e,i,r,n;t[a+"_xField"]=null===(e=null==c?void 0:c[t[a]])||void 0===e?void 0:e[l],t[a+"_yField"]=null===(i=null==c?void 0:c[t[a]])||void 0===i?void 0:i[h],t[o+"_xField"]=null===(r=null==c?void 0:c[t[o]])||void 0===r?void 0:r[l],t[o+"_yField"]=null===(n=null==c?void 0:c[t[o]])||void 0===n?void 0:n[h]}),u};class B2 extends C6{constructor(){super(...arguments),this.type=cZ.link}getFromField(){return this._fromField}setFromField(t){eO(t)&&(this._fromField=t)}getToField(){return this._toField}setToField(t){eO(t)&&(this._toField=t)}getDotTypeField(){return this._dotTypeField}setDotTypeField(t){eO(t)&&(this._dotTypeField=t)}getDotSeriesSpec(){return this._dotSeriesSpec}setDotSeriesSpec(t){eO(t)&&(this._dotSeriesSpec=t)}_getDotData(){let t=this._option.getChart().getSeriesInIndex([this._spec.dotSeriesIndex])[0];return t?t.getRawData().latestData:[]}initData(){var t;super.initData(),gw(this._option.dataSet,"linkDotInfo",B1),null===(t=this.getViewData())||void 0===t||t.transform({type:"linkDotInfo",options:{infoKey:"dots",fields:()=>({fromField:this._fromField,toField:this._toField,xField:this._dotSeriesSpec.xField,yField:this._dotSeriesSpec.yField}),linkData:()=>this._rawData.latestData,dotData:()=>this._getDotData()},level:ty.linkDotInfo},!1)}setAttrFromSpec(){super.setAttrFromSpec(),this.setFromField(this._spec.fromField),this.setToField(this._spec.toField),this.setDotTypeField(this._spec.dotTypeField),this.setDotSeriesSpec(this._spec.dotSeriesSpec)}initMark(){this._clipMark=this._createMark(B2.mark.group),this._containerMark=this._createMark(B2.mark.group,{parent:this._clipMark}),this._linkMark=this._createMark(B2.mark.link,{skipBeforeLayouted:!1,parent:this._containerMark}),this._arrowMark=this._createMark(B2.mark.arrow,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark})}initMarkStyle(){var t,e,i,r;let n=this._clipMark;n&&(this.setMarkStyle(n,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight,clip:!0},"normal",tw.Series),n.setInteractive(!1));let s=this._containerMark;s&&(this.setMarkStyle(s,{x:this._spec.leftAppendPadding,width:this.getLayoutRect().width},"normal",tw.Series),s.setInteractive(!1));let a=this._linkMark;a&&this.setMarkStyle(a,{stroke:this.getColorAttribute(),strokeOpacity:this.dataToOpacity.bind(this),x:this.dataToPositionXFrom.bind(this),y:this.dataToPositionYFrom.bind(this),x1:this.dataToPositionXTo.bind(this),y1:this.dataToPositionYTo.bind(this)},"normal",tw.Series);let o=this._arrowMark;if(o){let n=null!==(r=null===(i=null===(e=null===(t=this._theme)||void 0===t?void 0:t.arrow)||void 0===e?void 0:e.style)||void 0===i?void 0:i.size)&&void 0!==r?r:10;this.setMarkStyle(o,{x:this.dataToPositionXTo.bind(this),y:t=>this.dataToPositionArrowYTo(t,n),fill:this.getColorAttribute(),fillOpacity:this.dataToOpacity.bind(this),size:n,symbolType:t=>this.isPositionYFromHigher(t)?"triangleDown":"triangleUp"},"normal",tw.Series)}}afterInitMark(){super.afterInitMark()}dataToPositionXFrom(t){if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._fromField+"_xField"),{bandPosition:this._bandPosition})}dataToPositionYFrom(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fromField+"_yField"))}dataToPositionXTo(t){if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._toField+"_xField"),{bandPosition:this._bandPosition})}dataToPositionYTo(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})}dataToPositionArrowYTo(t,e){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:i}=this._yAxisHelper,r=this.isPositionYFromHigher(t)?-e/2:e/2;return i(this.getDatumPositionValues(t,this._toField+"_yField"),{bandPosition:this._bandPosition})+r}dataToOpacity(t){return this.isPositionXOuterRange(t,this._fromField+"_xField")||this.isPositionXOuterRange(t,this._toField+"_xField")||t[this._fromField]===t[this._toField]?0:1}isPositionYFromHigher(t){return this.dataToPositionYFrom(t)<this.dataToPositionYTo(t)}isPositionXOuterRange(t,e){if(!this._xAxisHelper)return!1;let{dataToPosition:i,getScale:r}=this._xAxisHelper;return i(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})<r(0).range()[0]||i(this.getDatumPositionValues(t,e),{bandPosition:this._bandPosition})>r(0).range()[1]}getDefaultColorDomain(){var t,e;return this._dotTypeField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._dotTypeField].values:this._seriesField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesField].values:[]}getColorAttribute(){var t,e,i;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(i=null!==(e=this._dotTypeField)&&void 0!==e?e:this._seriesField)&&void 0!==i?i:bM}}initInteraction(){let t=[];this._linkMark&&t.push(this._linkMark),this._arrowMark&&t.push(this._arrowMark),this._parseInteractionConfig(t)}initTooltip(){this._tooltipHelper=new BJ(this),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._arrowMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._arrowMark)}onMarkTreePositionUpdate(t){t.forEach(t=>{"group"===t.type?this.onMarkTreePositionUpdate(t.getMarks()):t.updateLayoutState()})}getDotInfoData(){var t,e;return null===(e=null!==(t=this._linkMark)&&void 0!==t?t:this._arrowMark)||void 0===e?void 0:e.getData()}getActiveMarks(){return[this._linkMark,this._arrowMark]}}B2.type=cZ.link,B2.mark=hU;let B3=()=>{B0(),Ta(),Oy(),OA(),de.registerSeries(B2.type,B2)};class B5 extends CB{updateTooltipSpec(){var t;super.updateTooltipSpec(),eO(null===(t=this.spec)||void 0===t?void 0:t.mark)&&(this.spec.mark.updateContent=(t,e,i)=>{let r=[],n=t.filter(t=>"children"===t.key);return n.length>0&&n[0].value.forEach(t=>{let i=!0;for(let n in t)r.push({shapeType:"circle",hasShape:i,shapeColor:this.shapeColorCallback(e[0].datum[0]),shapeStroke:this.shapeStrokeCallback(e[0].datum[0]),key:n,value:t[n]+""}),i=!1}),t.concat(r)})}getDefaultTooltipPattern(t){return"mark"===t?{visible:!0,activeType:t,title:{key:"event info",value:"event info"},content:[{hasShape:!0,shapeType:"square",shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,key:t=>t.type,value:t=>t.id},{hasShape:!0,shapeType:"square",shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,key:"event_time",value:t=>Bq.getInstance().timeFormat("%Y%m%d",t.event_time)},{hasShape:!0,shapeType:"square",shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,key:"action_type",value:t=>t.action_type},{shapeType:"square",hasShape:!0,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,key:"children",value:t=>t.children}],updateContent:(t,e,i)=>{let r=[];return t[3].value.forEach(t=>{let i=!0;for(let n in t)r.push({shapeType:"circle",hasShape:i,shapeColor:this.shapeColorCallback(e[0].datum[0]),shapeStroke:this.shapeStrokeCallback(e[0].datum[0]),key:n,value:t[n]+""}),i=!1}),t.concat(r)}}:null}}let B4=(t,e)=>{var i;let r=(null===(i=t[0])||void 0===i?void 0:i.latestData)?t[0].latestData:t||[],n=[];return r.forEach(t=>{let i={};for(let r in t)r!==e&&(i[r]=t[r]);let r=t[e];null==r||r.forEach(t=>{n.push(Object.assign({},i,t))})}),n},B8={fill:"#bbb",fillOpacity:.2};class B6 extends Sd{getTextType(){return this._textType}constructor(t,e){super(t,e),this.type=B6.type,this._textType="text"}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{angle:0,textAlign:"center",lineWidth:0,textConfig:[]})}initStyleWithSpec(t,e){super.initStyleWithSpec(t,e),t.textType&&(this._textType=t.textType)}compileEncode(){super.compileEncode(),"rich"===this._textType&&this._product.encodeState("group",{textType:this._textType})}}B6.type="text";let B9=()=>{de.registerMark(B6.type,B6),AY(),AZ()};class B7 extends C6{constructor(){super(...arguments),this.type=cZ.dot}getSeriesGroupField(){return this._seriesField}setSeriesGroupField(t){eO(t)&&(this._seriesGroupField=t)}getTitleField(){return this._titleField}setTitleField(t){eO(t)&&(this._titleField=t)}getSubTitleField(){return this._subTitleField}setSubTitleField(t){eO(t)&&(this._subTitleField=t)}getDotTypeField(){return this._dotTypeField}setDotTypeField(t){eO(t)&&(this._dotTypeField=t)}getHighLightSeriesGroup(){return this._highLightSeriesGroup}setHighLightSeriesGroup(t){eO(t)&&(this._highLightSeriesGroup=t)}setGridBackground(t){eO(t)&&(this._gridBackground=t)}initData(){var t;super.initData(),this._xDimensionStatisticsDomain=this.getRawData().latestData.map(t=>t[this._fieldY[0]]),gw(this._option.dataSet,"objFlat",B4),gw(this._option.dataSet,"copyDataView",gP),gM(this._option.dataSet,"dataview",eC),null===(t=this.getViewData())||void 0===t||t.transform({type:"objFlat",options:"dots",level:ty.dotObjFlat},!1)}setSeriesField(t){eO(t)&&(this._seriesField=t,this.getMarksInType(["line","area"]).forEach(t=>{t.setFacet(this._seriesField)}))}getStatisticFields(){return[{key:this._fieldY[0],operations:["values"],customize:this._xDimensionStatisticsDomain}]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setSeriesGroupField(this._spec.seriesGroupField),this.setTitleField(this._spec.titleField),this.setSubTitleField(this._spec.subTitleField),this.setDotTypeField(this._spec.dotTypeField),this.setHighLightSeriesGroup(this._spec.highLightSeriesGroup),this.setGridBackground(us(B8,(null===(t=this._spec.grid)||void 0===t?void 0:t.background)||{}))}initMark(){this._clipMark=this._createMark(B7.mark.group),this._containerMark=this._createMark(B7.mark.group,{parent:this._clipMark,dataView:this.getRawData()}),this._gridBackgroundMark=this._createMark(B7.mark.gridBackground,{parent:this._containerMark,dataView:this.getRawData()}),this._gridMark=this._createMark(B7.mark.grid,{parent:this._containerMark,dataView:this.getRawData()}),this._dotMark=this._createMark(B7.mark.dot,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark}),this._titleMark=this._createMark(B7.mark.title,{parent:this._containerMark,dataView:this.getRawData()}),this._subTitleMark=this._createMark(B7.mark.subTitle,{parent:this._containerMark,dataView:this.getRawData()}),this._symbolMark=this._createMark(B7.mark.symbol,{parent:this._containerMark,dataView:this.getRawData()})}initMarkStyle(){let t=this._clipMark;t&&(this.setMarkStyle(t,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight,clip:!0},"normal",tw.Series),t.setInteractive(!1));let e=this._containerMark;e&&(this.setMarkStyle(e,{x:this._spec.leftAppendPadding},"normal",tw.Series),e.setInteractive(!1));let i=this._gridBackgroundMark;i&&this.setMarkStyle(i,{x:this.getRegionRectLeft.bind(this),x1:this.getRegionRectRight.bind(this),y:this.dataToGridBackgroundPositionY.bind(this),y1:this.dataToGridBackgroundPositionY1.bind(this),fill:this._gridBackground.fill,fillOpacity:this.dataToGridBackgroundOpacity.bind(this)},"normal",tw.Series);let r=this._gridMark;r&&this.setMarkStyle(r,{stroke:this.getColorAttribute(),x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),x1:this.getRegionRectRight.bind(this),y1:this.dataToPositionY.bind(this)},"normal",tw.Series);let n=this._dotMark;n&&this.setMarkStyle(n,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),fill:this.getDotColorAttribute(),fillOpacity:this.dataToOpacity.bind(this)},"normal",tw.Series);let s=this._titleMark;s&&this.setMarkStyle(s,{fill:this.getColorAttribute(),text:t=>t[this.getTitleField()],x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",tw.Series);let a=this._subTitleMark;a&&this.setMarkStyle(a,{fill:this.getColorAttribute(),text:t=>t[this.getSubTitleField()],x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",tw.Series);let o=this._symbolMark;o&&this.setMarkStyle(o,{x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),fill:this.getColorAttribute()},"normal",tw.Series)}dataToGridBackgroundPositionY(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e,getBandwidth:i}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})-i(0)/2}dataToGridBackgroundPositionY1(t){if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e,getBandwidth:i}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._fieldY),{bandPosition:this._bandPosition})+i(0)/2}dataToOpacity(t){var e,i,r,n;if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:s,getScale:a}=this._xAxisHelper;return s(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})<a(0).range()[0]||s(this.getDatumPositionValues(t,this._fieldX),{bandPosition:this._bandPosition})>a(0).range()[1]?0:null!==(n=null===(r=null===(i=null===(e=this._theme)||void 0===e?void 0:e.dot)||void 0===i?void 0:i.style)||void 0===r?void 0:r.fillOpacity)&&void 0!==n?n:1}dataToGridBackgroundOpacity(t){return t[this._seriesGroupField]===this._highLightSeriesGroup?this._gridBackground.fillOpacity:0}onLayoutEnd(t){var e,i;super.onLayoutEnd(t);let r=null!==(i=null===(e=this._spec)||void 0===e?void 0:e.leftAppendPadding)&&void 0!==i?i:0;this.setMarkStyle(this._clipMark,{width:this.getLayoutRect().width+r},"normal",tw.Series)}getDefaultColorDomain(){var t,e;return this._seriesGroupField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._seriesGroupField].values:this._seriesField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesField].values:[]}getColorAttribute(){var t,e,i;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:null!==(i=null!==(e=this._seriesGroupField)&&void 0!==e?e:this._seriesField)&&void 0!==i?i:bM}}getDotColorScale(){var t,e,i;let r=this._dotTypeField?null===(t=this.getViewDataStatistics())||void 0===t?void 0:t.latestData[this._dotTypeField].values:this._seriesGroupField?null===(e=this.getViewDataStatistics())||void 0===e?void 0:e.latestData[this._seriesGroupField].values:this._seriesField?null===(i=this.getViewDataStatistics())||void 0===i?void 0:i.latestData[this._seriesField].values:[],n=this._getDataScheme();return(new x9).domain(r).range(n)}getDotColorAttribute(){var t,e,i,r;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this.getDotColorScale(),field:null!==(r=null!==(i=null!==(e=this._dotTypeField)&&void 0!==e?e:this._seriesGroupField)&&void 0!==i?i:this._seriesField)&&void 0!==r?r:bM}}initTooltip(){this._tooltipHelper=new B5(this),this._dotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._dotMark)}onEvaluateEnd(t){super.onEvaluateEnd(t)}onMarkTreePositionUpdate(t){t.forEach(t=>{"group"===t.type?this.onMarkTreePositionUpdate(t.getMarks()):t.updateLayoutState()})}getDotData(){var t;return null===(t=this._dotMark)||void 0===t?void 0:t.getData()}_getDataIdKey(){}getStackValueField(){return null}getActiveMarks(){return[this._dotMark]}}B7.type=cZ.dot,B7.mark=h$;let It=()=>{Ta(),B0(),O2(),B9(),de.registerSeries(B7.type,B7)};class Ie extends OE{_getSeriesDataLength(t,e){var i,r;if(e.data){let t=om(e.data)[0];return t instanceof eH?null===(i=t.latestData)||void 0===i?void 0:i.length:null===(r=t.values)||void 0===r?void 0:r.length}let n=om(t.data).find((t,i)=>e.dataId?t instanceof eH?t.name===e.dataId:t.id===e.dataId:e.dataIndex===i);return n?n instanceof eH?n.latestData.length:n.values.length:0}addAttrToComponentSpec(t,e,i){return Array.isArray(t)?t[0][e]=i:t[e]=i,t}transformSpec(t){var e,i,r,n,s,a,o,l,h,u,d;super.transformSpec(t);let c=0,p=[],g=[],f=[],m=[],v=[],y=t.series.filter(t=>t.type!==cZ.link).length,_=(500-20*(y-1))/y,b=(null===(e=null==t?void 0:t.appendPadding)||void 0===e?void 0:e.left)||0,x=(null===(i=null==t?void 0:t.appendPadding)||void 0===i?void 0:i.right)||0;if(null==t?void 0:t.legends){p.push({modelId:`legendRow${c}`,col:1,row:c}),this.addAttrToComponentSpec(t.legends,"id",`legendRow${c}`);let e=om(t.legends),i=null!==(r=e[0].height)&&void 0!==r?r:40;if(e[0].padding){let t=hi(e[0].padding);i+=Number(null!==(n=null==t?void 0:t.bottom)&&void 0!==n?n:0)+Number(null!==(s=null==t?void 0:t.top)&&void 0!==s?s:0),e[0].offsetY=Number(null!==(o=null===(a=e[0])||void 0===a?void 0:a.offsetY)&&void 0!==o?o:0)+Number(null!==(l=null==t?void 0:t.top)&&void 0!==l?l:0)}v.push({index:c,size:i}),c++}(null==t?void 0:t.dataZoom)&&(p.push({modelId:`dataZoomRow${c}`,col:1,row:c}),this.addAttrToComponentSpec(t.dataZoom,"id",`dataZoomRow${c}`),c++,v.push({index:c,size:10}),c++),g.push({id:`regionAxesRow${c}`}),p.push({modelId:`axesRow${c}`,col:1,row:c}),t.axes[0].id=`axesRow${c}`,t.axes[0].regionIndex=Array.from(Array(t.series.length),(t,e)=>e+1),c++,null===(h=null==t?void 0:t.series)||void 0===h||h.forEach(e=>{var i,r;if([cZ.bar,cZ.line,cZ.area,cZ.dot].includes(e.type)){if(p.push({modelId:`${e.type}Row${c}`,col:1,row:c}),p.push({modelId:`axesLeftRow${c}`,col:0,row:c}),g.push({id:`${e.type}Row${c}`,clip:!1}),v.push({index:c,size:(null==e?void 0:e.height)||_}),f.push({orient:"left",id:`axesLeftRow${c}`,type:e.type===cZ.dot?"band":"linear",visible:e.type!==cZ.dot,title:{visible:!0,autoRotate:!1,style:{text:null==e?void 0:e.barTitle,dx:-20,textBaseline:"middle",textAlign:"end"}},grid:{visible:"boolean"!=typeof(null===(i=null==e?void 0:e.grid)||void 0===i?void 0:i.visible)||(null===(r=null==e?void 0:e.grid)||void 0===r?void 0:r.visible),style:(t,i)=>{var r,n,s,a,o;let l=0;if(0===i){let t=null===(r=null==e?void 0:e.grid)||void 0===r?void 0:r.style;l=null!==(s=null!==(n=null==t?void 0:t.lineWidth)&&void 0!==n?n:null==t?void 0:t.strokeWidth)&&void 0!==s?s:1}return{lineWidth:l,stroke:(null===(o=null===(a=null==e?void 0:e.grid)||void 0===a?void 0:a.style)||void 0===o?void 0:o.stroke)||"#dfdfdf",lineDash:[0,0]}}},domainLine:{visible:!1},tick:{visible:!1},label:{visible:!1},regionIndex:g.length-1}),e.type===cZ.dot){p.push({modelId:`scrollBarRightRow${c}`,col:2,row:c});let i=this._getSeriesDataLength(t,e),r=0;i&&(r=((null==e?void 0:e.height)||_)/(30*i)),m.push(Object.assign({orient:"right",visible:e.type===cZ.dot&&r<1,id:`scrollBarRightRow${c}`,start:0,end:Math.min(r,1),filterMode:"axis",regionIndex:g.length-1,axisId:`axesLeftRow${c}`},om(null==t?void 0:t.scrollBar)[0]))}e.regionIndex=g.length-1,c++,v.push({index:c,size:(null==e?void 0:e.padding)||20}),c++,e.leftAppendPadding=b,e.type===cZ.dot&&(e.title.style.dx=-b,e.subTitle.style.dx=-b)}}),null===(u=null==t?void 0:t.series)||void 0===u||u.forEach(e=>{if(e.type===cZ.link){let i=e.dotSeriesIndex+1;p.push({modelId:`${e.type}Row${i}`,col:1,row:i-1}),e.regionIndex=t.series[e.dotSeriesIndex].regionIndex,e.leftAppendPadding=b,e.height=t.series[e.dotSeriesIndex].height,e.clipHeight=t.series[e.dotSeriesIndex].clipHeight}}),(null==t?void 0:t.legends)&&this.addAttrToComponentSpec(t.legends,"regionIndex",[g.length-1]);let S={type:"grid",col:4,row:c,colWidth:[{index:0,size:b},{index:2,size:12},{index:3,size:x}],rowHeight:v,elements:p};t.layout=S,t.region=g,null===(d=t.axes)||void 0===d||d.push(...f),t.scrollBar=m}}var Ii=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Ir extends OD{constructor(){super(...arguments),this.transformerConstructor=Ie,this.type="sequence"}_createSeries(t,e){let i;if(!t)return;let{spec:r}=e,n=Ii(e,["spec"]);if(r.type===cZ.link&&(r.dotSeriesSpec=this._spec.series[r.dotSeriesIndex]),r.regionId&&(i=this.getRegionsInUserId(r.regionId)),i||(i=this.getRegionsInIndex(r.regionIndex?[r.regionIndex]:void 0)[0]),!i)return;let s=new t(r,Object.assign(Object.assign(Object.assign({},this._modelOption),n),{region:i,specKey:"series",globalScale:this._globalScale}));s&&(s.created(),this._series.push(s),i.addSeries(s))}}Ir.type="sequence",Ir.transformerConstructor=Ie;class In extends OO{transformSpec(t){super.transformSpec(t),t.axes.forEach(t=>t.type="linear")}_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{x2Field:null==t?void 0:t.x2Field,y2Field:null==t?void 0:t.y2Field,barMinHeight:null==t?void 0:t.barMinHeight,barBackground:null==t?void 0:t.barBackground})}}class Is extends OD{constructor(){super(...arguments),this.transformerConstructor=In,this._canStack=!0}}Is.transformerConstructor=In;class Ia extends In{transformSpec(t){super.transformSpec(t),bg(t)}}class Io extends Is{constructor(){super(...arguments),this.transformerConstructor=Ia,this.type="histogram",this.seriesType=cZ.bar}}Io.type="histogram",Io.seriesType=cZ.bar,Io.transformerConstructor=Ia;class Il extends Is{constructor(){super(...arguments),this.transformerConstructor=Ia,this.type="histogram3d",this.seriesType=cZ.bar3d}}Il.type="histogram3d",Il.seriesType=cZ.bar3d,Il.transformerConstructor=Ia;class Ih extends Rq{constructor(){super(...arguments),this._arcGroupMark=null,this._getAngleValueStart=t=>{let e=this._getAngleAxis(),{tickMask:i}=this._spec;if((null==i?void 0:i.forceAlign)&&this._isTickMaskVisible(e)){let r;let n=t[this.getStack()?bE:bj],s=this._getAngleAxisSubTickData(e),a=s[1].value-s[0].value,o=ik(i.offsetAngle);if(eO(n)){let t=xr(s,t=>t.value-n),e=t>=s.length||n>s[t].value-a/2?Math.min(t,s.length-1):t>0?t-1:void 0;void 0!==e&&(r=this.angleAxisHelper.dataToPosition([s[e].value-a/2]))}return ej(r)&&(r=this.angleAxisHelper.dataToPosition([s[0].value-a/2])),r+o}return this._getAngleValueStartWithoutMask(t)},this._getAngleValueEnd=t=>{let e=this._getAngleAxis(),{tickMask:i}=this._spec;if((null==i?void 0:i.forceAlign)&&this._isTickMaskVisible(e)){let r=t[this.getStack()?bO:this._angleField[0]],n=this._getAngleAxisSubTickData(e),s=n[1].value-n[0].value,a=ik(i.offsetAngle),o=xr(n,t=>t.value-r),l=o>=n.length||r>n[o].value-s/2?Math.min(o,n.length-1):o>0?o-1:void 0;return(void 0!==l?this.angleAxisHelper.dataToPosition([n[l].value+s/2]):this.angleAxisHelper.dataToPosition([n[0].value-s/2]))+a}return this._getAngleValueEndWithoutMask(t)}}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec();let r=null===(t=this._option.globalInstance.getChart())||void 0===t?void 0:t.getSpec(),n=null!==(e=this._spec.startAngle)&&void 0!==e?e:null==r?void 0:r.startAngle;this._startAngle=eO(n)?ik(n):ub;let s=null!==(i=this._spec.endAngle)&&void 0!==i?i:null==r?void 0:r.endAngle;this._endAngle=eO(s)?ik(s):ux,this.setAngleField(this._spec.valueField||this._spec.angleField),this.setRadiusField(this._spec.categoryField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice()}getStackGroupFields(){return this._radiusField}getStackValueField(){var t;return null===(t=this._angleField)||void 0===t?void 0:t[0]}getGroupFields(){return this._angleField}_convertMarkStyle(t){let e=super._convertMarkStyle(t);if(e.fill){let i=t.fill;"conical"!==(null==i?void 0:i.gradient)||eO(null==i?void 0:i.startAngle)||eO(null==i?void 0:i.endAngle)||(e.fill=Object.assign(Object.assign({},i),{startAngle:this._startAngle,endAngle:this._endAngle}))}return e}_getAngleValueStartWithoutMask(t){if(this.getStack()){let e=Se(this.angleAxisHelper.dataToPosition([t[bE]]),this.angleAxisHelper.getScale(0));if(l1(e))return e}return this._startAngle}_getAngleValueEndWithoutMask(t){if(this.getStack()){let e=Se(this.angleAxisHelper.dataToPosition([t[bO]]),this.angleAxisHelper.getScale(0));if(l1(e))return e}return this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])}getDimensionField(){return this._specRadiusField}getMeasureField(){return this._specAngleField}initMark(){this._initArcGroupMark()}initMarkStyle(){this._initArcGroupMarkStyle()}_initArcGroupMark(){return this._arcGroupMark=this._createMark(Ih.mark.group,{skipBeforeLayouted:!1}),this._arcGroupMark}_initArcGroupMarkStyle(){let t=this._arcGroupMark;t.setZIndex(this.layoutZIndex),t.created(),this.setMarkStyle(t,{x:0,y:0},"normal",tw.Series),t.setClip(()=>{let t=this._getAngleAxis();if(this._isTickMaskVisible(t)){let{tickMask:e}=this._spec,{angle:i,offsetAngle:r,style:n={}}=e,s=this._getAngleAxisSubTickData(t),{x:a,y:o}=this.angleAxisHelper.center(),l=this._computeLayoutRadius();return s.map(({value:t})=>{let e=this.angleAxisHelper.dataToPosition([t])+ik(r),s=ik(i)/2;return Sv(Object.assign(Object.assign({},n),{x:a,y:o,startAngle:e-s,endAngle:e+s,innerRadius:l*this._innerRadius,outerRadius:l*this._outerRadius,fill:!0}))})}let{width:e,height:i}=this.getLayoutRect();return[_4({width:e,height:i,fill:!0})]}),this._arcGroupMark.setInteractive(!1)}_getAngleAxis(){if(!this.angleAxisHelper)return;let t=this.angleAxisHelper.getAxisId();return this._option.getChart().getAllComponents().find(e=>e.id===t)}_getAngleAxisTickData(t){var e;return null===(e=null==t?void 0:t.getTickData())||void 0===e?void 0:e.getLatestData()}_isTickMaskVisible(t){let e=this._getAngleAxisTickData(t),{tickMask:i}=this._spec;return i&&!1!==i.visible&&(null==e?void 0:e.length)>1}_getAngleAxisSubTickData(t){var e;let i=this._getAngleAxisTickData(t),r=[],{subTick:n={},tick:s={}}=null!==(e=null==t?void 0:t.getSpec())&&void 0!==e?e:{},{tickCount:a=4}=n,{alignWithLabel:o}=s;if((null==i?void 0:i.length)>=2){let t=i[1].value-i[0].value;for(let e=0;e<i.length-1;e++){let n=i[e],s=i[e+1];r.push(n);for(let e=0;e<a;e++){let i=(e+1)/(a+1),l=(1-i)*n.value+i*(s?s.value:o?1:n.value+t);r.push({value:l})}}return r.push(i[i.length-1]),r}return i}}Ih.mark=hW;let Iu=t=>({type:"growAngleIn",options:{overall:t.startAngle}}),Id={type:"fadeIn"},Ic=()=>{de.registerAnimation("circularProgress",(t,e)=>{var i;return{appear:(i=t,"fadeIn"===e?Id:Iu(i)),enter:{type:"growAngleIn"},disappear:{type:"growAngleOut"}}})};class Ip extends C3{constructor(){super(...arguments),this._supportStack=!0}}class Ig extends Ih{constructor(){super(...arguments),this.type=cZ.circularProgress,this.transformerConstructor=Ip,this._progressMark=null,this._trackMark=null,this._getRadiusValueStart=t=>{if(this.getGroupFields().length>1){let e=this.radiusAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()));if(l1(e))return e}return this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]])},this._getRadiusValueEnd=t=>{var e,i;if(this.getGroupFields().length>1){let r=this.radiusAxisHelper.dataToPosition(this.getDatumPositionValues(t,this.getGroupFields()))+(null===(i=(e=this.radiusAxisHelper).getBandwidth)||void 0===i?void 0:i.call(e,this._groups?this._groups.fields.length-1:0));if(l1(r))return r}return this.radiusAxisHelper.dataToPosition([t[this._radiusField[0]]])+this.radiusAxisHelper.getScale(0).step()}}getStackGroupFields(){return this.getGroupFields()}getGroupFields(){return this._radiusField}initMark(){super.initMark(),this._initTrackMark(),this._initProgressMark()}initMarkStyle(){super.initMarkStyle(),this._initTrackMarkStyle(),this._initProgressMarkStyle()}_initProgressMark(){var t,e;return this._progressMark=this._createMark(Ig.mark.progress,{parent:this._arcGroupMark,isSeriesMark:!0,customShape:null===(t=this._spec.progress)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.progress)||void 0===e?void 0:e.stateSort}),this._progressMark}_initProgressMarkStyle(){var t;let e=this._progressMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._getAngleValueStart,endAngle:this._getAngleValueEnd,innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0},"normal",tw.Series)}initInteraction(){let t=[];this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)}initTooltip(){super.initTooltip(),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark)}_initTrackMark(){var t,e;return this._trackMark=this._createMark(Ig.mark.track,{parent:this._arcGroupMark,customShape:null===(t=this._spec.track)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.track)||void 0===e?void 0:e.stateSort}),this._trackMark}_initTrackMarkStyle(){let t=this._trackMark;t&&this.setMarkStyle(t,{visible:t=>{let e=this.angleAxisHelper.getScale(0).range(),i=Math.min(e[0],e[e.length-1]);return 1e-14>=Math.abs(this._getAngleValueStartWithoutMask(t)-i)},x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:()=>{let t=this.getStack()?bE:this._angleField[0],e=this.angleAxisHelper.getScale(0).domain();return this._getAngleValueStart({[t]:e[0]})},endAngle:()=>{let t=this.getStack()?bO:this._angleField[0],e=this.angleAxisHelper.getScale(0).domain();return this._getAngleValueEnd({[t]:e[e.length-1]})},innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:100},"normal",tw.Series)}initAnimation(){var t,e,i,r;let n=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._progressMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("circularProgress"))||void 0===i?void 0:i({startAngle:this._startAngle},n),Cq("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(CX(null===(r=de.getAnimationInKey("fadeInOut"))||void 0===r?void 0:r(),Cq("track",this._spec,this._markAttributeContext)))}getActiveMarks(){return[this._progressMark]}}Ig.type=cZ.circularProgress,Ig.mark=hG,Ig.transformerConstructor=Ip;let If=()=>{de.registerSeries(Ig.type,Ig),Bt(),Ic(),w7(),BT(),BO()};class Im extends Bs{needAxes(){return!1}_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{seriesField:t.seriesField,categoryField:t.categoryField||t.radiusField,valueField:t.valueField||t.angleField,startAngle:t.startAngle,endAngle:t.endAngle,radius:t.radius,innerRadius:t.innerRadius,centerX:t.centerX,centerY:t.centerY})}_transformProgressAxisSpec(t,e,i,r,n){var s,a;t.axes||(t.axes=[]);let o=(null!==(s=t.axes)&&void 0!==s?s:[]).find(t=>"radius"===t.orient),l=(null!==(a=t.axes)&&void 0!==a?a:[]).find(t=>"angle"===t.orient);l||(l=e,t.axes.push(l)),o||(o=i,t.axes.push(o)),ej(l.type)&&(l.type="linear"),ej(o.type)&&(o.type="band");let h=TU(l,{min:0,max:1});ej(l.min)&&(l.min=h.min),ej(l.max)&&(l.max=h.max),r&&Object.assign(l,us({},r,l)),n&&Object.assign(o,us({},n,o))}}class Iv extends Im{_getDefaultSeriesSpec(t){var e,i;return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{cornerRadius:null!==(e=t.cornerRadius)&&void 0!==e?e:0,roundCap:null!==(i=t.roundCap)&&void 0!==i&&i,progress:t.progress,track:t.track,tickMask:t.tickMask})}transformSpec(t){super.transformSpec(t),this._transformProgressAxisSpec(t,{orient:"angle",visible:!1},{orient:"radius",visible:!1},{forceInitTick:t.tickMask&&!1!==t.tickMask.visible})}}class Iy extends OD{constructor(){super(...arguments),this.transformerConstructor=Iv,this.type="circularProgress",this.seriesType=cZ.circularProgress,this._canStack=!0}}Iy.type="circularProgress",Iy.seriesType=cZ.circularProgress,Iy.transformerConstructor=Iv;let I_=t=>({channel:{angle:{from:t.startAngle+Math.PI/2}}}),Ib={type:"fadeIn"},Ix=()=>{de.registerAnimation("gaugePointer",(t,e)=>{var i;let r=(i=t,"fadeIn"===e?Ib:I_(i));return{appear:r,enter:r,disappear:{type:"fadeOut"}}})};class IS extends C3{constructor(){super(...arguments),this._supportStack=!1}}class Ik extends Ih{constructor(){super(...arguments),this.type=cZ.gaugePointer,this.transformerConstructor=IS,this._pinMark=null,this._pointerMark=null,this._pinBackgroundMark=null}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setRadiusField(this._spec.radiusField),this._pointerType="rect"===(null===(t=this._spec.pointer)||void 0===t?void 0:t.type)?"rect":"path"}initMark(){this._pinBackgroundMark=this._createMark(Ik.mark.pinBackground),this._pointerMark=this._createMark(Object.assign(Object.assign({},Ik.mark.pointer),{type:this._pointerType}),{isSeriesMark:!0}),this._pinMark=this._createMark(Ik.mark.pin)}initMarkStyle(){this.initPinBackgroundMarkStyle(),this.initPointerMarkStyle(),this.initPinMarkStyle()}initGroups(){}initPointerMarkStyle(){let t=this._pointerMark,e=this._spec.pointer;t&&(this.setMarkStyle(t,{x:t=>{var i,r;let{x:n}=this._getPointerAnchor(t,e);return n-this._getPointerWidth()*(null!==(r=null===(i=null==e?void 0:e.center)||void 0===i?void 0:i[0])&&void 0!==r?r:0)},y:t=>{var i,r;let{y:n}=this._getPointerAnchor(t,e);return n-this._getPointerHeight(t)*(null!==(r=null===(i=null==e?void 0:e.center)||void 0===i?void 0:i[1])&&void 0!==r?r:0)},anchor:t=>{let{x:i,y:r}=this._getPointerAnchor(t,e);return[i,r]},fill:this.getColorAttribute(),zIndex:200}),"path"===this._pointerType?this.setMarkStyle(t,{scaleX:this._getPointerWidth.bind(this),scaleY:this._getPointerHeight.bind(this),angle:t=>this._getPointerAngle(t)+Math.PI/2}):this.setMarkStyle(t,{width:this._getPointerWidth.bind(this),height:this._getPointerHeight.bind(this),angle:t=>this._getPointerAngle(t)-Math.PI/2}))}initTooltip(){super.initTooltip(),this._pointerMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pointerMark)}_getPointerAnchor(t,e){var i;return null===(i=e.isOnCenter)||void 0===i||i?this.angleAxisHelper.center():this.radiusAxisHelper.coordToPoint({radius:this._innerRadius*this._computeLayoutRadius(),angle:this.angleAxisHelper.dataToPosition([t[this._angleField[0]]])})}_getPointerWidth(){return this._spec.pointer.width*this._computeLayoutRadius()}_getPointerHeight(t){var e,i;let r=this._spec.pointer,n=this._radiusField[0];return eO(this.radiusAxisHelper)&&eO(n)?this.radiusAxisHelper.dataToPosition([t[n]])-(null!==(e=null==r?void 0:r.innerPadding)&&void 0!==e?e:0)-(null!==(i=null==r?void 0:r.outerPadding)&&void 0!==i?i:10):r.height*this._computeLayoutRadius()}_getPointerAngle(t){let e=this.angleAxisHelper.getScale().domain(),i=oy(e),r=o_(e),n=nL(t[this._angleField[0]],r,i);return this.angleAxisHelper.dataToPosition([n])}_getRotatedPointerCenterOffset(t){var e,i,r,n;let s=this._spec.pointer,a=this._getPointerWidth()*(null!==(i=null===(e=null==s?void 0:s.center)||void 0===e?void 0:e[0])&&void 0!==i?i:0),o=-this._getPointerHeight(t)*(null!==(n=null===(r=null==s?void 0:s.center)||void 0===r?void 0:r[1])&&void 0!==n?n:0),l=this._getPointerAngle(t)-Math.PI/2,h=Math.cos(l),u=Math.sin(l);return{x:a*h+o*u,y:-(o*h-a*u)}}initPinBackgroundMarkStyle(){let t=this._pinBackgroundMark,e=this._spec.pinBackground;t&&this.setMarkStyle(t,{x:t=>this._getPointerAnchor(t,e).x,y:t=>this._getPointerAnchor(t,e).y,scaleX:()=>e.width*this._computeLayoutRadius(),scaleY:()=>e.height*this._computeLayoutRadius(),fill:this.getColorAttribute(),zIndex:100})}initPinMarkStyle(){let t=this._pinMark,e=this._spec.pin;t&&this.setMarkStyle(t,{x:t=>this._getPointerAnchor(t,e).x,y:t=>this._getPointerAnchor(t,e).y,scaleX:()=>e.width*this._computeLayoutRadius(),scaleY:()=>e.height*this._computeLayoutRadius(),fill:this.getColorAttribute(),zIndex:300})}initInteraction(){this._parseInteractionConfig(this._pointerMark?[this._pointerMark]:[])}initAnimation(){var t,e,i;let r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._pointerMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("gaugePointer"))||void 0===i?void 0:i({startAngle:this._startAngle},r),Cq("pointer",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[]}}Ik.type=cZ.gaugePointer,Ik.mark=h2,Ik.transformerConstructor=IS;let IA=()=>{de.registerSeries(Ik.type,Ik),RL(),O2(),Ix(),BT(),BO()};class Iw extends C3{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){this._addMarkLabelSpec(t,"segment")}}class IM extends Ih{constructor(){super(...arguments),this.type=cZ.gauge,this.transformerConstructor=Iw,this._segmentMark=null,this._trackMark=null,this._padAngle=0}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._padAngle=ik(null!==(t=this._spec.padAngle)&&void 0!==t?t:0)}initData(){var t;super.initData(),gw(this._option.dataSet,"spiltSegment",(t,e)=>{let i=t.slice();return i.sort((t,e)=>t[this._angleField[0]]-e[this._angleField[0]]),i.forEach((t,e)=>{t[bN]=t[this._angleField[0]],t[bj]=e>0?i[e-1][bN]:void 0}),i}),null===(t=this.getViewData())||void 0===t||t.transform({type:"spiltSegment"},!1)}initMark(){super.initMark(),this._trackMark=this._createMark(IM.mark.track,{parent:this._arcGroupMark,dataView:!1}),this._segmentMark=this._createMark(IM.mark.segment,{parent:this._arcGroupMark,isSeriesMark:!0})}initMarkStyle(){super.initMarkStyle(),this.initTrackMarkStyle(),this.initSegmentMarkStyle()}initSegmentMarkStyle(){var t;let e=this._segmentMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._getAngleValueStart.bind(this),endAngle:this._getAngleValueEnd.bind(this),innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!==(t=this._spec.innerRadius)&&void 0!==t?t:0)},outerRadius:()=>{var t,e;return this._computeLayoutRadius()*(null!==(e=null!==(t=this._spec.radius)&&void 0!==t?t:this._spec.outerRadius)&&void 0!==e?e:1)},cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0})}initTooltip(){super.initTooltip(),this._segmentMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._segmentMark)}initTrackMarkStyle(){var t;let e=this._trackMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:()=>{var t;return this._computeLayoutRadius()*(null!==(t=this._spec.innerRadius)&&void 0!==t?t:0)},outerRadius:()=>{var t,e;return this._computeLayoutRadius()*(null!==(e=null!==(t=this._spec.radius)&&void 0!==t?t:this._spec.outerRadius)&&void 0!==e?e:1)},cap:null!==(t=this._spec.roundCap)&&void 0!==t&&t,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,zIndex:100})}_getAngleValueStartWithoutMask(t){let e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t);return Math.min(e+this._padAngle/2,(e+i)/2)}_getAngleValueEndWithoutMask(t){let e=this._getAngleValueStartWithoutPadAngle(t),i=this._getAngleValueEndWithoutPadAngle(t);return Math.max(i-this._padAngle/2,(e+i)/2)}_getAngleValueStartWithoutPadAngle(t){return eO(t[bj])?this.angleAxisHelper.dataToPosition([t[bj]]):this._startAngle}_getAngleValueEndWithoutPadAngle(t){return this.angleAxisHelper.dataToPosition([t[bN]])}initAnimation(){var t,e,i;let r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._segmentMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("circularProgress"))||void 0===i?void 0:i({startAngle:this._startAngle},r),Cq("segment",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[]}}IM.type=cZ.gauge,IM.mark=h1,IM.transformerConstructor=Iw;let IC=()=>{de.registerSeries(IM.type,IM),Bt(),Ic(),BO()};class IT extends Im{_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{radiusField:t.radiusField,pin:t.pin,pinBackground:t.pinBackground,pointer:t.pointer})}_getDefaultCircularProgressSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{type:cZ.circularProgress})}transformSpec(t){var e,i,r,n,s;super.transformSpec(t);let a=null===(e=t.series)||void 0===e?void 0:e.find(t=>t.type===cZ.gauge||t.type===cZ.circularProgress);ej(a)&&("circularProgress"===(a=null!==(i=t.gauge)&&void 0!==i?i:this._getDefaultCircularProgressSeriesSpec(t)).type&&(ej(a.radiusField)&&ej(a.categoryField)&&(a.radiusField=null!==(n=null!==(r=t.radiusField)&&void 0!==r?r:t.categoryField)&&void 0!==n?n:t.seriesField),ej(a.valueField)&&ej(a.angleField)&&(a.valueField=null!==(s=t.valueField)&&void 0!==s?s:t.angleField)),1===t.series.length?t.series.push(a):t.series.forEach(t=>{t.type===a.type&&Object.keys(a).forEach(e=>{e in t||(t[e]=a[e])})})),a.type===cZ.circularProgress?this._transformProgressAxisSpec(t,{orient:"angle",visible:!0,domainLine:{visible:!1},grid:{visible:!1}},{orient:"radius",visible:!1},{zIndex:tM.Region+50}):this._transformGaugeAxisSpec(t)}_transformGaugeAxisSpec(t){var e;t.axes||(t.axes=[]);let i={radius:null,angle:null};(null!==(e=t.axes)&&void 0!==e?e:[]).forEach(t=>{let{orient:e}=t;"radius"===e&&(i.radius=t),"angle"===e&&(i.angle=t)}),i.angle||(i.angle={orient:"angle",visible:!0},t.axes.push(i.angle)),i.radius||(i.radius={orient:"radius",visible:!1},t.axes.push(i.radius)),ej(i.angle.type)&&(i.angle.type="linear"),ej(i.radius.type)&&(i.radius.type="linear"),ej(i.angle.zIndex)&&(i.angle.zIndex=tM.Region+50)}}class IE extends OD{constructor(){super(...arguments),this.transformerConstructor=IT,this.type="gauge",this.seriesType=cZ.gaugePointer}}IE.type="gauge",IE.seriesType=cZ.gaugePointer,IE.transformerConstructor=IT;class IO extends OE{transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class IP extends OD{constructor(){super(...arguments),this.transformerConstructor=IO,this.type="wordCloud",this.seriesType=cZ.wordCloud}}IP.transformerConstructor=IO;let IR=[0],IB=[20,40],II=[200,500],IL={shrink:!1,enlarge:!1,fontSizeLimitMin:0},ID=["triangleForward","triangle","diamond","square","star","cardioid","circle","pentagon","rect"],IF=(t,e)=>{let i,r;let n=nx(e)?e:t=>t;if(t&&t.length){let e=t.length;for(let s=0;s<e;s+=1){let e=n(t[s]);ej(e)||!ey(e=+e)||Number.isNaN(e)||(ej(i)?(i=e,r=e):(i=Math.min(i,e),r=Math.max(r,e)))}}return[i,r]},Ij=`${hA}_WORD_CLOUD_WEIGHT`,IN=`${hA}_WORD_CLOUD_TEXT`;class Iz extends C5{constructor(){super(...arguments),this._fontSizeRange=[20,20],this._isWordCloudShape=!1,this._dataChange=!0,this.getWordColor=t=>t.isFillingWord?(this._fillingColorCallback&&!this._dataChange||(this._fillingColorCallback=this._wordCloudShapeConfig.fillingColorHexField?t=>t[this._wordCloudShapeConfig.fillingColorHexField]:this.initColorCallback(this._wordCloudShapeConfig.fillingSeriesField,!0)),this._fillingColorCallback(t)):(this._keyWordColorCallback&&!this._dataChange||(this._keyWordColorCallback=this._colorHexField?t=>t[this._colorHexField]:this.initColorCallback(this._seriesField,!1)),this._keyWordColorCallback(t))}setValueField(t){eO(t)&&(this._valueField=t)}setFontSizeRange(t){eO(t)?this._fontSizeRange=t:this._fontSizeRange=IB}setAttrFromSpec(){var t,e,i,r,n,s,a,o,l,h;super.setAttrFromSpec(),this._padding=this._option.getChart().padding,this._nameField=this._spec.nameField,this._fontFamilyField=this._spec.fontFamilyField,this._fontWeightField=this._spec.fontWeightField,this._fontStyleField=this._spec.fontStyleField,this._colorHexField=this._spec.colorHexField,this._colorMode=null!==(t=this._spec.colorMode)&&void 0!==t?t:"ordinal",this._colorList=this._spec.colorList,this.setValueField(this._spec.valueField),this._fontWeightRange=null!==(e=this._spec.fontWeightRange)&&void 0!==e?e:II,this._rotateAngles=null!==(i=this._spec.rotateAngles)&&void 0!==i?i:IR,this.setFontSizeRange(this._spec.fontSizeRange),this._maskShape=null!==(r=this._spec.maskShape)&&void 0!==r?r:"circle",this._keepAspect=this._spec.keepAspect,this._random=null===(n=this._spec.random)||void 0===n||n,this._fontPadding=null!==(a=null===(s=this._spec.word)||void 0===s?void 0:s.padding)&&void 0!==a?a:1,this._textField=(null===(o=this._spec.word)||void 0===o?void 0:o.formatMethod)?IN:this._nameField,this._wordCloudConfig=Object.assign({drawOutOfBound:"hidden",layoutMode:"default",zoomToFit:IL},this._spec.wordCloudConfig),this._wordCloudShapeConfig=Object.assign({fillingSeriesField:this.getSeriesField(),fillingRotateAngles:IR,layoutMode:"default"},this._spec.wordCloudShapeConfig),this._fillingFontPadding=null!==(h=null===(l=this._spec.fillingWord)||void 0===l?void 0:l.padding)&&void 0!==h?h:1,this._isWordCloudShape=!ID.includes(this._maskShape),this._defaultFontFamily=this._option.getTheme().fontFamily}initData(){var t,e;super.initData(),null===(e=null===(t=this.getViewData())||void 0===t?void 0:t.target)||void 0===e||e.addListener("change",()=>{this._dataChange=!0,this.compile()})}initMark(){this._wordMark=this._createMark(Iz.mark.word,{key:bw,defaultMorphElementKey:this._seriesField,groupKey:this._seriesField,isSeriesMark:!0})}initMarkStyle(){var t,e,i;let r=this._wordMark,n=null!==(t=this._spec.word)&&void 0!==t?t:{};r&&(this.setMarkStyle(r,{fill:this.getWordColor,text:t=>t[this._textField],x:t=>t.x,y:t=>t.y,fontFamily:t=>t.fontFamily,fontSize:t=>t.fontSize,fontStyle:t=>t.fontStyle,fontWeight:t=>t.fontWeight,angle:t=>t.angle,visible:t=>t.visible},"normal",tw.Series),this.setMarkStyle(r,{fontFamily:null!==(i=null===(e=n.style)||void 0===e?void 0:e.fontFamily)&&void 0!==i?i:this._defaultFontFamily},"normal",tw.User_Mark))}initTooltip(){super.initTooltip(),this._wordMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._wordMark)}initAnimation(){var t,e;let i=this._wordMark;if(i){let r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;i.setAnimationConfig(CX(de.getAnimationInKey("wordCloud")({animationConfig:()=>{var t,e;return null===(e=null===(t=i.getAnimationConfig())||void 0===t?void 0:t.appear)||void 0===e?void 0:e[0]}},r),Cq("word",this._spec,this._markAttributeContext)))}}getWordOrdinalColorScale(t,e){var i,r,n,s,a;let o=e?this._wordCloudShapeConfig.fillingColorList:this._colorList,l=t?null===(i=this.getViewData())||void 0===i?void 0:i.latestData.map(e=>e[t]):[],h=null!==(n=null!=o?o:null===(r=this._option.globalScale.getScale("color"))||void 0===r?void 0:r.range())&&void 0!==n?n:this._getDataScheme();return null===(a=(s=(new x9).domain(l)).range)||void 0===a?void 0:a.call(s,h)}initColorCallback(t,e){var i;if("ordinal"===this._colorMode){let i=this.getWordOrdinalColorScale(t,e);return t=>{var e;return i.scale(t[null!==(e=this._seriesField)&&void 0!==e?e:bM])}}let r=null!==(i=e?this._colorList:this._wordCloudShapeConfig.fillingColorList)&&void 0!==i?i:this._option.globalScale.getScale("color").range();return 1===r.length&&(r=[r[0],r[0]]),t=>r[0]}compile(){var t,e;super.compile();let{width:i,height:r}=this._region.getLayoutRect();if(!l1(i)||!l1(r)||!(r>0&&i>0))return;let n=[],s=this._valueField,a=new x1,o=this._fontWeightRange;if(s){let[e,i]=IF(null===(t=this.getViewData())||void 0===t?void 0:t.latestData.map(t=>+t[s]));a.domain([e,i],!0).range(o),n.push({type:"map",as:Ij,callback:t=>e===i?a.scale(i):a.scale(t[s])})}let l=null!==(e=this._spec.word)&&void 0!==e?e:{};l.formatMethod&&n.push({type:"map",as:IN,callback:l.formatMethod}),this._isWordCloudShape?n.push(Object.assign({type:"wordcloudShape"},this._wordCloudShapeTransformOption())):n.push(Object.assign({type:"wordcloud"},this._wordCloudTransformOption())),this._wordMark.getProduct().transform(n)}_wordCloudTransformOption(){var t,e,i,r,n;let{width:s,height:a}=this._region.getLayoutRect(),o=null!==(e=null===(t=this._spec.word)||void 0===t?void 0:t.style)&&void 0!==e?e:{};return{layoutType:hl(this._option.mode)?this._wordCloudConfig.layoutMode:"fast",size:[s,a],shape:this._maskShape,dataIndexKey:bw,text:{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:"auto"===this._fontSizeRange?null:this._fontSizeRange,padding:this._fontPadding,rotate:this._rotateAngles,fontFamily:null!==(r=null!==(i=this._fontFamilyField)&&void 0!==i?i:o.fontFamily)&&void 0!==r?r:this._defaultFontFamily,fontWeight:this._fontWeightField?{field:this._fontWeightField}:this._valueField?{field:Ij}:null,fontStyle:null!==(n=this._fontStyleField)&&void 0!==n?n:o.fontStyle,randomVisible:this._random,clip:"clip"===this._wordCloudConfig.drawOutOfBound,shrink:this._wordCloudConfig.zoomToFit.shrink,enlarge:this._wordCloudConfig.zoomToFit.enlarge,minFontSize:this._wordCloudConfig.zoomToFit.fontSizeLimitMin,progressiveTime:this._wordCloudConfig.progressiveTime,progressiveStep:this._wordCloudConfig.progressiveStep}}_wordCloudShapeTransformOption(){var t,e,i,r,n,s,a,o,l,h;let{width:u,height:d}=this._region.getLayoutRect(),c=null!==(e=null===(t=this._spec.word)||void 0===t?void 0:t.style)&&void 0!==e?e:{},p=null!==(i=this._wordCloudShapeConfig)&&void 0!==i?i:{},g=this._wordCloudShapeConfig.fillingRotateAngles;return{dataIndexKey:bw,size:[u,d],shape:this._maskShape,text:{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:"auto"===this._fontSizeRange?null:this._fontSizeRange,padding:this._fontPadding,rotateList:this._rotateAngles,fontFamily:null!==(n=null!==(r=this._fontFamilyField)&&void 0!==r?r:c.fontFamily)&&void 0!==n?n:this._defaultFontFamily,fontWeight:this._fontWeightField?{field:this._fontWeightField}:this._valueField?{field:Ij}:null,fontStyle:null!==(s=this._fontStyleField)&&void 0!==s?s:c.fontStyle,fillingFontFamily:null!==(o=null!==(a=p.fillingFontFamilyField)&&void 0!==a?a:c.fontFamily)&&void 0!==o?o:this._defaultFontFamily,fillingPadding:this._fillingFontPadding,fillingFontStyle:null!==(l=p.fillingFontStyleField)&&void 0!==l?l:c.fontStyle,fillingFontWeight:null!==(h=p.fillingFontWeightField)&&void 0!==h?h:c.fontWeight,fillingRotateList:g,fillingTimes:p.fillingTimes,fillingXStep:p.fillingXStep,fillingYStep:p.fillingYStep,fillingXRatioStep:p.fillingXRatioStep,fillingYRatioStep:p.fillingYRatioStep,fillingInitialOpacity:p.fillingInitialOpacity,fillingDeltaOpacity:p.fillingDeltaOpacity,fillingInitialFontSize:p.fillingInitialFontSize,fillingDeltaFontSize:p.fillingDeltaFontSize,ratio:p.ratio,fillingRatio:p.fillingRatio,removeWhiteBorder:p.removeWhiteBorder,textLayoutTimes:p.textLayoutTimes,fontSizeShrinkFactor:p.fontSizeShrinkFactor,stepFactor:p.stepFactor,layoutMode:p.layoutMode,importantWordCount:p.importantWordCount,globalShinkLimit:p.globalShinkLimit,fontSizeEnlargeFactor:p.fontSizeEnlargeFactor,fillingDeltaFontSizeFactor:p.fillingDeltaFontSizeFactor}}getStatisticFields(){let t=[];return t.push({key:this._nameField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}dataToPosition(t){return null}dataToPositionX(t){return null}dataToPositionY(t){return null}dataToPositionZ(t){return null}valueToPosition(t,e){return null}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}onLayoutEnd(t){super.onLayoutEnd(t),this.compile(),this._dataChange=!1}getActiveMarks(){return[this._wordMark]}reInit(){super.reInit(),this._keyWordColorCallback&&(this._keyWordColorCallback=null),this._fillingColorCallback&&(this._fillingColorCallback=null)}}Iz.mark=hY;let IH=t=>({custom:mK,customParameters:(e,i)=>t,easing:"linear",loop:1/0,duration:6e3}),IV=t=>({channel:{fontSize:{from:0}},duration:200,delay:(e,i,r)=>{var n,s,a;let o=t.animationConfig(),l=(null==o?void 0:o.duration)||200,h=(null==o?void 0:o.totalTime)||w4.appear.duration,u=r.VGRAMMAR_ANIMATION_PARAMETERS.elementCount;return r.VGRAMMAR_ANIMATION_PARAMETERS.elementIndex*(n=l,s=h,n*(a=u)<s?n+(s-a*n)/(a-1):(s-n)/(a-1))}}),IW=()=>{de.registerAnimation("wordCloud",(t,e)=>{var i,r;return{appear:(i=t,!1===(r=e)?{}:"fadeIn"===r?{type:"fadeIn"}:IV(i)),enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}})},IG=()=>{de.registerAnimation("wordCloud3d",t=>({appear:IH(t)}))},IU={triangleForward:function(){return function(t){let e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}},triangleUpright:I$,triangle:I$,diamond:function(){return function(t){let e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))}},square:function(){return function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))}},star:function(){return function(t){let e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}},cardioid:function(){return function(t){return 1-Math.sin(t)}},circle:function(){return function(){return 1}},pentagon:function(){return function(t){let e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))}}};function I$(){return function(t){let e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}}function IY(t,e){let i=e[0],r=e[1],n=1,s=[e[0]>>1,e[1]>>1];switch(t){case"cardioid":s[1]=~~(r/2.7*.6),n=Math.floor(Math.min(i/2.3,r/2.6));break;case"triangleForward":n=r/Math.sqrt(.75)>i?Math.floor(i/2):Math.floor(r/(2*Math.sqrt(.75)));break;case"triangle":case"triangleUpright":s[1]=~~(r/1.5),n=Math.floor(Math.min(r/1.5,i/2));break;case"rect":n=Math.floor(Math.max(r/2,i/2));break;default:n=Math.floor(Math.min(i/2,r/2))}return{maxRadius:n,center:s}}let IK=t=>IU[t]?IU[t]():IU.circle(),IZ=(t,e)=>"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)";function IX(t){return nx(t)?t:function(){return t}}class Iq{constructor(t){var e,i;switch(this.options=eF({},Iq.defaultOptions,t),nx(this.options.shape)?this.shape=this.options.shape:this.shape=IK(this.options.shape),this.getText=null!==(e=IX(this.options.text))&&void 0!==e?e:t=>t,this.getTextFontWeight=IX(this.options.fontWeight),this.getTextFontSize=IX(this.options.fontSize),this.getTextFontStyle=IX(this.options.fontStyle),this.getTextFontFamily=IX(this.options.fontFamily),this.outputCallback=null!==(i=this.options.outputCallback)&&void 0!==i?i:t=>t,this.options.color){case"random-dark":this.getTextColor=()=>IZ(10,50);break;case"random-light":this.getTextColor=()=>IZ(50,90);break;default:this.getTextColor=IX(this.options.color)}if(ej(this.options.rotate)){if(this.options.useRandomRotate){let t=Math.abs(this.options.maxRotation-this.options.minRotation),e=Math.abs(Math.floor(this.options.rotationSteps)),i=Math.min(this.options.maxRotation,this.options.minRotation);this.getTextRotate=()=>0===this.options.rotateRatio||Math.random()>this.options.rotateRatio?0:0===t?i:e>0?i+Math.floor(Math.random()*e)*t/(e-1):i+Math.random()*t}else this.getTextRotate=()=>0}else this.getTextRotate=nx(this.options.rotate)?t=>{var e;return ik(null!==(e=this.options.rotate(t))&&void 0!==e?e:0)}:(t,e)=>{let i=om(this.options.rotate);return ik(i[Math.floor((this.options.random?Math.random():parseFloat("0."+Math.sin(e).toString().substring(6)))*i.length)])}}exceedTime(){var t;return this.options.progressiveStep>0?this.progressiveIndex>=((null!==(t=this.currentStepIndex)&&void 0!==t?t:0)+1)*this.options.progressiveStep:this.options.progressiveTime>0&&(new Date).getTime()-this.escapeTime>this.options.progressiveTime}progressiveRun(){var t;if(this.options.progressiveStep>0?this.currentStepIndex=(null!==(t=this.currentStepIndex)&&void 0!==t?t:0)+1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.data&&this.progressiveIndex&&this.progressiveIndex<this.data.length){this.progressiveResult=[];let t=this.data.length,e=this.progressiveIndex;for(;e<t&&(this.layoutWord(e),e++,this.progressiveIndex=e,!this.exceedTime()););return this.progressiveResult}return this.result}initProgressive(){this.progressiveIndex=-1,this.options.progressiveStep>0?this.currentStepIndex=0:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.progressiveResult=[]}output(){return this.result?this.outputCallback(this.result):null}progressiveOutput(){return this.progressiveResult?this.outputCallback(this.progressiveResult):null}unfinished(){return this.data&&this.data.length&&!ej(this.progressiveIndex)&&this.progressiveIndex<this.data.length}release(){this.data=null,this.result=null,this.progressiveIndex=null,this.progressiveResult=null}}Iq.defaultOptions={fontFamily:'"Trebuchet MS", "Heiti TC", "\u5FAE\u8EDF\u6B63\u9ED1\u9AD4", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",fontStyle:"normal",minFontSize:12,drawOutOfBound:!1,shrink:!1,minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,rotateRatio:.1,random:!1,shape:"circle",progressiveTime:0,progressiveStep:0,backgroundColor:"#fff"};let IJ={archimedean:function(t){let e=t[0]/t[1];return t=>[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]},rectangular:function(t){let e=4*t[0]/t[1],i=0,r=0;return t=>{let n=t<0?-1:1;switch(Math.sqrt(1+4*n*t)-n&3){case 0:i+=e;break;case 1:r+=4;break;case 2:i-=e;break;default:r-=4}return[i,r]}}};class IQ extends Iq{constructor(t){var e;super(eF({},IQ.defaultOptions,t)),this.cw=64,this.ch=2048,this._size=[256,256],this._isBoardExpandCompleted=!1,this._placeStatus=0,this._tTemp=null,this._dtTemp=null,this._dy=0,this.cacheMap=new Map,this.options.minFontSize<=IQ.defaultOptions.minFontSize&&(this.options.minFontSize=IQ.defaultOptions.minFontSize),this.spiral=eE(this.options.spiral)?null!==(e=IJ[this.options.spiral])&&void 0!==e?e:IJ.archimedean:this.options.spiral,this.random=this.options.random?Math.random:()=>1,this.getTextPadding=IX(this.options.padding)}zoomRatio(){return this._originSize[0]/this._size[0]}dy(){return this._dy}layoutWord(t){let e=this.data[t];if(""===(""+e.text).trim())return!0;let{maxRadius:i,center:r}=IY(this.options.shape,this._size);if(e.x=r[0],e.y=r[1],function(t,e,i,r,n,s){let a,o,l,h,u;if(e.sprite)return;let d=t.context,c=t.ratio;d.setTransform(c,0,0,c,0,0),d.clearRect(0,0,(n<<5)/c,s/c);let p=0,g=0,f=0,m=i.length;for(--r;++r<m;){if(e=i[r],d.save(),d.font=e.fontStyle+" "+e.fontWeight+" "+~~((e.fontSize+1)/c)+"px "+e.fontFamily,a=d.measureText(e.text+"m").width*c,l=e.fontSize<<1,e.angle){let t=Math.sin(e.angle),i=Math.cos(e.angle),r=a*i,n=a*t,s=l*i,o=l*t;a=Math.max(Math.abs(r+o),Math.abs(r-o))+31>>5<<5,l=~~Math.max(Math.abs(n+s),Math.abs(n-s))}else a=a+31>>5<<5;if(l>f&&(f=l),p+a>=n<<5&&(p=0,g+=f,f=0),g+l>=s)break;d.translate((p+(a>>1))/c,(g+(l>>1))/c),e.angle&&d.rotate(e.angle),d.fillText(e.text,0,0),e.padding&&(d.lineWidth=2*e.padding,d.strokeText(e.text,0,0)),d.restore(),e.width=a,e.height=l,e.xoff=p,e.yoff=g,e.x1=a>>1,e.y1=l>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,p+=a}let v=d.getImageData(0,0,(n<<5)/c,s/c).data,y=[];for(;--r>=0;){if(!(e=i[r]).hasText)continue;for(o=(a=e.width)>>5,l=e.y1-e.y0,h=0;h<l*o;h++)y[h]=0;if(null==(p=e.xoff))return;g=e.yoff;let t=0,s=-1;for(u=0;u<l;u++){for(h=0;h<a;h++){let e=o*u+(h>>5),i=v[(g+u)*(n<<5)+(p+h)<<2]?1<<31-h%32:0;y[e]|=i,t|=i}t?s=u:(e.y0++,l--,u--,g++)}e.y1=e.y0+s,e.sprite=y.slice(0,(e.y1-e.y0)*o)}}(this.contextAndRatio,e,this.data,t,this.cw,this.ch),this._placeStatus=0,e.hasText&&this.place(this._board,e,this._bounds,i))return this.result.push(e),this._bounds?function(t,e){let i=t[0],r=t[1];e.x+e.x0<i.x&&(i.x=e.x+e.x0),e.y+e.y0<i.y&&(i.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}(this._bounds,e):this._bounds=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=this._size[0]>>1,e.y-=this._size[1]>>1,this._tTemp=null,this._dtTemp=null,!0;if(this.updateBoardExpandStatus(e.fontSize),e.hasText&&this.shouldShrinkContinue()){if(1===this._placeStatus){let t=e.fontSize*this._originSize[0]/this.options.minFontSize,i=Math.max(e.width,e.height);if(i<=t)this.expandBoard(this._board,this._bounds,i/this._size[0]);else{if(!this.options.clip)return!0;this.expandBoard(this._board,this._bounds,t/this._size[0])}}else this._placeStatus,this.expandBoard(this._board,this._bounds);return this.updateBoardExpandStatus(e.fontSize),!1}return this._tTemp=null,this._dtTemp=null,!0}layout(t,e){this.initProgressive(),this.result=[],this._size=[e.width,e.height],this.clearCache(),this._originSize=[...this._size];let i=this.getContext(lX.createCanvas({width:1,height:1}));this.contextAndRatio=i,this._board=Array((this._size[0]>>5)*this._size[1]).fill(0),this._bounds=null;let r=t.length,n=0;this.result=[];let s=t.map((t,e)=>({text:this.getText(t),fontFamily:this.getTextFontFamily(t),fontStyle:this.getTextFontStyle(t),fontWeight:this.getTextFontWeight(t),angle:this.getTextRotate(t,e),fontSize:~~this.getTextFontSize(t),padding:this.getTextPadding(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:t,x:0,y:0,width:0,height:0})).sort(function(t,e){return e.fontSize-t.fontSize});this.data=s;let a=0;for(;n<r&&(this.layoutWord(n)||a>=2?(n++,a=0):a++,this.progressiveIndex=n,!this.exceedTime()););if(!this.options.clip&&this.options.enlarge&&this._bounds&&this.shrinkBoard(this._bounds),this._bounds&&["cardioid","triangle","triangle-upright"].includes(this.options.shape)){let t=(this._bounds[0].y+this._bounds[1].y)/2;this._dy=-(t-this._size[1]/2)}return this.result}formatTagItem(t){let e,i;let r=this._size,n=this.zoomRatio(),s=this.dy(),a=r[0]>>1,o=r[1]>>1,l=t.length,h=[];for(let r=0;r<l;++r)e=t[r],(i={}).datum=e.datum,i.x=(e.x+a)*n,i.y=(e.y+o+s)*n,i.fontFamily=e.fontFamily,i.fontSize=e.fontSize*n,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.angle=e.angle,h.push(i);return h}output(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.result)):this.formatTagItem(this.result)}progressiveOutput(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.progressiveResult)):this.formatTagItem(this.progressiveResult)}updateBoardExpandStatus(t){this._isBoardExpandCompleted=t*(this._originSize[0]/this._size[0])<this.options.minFontSize}shouldShrinkContinue(){return!this.options.clip&&this.options.shrink&&!this._isBoardExpandCompleted}shrinkBoard(t){let e=t[0],i=t[1];if(i.x>=this._size[0]||i.y>=this._size[1])return;let r=Math.min(e.x,this._size[0]-i.x),n=Math.min(e.y,this._size[1]-i.y),s=2*Math.min(r/this._size[0],n/this._size[1]);this._size=this._size.map(t=>t*(1-s))}expandBoard(t,e,i){let r=this._size[0]*(i||1.1)-this._size[0]>>5,n=2*r>2?r:2;n%2!=0&&n++;let s=Math.ceil(this._size[1]*(n<<5)/this._size[0]);s%2!=0&&s++;let a=this._size[0],o=this._size[1],l=Array(n).fill(0),h=Array(s/2*(n+(a>>5))).fill(0);this.insertZerosToArray(t,o*(a>>5),h.length+n/2);for(let e=o-1;e>0;e--)this.insertZerosToArray(t,e*(a>>5),l.length);this.insertZerosToArray(t,0,h.length+n/2),this._size=[a+(n<<5),o+s],e&&(e[0].x+=(n<<5)/2,e[0].y+=s/2,e[1].x+=(n<<5)/2,e[1].y+=s/2)}insertZerosToArray(t,e,i){let r=Math.floor(i/6e4);for(let i=0;i<r;i++)t.splice(e+6e4*i,0,...Array(6e4).fill(0));t.splice(e+6e4*r,0,...Array(i%6e4).fill(0))}getContext(t){t.width=1,t.height=1;let e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(this.cw<<5)/e,t.height=this.ch/e;let i=t.getContext("2d");return i.fillStyle=i.strokeStyle="red",i.textAlign="center",{context:i,ratio:e,canvas:t}}place(t,e,i,r){let n=!1;if(this.shouldShrinkContinue()&&(e.width>this._size[0]||e.height>this._size[1]))return this._placeStatus=1,!1;let s=.5>this.random()?1:-1;if(!this.shouldShrinkContinue()&&this.isSizeLargerThanMax(e,s))return null;let a=e.x,o=e.y,l=Math.sqrt(this._size[0]*this._size[0]+this._size[1]*this._size[1]),h=this.spiral(this._size),u,d,c,p,g=-s;for(this._tTemp=null,this._dtTemp=null;u=h(g+=s);){d=u[0];let h=Math.sqrt(d**2+(c=u[1])**2),f=Math.atan(c/d);d<0?f+=Math.PI:c<0&&(f=2*Math.PI+f);let m=this.shape(f);if(Math.min(Math.abs(d),Math.abs(c))>=l)break;if(h>=r)n&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=s);else{if(e.x=a+~~(h*m*Math.cos(-f)),e.y=o+~~(h*m*Math.sin(-f)),p=e,this.options.clip){if(this.shouldShrinkContinue()){if(I1(p,this._size)){n&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=s);continue}}else{if(I0(p,this._size)){n&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=s);continue}I1(p,this._size)&&(p=function(t,e){let i=t.sprite,r=t.y1-t.y0,n=t.width>>5,s=0,a=[],o=Math.max(-(t.y0+t.y),0),l=Math.min(r+(e[1]-(t.y1+t.y)),r),h=Math.max(-(t.x0+t.x),0)>>5,u=Math.min(n+(e[0]-(t.x1+t.x)>>5)+1,n);for(let t=0;t<r;t++){for(let e=0;e<n;e++)t<o||l<=t||e<h||u<=e||a.push(i[s+e]);s+=n}let d=h<<5,c=n-u<<5,p=r-l;return Object.assign(Object.assign({},t),{width:t.width-d-c,height:t.height-o-p,x0:t.x0+d,x1:t.x1-c,y0:t.y0+o,y1:t.y1-p,x:t.x+d/2-c/2,sprite:a})}(p,this._size))}}else if(I1(p,this._size)){n&&null===this._tTemp&&(this._tTemp=g,this._dtTemp=s);continue}if(n=!0,(!i||function(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}(p,i))&&(!i||!function(t,e,i){let r=i[0]>>5,n=t.sprite,s=t.width>>5,a=t.x-(s<<4),o=127&a,l=32-o,h=t.y1-t.y0,u,d=(t.y+t.y0)*r+(a>>5);for(let t=0;t<h;t++){u=0;for(let i=0;i<=s;i++)if((u<<l|(i<s?(u=n[t*s+i])>>>o:0))&e[d+i])return!0;d+=r}return!1}(p,t,this._size))){let i=p.sprite,r=p.width>>5,n=this._size[0]>>5,s=p.x-(r<<4),a=127&s,o=32-a,l=p.y1-p.y0,h,u=(p.y+p.y0)*n+(s>>5);for(let e=0;e<l;e++){h=0;for(let n=0;n<=r;n++)t[u+n]|=h<<o|(n<r?(h=i[e*r+n])>>>a:0);u+=n}return e.sprite=null,p.sprite=null,!0}}}return null!==this._tTemp&&(this._placeStatus=3),this.shouldShrinkContinue()||this.setCache(p,s),!1}clearCache(){this.cacheMap.clear()}setCache(t,e){let i=`${t.angle}-${e}`,r=t.x1-t.x0,n=t.y1-t.y0;if(!this.cacheMap.has(i))return void this.cacheMap.set(i,{width:r,height:n});let{width:s,height:a}=this.cacheMap.get(i);(r<s&&n<a||r<=s&&n<a)&&this.cacheMap.set(i,{width:r,height:n})}isSizeLargerThanMax(t,e){let i=`${t.angle}-${e}`;if(!this.cacheMap.has(i))return!1;let{width:r,height:n}=this.cacheMap.get(i),s=t.x1-t.x0,a=t.y1-t.y0;return s>=r&&a>=n}}IQ.defaultOptions={enlarge:!1,minFontSize:2};let I0=(t,e)=>t.x+t.x0>e[0]||t.y+t.y0>e[0]||t.x+t.x1<0||t.y+t.y1<0,I1=(t,e)=>t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>e[0]||t.y+t.y1>e[1];class I2 extends Iq{constructor(t){super(eF({},I2.defaultOptions,t)),this.fillGridAt=(t,e)=>{t>=this.ngx||e>=this.ngy||t<0||e<0||(this.grid[t][e]=!1)},this.updateGrid=(t,e,i,r,n)=>{let s=n.occupied,a=s.length;for(;a--;){let i=t+s[a][0],r=e+s[a][1];i>=this.ngx||r>=this.ngy||i<0||r<0||this.fillGridAt(i,r)}},this.gridSize=Math.max(Math.floor(this.options.gridSize),4)}getPointsAtRadius(t){if(this.pointsAtRadius[t])return this.pointsAtRadius[t];let e=8*t,i=e,r=[];for(0===t&&r.push([this.center[0],this.center[1],0]);i--;){let n=this.shape(i/e*2*Math.PI);r.push([this.center[0]+t*n*Math.cos(-i/e*2*Math.PI),this.center[1]+t*n*Math.sin(-i/e*2*Math.PI)*this.options.ellipticity,i/e*2*Math.PI])}return this.pointsAtRadius[t]=r,r}getTextInfo(t,e=1,i){var r;let n=this.options.clip?1:e,s=Math.max(Math.floor(this.getTextFontSize(t)*n),this.options.minFontSize),a=this.getText(t)+"";if(this.options.clip&&(a=a.slice(0,Math.ceil(a.length*e))),!a)return null;let o=this.getTextFontWeight(t),l=this.getTextFontStyle(t),h=this.getTextRotate&&null!==(r=this.getTextRotate(t,i))&&void 0!==r?r:0,u=this.getTextFontFamily(t),d=document.createElement("canvas"),c=d.getContext("2d",{willReadFrequently:!0});c.font=l+" "+o+" "+s.toString(10)+"px "+u;let p=c.measureText(a).width,g=Math.max(s,c.measureText("m").width,c.measureText("\uFF37").width),f=p+2*g,m=3*g,v=Math.ceil(f/this.gridSize),y=Math.ceil(m/this.gridSize);f=v*this.gridSize;let _=-p/2,b=-(.4*g),x=Math.ceil((f*Math.abs(Math.sin(h))+(m=y*this.gridSize)*Math.abs(Math.cos(h)))/this.gridSize),S=Math.ceil((f*Math.abs(Math.cos(h))+m*Math.abs(Math.sin(h)))/this.gridSize),k=S*this.gridSize,A=x*this.gridSize;d.setAttribute("width",""+k),d.setAttribute("height",""+A),c.scale(1,1),c.translate(k/2,A/2),c.rotate(-h),c.font=l+" "+o+" "+s.toString(10)+"px "+u,c.fillStyle="#000",c.textBaseline="middle",c.fillText(a,_,b);let w=c.getImageData(0,0,k,A).data;if(this.exceedTime())return null;let M=[],C,T=S,E=[x/2,S/2,x/2,S/2],O=(t,e,i)=>{let r=this.gridSize;for(;r--;){let n=this.gridSize;for(;n--;)if(w[4*((e*this.gridSize+r)*k+(t*this.gridSize+n))+3])return i.push([t,e]),t<E[3]&&(E[3]=t),t>E[1]&&(E[1]=t),e<E[0]&&(E[0]=e),void(e>E[2]&&(E[2]=e))}};for(;T--;)for(C=x;C--;)O(T,C,M);return{datum:t,occupied:M,bounds:E,gw:S,gh:x,fillTextOffsetX:_,fillTextOffsetY:b,fillTextWidth:p,fillTextHeight:g,fontSize:s,fontStyle:l,fontWeight:o,fontFamily:u,angle:h,text:a}}canFitText(t,e,i,r,n){let s=n.length;for(;s--;){let i=t+n[s][0],r=e+n[s][1];if(i>=this.ngx||r>=this.ngy||i<0||r<0){if(!this.options.drawOutOfBound)return!1}else if(!this.grid[i][r])return!1}return!0}layoutWord(t,e=1){let i=this.data[t],r=this.getTextInfo(i,e,t);if(!r||this.exceedTime())return!1;if(!this.options.drawOutOfBound&&(!this.options.shrink||r.fontSize<=this.options.minFontSize)&&!this.options.clip){let t=r.bounds;if(t[1]-t[3]+1>this.ngx||t[2]-t[0]+1>this.ngy)return!1}let n=this.maxRadius+1,s=t=>{let e=Math.floor(t[0]-r.gw/2),i=Math.floor(t[1]-r.gh/2),s=r.gw,a=r.gh;return!!this.canFitText(e,i,s,a,r.occupied)&&(r.distance=this.maxRadius-n,r.theta=t[2],this.outputText(e,i,r),this.updateGrid(e,i,s,a,r),!0)};for(;n--;){let t=this.getPointsAtRadius(this.maxRadius-n);if(this.options.random&&ox(t=[].concat(t)),t.some(s))return!0}return(this.options.clip||!!(this.options.shrink&&r.fontSize>this.options.minFontSize))&&this.layoutWord(t,.75*e)}outputText(t,e,i){let r=this.getTextColor(i),n={text:i.text,datum:i.datum,color:r,fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontFamily:i.fontFamily,angle:i.angle,width:i.fillTextWidth,height:i.fillTextHeight,x:(t+i.gw/2)*this.gridSize,y:(e+i.gh/2)*this.gridSize+i.fillTextOffsetY+.5*i.fontSize,fontSize:i.fontSize};this.result.push(n),this.progressiveResult&&this.progressiveResult.push(n)}initGrid(t){let e;if(this.grid=[],t){let i=document.createElement("canvas").getContext("2d");i.fillStyle=this.options.backgroundColor,i.fillRect(0,0,1,1);let r=i.getImageData(0,0,1,1).data,n=t.getContext("2d").getImageData(0,0,this.ngx*this.gridSize,this.ngy*this.gridSize).data,s=(t,i)=>{let s=this.gridSize;for(;s--;){let a=this.gridSize;for(;a--;)for(e=4;e--;)if(n[4*((i*this.gridSize+s)*this.ngx*this.gridSize+(t*this.gridSize+a))+e]!==r[e])return void(this.grid[t][i]=!1)}},a=this.ngx;for(;a--;){this.grid[a]=[];let t=this.ngy;for(;t--;)s(a,t),!1!==this.grid[a][t]&&(this.grid[a][t]=!0)}n=i=r=void 0}else{let t=this.ngx;for(;t--;){this.grid[t]=[];let e=this.ngy;for(;e--;)this.grid[t][e]=!0}}}layout(t,e){this.initProgressive(),this.data=t,this.pointsAtRadius=[],this.ngx=Math.floor(e.width/this.gridSize),this.ngy=Math.floor(e.height/this.gridSize);let{center:i,maxRadius:r}=IY(this.options.shape,[e.width,e.height]);this.center=e.origin?[e.origin[0]/this.gridSize,e.origin[1]/this.gridSize]:[i[0]/this.gridSize,i[1]/this.gridSize],this.maxRadius=Math.floor(r/this.gridSize),this.initGrid(e.canvas),this.result=[];let n=0;for(;n<t.length&&(this.layoutWord(n),n++,this.progressiveIndex=n,!this.exceedTime()););return this.result}}I2.defaultOptions={gridSize:8,ellipticity:1};class I3 extends Iq{constructor(t){super(eF({},I3.defaultOptions,t)),this.random=this.options.random?Math.random:()=>0,this.aspectRatio=1}fit(t){for(let e=0,i=this.result.length;e<i;e++)if(function(t,e){return!(t.left+t.width<e.left||t.top+t.height<e.top||t.left>e.left+e.width||t.top>e.top+e.height)}(t,this.result[e]))return!1;return!0}getTextInfo(t,e){let i={datum:t,fontSize:this.getTextFontSize(t),fontWeight:this.getTextFontWeight(t),fontStyle:this.getTextFontStyle(t),fontFamily:this.getTextFontFamily(t),angle:this.getTextRotate(t,e),text:this.getText(t)+"",x:this.center[0],y:this.center[1]},r=ye(i);return i.width=r.width(),i.height=r.height(),i.top=this.center[1]-i.height+.21*i.height,i.left=this.center[0]-i.width/2,i}layoutWord(t){let e=this.getTextInfo(this.data[t],t),i=2*Math.PI,r=0,n=e.left,s=e.top,a=e.width,o=e.height,l=1,h=this.fit(e);for(;!h&&r<this.maxRadius;)r+=.5,l=this.shape(r/this.maxRadius*2*Math.PI),i+=.5*(this.options.random?this.random()>.5?1:-1:t%2==0?1:-1),n=this.center[0]-a/2+r*l*Math.cos(i)*this.aspectRatio,s=this.center[1]-o/2+r*l*Math.sin(i),e.left=n,e.top=s,e.x=n+a/2,e.y=s+o/2,h=this.fit(e);return!!h&&!!(this.options.clip||e.left>=0&&e.left+e.width<=this.width&&e.top>=0&&e.top+e.height<=this.height)&&(this.result.push(e),!0)}layout(t,e){if(!(null==t?void 0:t.length))return[];this.initProgressive(),this.result=[],this.maxRadius=Math.sqrt(e.width*e.width+e.height*e.height)/2,this.center=[e.width/2,e.height/2],this.width=e.width,this.height=e.height,this.data=t.sort((t,e)=>this.getTextFontSize(e)-this.getTextFontSize(t));let i=0;for(;i<t.length&&(this.layoutWord(i),i++,this.progressiveIndex=i,!this.exceedTime()););return this.result}}I3.defaultOptions={enlarge:!1};let I5={x:"x",y:"y",z:"z",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle"},I4=(t,e)=>{var i,r,n,s,a,o;if(t.size&&(t.size[0]<=0||t.size[1]<=0))return ex.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];let l=(null!==(i=t.size)&&void 0!==i?i:[500,500]).slice();l[0]=Math.floor(l[0]),l[1]=Math.floor(l[1]);let h=t.fontFamily?I8(t.fontFamily):"sans-serif",u=t.fontStyle?I8(t.fontStyle):"normal",d=t.fontWeight?I8(t.fontWeight):"normal",c=t.rotate?I8(t.rotate):0,p=I8(t.text),g=null!==(r=t.spiral)&&void 0!==r?r:"archimedean",f=t.padding?I8(t.padding):1,m=null!==(n=t.shape)&&void 0!==n?n:"square",v=null!==(s=t.shrink)&&void 0!==s&&s,y=null!==(a=t.enlarge)&&void 0!==a&&a,_=null!==(o=t.clip)&&void 0!==o&&o,b=t.minFontSize,x=t.randomVisible,S=t.as||I5,k=t.depth_3d,A=t.postProjection,w=t.fontSize?I8(t.fontSize):14,M=t.fontSizeRange;if(M&&!ey(w)){let t=w,i=I9(I7(t,e),M);w=e=>i(t(e))}let C=IQ;"fast"===t.layoutType?C=I3:"grid"===t.layoutType&&(C=I2);let T=new C({text:p,padding:f,spiral:g,shape:m,rotate:c,fontFamily:h,fontStyle:u,fontWeight:d,fontSize:w,shrink:v,clip:_,enlarge:y,minFontSize:b,random:x,progressiveStep:t.progressiveStep,progressiveTime:t.progressiveTime,outputCallback:t=>{let e,i;let r=[];for(let n=0,s=t.length;n<s;n++)(e=(i=t[n]).datum)[S.x]=i.x,e[S.y]=i.y,e[S.fontFamily]=i.fontFamily,e[S.fontSize]=i.fontSize,e[S.fontStyle]=i.fontStyle,e[S.fontWeight]=i.fontWeight,e[S.angle]=i.angle,"StereographicProjection"===A&&function(t,e,i,r,n){let s=Math.max(t[0],t[1])/2,a=function(t,e,i,r,n){let{x:s,y:a}=n,o=s/t*Math.PI*2,l=Math.PI-a/e*Math.PI;return l+=(l<Math.PI/2?1:-1)*Math.pow(Math.min(l-Math.PI/2,1),2)/5,{x:i*Math.sin(l)*Math.cos(o)+r.x,y:i*Math.cos(l)+r.y,z:i*Math.sin(l)*Math.sin(o)+r.z}}(t[0],t[1],s,{x:s,y:s,z:null!=n?n:s},e);i[r.x]=a.x,i[r.y]=a.y,i[r.z]=a.z}(l,i,e,S,k),r.push(e);return r}});return T.layout(e,{width:l[0],height:l[1]}),t.progressiveStep>0||t.progressiveTime>0?{progressive:T}:T.output()},I8=t=>eE(t)||ey(t)||nx(t)||eM(t)?t:e=>e[t.field],I6=t=>t<0?-Math.sqrt(-t):Math.sqrt(t),I9=(t,e)=>{if(t[0]===t[1])return t=>e[0];let i=I6(t[0]),r=I6(t[1]),n=Math.min(i,r),s=Math.max(i,r);return t=>(I6(t)-n)/(s-n)*(e[1]-e[0])+e[0]},I7=(t,e)=>{let i,r=1/0,n=-Infinity,s=e.length;for(let a=0;a<s;++a)(i=dy(t(e[a])))<r&&(r=i),i>n&&(n=i);return 1===e.length&&r===n&&(r-=1e4),[r,n]},Lt=()=>{d0.registerTransform("wordcloud",{transform:I4,markPhase:"beforeJoin"},!0)};(tV=t9||(t9={})).BEFORE_WORDCLOUD_SHAPE_LAYOUT="beforeWordcloudShapeLayout",tV.AFTER_WORDCLOUD_SHAPE_LAYOUT="afterWordcloudShapeLayout";let Le=(t,e)=>{if(1===e.length&&"#537EF5"===e[0])return!0;if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},Li=()=>{let t=-1,e=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9];return()=>(t=(t+1)%e.length,e[t])},Lr=t=>/^[\u4e00-\u9fa5]+$/.test(t),Ln=(t,e)=>{if(ej(t))return 0;let i=0;for(let e of t)Lr(e)?i+=1:i+=.53;return i};function Ls(t,e,i){let r=t.width;return 0===t.data[e*r*4+4*i+3]||255===t.data[e*r*4+4*i+0]&&255===t.data[e*r*4+4*i+1]&&255===t.data[e*r*4+4*i+2]}function La(t,e,i){for(let r=0;r<e;++r)if(!Ls(t,i,r))return!1;return!0}function Lo(t,e,i,r,n){for(let e=r;e<n;++e)if(!Ls(t,e,i))return!1;return!0}class Ll extends x1{constructor(){super(xa,xo),this.type=c0.Sqrt}clone(){return(new Ll).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}}function Lh(t,e,i){let{stepFactor:r,importantWordCount:n,globalShinkLimit:s}=e,{size:a,segmentation:{regions:o},tempCtx:l,tempCanvas:h,boardSize:u,shapeCenter:d,shapeMaxR:c,shapeRatio:p}=i,g=Lg(i),f=g.slice(0),m=e.fontSizeShrinkFactor,v=null,y=1,_=1,b=0;t.length>n&&(b=t.sort((t,e)=>e.weight-t.weight)[n].weight);for(let e=0;e<o.length;e++){let{words:i,center:n,maxR:d,ratio:c}=o[e],p=!1;for(let e=0;e<i.length;e++){Lp(h,l,t,e);let o=i[e];if(o.x=n[0],o.y=n[1],!o.skip&&o.hasText&&o.sprite&&Lu(f,o,d,c,a,u,r))o.hasPlaced=!0;else{if(!o.skip&&o.weight>b&&_>s){let e=o.datum[Symbol.for("vGrammar_id")];e!==v&&(v=e,y=_),_*=m,t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*m}),f=g.slice(0),p=!0;break}if(!o.skip&&o.datum[Symbol.for("vGrammar_id")]===v){t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/_}),o.skip=!0,_=y,v=null,f=g.slice(0),p=!0;break}}}p&&(e=-1)}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];Lp(h,l,i,t),e.x=d[0],e.y=d[1],e.hasText&&Lu(f,e,c,p,a,u,r)&&(e.hasPlaced=!0)}}e.board=f}function Lu(t,e,i,r,n,s,a){let o=e.x,l=e.y,h=function(t){return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}(r),u=1*a,d,c,p,g=-u;for(;d=h(g+=u);){let{wordSize:r,bounds:{dTop:a,dBottom:h,dLeft:u,dRight:g}}=e;if(c=d[0],Math.min(Math.abs(c),Math.abs(p=d[1]))>=i)break;if(e.x=~~(o+c),e.y=~~(l+p),!(e.x-u<0||e.x+g>n[0]||e.y-a<0||e.y+h>n[1]||Lc(e,t,s)))return Ld(e,t,s),!0}return!1}function Ld(t,e,i){let{wordSize:r}=t,n=t.sprite,s=r[0]>>5,a=i[0]>>5,o=t.x-(s<<4),l=o%32,h=32-l,u=r[1],d,c=(t.y-(r[1]>>1))*a+(o>>5);if(0===l)for(let t=0;t<u;t++){for(let i=0;i<s;i++)e[c+i]|=n[t*s+i];c+=a}else for(let t=0;t<u;t++){d=0;for(let i=0;i<=s;i++)e[c+i]|=d<<h|(i<s?(d=n[t*s+i])>>>l:0);c+=a}}function Lc(t,e,i){let{sprite:r,wordSize:n}=t,s=i[0]>>5,a=n[0]>>5,o=t.x-(a<<4),l=o%32,h=32-l,u=n[1],d,c=(t.y-(n[1]>>1))*s+(o>>5);if(0===l)for(let t=0;t<u;t++){for(let i=0;i<a;i++)if(e[c+i]&r[t*a+i])return!0;c+=s}else for(let t=0;t<u;t++){d=0;for(let i=0;i<=a;i++)if((d<<h|(i<a?(d=r[t*a+i])>>>l:0))&e[c+i])return!0;c+=s}return!1}function Lp(t,e,i,r){let n,s;if(i[r].sprite||0===i[r].fontSize)return;let a=Math.PI/180,o=i.length;t.width=2048,t.height=2048,e.clearRect(0,0,2048,2048),e.textAlign="center";let l,h,u=0,d=0,c=0,p=0,g=r;for(--r;++r<o;){let t=i[r],n=Math.max(t.fontSize,2);if(e.save(),e.font=t.fontStyle+" "+t.fontWeight+" "+n+"px "+t.fontFamily,l=e.measureText(t.text+"m").width+2*t.padding,h=2*n+2*t.padding,0!==t.rotate){let e=Math.sin(t.rotate*a),i=Math.cos(t.rotate*a),r=l*i,n=l*e,s=h*i,o=h*e;l=Math.max(Math.abs(r+o),Math.abs(r-o)),h=~~Math.max(Math.abs(n+s),Math.abs(n-s))}if(l=l+31>>5<<5,(h=Math.ceil(h))>c&&(c=h),u+l>=2048&&(u=0,d+=c,c=h),d+h>=2048){if(0===d){t.hasText=!1;continue}break}d+h>=p&&(p=d+h),e.translate(u+(l>>1),d+(h>>1)),0!==t.rotate&&e.rotate(t.rotate*a),e.fillText(t.text,0,0),t.padding&&(e.lineWidth=2*t.padding,e.strokeText(t.text,0,0)),e.restore(),t.LT=[u,d],t.wordSize=[l,h],t.hasText=!0,u+=l}if(0===p)return;let f=e.getImageData(0,0,2048,p).data;for(;--r>=g;){let t=i[r];if(!t.hasText){t.bounds={dTop:1/0,dBottom:-Infinity,dLeft:1/0,dRight:-Infinity};break}let{LT:e=[0,0],wordSize:a}=t;[u,d]=e;let o=a[0]>>5,l=Array(o*a[1]).fill(0),[h,c,p,g]=[1/0,-Infinity,1/0,-Infinity];for(s=0;s<a[1];s++){let t;for(n=0;n<a[0];n++)if(f[4*((d+s)*2048+(u+n))+3]>0){let e=1<<31-n%32;l[o*s+(n>>5)]|=e,n<p&&(p=n),n>g&&(g=n),t|=e}t&&(s<h&&(h=s),s>c&&(c=s))}t.bounds={dTop:(a[1]>>1)-h,dBottom:c-(a[1]>>1),dLeft:(a[0]>>1)-p,dRight:g-(a[0]>>1)},t.sprite=l,delete t.LT}}function Lg(t){let{segmentation:{labels:e},boardSize:i,size:r}=t,n=i[0]>>5,s=Array(n*r[1]).fill(0);for(let t=0;t<r[1];t++)for(let i=0;i<r[0];i++)if(0===e[t*r[0]+i]){let e=1<<31-i%32;s[n*t+(i>>5)]|=e}if(i[0]>r[0]){let t=(1<<i[0]-r[0])-1;for(let e=0;e<r[1];e++)s[n*e+n-1]|=t}return s}let Lf={x:"x",y:"y",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle",opacity:"opacity",visible:"visible",isFillingWord:"isFillingWord",color:"color"};class Lm{constructor(t,e){this.progressiveResult=[],this.options=t,this.view=e}layout(t){this.data=t;let e=this.options,i={shapeUrl:e.shape,size:e.size,ratio:e.ratio||.8,tempCanvas:void 0,tempCtx:void 0,removeWhiteBorder:e.removeWhiteBorder||!1,boardSize:[0,0],random:!1,randomGenerator:void 0},r=lX.createCanvas({width:e.size[0],height:e.size[1]}),n=r.getContext("2d");n.textAlign="center",n.textBaseline="middle",i.tempCanvas=r,i.tempCtx=n;let s=e.size[0]+31>>5<<5;i.boardSize=[s,e.size[1]],i.random?i.randomGenerator=Math.random:i.randomGenerator=Li();let a=function(t){var e;let i=(e=t.shapeUrl)&&(ny(e)||n_(e)||e.startsWith("<svg"))?new Promise((t,i)=>{var r;let n=ks({image:e}),s=null===(r=n.resources)||void 0===r?void 0:r.get(e);s&&"success"===s.state&&s.data?t(s.data):(n.successCallback=()=>{var r;if(n){let s=null===(r=n.resources)||void 0===r?void 0:r.get(e);s&&"success"===s.state&&s.data?t(s.data):i(Error("image load failed"+e))}else i(Error("image load failed"+e))},n.failCallback=()=>{ex.getInstance().error("image \u52A0\u8F7D\u5931\u8D25\uFF01",e)})}):null;return i?i.then(e=>t&&t.removeWhiteBorder&&e?function(t,e,i){e.width=t.width,e.height=t.height,i.clearRect(0,0,e.width,e.height),i.drawImage(t,0,0);let r=e.width,n=i.getImageData(0,0,e.width,e.height),s=0,a=n.height,o=0,l=n.width;for(;s<a&&La(n,r,s);)++s;for(;a-1>s&&La(n,r,a-1);)--a;for(;o<l&&Lo(n,r,o,s,a);)++o;for(;l-1>o&&Lo(n,r,l-1,s,a);)--l;let h=i.getImageData(o,s,l-o,a-s);return e.width=h.width,e.height=h.height,i.clearRect(0,0,e.width,e.height),i.putImageData(h,0,0),e}(e,t.tempCanvas,t.tempCtx):e):null}(i);a?(this.segmentationInput=i,this.isImageFinished=!1,this.isLayoutFinished=!1,a.then(t=>{this.shapeImage=t,this.isImageFinished=!0}).catch(t=>{this.shapeImage=null,this.isImageFinished=!0})):(this.isImageFinished=!0,this.isLayoutFinished=!0)}unfinished(){return!this.isLayoutFinished}output(){return this.progressiveResult}progressiveRun(){this.isImageFinished&&!this.isLayoutFinished&&(this.shapeImage&&this.doLayout(),this.isLayoutFinished=!0)}progressiveOutput(){return this.progressiveResult}doLayout(){var t,e,i;let r,n;let s=this.segmentationInput,a=function(t,e){let{size:i,tempCanvas:r,tempCtx:n}=e,s=function(t,e){let i=t.width,r=t.height,n=e[0]/i;r*n>e[1]&&(n=e[1]/r);let s=Math.floor(n*i),a=Math.floor(n*r);return{x:(e[0]-s)/2,y:(e[1]-a)/2,width:s,height:a,scale:n}}(t,i);r.width=i[0],r.height=i[1],n.clearRect(0,0,r.width,r.height),n.drawImage(t,s.x,s.y,s.width,s.height);let a=n.getImageData(0,0,i[0],i[1]),o=Array(i[0]*i[1]).fill(0),l=1,h=[[0,1],[1,0],[-1,0],[0,-1]],u=[];for(let t=0;t<i[1];t++)for(let e=0;e<i[0];e++)if(0===o[t*i[0]+e]&&!Ls(a,t,e)){o[t*i[0]+e]=l,u.push([t,e]);for(let t=0;t<u.length;t++)for(let e=0;e<4;e++){let r=u[t][0]+h[e][0],n=u[t][1]+h[e][1];r=r<0?0:r>=i[1]?i[1]-1:r,n=n<0?0:n>=i[0]?i[0]-1:n,0!==o[r*i[0]+n]||Ls(a,r,n)||(o[r*i[0]+n]=l,u.push([r,n]))}l++,u=[]}let d={},c={},p={},g={},f={},m={},v={x1:1/0,x2:-Infinity,y1:1/0,y2:-Infinity,width:0,height:0};for(let t=0;t<i[1];t++)for(let e=0;e<i[0];e++){let r=o[t*i[0]+e];0!==r&&(function(t,e){let r=[[0,1],[1,0],[-1,0],[0,-1]];if(0===t||0===e||t===i[1]-1||e===i[0]-1)return!0;for(let n=0;n<4;n++){let s=t+r[n][0],a=e+r[n][1];if(s=s<0?0:s>=i[1]?i[1]-1:s,a=a<0?0:a>=i[0]?i[0]-1:a,0===o[s*i[0]+a])return!0}return!1}(t,e)&&(d[r]=d[r]||[],d[r].push([e,t]),g[r]||(g[r]=[1/0,-Infinity,1/0,-Infinity]),t<g[r][0]&&(g[r][0]=t),t>g[r][1]&&(g[r][1]=t),e<g[r][2]&&(g[r][2]=e),e>g[r][3]&&(g[r][3]=e),e<v.x1&&(v.x1=e),e>v.x2&&(v.x2=e),t<v.y1&&(v.y1=t),t>v.y2&&(v.y2=t)),c[r]=c[r]||0,c[r]++)}let y=[];for(let t in d){let e=d[t],i=~~(e.reduce((t,e)=>t+e[0],0)/e.length),r=~~(e.reduce((t,e)=>t+e[1],0)/e.length);p[t]=[i,r],y.push(...e);let[n,s,a,o]=g[t];f[t]=~~Math.max(Math.sqrt((i-a)**2+(r-n)**2),Math.sqrt((i-o)**2+(r-s)**2),Math.sqrt((i-a)**2+(r-s)**2),Math.sqrt((i-o)**2+(r-n)**2)),m[t]=(o-a)/(s-n)}let _=Object.keys(p).map(t=>({label:t-1,boundary:d[t],area:c[t],center:p[t],maxPoint:g[t],maxR:f[t],ratio:m[t]}));v.width=v.x2-v.x1+1,v.height=v.y2-v.y1+1;let b=~~(y.reduce((t,e)=>t+e[0],0)/y.length),x=~~(y.reduce((t,e)=>t+e[1],0)/y.length),S=~~Math.max(Math.sqrt((b-v.x1)**2+(x-v.y1)**2),Math.sqrt((b-v.x2)**2+(x-v.y2)**2),Math.sqrt((b-v.x1)**2+(x-v.y2)**2),Math.sqrt((b-v.x2)**2+(x-v.y1)**2)),k=v.width/v.height,A=Object.keys(c).reduce((t,e)=>t+c[e],0);return Object.assign(e,{segmentation:{regions:_,labels:o,labelNumber:l-1},shapeConfig:s,shapeBounds:v,shapeMaxR:S,shapeRatio:k,shapeCenter:[b,x],shapeArea:A})}(this.shapeImage,s),o=this.options,l=this.data,h=o.colorMode||"ordinal",u={getText:Lx(o.text),getFontSize:Lx(o.fontSize),fontSizeRange:o.fontSizeRange,colorMode:h,getColor:o.colorField?Lx(o.colorField):Lx(o.text),getFillingColor:Lx(o.fillingColorField),colorList:o.colorList||("ordinal"===h?["#2E62F1"]:["#537EF5","#2E62F1","#2358D8","#184FBF","#0C45A6","#013B8E"]),getColorHex:Lx(o.colorHexField),getFontFamily:Lx(o.fontFamily||"sans-serif"),rotateList:o.rotateList||[0],getPadding:Lx(o.padding||1),getFontStyle:Lx(o.fontStyle||"normal"),getFontWeight:Lx(o.fontWeight||"normal"),getFontOpacity:o.fontOpacity?Lx(o.fontOpacity):()=>1};Ly(l,u,a);let d={size:o.size,ratio:o.ratio||.8,shapeUrl:o.shape,random:void 0===o.random||o.random,textLayoutTimes:o.textLayoutTimes||3,removeWhiteBorder:o.removeWhiteBorder||!1,layoutMode:o.layoutMode||"default",fontSizeShrinkFactor:o.fontSizeShrinkFactor||.8,stepFactor:o.stepFactor||1,importantWordCount:o.importantWordCount||10,globalShinkLimit:o.globalShinkLimit||.2,fontSizeEnlargeFactor:o.fontSizeEnlargeFactor||1.5,fillingRatio:o.fillingRatio||.7,fillingTimes:o.fillingTimes||4,fillingXStep:o.fillingXRatioStep?Math.max(Math.floor(o.size[0]*o.fillingXRatioStep),1):o.fillingXStep||4,fillingYStep:o.fillingYRatioStep?Math.max(Math.floor(o.size[1]*o.fillingYRatioStep),1):o.fillingYStep||4,fillingInitialFontSize:o.fillingInitialFontSize,fillingDeltaFontSize:o.fillingDeltaFontSize,fillingInitialOpacity:o.fillingInitialOpacity||.8,fillingDeltaOpacity:o.fillingDeltaOpacity||.05,getFillingFontFamily:Lx(o.fillingFontFamily||"sans-serif"),getFillingFontStyle:Lx(o.fillingFontStyle||"normal"),getFillingFontWeight:Lx(o.fillingFontWeight||"normal"),getFillingPadding:Lx(o.fillingPadding||.4),fillingRotateList:o.fillingRotateList||[0,90],fillingDeltaFontSizeFactor:o.fillingDeltaFontSizeFactor||.2,fillingColorList:o.fillingColorList||["#537EF5"],sameColorList:!1,minInitFontSize:o.minInitFontSize||10,minFontSize:o.minFontSize||4,minFillFoontSize:o.minFillFoontSize||2},c=Le(u.colorList,d.fillingColorList);d.sameColorList=c,Lv(l,u,d,o),function(t,e,i,r){let{getText:n}=e,{fillingInitialFontSize:s,fillingDeltaFontSize:a}=i,{fillingRatio:o}=i,l=Math.ceil(Math.sqrt(r.shapeArea)/4);if(!s||!a){let e;let h=t.reduce((t,e)=>{let i=Ln(n(e));return i>l?t:t+i},0)/t.length;s=~~(e=0===h?8:Math.sqrt(.2*r.shapeArea/h*(o/100))),a=e*i.fillingDeltaFontSizeFactor,Object.assign(i,{fillingInitialFontSize:s,fillingDeltaFontSize:a})}}(l,u,d,a);let{getText:p,getFontFamily:g,getFontStyle:f,getFontWeight:m,getPadding:v,getColor:y,getFillingColor:_,getColorHex:b,fontSizeScale:x,colorScale:S,fillingColorScale:k,getFontOpacity:A,rotateList:w}=u,M=l.map(t=>{var e,i;return{x:0,y:0,weight:0,text:p(t),fontFamily:g(t),fontWeight:m(t),fontStyle:f(t),rotate:w[~~(s.randomGenerator()*w.length)],fontSize:Math.max(d.minInitFontSize,~~x(t)),opacity:A(t),padding:v(t),color:b&&b(t)||S&&S(y(t))||"black",fillingColor:!_||(null===(e=o.colorField)||void 0===e?void 0:e.field)===(null===(i=o.fillingColorField)||void 0===i?void 0:i.field)&&c?void 0:b&&b(t)||k&&k(_(t))||"black",datum:t,visible:!0,hasPlaced:!1}}),C=oy(M.map(t=>t.fontSize));M.forEach(t=>t.weight=t.fontSize/C),M.sort((t,e)=>e.weight-t.weight);let{fillingWords:T,successedWords:E,failedWords:O}=function(t,e,i){(function(t,e){let{segmentation:{regions:i}}=e,r=-Infinity,n=0,s=0;i.forEach((t,e)=>{let i=t.area;i>r&&(r=i,s=e),n+=i});let a=0;i.forEach(e=>{let i=e.area,s=Math.ceil(i/n*t.length),o=i/r;e.words=[],e.regionNum=s,e.regionWeight=o,a+=s}),a<t.length&&(i[s].wordsNum+=t.length-a);let o=s,l=i.map(t=>t.regionNum);t.forEach(t=>{let e=0,r=0;t.regionIndex=-1;do{if(l[o]>0&&t.weight<=i[o].regionWeight){t.regionIndex=o,i[o].words.push(t),l[o]--,o=(o+1)%i.length;break}o=(o+1)%i.length,e++,++r>i.length+1&&(i.forEach(t=>{t.regionWeight+=.15}),r=0)}while(-1===t.regionIndex&&e<3*i.length);-1===t.regionIndex&&(t.regionIndex=s,i[s].words.push(t),l[s]--)}),i.forEach(t=>{t.words.sort((t,e)=>e.weight-t.weight)})})(t,i),"ensureMapping"===e.layoutMode?Lh(t,e,i):"ensureMappingEnlarge"===e.layoutMode?function(t,e,i){let{size:r,stepFactor:n,importantWordCount:s}=e,{segmentation:{regions:a},tempCtx:o,tempCanvas:l,boardSize:h,shapeCenter:u,shapeMaxR:d,shapeRatio:c}=i,p=Lg(i),g=p.slice(0),f=e.fontSizeEnlargeFactor,m=Math.min(s,t.length),v=0;t.length>m&&(v=t.sort((t,e)=>e.weight-t.weight)[m-1].weight);let y=0,_=1,b=!1;for(let s=0;s<a.length;s++){let{words:u,center:d,maxR:c,ratio:x}=a[s],S=!1;for(let s=0;s<u.length;s++){Lp(l,o,t,s);let a=u[s];if(a.x=d[0],a.y=d[1],a.hasText&&a.sprite&&Lu(g,a,c,x,r,h,n)){if(a.hasPlaced=!0,a.weight>=v&&y++,y>=m&&!b){_*=f,t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize*f}),g=p.slice(0),S=!0,y=0;break}}else{if(a.weight>=v&&_>1){t.forEach(t=>{t.hasText=!1,t.sprite=null,t.fontSize=t.fontSize/f}),_/=f,b=!0,g=p.slice(0),S=!0;break}if(a.weight>=v)return Lh(t,e,i)}}S&&(s=-1)}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];Lp(l,o,i,t),e.x=u[0],e.y=u[1],e.hasText&&Lu(g,e,d,c,r,h,n)&&(e.hasPlaced=!0)}}e.board=g}(t,e,i):function(t,e,i){let{size:r,stepFactor:n}=e,{segmentation:{regions:s},tempCtx:a,tempCanvas:o,boardSize:l,shapeCenter:h,shapeMaxR:u,shapeRatio:d}=i,c=Lg(i);for(let e of s){let{words:i,center:s,maxR:h,ratio:u}=e;for(let e=0;e<i.length;e++){Lp(o,a,t,e);let d=i[e];d.x=s[0],d.y=s[1],d.hasText&&d.sprite&&Lu(c,d,h,u,r,l,n)&&(d.hasPlaced=!0)}}for(let i=0;i<e.textLayoutTimes;i++){let i=t.filter(t=>(t.hasPlaced||(t.hasText=!1,t.sprite=null,t.fontSize=Math.max(~~(t.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!t.hasPlaced));if(0===i.length)break;for(let t=0;t<i.length;t++){let e=i[t];Lp(o,a,i,t),e.x=h[0],e.y=h[1],e.hasText&&Lu(c,e,u,d,r,l,n)&&(e.hasPlaced=!0)}}e.board=c}(t,e,i);let r=function(t,e,i){let{size:r,fillingTimes:n,fillingXStep:s,fillingYStep:a,getFillingFontStyle:o,getFillingFontWeight:l,getFillingFontFamily:h,fillingInitialFontSize:u,fillingDeltaFontSize:d,fillingInitialOpacity:c,fillingDeltaOpacity:p,fillingRotateList:g,getFillingPadding:f,random:m,board:v,minFillFoontSize:y}=e,{boardSize:_,shapeBounds:b,tempCtx:x,tempCanvas:S,randomGenerator:k}=i,A=u,w=c,M=[];for(let e=0;e<n;e++)(function(e,i){let n=t.map(t=>{let{text:r,color:n,fillingColor:s,hasPlaced:a,datum:u}=t;return{x:0,y:0,weight:0,text:r,fontFamily:h(u),fontStyle:o(u),fontWeight:l(u),fontSize:e,rotate:g[~~(k()*g.length)],padding:f(u),opacity:i,visible:!0,color:n,fillingColor:s,hasPlaced:a,datum:u}});C(n);let u=0,{x1:d,y1:c,x2:p,y2:y}=b,[A,w]=[d+~~(k()*s*2),c+~~(k()*a*2)];for(let t=w;t<=y;t+=a)for(let e=A;e<=p;e+=s){Lp(S,x,n,u);let i=n[u];i.x=e,i.y=t;let{wordSize:s,bounds:a,hasPlaced:o}=i;if(!o||!a){++u===n.length&&(u=0,m&&C(n));continue}let{dTop:l,dBottom:h,dLeft:d,dRight:c}=a;i.x-d<0||i.x+c>r[0]||i.y-l<0||i.y+h>r[1]||i.hasText&&i.sprite&&!Lc(i,v,_)&&(Ld(i,v,_),M.push(Object.assign({},i)),++u===n.length&&(u=0,m&&C(n)))}})(A,w),A=Math.max(A>d?A-d:d,y),w=w>p?w-p:p;return M;function C(t){return t.sort(()=>k()-.5)}}(t,e,i),n=[],s=[];for(let e=0;e<t.length;e++)t[e].hasPlaced?s.push(t[e]):n.push(t[e]);return n.forEach(t=>t.visible=!1),{fillingWords:r,successedWords:s,failedWords:n}}(M,d,a),P=null!==(e=null===(t=o.text)||void 0===t?void 0:t.field)&&void 0!==e?e:"textKey",R=null!==(i=o.dataIndexKey)&&void 0!==i?i:"defaultDataIndexKey",B=o.as||Lf,I=[];for(let t=0;t<M.length;++t)(n=(r=M[t]).datum)[B.x]=r.x,n[B.y]=r.y,n[B.fontFamily]=r.fontFamily,n[B.fontSize]=r.fontSize,n[B.fontStyle]=r.fontStyle,n[B.fontWeight]=r.fontWeight,n[B.angle]=ik(r.rotate),n[B.opacity]=r.opacity,n[B.visible]=r.visible,n[B.isFillingWord]=!1,n[B.color]=r.color,n[R]=`${r.text}_${t}_keyword`,I.push(n);let L=[];T.forEach((t,e)=>{var i,r;let n={};n[B.x]=t.x,n[B.y]=t.y,n[B.fontFamily]=t.fontFamily,n[B.fontSize]=t.fontSize,n[B.fontStyle]=t.fontStyle,n[B.fontWeight]=t.fontWeight,n[B.angle]=ik(t.rotate),n[B.opacity]=t.opacity,n[B.visible]=t.visible,n[B.isFillingWord]=!0,n[B.color]=_?(null===(i=o.colorField)||void 0===i?void 0:i.field)===(null===(r=o.fillingColorField)||void 0===r?void 0:r.field)&&c?t.color:t.fillingColor:d.fillingColorList[~~(s.randomGenerator()*d.fillingColorList.length)],n[P]=t.text,n[R]=`${t.text}_${e}_fillingWords`,L.push(n)}),this.view&&this.view.emit&&this.view.emit(t9.AFTER_WORDCLOUD_SHAPE_LAYOUT,{successedWords:E,failedWords:O}),this.progressiveResult=I.concat(L)}release(){this.segmentationInput=null,this.data=null,this.shapeImage=null,this.progressiveResult=null,this.options=null}}let Lv=(t,e,i,r)=>{var n,s,a,o;let{colorMode:l,getColor:h,getFillingColor:u}=e,{sameColorList:d}=i,c,p,g=e.colorList,f=i.fillingColorList;if("ordinal"===l){let e=t.map(t=>h(t));if(c=t=>(new x3).domain(e).range(g).scale(t),u&&((null===(n=r.colorField)||void 0===n?void 0:n.field)!==(null===(s=r.fillingColorField)||void 0===s?void 0:s.field)||!d)){let e=t.map(t=>u(t));p=t=>(new x3).domain(e).range(f).scale(t)}}else{1===g.length&&(g=[g[0],g[0]]);let e=(new x1).domain(Lb(h,t)).range(g);if(c=t=>e.scale(t),u&&((null===(a=r.colorField)||void 0===a?void 0:a.field)!==(null===(o=r.fillingColorField)||void 0===o?void 0:o.field)||!d)){1===f.length&&(f=[f[0],f[0]]);let e=(new x1).domain(Lb(u,t)).range(f);p=t=>e.scale(t)}}Object.assign(e,{colorScale:c,fillingColorScale:p})},Ly=(t,e,i)=>{let r,{fontSizeRange:n}=e,{getFontSize:s,getText:a}=e;if(s){if(s&&n){let e=(new Ll).domain(Lb(s,t)).range(n);r=t=>e.scale(s(t))}else if(s&&nx(s)&&!n){let[e,o]=Lb(s,t),l=L_(t.map(t=>({text:a(t),value:s(t),weight:o===e?1:(s(t)-e)/(o-e)})),i,!0);n=[~~(.5*l),~~l];let h=(new Ll).domain(Lb(s,t)).range(n);r=t=>h.scale(s(t))}}else{var o;r="function"==typeof(o=L_(t.map(t=>({text:a(t)})),i,!1))?o:function(){return o}}Object.assign(e,{getFontSize:s,fontSizeRange:n,fontSizeScale:r})},L_=(t,e,i)=>{let r=e.shapeArea,n=e.ratio,s=e.segmentation.regions,a=Math.ceil(Math.sqrt(r)/12),o=t.reduce((t,e)=>{let r=Ln(e.text);return r<a?t+r*(i?(.5+.5*e.weight)**2:1):t},0);if(0===o)return 12;let l=20;if(1===s.length)l=Math.sqrt(r/(1.7*o)*n);else{let t=[];for(let e=0;e<s.length;e++){let i=s[e].area,a=s[e].ratio,l=i/r;if(l<.1)continue;let h=Math.sqrt(i/(o*(a<1?2.7-a:1.7)*l)*n);t.push(h)}l=t.length?Math.min(...t):Math.sqrt(r/(1.7*o)*n)}return l},Lb=(t,e)=>{let i,r=1/0,n=-Infinity,s=e.length;for(let a=0;a<s;++a)(i=dy(t(e[a])))<r&&(r=i),i>n&&(n=i);return 1===e.length&&r===n&&(r-=1e4),[r,n]},Lx=t=>t?"string"==typeof t||"number"==typeof t?()=>t:nx(t)?t:e=>e[t.field]:null,LS=(t,e,i,r)=>{if(!t.size||ej(t.size[0])||ej(t.size[1])||t.size[0]<=0||t.size[1]<=0)return ex.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];if(t.size=[Math.ceil(t.size[0]),Math.ceil(t.size[1])],t.shape||fs("WordcloudShape shape must be specified."),t.text||fs("WordcloudShape text must be specified."),(null==r?void 0:r.emit)&&r.emit(t9.BEFORE_WORDCLOUD_SHAPE_LAYOUT),!e||0===e.length)return[];let n=new Lm(t,r);return n.layout(e),n.unfinished()?{progressive:n}:n.output()},Lk=()=>{d0.registerTransform("wordcloudShape",{transform:LS,markPhase:"beforeJoin"},!0)};class LA extends Iz{constructor(){super(...arguments),this.type=cZ.wordCloud}}LA.type=cZ.wordCloud;let Lw=()=>{Lt(),B9(),IW(),de.registerSeries(LA.type,LA)},LM=()=>{Lk(),Lt(),B9(),IW(),de.registerSeries(LA.type,LA)};class LC extends IO{_getDefaultSeriesSpec(t){let e=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{nameField:t.nameField,valueField:t.valueField,seriesField:t.seriesField,fontFamilyField:t.fontFamilyField,fontWeightField:t.fontWeightField,fontStyleField:t.fontStyleField,colorHexField:t.colorHexField,colorMode:t.colorMode,colorList:t.colorList,rotateAngles:t.rotateAngles,fontWeightRange:t.fontWeightRange,fontSizeRange:t.fontSizeRange,maskShape:t.maskShape,keepAspect:t.keepAspect,random:t.random,wordCloudConfig:t.wordCloudConfig,wordCloudShapeConfig:t.wordCloudShapeConfig,word:t.word,fillingWord:t.fillingWord}),i=this.seriesType;return i&&(e.type=i,e[i]=t[i]),e}}class LT extends IP{constructor(){super(...arguments),this.transformerConstructor=LC,this.type="wordCloud",this.seriesType=cZ.wordCloud}}LT.type="wordCloud",LT.seriesType=cZ.wordCloud,LT.transformerConstructor=LC;class LE extends Iz{constructor(){super(...arguments),this.type=cZ.wordCloud3d}_wordCloudTransformOption(){var t;return Object.assign(Object.assign({},super._wordCloudTransformOption()),{postProjection:null!==(t=this._spec.postProjection)&&void 0!==t?t:"StereographicProjection",depth_3d:this._spec.depth_3d})}_wordCloudShapeTransformOption(){var t;return Object.assign(Object.assign({},super._wordCloudShapeTransformOption()),{postProjection:null!==(t=this._spec.postProjection)&&void 0!==t?t:"StereographicProjection",depth_3d:this._spec.depth_3d})}initMark(){this._wordMark=this._createMark(Iz.mark.word,{groupKey:this._seriesField,support3d:!0,isSeriesMark:!0})}initMarkStyle(){super.initMarkStyle();let t=this._wordMark;t&&this.setMarkStyle(t,{z:t=>{var e;return null!==(e=t.z)&&void 0!==e?e:0}},"normal",tw.Series)}initAnimation(){var t,e;let i=null!==(t=this._padding)&&void 0!==t?t:{};this._wordMark&&this._wordMark.setAnimationConfig(CX(null===(e=de.getAnimationInKey("wordCloud3d"))||void 0===e?void 0:e(()=>{var t;let e=this.getCompiler().getVGrammarView(),r=e.width()-i.left||0-i.right||0,n=Math.max(r,e.height()-i.top||0-i.bottom||0)/2;return{center:{x:n,y:n,z:null!==(t=this._spec.depth_3d)&&void 0!==t?t:n},r:n}}),Cq("word",this._spec,this._markAttributeContext)))}}LE.type=cZ.wordCloud3d;let LO=()=>{Lt(),B9(),IG(),de.registerSeries(LE.type,LE)},LP=()=>{Lk(),Lt(),B9(),IG(),de.registerSeries(LE.type,LE)};class LR extends IO{_getDefaultSeriesSpec(t){let e=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{nameField:t.nameField,valueField:t.valueField,seriesField:t.seriesField,fontFamilyField:t.fontFamilyField,fontWeightField:t.fontWeightField,fontStyleField:t.fontStyleField,colorHexField:t.colorHexField,colorMode:t.colorMode,colorList:t.colorList,rotateAngles:t.rotateAngles,fontWeightRange:t.fontWeightRange,fontSizeRange:t.fontSizeRange,depth_3d:t.depth_3d,maskShape:t.maskShape,keepAspect:t.keepAspect,random:t.random,wordCloudConfig:t.wordCloudConfig,wordCloudShapeConfig:t.wordCloudShapeConfig,word:t.word,fillingWord:t.fillingWord}),i=this.seriesType;return i&&(e.type=i,e[i]=t[i]),e}}class LB extends IP{constructor(){super(...arguments),this.transformerConstructor=LR,this.type="wordCloud3d",this.seriesType=cZ.wordCloud3d}}LB.type="wordCloud3d",LB.seriesType=cZ.wordCloud3d,LB.transformerConstructor=LR;let LI=(t,e)=>{var i,r;let n=t.map(t=>Object.assign({},t));if(!n||0===n.length)return n;let{valueField:s,asTransformRatio:a,asReachRatio:o,asHeightRatio:l,asValueRatio:h,asNextValueRatio:u,asLastValueRatio:d,asLastValue:c,asCurrentValue:p,asNextValue:g,heightVisual:f=!1,isCone:m=!0,range:v}=e,y=n.reduce((t,e)=>Math.max(t,Number.parseFloat(e[s])||-Infinity),-Infinity),_=n.reduce((t,e)=>Math.min(t,Number.parseFloat(e[s])||1/0),1/0),b=[null!==(i=null==v?void 0:v.min)&&void 0!==i?i:_,null!==(r=null==v?void 0:v.max)&&void 0!==r?r:y];return n.forEach((t,e)=>{var i,r;let v=Number.parseFloat(t[s]),y=Number.parseFloat(null===(i=n[e-1])||void 0===i?void 0:i[s]),_=Number.parseFloat(null===(r=n[e+1])||void 0===r?void 0:r[s]),x=l1(_*v)&&0!==v?_/v:0,S=l1(v*y)&&0!==y?v/y:0;c&&(t[c]=y),g&&(t[g]=_),a&&(t[a]=x),o&&(t[o]=0===e?1:S),l&&(t[l]=!0===f?x:1/n.length),h&&(t[h]=v/b[1]),u&&(t[u]=e===n.length-1?m?0:t[h]:_/b[1]),d&&(t[d]=0===e?1:y/b[1]),p&&(t[p]=v)}),n},LL=(t,e)=>{var i,r;let n=null===(r=null===(i=t[0])||void 0===i?void 0:i.latestData)||void 0===r?void 0:r.map(t=>Object.assign({},t));return n&&0!==n.length&&(n.shift(),n.forEach(t=>{t[e.asIsTransformLevel]=!0})),n},LD=`${hA}_FUNNEL_TRANSFORM_RATIO`,LF=`${hA}_FUNNEL_REACH_RATIO`,Lj=`${hA}_FUNNEL_HEIGHT_RATIO`,LN=`${hA}_FUNNEL_VALUE_RATIO`,Lz=`${hA}_FUNNEL_LAST_VALUE_RATIO`,LH=`${hA}_FUNNEL_NEXT_VALUE_RATIO`,LV=`${hA}_FUNNEL_LAST_VALUE`,LW=`${hA}_FUNNEL_CURRENT_VALUE`,LG=`${hA}_FUNNEL_NEXT_VALUE`,LU=`${hA}_FUNNEL_TRANSFORM_LEVEL`;class L$ extends CB{constructor(){super(...arguments),this.dimensionTooltipTitleCallback=(t,e)=>{var i,r,n;let s=this.series;return"transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name)?"\u8F6C\u5316\u7387":null!==(r=this._getDimensionData(t))&&void 0!==r?r:null===(n=t.properties)||void 0===n?void 0:n[`${s.getCategoryField()}`]},this.markTooltipValueCallback=(t,e)=>{var i;return"transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name)?`${(100*(null==t?void 0:t[LF])).toFixed(1)}%`:this._getMeasureData(t)},this.markTooltipKeyCallback=(t,e)=>{var i;if("transform"===(null===(i=null==e?void 0:e.mark)||void 0===i?void 0:i.name))return"\u8F6C\u5316\u7387";let{dimensionFields:r,seriesFields:n}=this._seriesCacheInfo,s=r[r.length-1];return eO(n[0])?null==t?void 0:t[n[0]]:null==t?void 0:t[s]}}}class LY extends Sd{_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{points:[]})}}class LK extends LY{constructor(){super(...arguments),this.type=LK.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0})}}LK.type="polygon";let LZ=()=>{de.registerMark(LK.type,LK),AK(),Mo()};class LX extends C3{_transformLabelSpec(t){this._addMarkLabelSpec(t,"funnel"),t.isTransform&&this._addMarkLabelSpec(t,"transform","transformLabel")}}class Lq extends C5{constructor(){super(...arguments),this.type=cZ.funnel,this._funnelMarkName="funnel",this._funnelMarkType="polygon",this._transformMarkName="transform",this._transformMarkType="polygon",this.transformerConstructor=LX,this._funnelMark=null,this._funnelTransformMark=null,this._labelMark=null,this._transformLabelMark=null,this._funnelOuterLabelMark={}}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t,e;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this._funnelOrient=null!==(t=this._spec.funnelOrient)&&void 0!==t?t:"top",this._shape=null!==(e=this._spec.shape)&&void 0!==e?e:"trapezoid",this._isHorizontal()?this._funnelAlign=["top","bottom"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center":this._funnelAlign=["left","right"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center",this._spec.categoryField&&this.setSeriesField(this._spec.categoryField)}initData(){if(super.initData(),!this._data)return;gw(this._dataSet,"funnel",LI),gw(this._dataSet,"funnelTransform",LL);let t=new eH(this._dataSet,{name:`${hA}_series_${this.id}_viewDataTransform`});t.parse([this.getViewData()],{type:"dataview"}),this._viewDataTransform=new CH(this._option,t)}getStatisticFields(){let t=[];return t.push({key:this._categoryField,operations:["values"]}),t.push({key:this._valueField,operations:["max","min"]}),t}_statisticViewData(){var t,e,i,r,n,s,a,o,l;super._statisticViewData(),this._data.getDataView().transform({type:"funnel",options:{valueField:this.getValueField(),isCone:this._spec.isCone,asCurrentValue:LW,asTransformRatio:LD,asReachRatio:LF,asHeightRatio:Lj,asValueRatio:LN,asNextValueRatio:LH,asLastValueRatio:Lz,asLastValue:LV,asNextValue:LG,range:{min:null!==(e=null===(t=this._spec.range)||void 0===t?void 0:t.min)&&void 0!==e?e:null===(r=null===(i=this.getViewDataStatistics().latestData)||void 0===i?void 0:i[this.getValueField()])||void 0===r?void 0:r.min,max:null!==(s=null===(n=this._spec.range)||void 0===n?void 0:n.max)&&void 0!==s?s:null===(o=null===(a=this.getViewDataStatistics().latestData)||void 0===a?void 0:a[this.getValueField()])||void 0===o?void 0:o.max}}}),null===(l=this._viewDataTransform.getDataView())||void 0===l||l.transform({type:"funnelTransform",options:{asIsTransformLevel:LU}})}initMark(){var t,e,i,r,n,s,a,o,l,h,u,d;if(this._funnelMark=this._createMark(Object.assign(Object.assign({},Lq.mark.funnel),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null===(t=this._theme)||void 0===t?void 0:t.funnel,morph:C0(this._spec,this._funnelMarkName),defaultMorphElementKey:this._seriesField,groupKey:this._seriesField,isSeriesMark:!0,customShape:null===(e=this._spec.funnel)||void 0===e?void 0:e.customShape,stateSort:null===(i=this._spec.funnel)||void 0===i?void 0:i.stateSort,noSeparateStyle:!0}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(Object.assign(Object.assign({},Lq.mark.transform),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null===(r=this._theme)||void 0===r?void 0:r.transform,skipBeforeLayouted:!1,dataView:this._viewDataTransform.getDataView(),dataProductId:this._viewDataTransform.getProductId(),customShape:null===(n=this._spec.transform)||void 0===n?void 0:n.customShape,stateSort:null===(s=this._spec.transform)||void 0===s?void 0:s.stateSort,noSeparateStyle:!0})),null===(o=null===(a=this._spec)||void 0===a?void 0:a.outerLabel)||void 0===o?void 0:o.visible){let{line:t}=null!==(l=this._spec.outerLabel)&&void 0!==l?l:{},{line:e}=null!==(u=null===(h=this._theme)||void 0===h?void 0:h.outerLabel)&&void 0!==u?u:{};this._funnelOuterLabelMark.label=this._createMark(Lq.mark.outerLabel,{themeSpec:null===(d=this._theme)||void 0===d?void 0:d.outerLabel,markSpec:this._spec.outerLabel,skipBeforeLayouted:!0,noSeparateStyle:!0}),this._funnelOuterLabelMark.line=this._createMark(Lq.mark.outerLabelLine,{themeSpec:e,markSpec:t,depend:[this._funnelOuterLabelMark.label],noSeparateStyle:!0})}}initTooltip(){this._tooltipHelper=new L$(this),this._funnelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelMark),this._funnelTransformMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelTransformMark)}getDimensionField(){return this._seriesField?[this._seriesField]:[]}getMeasureField(){return[this._valueField]}getGroupFields(){return null}initMarkStyle(){let t=this._funnelMark;t&&this.setMarkStyle(t,{points:t=>this.getPoints(t),visible:t=>eO(t[this._valueField]),fill:this.getColorAttribute()},"normal",tw.Series);let e=this._funnelTransformMark;e&&this.setMarkStyle(e,{points:t=>this.getPoints(t)},"normal",tw.Series);let i=this._funnelOuterLabelMark.label;i&&this.setMarkStyle(i,{text:t=>{let e=`${t[this.getCategoryField()]}`;return nx(this._spec.outerLabel.formatMethod)?this._spec.outerLabel.formatMethod(e,t):e},x:t=>this._computeOuterLabelPosition(t).x,y:t=>this._computeOuterLabelPosition(t).y,textAlign:t=>this._computeOuterLabelPosition(t).align,textBaseline:t=>this._computeOuterLabelPosition(t).textBaseline,maxLineWidth:t=>this._computeOuterLabelLimit(t)},"normal",tw.Series);let r=this._funnelOuterLabelMark.line;r&&i&&this.setMarkStyle(r,{x:t=>this._computeOuterLabelLinePosition(t).x1,y:t=>this._computeOuterLabelLinePosition(t).y1,x1:t=>this._computeOuterLabelLinePosition(t).x2,y1:t=>this._computeOuterLabelLinePosition(t).y2},"normal",tw.Series)}initLabelMarkStyle(t){var e,i;if(!t)return;let r=t.getTarget(),n=t.getComponent();r===this._funnelMark?(this._labelMark=t,this.setMarkStyle(t,{text:t=>`${t[this.getCategoryField()]} ${t[this.getValueField()]}`,x:t=>this._computeLabelPosition(t).x,y:t=>this._computeLabelPosition(t).y,maxLineWidth:t=>this._computeLabelLimit(t,this._spec.label),stroke:this.getColorAttribute()},"normal",tw.Series),(null===(e=this._funnelOuterLabelMark)||void 0===e?void 0:e.label)&&this._funnelOuterLabelMark.label.setDepend(n),(null===(i=this._funnelOuterLabelMark)||void 0===i?void 0:i.line)&&this._funnelOuterLabelMark.line.setDepend(...this._funnelOuterLabelMark.line.getDepend())):this._funnelTransformMark&&r===this._funnelTransformMark&&(this._transformLabelMark=t,this.setMarkStyle(t,{text:t=>`${(100*RX(LF).bind(this)(t)).toFixed(1)}%`,x:t=>this._computeLabelPosition(t).x,y:t=>this._computeLabelPosition(t).y,maxLineWidth:t=>this._computeLabelLimit(t,this._spec.transformLabel)},"normal",tw.Series))}initAnimation(){var t,e,i,r,n,s,a;let o=null!==(i=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset)&&void 0!==i?i:"clipIn";"clipIn"===o&&this._rootMark&&this._rootMark.setAnimationConfig(CX(null===(r=de.getAnimationInKey("cartesianGroupClip"))||void 0===r?void 0:r({direction:()=>this._isHorizontal()?"x":"y",width:()=>{let t=this.getRootMark().getProduct();if(t){let{x1:e,x2:i}=t.getBounds();return Math.max(e,i)}return this.getLayoutRect().width},height:()=>{let t=this.getRootMark().getProduct();if(t){let{y1:e,y2:i}=t.getBounds();return Math.max(e,i)}return this.getLayoutRect().height},orient:()=>this._isReverse()?"negative":"positive"},o),Cq("group",this._spec,this._markAttributeContext))),[null===(n=this._funnelOuterLabelMark)||void 0===n?void 0:n.label].forEach(t=>{t&&t.setAnimationConfig(CX(de.getAnimationInKey("fadeInOut")(),Cq(t.name,this._spec,this._markAttributeContext)))}),[this._funnelMark,this._funnelTransformMark].forEach(t=>{t&&t.setAnimationConfig(CX(de.getAnimationInKey("funnel")({},o),Cq(t.name,this._spec,this._markAttributeContext)))}),(null===(s=this._funnelOuterLabelMark)||void 0===s?void 0:s.line)&&this._funnelOuterLabelMark.line.setAnimationConfig(CX(null===(a=de.getAnimationInKey("fadeInOut"))||void 0===a?void 0:a(),Cq("outerLabelLine",this._spec,this._markAttributeContext)))}initGroups(){}getStackGroupFields(){return[]}getStackValueField(){return null}initEvent(){var t;super.initEvent(),null===(t=this._viewDataTransform.getDataView())||void 0===t||t.target.addListener("change",t=>{this._viewDataTransform.updateData()})}getPoints(t){let e,i;let r=this.isTransformLevel(t),n=this._getMainAxisLength(r)/2;r?(e="rect"===this._shape?this._getSecondaryAxisLength(t[Lz])/2:this._getSecondaryAxisLength(t[LN])/2,i=this._getSecondaryAxisLength(t[LN])/2):(e=this._getSecondaryAxisLength(t[LN])/2,i="rect"===this._shape?e:this._getSecondaryAxisLength(t[LH])/2);let{x:s,y:a}=this._getPositionByData(t),o=this._getPolygonPoints([s,a],e,i,e,i,n);return"center"!==this._funnelAlign&&this._adjustPoints(o),o}isTransformLevel(t){return!!(null==t?void 0:t[LU])}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getPoints=this.getPoints.bind(this),this._markAttributeContext.isTransformLevel=this.isTransformLevel.bind(this)}valueToPosition(t){var e,i,r;let n=null===(r=null===(i=null===(e=this.getViewData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.find)||void 0===r?void 0:r.call(i,e=>e[this._categoryField]===t);return eO(n)?this._getPolygonCenter(this.getPoints(n)):null}dataToPosition(t,e){return e&&!this.isDatumInViewData(t)?null:this.valueToPosition(t[this._categoryField])}dataToPositionX(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.x}dataToPositionY(t){var e;return null===(e=this.dataToPosition(t))||void 0===e?void 0:e.y}dataToPositionZ(t){return 0}_getMainAxisLength(t=!1){var e;let i=this.getViewData().latestData.length,r=this._isHorizontal()?this.getLayoutRect().width:this.getLayoutRect().height,n=!!this._spec.isTransform,s=n?0:null!==(e=this._spec.gap)&&void 0!==e?e:0,a=n?Math.max(0,i-1):0,o=this._spec.heightRatio||.5,l=(r-s*Math.max(0,i-1))/(i+o*a);return t?n?l*o:0:l}_getSecondaryAxisLength(t){let e=Number.isNaN(t)||!Number.isFinite(t)?0:t,i=this._computeMaxSize(),r=this._computeMinSize();return r+(i-r)*e}_getPositionByData(t){var e;let i=null===(e=this.getViewData().latestData)||void 0===e?void 0:e.findIndex(e=>e[this._categoryField]===t[this._categoryField]&&e[bw]===t[bw]);if(!eO(i)||i<0)return{};let r=this.isTransformLevel(t),n=this._isHorizontal(),s=n?this.getLayoutRect().height:this.getLayoutRect().width,a=n?this.getLayoutRect().width:this.getLayoutRect().height,o=s/2,l=0,h=this._getMainAxisLength(),u=this._getMainAxisLength(!0);return l+=i*(h+u)+(r?-u/2:h/2),!this._spec.isTransform&&this._spec.gap&&(l+=this._spec.gap*i),this._isReverse()&&(l=a-l),this._isHorizontal()?{x:l,y:o}:{x:o,y:l}}_getPolygonPoints(t,e,i,r,n,s){let a=t[0],o=t[1];switch(this._funnelOrient){case"left":return[{x:a-s,y:o+e},{x:a-s,y:o-r},{x:a+s,y:o-n},{x:a+s,y:o+i}];case"right":return[{x:a+s,y:o-r},{x:a+s,y:o+r},{x:a-s,y:o+i},{x:a-s,y:o-i}];case"bottom":return[{x:a+e,y:o+s},{x:a-r,y:o+s},{x:a-n,y:o-s},{x:a+i,y:o-s}];default:return[{x:a-e,y:o-s},{x:a+r,y:o-s},{x:a+n,y:o+s},{x:a-i,y:o+s}]}}_getPolygonCenter(t){if(this._isHorizontal()){let e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}let e=(t[0].x+t[3].x)/2,i=(t[0].y+t[3].y)/2;return{x:(e+(t[1].x+t[2].x)/2)/2,y:(i+(t[1].y+t[2].y)/2)/2}}_adjustPoints(t){let e,i,r;return this._isHorizontal()?(r="y","left"===this._funnelOrient?(e="bottom"===this._funnelAlign?-t[1].y:t[1].y,i="bottom"===this._funnelAlign?-t[2].y:t[2].y):(e="bottom"===this._funnelAlign?-t[0].y:t[0].y,i="bottom"===this._funnelAlign?-t[3].y:t[3].y)):(r="x","top"===this._funnelOrient?(e="left"===this._funnelAlign?t[0].x:-t[0].x,i="left"===this._funnelAlign?t[3].x:-t[3].x):(e="left"===this._funnelAlign?t[1].x:-t[1].x,i="left"===this._funnelAlign?t[2].x:-t[2].x)),t[0][r]-=e,t[1][r]-=e,t[2][r]-=i,t[3][r]-=i,t}_computeLabelPosition(t){let e=this.getPoints(t);return this._getPolygonCenter(e)}_computeLabelLimit(t,e){let i=null==e?void 0:e.limit;if(ey(i))return i;let r=this.getPoints(t);return"shapeSize"===i?this._isHorizontal()?Math.abs(r[3].x-r[0].x):(Math.abs(r[0].x-r[1].x)+Math.abs(r[2].x-r[3].x))/2:this._isHorizontal()?Math.abs(r[3].x-r[0].x):void 0}_computeOuterLabelPosition(t){var e,i;let r,n,s=null===(e=this._spec.outerLabel)||void 0===e?void 0:e.position,a="center",o="middle";if(s=this._isHorizontal()?["top","bottom"].includes(s)?s:"bottom"===this._funnelAlign?"top":"bottom":["left","right"].includes(s)?s:"left"===this._funnelAlign?"right":"left",!1!==(null===(i=this._spec.outerLabel)||void 0===i?void 0:i.alignLabel))({x:r,y:n}=this._getPositionByData(t)),"left"===s?(r=0,a="left"):"right"===s?(r=this.getLayoutRect().width,a="right"):"top"===s?(n=0,o="top"):"bottom"===s&&(n=this.getLayoutRect().height,o="bottom");else{let{x2:e,y2:i}=this._computeOuterLabelLinePosition(t);r=e,n=i,"left"===s?(r-=5,a="right"):"right"===s?(r+=5,a="left"):"top"===s?(n-=5,o="bottom"):"bottom"===s&&(n+=5,o="top")}return{x:r,y:n,align:a,textBaseline:o}}_computeOuterLabelLimit(t){var e,i,r,n,s;if(this._isHorizontal())return this._getMainAxisLength(this.isTransformLevel(t));let a=this.getPoints(t),o=(Math.abs(a[0].x-a[1].x)+Math.abs(a[2].x-a[3].x))/2,l=this.getCategoryField(),h=null===(r=null===(i=null===(e=this._labelMark)||void 0===e?void 0:e.getComponent())||void 0===i?void 0:i.getProduct().getGroupGraphicItem().find(({attribute:e,type:i})=>{var r;return"text"===i&&(null===(r=e.data)||void 0===r?void 0:r[l])===t[l]},!0))||void 0===r?void 0:r.AABBBounds,u=h?h.x2-h.x1:0,d=this._funnelOuterLabelMark.line?20:0,c=this.getLayoutRect().width-Math.max(o,u);return"center"===this._funnelAlign&&(c/=2),c-d-(null!==(s=null===(n=this._spec.outerLabel)||void 0===n?void 0:n.spaceWidth)&&void 0!==s?s:5)}_computeOuterLabelLinePosition(t){var e,i,r,n,s,a,o,l,h,u,d;let c,p,g,f;let m=this.getCategoryField(),v=null===(s=null===(n=null===(r=null===(i=null===(e=this._funnelOuterLabelMark)||void 0===e?void 0:e.label)||void 0===i?void 0:i.getProduct())||void 0===r?void 0:r.elements)||void 0===n?void 0:n.find(e=>{var i;return(null===(i=e.data[0])||void 0===i?void 0:i[m])===t[m]}))||void 0===s?void 0:s.getBounds(),y=null===(l=null===(o=null===(a=this._labelMark)||void 0===a?void 0:a.getComponent())||void 0===o?void 0:o.getProduct().getGroupGraphicItem().find(({attribute:e,type:i})=>{var r;return"text"===i&&(null===(r=e.data)||void 0===r?void 0:r[m])===t[m]},!0))||void 0===l?void 0:l.AABBBounds,_=null!==(h=this._spec.outerLabel)&&void 0!==h?h:{};if(this._isHorizontal()){let e=null!==(u=_.spaceWidth)&&void 0!==u?u:5,i=this.getPoints(t),r=(Math.abs(i[0].y-i[1].y)+Math.abs(i[2].y-i[3].y))/2;return"top"===this._spec.outerLabel.position||"bottom"===this._funnelAlign?(g=this._getPolygonCenter(i).y-r/2-e,f=!1!==_.alignLabel?(null==v?void 0:v.y2)+e:g-e,c=this._getPolygonCenter(i).x,g-f<20&&(f=g-20)):(g=this._getPolygonCenter(i).y+r/2+e,f=!1!==_.alignLabel?(null==v?void 0:v.y1)-e:g+e,c=this._getPolygonCenter(i).x,f-g<20&&(f=g+20)),p=c,{x1:c,x2:p,y1:g,y2:f}}let b=this.getPoints(t),x=(Math.abs(b[0].x-b[1].x)+Math.abs(b[2].x-b[3].x))/2,S=(null==y?void 0:y.x2)-(null==y?void 0:y.x1)||0,k=null!==(d=_.spaceWidth)&&void 0!==d?d:5;return"right"===this._spec.outerLabel.position||"left"===this._funnelAlign?(c=this._getPolygonCenter(b).x+Math.max(S/2,x/2)+k,p=!1!==_.alignLabel?(null==v?void 0:v.x1)-k:c+k,g=this._getPolygonCenter(b).y,p-c<20&&(p=c+20)):(c=this._getPolygonCenter(b).x-Math.max(S/2,x/2)-k,p=!1!==_.alignLabel?(null==v?void 0:v.x2)+k:c-k,g=this._getPolygonCenter(b).y,c-p<20&&(p=c-20)),f=g,{x1:c,x2:p,y1:g,y2:f}}_computeMaxSize(){var t;let e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return ht(null!==(t=this._spec.maxSize)&&void 0!==t?t:"80%",e)}_computeMinSize(){var t;let e=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width;return ht(null!==(t=this._spec.minSize)&&void 0!==t?t:0,e)}_isHorizontal(){return"left"===this._funnelOrient||"right"===this._funnelOrient}_isReverse(){return"bottom"===this._funnelOrient||"right"===this._funnelOrient}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._funnelMark]}}Lq.type=cZ.funnel,Lq.mark=hK,Lq.transformerConstructor=LX;let LJ=()=>{LZ(),B9(),B0(),de.registerSeries(Lq.type,Lq),de.registerAnimation("funnel",(t,e)=>Object.assign({appear:"clipIn"===e?void 0:{type:"fadeIn"}},w6)),Mt(),w7()};class LQ extends OE{needAxes(){return!1}_getDefaultSeriesSpec(t){let e=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{categoryField:t.categoryField,valueField:t.valueField,seriesField:t.seriesField,funnelAlign:t.funnelAlign,funnelOrient:t.funnelOrient,heightRatio:t.heightRatio,shape:t.shape,funnel:t.funnel,transform:t.transform,outerLabel:t.outerLabel,transformLabel:t.transformLabel,isTransform:t.isTransform,maxSize:t.maxSize,minSize:t.minSize,gap:t.gap,isCone:t.isCone,range:t.range}),i=this.seriesType;return i&&(e.type=i,e[i]=t[i]),e}transformSpec(t){super.transformSpec(t);let e=this._getDefaultSeriesSpec(t);t.series&&0!==t.series.length?t.series.forEach(t=>{this._isValidSeries(t.type)&&Object.keys(e).forEach(i=>{i in t||(t[i]=e[i])})}):t.series=[e]}}class L0 extends OD{constructor(){super(...arguments),this.transformerConstructor=LQ,this.type="funnel",this.seriesType=cZ.funnel}}L0.type="funnel",L0.seriesType=cZ.funnel,L0.transformerConstructor=LQ;class L1 extends LY{constructor(){super(...arguments),this.type=L1.type}}L1.type="pyramid3d";let L2=()=>{de.registerMark(L1.type,L1),AF(),Mo()};class L3 extends LX{_transformLabelSpec(t){this._addMarkLabelSpec(t,"funnel3d"),t.isTransform&&this._addMarkLabelSpec(t,"transform3d","transformLabel")}}class L5 extends Lq{constructor(){super(...arguments),this.type=cZ.funnel3d,this._funnelMarkName="funnel3d",this._funnelMarkType="pyramid3d",this._transformMarkName="transform3d",this._transformMarkType="pyramid3d",this.transformerConstructor=L3}initMark(){var t,e,i,r,n,s,a,o;if(this._funnelMark=this._createMark(Object.assign(Object.assign({},L5.mark.funnel3d),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:null===(t=this._theme)||void 0===t?void 0:t.funnel3d,key:this._seriesField,isSeriesMark:!0,support3d:!0}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(Object.assign(Object.assign({},L5.mark.transform3d),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:null===(e=this._theme)||void 0===e?void 0:e.transform3d,key:this._seriesField,skipBeforeLayouted:!1,dataView:this._viewDataTransform.getDataView(),dataProductId:this._viewDataTransform.getProductId()})),null===(r=null===(i=this._spec)||void 0===i?void 0:i.outerLabel)||void 0===r?void 0:r.visible){let{line:t}=null!==(n=this._spec.outerLabel)&&void 0!==n?n:{},{line:e}=null!==(a=null===(s=this._theme)||void 0===s?void 0:s.outerLabel)&&void 0!==a?a:{};this._funnelOuterLabelMark.label=this._createMark(L5.mark.outerLabel,{themeSpec:null===(o=this._theme)||void 0===o?void 0:o.outerLabel,key:this._seriesField,markSpec:this._spec.outerLabel}),this._funnelOuterLabelMark.line=this._createMark(L5.mark.outerLabelLine,{themeSpec:e,key:this._seriesField,markSpec:t,depend:[this._funnelOuterLabelMark.label]})}}initMarkStyle(){super.initMarkStyle();let t=this._funnelMark;t&&this.setMarkStyle(t,{z:t=>{if(this._isHorizontal())return 0;let e=this.getPoints(t),i=Math.max(Math.abs(e[0].x-e[1].x),Math.abs(e[2].x-e[3].x));return(this._computeMaxSize()-i)/2}},"normal",tw.Series)}initLabelMarkStyle(t){var e,i;super.initLabelMarkStyle(t),this.setMarkStyle(t,{z:t=>{if(this._isHorizontal())return 0;let e=this.getPoints(t),i=Math.max(Math.abs(e[0].x-e[1].x),Math.abs(e[2].x-e[3].x));return(this._computeMaxSize()-i)/2}},"normal",tw.Series),this._labelMark=t,(null===(e=this._funnelOuterLabelMark)||void 0===e?void 0:e.label)&&this._funnelOuterLabelMark.label.setDepend(t.getComponent()),(null===(i=this._funnelOuterLabelMark)||void 0===i?void 0:i.line)&&this._funnelOuterLabelMark.line.setDepend(...this._funnelOuterLabelMark.line.getDepend())}}L5.type=cZ.funnel3d,L5.mark=hZ,L5.transformerConstructor=L3;let L4=()=>{L2(),B9(),B0(),de.registerSeries(L5.type,L5)};class L8 extends OD{constructor(){super(...arguments),this.transformerConstructor=LQ,this.type="funnel3d",this.seriesType=cZ.funnel3d}}L8.type="funnel3d",L8.seriesType=cZ.funnel3d,L8.transformerConstructor=LQ;function L6(t){return()=>"vertical"===t.direction?{orient:"negative"}:{orient:"positive"}}let L9=t=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:L6(t)}),L7=t=>({type:"horizontal"===t.direction?"growWidthOut":"growHeightOut",options:L6(t)}),Dt={type:"fadeIn"},De=()=>{de.registerAnimation("linearProgress",(t,e)=>{var i,r;return{appear:(i=t,!1===(r=e)?{}:"fadeIn"===r?Dt:L9(i)),enter:{type:"grow"},disappear:L7(t)}})};class Di extends CB{getDefaultTooltipPattern(t,e){let i=super.getDefaultTooltipPattern(t,e);switch(t){case"mark":case"group":return i;case"dimension":return i.visible=!1,i}return null}}class Dr extends C6{constructor(){super(...arguments),this.type=cZ.linearProgress,this._progressMark=null,this._trackMark=null,this._progressGroupMark=null}initMark(){this._initProgressGroupMark(),this._initTrackMark(),this._initProgressMark()}initMarkStyle(){this._initProgressGroupMarkStyle(),this._initTrackMarkStyle(),this._initProgressMarkStyle()}_initProgressMark(){var t,e;return this._progressMark=this._createMark(Dr.mark.progress,{isSeriesMark:!0,parent:this._progressGroupMark,customShape:null===(t=this._spec.progress)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.progress)||void 0===e?void 0:e.stateSort}),this._progressMark}_initProgressMarkStyle(){var t,e,i,r,n,s,a,o;let l=this._progressMark;if(l){if("vertical"===this._spec.direction){let n=null!==(e=null===(t=this._spec.progress)||void 0===t?void 0:t.leftPadding)&&void 0!==e?e:0,s=null!==(r=null===(i=this._spec.progress)||void 0===i?void 0:i.rightPadding)&&void 0!==r?r:0;this.setMarkStyle(l,{x:t=>{var e,i;return Se(this.dataToPositionX(t),null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))-this._spec.bandWidth/2+n},y:t=>{var e,i;return Se(this.dataToPositionY(t),null===(i=null===(e=this._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))},height:()=>{var t;return null===(t=this._yAxisHelper)||void 0===t?void 0:t.dataToPosition([0],{bandPosition:this._bandPosition})},width:this._spec.bandWidth-n-s,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",tw.Series)}else{let t=null!==(s=null===(n=this._spec.progress)||void 0===n?void 0:n.topPadding)&&void 0!==s?s:0,e=null!==(o=null===(a=this._spec.progress)||void 0===a?void 0:a.bottomPadding)&&void 0!==o?o:0;this.setMarkStyle(l,{x:t=>{var e,i;return Se(this.dataToPositionX(t),null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))-this._xAxisHelper.dataToPosition([1],{bandPosition:this._bandPosition})},y:e=>{var i,r;return Se(this.dataToPositionY(e),null===(r=null===(i=this._yAxisHelper)||void 0===i?void 0:i.getScale)||void 0===r?void 0:r.call(i,0))-this._spec.bandWidth/2+t},height:this._spec.bandWidth-t-e,width:()=>{var t;return null===(t=this._xAxisHelper)||void 0===t?void 0:t.dataToPosition([1],{bandPosition:this._bandPosition})},cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",tw.Series)}}}_initTrackMark(){var t,e;return this._trackMark=this._createMark(Dr.mark.track,{parent:this._progressGroupMark,customShape:null===(t=this._spec.track)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.track)||void 0===e?void 0:e.stateSort}),this._trackMark}_initTrackMarkStyle(){let t=this._trackMark;t&&("vertical"===this._spec.direction?this.setMarkStyle(t,{x:t=>{var e,i;return Se(this.dataToPositionX(t),null===(i=null===(e=this._xAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))-this._spec.bandWidth/2},y:0,width:this._spec.bandWidth,height:()=>this._scaleY.range()[0],cornerRadius:this._spec.cornerRadius},"normal",tw.Series):this.setMarkStyle(t,{x:0,y:t=>{var e,i;return Se(this.dataToPositionY(t),null===(i=null===(e=this._yAxisHelper)||void 0===e?void 0:e.getScale)||void 0===i?void 0:i.call(e,0))-this._spec.bandWidth/2},height:this._spec.bandWidth,width:()=>this._scaleX.range()[1],cornerRadius:this._spec.cornerRadius},"normal",tw.Series))}_initProgressGroupMark(){return this._progressGroupMark=this._createMark(Dr.mark.group,{skipBeforeLayouted:!1}),this._progressGroupMark}_initProgressGroupMarkStyle(){let t=this._progressGroupMark;t.setZIndex(this.layoutZIndex),t.created(),this.setMarkStyle(t,{clip:!0,x:0,y:0,path:()=>{var t;let e=[];return null===(t=this._rawData)||void 0===t||t.rawData.forEach((t,i)=>{var r,n,s,a;if("vertical"===this._spec.direction){let i=Se(this.dataToPositionX(t),null===(n=null===(r=this._xAxisHelper)||void 0===r?void 0:r.getScale)||void 0===n?void 0:n.call(r,0))-this._spec.bandWidth/2,s=this._scaleY.range()[0];e.push(_4({x:i,y:0,height:s,width:this._spec.bandWidth,cornerRadius:this._spec.cornerRadius,fill:!0}))}else{let i=Se(this.dataToPositionY(t),null===(a=null===(s=this._yAxisHelper)||void 0===s?void 0:s.getScale)||void 0===a?void 0:a.call(s,0))-this._spec.bandWidth/2,r=this._scaleX.range()[1];e.push(_4({x:0,y:i,height:this._spec.bandWidth,width:r,cornerRadius:this._spec.cornerRadius,fill:!0}))}}),e}},"normal",tw.Series),this._progressGroupMark.setInteractive(!1)}initInteraction(){let t=[];this._trackMark&&t.push(this._trackMark),this._progressMark&&t.push(this._progressMark),this._parseInteractionConfig(t)}initAnimation(){var t,e,i,r;let n={direction:this.direction},s=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._progressMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("linearProgress"))||void 0===i?void 0:i(n,s),Cq("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(CX(null===(r=de.getAnimationInKey("fadeInOut"))||void 0===r?void 0:r(),Cq("track",this._spec,this._markAttributeContext)))}initTooltip(){this._tooltipHelper=new Di(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark),this._trackMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._trackMark)}getActiveMarks(){return[this._progressMark]}}Dr.type=cZ.linearProgress,Dr.mark=hX;let Dn=()=>{O2(),De(),w7(),de.registerSeries(Dr.type,Dr)};class Ds extends OO{needAxes(){return!1}_getDefaultSeriesSpec(t){var e,i;return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{direction:null!==(e=t.direction)&&void 0!==e?e:"horizontal",cornerRadius:null!==(i=t.cornerRadius)&&void 0!==i?i:0,bandWidth:t.bandWidth,progress:t.progress,track:t.track})}transformSpec(t){var e,i;if(super.transformSpec(t),t.axes||(t.axes=[]),"vertical"===t.direction){let i=null,r=null;(null!==(e=t.axes)&&void 0!==e?e:[]).forEach(t=>{let{orient:e}=t;"left"===e&&(i=t),"bottom"===e&&(r=t)}),i||(i={orient:"left",visible:!1},t.axes.push(i)),r||(r={orient:"bottom",visible:!1},t.axes.push(r)),ej(r.type)&&(r.type="band"),ej(i.type)&&(i.type="linear");let n=TU(i,{min:0,max:1});ej(i.min)&&(i.min=n.min),ej(i.max)&&(i.max=n.max)}else{let e=null,r=null;(null!==(i=t.axes)&&void 0!==i?i:[]).forEach(t=>{let{orient:i}=t;"left"===i&&(e=t),"bottom"===i&&(r=t)}),e||(e={type:"band",orient:"left",visible:!1},t.axes.push(e)),r||(r={orient:"bottom",visible:!1},t.axes.push(r)),ej(r.type)&&(r.type="linear"),ej(e.type)&&(e.type="band");let n=TU(r,{min:0,max:1});ej(r.min)&&(r.min=n.min),ej(r.max)&&(r.max=n.max)}}}class Da extends OD{constructor(){super(...arguments),this.transformerConstructor=Ds,this.type="linearProgress",this.seriesType=cZ.linearProgress,this._canStack=!0}}Da.type="linearProgress",Da.seriesType=cZ.linearProgress,Da.transformerConstructor=Ds;function Do(t,e,i,r,n,s,a,o,l){t.setMarkStyle(e,{textAlign:t=>{if("vertical"===l())return"center";let e=n(t),r=s(t);if("middle"===i)return"center";if(e>=r){if("start"===i)return"left";if("end"===i)return"right";if("outside"===i)return"left"}else{if("start"===i)return"right";if("end"===i)return"left";if("outside"===i)return"right"}return"center"},textBaseline:t=>{if("horizontal"===l())return"middle";let e=a(t),r=o(t);if("middle"===i)return"middle";if(r>=e){if("start"===i)return"bottom";if("end"===i)return"top";if("outside"===i)return"bottom"}else{if("start"===i)return"top";if("end"===i)return"bottom";if("outside"===i)return"top"}return"middle"}}),t.setMarkStyle(e,{x:t=>{let e=l(),a=n(t),o=s(t);if("vertical"===e||"middle"===i)return(a+o)/2;if(a>=o){if("start"===i)return o+r;if("end"===i)return a-r;if("outside"===i)return a+r}else{if("start"===i)return o-r;if("end"===i)return a+r;if("outside"===i)return a-r}return(a+o)/2},y:t=>{let e=l(),n=a(t),s=o(t);if("horizontal"===e||"middle"===i)return(n+s)/2;if(n>=s){if("start"===i)return s+r;if("end"===i)return n-r;if("outside"===i)return n+r}else{if("start"===i)return s-r;if("end"===i)return n+r;if("outside"===i)return n-r}return(n+s)/2}},"normal",tw.Series)}class Dl extends CB{getDefaultTooltipPattern(t){return{visible:!0,activeType:t,title:{key:void 0,value:this.dimensionTooltipTitleCallback,hasShape:!1},content:[{key:this.markTooltipKeyCallback,value:t=>"horizontal"===this.series.getSpec().direction?t[this.series.getSpec().xField[0]]+"-"+t[this.series.getSpec().xField[1]]:t[this.series.getSpec().yField[0]]+"-"+t[this.series.getSpec().yField[1]],hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1}]}}}let Dh=t=>({type:"growCenterIn",options:{direction:"horizontal"===t.direction?"x":"y"}}),Du={type:"fadeIn"},Dd=t=>({type:"growCenterOut",options:{direction:"horizontal"===t.direction?"x":"y"}}),Dc=()=>{de.registerAnimation("rangeColumn",(t,e)=>{var i;return{appear:(i=t,"fadeIn"===e?Du:Dh(i)),enter:Dh(t),exit:Dd(t),disappear:Dd(t)}})};class Dp extends O5{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){var e;"bothEnd"!==(null===(e=t.label)||void 0===e?void 0:e.position)&&this._addMarkLabelSpec(t,"bar")}}class Dg extends O4{constructor(){super(...arguments),this.type=cZ.rangeColumn,this._barMarkType="rect",this._barName=cZ.bar,this.transformerConstructor=Dp}initMark(){var t,e,i,r,n,s,a,o,l,h;this._initBarBackgroundMark();let u=null===(t=this._spec.label)||void 0===t?void 0:t.position;this._barMark=this._createMark(Dg.mark.bar,{morph:C0(this._spec,Dg.mark.bar.name),defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,isSeriesMark:!0,customShape:null===(e=this._spec.bar)||void 0===e?void 0:e.customShape,stateSort:null===(i=this._spec.bar)||void 0===i?void 0:i.stateSort}),!1!==(null===(r=this._spec.label)||void 0===r?void 0:r.visible)&&"bothEnd"===u&&(!1!==(null===(s=null===(n=this._spec.label)||void 0===n?void 0:n.minLabel)||void 0===s?void 0:s.visible)&&(this._minLabelMark=this._createMark(Dg.mark.minLabel,{markSpec:null===(a=this._spec.label)||void 0===a?void 0:a.minLabel})),!1!==(null===(l=null===(o=this._spec.label)||void 0===o?void 0:o.maxLabel)||void 0===l?void 0:l.visible)&&(this._maxLabelMark=this._createMark(Dg.mark.maxLabel,{markSpec:null===(h=this._spec.label)||void 0===h?void 0:h.maxLabel})))}initMarkStyle(){var t,e,i,r,n,s,a,o,l,h;super.initMarkStyle();let u=this._minLabelMark,d=null===(t=this._spec.label)||void 0===t?void 0:t.minLabel;if(u){this.setMarkStyle(u,{fill:null!==(i=null===(e=null==d?void 0:d.style)||void 0===e?void 0:e.fill)&&void 0!==i?i:this.getColorAttribute(),text:t=>{let e="horizontal"===this._spec.direction?t[this._spec.xField[0]]:t[this._spec.yField[0]];return(null==d?void 0:d.formatMethod)?d.formatMethod(e,t):e}});let t=null!==(r=null==d?void 0:d.position)&&void 0!==r?r:"end";Do(this,u,t,null!==(n=null==d?void 0:d.offset)&&void 0!==n?n:"vertical"===this._direction?-20:-25,t=>this._barMark.getAttribute("x",t),t=>"vertical"===this._direction?this._barMark.getAttribute("x",t)+this._barMark.getAttribute("width",t):this._barMark.getAttribute("x1",t),t=>this._barMark.getAttribute("y",t),t=>"vertical"===this._direction?this._barMark.getAttribute("y1",t):this._barMark.getAttribute("y",t)+this._barMark.getAttribute("height",t),()=>this._direction)}let c=this._maxLabelMark,p=null===(s=this._spec.label)||void 0===s?void 0:s.maxLabel;if(c){this.setMarkStyle(c,{fill:null!==(o=null===(a=null==p?void 0:p.style)||void 0===a?void 0:a.fill)&&void 0!==o?o:this.getColorAttribute(),text:t=>{let e="horizontal"===this._spec.direction?t[this._spec.xField[1]]:t[this._spec.yField[1]];return(null==p?void 0:p.formatMethod)?p.formatMethod(e,t):e}});let t=null!==(l=null==p?void 0:p.position)&&void 0!==l?l:"start";Do(this,c,t,null!==(h=null==p?void 0:p.offset)&&void 0!==h?h:"vertical"===this._direction?-20:-25,t=>this._barMark.getAttribute("x",t),t=>"vertical"===this._direction?this._barMark.getAttribute("x",t)+this._barMark.getAttribute("width",t):this._barMark.getAttribute("x1",t),t=>this._barMark.getAttribute("y",t),t=>"vertical"===this._direction?this._barMark.getAttribute("y1",t):this._barMark.getAttribute("y",t)+this._barMark.getAttribute("height",t),()=>this._direction)}}initLabelMarkStyle(t){t&&(this.setMarkStyle(t,{text:t=>{let e,i;return"horizontal"===this._spec.direction?(e=t[this._spec.xField[0]],i=t[this._spec.xField[1]]):(e=t[this._spec.yField[0]],i=t[this._spec.yField[1]]),e+"-"+i},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),this._labelMark=t)}_dataToPosX(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[0]),{bandPosition:this._bandPosition})}_dataToPosX1(t){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})}_dataToPosY(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[0]),{bandPosition:this._bandPosition})}_dataToPosY1(t){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})}initAnimation(){var t,e,i,r,n;let s=C8(this),a=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._barMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("rangeColumn"))||void 0===i?void 0:i({direction:this.direction},a),Cq("bar",this._spec,this._markAttributeContext),s)),this._minLabelMark&&this._minLabelMark.setAnimationConfig(CX(null===(r=de.getAnimationInKey("fadeInOut"))||void 0===r?void 0:r(),Cq("label",this._spec,this._markAttributeContext),s)),this._maxLabelMark&&this._maxLabelMark.setAnimationConfig(CX(null===(n=de.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),Cq("label",this._spec,this._markAttributeContext),s))}initTooltip(){this._tooltipHelper=new Dl(this),this._barMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._barMark),this._minLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._minLabelMark),this._maxLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._maxLabelMark),this._labelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._labelMark)}}Dg.type=cZ.rangeColumn,Dg.mark=h5,Dg.transformerConstructor=Dp;let Df=()=>{O2(),B9(),Dc(),w7(),Oy(),OA(),de.registerSeries(Dg.type,Dg)};class Dm extends OO{_getDefaultSeriesSpec(t){var e,i;let r=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{barWidth:t.barWidth,barMaxWidth:t.barMaxWidth,barMinWidth:t.barMinWidth,barGapInGroup:t.barGapInGroup,barBackground:t.barBackground,barMinHeight:t.barMinHeight,stackCornerRadius:t.stackCornerRadius});return r.bar=t.bar,"horizontal"===t.direction?r.xField=null!==(e=t.xField)&&void 0!==e?e:[t.minField,t.maxField]:r.yField=null!==(i=t.yField)&&void 0!==i?i:[t.minField,t.maxField],r}transformSpec(t){super.transformSpec(t),bg(t)}}class Dv extends OD{constructor(){super(...arguments),this.transformerConstructor=Dm,this.type="rangeColumn",this.seriesType=cZ.rangeColumn}}Dv.type="rangeColumn",Dv.seriesType=cZ.rangeColumn,Dv.transformerConstructor=Dm;class Dy extends Dg{constructor(){super(...arguments),this.type=cZ.rangeColumn3d,this._barMarkType="rect3d",this._barName=cZ.bar3d}}Dy.type=cZ.rangeColumn3d,Dy.mark=h4;let D_=()=>{Pt(),Oy(),OA(),de.registerSeries(Dy.type,Dy)};class Db extends OO{_getDefaultSeriesSpec(t){var e,i;let r=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{barGapInGroup:t.barGapInGroup});return r.bar3d=t.bar3d,"horizontal"===t.direction?r.xField=null!==(e=t.xField)&&void 0!==e?e:[t.minField,t.maxField]:r.yField=null!==(i=t.yField)&&void 0!==i?i:[t.minField,t.maxField],r}}class Dx extends OD{constructor(){super(...arguments),this.transformerConstructor=Db,this.type="rangeColumn3d",this.seriesType=cZ.rangeColumn3d}}Dx.type="rangeColumn3d",Dx.seriesType=cZ.rangeColumn3d,Dx.transformerConstructor=Db;let DS=(t,e)=>Math.max(0,Math.min(1,(t-e[0])/(e[1]-e[0]||1))),Dk=t=>{let e=t.mark.elements.filter(t=>t.diffState===c4.update),i=o_(e.map(t=>{var e;return null===(e=null==t?void 0:t.data)||void 0===e?void 0:e[0].depth}));return e.filter(t=>{var e;return(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e[0].depth)===i})},DA=(t,e,i)=>mk(t)?[e,i]:[o_(t.map(t=>1*t.getGraphicAttribute("startAngle",!1))),oy(t.map(t=>1*t.getGraphicAttribute("endAngle",!1)))],Dw=t=>({channel:{startAngle:{from:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),s=DA(Dk(i),r,n);return DS(e.startAngle,s)*(n-r)+r},to:t=>t.startAngle},endAngle:{from:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),s=DA(Dk(i),r,n);return DS(e.endAngle,s)*(n-r)+r},to:t=>t.endAngle},outerRadius:{from:t=>t.innerRadius,to:t=>t.outerRadius},innerRadius:{from:t=>t.innerRadius,to:t=>t.innerRadius}}}),DM=t=>[o_(t.map(t=>1*t.getGraphicAttribute("startAngle",!1))),oy(t.map(t=>1*t.getGraphicAttribute("endAngle",!1)))],DC=t=>({channel:{startAngle:{from:(t,e)=>e.getGraphicAttribute("startAngle",!1),to:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),s=DM(Dk(i));return DS(i.getGraphicAttribute("startAngle",!1),s)*(n-r)+r}},endAngle:{from:(t,e)=>e.getGraphicAttribute("endAngle",!1),to:(e,i)=>{let{startAngle:r,endAngle:n}=t.animationInfo(),s=DM(Dk(i));return DS(i.getGraphicAttribute("endAngle",!1),s)*(n-r)+r}},outerRadius:{from:(t,e)=>e.getGraphicAttribute("outerRadius",!1),to:()=>t.animationInfo().innerRadius},innerRadius:{from:(t,e)=>e.getGraphicAttribute("innerRadius",!1),to:()=>t.animationInfo().innerRadius}}}),DT=(t,e)=>{switch(e){case"fadeIn":return{type:"fadeIn"};case"growAngle":return{type:"growAngleIn"};default:return{type:"growRadiusIn"}}},DE=()=>{de.registerAnimation("sunburst",(t,e)=>({appear:DT(t,e),enter:Dw(t),exit:DC(t),disappear:DC(t)}))},DO=(t,e=[],i)=>{let r=(null==i?void 0:i.maxDepth)>=0;return t.forEach(t=>{(!r||t.depth<=i.maxDepth)&&(e.push((null==i?void 0:i.callback)?i.callback(t):t),t.children&&(r&&t.depth===i.maxDepth?(t.children=null,t.isLeaf=!0):DO(t.children,e,i)))}),e},DP=(t,e={})=>{if(!t)return[];let i=[];return DO(t,i,e),i};function DR(t,e,i,r,n,s={x0:"x0",x1:"x1",y0:"y0",y1:"y1"}){let a=t.children,o,l=-1,h=a.length,u=t.value&&(r-e)/t.value;for(;++l<h;)(o=a[l])[s.y0]=i,o[s.y1]=n,o[s.x0]=e,o[s.x1]=e+=o.value*u}function DB(t){if(l1(t))return t;let e=+t;return l1(e)?e:0}let DI=(t,e,i=0,r=-1,n,s)=>{let a=0,o=null!=r?r:-1,l=i;return t.forEach((t,r)=>{var h,u;let d={flattenIndex:++o,key:s?s(t):`${null!==(h=null==n?void 0:n.key)&&void 0!==h?h:""}-${r}`,maxDepth:-1,depth:i,index:r,value:t.value,isLeaf:!0,datum:n?n.datum.concat(t):[t],parentKey:null==n?void 0:n.key};if(null===(u=t.children)||void 0===u?void 0:u.length){d.children=[],d.isLeaf=!1;let e=DI(t.children,d.children,i+1,o,d,s);d.value=ej(t.value)?e.sum:Math.max(e.sum,DB(t.value)),o=e.flattenIndex,l=Math.max(e.maxDepth,l)}else d.isLeaf=!0,d.value=DB(t.value);a+=Math.abs(d.value),e.push(d)}),{sum:a,maxDepth:l,flattenIndex:o}},DL=(t,e,i,r)=>{let n=r;return t.forEach((t,r)=>{var s;n=e(t,r,i,n),(null===(s=t.children)||void 0===s?void 0:s.length)&&(n=DL(t.children,e,t,n))}),r},DD=(t,e,i,r)=>{let n=r;return t.forEach((t,r)=>{var s;(null===(s=t.children)||void 0===s?void 0:s.length)&&(n=DD(t.children,e,t,n)),n=e(t,r,i,n)}),n},DF={x0:"startAngle",x1:"endAngle",y0:"innerRadius",y1:"outerRadius"};class Dj{constructor(t){this._layoutNode=t=>{if(t.maxDepth=this._maxDepth,t.children){let e=this._parsedInnerRadius[t.depth+1],i=this._parsedOutterRadius[t.depth+1];DR(t,t.startAngle,Math.min(e,i),t.endAngle,Math.max(e,i),DF);let r=eM(this.options.label)?this.options.label[t.depth+1]:this.options.label;t.children.forEach(t=>{if(t.x=this._parsedCenter[0],t.y=this._parsedCenter[1],r)return this._layoutLabel(t,ew(r)?{align:"center",rotate:"radial"}:r)})}},this.options=t?Object.assign({},Dj.defaultOpionts,t):Object.assign({},Dj.defaultOpionts);let e=this.options.nodeKey,i=nx(e)?e:e?fl(e):null;this._getNodeKey=i,this._maxDepth=-1}_parseRadius(t,e){let i=t.x0+vs(this.options.center[0],t.width),r=t.y0+vs(this.options.center[1],t.height),n=Math.min(t.width/2,t.height/2),s=this.options.innerRadius,a=this.options.outerRadius,o=eM(s),l=o?s.map(t=>vs(t,n)):vs(s,n),h=eM(a),u=this.options.gapRadius,d=h?a.map(t=>vs(t,n)):vs(a,n),c=xt(0,e+1);if(o)this._parsedInnerRadius=c.map((t,e)=>{let i=l[e];return ej(i)?n:i}),this._parsedOutterRadius=c.map((t,i)=>{var r,s;return h?null!==(r=d[i])&&void 0!==r?r:n:i<e?this._parsedInnerRadius[i+1]-(eM(u)?null!==(s=u[i])&&void 0!==s?s:0:u):d});else if(h)this._parsedOutterRadius=c.map((t,e)=>ej(d[e])?n:d[e]),this._parsedInnerRadius=c.map((t,e)=>{var i;return 0===e?l:this._parsedOutterRadius[e-1]-(eM(u)?null!==(i=u[e])&&void 0!==i?i:0:u)});else{let t=vs(s,n),i=(d-t)/(e+1);this._parsedInnerRadius=c.map((e,r)=>t+r*i),this._parsedOutterRadius=c.map((t,e)=>{var r;return this._parsedInnerRadius[e]+i-(eM(u)?null!==(r=u[e])&&void 0!==r?r:0:u)})}this._parsedCenter=[i,r],this._maxRadius=n}layout(t,e){let i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];let r=[],n=DI(t,r,0,-1,null,this._getNodeKey);return this._parseRadius(i,n.maxDepth),this._maxDepth=n.maxDepth,this._layout(r,{flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:n.sum,datum:null,children:r,startAngle:this.options.startAngle,endAngle:this.options.endAngle}),r}_layout(t,e){this._layoutNode(e),t.forEach(t=>{var e;(null===(e=null==t?void 0:t.children)||void 0===e?void 0:e.length)?this._layout(t.children,t):this._layoutNode(t)})}_layoutLabel(t,e){var i;let r=(t.startAngle+t.endAngle)/2,n=("start"===e.align?t.innerRadius:"end"===e.align?t.outerRadius:(t.innerRadius+t.outerRadius)/2)+(null!==(i=e.offset)&&void 0!==i?i:0),s=iM({x:this._parsedCenter[0],y:this._parsedCenter[1]},n,r);if(t.label={x:s.x,y:s.y,textBaseline:"middle"},"tangential"===e.rotate)t.label.angle=r-Math.PI/2,t.label.textAlign="center",t.label.maxLineWidth=Math.abs(t.endAngle-t.startAngle)*n;else{let i=r%(2*Math.PI),n=i<0?i+2*Math.PI:i;n>Math.PI/2&&n<1.5*Math.PI?(t.label.angle=n+Math.PI,t.label.textAlign="start"===e.align?"end":"end"===e.align?"start":"center"):(t.label.angle=n,t.label.textAlign=e.align),t.label.maxLineWidth=t.isLeaf?void 0:Math.abs(t.outerRadius-t.innerRadius)}}}Dj.defaultOpionts={startAngle:Math.PI/2,endAngle:-3*Math.PI/2,center:["50%","50%"],gapRadius:0,innerRadius:0,outerRadius:"70%"};let DN=(t,e)=>{if(!t)return t;let i=e(),{width:r,height:n}=i;return new Dj(i).layout(t,{width:r,height:n})};class Dz extends CB{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>null==t?void 0:t[this.series.getDimensionField()[0]]}}let DH=(t,e,i="key",r="children")=>{for(let n=0;n<t.length;n++){let s=t[n];if(s[i]===e)return s;if(s[r]){let t=DH(s[r],e,i,r);if(t)return t}}return null},DV=(t,e,i="key",r="children")=>{for(let n=0;n<t.length;n++){let s=t[n];if(s[r])for(let t=0;t<s[r].length;t++){let n=s[r][t];if(n[i]===e)return s;let a=DV([n],e,i,r);if(a)return a}}return null},DW=(t,e,i="key",r="children")=>{let n=[],s=(t,a)=>{for(let o of t){if(o[i]===e)return n.push(...a,o[i].toString()),!0;if(o[r]){let t=s(o[r],[...a,o[i]]);if(!0===t)return t}}return!1};return s(t,[]),n};(tW=t7||(t7={})).DrillDown="drillDown",tW.DrillUp="drillUp";let DG=(t,e)=>{let i=e.info(),r=e.keyField(),n=null==i?void 0:i.key;if(ej(n))return t;if(i.type===t7.DrillDown)return om(DH(t,n,r,"children"));if(i.type===t7.DrillUp){let e=DV(t,n,r,"children");if(e)return om(e)}return t};class DU{_getDrillTriggerEvent(t){var e;let{mode:i}=this._drillParams;return null===(e=RN(i))||void 0===e?void 0:e[t]}_hideTooltip(){let t=this.getChart().getComponentsByType(lx.tooltip)[0];t&&t.hideTooltip()}initDrillable(t){this._drillParams=t}initDrillableData(t){let{getRawData:e}=this._drillParams;gw(t,"drillFilter",DG),e().transform({type:"drillFilter",options:{info:()=>this._drillInfo,keyField:()=>this._drillParams.drillField()}})}bindDrillEvent(){let{event:t,getRawData:e,drillField:i}=this._drillParams,r=i();this._getDrillTriggerEvent("start")&&t.on(this._getDrillTriggerEvent("start"),t=>{var i,n,s;if(ej(t.datum)||ej(null===(i=t.datum)||void 0===i?void 0:i[r]))return void this.drillUp();this._hideTooltip();let a=t.datum[r],o=null!==(s=null===(n=this._drillInfo)||void 0===n?void 0:n.path)&&void 0!==s?s:[],l=DW(e().rawData,a,r,"children");o[o.length-1]===l[l.length-1]?this.drillUp():this.drillDown(l)})}drillDown(t=[]){let{getRawData:e,event:i}=this._drillParams;if(!eM(t)||mk(t))return t;let r=t[t.length-1];return this._drillInfo={key:r,path:t,type:t7.DrillDown},e().reRunAllTransform(),i.emit(c1.drill,{value:{path:t,type:t7.DrillDown},model:this}),t}drillUp(){var t,e;let{getRawData:i,event:r}=this._drillParams,n=null!==(e=null===(t=this._drillInfo)||void 0===t?void 0:t.path)&&void 0!==e?e:[];if(!eM(n)||mk(n))return n;let s=n.pop();return this._drillInfo={key:s,path:n,type:t7.DrillUp},i().reRunAllTransform(),r.emit(c1.drill,{value:{path:n,type:t7.DrillUp},model:this}),n}}class D$ extends Rq{constructor(){super(...arguments),this.type=cZ.sunburst}setCategoryField(t){return this._categoryField=t,this._categoryField}getCategoryField(){return this._categoryField}setValueField(t){return this._valueField=t,this._valueField}getValueField(){return this._valueField}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:CW),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t;return null!==(t=this._spec.drillField)&&void 0!==t?t:bw},getRawData:()=>this.getRawData()}),this._startAngle=ik(this._spec.startAngle),this._endAngle=ik(this._spec.endAngle),this._centerX=this._spec.centerX,this._centerY=this._spec.centerY,this._offsetX=this._spec.offsetX,this._offsetY=this._spec.offsetY,this.__innerRadius=this._spec.innerRadius,this.__outerRadius=this._spec.outerRadius,this._gap=this._spec.gap,this._labelLayout=this._spec.labelLayout,this._sunburst=this._spec.sunburst,this._label=this._spec.label,this._labelAutoVisible=this._spec.labelAutoVisible}initData(){super.initData();let t=this.getRawData();t&&(this._spec.drill&&this.initDrillableData(this._dataSet),gw(this._dataSet,"sunburstLayout",DN),gw(this._dataSet,"flatten",DP),t.transform({type:"sunburstLayout",options:()=>{let{innerRadius:t,outerRadius:e,gap:i,label:r}=this._computeLevel();return{nodeKey:this._categoryField,width:this.getLayoutRect().width,height:this.getLayoutRect().height,center:[eO(this._centerX)?this._centerX:this.getLayoutRect().width/2,eO(this._centerY)?this._centerY:this.getLayoutRect().height/2],startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:t,outerRadius:e,gapRadius:i,label:r}}}),t.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}}))}getStatisticFields(){return super.getStatisticFields().concat([{key:this._categoryField,operations:["values"]},{key:this._valueField,operations:["max","min"]},{key:CV,operations:["max","min","values"]},{key:CW,operations:["values"]}])}_addDataIndexAndKey(){let t=this.getRawData();ej(null==t?void 0:t.dataSet)||(gw(t.dataSet,"addVChartProperty",CO),t.transform({type:"addVChartProperty",options:{beforeCall:CY.bind(this),call:CK}}))}initMark(){this._initArcMark(),this._initLabelMark()}initMarkStyle(){this._initArcMarkStyle(),this._initLabelMarkStyle()}_initArcMark(){var t,e;if(!1===this._sunburst.visible)return;let i=this._createMark(D$.mark.sunburst,{isSeriesMark:!0,customShape:null===(t=this._spec.sunburst)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.sunburst)||void 0===e?void 0:e.stateSort});this._sunburstMark=i}_initArcMarkStyle(){ej(this._sunburstMark)||this.setMarkStyle(this._sunburstMark,{x:t=>t.x+(eO(this._offsetX)?this._offsetX:0),y:t=>t.y+(eO(this._offsetY)?this._offsetY:0),outerRadius:t=>t.outerRadius,innerRadius:t=>t.innerRadius,startAngle:t=>t.startAngle,endAngle:t=>t.endAngle,fill:this.getColorAttribute()},tk.STATE_NORMAL,tw.Series)}_initLabelMark(){if(!0!==this._label.visible)return;let t=this._createMark(D$.mark.label,{isSeriesMark:!1});this._labelMark=t}_initLabelMarkStyle(){ej(this._labelMark)||this.setMarkStyle(this._labelMark,{visible:t=>{var e;let i=this._labelAutoVisible;return nb(i)&&!0===i.enable?(t.endAngle-t.startAngle)*(t.outerRadius-t.innerRadius)>(null!==(e=null==i?void 0:i.circumference)&&void 0!==e?e:10):this._spec.label.visible},x:t=>{var e;return(null===(e=t.label)||void 0===e?void 0:e.x)+(eO(this._offsetX)?this._offsetX:0)},y:t=>{var e;return(null===(e=t.label)||void 0===e?void 0:e.y)+(eO(this._offsetY)?this._offsetY:0)},textBaseline:t=>{var e;return null===(e=t.label)||void 0===e?void 0:e.textBaseline},textAlign:t=>{var e;return null===(e=t.label)||void 0===e?void 0:e.textAlign},angle:t=>{var e,i;return null!==(i=null===(e=t.label)||void 0===e?void 0:e.angle)&&void 0!==i?i:0},fontSize:10,text:t=>t.name},tk.STATE_NORMAL,tw.Series)}initTooltip(){this._tooltipHelper=new Dz(this),this._sunburstMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._sunburstMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}initAnimation(){var t,e;let i={animationInfo:()=>({innerRadius:this._computeRadius(om(this.__innerRadius))[0],outerRadius:this._computeRadius(om(this.__outerRadius))[0],startAngle:om(this._startAngle)[0],endAngle:om(this._endAngle)[0]})},r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this.getMarksInType("arc").forEach(t=>{var e;t.setAnimationConfig(CX(null===(e=de.getAnimationInKey("sunburst"))||void 0===e?void 0:e(i,r),Cq(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("text").forEach(t=>{var e;t.setAnimationConfig(CX(null===(e=de.getAnimationInKey("fadeInOut"))||void 0===e?void 0:e(),Cq(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.drill&&this.bindDrillEvent()}onLayoutEnd(t){super.onLayoutEnd(t),this._rawData.reRunAllTransform()}_computeRadius(t){return eM(t)?t.map(t=>this._computeLayoutRadius()*t):this._computeLayoutRadius()*t}_computeLevel(){return{innerRadius:this._computeRadius(this.__innerRadius),outerRadius:this._computeRadius(this.__outerRadius),gap:this._gap,label:this._labelLayout}}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._sunburstMark]}}D$.type=cZ.sunburst,D$.mark=h3,CS(D$,DU);let DY=()=>{de.registerSeries(D$.type,D$),Bt(),B9(),w7(),DE()};class DK extends OE{_getDefaultSeriesSpec(t){let e=eO(t.startAngle)?t.startAngle:-90,i=eO(t.endAngle)?t.endAngle:e+iA(2*Math.PI),r=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{categoryField:t.categoryField,valueField:t.valueField,seriesField:t.seriesField,centerX:t.centerX,centerY:t.centerY,offsetX:t.offsetX,offsetY:t.offsetY,startAngle:e,endAngle:i,innerRadius:t.innerRadius,outerRadius:t.outerRadius,gap:t.gap,labelLayout:t.labelLayout,label:t.label,labelAutoVisible:t.labelAutoVisible,drill:t.drill,drillField:t.drillField}),n=cZ.sunburst;return r.type=n,r[n]=t[n],r}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class DZ extends OD{constructor(){super(...arguments),this.transformerConstructor=DK,this.type="sunburst",this.seriesType=cZ.sunburst}}DZ.type="sunburst",DZ.seriesType=cZ.sunburst,DZ.transformerConstructor=DK;function DX(t,e){let i=t.radius-e.radius,r=e.x-t.x,n=e.y-t.y;return i<0||i*i<r*r+n*n}function Dq(t,e){let i=t.radius-e.radius+1e-9*Math.max(t.radius,e.radius,1),r=e.x-t.x,n=e.y-t.y;return i>0&&i*i>r*r+n*n}function DJ(t,e){for(let i=0;i<e.length;++i)if(!Dq(t,e[i]))return!1;return!0}function DQ(t,e){let i=t.x,r=t.y,n=t.radius,s=e.x,a=e.y,o=e.radius,l=s-i,h=a-r,u=o-n,d=Math.sqrt(l*l+h*h);return{x:(i+s+l/d*u)/2,y:(r+a+h/d*u)/2,radius:(d+n+o)/2}}function D0(t,e,i){let r=t.x,n=t.y,s=t.radius,a=e.x,o=e.y,l=e.radius,h=i.x,u=i.y,d=i.radius,c=r-a,p=r-h,g=n-o,f=n-u,m=l-s,v=d-s,y=r*r+n*n-s*s,_=y-a*a-o*o+l*l,b=y-h*h-u*u+d*d,x=p*g-c*f,S=(g*b-f*_)/(2*x)-r,k=(f*m-g*v)/x,A=(p*_-c*b)/(2*x)-n,w=(c*v-p*m)/x,M=k*k+w*w-1,C=2*(s+S*k+A*w),T=S*S+A*A-s*s,E=-(Math.abs(M)>1e-6?(C+Math.sqrt(C*C-4*M*T))/(2*M):T/C);return{x:r+S+k*E,y:n+A+w*E,radius:E}}function D1(t,e,i){let r,n,s,a;let o=t.x-e.x,l=t.y-e.y,h=o*o+l*l;h?(n=e.radius+i.radius,n*=n,a=t.radius+i.radius,n>(a*=a)?(r=(h+a-n)/(2*h),s=Math.sqrt(Math.max(0,a/h-r*r)),i.x=t.x-r*o-s*l,i.y=t.y-r*l+s*o):(r=(h+n-a)/(2*h),s=Math.sqrt(Math.max(0,n/h-r*r)),i.x=e.x+r*o-s*l,i.y=e.y+r*l+s*o)):(i.x=e.x+i.radius,i.y=e.y)}function D2(t,e){let i=t.radius+e.radius-1e-6,r=e.x-t.x,n=e.y-t.y;return i>0&&i*i>r*r+n*n}function D3(t){let e=t._,i=t.next._,r=e.radius+i.radius,n=(e.x*i.radius+i.x*e.radius)/r,s=(e.y*i.radius+i.y*e.radius)/r;return n*n+s*s}function D5(t){return{_:t,next:null,prev:null}}function D4(t){return function(e){e.children||(e.radius=Math.max(0,+t(e)||0))}}function D8(t,e,i){return function(r){let n=null==r?void 0:r.children;if(n){let s;let a=n.length,o=t(r)*e||0;if(o)for(s=0;s<a;++s)n[s].radius+=o;let l=function(t,e){let i=(t=om(t)).length;if(!i)return 0;let r=t[0];if(r.x=0,r.y=0,1===i)return r.radius;let n=t[1];if(r.x=-n.radius,n.x=r.radius,n.y=0,2===i)return r.radius+n.radius;let s=t[2];D1(n,r,s);let a,o,l,h,u,d,c,p=D5(r),g=D5(n),f=D5(s);p.next=g,f.prev=g,g.next=f,p.prev=f,f.next=p,g.prev=p;for(let e=3;e<i;++e){c=!1,s=t[e],D1(p._,g._,s),f=D5(s),a=g.next,o=p.prev,l=g._.radius,h=p._.radius;do if(l<=h){if(D2(a._,f._)){g=a,p.next=g,g.prev=p,--e,c=!0;break}l+=a._.radius,a=a.next}else{if(D2(o._,f._)){(p=o).next=g,g.prev=p,--e,c=!0;break}h+=o._.radius,o=o.prev}while(a!==o.next);if(!c){for(f.prev=p,f.next=g,p.next=g.prev=g=f,u=D3(p),f=f.next;f!==g;)(d=D3(f))<u&&(p=f,u=d),f=f.next;g=p.next}}let m=[g._];for(f=g.next;f!==g;)m.push(f._),f=f.next;s=function(t,e){let i=0,r=ox(Array.from(t),e),n=r.length,s,a,o=[];for(;i<n;)s=r[i],a&&Dq(a,s)?++i:(a=function(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,radius:t.radius}}(t[0]);case 2:return DQ(t[0],t[1]);case 3:return D0(t[0],t[1],t[2])}}(o=function(t,e){let i,r;if(DJ(e,t))return[e];for(i=0;i<t.length;++i)if(DX(e,t[i])&&DJ(DQ(t[i],e),t))return[t[i],e];for(i=0;i<t.length-1;++i)for(r=i+1;r<t.length;++r)if(DX(DQ(t[i],t[r]),e)&&DX(DQ(t[i],e),t[r])&&DX(DQ(t[r],e),t[i])&&DJ(D0(t[i],t[r],e),t))return[t[i],t[r],e];ex.getInstance().error("error when packEncloseRandom")}(o,s)),i=0);return a}(m,e);for(let e=0;e<i;++e)r=t[e],r.x-=s.x,r.y-=s.y;return s.radius}(n,i);if(o)for(s=0;s<a;++s)n[s].radius-=o;r.radius=l+o}}}function D6(t,e){return function(i,r,n){i.radius*=t,i.maxDepth=e,n&&(i.x=n.x+t*i.x,i.y=n.y+t*i.y)}}class D9{constructor(t){this.options=t;let e=null==t?void 0:t.nodeKey,i=nx(e)?e:e?fl(e):null;this._getNodeKey=i,this._getPadding=ey(null==t?void 0:t.padding)?e=>t.padding:eM(null==t?void 0:t.padding)?e=>{var i;return null!==(i=t.padding[e.depth+1])&&void 0!==i?i:0}:()=>0,this._maxDepth=-1}layout(t,e){var i;let r="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};if(!t||!t.length)return[];let n=[],s=DI(t,n,0,-1,null,this._getNodeKey);this._maxDepth=s.maxDepth;let a=function(t=1){let e=t;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}(),o={flattenIndex:-1,maxDepth:-1,key:"root",depth:-1,index:-1,value:s.sum,datum:null,children:n,x:r.x0+r.width/2,y:r.y0+r.height/2},{nodeSort:l,setRadius:h,padding:u,includeRoot:d}=null!==(i=this.options)&&void 0!==i?i:{};if(!1!==l){let t=nx(l)?this.options.nodeKey:D9.defaultOpionts.nodeSort;DL([o],e=>{e.children&&e.children.length&&e.children.sort(t)})}if(h)DL([o],D4(h)),DD([o],D8(this._getPadding,.5,a)),DL([o],D6(1,this._maxDepth));else{let t=Math.min(r.width,r.height);DL([o],D4(D9.defaultOpionts.setRadius)),DD([o],D8(fu,1,a)),u&&DD([o],D8(this._getPadding,o.radius/t,a)),DL([o],D6(t/(2*o.radius),this._maxDepth))}return d?[o]:n}}D9.defaultOpionts={setRadius:t=>Math.sqrt(t.value),padding:0,nodeSort:(t,e)=>e.value-t.value};let D7=(t,e)=>{if(!t)return t;let i=e(),{width:r,height:n}=i;return 0===r||0===n?t:new D9(i).layout(t,{width:r,height:n})};class Ft extends CB{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>null==t?void 0:t[this.series.getDimensionField()[0]]}}let Fe=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"growRadiusIn"},Fi=()=>{de.registerAnimation("circlePacking",(t,e)=>({appear:Fe(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}))};class Fr extends C6{constructor(){super(...arguments),this.type=cZ.circlePacking}setCategoryField(t){return this._categoryField=t,this._categoryField}getCategoryField(){return this._categoryField}setValueField(t){return this._valueField=t,this._valueField}getValueField(){return this._valueField}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:CW),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t;return null!==(t=this._spec.drillField)&&void 0!==t?t:bw},getRawData:()=>this.getRawData()}),this._circlePacking=this._spec.circlePacking,this._label=this._spec.label,this._layoutPadding=this._spec.layoutPadding}initData(){super.initData();let t=this.getRawData();ej(t)||(this._spec.drill&&this.initDrillableData(this._dataSet),gw(this._dataSet,"circlePackingLayout",D7),gw(this._dataSet,"flatten",DP),t.transform({type:"circlePackingLayout",options:()=>({nodeKey:this._categoryField,padding:this._layoutPadding,includeRoot:!1,width:this.getLayoutRect().width||1,height:this.getLayoutRect().height||1})}),t.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}}))}_addDataIndexAndKey(){let t=this.getRawData();ej(null==t?void 0:t.dataSet)||(gw(t.dataSet,"addVChartProperty",CO),t.transform({type:"addVChartProperty",options:{beforeCall:CY.bind(this),call:CK}}))}initMark(){this._initCirclePackingMark(),this._initLabelMark()}initMarkStyle(){this._initCirclePackingMarkStyle(),this._initLabelMarkStyle()}_initCirclePackingMark(){var t,e;if(!1===(null===(t=this._circlePacking)||void 0===t?void 0:t.visible))return;let i=this._createMark(Fr.mark.circlePacking,{isSeriesMark:!0,customShape:null===(e=this._spec.circlePacking)||void 0===e?void 0:e.customShape});this._circlePackingMark=i}_initCirclePackingMarkStyle(){ej(this._circlePackingMark)||this.setMarkStyle(this._circlePackingMark,{x:t=>t.x,y:t=>t.y,outerRadius:t=>t.radius,innerRadius:0,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),zIndex:t=>t.depth},tk.STATE_NORMAL,tw.Series)}_initLabelMark(){var t;if(!1===(null===(t=this._label)||void 0===t?void 0:t.visible))return;let e=this._createMark(Fr.mark.label,{isSeriesMark:!1});this._labelMark=e}_initLabelMarkStyle(){ej(this._labelMark)||this.setMarkStyle(this._labelMark,{x:t=>t.x,y:t=>t.y,text:t=>t.key,cursor:"pointer"},tk.STATE_NORMAL,tw.Series)}getStatisticFields(){return super.getStatisticFields().concat([{key:this._categoryField,operations:["values"]},{key:this._valueField,operations:["max","min"]},{key:CV,operations:["max","min","values"]},{key:CW,operations:["values"]}])}initTooltip(){this._tooltipHelper=new Ft(this),this._tooltipHelper.updateTooltipSpec(),this._circlePackingMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circlePackingMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}initAnimation(){var t;let e=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this.getMarksInType("arc").forEach(t=>{var i;t.setAnimationConfig(CX(null===(i=de.getAnimationInKey("circlePacking"))||void 0===i?void 0:i(void 0,e),Cq(t.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("text").forEach(t=>{var e;t.setAnimationConfig(CX(null===(e=de.getAnimationInKey("scaleInOut"))||void 0===e?void 0:e(),Cq(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.drill&&this.bindDrillEvent()}onLayoutEnd(t){super.onLayoutEnd(t),this._rawData.reRunAllTransform()}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._circlePackingMark]}}Fr.type=cZ.circlePacking,Fr.mark=h8,CS(Fr,DU);let Fn=()=>{de.registerSeries(Fr.type,Fr),Bt(),B9(),w9(),Fi()};class Fs extends OE{_getDefaultSeriesSpec(t){let e=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{categoryField:t.categoryField,valueField:t.valueField,seriesField:t.seriesField,layoutPadding:t.layoutPadding,label:t.label,circlePacking:t.circlePacking,drill:t.drill,drillField:t.drillField}),i=cZ.circlePacking;return e.type=i,e[i]=t[i],e}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class Fa extends OD{constructor(){super(...arguments),this.transformerConstructor=Fs,this.type="circlePacking",this.seriesType=cZ.circlePacking}}Fa.type="circlePacking",Fa.seriesType=cZ.circlePacking,Fa.transformerConstructor=Fs;function Fo(t,e,i,r,n){let s=t.children,a,o=-1,l=s.length,h=t.value&&(n-i)/t.value;for(;++o<l;)(a=s[o]).x0=e,a.x1=r,a.y0=i,i+=a.value*h,a.y1=i}let Fl=t=>(e,i,r,n,s)=>{!function(t,e,i,r,n,s){let a=[],o=e.children,l,h,u=0,d=0,c=o.length,p,g,f,m,v,y,_,b,x,S=e.value;for(;u<c;){p=n-i,g=s-r;do f=o[d++].value;while(!f&&d<c);for(m=f,_=Math.max((v=f)/(x=f*f*(b=Math.max(g/p,p/g)/(S*t))),x/m);d<c;++d){if(f+=h=o[d].value,h<m&&(m=h),h>v&&(v=h),(y=Math.max(v/(x=f*f*b),x/m))>_){f-=h;break}_=y}l=Object.assign({},e,{value:f,children:o.slice(u,d)}),a.push(l),p<g?DR(l,i,r,n,S?r+=g*f/S:s):Fo(l,i,r,S?i+=p*f/S:n,s),S-=f,u=d};}(t,e,i,r,n,s)},Fh={binary:function(t,e,i,r,n){let s=t.children,a=s.length,o=0,l=Array(a+1);l[0]=0;for(let t=0;t<a;++t)o+=s[t].value,l[t+1]=o;let h=(t,e,i,r,n,a,o)=>{if(t>=e-1){let e=s[t];return e.x0=r,e.y0=n,e.x1=a,void(e.y1=o)}let u=l[t],d=i/2+u,c=t+1,p=e-1;for(;c<p;){let t=c+p>>>1;l[t]<d?c=t+1:p=t}d-l[c-1]<l[c]-d&&t+1<c&&--c;let g=l[c]-u,f=i-g;if(a-r>o-n){let s=i?(r*f+a*g)/i:a;h(t,c,g,r,n,s,o),h(c,e,f,s,n,a,o)}else{let s=i?(n*f+o*g)/i:o;h(t,c,g,r,n,a,s),h(c,e,f,r,s,a,o)}};h(0,a,t.value,e,i,r,n)},dice:DR,slice:Fo,sliceDice:function(t,e,i,r,n){(t.depth%2==1?Fo:DR)(t,e,i,r,n)}};class Fu{constructor(t){var e;this._filterByArea=(t,e)=>{var i;let r=this._getMinAreaByDepth(t.depth);if(r>0&&t.value*e<r)return!1;if(null===(i=t.children)||void 0===i?void 0:i.length){let i=t.children.filter(t=>this._filterByArea(t,e));i.length?i.length!==t.children.length&&(t.children=i):(t.isLeaf=!0,t.children=null)}return!0},this._getMinAreaByDepth=t=>{var e;return t<0?0:null!==(e=eM(this.options.minVisibleArea)?this.options.minVisibleArea[t]:this.options.minVisibleArea)&&void 0!==e?e:0},this._getGapWidthByDepth=t=>{var e;return t<0?0:null!==(e=eM(this.options.gapWidth)?this.options.gapWidth[t]:this.options.gapWidth)&&void 0!==e?e:0},this._getPaddingByDepth=t=>{var e;return t<0?0:null!==(e=eM(this.options.padding)?this.options.padding[t]:this.options.padding)&&void 0!==e?e:0},this._getLabelPaddingByDepth=t=>{var e;return t<0?0:null!==(e=eM(this.options.labelPadding)?this.options.labelPadding[t]:this.options.labelPadding)&&void 0!==e?e:0},this._layoutNode=t=>{let e=this._getGapWidthByDepth(t.depth),i=t.x0,r=t.y0,n=t.x1,s=t.y1;if(t.maxDepth=this._maxDepth,e>0&&(i+=e/2,n-=e/2,r+=e/2,s-=e/2,i>n&&(n=i=(i+n)/2),r>s&&(s=r=(r+s)/2),t.x0=i,t.x1=n,t.y0=r,t.y1=s),t.children){let e=this._getLabelPaddingByDepth(t.depth),a=this._getPaddingByDepth(t.depth);a>0&&a<Math.min(n-i,s-r)/2&&(r+=a,s-=a,i+=a,n-=a),e>0&&("top"===this.options.labelPosition&&r+e<s?(t.labelRect={x0:i,y0:r,x1:n,y1:r+e},r+=e):"bottom"===this.options.labelPosition&&s-e>r?(t.labelRect={x0:i,y0:s-e,x1:n,y1:s},s-=e):"left"===this.options.labelPosition&&i+e<n?(t.labelRect={x0:i,y0:r,x1:i+e,y1:s},i+=e):"right"===this.options.labelPosition&&n-e>i&&(t.labelRect={x0:n-e,y0:r,x1:n,y1:s},n-=e));let o=this._getGapWidthByDepth(t.depth+1);o>0&&(i-=o/2,n+=o/2,r-=o/2,s+=o/2),this._splitNode(t,i,r,n,s)}},this.options=Object.assign({},Fu.defaultOpionts,t);let i=this.options.nodeKey,r=nx(i)?i:i?fl(i):null;this._getNodeKey=r,this._splitNode="squarify"===this.options.splitType?Fl(this.options.aspectRatio):null!==(e=Fh[this.options.splitType])&&void 0!==e?e:Fh.binary,this._maxDepth=-1}layout(t,e){var i;if(!t||!t.length)return[];let r="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)},n=[],s=DI(t,n,0,-1,null,this._getNodeKey);if(this._maxDepth=s.maxDepth,s.sum<=0)return[];let a={flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:s.sum,datum:null,x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1,children:n},o=r.width*r.height/s.sum;return this._filterByArea(a,o),this._layout(a),null!==(i=a.children)&&void 0!==i?i:[]}_filterChildren(t){let e=this.options.maxDepth;if(ey(e)&&e>=0&&t.depth>=e)return!1;let i=this.options.minChildrenVisibleArea;if(ey(i)&&Math.abs((t.x1-t.x0)*(t.y1-t.y0))<i)return!1;let r=this.options.minChildrenVisibleSize;return!ey(r)||!(Math.abs(t.x1-t.x0)<r||Math.abs(t.y1-t.y0)<r)}_layout(t){var e;this._filterChildren(t)||(t.children=null,t.isLeaf=!0),this._layoutNode(t),(null===(e=t.children)||void 0===e?void 0:e.length)&&t.children.forEach(t=>{var e;(null===(e=null==t?void 0:t.children)||void 0===e?void 0:e.length)?this._layout(t):this._layoutNode(t)})}}Fu.defaultOpionts={aspectRatio:(1+Math.sqrt(5))/2,gapWidth:0,labelPadding:0,labelPosition:"top",splitType:"binary",minVisibleArea:10};let Fd=(t,e)=>{let i=new Fu(t).layout(e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});if(t.flatten){let e=[];return DO(i,e,{maxDepth:null==t?void 0:t.maxDepth}),e}return i},Fc=()=>{d0.registerTransform("treemap",{transform:Fd,markPhase:"beforeJoin"},!0)},Fp=(t,e)=>{let i={},r=e.fields;return(nx(r)&&(r=r()),(null==r?void 0:r.length)&&(null==t?void 0:t.length)&&t[0].latestData)?Cj([{latestData:DP(t[0].latestData)}],e):i};class Fg extends CB{constructor(){super(...arguments),this.markTooltipKeyCallback=t=>null==t?void 0:t[this.series.getDimensionField()[0]]}get defaultShapeType(){return"square"}}let Ff=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"growCenterIn"},Fm=()=>{de.registerAnimation("treemap",(t,e)=>({appear:Ff(e),enter:{type:"growCenterIn"},exit:{type:"growCenterOut"},disappear:{type:"growCenterOut"}}))};class Fv extends C3{_transformLabelSpec(t){this._addMarkLabelSpec(t,"nonLeaf","nonLeafLabel","initNonLeafLabelMarkStyle"),this._addMarkLabelSpec(t,"leaf")}}class Fy extends C6{constructor(){super(...arguments),this.type=cZ.treemap,this.transformerConstructor=Fv,this._viewBox=new iB,this._enableAnimationHook=this.enableMarkAnimation.bind(this),this.isHierarchyData=()=>!0}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:CW),this._spec.roam&&(this.initZoomable(this.event,this._option.mode),this._matrix=new iE),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var t,e;return null!==(e=null!==(t=this._spec.drillField)&&void 0!==t?t:this._categoryField)&&void 0!==e?e:bw},getRawData:()=>this.getRawData()}),l1(this._spec.maxDepth)&&(this._maxDepth=this._spec.maxDepth-1)}initData(){super.initData(),this.getViewData()&&this._spec.drill&&this.initDrillableData(this._dataSet)}compile(){super.compile(),this._runTreemapTransform()}_runTreemapTransform(t=!1){var e,i,r,n;let s=this._data.getProduct();s&&s.transform([{type:"treemap",x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2,maxDepth:this._maxDepth,gapWidth:this._spec.gapWidth,padding:this._spec.nodePadding,splitType:this._spec.splitType,aspectRatio:this._spec.aspectRatio,labelPadding:(null===(e=this._spec.nonLeafLabel)||void 0===e?void 0:e.visible)?null===(i=this._spec.nonLeafLabel)||void 0===i?void 0:i.padding:0,labelPosition:null===(r=this._spec.nonLeafLabel)||void 0===r?void 0:r.position,minVisibleArea:null!==(n=this._spec.minVisibleArea)&&void 0!==n?n:10,minChildrenVisibleArea:this._spec.minChildrenVisibleArea,minChildrenVisibleSize:this._spec.minChildrenVisibleSize,flatten:!0},{type:"map",callback:t=>(t&&[CW,"name"].forEach(e=>{t[e]=t.datum[t.depth][e]}),t)}]),t&&this.getCompiler().renderNextTick()}_addDataIndexAndKey(){var t;(null===(t=this._rawData)||void 0===t?void 0:t.dataSet)&&(gw(this._rawData.dataSet,"addVChartProperty",CO),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:CY.bind(this),call:CK}}))}getRawDataStatisticsByField(t,e){var i;if(!this._rawDataStatistics){let t=`${this.type}_${this.id}_rawDataStatic`;this._rawDataStatistics=this._createHierarchyDataStatistics(t,[this._rawData]),this._rawData.target.removeListener("change",this._rawDataStatistics.reRunAllTransform),this._rawDataStatistics.reRunAllTransform()}return null===(i=this._rawDataStatistics.latestData)||void 0===i?void 0:i[t]}_createHierarchyDataStatistics(t,e){gw(this._dataSet,"hierarchyDimensionStatistics",Fp),gw(this._dataSet,"flatten",DP);let i=new eH(this._dataSet,{name:t});return i.parse(e,{type:"dataview"}),i.transform({type:"hierarchyDimensionStatistics",options:{fields:()=>{let t=this.getStatisticFields();return this._seriesField&&this._seriesField!==this._categoryField&&t.push({key:this._seriesField,operations:["values"]}),t}}},!1),i}getStatisticFields(){return super.getStatisticFields().concat([{key:this._categoryField,operations:["values"]},{key:this._valueField,operations:["max","min"]},{key:CV,operations:["max","min","values"]},{key:CW,operations:["values"]}])}initMark(){var t,e,i,r;let n=this._createMark(Fy.mark.nonLeaf,{isSeriesMark:!0,customShape:null===(t=this._spec.nonLeaf)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.nonLeaf)||void 0===e?void 0:e.stateSort});n&&(n.setTransform([{type:"filter",callback:t=>!this._shouldFilterElement(t,"nonLeaf")}]),this._nonLeafMark=n);let s=this._createMark(Fy.mark.leaf,{isSeriesMark:!0,customShape:null===(i=this._spec.leaf)||void 0===i?void 0:i.customShape,stateSort:null===(r=this._spec.leaf)||void 0===r?void 0:r.stateSort});s&&(s.setTransform([{type:"filter",callback:t=>!this._shouldFilterElement(t,"leaf")}]),this._leafMark=s)}initMarkStyle(){this._initLeafMarkStyle(),this._initNonLeafMarkStyle()}_initLeafMarkStyle(){this._leafMark&&this.setMarkStyle(this._leafMark,{x:t=>t.x0,y:t=>t.y0,x1:t=>t.x1,y1:t=>t.y1,fill:this.getColorAttribute()},tk.STATE_NORMAL,tw.Series)}_initNonLeafMarkStyle(){this._nonLeafMark&&this.setMarkStyle(this._nonLeafMark,{x:t=>t.x0,y:t=>t.y0,x1:t=>t.x1,y1:t=>t.y1,fill:this.getColorAttribute()},tk.STATE_NORMAL,tw.Series)}initLabelMarkStyle(t){t&&(this._labelMark=t,t.setRule("treemap"),this.setMarkStyle(t,{x:t=>(t.x0+t.x1)/2,y:t=>(t.y0+t.y1)/2,text:t=>{var e;return null===(e=t.datum[t.depth])||void 0===e?void 0:e[this.getDimensionField()[0]]},maxLineWidth:t=>t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0},tk.STATE_NORMAL,tw.Series),"rich"===t.getTextType()&&this.setMarkStyle(t,{maxWidth:t=>Math.abs(t.x0-t.x1),maxHeight:t=>Math.abs(t.y0-t.y1),ellipsis:!0},tk.STATE_NORMAL,tw.Series))}initNonLeafLabelMarkStyle(t){t&&(this._nonLeafLabelMark=t,t.setRule("treemap"),this.setMarkStyle(t,{x:t=>t.labelRect?(t.labelRect.x0+t.labelRect.x1)/2:(t.x0+t.x1)/2,y:t=>t.labelRect?(t.labelRect.y0+t.labelRect.y1)/2:(t.y0+t.y1)/2,text:t=>{var e;return null===(e=t.datum[t.depth])||void 0===e?void 0:e[this.getDimensionField()[0]]},maxLineWidth:t=>t.x1===t.x0?Number.MIN_VALUE:t.x1-t.x0},tk.STATE_NORMAL,tw.Series),"rich"===t.getTextType()&&this.setMarkStyle(t,{maxWidth:t=>Math.abs(t.x0-t.x1),maxHeight:t=>Math.abs(t.y0-t.y1),ellipsis:!0},tk.STATE_NORMAL,tw.Series))}initAnimation(){this.getMarksInType("rect").forEach(t=>{var e;t.setAnimationConfig(CX(null===(e=de.getAnimationInKey("treemap"))||void 0===e?void 0:e(),Cq(t.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.roam&&(this.initDragEventOfSeries(this),this.event.on("panmove",t=>{this.handlePan(t)}),this.initZoomEventOfSeries(this),this.event.on("zoom",t=>{this.handleZoom(t)})),this._spec.drill&&this.bindDrillEvent()}_getDataIdKey(){return"key"}initTooltip(){this._tooltipHelper=new Fg(this),this._leafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._leafMark),this._nonLeafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nonLeafMark)}_shouldFilterElement(t,e){let i=t.isLeaf;return"leaf"===e?!i:i}handlePan(t){let{delta:e}=t;if(0===e[0]&&0===e[1])return;this._matrix.reset(),this._matrix.translate(e[0],e[1]);let{a:i,b:r,c:n,d:s,e:a,f:o}=this._matrix;this._matrix.multiply(i,r,n,s,a,o),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}handleZoom(t){let{scale:e,scaleCenter:i}=t;if(1===e)return;this._matrix.reset();let{x:r,y:n}=i;this._matrix.translate(r,n),this._matrix.scale(e,e),this._matrix.translate(-r,-n);let{a:s,b:a,c:o,d:l,e:h,f:u}=this._matrix;this._matrix.multiply(s,a,o,l,h,u),this.disableMarkAnimation(),this.event.on(pa.AFTER_DO_RENDER,this._enableAnimationHook),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(t){super.onLayoutEnd(t),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runTreemapTransform()}enableMarkAnimation(){this.getMarks().forEach(t=>{var e;null===(e=t.getProduct().animate)||void 0===e||e.enable()}),[this._labelMark,this._nonLeafLabelMark].forEach(t=>{t&&t.getComponent()&&t.getComponent().getProduct().getGroupGraphicItem().enableAnimation()}),this.event.off(pa.AFTER_DO_RENDER,this._enableAnimationHook)}disableMarkAnimation(){this.getMarks().forEach(t=>{var e;null===(e=t.getProduct().animate)||void 0===e||e.disable()}),[this._labelMark,this._nonLeafLabelMark].forEach(t=>{t&&t.getComponent()&&t.getComponent().getProduct().getGroupGraphicItem().disableAnimation()})}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._nonLeafMark,this._leafMark]}}Fy.type=cZ.treemap,Fy.mark=hQ,Fy.transformerConstructor=Fv,CS(Fy,DU),CS(Fy,RH);let F_=()=>{O2(),B9(),Fm(),w7(),Fc(),de.registerSeries(Fy.type,Fy)};class Fb extends OE{_getDefaultSeriesSpec(t){let e=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{categoryField:t.categoryField,valueField:t.valueField,seriesField:t.seriesField,aspectRatio:t.aspectRatio,splitType:t.splitType,maxDepth:t.maxDepth,gapWidth:t.gapWidth,nodePadding:t.nodePadding,minVisibleArea:t.minVisibleArea,minChildrenVisibleArea:t.minChildrenVisibleArea,minChildrenVisibleSize:t.minChildrenVisibleSize,roam:t.roam,drill:t.drill,drillField:t.drillField,leaf:t.leaf,nonLeaf:t.nonLeaf,nonLeafLabel:t.nonLeafLabel}),i=this.seriesType;return i&&(e.type=i,e[i]=t[i]),e}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class Fx extends OD{constructor(){super(...arguments),this.transformerConstructor=Fb,this.type="treemap",this.seriesType=cZ.treemap}}Fx.type="treemap",Fx.seriesType=cZ.treemap,Fx.transformerConstructor=Fb;let FS=`${hA}_waterfall_default_seriesField`,Fk=(t,e)=>{if(!t||0===t.length)return t;let{indexField:i,total:r,groupData:n}=e,s=[],{dimensionValues:a,dimensionData:o}=n().latestData,l=Array.from(a[i]),h={start:0,end:0,positive:0,negative:0,lastIndex:null};return l.forEach((t,i)=>{let n={start:h.end,end:h.end,lastIndex:h.lastIndex,lastEnd:h.end,index:t,isTotal:!1,positive:h.end,negative:h.end},a=o[t];if(null==a||a.forEach((t,e)=>{e===a.length-1?t[bF]=!0:delete t[bF]}),a.length>1){let o=t=>{if(r&&"end"!==r.type){if("field"===r.type||"custom"===r.type)return!!t[r.tagField]}else if(i===l.length-1)return!0;return!1};if(a.some(t=>o(t)))return h=function(t,e,i,r,n,s,a,o,l){i.isTotal=!0;let{valueField:h,startAs:u,endAs:d,total:c}=o,p=[],g=[];if(t.forEach(t=>{l(t)?g.push(t):p.push(t)}),g.length===t.length){let l=FA([t[0]],e,i,r,n,s,a,o);return g.forEach(e=>{e[u]=t[0][u],e[d]=t[0][d],e[h]=t[0][h]}),l}let{start:f,end:m}=Fw(g[0],i,r,n,c);i.start=f,i.end=m;let v=f,y=f,_=m-f;return p.forEach(t=>{let e=+t[h];e>=0?(t[u]=+v,v=ix(v,e)):(t[u]=+y,y=ix(y,e)),t[d]=ix(t[u],e),f=ix(f,e),_=iS(_,e)}),g.forEach(t=>{t[u]=+f,t[d]=ix(t[u],_),t[h]=_}),Object.assign(Object.assign({},i),{lastIndex:e})}(a,t,n,s,h,l,i,e,o),void s.push(n)}h=FA(a,t,n,s,h,l,i,e),s.push(n)}),s};function FA(t,e,i,r,n,s,a,o){let{valueField:l,startAs:h,endAs:u,total:d,seriesField:c,seriesFieldName:p}=o;return t.forEach(t=>{let e=!1;if(d&&"end"!==d.type){if(("field"===d.type||"custom"===d.type)&&t[d.tagField]){e=!0;let{start:s,end:a}=Fw(t,i,r,n,d);t[h]=s,t[u]=a,t[l]=a-s,i.start=s,i.end=a}}else a===s.length-1&&(i.start=0,t[h]=i.start,t[u]=i.end,e=!0);if(!e){let e=+t[l];e>=0?(t[h]=+i.positive,i.positive=ix(i.positive,e)):(t[h]=+i.negative,i.negative=ix(i.negative,e)),t[u]=ix(t[h],e),i.end=ix(i.end,e)}i.isTotal=e,(ej(c)||c===FS)&&(t[FS]=e?p.total:+t[l]>=0?p.increase:p.decrease)}),Object.assign(Object.assign({},i),{lastIndex:e})}function Fw(t,e,i,r,n){return n&&"end"!==n.type?"field"===n.type||"custom"===n.type?"custom"===n.type?function(t,e,i){return i.product(t,e)}(t,r,n):n.collectCountField&&!ej(t[n.collectCountField])?function(t,e,i,r){let n=0,s=i.end,a=e.length-+t[r.collectCountField],o=e.length-1;return a<0?hd("total.collectCountField error"):n=e[a].start,o<0?hd("total.collectCountField error"):s=e[o].end,{start:n,end:s}}(t,i,e,n):function(t,e,i){let r=0,n=e.end;return i.startField&&!ej(t[i.startField])&&(r=+t[i.startField]),i.valueField&&!ej(t[i.valueField])&&(n=ix(r,+t[i.valueField])),{start:r,end:n}}(t,e,n):{start:0,end:0}:function(t){return{start:0,end:t.end}}(e)}let FM=(t,e)=>{if(!t)return t;let{indexField:i,valueField:r,total:n,seriesField:s}=e,a={[i]:(null==n?void 0:n.text)||"total",[r]:t.reduce((t,e)=>ix(t,+e[r]),0)};return s&&(a[s]="total"),t.push(a),t},FC={type:"fadeIn"},FT={type:"growCenterIn"},FE=()=>{de.registerAnimation("waterfall",(t,e)=>({appear:function(t,e){switch(e){case"fadeIn":return FC;case"scaleIn":return FT;default:return OK(t,!1)}}(t,e),enter:OK(t,!1),exit:OZ(t,!1),disappear:OZ(t,!1)}))},FO=(t,e)=>{if(!e.fields)return t;let i={};return{dimensionValues:i,dimensionData:function t(e,i,r){if(0===i.length)return e;let n=i[0],s=i.slice(1);r[n]=new Set;let a=function(t,e,i){let r={};return t.forEach(t=>{let n=t[e];r[n]||(r[n]=[],i.add(n)),r[n].push(t)}),r}(e,n,r[n]);return s.length?function(t,e){return Object.keys(t).reduce((i,r)=>(i[r]=e(t[r],r),i),{})}(a,(e,i)=>t(e,s,r)):a}(t.map(t=>t.latestData).flat(),e.fields,i)}};class FP{get fields(){return this._fields}get groupData(){return this._groupData}constructor(t){this._fields=[],this._fields=t}initData(t,e){let i=t.name,r=new eH(e instanceof eA?e:t.dataSet);r.name=i,r.parse([t],{type:"dataview"}),gw(e,"dimensionTree",FO),r.transform({type:"dimensionTree",options:{fields:this._fields}},!1),r.target.addListener("change",this.groupDataUpdate.bind(this)),this._groupData=r}groupDataUpdate(){}getGroupValueInField(t){var e,i,r;let n=null===(r=null===(i=null===(e=this.groupData)||void 0===e?void 0:e.latestData)||void 0===i?void 0:i.dimensionValues)||void 0===r?void 0:r[t];return n?Array.from(n):[]}}class FR extends O5{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(t){this._addMarkLabelSpec(t,"bar"),this._addMarkLabelSpec(t,"bar","stackLabel","initStackLabelMarkStyle")}}let FB={rect:FF,symbol:FD,arc:Fj,point:function(t){let{labelSpec:e}=t;return{position:"center",overlap:!1!==e.overlap&&{avoidBaseMark:!1}}},"line-data":function(t){let e=FD(t);return ew(e.overlap)||(e.overlap.avoidBaseMark=!1),e},stackLabel:FN,line:Fz,area:Fz,rect3d:FF,arc3d:Fj,treemap:function(t){return{customLayoutFunc:(t,e)=>e,overlap:!1}},venn:function(t){return{customLayoutFunc:(t,e)=>e,smartInvert:!0}}};function FI(t,e,i,r){var n;let{labelMark:s,series:a}=t,o={text:e[a.getMeasureField()[0]],data:e,textType:null!==(n=t.labelSpec.textType)&&void 0!==n?n:"text"};for(let t of Object.keys(s.stateStyle.normal)){let i=s.getAttribute(t,e);o[t]=i}let{formatFunc:l,args:h}=TV(i,r,o.text,e);return l&&(o.text=l(...h,{series:a})),o}function FL(t){return nx(t)?e=>t(e.data):t}function FD(t){var e,i,r;let n;let{series:s,labelSpec:a}=t,o="horizontal"===s.direction?"right":"top",l=null!==(e=FL(a.position))&&void 0!==e?e:o;return n=!1!==a.overlap&&{strategy:null!==(r=null===(i=a.overlap)||void 0===i?void 0:i.strategy)&&void 0!==r?r:function(){return[{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}]}(),avoidBaseMark:"center"!==l},{position:l,overlap:n}}function FF(t){var e,i,r,n,s,a;let{series:o,labelSpec:l={}}=t,h=null!==(e=FL(l.position))&&void 0!==e?e:"outside",u=null!==(i=o.direction)&&void 0!==i?i:"vertical",d="horizontal"===o.direction?null===(r=o.getXAxisHelper())||void 0===r?void 0:r.isInverse():null===(n=o.getYAxisHelper())||void 0===n?void 0:n.isInverse(),c,p=h;eE(h)&&"outside"===h&&(p=t=>{let{data:e}=t,i=o.getMeasureField()[0];return({vertical:["top","bottom"],horizontal:["right","left"]})[u][(null==e?void 0:e[i])>=0&&d||(null==e?void 0:e[i])<0&&!d?1:0]}),c=!1!==l.overlap&&{strategy:null!==(a=null===(s=l.overlap)||void 0===s?void 0:s.strategy)&&void 0!==a?a:function(t){return[{type:"position",position:e=>{var i,r;let{data:n}=e,s=t.getMeasureField()[0];return("horizontal"===t.direction?null===(i=t.getXAxisHelper())||void 0===i?void 0:i.isInverse():null===(r=t.getYAxisHelper())||void 0===r?void 0:r.isInverse())?(null==n?void 0:n[s])>=0?"horizontal"===t.direction?["left","inside-left"]:["bottom","inside-bottom"]:"horizontal"===t.direction?["right","inside-right"]:["top","inside-top"]:(null==n?void 0:n[s])>=0?"horizontal"===t.direction?["right","inside-right"]:["top","inside-top"]:"horizontal"===t.direction?["left","inside-left"]:["bottom","inside-bottom"]}}]}(o)};let g=!1;return eE(h)&&h.includes("inside")&&(g=!0),{position:p,overlap:c,smartInvert:g}}function Fj(t){var e;let i;let{labelSpec:r}=t,n=null!==(e=FL(r.position))&&void 0!==e?e:"outside";return i=r.smartInvert?r.smartInvert:eE(n)&&n.includes("inside"),{position:n,smartInvert:i}}function FN(t,e,i){let r=t.series,n=t.labelSpec||{},s=r.getTotalData();return{customLayoutFunc:s=>s.map(s=>{var a,o,l,h,u,d,c,p;let g=n.position||"withChange",f=n.offset||0,m=e?e(s.data):s.data,v=FI(t,m,n.formatMethod);return v.x=(a=m,o=r,l=g,h=f,"horizontal"===o.direction?"middle"===l?.5*(o.totalPositionX(a,"end")+o.totalPositionY(a,"start")):"max"===l?o.totalPositionX(a,a.end>=a.start?"end":"start")+h:"min"===l?o.totalPositionX(a,a.end>=a.start?"start":"end")-h:o.totalPositionX(a,"end")+(a.end>=a.start?h:-h):o.totalPositionX(a,"index",.5)),v.y=(u=m,d=r,c=g,p=f,"horizontal"===d.direction?d.totalPositionY(u,"index",.5):"middle"===c?.5*(d.totalPositionY(u,"end")+d.totalPositionY(u,"start")):"max"===c?d.totalPositionY(u,u.end>=u.start?"end":"start")-p:"min"===c?d.totalPositionY(u,u.end>=u.start?"start":"end")+p:d.totalPositionY(u,"end")+(u.end>=u.start?-p:p)),"horizontal"===r.direction?v.textAlign="middle"===g?"center":"withChange"===g&&m.end-m.start>=0||"max"===g?"left":"right":v.textBaseline="middle"===g?g:"withChange"===g&&m.end-m.start>=0||"max"===g?"bottom":"top",null==i||i(s,m,v),yt(Object.assign(Object.assign({},v),{id:s.id}))}),dataFilter:t=>{let e=[];return s.forEach(i=>{let n=t.find(t=>{var e;return i.index===(null===(e=t.data)||void 0===e?void 0:e[r.getDimensionField()[0]])});n&&(n.data=i,e.push(n))}),e},overlap:{strategy:[]}}}function Fz(t){var e,i,r,n;let{labelSpec:s,series:a}=t,o=null===(r=null===(i=null===(e=a.getViewDataStatistics)||void 0===e?void 0:e.call(a).latestData)||void 0===i?void 0:i[a.getSeriesField()])||void 0===r?void 0:r.values,l=o?o.map((t,e)=>({[a.getSeriesField()]:t,index:e})):[];return{position:null!==(n=s.position)&&void 0!==n?n:"end",data:l}}class FH extends O4{constructor(){super(...arguments),this.type=cZ.waterfall,this.transformerConstructor=FR,this._leaderLineMark=null,this._stackLabelMark=null,this._labelMark=null}getTotalData(){var t;return null===(t=this._totalData)||void 0===t?void 0:t.getLatestData()}initGroups(){let t=this.getGroupFields();t&&t.length&&(this._groups=new FP(t),this._data&&this._groups.initData(this._data.getDataView(),this._dataSet))}setAttrFromSpec(){super.setAttrFromSpec(),this.setValueFieldToStack(),this._fieldX=[this._fieldX[0]],this._fieldY=[this._fieldY[0]],ej(this._seriesField)&&(this._seriesField=FS)}getSeriesKeys(){return this._seriesField===FS?[this._theme.seriesFieldName.increase,this._theme.seriesFieldName.decrease,this._theme.seriesFieldName.total]:super.getSeriesKeys()}initData(){var t;super.initData(),gw(this._dataSet,"waterfallFillTotal",FM),gw(this._dataSet,"waterfall",Fk),(ej(this._spec.total)||"end"===this._spec.total.type)&&(null===(t=this._rawData)||void 0===t||t.transform({type:"waterfallFillTotal",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,total:this._spec.total}},!1));let e=gR(this.getViewData(),this._dataSet,{name:`${hA}_series_${this.id}_totalData`});this.getViewData().target.removeListener("change",e.reRunAllTransform),this._totalData=new CH(this._option,e),e.transform({type:"waterfall",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,startAs:bE,endAs:bO,total:this._spec.total,groupData:()=>this.getGroups().groupData}},!1)}initAnimation(){var t,e,i,r;let n={yField:"horizontal"===this.direction?this._fieldY[0]:this.getStackValueField(),xField:"horizontal"===this.direction?this.getStackValueField():this._fieldX[0],direction:this.direction,growFrom:()=>{var t,e;return"horizontal"===this.direction?null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=this._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},s=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset,a=C8(this);this._barMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("waterfall"))||void 0===i?void 0:i(n,s),Cq("bar",this._spec,this._markAttributeContext),a)),this._leaderLineMark&&this._leaderLineMark.setAnimationConfig(CX(null===(r=de.getAnimationInKey("fadeInOut"))||void 0===r?void 0:r(),Cq("leaderLine",this._spec,this._markAttributeContext)))}viewDataUpdate(t){this._totalData.getDataView().reRunAllTransform(),this._totalData.updateData(),super.viewDataUpdate(t)}addViewDataFilter(t){}reFilterViewData(){}onEvaluateEnd(t){super.onEvaluateEnd(t),this._totalData.updateData()}initMark(){var t,e;super.initMark();let i=this._createMark(FH.mark.leaderLine,{key:"index",customShape:null===(t=this._spec.leaderLine)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.leaderLine)||void 0===e?void 0:e.stateSort});i&&(this._leaderLineMark=i,i.setDataView(this._totalData.getDataView(),this._totalData.getProductId()))}initLabelMarkStyle(t){var e;if(t)return!this._labelMark&&(null===(e=this._spec.label)||void 0===e?void 0:e.visible)?(super.initLabelMarkStyle(t),void(this._labelMark=t)):void 0}initStackLabelMarkStyle(t){t&&(this._stackLabelMark=t,t.skipEncode=!0,t.setRule("stackLabel"),t.setDataView(this._totalData.getDataView(),this._totalData.getProductId()),this.setMarkStyle(t,{text:t=>{var e;return"absolute"===(null===(e=this._spec.stackLabel)||void 0===e?void 0:e.valueType)?t.end:iS(t.end,t.start)}}))}initTotalLabelMarkStyle(t){this.setMarkStyle(t,{text:t=>{var e;return"end"in t?"absolute"===(null===(e=this._spec.totalLabel)||void 0===e?void 0:e.valueType)?t.end:iS(t.end,t.start):"horizontal"===this.direction?t[this._fieldX[0]]:t[this._fieldY[0]]}})}getTotalLabelComponentStyle(t){return FN(Object.assign(Object.assign({},t),{series:this,labelSpec:this._spec.totalLabel}),t=>{let e="vertical"===this.direction?t[this._fieldX[0]]:t[this._fieldY[0]];return this._totalData.getLatestData().find(t=>t.index===e)})}totalPositionX(t,e,i=.5){let{dataToPosition:r,getBandwidth:n}=this._xAxisHelper;return"horizontal"===this._direction?Se(r([t[e]],{bandPosition:this._bandPosition})):r([t[e]],{bandPosition:this._bandPosition})+.5*n(0)-this._barMark.getAttribute("width",t)*(.5-i)}totalPositionY(t,e,i=.5){let{dataToPosition:r,getBandwidth:n}=this._yAxisHelper;return"horizontal"===this._direction?r([t[e]],{bandPosition:this._bandPosition})+.5*n(0)-this._barMark.getAttribute("height",t)*(.5-i):Se(r([t[e]],{bandPosition:this._bandPosition}))}initMarkStyle(){super.initMarkStyle(),this._leaderLineMark&&("horizontal"===this._direction?this.setMarkStyle(this._leaderLineMark,{visible:t=>!ej(t.lastIndex),x:t=>this.totalPositionX(t,"lastEnd",0),x1:t=>this.totalPositionX(t,t.isTotal?"end":"start",0),y:t=>t.lastIndex?this.totalPositionY(t,"lastIndex",1):0,y1:t=>this.totalPositionY(t,"index",0)},"normal",tw.Series):this.setMarkStyle(this._leaderLineMark,{visible:t=>!ej(t.lastIndex),x:t=>t.lastIndex?this.totalPositionX(t,"lastIndex",1):0,x1:t=>this.totalPositionX(t,"index",0),y:t=>this.totalPositionY(t,"lastEnd",0),y1:t=>this.totalPositionY(t,t.isTotal?"end":"start",0)},"normal",tw.Series))}}FH.type=cZ.waterfall,FH.mark=hq,FH.transformerConstructor=FR;let FV=()=>{B0(),O2(),FE(),w7(),Oy(),OA(),de.registerSeries(FH.type,FH)};class FW extends O6{transformSpec(t){super.transformSpec(t),t.legends&&om(t.legends).forEach(t=>{t.select=!1,t.hover=!1,t.filter=!1}),bg(t)}_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{bar:t.bar,stackLabel:t.stackLabel,leaderLine:t.leaderLine,total:t.total})}}class FG extends O9{constructor(){super(...arguments),this.transformerConstructor=FW,this.type="waterfall",this.seriesType=cZ.waterfall}}FG.type="waterfall",FG.seriesType=cZ.waterfall,FG.transformerConstructor=FW;let FU=`${hA}_BOX_PLOT_OUTLIER_VALUE`;(tG=et||(et={})).OUTLIER="outlier",tG.MAX="max",tG.MIN="min",tG.MEDIAN="median",tG.Q1="q1",tG.Q3="q3",tG.SERIES_FIELD="seriesField";let F$=(t,e)=>{let i=[],{outliersField:r,dimensionField:n}=e;return(t[0].latestData||[]).forEach(t=>{let e=t[r];eM(e)||(e=[e]),i.push(...e.map(e=>{let i={[FU]:e};return n.forEach(e=>{i[e]=t[e]}),i}))}),i};class FY extends CB{constructor(){super(...arguments),this.getContentKey=t=>e=>{if(this.isOutlierMark(e))return t===et.OUTLIER?this.series.getOutliersField():t===et.SERIES_FIELD?this.series.getSeriesField():null;switch(t){case et.MIN:return this.series.getMinField();case et.MAX:return this.series.getMaxField();case et.MEDIAN:return this.series.getMedianField();case et.Q1:return this.series.getQ1Field();case et.Q3:return this.series.getQ3Field();case et.SERIES_FIELD:return this.series.getSeriesField()}return null},this.getContentValue=t=>e=>{if(this.isOutlierMark(e))return t===et.OUTLIER?e[FU]:t===et.SERIES_FIELD?e[this.series.getSeriesField()]:null;switch(t){case et.MIN:return e[this.series.getMinField()];case et.MAX:return e[this.series.getMaxField()];case et.MEDIAN:return e[this.series.getMedianField()];case et.Q1:return e[this.series.getQ1Field()];case et.Q3:return e[this.series.getQ3Field()];case et.SERIES_FIELD:return e[this.series.getSeriesField()]}return null},this.shapeColorCallback=t=>"line"===this.series.getShaftShape()?this.series.getMarkInName("boxPlot").getAttribute("stroke",t):this.series.getMarkInName("boxPlot").getAttribute("fill",t),this.getOutlierFillColor=t=>{var e;let i=this.series.getOutliersStyle();return null!==(e=null==i?void 0:i.fill)&&void 0!==e?e:this.series.getMarkInName("outlier").getAttribute("fill",t)},this.isOutlierMark=t=>eO(t[FU])}getDefaultTooltipPattern(t){return{visible:!0,activeType:t,title:{key:void 0,value:this.dimensionTooltipTitleCallback,hasShape:!1},content:[{key:this.getContentKey(et.OUTLIER),value:this.getContentValue(et.OUTLIER),hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.getOutlierFillColor,shapeStroke:this.getOutlierFillColor,shapeHollow:!1},{key:this.getContentKey(et.MAX),value:this.getContentValue(et.MAX),hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1},{key:this.getContentKey(et.Q3),value:this.getContentValue(et.Q3),hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1},{key:this.getContentKey(et.MEDIAN),value:this.getContentValue(et.MEDIAN),hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1},{key:this.getContentKey(et.Q1),value:this.getContentValue(et.Q1),hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1},{key:this.getContentKey(et.MIN),value:this.getContentValue(et.MIN),hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1},{key:this.getContentKey(et.SERIES_FIELD),value:this.getContentValue(et.SERIES_FIELD),hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1}]}}}function FK(t){return"horizontal"===t}function FZ(t){return"vertical"===t}let FX=t=>(e,i,r)=>{var n,s,a;let o=null!==(a=null!==(n=e.getGraphicAttribute("direction",!1))&&void 0!==n?n:null===(s=e.mark.getGlyphConfig())||void 0===s?void 0:s.direction)&&void 0!==a?a:"vertical",l=t(e,o,i);if(!l1(l))return{};let h=e.getGraphicAttribute("x",!1),u=e.getGraphicAttribute("y",!1),d=e.getGraphicAttribute("min",!1),c=e.getGraphicAttribute("max",!1),p=e.getGraphicAttribute("q1",!1),g=e.getGraphicAttribute("q3",!1),f=e.getGraphicAttribute("median",!1),m={from:{x:h,y:u},to:{x:h,y:u}};return l1(d)&&(m.from.min=l,m.to.min=d),l1(c)&&(m.from.max=l,m.to.max=c),l1(p)&&(m.from.q1=l,m.to.q1=p),l1(g)&&(m.from.q3=l,m.to.q3=g),l1(f)&&(m.from.median=l,m.to.median=f),m},Fq=t=>(e,i,r)=>{var n,s,a;let o=null!==(a=null!==(n=e.getGraphicAttribute("direction",!1))&&void 0!==n?n:null===(s=e.mark.getGlyphConfig())||void 0===s?void 0:s.direction)&&void 0!==a?a:"vertical",l=t(e,o,i);if(!l1(l))return{};let h=e.getGraphicAttribute("x",!0),u=e.getGraphicAttribute("y",!0),d=e.getGraphicAttribute("min",!0),c=e.getGraphicAttribute("max",!0),p=e.getGraphicAttribute("q1",!0),g=e.getGraphicAttribute("q3",!0),f=e.getGraphicAttribute("median",!0),m={from:{x:h,y:u},to:{x:h,y:u}};return l1(d)&&(m.to.min=l,m.from.min=d),l1(c)&&(m.to.max=l,m.from.max=c),l1(p)&&(m.to.q1=l,m.from.q1=p),l1(g)&&(m.to.q3=l,m.from.q3=g),l1(f)&&(m.to.median=l,m.from.median=f),m},FJ=(t,e,i)=>{var r,n,s,a,o,l,h,u,d,c,p,g;let f,m,v,y,_;if(i&&l1(i.center))return i.center;if(FK(e)){f=null===(n=null===(r=t.getGraphicAttribute("points",!1,"median"))||void 0===r?void 0:r[0])||void 0===n?void 0:n.x,m=null===(a=null===(s=t.getGraphicAttribute("points",!1,"max"))||void 0===s?void 0:s[0])||void 0===a?void 0:a.x,v=null===(l=null===(o=t.getGraphicAttribute("points",!1,"min"))||void 0===o?void 0:o[0])||void 0===l?void 0:l.x;let e=t.getGraphicAttribute("width",!1,"box"),i=t.getGraphicAttribute("x",!1,"box");y=i,_=i+e}else{f=null===(u=null===(h=t.getGraphicAttribute("points",!1,"median"))||void 0===h?void 0:h[0])||void 0===u?void 0:u.y,m=null===(c=null===(d=t.getGraphicAttribute("points",!1,"max"))||void 0===d?void 0:d[0])||void 0===c?void 0:c.y,v=null===(g=null===(p=t.getGraphicAttribute("points",!1,"min"))||void 0===p?void 0:p[0])||void 0===g?void 0:g.y;let e=t.getGraphicAttribute("height",!1,"box"),i=t.getGraphicAttribute("y",!1,"box");y=i,_=i+e}return l1(f)?f:l1(y)&&l1(_)?(y+_)/2:l1(m)&&l1(v)?(m+v)/2:l1(v)?v:l1(m)?m:NaN},FQ=(t,e,i,r)=>{var n,s,a,o,l,h,u,d;let c={shaft:{},box:{},max:{},min:{},median:{}},p=null!==(n=t.x)&&void 0!==n?n:i.getGraphicAttribute("x",!1),g=null!==(s=t.y)&&void 0!==s?s:i.getGraphicAttribute("y",!1),f=null!==(a=t.width)&&void 0!==a?a:i.getGraphicAttribute("width",!1),m=null!==(o=t.height)&&void 0!==o?o:i.getGraphicAttribute("height",!1),v=null!==(l=t.boxWidth)&&void 0!==l?l:i.getGraphicAttribute("boxWidth",!1),y=null!==(h=t.boxHeight)&&void 0!==h?h:i.getGraphicAttribute("boxHeight",!1),_=null!==(u=t.ruleWidth)&&void 0!==u?u:i.getGraphicAttribute("ruleWidth",!1),b=null!==(d=t.ruleHeight)&&void 0!==d?d:i.getGraphicAttribute("ruleHeight",!1);return r&&FK(r.direction)?(l1(y)?(Object.assign(c.box,{y:g-y/2,y1:g+y/2}),Object.assign(c.median,{y:g-y/2,y1:g+y/2})):(Object.assign(c.box,{y:g-m/2,y1:g+m/2}),Object.assign(c.median,{y:g-m/2,y1:g+m/2})),l1(b)?(Object.assign(c.max,{y:g-b/2,y1:g+b/2}),Object.assign(c.min,{y:g-b/2,y1:g+b/2})):(Object.assign(c.max,{y:g-m/2,y1:g+m/2}),Object.assign(c.min,{y:g-m/2,y1:g+m/2}))):(l1(v)?(Object.assign(c.box,{x:p-v/2,x1:p+v/2}),Object.assign(c.median,{x:p-v/2,x1:p+v/2})):(Object.assign(c.box,{x:p-f/2,x1:p+f/2}),Object.assign(c.median,{x:p-f/2,x1:p+f/2})),l1(_)?(Object.assign(c.max,{x:p-_/2,x1:p+_/2}),Object.assign(c.min,{x:p-_/2,x1:p+_/2})):(Object.assign(c.max,{x:p-f/2,x1:p+f/2}),Object.assign(c.min,{x:p-f/2,x1:p+f/2}))),c},F0=FX(FJ),F1=Fq(FJ),F2=(t,e,i)=>{var r,n,s,a;let o,l,h,u,d;if(l1(null==i?void 0:i.center))return i.center;if(FK(e)){o=null===(n=null===(r=t.getGraphicAttribute("points",!1,"median"))||void 0===r?void 0:r[0])||void 0===n?void 0:n.x;let e=t.getGraphicAttribute("width",!1,"minMaxBox"),i=t.getGraphicAttribute("x",!1,"minMaxBox");h=i,l=i+e;let s=t.getGraphicAttribute("width",!1,"q1q3Box"),a=t.getGraphicAttribute("x",!1,"q1q3Box");u=a,d=a+s}else{o=null===(a=null===(s=t.getGraphicAttribute("points",!1,"median"))||void 0===s?void 0:s[0])||void 0===a?void 0:a.y;let e=t.getGraphicAttribute("height",!1,"minMaxBox"),i=t.getGraphicAttribute("y",!1,"minMaxBox");h=i,l=i+e;let r=t.getGraphicAttribute("height",!1,"q1q3Box"),n=t.getGraphicAttribute("y",!1,"q1q3Box");u=n,d=n+r}return l1(o)?o:l1(u)&&l1(d)?(u+d)/2:l1(l)&&l1(h)?(l+h)/2:l1(h)?h:l1(l)?l:NaN},F3=(t,e,i,r)=>{var n,s,a,o,l,h,u,d;let c={minMaxBox:{},q1q3Box:{},median:{}},p=null!==(n=t.x)&&void 0!==n?n:i.getGraphicAttribute("x",!1),g=null!==(s=t.y)&&void 0!==s?s:i.getGraphicAttribute("y",!1),f=null!==(a=t.width)&&void 0!==a?a:i.getGraphicAttribute("width",!1),m=null!==(o=t.minMaxWidth)&&void 0!==o?o:i.getGraphicAttribute("minMaxWidth",!1),v=null!==(l=t.q1q3Width)&&void 0!==l?l:i.getGraphicAttribute("q1q3Width",!1),y=null!==(h=t.height)&&void 0!==h?h:i.getGraphicAttribute("height",!1),_=null!==(u=t.minMaxHeight)&&void 0!==u?u:i.getGraphicAttribute("minMaxHeight",!1),b=null!==(d=t.q1q3Height)&&void 0!==d?d:i.getGraphicAttribute("q1q3Height",!1);return r&&FK(r.direction)?(l1(_)?Object.assign(c.minMaxBox,{y:g-_/2,y1:g+_/2}):Object.assign(c.minMaxBox,{y:g-y/2,y1:g+y/2}),l1(b)?(Object.assign(c.q1q3Box,{y:g-b/2,y1:g+b/2}),Object.assign(c.median,{y:g-b/2,y1:g+b/2})):(Object.assign(c.q1q3Box,{y:g-y/2,y1:g+y/2}),Object.assign(c.median,{y:g-y/2,y1:g+y/2}))):(l1(m)?Object.assign(c.minMaxBox,{x:p-m/2,x1:p+m/2}):Object.assign(c.minMaxBox,{x:p-f/2,x1:p+f/2}),l1(v)?(Object.assign(c.q1q3Box,{x:p-v/2,x1:p+v/2}),Object.assign(c.median,{x:p-v/2,x1:p+v/2})):(Object.assign(c.q1q3Box,{x:p-f/2,x1:p+f/2}),Object.assign(c.median,{x:p-f/2,x1:p+f/2}))),c},F5=FX(F2),F4=Fq(F2);class F8 extends Sd{constructor(){super(...arguments),this.type=F8.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:2,boxWidth:30,shaftWidth:20,shaftShape:"line"})}_initProduct(t){let e=this.getStyle("shaftShape"),i=this.getVGrammarView(),r=this.getProductId(),n=this.getStyle("direction");this._product=i.glyph("bar"===e?"barBoxplot":"boxplot",null!=t?t:i.rootMark).id(r).configureGlyph({direction:n}),this._compiledProductId=r}}F8.type="boxPlot";let F6=()=>{de.registerMark(F8.type,F8),d0.registerGlyph("boxplot",{shaft:"rule",box:"rect",max:"rule",min:"rule",median:"rule"}).registerProgressiveChannels(["x","y","q1","q3","min","max","median","angle","width","height","boxWidth","boxHeight","ruleWidth","ruleHeight"]).registerFunctionEncoder(FQ).registerChannelEncoder("x",(t,e,i,r,n,s)=>s&&FK(s.direction)?null:{shaft:{x:e,x1:e}}).registerChannelEncoder("y",(t,e,i,r,n,s)=>s&&FK(s.direction)?{shaft:{y:e,y1:e}}:null).registerChannelEncoder("q1",(t,e,i,r,n,s)=>s&&FK(s.direction)?{box:{x:e}}:{box:{y:e}}).registerChannelEncoder("q3",(t,e,i,r,n,s)=>s&&FK(s.direction)?{box:{x1:e}}:{box:{y1:e}}).registerChannelEncoder("min",(t,e,i,r,n,s)=>s&&FK(s.direction)?{shaft:{x:e},min:{x:e,x1:e,visible:!0}}:{shaft:{y:e},min:{y:e,y1:e,visible:!0}}).registerChannelEncoder("max",(t,e,i,r,n,s)=>s&&FK(s.direction)?{shaft:{x1:e},max:{x:e,x1:e,visible:!0}}:{shaft:{y1:e},max:{y:e,y1:e,visible:!0}}).registerChannelEncoder("median",(t,e,i,r,n,s)=>s&&FK(s.direction)?{median:{x:e,x1:e,visible:!0}}:{median:{y:e,y1:e,visible:!0}}).registerChannelEncoder("angle",(t,e,i,r,n,s)=>{var a;let o=s&&FK(s.direction)?[(i.min+i.max)/2,i.y]:[i.x,(i.min+i.max)/2],l=null!==(a=i.anchor)&&void 0!==a?a:o;return{shaft:{angle:e,anchor:l},box:{angle:e,anchor:l},max:{angle:e,anchor:l},min:{angle:e,anchor:l},median:{angle:e,anchor:l}}}).registerDefaultEncoder(()=>({max:{visible:!1},min:{visible:!1},median:{visible:!1}})),d0.registerAnimationType("boxplotScaleIn",F0),d0.registerAnimationType("boxplotScaleOut",F1),Aq(),AW(),AU(),d0.registerGlyph("barBoxplot",{minMaxBox:"rect",q1q3Box:"rect",median:"rule"}).registerProgressiveChannels(["x","y","q1","q3","min","max","median","angle","width","height","minMaxWidth","q1q3Width","minMaxHeight","q1q3Height"]).registerFunctionEncoder(F3).registerChannelEncoder("q1",(t,e,i,r,n,s)=>s&&FK(s.direction)?{q1q3Box:{x:e}}:{q1q3Box:{y:e}}).registerChannelEncoder("q3",(t,e,i,r,n,s)=>s&&FK(s.direction)?{q1q3Box:{x1:e}}:{q1q3Box:{y1:e}}).registerChannelEncoder("min",(t,e,i,r,n,s)=>s&&FK(s.direction)?{minMaxBox:{x:e}}:{minMaxBox:{y:e}}).registerChannelEncoder("max",(t,e,i,r,n,s)=>s&&FK(s.direction)?{minMaxBox:{x1:e}}:{minMaxBox:{y1:e}}).registerChannelEncoder("median",(t,e,i,r,n,s)=>s&&FK(s.direction)?{median:{x:e,x1:e,visible:!0}}:{median:{y:e,y1:e,visible:!0}}).registerChannelEncoder("angle",(t,e,i,r,n,s)=>{var a;let o=null!==(a=i.anchor)&&void 0!==a?a:[i.x,(i.min+i.max)/2];return{minMaxBox:{angle:e,anchor:o},q1q3Box:{angle:e,anchor:o},median:{angle:e,anchor:o}}}).registerChannelEncoder("lineWidth",(t,e,i,r,n,s)=>({minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0}})).registerChannelEncoder("minMaxFillOpacity",(t,e,i,r,n,s)=>({minMaxBox:{fillOpacity:e}})).registerChannelEncoder("stroke",(t,e,i,r,n,s)=>({minMaxBox:{stroke:!1},q1q3Box:{stroke:!1}})).registerDefaultEncoder(()=>({minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0},median:{visible:!1}})),d0.registerAnimationType("barBoxplotScaleIn",F5),d0.registerAnimationType("barBoxplotScaleOut",F4),Aq(),AW(),AU()};class F9 extends C6{constructor(){super(...arguments),this.type=cZ.boxPlot}getMinField(){return this._minField}getMaxField(){return this._maxField}getQ1Field(){return this._q1Field}getMedianField(){return this._medianField}getQ3Field(){return this._q3Field}getOutliersField(){return this._outliersField}getShaftShape(){return this._shaftShape}getBoxFillColor(){return this._boxFillColor}getStrokeColor(){return this._strokeColor}getOutliersStyle(){return this._outliersStyle}setAttrFromSpec(){var t,e,i,r,n;super.setAttrFromSpec();let s=null!==(e=null===(t=this._spec.boxPlot)||void 0===t?void 0:t.style)&&void 0!==e?e:{};this._minField=this._spec.minField,this._maxField=this._spec.maxField,this._q1Field=this._spec.q1Field,this._medianField=this._spec.medianField,this._q3Field=this._spec.q3Field,this._outliersField=this._spec.outliersField,this._lineWidth=null!==(i=s.lineWidth)&&void 0!==i?i:2,this._boxWidth=s.boxWidth,this._shaftShape=null!==(r=s.shaftShape)&&void 0!==r?r:"line",this._shaftWidth=s.shaftWidth,this._boxFillColor=s.boxFill,this._strokeColor=s.stroke,this._shaftFillOpacity="bar"===this._shaftShape?null!==(n=s.shaftFillOpacity)&&void 0!==n?n:.5:void 0,this._outliersStyle=this._spec.outliersStyle}initMark(){let t={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._boxPlotMark=this._createMark(F9.mark.boxPlot,{isSeriesMark:!0,progressive:t}),this._outlierMark=this._createMark(F9.mark.outlier,{progressive:t,key:bA,dataView:this._outlierDataView.getDataView(),dataProductId:this._outlierDataView.getProductId()})}initMarkStyle(){var t,e,i,r,n;let s=this._boxPlotMark;if(s){let i={direction:this._direction,lineWidth:this._lineWidth,shaftShape:this._shaftShape,fill:null!==(t=this._boxFillColor)&&void 0!==t?t:"line"===this._shaftShape?"#FFF":this.getColorAttribute(),minMaxFillOpacity:this._shaftFillOpacity,stroke:null!==(e=this._strokeColor)&&void 0!==e?e:"line"===this._shaftShape?this.getColorAttribute():"#000"},r="horizontal"===this._direction?Object.assign(Object.assign({y:this.dataToPositionY.bind(this)},i),{boxHeight:()=>{var t;return null!==(t=this._boxWidth)&&void 0!==t?t:this._getMarkWidth()},ruleHeight:()=>{var t;return null!==(t=this._shaftWidth)&&void 0!==t?t:this._getMarkWidth()},q1q3Height:()=>{var t;return null!==(t=this._boxWidth)&&void 0!==t?t:this._getMarkWidth()},minMaxHeight:()=>{var t;return null!==(t=this._shaftWidth)&&void 0!==t?t:this._getMarkWidth()}}):Object.assign(Object.assign({x:this.dataToPositionX.bind(this)},i),{boxWidth:()=>{var t;return null!==(t=this._boxWidth)&&void 0!==t?t:this._getMarkWidth()},ruleWidth:()=>{var t;return null!==(t=this._shaftWidth)&&void 0!==t?t:this._getMarkWidth()},q1q3Width:()=>{var t;return null!==(t=this._boxWidth)&&void 0!==t?t:this._getMarkWidth()},minMaxWidth:()=>{var t;return null!==(t=this._shaftWidth)&&void 0!==t?t:this._getMarkWidth()}});this.setMarkStyle(s,r,tk.STATE_NORMAL,tw.Series)}let a=this._outlierMark;a&&this.setMarkStyle(a,{fill:null!==(r=null===(i=this._outliersStyle)||void 0===i?void 0:i.fill)&&void 0!==r?r:this.getColorAttribute(),size:ey(null===(n=this._outliersStyle)||void 0===n?void 0:n.size)?this._outliersStyle.size:10,symbolType:"circle"},tk.STATE_NORMAL,tw.Series)}initBoxPlotMarkStyle(){var t,e;let i=this._boxPlotMark,r="horizontal"===this._direction?this._xAxisHelper:this._yAxisHelper;if(i&&r){let{dataToPosition:e}=r,n=null===(t=null==r?void 0:r.getScale)||void 0===t?void 0:t.call(r,0);this.setMarkStyle(i,{min:t=>Se(e(this.getDatumPositionValues(t,this._minField),{bandPosition:this._bandPosition}),n),q1:t=>Se(e(this.getDatumPositionValues(t,this._q1Field),{bandPosition:this._bandPosition}),n),median:t=>Se(e(this.getDatumPositionValues(t,this._medianField),{bandPosition:this._bandPosition}),n),q3:t=>Se(e(this.getDatumPositionValues(t,this._q3Field),{bandPosition:this._bandPosition}),n),max:t=>Se(e(this.getDatumPositionValues(t,this._maxField),{bandPosition:this._bandPosition}),n)},tk.STATE_NORMAL,tw.Series)}let n=this._outlierMark;if(n&&r){let{dataToPosition:t}=r,i=null===(e=null==r?void 0:r.getScale)||void 0===e?void 0:e.call(r,0),s="horizontal"===this._direction?{y:this.dataToPositionY.bind(this),x:e=>Se(t(this.getDatumPositionValues(e,FU),{bandPosition:this._bandPosition}),i)}:{x:this.dataToPositionX.bind(this),y:e=>Se(t(this.getDatumPositionValues(e,FU),{bandPosition:this._bandPosition}),i)};this.setMarkStyle(n,s,tk.STATE_NORMAL,tw.Series)}}initData(){if(super.initData(),!this._data)return;gw(this._dataSet,"foldOutlierData",F$),gw(this._dataSet,"addVChartProperty",CO);let t=new eH(this._dataSet,{name:`${this.type}_outlier_${this.id}_data`});t.parse([this.getViewData()],{type:"dataview"}),t.name=`${hA}_series_${this.id}_outlierData`,t.transform({type:"foldOutlierData",options:{dimensionField:"horizontal"===this._direction?this._fieldY:this._fieldX,outliersField:this._outliersField}}),t.transform({type:"addVChartProperty",options:{beforeCall:CU.bind(this),call:C$}},!1),this._outlierDataView=new CH(this._option,t)}init(t){super.init(t),this.initBoxPlotMarkStyle()}_getMarkWidth(){if(this._autoBoxWidth)return this._autoBoxWidth;let t="horizontal"===this._direction?this._yAxisHelper:this._xAxisHelper,e="horizontal"===this._direction?this._fieldY:this._fieldX,i=t.getBandwidth(e.length-1)/e.length;return this._autoBoxWidth=i,this._autoBoxWidth}onLayoutEnd(t){super.onLayoutEnd(t),this._autoBoxWidth=null}_initAnimationSpec(t={}){let e=eF({},t);return["appear","enter","update","exit","disappear"].forEach(t=>{e[t]&&"scaleIn"===e[t].type?e[t].type="line"===this._shaftShape?"boxplotScaleIn":"barBoxplotScaleIn":e[t]&&"scaleOut"===e[t].type&&(e[t].type="line"===this._shaftShape?"boxplotScaleOut":"barBoxplotScaleOut")}),e}initAnimation(){var t,e,i,r,n,s,a;let o=C8(this);if(this._boxPlotMark){let e=this._initAnimationSpec(null===(t=de.getAnimationInKey("scaleInOut"))||void 0===t?void 0:t()),i=this._initAnimationSpec(Cq("boxPlot",this._spec,this._markAttributeContext));this._boxPlotMark.setAnimationConfig(CX(e,i,o))}if(this._outlierMark){let t={appear:null===(e=this._spec.animationAppear)||void 0===e?void 0:e.symbol,disappear:null===(i=this._spec.animationDisappear)||void 0===i?void 0:i.symbol,enter:null===(r=this._spec.animationEnter)||void 0===r?void 0:r.symbol,exit:null===(n=this._spec.animationExit)||void 0===n?void 0:n.symbol,update:null===(s=this._spec.animationUpdate)||void 0===s?void 0:s.symbol};this._outlierMark.setAnimationConfig(CX(null===(a=de.getAnimationInKey("scaleInOut"))||void 0===a?void 0:a(),t,o))}}initTooltip(){this._tooltipHelper=new FY(this),this._boxPlotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._boxPlotMark),this._outlierMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._outlierMark)}getStatisticFields(){let t=super.getStatisticFields(),e=t.find(t=>t.key===this._outliersField);return e&&(e.operations=["array-min","array-max"]),t}onEvaluateEnd(t){super.onEvaluateEnd(t),this._outlierDataView.updateData()}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._boxPlotMark]}}F9.type=cZ.boxPlot,F9.mark=hJ;let F7=()=>{F6(),Ta(),w9(),Oy(),OA(),de.registerSeries(F9.type,F9)};class jt extends OO{_getDefaultSeriesSpec(t){var e;let i=[t.maxField,t.medianField,t.q1Field,t.q3Field,t.minField,t.outliersField],r=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{boxPlot:t.boxPlot,direction:null!==(e=t.direction)&&void 0!==e?e:"vertical",minField:t.minField,maxField:t.maxField,q1Field:t.q1Field,medianField:t.medianField,q3Field:t.q3Field,outliersField:t.outliersField,outliersStyle:t.outliersStyle});return r["horizontal"===r.direction?"xField":"yField"]=i,r}transformSpec(t){super.transformSpec(t),t.axes||(t.axes=[{orient:"bottom"},{orient:"left"}]),bg(t)}}class je extends OD{constructor(){super(...arguments),this.transformerConstructor=jt,this.type="boxPlot",this.seriesType=cZ.boxPlot}}je.type="boxPlot",je.seriesType=cZ.boxPlot,je.transformerConstructor=jt;let ji=t=>{let e=0;return t.forEach((t,i)=>{var r;ej(t.value)&&((null===(r=t.children)||void 0===r?void 0:r.length)?t.value=ji(t.children):t.value=0),e+=Math.abs(t.value)}),e};function jr(t){return t.depth}function jn(t,e){return e-1-t.endDepth}let js=(t,e)=>(null==t?void 0:t.y0)-(null==e?void 0:e.y0),ja=(t,e)=>{if(ej(t.value))return null;let i=(e?t.targetLinks:t.sourceLinks).reduce((t,e)=>(ej(e.value)?t.count+=1:t.sum+=e.value,t),{sum:0,count:0});return i.count>0?(t.value-i.sum)/i.count:null},jo={left:jr,right:jn,justify:function(t,e){return t.sourceLinks.length?t.depth:e-1},center:function(t,e,i){return t.targetLinks.length?t.depth:t.sourceLinks.length?o_(t.sourceLinks.map(t=>i[t.target].depth))-1:0},start:jr,end:jn},jl=xQ(0,1);class jh{constructor(t){this._ascendingSourceBreadth=(t,e)=>js(this._nodeMap[t.source],this._nodeMap[e.source])||t.index-e.index,this._ascendingTargetBreadth=(t,e)=>js(this._nodeMap[t.target],this._nodeMap[e.target])||t.index-e.index,this.options=Object.assign({},jh.defaultOptions,t);let e=this.options.nodeKey,i=nx(e)?e:e?fl(e):null;this._getNodeKey=i,this._logger=ex.getInstance(),this._alignFunc=nx(this.options.setNodeLayer)?t=>this.options.setNodeLayer(t.datum):jo[this.options.nodeAlign]}layout(t,e){if(!t)return null;let i="width"in e?{x0:0,x1:e.width,y0:0,y1:e.height,width:e.width,height:e.height}:{x0:Math.min(e.x0,e.x1),x1:Math.max(e.x0,e.x1),y0:Math.min(e.y0,e.y1),y1:Math.max(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)};FZ(this.options.direction)?this._viewBox={x0:i.y0,x1:i.y1,y0:i.x0,y1:i.x1,width:i.height,height:i.width}:this._viewBox=i;let r=this.computeNodeLinks(t),n=r.nodes,s=r.links;if(this._nodeMap=r.nodeMap,this.computeNodeValues(n),this.computeNodeDepths(n),["right","end","justify"].includes(this.options.nodeAlign)&&this.computeNodeEndDepths(n),this._maxDepth<=1)return null;let a=this.computeNodeBreadths(n);return this.computeLinkBreadths(n),n.forEach(t=>{t.sourceLinks=t.sourceLinks.filter(t=>!ej(t.source)&&!ej(t.target)),t.targetLinks=t.targetLinks.filter(t=>!ej(t.source)&&!ej(t.target))}),s=s.filter(t=>!ej(t.source)&&!ej(t.target)),FZ(this.options.direction)&&(n.forEach(t=>{let e=t.y0,i=t.y1;t.y0=t.x0,t.y1=t.x1,t.x0=e,t.x1=i}),s.forEach(t=>{t.vertical=!0;let e=t.x0,i=t.x1;t.x0=t.y0,t.x1=t.y1,t.y0=e,t.y1=i})),s.forEach(t=>{let e=this._nodeMap[t.source],i=this._nodeMap[t.target];t.sourceRect={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1},t.targetRect={x0:i.x0,x1:i.x1,y1:i.y1,y0:i.y0}}),{nodes:n,links:s,columns:a}}computeHierarchicNodeLinks(t){let e=[],i=[],r={},n={},s=[];ji(t);let a=(t,i,n)=>{t.forEach((t,o)=>{let l=this._getNodeKey?this._getNodeKey(t):n?`${n[n.length-1].key}-${o}`:`${i}-${o}`,h=ej(t.value)?0:DB(t.value);if(r[l])r[l].value=void 0;else{let n={depth:i,datum:t,index:o,key:l,value:h,sourceLinks:[],targetLinks:[]};r[l]=n,e.push(n)}n&&s.push({source:n[n.length-1].key,target:l,value:h,parents:n}),t.children&&t.children.length&&a(t.children,i+1,n?n.concat([r[l]]):[r[l]])})};return a(t,0,null),s.forEach((t,e)=>{let s=`${t.source}-${t.target}`,a=Eo(t,["parents"]);if(a.parents=t.parents.map(t=>Eo(t,["sourceLinks","targetLinks"])),n[s])return n[s].value+=DB(t.value),void n[s].datum.push(a);let o={index:e,key:`${t.source}-${t.target}`,source:t.source,target:t.target,datum:[a],value:t.value,parents:t.parents.map(t=>t.key)};i.push(o),r[t.source].sourceLinks.push(o),r[t.target].targetLinks.push(o),n[s]=o}),{nodes:e,links:i,nodeMap:r}}computeSourceTargetNodeLinks(t){let e=[],i=[],r={};t.nodes&&t.nodes.forEach((t,i)=>{let n={depth:-1,datum:t,index:i,key:this._getNodeKey?this._getNodeKey(t):i,value:t.value,sourceLinks:[],targetLinks:[]};r[n.key]=n,e.push(n)});let n=[];return t.links.forEach((s,a)=>{let o=!ej(s.source),l=!ej(s.target);if(t.nodes&&(!r[s.source]||!r[s.target]))return;t.nodes||!o||r[s.source]||(r[s.source]={value:void 0,depth:-1,index:e.length,key:s.source,datum:null,sourceLinks:[],targetLinks:[]},e.push(r[s.source])),t.nodes||!l||r[s.target]||(r[s.target]={value:void 0,depth:-1,index:e.length,key:s.target,datum:null,sourceLinks:[],targetLinks:[]},e.push(r[s.target]));let h={index:a,source:s.source,target:s.target,datum:s,value:s.value};this.options.divideNodeValueToLink&&ej(s.value)&&n.push(h),i.push(h),o&&r[s.source].sourceLinks.push(h),l&&r[s.target].targetLinks.push(h)}),this.options.divideNodeValueToLink&&n.length&&n.forEach(t=>{let e=[ja(r[t.source]),ja(r[t.target],!0)].filter(t=>!ej(t));e.length&&(t.value=o_(e))}),{nodeMap:r,nodes:e,links:i}}computeNodeLinks(t){let e;"links"in t?e=this.computeSourceTargetNodeLinks(t):(this._isHierarchic=!0,e=this.computeHierarchicNodeLinks(t.nodes));let i=e.nodes,r=e.links;if(this.options.linkSortBy)for(let t=0,e=i.length;t<e;t++)i[t].sourceLinks.sort(this.options.linkSortBy),i[t].targetLinks.sort(this.options.linkSortBy);return this.options.dropIsolatedNode&&(i=i.filter(t=>t.targetLinks.length||t.sourceLinks.length)),{nodes:i,links:r,nodeMap:e.nodeMap}}computeNodeValues(t){for(let e=0,i=t.length;e<i;e++){let i=t[e];i.value=Math.max(ej(i.value)?0:DB(i.value),i.sourceLinks.reduce((t,e)=>{var i;return t+(null!==(i=DB(e.value))&&void 0!==i?i:0)},0),i.targetLinks.reduce((t,e)=>{var i;return t+(null!==(i=DB(e.value))&&void 0!==i?i:0)},0))}}computeNodeDepths(t){let e=t.length,i,r,n=t,s=0;for(;n.length&&s<e;){i=[],r={};for(let t=0,e=n.length;t<e;t++){let e=n[t];if(e&&(e.depth=s,e.sourceLinks&&e.sourceLinks.length))for(let t=0,n=e.sourceLinks.length;t<n;t++){let n=e.sourceLinks[t];r[n.target]||(i.push(this._nodeMap[n.target]),r[n.target]=!0)}}n=i,s+=1}s>e&&this._logger.warn("Error: there is a circular link"),this._maxDepth=s}computeNodeEndDepths(t){let e=t.length,i,r,n=t,s=0;for(;n.length&&s<e;){i=[],r={};for(let t=0,e=n.length;t<e;t++){let e=n[t];if(e){e.endDepth=s;for(let t=0,n=e.targetLinks.length;t<n;t++){let n=e.targetLinks[t];r[n.source]||(i.push(this._nodeMap[n.source]),r[n.source]=!0)}}}n=i,s+=1}s>e&&this._logger.warn("Error: there is a circular link")}computeNodeLayers(t){let e=this.options.nodeWidth,i=this.options.linkWidth,r=this.options.minStepWidth,n=this._viewBox.width,s=null,a=null,o=!1;if(eE(e)){let t=nL(parseFloat(e.replace("%",""))/100,0,1),i=n/(this._maxDepth-1+t);r>0&&(i=Math.max(r,i)),s=i*t,a=i*(1-t),o=!0}else if(ey(e)){if(s=e,ey(i))a=i;else if(ej(i)){let t=(n-e)/(this._maxDepth-1);r>0&&(t=Math.max(r,t)),a=t-e}o=!0}else nx(e)&&ey(i)&&(a=i);let l=[];for(let e=0,i=t.length;e<i;e++){let i=t[e];i.layer=this._isHierarchic?i.depth:nL(Math.floor(this._alignFunc(i,this._maxDepth,this._nodeMap)),0,this._maxDepth-1);let r=i.layer;r===this._maxDepth-1&&(i.isLastLayer=!0),o&&(i.x0=this._viewBox.x0+r*(s+a),i.x1=i.x0+s),l[r]?l[r].push(i):l[r]=[i]}if(this.options.nodeSortBy)for(let t=0,e=l.length;t<e;t++)l[t].sort(this.options.nodeSortBy);if(!o&&nx(e)){let t=this._viewBox.x0;for(let r=0;r<this._maxDepth;r++){let n=l[r],o=0,h=0;for(let r=0,l=n&&n.length;r<l;r++){let l=n[r],u=e(l);l.x0=t,l.x1=t+u,o=Math.max(s,u);let d=l.sourceLinks;for(let t=0,e=d.length;t<e;t++){let e=d[t];h=Math.max(h,nx(i)?i(e,this._viewBox):a)}}t+=o+h}}return l}initializeNodeBreadths(t){var e,i;let r=null!==(e=this.options.minLinkHeight)&&void 0!==e?e:0,n=null!==(i=this.options.minNodeHeight)&&void 0!==i?i:0;(ej(n)||n<r)&&(n=r);let s=0,a=null,o=null;if(nx(this.options.nodeGap))a=this.options.nodeGap,s=t.reduce((t,e)=>{let i=e.reduce((t,e)=>t+e.value,0),r=e.reduce((t,e)=>t+this.options.nodeGap(e),0);return Math.min(t,(this._viewBox.height-r)/i)},1/0);else{let e=t.reduce((t,e)=>Math.max(t,e.length),0),i=this._viewBox.height/e,r=Math.min(this.options.nodeGap,i);if(a=()=>r,this._gapY=r,(n+r)*e>this._viewBox.height&&(n=i-r),this.options.equalNodeHeight)o=this._viewBox.height/e-r;else{let e=n>0?Math.max(r,n):r;s=t.reduce((t,i)=>{let r=i.reduce((t,e)=>t+e.value,0);return Math.min(t,(this._viewBox.height-((i.length-1)*e+n))/r)},1/0)}}let l="start"===this.options.gapPosition,h=!l&&"end"!==this.options.gapPosition,u=ey(this.options.nodeHeight)?t=>this.options.nodeHeight:nx(this.options.nodeHeight)?this.options.nodeHeight:o>0?t=>o:t=>Math.max(t.value*s,0),d=ey(this.options.linkHeight)?()=>this.options.linkHeight:nx(this.options.linkHeight)?this.options.linkHeight:(t,e,i)=>Math.max(e.value?i*jl(t.value/e.value):0,r,0);for(let e=0,i=t.length;e<i;e++){let i=t[e];if(!i||!i.length)continue;let r=this._viewBox.y0,s=0,o=0,c=0;for(let t=0,e=i.length;t<e;t++){let e=i[t];s=a(e),l&&(r+=s),o=Math.max(c=u(e),n),e.y0=r,e.y1=r+o,r=l?e.y1:e.y1+s;for(let t=0,i=e.sourceLinks.length;t<i;t++){let i=e.sourceLinks[t];i.thickness=d(i,e,c)}}let p=this._viewBox.y1-r+(h?s:0);if(p>0){if("start"===this.options.crossNodeAlign);else if("end"===this.options.crossNodeAlign)for(let t=0,e=i.length;t<e;++t){let e=i[t];e.y0+=p,e.y1+=p}else{p/=i.length+1;for(let t=0,e=i.length;t<e;++t){let e=i[t];e.y0+=p*(t+1),e.y1+=p*(t+1)}}}else if(p<0&&i.length>1&&s+(p/=i.length-1)>=0){s+=p,this._gapY=Math.min(s);for(let t=1,e=i.length;t<e;++t){let e=i[t];e.y0+=p*t,e.y1+=p*t}}this.reorderLinks(i)}}computeNodeBreadths(t){let e=this.computeNodeLayers(t);this.initializeNodeBreadths(e);let i=this.options.iterations;if(!this._isHierarchic&&!nx(this.options.setNodeLayer)&&!nx(this.options.nodeGap))for(let t=0;t<i;++t){let r=Math.pow(.99,t),n=Math.max(1-r,(t+1)/i);this.relaxRightToLeft(e,r,n),this.relaxLeftToRight(e,r,n)}return e}relaxLeftToRight(t,e,i){for(let r=1,n=t.length;r<n;++r){let n=t[r];for(let t=0,i=n.length;t<i;t++){let i=n[t],r=0,s=0;for(let t=0,e=i.targetLinks.length;t<e;t++){let e=i.targetLinks[t],n=e.value*(i.layer-this._nodeMap[e.source].layer);r+=this.targetTop(this._nodeMap[e.source],i)*n,s+=n}if(!(s>0))continue;let a=(r/s-i.y0)*e;i.y0+=a,i.y1+=a,this.reorderNodeLinks(i)}ej(this.options.nodeSortBy)&&n.sort(js),this.resolveCollisions(n,i)}}relaxRightToLeft(t,e,i){for(let r=t.length-2;r>=0;--r){let n=t[r];for(let t=0,i=n.length;t<i;t++){let i=n[t],r=0,s=0;for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t],n=e.value*(this._nodeMap[e.target].layer-i.layer);r+=this.sourceTop(i,this._nodeMap[e.target])*n,s+=n}if(!(s>0))continue;let a=(r/s-i.y0)*e;i.y0+=a,i.y1+=a,this.reorderNodeLinks(i)}void 0===this.options.nodeSortBy&&n.sort(js),this.resolveCollisions(n,i)}}resolveCollisions(t,e){let i=t.length>>1,r=t[i];this.resolveCollisionsBottomToTop(t,r.y0-this._gapY,i-1,e),this.resolveCollisionsTopToBottom(t,r.y1+this._gapY,i+1,e),this.resolveCollisionsBottomToTop(t,this._viewBox.y1,t.length-1,e),this.resolveCollisionsTopToBottom(t,this._viewBox.y0,0,e)}resolveCollisionsTopToBottom(t,e,i,r){for(;i<t.length;++i){let n=t[i],s=(e-n.y0)*r;s>1e-6&&(n.y0+=s,n.y1+=s),e=n.y1+this._gapY}}resolveCollisionsBottomToTop(t,e,i,r){for(;i>=0;--i){let n=t[i],s=(n.y1-e)*r;s>1e-6&&(n.y0-=s,n.y1-=s),e=n.y0-this._gapY}}targetTop(t,e){let i,r,n,s=t.y0-(t.sourceLinks.length-1)*this._gapY/2;for(i=0,r=t.sourceLinks.length;i<r&&(n=t.sourceLinks[i]).target!==e.key;i++)s+=n.thickness+this._gapY;for(i=0,r=e.targetLinks.length;i<r&&(n=e.targetLinks[i]).source!==t.key;i++)s-=n.thickness;return s}sourceTop(t,e){let i,r,n,s=e.y0-(e.targetLinks.length-1)*this._gapY/2;for(i=0,r=e.targetLinks.length;i<r&&(n=e.targetLinks[i]).source!==t.key;i++)s+=n.thickness+this._gapY;for(i=0,r=t.sourceLinks.length;i<r&&(n=t.sourceLinks[i]).target!==e.key;i++)s-=n.thickness;return s}computeLinkBreadthsNoOverlap(t){for(let e=0,i=t.length;e<i;e++){let i=t[e],r=i.y0,n=!1;for(let t=0,e=i.sourceLinks.length;t<e;t++){let e=i.sourceLinks[t];n||(e.y0=r+e.thickness/2),e.x0=i.x1,r+e.thickness>i.y1||n?(e.y0=i.y1-e.thickness/2,n=!0):r+=e.thickness}let s=i.y0;n=!1;for(let t=0,e=i.targetLinks.length;t<e;t++){let e=i.targetLinks[t];n||(e.y1=s+e.thickness/2),e.x1=i.x0,s+e.thickness>i.y1||n?(e.y1=i.y1-e.thickness/2,n=!0):s+=e.thickness}}}computeLinkBreadthsOverlap(t){let e=this.options.linkOverlap;for(let i=0,r=t.length;i<r;i++){let r=t[i],n="start"===e?r.y0:"end"===e?r.y1:(r.y0+r.y1)/2,s="start"===e?.5:"end"===e?-.5:0;for(let t=0,e=r.sourceLinks.length;t<e;t++){let e=r.sourceLinks[t];e.y0=n+s*e.thickness,e.x0=r.x1}for(let t=0,e=r.targetLinks.length;t<e;t++){let e=r.targetLinks[t];e.y1=n+s*e.thickness,e.x1=r.x0}}}computeLinkBreadths(t){this.options.linkOverlap?this.computeLinkBreadthsOverlap(t):this.computeLinkBreadthsNoOverlap(t)}reorderNodeLinks(t){if(ej(this.options.linkSortBy)){let e=t.targetLinks,i=t.sourceLinks;for(let t=0,i=e.length;t<i;t++){let i=e[t];this._nodeMap[i.source].sourceLinks.sort(this._ascendingTargetBreadth)}for(let t=0,e=i.length;t<e;t++){let e=i[t];this._nodeMap[e.target].targetLinks.sort(this._ascendingSourceBreadth)}}}reorderLinks(t){if(ej(this.options.linkSortBy))for(let e=0,i=t.length;e<i;e++){let i=t[e];i.sourceLinks.sort(this._ascendingTargetBreadth),i.targetLinks.sort(this._ascendingSourceBreadth)}}}jh.defaultOptions={iterations:6,nodeAlign:"justify",direction:"horizontal",nodeWidth:24,nodeGap:8,crossNodeAlign:"middle",dropIsolatedNode:!0};let ju=(t,e)=>{let i=new jh(t).layout(Array.isArray(e)?e[0]:e,"width"in t?{width:t.width,height:t.height}:{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1});return i?[i]:[]},jd=()=>{d0.registerTransform("sankey",{transform:ju,markPhase:"beforeJoin"},!0)},jc=(t,e,i)=>{e.forEach(e=>{ej(e[i])||t.add(e[i]),e.children&&e.children.length>0&&jc(t,e.children,i)})},jp=t=>{var e;if(!t||!eM(t))return[];if(t.length>1){let e={links:[],nodes:[]};return t.forEach(t=>{"links"!==t.id&&"nodes"!==t.id||(e[t.id]=t.values)}),[e]}return(null===(e=t[0])||void 0===e?void 0:e.latestData)?t[0].latestData:t},jg=(t,e)=>{if(!t||!(null==e?void 0:e.view)||!t.length)return[];let i=e.view();if(i.x1-i.x0==0||i.y1-i.y0==0||i.x1-i.x0==-Infinity||i.x1-i.x0==1/0||i.y1-i.y0==-Infinity||i.y1-i.y0==1/0)return[];let r=t[0];if(("source"!==e.sourceField||"target"!==e.targetField||"value"!==e.valueField)&&r.links){let t=[];r.links.forEach(i=>{let r={};for(let t in i)t===e.sourceField?r.source=i[e.sourceField]:t===e.targetField?r.target=i[e.targetField]:t===e.valueField?r.value=i[e.valueField]:r[t]=i[t];t.push(r)}),r.links=t}let n=new jh(e),s=[];return s.push(n.layout(r,i)),s},jf=t=>{var e,i;return t&&eM(t)&&(null===(e=t[0])||void 0===e?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!==(i=t[0].latestData[0].nodes)&&void 0!==i?i:[]},jm=t=>{var e,i;return t&&eM(t)&&(null===(e=t[0])||void 0===e?void 0:e.latestData)&&t[0].latestData.length&&t[0].latestData[0]&&null!==(i=t[0].latestData[0].links)&&void 0!==i?i:[]};class jv extends CB{getDefaultTooltipPattern(t,e){switch(t){case"mark":return{visible:!0,activeType:t,title:{key:void 0,value:t=>{if(t.source){if(ey(t.source)){let e=this.series.getSeriesKeys();return e[t.source]+" => "+e[t.target]}return t.source+" => "+t.target}return t.datum?t.datum[this.series.getSpec().categoryField]:t.key},hasShape:!1},content:[{key:this.markTooltipKeyCallback,value:t=>t.value,hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1}]};case"dimension":if(e){let i={key:void 0,value:this._getDimensionData,hasShape:!1},r=[];return e.forEach(({data:t})=>t.forEach(({series:t})=>{r.push({seriesId:t.id,key:this.markTooltipKeyCallback,value:this.markTooltipValueCallback,hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1})})),{visible:!0,activeType:t,title:i,content:r}}}return null}}let jy=(t,e=!0)=>({type:"horizontal"===t.direction?"growWidthIn":"growHeightIn",options:{overall:e?t.growFrom():e,orient:"positive"}}),j_=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:jy(t),jb=t=>"fadeIn"===t?{type:"fadeIn"}:{type:"linkPathGrowIn"},jx=()=>{de.registerAnimation("sankeyNode",(t,e)=>Object.assign({appear:j_(t,e)},w6)),de.registerAnimation("sankeyLinkPath",(t,e)=>({appear:jb(e),enter:{type:"linkPathGrowIn"},exit:{type:"linkPathGrowOut"},disappear:{type:"linkPathGrowOut"}}))},jS=(t,e)=>{var i;let r=null!==(i=t.curvature)&&void 0!==i?i:.5,n="number"==typeof e?t.thickness*e:t.thickness,s=t.x0,a=t.x1,o=t.y0,l=t.y1,h=s+r*(a-s),u=a+r*(s-a),d=t=>t;!1!==t.round&&(s=Math.round(s),a=Math.round(a),o=Math.round(o),l=Math.round(l),h=Math.round(h),u=Math.round(u),d=Math.round),"line"===t.pathType||t.pathType,"center"===t.align?(o=d(t.y0-n/2),l=d(t.y1-n/2)):"end"===t.align?(o=d(t.y0+t.thickness/2-n),l=d(t.y1+t.thickness/2-n)):(o=d(t.y0-t.thickness/2),l=d(t.y1-t.thickness/2));let c=d(o+n),p=d(l+n),g=Math.abs(a-s)>1e-6,f=t.endArrow&&g?`L${a},${d(l-n/2)}L${d(a+n)},${d((l+p)/2)}L${a},${d(p+n/2)}`:"",m=t.startArrow&&g?`L${s},${d(c+n/2)}L${d(s-n)},${d((o+c)/2)}L${s},${d(o-n/2)}`:"";return"line"===t.pathType?`M${s},${o}L${a},${l}${f}L${a},${p}L${s},${c}${m}Z`:"polyline"===t.pathType?`M${s},${o}L${h},${o}L${h},${l}L${a},${l}
    ${f}L${a},${p}L${h},${p}L${h},${c}L${s},${c}${m}Z`:`M${s},${o}C${h},${o},${u},${l},${a},${l}
  ${f}L${a},${p}C${u},${p},${h},${c},${s},${c}${m}Z`},jk=(t,e)=>{var i;let r=null!==(i=t.curvature)&&void 0!==i?i:.5,n="number"==typeof e?t.thickness*e:t.thickness,s=t.y0,a=t.y1,o=t.x0,l=t.x1,h=s+r*(a-s),u=a+r*(s-a),d=t=>t;!1!==t.round&&(d=Math.round,s=Math.round(s),a=Math.round(a),o=Math.round(o),l=Math.round(l),h=Math.round(h),u=Math.round(u)),"line"===t.pathType||t.pathType,"center"===t.align?(o=d(t.x0-n/2),l=d(t.x1-n/2)):"end"===t.align?(o=d(t.x0+t.thickness/2-n),l=d(t.x1+t.thickness/2-n)):(o=d(t.x0-t.thickness/2),l=d(t.x1-t.thickness/2));let c=d(o+n),p=d(l+n),g=Math.abs(a-s)>1e-6,f=t.endArrow&&g?`L${d(l-n/2)},${a}L${d((l+p)/2)},${d(a+n)}L${d(p+n/2)},${a}`:"",m=t.startArrow&&g?`L${d(c+n/2)},${s}L${d((c+o)/2)},${d(s-n)}L${d(o-n/2)},${s}`:"";return"line"===t.pathType?`M${o},${s}L${l},${a}${f}L${p},${a}L${c},${s}${m}Z`:"polyline"===t.pathType?`M${o},${s}L${o},${h}L${l},${h}L${l},${a}
    ${f}L${p},${a}L${p},${h}L${c},${h}L${c},${s}${m}Z`:`M${o},${s}C${o},${h},${l},${u},${l},${a}
  ${f}L${p},${a}C${p},${u},${c},${h},${c},${s}${m}Z`},jA=(t,e,i,r)=>{var n;let s=["vertical","TB","BT"].includes(null!==(n=t.direction)&&void 0!==n?n:null==r?void 0:r.direction)?jk:jS,a="number"==typeof t.ratio&&t.ratio>=0&&t.ratio<=1,o=Object.keys(t);return["x0","y0","x1","y1"].every(t=>o.includes(t))?{back:{path:a?s(t,1):""},front:{path:s(t,a?t.ratio:1)}}:{}},jw=(t,e,i)=>{let r={x0:t.getGraphicAttribute("x0",!1),x1:t.getGraphicAttribute("x1",!1),y0:t.getGraphicAttribute("y0",!1),y1:t.getGraphicAttribute("y1",!1),thickness:t.getGraphicAttribute("thickness",!1),round:t.getGraphicAttribute("round",!1),align:t.getGraphicAttribute("align",!1),pathType:t.getGraphicAttribute("pathType",!1),endArrow:t.getGraphicAttribute("endArrow",!1),startArrow:t.getGraphicAttribute("startArrow",!1)};return Object.keys(r).forEach(t=>{ej(r[t])&&delete r[t]}),{from:Object.assign({},r,{x1:r.x0,y1:r.y0}),to:r}},jM=(t,e,i)=>{let r={x0:t.getGraphicAttribute("x0",!0),x1:t.getGraphicAttribute("x1",!0),y0:t.getGraphicAttribute("y0",!0),y1:t.getGraphicAttribute("y1",!0),thickness:t.getGraphicAttribute("thickness",!0),round:t.getGraphicAttribute("round",!0),align:t.getGraphicAttribute("align",!0),pathType:t.getGraphicAttribute("pathType",!0),endArrow:t.getGraphicAttribute("endArrow",!0),startArrow:t.getGraphicAttribute("startArrow",!0)};return Object.keys(r).forEach(t=>{ej(r[t])&&delete r[t]}),{from:r,to:Object.assign({},r,{x1:r.x0,y1:r.y0})}},jC=(t,e,i)=>{let r={thickness:t.getGraphicAttribute("thickness",!1),round:t.getGraphicAttribute("round",!1),align:t.getGraphicAttribute("align",!1),pathType:t.getGraphicAttribute("pathType",!1),endArrow:t.getGraphicAttribute("endArrow",!1),startArrow:t.getGraphicAttribute("startArrow",!1)};return Object.keys(r).forEach(t=>{ej(r[t])&&delete r[t]}),{from:Object.assign(Object.assign({x0:t.getGraphicAttribute("x0",!0),x1:t.getGraphicAttribute("x1",!0),y0:t.getGraphicAttribute("y0",!0),y1:t.getGraphicAttribute("y1",!0)},r),r),to:Object.assign({x0:t.getGraphicAttribute("x0",!1),x1:t.getGraphicAttribute("x1",!1),y0:t.getGraphicAttribute("y0",!1),y1:t.getGraphicAttribute("y1",!1)},r)}},jT=()=>{d0.registerGlyph("linkPath",{back:"path",front:"path"}).registerFunctionEncoder(jA).registerChannelEncoder("backgroundStyle",(t,e)=>({back:e})).registerDefaultEncoder(()=>({back:{zIndex:0},front:{zIndex:1}})),d0.registerAnimationType("linkPathGrowIn",jw),d0.registerAnimationType("linkPathGrowOut",jM),d0.registerAnimationType("linkPathUpdate",jC),Aq(),AV()};class jE extends Sd{constructor(){super(...arguments),this.type=jE.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x:0,y:0,x0:0,y0:0,x1:100,y1:100,thickness:1,round:!0})}_initProduct(t){let e=this.getVGrammarView(),i=this.getProductId(),r=this.getStyle("direction");this._product=e.glyph("linkPath",null!=t?t:e.rootMark).id(i).configureGlyph({direction:r}),this._compiledProductId=i}}jE.type="linkPath";let jO=()=>{jT(),de.registerMark(jE.type,jE)};class jP extends C6{constructor(){super(...arguments),this.type=cZ.sankey,this._nodeLayoutZIndex=tM.Node,this._labelLayoutZIndex=tM.Label,this._viewBox=new iB,this._fillByNode=t=>{var e,i,r,n,s;if(t&&t.sourceRect&&t.targetRect)return this._fillByLink(t);let a=null===(i=null===(e=this._spec.node)||void 0===e?void 0:e.style)||void 0===i?void 0:i.fill;if(eO(a))return a;if(eO(this._spec.seriesField)){let e=null===(n=null===(r=this._option)||void 0===r?void 0:r.globalScale)||void 0===n?void 0:n.getScale("color"),i=(null==t?void 0:t.datum)?t.datum:t;return null==e?void 0:e.scale(null==i?void 0:i[this._spec.seriesField])}return null===(s=this._colorScale)||void 0===s?void 0:s.scale(this._getNodeNameFromData(t))},this._fillByLink=t=>{var e,i,r,n,s,a,o;let l=null===(i=null===(e=this._spec.link)||void 0===e?void 0:e.style)||void 0===i?void 0:i.fill;if(l)return l;if(eO(this._spec.seriesField)){let e=null===(n=null===(r=this._nodesSeriesData)||void 0===r?void 0:r.getLatestData())||void 0===n?void 0:n.find(e=>t.source===e.key),i=null==e?void 0:e.datum,o=null===(a=null===(s=this._option)||void 0===s?void 0:s.globalScale)||void 0===a?void 0:a.getScale("color");return null==o?void 0:o.scale(null==i?void 0:i[this._spec.seriesField])}let h=ey(t.source)?this.getNodeList()[t.source]:t.source;return null===(o=this._colorScale)||void 0===o?void 0:o.scale(h)},this._handleEmphasisElement=t=>{var e;let i=null!==(e=this._spec.emphasis)&&void 0!==e?e:{},r=t.item;"adjacency"===i.effect?r&&r.mark.id().includes("node")?this._handleNodeAdjacencyClick(r):r&&r.mark.id().includes("link")?this._handleLinkAdjacencyClick(r):this._handleClearEmpty():"related"===i.effect&&(r&&r.mark.id().includes("node")?this._handleNodeRelatedClick(r):r&&r.mark.id().includes("link")?this._handleLinkRelatedClick(r):this._handleClearEmpty())},this._handleClearEmpty=()=>{var t,e,i;let r=null===(t=this._nodeMark)||void 0===t?void 0:t.getProductElements();if(!r||!r.length)return;let n=null===(e=this._linkMark)||void 0===e?void 0:e.getProductElements();if(!n||!n.length)return;let s=null===(i=this._labelMark)||void 0===i?void 0:i.getProductElements();if(!s||!s.length)return;let a=[tk.STATE_SANKEY_EMPHASIS,tk.STATE_SANKEY_EMPHASIS_REVERSE];r.forEach(t=>{t.removeState(a)}),n.forEach(t=>{t.removeState(a)}),s.forEach(t=>{t.removeState(a)})},this._handleNodeAdjacencyClick=t=>{let e=t.getDatum(),i=[e.key];if(this._linkMark){let t=this._linkMark.getProductElements();if(!t||!t.length)return;t.forEach((t,r)=>{let n=t.getDatum(),s=(null==n?void 0:n.parents)?"parents":"source";if(om(n[s]).includes(e.key)){let r;if(i.includes(n.source)||i.push(n.source),i.includes(n.target)||i.push(n.target),"parents"===s){let t=n.datum;r=(t?t.filter(t=>t.parents.some(t=>t.key===e.key)).reduce((t,e)=>t+e.value,0):0)/n.value}t.removeState(tk.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(tk.STATE_SANKEY_EMPHASIS),t.addState(tk.STATE_SANKEY_EMPHASIS,{ratio:r})}else n.target===e.key?i.includes(n.source)||i.push(n.source):(t.removeState(tk.STATE_SANKEY_EMPHASIS),t.addState(tk.STATE_SANKEY_EMPHASIS_REVERSE))})}this._nodeMark&&this._highLightElements(this._nodeMark.getProductElements(),i),this._labelMark&&this._highLightElements(this._labelMark.getProductElements(),i)},this._handleLinkAdjacencyClick=t=>{let e=t.getDatum(),i=[e.source,e.target];if(this._linkMark){let e=this._linkMark.getProductElements();if(!e||!e.length)return;e.forEach(e=>{e===t?(e.removeState(tk.STATE_SANKEY_EMPHASIS_REVERSE),e.addState(tk.STATE_SANKEY_EMPHASIS,{ratio:1})):(e.removeState(tk.STATE_SANKEY_EMPHASIS),e.addState(tk.STATE_SANKEY_EMPHASIS_REVERSE))})}this._nodeMark&&this._highLightElements(this._nodeMark.getProductElements(),i),this._labelMark&&this._highLightElements(this._labelMark.getProductElements(),i)},this._handleNodeRelatedClick=t=>{var e;let i=t.getDatum(),r=this._nodeMark.getProductElements();if(!r||!r.length)return;let n=this._linkMark.getProductElements();if(n&&n.length){if("source"==((null===(e=n[0].getDatum())||void 0===e?void 0:e.parents)?"parents":"source")){let t=[i.key],e=[];if(n.forEach((n,s)=>{var a,o,l,h;let u=n.getDatum(),d=(null==u?void 0:u.parents)?"parents":"source";if(om(u[d]).includes(i.key)){if(e.includes(null!==(a=u.key)&&void 0!==a?a:u.index)||e.push(null!==(o=u.key)&&void 0!==o?o:u.index),t.includes(u.source)||t.push(u.source),!t.includes(u.target)){t.push(u.target);let i=r.find(t=>t.data[0].key===u.target).data[0].sourceLinks;for(;(null==i?void 0:i.length)>0;){let n=[];return i.forEach(i=>{var s,a;if(!e.includes(null!==(s=i.key)&&void 0!==s?s:i.index)&&(e.push(null!==(a=i.key)&&void 0!==a?a:i.index),!t.includes(i.target))){t.push(i.target);let e=r.find(t=>t.data[0].key===i.target);n.push(e.data[0].targetLinks)}}),void(i=n)}}}else if(u.target===i.key&&(e.includes(null!==(l=u.key)&&void 0!==l?l:u.index)||e.push(null!==(h=u.key)&&void 0!==h?h:u.index),!t.includes(u.source))){t.push(u.source);let i=r.find(t=>t.data[0].key===u.source).data[0].targetLinks;for(;(null==i?void 0:i.length)>0;){let n=[];return i.forEach(i=>{var s,a;if(!e.includes(null!==(s=i.key)&&void 0!==s?s:i.index)&&(e.push(null!==(a=i.key)&&void 0!==a?a:i.index),!t.includes(i.source))){t.push(i.source);let e=r.find(t=>t.data[0].key===i.source);n.push(e.data[0].targetLinks)}}),void(i=n)}}}),this._linkMark){let t=this._linkMark.getProductElements();if(!t||!t.length)return;t.forEach((t,i)=>{var r;e.includes(null!==(r=t.getDatum().key)&&void 0!==r?r:t.getDatum().index)?(t.removeState(tk.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(tk.STATE_SANKEY_EMPHASIS)):(t.removeState(tk.STATE_SANKEY_EMPHASIS),t.addState(tk.STATE_SANKEY_EMPHASIS_REVERSE))})}this._nodeMark&&this._highLightElements(this._nodeMark.getProductElements(),t),this._labelMark&&this._highLightElements(this._labelMark.getProductElements(),t)}else{let t=[i.key],e=i.targetLinks.reduce((t,e)=>(om(e.datum).forEach(e=>{let r=e.parents,n=r.length;for(let s=0;s<n;s++){let n=r[s].key,a=r[s+1]?r[s+1].key:i.key,o=e.value,l=t.find(t=>t.source===n&&t.target===a);l?l.value+=o:t.push({source:n,target:a,value:o})}}),t),[]);n.forEach((r,n)=>{let s=r.getDatum(),a=(null==s?void 0:s.parents)?"parents":"source",o=s.datum,l=o?o.filter(t=>t[a].some(t=>t.key===i.key)):null,h=e.find(t=>t.source===s.source&&t.target===s.target);if(l&&l.length){t.includes(s.source)||t.push(s.source),t.includes(s.target)||t.push(s.target);let e=l.reduce((t,e)=>t+e.value,0)/s.value;return r.removeState(tk.STATE_SANKEY_EMPHASIS_REVERSE),r.addState(tk.STATE_SANKEY_EMPHASIS),void r.addState(tk.STATE_SANKEY_EMPHASIS,{ratio:e})}if(h)return t.includes(s.source)||t.push(s.source),t.includes(s.target)||t.push(s.target),r.removeState(tk.STATE_SANKEY_EMPHASIS_REVERSE),r.addState(tk.STATE_SANKEY_EMPHASIS),void r.addState(tk.STATE_SANKEY_EMPHASIS,{ratio:h.value/s.value});r.removeState(tk.STATE_SANKEY_EMPHASIS),r.addState(tk.STATE_SANKEY_EMPHASIS_REVERSE)}),this._nodeMark&&this._highLightElements(this._nodeMark.getProductElements(),t),this._labelMark&&this._highLightElements(this._labelMark.getProductElements(),t)}}},this._handleLinkRelatedClick=t=>{var e;let i=this._nodeMark.getProductElements();if(!i||!i.length)return;let r=this._linkMark.getProductElements();if(r&&r.length){if("source"==((null===(e=t.getDatum())||void 0===e?void 0:e.parents)?"parents":"source")){let t=[tk.STATE_SANKEY_EMPHASIS,tk.STATE_SANKEY_EMPHASIS_REVERSE];if(this._linkMark&&r.forEach(e=>{e.removeState(t)}),this._nodeMark&&i.forEach(e=>{e.removeState(t)}),this._labelMark){let e=this._labelMark.getProductElements();if(!e||!e.length)return;e.forEach(e=>{e.removeState(t)})}}else{let e=t.getDatum(),n=[e.source,e.target],s=[];om(e.datum).forEach(t=>{let e=t.parents,i=e.length;for(let r=0;r<i-1;r++){let i=e[r].key,n=e[r+1].key,a=t.value,o=s.find(t=>t.source===i&&t.target===n);s.push({source:e[r].key,target:e[r+1].key,value:t.value}),o?o.value+=a:s.push({source:i,target:n,value:a})}}),r.forEach(t=>{let i=t.getDatum(),r=i.datum;if(i.source===e.source&&i.target===e.target)return t.removeState(tk.STATE_SANKEY_EMPHASIS_REVERSE),void t.addState(tk.STATE_SANKEY_EMPHASIS,{ratio:1});let a=r?r.filter(t=>{let i=t.parents.map(t=>t.key);return i.includes(e.source)&&i.includes(e.target)}):null;if(a&&a.length){n.includes(i.source)||n.push(i.source),n.includes(i.target)||n.push(i.target);let r=a.filter(t=>t.parents.some((i,r)=>{var n;return i.key===e.source&&(null===(n=t.parents[r+1])||void 0===n?void 0:n.key)===e.target})).reduce((t,e)=>t+e.value,0)/i.value;return t.removeState(tk.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(tk.STATE_SANKEY_EMPHASIS),void t.addState(tk.STATE_SANKEY_EMPHASIS,{ratio:r})}let o=s.find(t=>t.source===i.source&&t.target===i.target);if(o)return n.includes(i.source)||n.push(i.source),n.includes(i.target)||n.push(i.target),t.removeState(tk.STATE_SANKEY_EMPHASIS_REVERSE),t.addState(tk.STATE_SANKEY_EMPHASIS),void t.addState(tk.STATE_SANKEY_EMPHASIS,{ratio:o.value/i.value});t.removeState(tk.STATE_SANKEY_EMPHASIS),t.addState(tk.STATE_SANKEY_EMPHASIS_REVERSE)}),this._highLightElements(i,n),this._labelMark&&this._highLightElements(this._labelMark.getProductElements(),n)}}}}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}setAttrFromSpec(){var t,e,i;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(null!==(t=this._spec.seriesField)&&void 0!==t?t:this._spec.categoryField),this._labelLimit=null!==(i=null===(e=this._spec.label)||void 0===e?void 0:e.limit)&&void 0!==i?i:100}initData(){var t,e,i,r;super.initData();let n=this.getViewData(),s=this.getRawData();if(s&&n){gw(this._dataSet,"sankeyLayout",jg),gw(this._dataSet,"sankeyFormat",jp),s.transform({type:"sankeyFormat"},!1),n.transform({type:"sankeyLayout",options:{view:()=>({x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2}),sourceField:this._spec.sourceField,targetField:this._spec.targetField,valueField:this._spec.valueField,direction:this._spec.direction,nodeAlign:null!==(t=this._spec.nodeAlign)&&void 0!==t?t:"justify",nodeGap:null!==(e=this._spec.nodeGap)&&void 0!==e?e:8,nodeWidth:null!==(i=this._spec.nodeWidth)&&void 0!==i?i:10,linkWidth:this._spec.linkWidth,minStepWidth:this._spec.minStepWidth,minNodeHeight:null!==(r=this._spec.minNodeHeight)&&void 0!==r?r:4,minLinkHeight:this._spec.minLinkHeight,iterations:this._spec.iterations,nodeKey:this._spec.nodeKey,linkSortBy:this._spec.linkSortBy,nodeSortBy:this._spec.nodeSortBy,setNodeLayer:this._spec.setNodeLayer,dropIsolatedNode:this._spec.dropIsolatedNode,nodeHeight:this._spec.nodeHeight,linkHeight:this._spec.linkHeight,equalNodeHeight:this._spec.equalNodeHeight,linkOverlap:this._spec.linkOverlap},level:ty.sankeyLayout});let{dataSet:a}=this._option;gw(a,"sankeyNodes",jf),gw(a,"flatten",DP);let o=new eH(a,{name:`sankey-node-${this.id}-data`});o.parse([this.getViewData()],{type:"dataview"}),o.transform({type:"sankeyNodes"}),o.transform({type:"flatten",options:{callback:t=>{if(t.datum){let e=t.datum[t.depth];return Object.assign(Object.assign({},t),e)}return t}}},!1),o.transform({type:"addVChartProperty",options:{beforeCall:CU.bind(this),call:C$}},!1),this._nodesSeriesData=new CH(this._option,o),gw(a,"sankeyLinks",jm);let l=new eH(a,{name:`sankey-link-${this.id}-data`});l.parse([this.getViewData()],{type:"dataview"}),l.transform({type:"sankeyLinks"}),l.transform({type:"addVChartProperty",options:{beforeCall:CU.bind(this),call:C$}},!1),this._linksSeriesData=new CH(this._option,l)}}initMark(){var t,e,i,r;let n=this._createMark(jP.mark.node,{isSeriesMark:!0,dataView:this._nodesSeriesData.getDataView(),dataProductId:this._nodesSeriesData.getProductId(),customShape:null===(t=this._spec.node)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.node)||void 0===e?void 0:e.stateSort});n&&(n.setZIndex(this._nodeLayoutZIndex),this._nodeMark=n);let s=this._createMark(jP.mark.link,{dataView:this._linksSeriesData.getDataView(),dataProductId:this._linksSeriesData.getProductId(),customShape:null===(i=this._spec.link)||void 0===i?void 0:i.customShape,stateSort:null===(r=this._spec.link)||void 0===r?void 0:r.stateSort});if(s&&(this._linkMark=s),this._spec.label&&this._spec.label.visible){let t=this._createMark(jP.mark.label,{dataView:this._nodesSeriesData.getDataView(),dataProductId:this._nodesSeriesData.getProductId()});t&&(this._labelMark=t)}}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToNode=this.valueToNode.bind(this),this._markAttributeContext.valueToLink=this.valueToLink.bind(this)}valueToNode(t){let e=this._nodesSeriesData.getLatestData(),i=om(t)[0];return e&&e.find(t=>t.key===i)}valueToLink(t){let e=this._linksSeriesData.getLatestData(),i=om(t);return e&&e.find(t=>t&&t.source===i[0]&&t.target===i[1])}valueToPositionX(t){let e=this.valueToNode(t);return null==e?void 0:e.x0}valueToPositionY(t){let e=this.valueToNode(t);return null==e?void 0:e.y0}initMarkStyle(){this._initNodeMarkStyle(),this._initLinkMarkStyle(),this._initLabelMarkStyle()}_initNodeMarkStyle(){let t=this._nodeMark;t&&this.setMarkStyle(t,{x:t=>t.x0,x1:t=>t.x1,y:t=>t.y0,y1:t=>t.y1,fill:this._fillByNode},tk.STATE_NORMAL,tw.Mark)}_initLinkMarkStyle(){var t;let e=this._linkMark;e&&this.setMarkStyle(e,{x0:t=>t.x0,x1:t=>t.x1,y0:t=>t.y0,y1:t=>t.y1,thickness:t=>t.thickness,fill:this._fillByLink,direction:null!==(t=this._spec.direction)&&void 0!==t?t:"horizontal"},tk.STATE_NORMAL,tw.Series)}_initLabelMarkStyle(){this._labelMark&&("vertical"===this._spec.direction?"inside-start"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:t=>t.x0,y:t=>(t.y0+t.y1)/2,fill:"#ffffff",text:t=>this._createText(t),limit:t=>{var e;return null!==(e=this._spec.label.limit)&&void 0!==e?e:t.x1-t.x0},textAlign:"left",textBaseline:"middle"},tk.STATE_NORMAL,tw.Series):"inside-middle"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:t=>(t.x0+t.x1)/2,y:t=>(t.y0+t.y1)/2,fill:"#ffffff",text:t=>this._createText(t),limit:t=>{var e;return null!==(e=this._spec.label.limit)&&void 0!==e?e:t.x1-t.x0},textAlign:"center",textBaseline:"middle"},tk.STATE_NORMAL,tw.Series):"inside-end"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:t=>t.x1,y:t=>(t.y0+t.y1)/2,fill:"#ffffff",text:t=>this._createText(t),limit:t=>{var e;return null!==(e=this._spec.label.limit)&&void 0!==e?e:t.x1-t.x0},textAlign:"right",textBaseline:"middle"},tk.STATE_NORMAL,tw.Series):this.setMarkStyle(this._labelMark,{x:t=>(t.x0+t.x1)/2,y:t=>t.y1>=this._viewBox.y2?t.y0:t.y1,fill:this._fillByNode,text:t=>this._createText(t),limit:this._labelLimit,textAlign:"center",textBaseline:t=>t.y1>=this._viewBox.y2?"bottom":"top"},tk.STATE_NORMAL,tw.Series):"inside-start"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:t=>t.x0,y:t=>(t.y0+t.y1)/2,fill:"#ffffff",text:t=>this._createText(t),limit:t=>{var e;return null!==(e=this._spec.label.limit)&&void 0!==e?e:t.x1-t.x0},textAlign:"left",textBaseline:"middle"},tk.STATE_NORMAL,tw.Series):"inside-middle"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:t=>(t.x0+t.x1)/2,y:t=>(t.y0+t.y1)/2,fill:"#ffffff",text:t=>this._createText(t),limit:t=>{var e;return null!==(e=this._spec.label.limit)&&void 0!==e?e:t.x1-t.x0},textAlign:"center",textBaseline:"middle"},tk.STATE_NORMAL,tw.Series):"inside-end"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:t=>t.x1,y:t=>(t.y0+t.y1)/2,fill:"#ffffff",text:t=>this._createText(t),limit:t=>{var e;return null!==(e=this._spec.label.limit)&&void 0!==e?e:t.x1-t.x0},textAlign:"right",textBaseline:"middle"},tk.STATE_NORMAL,tw.Series):"left"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:t=>t.x0,y:t=>(t.y0+t.y1)/2,fill:this._fillByNode,text:t=>this._createText(t),limit:this._labelLimit,textAlign:"right",textBaseline:"middle"},tk.STATE_NORMAL,tw.Series):"right"===this._spec.label.position?this.setMarkStyle(this._labelMark,{x:t=>t.x1,y:t=>(t.y0+t.y1)/2,fill:this._fillByNode,text:t=>this._createText(t),limit:this._labelLimit,textAlign:"left",textBaseline:"middle"},tk.STATE_NORMAL,tw.Series):this.setMarkStyle(this._labelMark,{x:t=>t.x1>=this._viewBox.x2?t.x0:t.x1,y:t=>(t.y0+t.y1)/2,fill:this._fillByNode,text:t=>this._createText(t),limit:this._labelLimit,textAlign:t=>t.x1>=this._viewBox.x2?"right":"left",textBaseline:"middle"},tk.STATE_NORMAL,tw.Series),this._labelMark.setZIndex(this._labelLayoutZIndex))}_createText(t){var e;if(ej(t)||ej(t.datum))return"";let i=t.datum[this._spec.categoryField]||"";return(null===(e=this._spec.label)||void 0===e?void 0:e.formatMethod)&&(i=this._spec.label.formatMethod(i,t.datum)),i}initAnimation(){var t,e,i,r,n;let s={direction:this.direction,growFrom:()=>{var t,e;return"horizontal"===this.direction?null===(t=this._xAxisHelper)||void 0===t?void 0:t.getScale(0).scale(0):null===(e=this._yAxisHelper)||void 0===e?void 0:e.getScale(0).scale(0)}},a=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset;this._nodeMark&&this._nodeMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("sankeyNode"))||void 0===i?void 0:i(s,a),Cq("node",this._spec,this._markAttributeContext))),this._linkMark&&this._linkMark.setAnimationConfig(CX(null===(r=de.getAnimationInKey("sankeyLinkPath"))||void 0===r?void 0:r(s,a),Cq("link",this._spec,this._markAttributeContext))),this._labelMark&&this._labelMark.setAnimationConfig(CX(null===(n=de.getAnimationInKey("fadeInOut"))||void 0===n?void 0:n(),Cq("label",this._spec,this._markAttributeContext)))}initEvent(){var t,e,i;super.initEvent(),null===(t=this._nodesSeriesData.getDataView())||void 0===t||t.target.addListener("change",this.nodesSeriesDataUpdate.bind(this)),null===(e=this._linksSeriesData.getDataView())||void 0===e||e.target.addListener("change",this.linksSeriesDataUpdate.bind(this));let r=null!==(i=this._spec.emphasis)&&void 0!==i?i:{};if(!0!==this._option.disableTriggerEvent&&r.enable&&("adjacency"===r.effect||"related"===r.effect)){let t="hover"===r.trigger?"pointerover":"pointerdown";this.event.on(t,{level:c3.chart},this._handleEmphasisElement)}}nodesSeriesDataUpdate(){this._nodesSeriesData.updateData(),this._nodeList=null,this._setNodeOrdinalColorScale()}linksSeriesDataUpdate(){this._linksSeriesData.updateData()}_highLightElements(t,e){t&&t.length&&t.forEach(t=>{t.removeState([tk.STATE_SANKEY_EMPHASIS_REVERSE,tk.STATE_SANKEY_EMPHASIS]),e.includes(t.getDatum().key)||t.addState(tk.STATE_SANKEY_EMPHASIS_REVERSE)})}initTooltip(){this._tooltipHelper=new jv(this),this._nodeMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodeMark),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}_setNodeOrdinalColorScale(){var t,e,i,r,n;let s,a;let o=null===(e=null===(t=this._option)||void 0===t?void 0:t.globalScale)||void 0===e?void 0:e.getScale("color");if(null==o?void 0:o._specified)return void(this._colorScale=o);o&&(s=o.domain(),a=o.range()),a||(a=this._getDataScheme()),s&&!ej(s[0])||(s=this.getNodeList()).length>10&&(a=null===(i=this._getDataScheme()[1])||void 0===i?void 0:i.scheme);let l=new x9;null===(n=(r=l.domain(s)).range)||void 0===n||n.call(r,a),this._colorScale=l}getNodeList(){var t;if(this._nodeList)return this._nodeList;let e=this._rawData.latestData[0],i=(null==e?void 0:e.nodes)?(null===(t=e.nodes[0])||void 0===t?void 0:t.children)?Array.from(this.extractNamesFromTree(e.nodes,this._spec.categoryField)):e.nodes.map((t,e)=>t[this._spec.categoryField]):(null==e?void 0:e.links)?Array.from(this.extractNamesFromLink(e.links)):null==e?void 0:e.values.map((t,e)=>t[this._spec.categoryField]);return this._nodeList=i,i}_getNodeNameFromData(t){var e;return(null==t?void 0:t.datum)?t.datum[this._spec.categoryField]:null!==(e=t.key)&&void 0!==e?e:t[this._spec.categoryField]}extractNamesFromTree(t,e){let i=new Set;return t.forEach(t=>{i.add(t[e]),t.children&&this.extractNamesFromTree(t.children,e).forEach(t=>i.add(t))}),i}extractNamesFromLink(t){let e=new Set,{sourceField:i,targetField:r}=this._spec;return t.forEach(t=>{eO(t[i])&&e.add(t[i]),eO(t[r])&&e.add(t[r])}),e}getDimensionField(){return[this._spec.categoryField]}getMeasureField(){return[this._valueField]}getRawDataStatisticsByField(t,e){var i;return this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[t]&&(this._viewDataStatistics&&this.getViewData().transformsArr.length<=1&&(null===(i=this._viewDataStatistics.latestData)||void 0===i?void 0:i[t])?this._rawStatisticsCache[t]=this._viewDataStatistics.latestData[t]:this._rawData&&(this._rawStatisticsCache[t]={values:this._collectByField(t)})),this._rawStatisticsCache[t]}_collectByField(t){var e,i,r;let n=[],s=null===(i=null===(e=this.getRawData())||void 0===e?void 0:e.latestData)||void 0===i?void 0:i[0];if(!s)return[];if(s.links)(null===(r=s.nodes)||void 0===r?void 0:r.length)&&s.nodes.forEach(t=>{t[this._seriesField]&&n.push(t[this._seriesField])});else if(s.nodes){let t=new Set;return jc(t,s.nodes,this._seriesField),Array.from(t)}return n}onLayoutEnd(t){super.onLayoutEnd(t),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this.getViewData().reRunAllTransform()}getDefaultShapeType(){return"square"}_noAnimationDataKey(t,e){}getActiveMarks(){return[this._nodeMark,this._linkMark]}}jP.type=cZ.sankey,jP.mark=h0;let jR=()=>{jd(),O2(),jO(),B9(),jx(),w7(),de.registerSeries(jP.type,jP)};class jB extends OE{_getDefaultSeriesSpec(t){let e=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{categoryField:t.categoryField,valueField:t.valueField,sourceField:t.sourceField,targetField:t.targetField,direction:t.direction,nodeAlign:t.nodeAlign,nodeGap:t.nodeGap,nodeWidth:t.nodeWidth,linkWidth:t.linkWidth,minStepWidth:t.minStepWidth,minNodeHeight:t.minNodeHeight,minLinkHeight:t.minLinkHeight,dropIsolatedNode:t.dropIsolatedNode,nodeHeight:t.nodeHeight,linkHeight:t.linkHeight,equalNodeHeight:t.equalNodeHeight,linkOverlap:t.linkOverlap,iterations:t.iterations,nodeKey:t.nodeKey,linkSortBy:t.linkSortBy,nodeSortBy:t.nodeSortBy,setNodeLayer:t.setNodeLayer,node:t.node,link:t.link,label:t.label,emphasis:t.emphasis}),i=this.seriesType;return i&&(e.type=i,e[i]=t[i]),e}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class jI extends OD{constructor(){super(...arguments),this.transformerConstructor=jB,this.type="sankey",this.seriesType=cZ.sankey}_setStateInDatum(t,e,i,r,n){let s=eM(i)?i[0]:i,a=s?Object.keys(s):null;this.getRegionsInQuerier(n).forEach(i=>{if(!s)return void i.interaction.clearEventElement(t,!0);let n=!1;i.getSeries().forEach(e=>{var o;let l=null;e.getMarksWithoutRoot().forEach(o=>{if("text"===o.type)return;let h=null,u=o.getProduct();u&&((!r||nx(r)&&r(e,o))&&(h=u.elements.find(t=>a.every(e=>{var i;let r=null===(i=t.getDatum())||void 0===i?void 0:i.datum;return eM(r)&&(r=r[0]),s[e]==(null==r?void 0:r[e])}))),h&&(n=!0,i.interaction.startInteraction(t,h),(u.id().includes("node")||u.id().includes("link"))&&(l=h)))}),l&&(null===(o=e._handleEmphasisElement)||void 0===o||o.call(e,{item:l}))}),e&&n&&i.interaction.reverseEventElement(t)})}}jI.type="sankey",jI.seriesType=cZ.sankey,jI.transformerConstructor=jB;class jL extends CB{getDefaultTooltipPattern(t,e){switch(t){case"mark":case"group":return{visible:!0,activeType:t,title:{key:void 0,value:this.dimensionTooltipTitleCallback,hasShape:!1},content:[{key:this.markTooltipKeyCallback,value:this.markTooltipValueCallback,hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1}]};case"dimension":if(e){let i={key:void 0,value:this._getDimensionData,hasShape:!1},r=[];return e.forEach(({data:t})=>t.forEach(({series:t})=>{"rangeArea"===t.type&&r.push({seriesId:t.id,key:this.markTooltipKeyCallback,value:t=>"horizontal"===this.series.getSpec().direction?t[this.series.getSpec().xField[0]]+"-"+t[this.series.getSpec().xField[1]]:t[this.series.getSpec().yField[0]]+"-"+t[this.series.getSpec().yField[1]],hasShape:!0,shapeType:this.shapeTypeCallback,shapeColor:this.shapeColorCallback,shapeStroke:this.shapeStrokeCallback,shapeHollow:!1})})),{visible:!0,activeType:t,title:i,content:r}}}return null}}class jD extends OW{constructor(){super(...arguments),this.type=cZ.rangeArea}initMark(){var t;let{customShape:e,stateSort:i}=null!==(t=this._spec.area)&&void 0!==t?t:{};this._areaMark=this._createMark(jD.mark.area,{defaultMorphElementKey:this.getDimensionField()[0],groupKey:this._seriesField,isSeriesMark:!0,customShape:e,stateSort:i})}initMarkStyle(){this.initAreaMarkStyle()}initAreaMarkStyle(){let t=this._areaMark;t&&(super.initAreaMarkStyle(),"horizontal"===this._direction?this.setMarkStyle(this._areaMark,{x1:t=>{if(!this._xAxisHelper)return Number.NaN;let{dataToPosition:e}=this._xAxisHelper;return e(this.getDatumPositionValues(t,this._spec.xField[1]),{bandPosition:this._bandPosition})}},"normal",tw.Series):this.setMarkStyle(this._areaMark,{y1:t=>{if(!this._yAxisHelper)return Number.NaN;let{dataToPosition:e}=this._yAxisHelper;return e(this.getDatumPositionValues(t,this._spec.yField[1]),{bandPosition:this._bandPosition})}},"normal",tw.Series),this.setMarkStyle(t,{stroke:!1},"normal",tw.Series))}initTooltip(){this._tooltipHelper=new jL(this),this._areaMark&&this._tooltipHelper.activeTriggerSet.dimension.add(this._areaMark)}_isFieldAllValid(){let t=this.getViewDataStatistics(),e=this.fieldY;return!!(t&&t.latestData&&e.length)&&e.every(e=>t.latestData[e]&&t.latestData[e].allValid)}}jD.type=cZ.rangeArea,jD.mark=h7;let jF=()=>{ON(),Oy(),OA(),de.registerSeries(jD.type,jD)};class jj extends OO{_getDefaultSeriesSpec(t){var e,i;let r=Object.assign({},super._getDefaultSeriesSpec(t));return r.area=t.area,"horizontal"===t.direction?r.xField=null!==(e=t.xField)&&void 0!==e?e:[t.minField,t.maxField]:r.yField=null!==(i=t.yField)&&void 0!==i?i:[t.minField,t.maxField],r.stack=!1,r}transformSpec(t){super.transformSpec(t),bg(t)}}class jN extends OD{constructor(){super(...arguments),this.transformerConstructor=jj,this.type="rangeArea",this.seriesType=cZ.rangeArea}}jN.type="rangeArea",jN.seriesType=cZ.rangeArea,jN.transformerConstructor=jj;function jz(t){if(t)return t.type===c0.Band?t.bandwidth():t.type===c0.Point?t.step():void 0}class jH extends m7{encodeState(t,e,i){return super.encodeState(t,e,i),this._updateComponentEncoders(t),this}_updateComponentEncoders(t){this._encoders||(this._encoders={});let e=this.spec.encode[t];if(e&&"update"===t){let i=this.parameters(),r=gj(e)?null:Object.keys(e).reduce((t,r)=>(mw(e[r])&&(t[r]=gz(e[r].scale,i)),t),{});this._encoders[t]={callback:(t,i,n)=>{let s=mE(e,t,i,n);if(ej(s.size)){let t=r.x?jz(r.x):void 0,e=r.y?jz(r.y):void 0;ej(t)&&ej(e)?s.size=10:ej(t)?s.size=e:ej(e)&&(s.size=t),s.size=[t,e]}return ej(s.shape)&&(s.shape="rect"),s}}}else this._encoders[t]=e}_getEncoders(){var t;return null!==(t=this._encoders)&&void 0!==t?t:{}}getAttributeTransforms(){return[{channels:["size","padding"],transform:(t,e,i)=>{if(ey(i.padding)&&i.padding>0)t.size=eM(i.size)?i.size.map(t=>Math.max(t-i.padding,1)):Math.max(i.size-i.padding,1);else if(eM(i.padding)&&2===i.padding.length){let e=eM(i.size)?i.size:[i.size,i.size];t.size=[Math.max(e[0]-i.padding[0],1),Math.max(e[1]-i.padding[1],1)]}else t.size=i.size},storedAttrs:"paddingAttrs"}].concat(mg.symbol)}release(){super.release(),this._encoders=null}}jH.markType=c8.cell;let jV=()=>{d0.registerMark(c8.cell,jH)};class jW extends Tn{constructor(){super(...arguments),this.type=jW.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{padding:0})}}jW.type="cell";let jG=()=>{de.registerMark(jW.type,jW),AX(),jV()},jU=()=>{de.registerAnimation("heatmap",(t,e)=>Object.assign(Object.assign({},w6),{appear:!1===e?{}:{type:"fadeIn"}}))};class j$ extends CB{getDefaultTooltipPattern(t,e){let i=super.getDefaultTooltipPattern(t,e);return eO(i)&&"dimension"===t&&(i.visible=!1),i}}class jY extends C3{_transformLabelSpec(t){this._addMarkLabelSpec(t,"cell")}}class jK extends C6{constructor(){super(...arguments),this.type=cZ.heatmap,this.transformerConstructor=jY}getFieldValue(){return this._fieldValue}setFieldValue(t){this._fieldValue=om(t)}setAttrFromSpec(){super.setAttrFromSpec(),this.setFieldValue(this._spec.valueField)}initMark(){var t,e,i,r;let n={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._cellMark=this._createMark(jK.mark.cell,{morph:C0(this._spec,jK.mark.cell.name),defaultMorphElementKey:this.getDimensionField()[0],isSeriesMark:!0,progressive:n,customShape:null===(t=this._spec.cell)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.cell)||void 0===e?void 0:e.stateSort}),this._backgroundMark=this._createMark(jK.mark.cellBackground,{progressive:n,customShape:null===(i=this._spec.cellBackground)||void 0===i?void 0:i.customShape,stateSort:null===(r=this._spec.cellBackground)||void 0===r?void 0:r.stateSort})}initMarkStyle(){this.initCellMarkStyle(),this.initCellBackgroundMarkStyle()}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this.getMeasureField()[0]]})}initCellMarkStyle(){this.setMarkStyle(this._cellMark,{x:t=>this.dataToPositionX(t),y:t=>this.dataToPositionY(t),size:()=>[this.getCellSize(this._xAxisHelper),this.getCellSize(this._yAxisHelper)],fill:this.getColorAttribute()},"normal",tw.Series)}initCellBackgroundMarkStyle(){var t,e,i;let r=El(null!==(i=null===(e=null===(t=this._spec.cellBackground)||void 0===t?void 0:t.style)||void 0===e?void 0:e.padding)&&void 0!==i?i:0);this.setMarkStyle(this._backgroundMark,{x:t=>{let e=this.getCellSize(this._xAxisHelper);return this.dataToPositionX(t)-e/2+r[3]},y:t=>{let e=this.getCellSize(this._yAxisHelper);return this.dataToPositionY(t)-e/2+r[0]},width:()=>this.getCellSize(this._xAxisHelper)-r[1]-r[3],height:()=>this.getCellSize(this._yAxisHelper)-r[0]-r[2]},"normal",tw.Series)}getColorAttribute(){var t;return{scale:null!==(t=this._option.globalScale.getScale("color"))&&void 0!==t?t:this._getDefaultColorScale(),field:this.getFieldValue[0]}}initInteraction(){this._parseInteractionConfig(this._cellMark?[this._cellMark]:[])}initAnimation(){var t,e,i;let r=null===(e=null===(t=this._spec)||void 0===t?void 0:t.animationAppear)||void 0===e?void 0:e.preset,n=C8(this);this._cellMark.setAnimationConfig(CX(null===(i=de.getAnimationInKey("heatmap"))||void 0===i?void 0:i(r),Cq("cell",this._spec,this._markAttributeContext),n))}getCellSize(t){var e,i;return null!==(i=null===(e=t.getBandwidth)||void 0===e?void 0:e.call(t,0))&&void 0!==i?i:6}initTooltip(){this._tooltipHelper=new j$(this),this._cellMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._cellMark)}getDefaultShapeType(){return"square"}getDimensionField(){return[].concat(this.fieldX,this.fieldY)}getMeasureField(){return this.getFieldValue()}getActiveMarks(){return[this._cellMark]}}jK.type=cZ.heatmap,jK.mark=h6,jK.transformerConstructor=jY;let jZ=()=>{B9(),jG(),jU(),Oy(),OA(),de.registerSeries(jK.type,jK)};class jX extends OO{_getDefaultSeriesSpec(t){return Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{valueField:t.valueField,cell:t.cell})}}class jq extends OD{constructor(){super(...arguments),this.transformerConstructor=jX,this.type="heatmap",this.seriesType=cZ.heatmap}}jq.type="heatmap",jq.seriesType=cZ.heatmap,jq.transformerConstructor=jX;let jJ=`${hA}_CORRELATION_X`,jQ=`${hA}_CORRELATION_Y`,j0=`${hA}_CORRELATION_SIZE`,j1=(t,e)=>{var i,r,n,s,a,o,l,h,u,d,c,p,g,f,m;if(!t||!(null==e?void 0:e.view)||!eM(t))return t;let v=e.view();if(v.x1-v.x0==0||v.y1-v.y0==0||v.x1-v.x0==-Infinity||v.x1-v.x0==1/0||v.y1-v.y0==-Infinity||v.y1-v.y0==1/0)return t;let y=ik(null!==(i=e.startAngle)&&void 0!==i?i:-90),_=ik(null!==(r=e.endAngle)&&void 0!==r?r:270),b=Math.max((v.x1-v.x0)/2,(v.y1-v.y0)/2),x=vs(null!==(n=e.innerRadius)&&void 0!==n?n:0,b),S=vs(e.outerRadius,b),k=[ey(null===(s=e.center)||void 0===s?void 0:s[0])?e.center[0]:v.x0+vs(null!==(o=null===(a=e.center)||void 0===a?void 0:a[0])&&void 0!==o?o:"50%",v.x1-v.x0),ey(null===(l=e.center)||void 0===l?void 0:l[1])?e.center[1]:v.y0+vs(null!==(u=null===(h=e.center)||void 0===h?void 0:h[1])&&void 0!==u?u:"50%",v.y1-v.y0)],A=fl(e.field),w=t.map(A),[M,C]=IF(w),T=M===C?t=>(x+S)/2:t=>x+(S-x)*(t-M)/(C-M),E=ej(e.radiusField)?A:fl(e.radiusField),O=null!==(c=null===(d=null==e?void 0:e.radiusRange)||void 0===d?void 0:d[1])&&void 0!==c?c:5,P=t=>O;if(E){let[i,r]=E!==A?IF(t.map(E)):[M,C],n=null!==(g=null===(p=e.radiusRange)||void 0===p?void 0:p[0])&&void 0!==g?g:5,s=null!==(m=null===(f=e.radiusRange)||void 0===f?void 0:f[1])&&void 0!==m?m:5;i!==r&&(P=t=>n+(s-n)*(E(t)-i)/(r-i))}let R=Math.min(y,_),B=Math.max(y,_),I=j2(R,B,t.length),L=[],D=(B-R)/60;return t.forEach((t,e)=>{let i=T(w[e]),r=P(t),n,s,a=I[e];for(let t=0;t<60&&(n=k[0]+i*Math.cos(a),j3({x:n,y:s=k[1]+i*Math.sin(a),size:r},L)||n-r<v.x0||n+r>v.x1||s-r<v.y0||s+r>v.y1);t++)t<59&&((a+=D)>B?a=R:a<R&&(a=B));L.push(Object.assign({[jJ]:n,[jQ]:s,[j0]:r},t))}),L},j2=(t,e,i)=>{let r=0,n=Math.max(Math.ceil(2*(e-t)/Math.PI),2),s=(e-t)/n,a=0,o=1,l=0,h=0,u=[],d=t;for(;l<i;)h<n&&(u.push(d+(h%2?Math.floor(h/2)+Math.floor(n/2):h/2)*s*o),h++),l++,h===n&&(h=0,a+=1,o*=-1,0===r?r=s/2:r/=2,d=-1===o?e-r:t+r,a>=2&&(s/=2,n*=2));return u},j3=(t,e)=>!(!e||!e.length)&&e.some(e=>Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<Math.pow(t.size+e.size,2)),j5=(t,e)=>{if(!t||!eM(t))return[];let{keyword:i,categoryField:r}=e,n=t[0].latestData[0];return{[r]:i,[bA]:null==n?void 0:n[bA],[bM]:null==n?void 0:n[bM]}},j4=()=>{d0.registerGlyph("ripplePoint",{symbol:"symbol",ripple0:"symbol",ripple1:"symbol",ripple2:"symbol"}).registerFunctionEncoder((t,e,i,r)=>{var n;let s=Math.max(0,Math.min(t.ripple,1)),a=null!==(n=t.size)&&void 0!==n?n:i.getGraphicAttribute("size"),o=.5*a;return{ripple0:{size:a+o*s,fillOpacity:.75-.25*s},ripple1:{size:a+o*(1+s),fillOpacity:.5-.25*s},ripple2:{size:a+o*(2+s),fillOpacity:.25-.25*s}}}).registerDefaultEncoder(()=>({ripple0:{fillOpacity:.75},ripple1:{fillOpacity:.5},ripple2:{fillOpacity:.25}})),Aq(),A$()};class j8 extends Sd{constructor(){super(...arguments),this.type=j8.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x:0,y:0,ripple:0})}_initProduct(t){let e=this.getVGrammarView(),i=this.getProductId();this._product=e.glyph("ripplePoint",null!=t?t:e.rootMark).id(i),this._compiledProductId=i}}j8.type="ripple";let j6=()=>{de.registerMark(j8.type,j8),j4()},j9=(t,e)=>"fadeIn"===e?{type:"fadeIn"}:{type:"scaleIn"},j7=()=>{de.registerAnimation("correlation",(t,e)=>Object.assign({appear:j9(0,e)},w8))};class Nt extends C3{_transformLabelSpec(t){this._addMarkLabelSpec(t,"nodePoint"),this._addMarkLabelSpec(t,"centerPoint","centerLabel")}}class Ne extends Rq{constructor(){super(...arguments),this.type=cZ.correlation,this.transformerConstructor=Nt,this._viewBox=new iB}getCategoryField(){return this._categoryField}setCategoryField(t){return this._categoryField=t,this._categoryField}getValueField(){return this._valueField}setValueField(t){return this._valueField=t,this._valueField}getSeriesField(){return this._seriesField}setSeriesField(t){eO(t)&&(this._seriesField=t)}getSizeField(){return this._sizeField}setSizeField(t){eO(t)&&(this._sizeField=t)}getSizeRange(){return this._sizeRange}setSizeRange(t){eO(t)&&(this._sizeRange=t)}setAttrFromSpec(){super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(this._spec.seriesField),this.setSizeField(this._spec.sizeField),this.setSizeRange(this._spec.sizeRange)}initData(){var t,e,i;if(super.initData(),!this._data)return;gw(this._dataSet,"correlation",j1);let r=new eA;gM(r,"dataview",eC),gw(r,"correlationCenter",j5);let n=new eH(r,{name:`${this.type}_${this.id}_center`});n.parse([this.getViewData()],{type:"dataview"}),n.transform({type:"correlationCenter",options:{keyword:null!==(i=null===(e=null===(t=this._spec.centerLabel)||void 0===t?void 0:t.style)||void 0===e?void 0:e.text)&&void 0!==i?i:"",categoryField:this._spec.categoryField}}),this._centerSeriesData=new CH(this._option,n)}_statisticViewData(){super._statisticViewData(),this._data.getDataView().transform({type:"correlation",options:{view:()=>({x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2}),field:this._spec.valueField,radiusRange:this._spec.sizeRange,radiusField:this._spec.sizeField,center:[this._spec.centerX,this._spec.centerY],innerRadius:this._spec.innerRadius,outerRadius:this._spec.outerRadius,startAngle:this._spec.startAngle,endAngle:this._spec.endAngle}})}initMark(){var t,e,i,r;let n=this._createMark(Ne.mark.nodePoint,{groupKey:this._seriesField,isSeriesMark:!0,key:bA,customShape:null===(t=this._spec.nodePoint)||void 0===t?void 0:t.customShape,stateSort:null===(e=this._spec.nodePoint)||void 0===e?void 0:e.stateSort});n&&(n.setZIndex(tM.Node),this._nodePointMark=n);let s=this._createMark(Ne.mark.ripplePoint,{key:bA,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});s&&(this._ripplePointMark=s);let a=this._createMark(Ne.mark.centerPoint,{key:bA,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId(),customShape:null===(i=this._spec.centerPoint)||void 0===i?void 0:i.customShape,stateSort:null===(r=this._spec.centerPoint)||void 0===r?void 0:r.stateSort});a&&(a.setZIndex(tM.Node),this._centerPointMark=a)}initMarkStyle(){this._initNodePointMarkStyle(),this._initRipplePointMarkStyle(),this._initCenterPointMarkStyle()}_initNodePointMarkStyle(){var t,e,i,r;let n=this._nodePointMark;if(!n)return;let s=null!==(e=null===(t=this._spec.nodePoint)||void 0===t?void 0:t.style)&&void 0!==e?e:{};this.setMarkStyle(n,{x:t=>t[jJ],y:t=>t[jQ],size:t=>t[j0],fill:null!==(i=s.fill)&&void 0!==i?i:this.getColorAttribute(),fillOpacity:null!==(r=s.fillOpacity)&&void 0!==r?r:1,lineWidth:0},tk.STATE_NORMAL,tw.Series)}_initRipplePointMarkStyle(){var t,e,i,r,n;let s=this._ripplePointMark;if(!s)return;let a=null!==(e=null===(t=this._spec.ripplePoint)||void 0===t?void 0:t.style)&&void 0!==e?e:{};this.setMarkStyle(s,{x:()=>{var t;return null!==(t=this._spec.centerX)&&void 0!==t?t:(this._viewBox.x1+this._viewBox.x2)/2},y:()=>{var t;return null!==(t=this._spec.centerY)&&void 0!==t?t:(this._viewBox.y1+this._viewBox.y2)/2},size:()=>Math.max(this._viewBox.x2-this._viewBox.x1,this._viewBox.y2-this._viewBox.y1)/2,fill:null!==(i=a.fill)&&void 0!==i?i:this.getColorAttribute(),opacity:null!==(r=a.fillOpacity)&&void 0!==r?r:.2,ripple:null!==(n=a.ripple)&&void 0!==n?n:0},tk.STATE_NORMAL,tw.Series)}_initCenterPointMarkStyle(){var t,e,i,r,n,s;let a=this._centerPointMark;a&&this.setMarkStyle(a,{x:()=>{var t;return null!==(t=this._spec.centerX)&&void 0!==t?t:(this._viewBox.x1+this._viewBox.x2)/2},y:()=>{var t;return null!==(t=this._spec.centerY)&&void 0!==t?t:(this._viewBox.y1+this._viewBox.y2)/2},size:()=>.2*Math.max(this._viewBox.x2-this._viewBox.x1,this._viewBox.y2-this._viewBox.y1)/2,fill:null!==(i=null===(e=null===(t=this._spec.centerPoint)||void 0===t?void 0:t.style)||void 0===e?void 0:e.fill)&&void 0!==i?i:this.getColorAttribute(),fillOpacity:null!==(s=null===(n=null===(r=this._spec.centerPoint)||void 0===r?void 0:r.style)||void 0===n?void 0:n.fillOpacity)&&void 0!==s?s:1},tk.STATE_NORMAL,tw.Series)}initTooltip(){super.initTooltip(),this._nodePointMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodePointMark)}initLabelMarkStyle(t){t&&this.setMarkStyle(t,{fill:this.getColorAttribute(),text:t=>t[this._categoryField],z:this.dataToPositionZ.bind(this)},tk.STATE_NORMAL,tw.Series)}initAnimation(){var t,e;let i=null===(t=this._spec.animationAppear)||void 0===t?void 0:t.preset;this._nodePointMark.setAnimationConfig(CX(null===(e=de.getAnimationInKey("correlation"))||void 0===e?void 0:e({},i),Cq("nodePoint",this._spec,this._markAttributeContext)))}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}getActiveMarks(){return[this._nodePointMark,this._centerPointMark]}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(t){super.onLayoutEnd(t),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this._rawData.reRunAllTransform(),this.getViewData().reRunAllTransform()}}Ne.type=cZ.correlation,Ne.mark=h9,Ne.transformerConstructor=Nt;let Ni=()=>{Ta(),j6(),de.registerSeries(Ne.type,Ne),j7()};class Nr extends OE{_getDefaultSeriesSpec(t){let e=Object.assign(Object.assign({},super._getDefaultSeriesSpec(t)),{categoryField:t.categoryField,valueField:t.valueField,seriesField:t.seriesField,sizeField:t.sizeField,sizeRange:t.sizeRange,centerX:t.centerX,centerY:t.centerY,innerRadius:t.innerRadius,outerRadius:t.outerRadius,startAngle:t.startAngle,endAngle:t.endAngle,ripplePoint:t.ripplePoint,centerPoint:t.centerPoint,centerLabel:t.centerLabel,nodePoint:t.nodePoint,label:t.label}),i=cZ.correlation;return e.type=i,e[i]=t[i],e}transformSpec(t){super.transformSpec(t),this.transformSeriesSpec(t)}}class Nn extends OD{constructor(){super(...arguments),this.transformerConstructor=Nr,this.type="correlation",this.seriesType=cZ.correlation}}Nn.type="correlation",Nn.seriesType=cZ.correlation,Nn.transformerConstructor=Nr;class Ns extends Ok{constructor(){super(...arguments),this.type=lx.cartesianTimeAxis,this._zero=!1,this.effect={scaleUpdate:t=>{this.computeData(null==t?void 0:t.value),dC(this._regions,t=>{dR(this.getOrient())?t.setXAxisHelper(this.axisHelper()):t.setYAxisHelper(this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}}}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._tick=us({},this._spec.tick,null===(t=this._spec.layers)||void 0===t?void 0:t[0])}_initData(){var t;if(super._initData(),null===(t=this._spec.layers)||void 0===t?void 0:t[1]){let t=new eH(this._option.dataSet,{name:`${this.type}_${this.id}_layer_1_ticks`}).parse(this._scale,{type:"scale"}).transform({type:"ticks",options:Object.assign(Object.assign({},this._tickTransformOption()),{tickCount:this._spec.layers[1].tickCount,forceTickCount:this._spec.layers[1].forceTickCount,tickStep:this._spec.layers[1].tickStep})},!1);this._layerTickData=new Sa(this._option,t)}}computeData(t){super.computeData(t),this._layerTickData&&(this._layerTickData.getDataView().reRunAllTransform(),this._layerTickData.updateData())}_getLabelFormatMethod(){var t,e,i,r,n,s,a,o;let l=Bq.getInstance(),h=(null===(e=null===(t=this._spec.layers)||void 0===t?void 0:t[1])||void 0===e?void 0:e.timeFormat)||"%Y%m%d",u="local"===((null===(r=null===(i=this._spec.layers)||void 0===i?void 0:i[1])||void 0===r?void 0:r.timeFormatMode)||"local")?l.timeFormat:l.timeUTCFormat,d=(null===(s=null===(n=this._spec.layers)||void 0===n?void 0:n[0])||void 0===s?void 0:s.timeFormat)||"%Y%m%d",c="local"===((null===(o=null===(a=this._spec.layers)||void 0===a?void 0:a[0])||void 0===o?void 0:o.timeFormatMode)||"local")?l.timeFormat:l.timeUTCFormat;return(t,e,i,r,n)=>{var s;let a;return a=0===n?c(d,t):u(h,t),(null===(s=this._spec.label)||void 0===s?void 0:s.formatMethod)?this._spec.label.formatMethod(a,e):a}}getLabelItems(t){var e,i;let r=[],n=null===(e=this.getTickData())||void 0===e?void 0:e.getLatestData();n&&n.length&&r.push(n.map(e=>Tq(e.value,this._getNormalizedValue([e.value],t))));let s=null===(i=this._layerTickData)||void 0===i?void 0:i.getLatestData();return s&&s.length&&r.push(s.map(e=>Tq(e.value,this._getNormalizedValue([e.value],t)))),r}transformScaleDomain(){}}Ns.type=lx.cartesianTimeAxis,Ns.specKey="axes";class Na{nice(t=10,e){var i,r,n,s;let a=this._domain,o=[],l=null;if(e){let t=xj(a,e);if(o=t.niceMinMax,this._domainValidator=t.domainValidator,l=t.niceType,t.niceDomain)return this._niceDomain=t.niceDomain,this.rescale(),this}else l="all";if(l){let t=xx(a.slice(),null!==(r=null===(i=this.getNiceConfig)||void 0===i?void 0:i.call(this))&&void 0!==r?r:{floor:t=>Math.floor(t),ceil:t=>Math.ceil(t)});return"min"===l?t[t.length-1]=null!==(n=o[1])&&void 0!==n?n:t[t.length-1]:"max"===l&&(t[0]=null!==(s=o[0])&&void 0!==s?s:t[0]),this._niceDomain=t,this.rescale(),this}return this}niceMin(){let t=this._domain[this._domain.length-1];this.nice();let e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}niceMax(){let t=this._domain[0];this.nice();let e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}function No(t){return e=>-t(-e)}function Nl(t=Number.EPSILON){return e=>Math.max(e,t)}class Nh extends x0{constructor(){super(xc(10),xd(10)),this.type=c0.Log,this._limit=Nl(),this._logs=this.transformer,this._pows=this.untransformer,this._domain=[1,10],this._base=10}clone(){return(new Nh).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}rescale(t){var e,i,r;if(t)return this;super.rescale();let n=xc(this._base),s=xd(this._base);return(null!==(e=this._niceDomain)&&void 0!==e?e:this._domain)[0]<0?(this._logs=(i=n,t=>-i(-t)),this._pows=(r=s,t=>-r(-t)),this._limit=function(t=Number.EPSILON){return e=>Math.min(e,-t)}(),this.transformer=xl,this.untransformer=xh):(this._logs=n,this._pows=s,this._limit=Nl(),this.transformer=this._logs,this.untransformer=s),this}scale(t){var e;if(Number.isNaN(t=Number(t))||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise((null!==(e=this._niceDomain)&&void 0!==e?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));let i=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(i):i}base(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}tickFormat(){return xs}d3Ticks(t=10,e){let i=this.domain(),r=this._limit(i[0]);return xz(r,this._limit(i[i.length-1]),t,this._base,this.transformer,this.untransformer,e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return xH(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return xV(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return xV(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}getNiceConfig(){return{floor:t=>this._pows(Math.floor(this._logs(this._limit(t)))),ceil:t=>Math.abs(t)>=1?Math.ceil(t):this._pows(Math.ceil(this._logs(this._limit(t))))}}}CS(Nh,Na);class Nu extends Ok{constructor(){super(...arguments),this.type=lx.cartesianLogAxis,this._zero=!1,this._scale=new Nh}initScales(){var t;super.initScales(),this._scale.base(null!==(t=this._spec.base)&&void 0!==t?t:10),this._scale.clamp(!0,null,!1)}transformScaleDomain(){}}Nu.type=lx.cartesianLogAxis,Nu.specKey="axes",CS(Nu,OS);class Nd extends x1{constructor(){super(xp(1),xg(1)),this.type=c0.Symlog,this._const=1}clone(){return(new Nd).domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}constant(t,e){return arguments.length?(this._const=t,this.transformer=xp(t),this.untransformer=xg(t),this.rescale(e)):this._const}d3Ticks(t=10,e){let i=this.domain(),r=i[0];return xz(r,i[i.length-1],t,this._const,this.transformer,this.untransformer,e)}ticks(t=10){let e=this.calculateVisibleDomain(this._range);return xH(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}forceTicks(t=10){let e=this.calculateVisibleDomain(this._range);return xV(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){let e=this.calculateVisibleDomain(this._range);return xV(e[0],e[e.length-1],t,this.transformer,this.untransformer)}}CS(Nd,Na);class Nc extends Ok{constructor(){super(...arguments),this.type=lx.cartesianSymlogAxis,this._zero=!1,this._scale=new Nd}initScales(){var t;super.initScales(),this._scale.constant(null!==(t=this._spec.constant)&&void 0!==t?t:10)}transformScaleDomain(){}}Nc.type=lx.cartesianSymlogAxis,Nc.specKey="axes",CS(Nc,OS);function Np(t){var e,i;let r=Object.assign({},t);return mk(t.style)||(r.textStyle=Tz(t.style)),mk(t.textStyle)||us(r.textStyle,Tz(t.textStyle)),(null===(e=t.shape)||void 0===e?void 0:e.style)&&Tz(r.shape.style),(null===(i=t.background)||void 0===i?void 0:i.style)&&Tz(r.background.style),r}var Ng=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Nf extends Eu{constructor(){super(...arguments),this.name="legend",this._title=null}render(){this.removeAllChild(!0);let{interactive:t=!0,title:e,padding:i=0}=this.attribute,r=El(i),n=aj.group({x:r[3],y:r[0],pickable:t,childrenPickable:t});n.name=t4.innerView,this.add(n),this._innerView=n,(null==e?void 0:e.visible)&&this._renderTitle(e),this._renderContent(),this._adjustLayout(),t&&this._bindEvents();let s=this._innerView.AABBBounds;this.attribute.width=s.width()+r[1]+r[3],this.attribute.height=s.height()+r[0]+r[2]}_renderTitle(t){let{text:e="",textStyle:i,padding:r=0,background:n,minWidth:s,maxWidth:a,shape:o}=t,l={x:0,y:0,text:e,textStyle:i,padding:El(r),minWidth:s,maxWidth:a};o&&o.visible&&(l.shape=Object.assign({visible:!0},o.style),eO(o.space)&&(l.space=o.space)),n&&n.visible&&(l.panel=Object.assign({visible:!0},n.style));let h=new Ey(l);h.name=t4.title,this._title=h,this._innerView.add(h)}_adjustLayout(){var t;if(this._title){let e=this._innerView.AABBBounds.width(),i=this._title.AABBBounds.width(),r=null===(t=this.attribute.title)||void 0===t?void 0:t.align;"center"===r?this._title.setAttribute("x",(e-i)/2):"end"===r&&this._title.setAttribute("x",e-i)}}}function Nm(){v8(),_2(),yG()}let Nv={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};Nm();class Ny extends Eu{getCurrent(){return this._current}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},Ny.defaultAttributes,t)),this.name="pager",this._current=1,this._onHover=t=>{let e=t.target;e.hasState("disable")||e.addState("hover")},this._onUnHover=t=>{t.target.removeState("hover")},this._onClick=t=>{let e=t.target;if("preHandler"===e.name){if(1===this._current)return;this._current-=1,1===this._current?e.addState("disable"):e.removeState("disable"),this._dispatchEvent("toPrev",{current:this._current,total:this._total,direction:"pre",event:t})}if("nextHandler"===e.name){if(this._current===this._total)return;this._current+=1,this._current===this._total?e.addState("disable"):e.removeState("disable"),this._dispatchEvent("toNext",{current:this._current,total:this._total,direction:"next",event:t})}this._current>1&&this.preHandler.removeState("disable"),this._current<this._total&&this.nextHandler.removeState("disable"),this.text.setAttribute("text",this._getPageText(this._current))}}render(){var t,e,i;this._reset();let{layout:r="horizontal",handler:n=Nv,total:s,defaultCurrent:a=1,textStyle:o,padding:l=0}=this.attribute;this._current=a;let h=El(l),u="horizontal"===r,d=aj.group({x:0,y:0}),c=n.style||{},p=c.size||15,g=null!==(t=n.space)&&void 0!==t?t:8,f=n.state||{},{preShape:m,nextShape:v}=n;m||(m=u?"triangleLeft":"triangleUp"),v||(v=u?"triangleRight":"triangleDown");let y=aj.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},c),{x:0,y:0,symbolType:m,size:p}));y.states=f,y.name="preHandler",this.preHandler=y,d.add(y);let{width:_,height:b}=MT(this._getPageText(s),Object.assign({textAlign:"center",textBaseline:"middle"},o),null===(i=null===(e=this.stage)||void 0===e?void 0:e.getTheme())||void 0===i?void 0:i.text),x=ey(p)?p:p[0],S=ey(p)?p:p[1],k=aj.text(Object.assign({x:u?x/2+g+_/2:0,y:u?0:S/2+g+b/2,text:this._getPageText(a),textAlign:"center",textBaseline:"middle",lineHeight:null==o?void 0:o.fontSize},o));this.text=k,d.add(k);let A=aj.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},c),{x:u?x+2*g+_:0,y:u?0:S+2*g+b,symbolType:v,size:p}));A.name="nextHandler",A.states=f,this.nextHandler=A,d.add(A),1===this._total?(y.addState("disable"),A.addState("disable")):1===this._current?y.addState("disable"):this._current===s&&A.addState("disable");let w=d.AABBBounds,M=w.width(),C=w.height();d.translateTo(0-w.x1+h[3],0-w.y1+h[0]),this.add(d),this.attribute.width=M+h[1]+h[3],this.attribute.height=C+h[0]+h[2],this._bindEvents()}_bindEvents(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}_reset(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}_getPageText(t){let{pageFormatter:e}=this.attribute;return e?nx(e)?e(t,this._total):`${e}`.replace("{current}",`${t}`).replace("{total}",`${this._total}`):`${t}/${this._total}`}setTotal(t){t!==this.attribute.total&&(this._total=t,1!==this._current&&this._current<=t?this.setAttributes({total:t,defaultCurrent:this._current}):this.setAttribute("total",t))}}function N_(){v8(),yG(),bp(),_2()}function Nb(){v8(),bp()}function Nx(){v8(),Em()}Ny.defaultAttributes={handler:Nv,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};let NS=(t,e,i)=>{let[r,n]=t;n<r&&(r=t[1],n=t[0]);let s=n-r;return s>=i-e?[e,i]:[r=Math.min(Math.max(r,e),i-s),r+s]},Nk={debounce:l3,throttle:dJ};v8(),bp();class NA extends Eu{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},NA.defaultAttributes,t)),this.name="scrollbar",this._onRailPointerDown=t=>{let e;let{viewX:i,viewY:r}=t,{direction:n,width:s,height:a,range:o}=this.attribute,l=this._sliderSize,[h,u]=this._getScrollRange();if("vertical"===n){let t=r-this._viewPosition.y,i=nL(t-l/2,h,u);e=t/a,this._slider.setAttribute("y",i,!0)}else{let t=i-this._viewPosition.x,r=nL(t-l/2,h,u);e=t/s,this._slider.setAttribute("x",r,!0)}this.setScrollRange([e-(o[1]-o[0])/2,e+(o[1]-o[0])/2],!1),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()},this._onSliderPointerDown=t=>{let{stopSliderDownPropagation:e=!0}=this.attribute;e&&t.stopPropagation();let{direction:i}=this.attribute,{x:r,y:n}=this.stage.eventPointTransform(t);this._prePos="horizontal"===i?r:n,this._dispatchEvent("scrollDown",{pos:this._prePos,event:t}),"browser"===lX.env?(lX.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),lX.addEventListener("pointerup",this._onSliderPointerUp)):(this.stage.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),this.stage.addEventListener("pointerup",this._onSliderPointerUp),this.stage.addEventListener("pointerupoutside",this._onSliderPointerUp))},this._computeScrollValue=t=>{let{direction:e}=this.attribute,{x:i,y:r}=this.stage.eventPointTransform(t),n,s,a=0,{width:o,height:l}=this._getSliderRenderBounds();return n="vertical"===e?(a=(s=r)-this._prePos)/l:(a=(s=i)-this._prePos)/o,[s,n]},this._onSliderPointerMove=t=>{let{stopSliderMovePropagation:e=!0}=this.attribute;e&&t.stopPropagation();let i=this.getScrollRange(),[r,n]=this._computeScrollValue(t);this.setScrollRange([i[0]+n,i[1]+n],!0),this._prePos=r},this._onSliderPointerMoveWithDelay=0===this.attribute.delayTime?this._onSliderPointerMove:Nk[this.attribute.delayType](this._onSliderPointerMove,this.attribute.delayTime),this._onSliderPointerUp=t=>{t.preventDefault();let{realTime:e=!0,range:i,limitRange:r=[0,1]}=this.attribute,n=this.getScrollRange(),[s,a]=this._computeScrollValue(t),o=[n[0]+a,n[1]+a];this._dispatchEvent("scrollUp",{pre:i,value:NS(o,r[0],r[1])}),"browser"===lX.env?(lX.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),lX.removeEventListener("pointerup",this._onSliderPointerUp)):(this.stage.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),this.stage.removeEventListener("pointerup",this._onSliderPointerUp),this.stage.removeEventListener("pointerupoutside",this._onSliderPointerUp))}}setScrollRange(t,e=!0){let{direction:i="horizontal",limitRange:r=[0,1],range:n,realTime:s=!0}=this.attribute,a=NS(t,r[0],r[1]);if(e){let t=this._getSliderPos(a);if(this._slider){let e=t[1]-t[0];this._sliderSize=e,"horizontal"===i?this._slider.setAttributes({x:t[0],width:e},!0):this._slider.setAttributes({y:t[0],height:e},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=a,s&&this._dispatchEvent("scrollDrag",{pre:n,value:a})}getScrollRange(){return this.attribute.range}bindEvents(){if(this.attribute.disableTriggerEvent)return;let{delayType:t="throttle",delayTime:e=0}=this.attribute;this._rail&&this._rail.addEventListener("pointerdown",Nk[t](this._onRailPointerDown,e)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown)}render(){let t;this._reset();let{direction:e="horizontal",width:i,height:r,range:n,limitRange:s=[0,1],railStyle:a,sliderStyle:o,padding:l=2}=this.attribute,h=this.createOrUpdateChild("scrollbar-container",{},"group"),u=h.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:i,height:r},a),"rect");this._rail=u;let d=this._getSliderRenderBounds(),c=this._getSliderPos(NS(n,s[0],s[1])),p=c[1]-c[0];this._sliderSize=p,t="horizontal"===e?{x:c[0],y:d.y1,width:p,height:d.height}:{x:d.x1,y:c[0],width:d.width,height:p};let g=h.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},t),{cornerRadius:this._getDefaultSliderCornerRadius()}),o),{boundsPadding:El(l),pickMode:"imprecise"}),"rect");this._slider=g,this._container=h;let f=this._container.AABBBounds;this._viewPosition={x:f.x1,y:f.y1}}_getSliderRenderBounds(){if(this._sliderRenderBounds)return this._sliderRenderBounds;let{width:t,height:e,padding:i=2}=this.attribute,[r,n,s,a]=El(i),o={x1:a,y1:r,x2:t-n,y2:e-s,width:Math.max(0,t-(a+n)),height:Math.max(0,e-(r+s))};return this._sliderRenderBounds=o,o}_getDefaultSliderCornerRadius(){let{direction:t,round:e}=this.attribute;if(e){let{width:e,height:i}=this._getSliderRenderBounds();return"horizontal"===t?i:e}return 0}_getSliderPos(t){let{direction:e}=this.attribute,{width:i,height:r,x1:n,y1:s}=this._getSliderRenderBounds();return"horizontal"===e?[i*t[0]+n,i*t[1]+n]:[r*t[0]+s,r*t[1]+s]}_getScrollRange(){if(this._sliderLimitRange)return this._sliderLimitRange;let{limitRange:t=[0,1],direction:e}=this.attribute,[i,r]=NS(t,0,1),{width:n,height:s,x1:a,y1:o}=this._getSliderRenderBounds(),l=this._sliderSize;return"horizontal"===e?NS([a+i*n,a+r*n],a,n-l):NS([o+i*s,o+r*s],o,s-l)}_reset(){this._sliderRenderBounds=null,this._sliderLimitRange=null}}NA.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0};var Nw=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let NM={[t3.focus]:{},[t3.selected]:{},[t3.selectedHover]:{},[t3.unSelected]:{},[t3.unSelectedHover]:{}};Nx(),Nm(),v8(),bp();class NC extends Nf{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},NC.defaultAttributes,t)),this.name="discreteLegend",this._itemsContainer=null,this._itemHeightByUser=void 0,this._itemHeight=0,this._itemMaxWidth=0,this._onHover=t=>{let e=t.target;if(e&&e.name&&e.name.startsWith(t4.item)){let i=e.delegate;if(this._lastActiveItem){if(this._lastActiveItem.id===i.id)return;this._unHover(this._lastActiveItem,t)}this._hover(i,t)}else this._lastActiveItem&&(this._unHover(this._lastActiveItem,t),this._lastActiveItem=null)},this._onUnHover=t=>{this._lastActiveItem&&(this._unHover(this._lastActiveItem,t),this._lastActiveItem=null)},this._onClick=t=>{var e,i,r,n;let s=t.target;if(s&&s.name&&s.name.startsWith(t4.item)){let a=s.delegate,{selectMode:o="multiple"}=this.attribute;if(s.name===t4.focus||"focus"===o){let r=a.hasState(t3.focus);a.toggleState(t3.focus),r?null===(e=this._itemsContainer)||void 0===e||e.getChildren().forEach(e=>{this._removeLegendItemState(e,[t3.unSelected,t3.unSelectedHover,t3.focus],t),this._setLegendItemState(e,t3.selected,t)}):(this._setLegendItemState(a,t3.selected,t),this._removeLegendItemState(a,[t3.unSelected,t3.unSelectedHover],t),null===(i=this._itemsContainer)||void 0===i||i.getChildren().forEach(e=>{a!==e&&(this._removeLegendItemState(e,[t3.selected,t3.selectedHover,t3.focus],t),this._setLegendItemState(e,t3.unSelected,t))}))}else{null===(r=this._itemsContainer)||void 0===r||r.getChildren().forEach(t=>{t.removeState(t3.focus)});let{allowAllCanceled:e=!0}=this.attribute,i=a.hasState(t3.selected),s=this._getSelectedLegends();if("multiple"===o){if(!1===e&&i&&1===s.length)return void this._dispatchLegendEvent(t5.legendItemClick,a,t);i?(this._removeLegendItemState(a,[t3.selected,t3.selectedHover],t),this._setLegendItemState(a,t3.unSelected,t)):(this._setLegendItemState(a,t3.selected,t),this._removeLegendItemState(a,[t3.unSelected,t3.unSelectedHover],t))}else this._setLegendItemState(a,t3.selected,t),this._removeLegendItemState(a,[t3.unSelected,t3.unSelectedHover],t),null===(n=this._itemsContainer)||void 0===n||n.getChildren().forEach(e=>{a!==e&&(this._removeLegendItemState(e,[t3.selected,t3.selectedHover],t),this._setLegendItemState(e,t3.unSelected,t))})}this._dispatchLegendEvent(t5.legendItemClick,a,t)}}}render(){super.render(),this._lastActiveItem=null}setSelected(t){var e;(null===(e=this._itemsContainer)||void 0===e?void 0:e.getChildren()).forEach(e=>{let i=e.data;t.includes(i.label)?(this._setLegendItemState(e,t3.selected),this._removeLegendItemState(e,[t3.unSelected,t3.unSelectedHover])):(this._removeLegendItemState(e,[t3.selected,t3.selectedHover]),this._setLegendItemState(e,t3.unSelected))})}_renderItems(){let{item:t={},maxCol:e=1,maxRow:i=2,maxWidth:r,maxHeight:n,defaultSelected:s,lazyload:a,autoPage:o}=this.attribute,{spaceCol:l=16,spaceRow:h=8}=t,u=this._itemsContainer,{items:d,isHorizontal:c,startIndex:p,isScrollbar:g}=this._itemContext,f=g?1:c?i:e,m,{doWrap:v,maxWidthInCol:y,startX:_,startY:b,pages:x}=this._itemContext,S=0;for(let t=p,e=d.length;t<e&&!(a&&x>this._itemContext.currentPage*f);t++){a&&(this._itemContext.startIndex=t+1),(m=d[t]).id||(m.id=m.label),m.index=t;let e=!0;eM(s)&&(e=s.includes(m.label));let i=this._renderEachItem(m,e,t,d),p=i.attribute.width,f=i.attribute.height;this._itemHeight=Math.max(this._itemHeight,f),y=Math.max(p,y),this._itemMaxWidth=Math.max(p,this._itemMaxWidth),c?(eO(r)&&(g&&o?v=(x=Math.ceil((_+p)/r))>1:_+p>r&&(v=!0,_>0&&(x+=1,_=0,b+=f+h))),0===_&&0===b||i.setAttributes({x:_,y:b}),_+=l+p):(eO(n)&&(g&&o?v=(x=Math.ceil((b+f)/n))>1:n<=f?(x+=1,v=!0,b=0,t>0&&(_+=S+l)):n<b+f&&(x+=1,v=!0,b=0,_+=y+l,y=0)),0===_&&0===b||i.setAttributes({x:_,y:b}),b+=h+f),u.add(i),S=p}return this._itemContext.doWrap=v,this._itemContext.startX=_,this._itemContext.startY=b,this._itemContext.maxWidthInCol=y,this._itemContext.pages=x,this._itemContext.maxPages=f,g&&(this._itemContext.totalPage=x),a||(this._itemContext.startIndex=d.length),this._itemContext}_renderContent(){let{item:t={},items:e,reversed:i,maxWidth:r}=this.attribute;if(!1===t.visible||mk(e))return;let n=e;i&&(n=null==e?void 0:e.reverse());let s=aj.group({x:0,y:0});this._itemsContainer=s;let{layout:a,autoPage:o}=this.attribute,{maxWidth:l,width:h,height:u}=t,d=[];eO(l)&&d.push(l),eO(h)&&d.push(h),d.length&&(eO(r)&&d.push(r),this._itemWidthByUser=o_(d)),eO(u)&&(this._itemHeightByUser=u);let c=this.attribute.pager;this._itemContext={currentPage:c&&c.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:n,isHorizontal:"horizontal"===a,totalPage:1/0,isScrollbar:c&&"scrollbar"===c.type},this._itemContext=this._renderItems();let p=!1;this._itemContext.doWrap&&o&&this._itemContext.pages>this._itemContext.maxPages&&(p=this._renderPagerComponent()),p||(s.setAttribute("y",this._title?this._title.AABBBounds.height()+dq(this.attribute,"title.space",8):0),this._innerView.add(s))}_bindEvents(){if(this.attribute.disableTriggerEvent||!this._itemsContainer)return;let{hover:t=!0,select:e=!0}=this.attribute;t&&(this._itemsContainer.addEventListener("pointermove",this._onHover),this._itemsContainer.addEventListener("pointerleave",this._onUnHover)),e&&this._itemsContainer.addEventListener("pointerdown",this._onClick)}_autoEllipsis(t,e,i,r){var n,s;let{label:a,value:o}=this.attribute.item,l=r.AABBBounds,h=i.AABBBounds,u=l.width(),d=h.width(),c=!1;"labelFirst"===t?d>e?c=!0:r.setAttribute("maxLineWidth",e-d):"valueFirst"===t?u>e?c=!0:i.setAttribute("maxLineWidth",e-u):u+d>e&&(c=!0),c&&(r.setAttribute("maxLineWidth",Math.max(e*(null!==(n=a.widthRatio)&&void 0!==n?n:.5),e-d)),i.setAttribute("maxLineWidth",Math.max(e*(null!==(s=o.widthRatio)&&void 0!==s?s:.5),e-u)))}_renderEachItem(t,e,i,r){var n,s;let a;let{id:o,label:l,value:h,shape:u}=t,{padding:d=0,focus:c,focusIconStyle:p,align:g,autoEllipsisStrategy:f}=this.attribute.item,{shape:m,label:v,value:y,background:_}=this.attribute.item,b=this._handleStyle(m,t,e,i,r),x=this._handleStyle(v,t,e,i,r),S=this._handleStyle(y,t,e,i,r),k=this._handleStyle(_,t,e,i,r),A=El(d);!1===_.visible?(a=aj.group({x:0,y:0,cursor:null===(n=k.style)||void 0===n?void 0:n.cursor}),this._appendDataToShape(a,t4.item,t,a)):(a=aj.group(Object.assign({x:0,y:0},k.style)),this._appendDataToShape(a,t4.item,t,a,k.state)),a.id=`${null!=o?o:l}-${i}`,a.addState(e?t3.selected:t3.unSelected);let w=aj.group({x:0,y:0,pickable:!1});a.add(w);let M,C=0,T=0,E=0;if(m&&!1!==m.visible){let i=dq(b,"style.size",10);T=eM(i)?i[0]||0:i,E=dq(m,"space",8);let r=aj.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},u),b.style));Object.keys(b.state||{}).forEach(t=>{let e=b.state[t].fill||b.state[t].stroke;u.fill&&ej(b.state[t].fill)&&e&&(b.state[t].fill=e),u.stroke&&ej(b.state[t].stroke)&&e&&(b.state[t].stroke=e)}),this._appendDataToShape(r,t4.itemShape,t,a,b.state),r.addState(e?t3.selected:t3.unSelected),w.add(r)}let O=0;if(c){let e=dq(p,"size",10);M=aj.symbol(Object.assign(Object.assign({x:0,y:-e/2-1,strokeBoundsBuffer:0},p),{visible:!0,pickMode:"imprecise",boundsPadding:A})),this._appendDataToShape(M,t4.focus,t,a),O=e}let P=v.formatMethod?v.formatMethod(l,t,i):l,R=MP(Object.assign(Object.assign({x:T/2+E,y:0,textAlign:"start",textBaseline:"middle",lineHeight:null===(s=x.style)||void 0===s?void 0:s.fontSize},x.style),{text:P,_originText:v.formatMethod?l:void 0}));this._appendDataToShape(R,t4.itemLabel,t,a,x.state),R.addState(e?t3.selected:t3.unSelected),w.add(R);let B=dq(v,"space",8);if(eO(h)){let r=dq(y,"space",c?8:0),n=y.formatMethod?y.formatMethod(h,t,i):h,s=MP(Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:S.style.fontSize},S.style),{text:n,_originText:y.formatMethod?h:void 0}));if(this._appendDataToShape(s,t4.itemValue,t,a,S.state),s.addState(e?t3.selected:t3.unSelected),this._itemWidthByUser){let t=this._itemWidthByUser-A[1]-A[3]-T-E-B-O-r;this._autoEllipsis(f,t,R,s),y.alignRight?s.setAttributes({textAlign:"right",x:this._itemWidthByUser-T/2-A[1]-A[3]-O-r}):s.setAttribute("x",r+(R.AABBBounds.empty()?0:R.AABBBounds.x2))}else s.setAttribute("x",r+(R.AABBBounds.empty()?0:R.AABBBounds.x2));C=r+(s.AABBBounds.empty()?0:s.AABBBounds.x2),w.add(s)}else this._itemWidthByUser&&R.setAttribute("maxLineWidth",this._itemWidthByUser-A[1]-A[3]-T-E-O),C=B+(R.AABBBounds.empty()?0:R.AABBBounds.x2);M&&(M.setAttribute("x",C),w.add(M));let I=w.AABBBounds,L=I.width();if("right"===g){let t=I.x2,e=I.x1;w.forEachChildren((i,r)=>{"symbol"!==i.type&&"right"!==i.attribute.textAlign||i===M?i.setAttribute("x",e+t-i.attribute.x-i.AABBBounds.width()):"symbol"!==i.type?i.setAttributes({x:e+t-i.attribute.x,textAlign:"left"}):i.setAttribute("x",e+t-i.attribute.x)})}let D=I.height(),F=eO(this.attribute.item.width)?this.attribute.item.width:L+A[1]+A[3],j=this._itemHeightByUser||D+A[0]+A[2];return a.attribute.width=F,a.attribute.height=j,M&&M.setAttribute("visible",!1),w.translateTo(-I.x1+A[3],-I.y1+A[0]),a}_createPager(t){var e,i;let{disableTriggerEvent:r,maxRow:n}=this.attribute;return new Ny(this._itemContext.isHorizontal?Object.assign(Object.assign({layout:1===n?"horizontal":"vertical",total:99},eF({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},t)),{defaultCurrent:null===(e=this.attribute.pager)||void 0===e?void 0:e.defaultCurrent,disableTriggerEvent:r}):Object.assign({layout:"horizontal",total:99,disableTriggerEvent:r,defaultCurrent:null===(i=this.attribute.pager)||void 0===i?void 0:i.defaultCurrent},t))}_createScrollbar(t,e){let{disableTriggerEvent:i}=this.attribute;return new NA(this._itemContext.isHorizontal?Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:i,range:[0,.5],height:12},t),{width:e}):Object.assign(Object.assign({direction:"vertical",width:12,range:[0,.5]},t),{height:e,disableTriggerEvent:i}))}_updatePositionOfPager(t,e,i,r,n){let{maxHeight:s,pager:a}=this.attribute,{totalPage:o,isHorizontal:l}=this._itemContext,h=a&&a.position||"middle";if(this._pagerComponent.setTotal(o),l){let e;e="start"===h?i:"end"===h?i+n-this._pagerComponent.AABBBounds.height()/2:i+n/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:t,y:e})}else{let t;t="start"===h?0:"end"===h?r-this._pagerComponent.AABBBounds.width():(r-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:t,y:s-this._pagerComponent.AABBBounds.height()})}}_updatePositionOfScrollbar(t,e,i){let{currentPage:r,totalPage:n,isHorizontal:s}=this._itemContext;this._pagerComponent.setScrollRange([(r-1)/n,r/n]),s?this._pagerComponent.setAttributes({x:0,y:i+e}):this._pagerComponent.setAttributes({x:t,y:i})}_bindEventsOfPager(t,e){let i=this.attribute.pager||{},{animation:r=!0,animationDuration:n=450,animationEasing:s="quadIn"}=i,a=this._itemContext.isScrollbar?t=>{let{value:e}=t.detail,r=e[0]*this._itemContext.totalPage;return i.scrollByPosition?r+=1:r=Math.floor(r)+1,r}:t=>t.detail.current,o=i=>{let o=a(i);if(o!==this._itemContext.currentPage){if(this._itemContext.currentPage=o,this._itemContext&&this._itemContext.startIndex<this._itemContext.items.length){this._renderItems();let t=Math.ceil(this._itemContext.pages/this._itemContext.maxPages);this._itemContext.totalPage=t,this._pagerComponent.setScrollRange([(o-1)/t,o/t])}r?this._itemsContainer.animate().to({[e]:-(o-1)*t},n,s):this._itemsContainer.setAttribute(e,-(o-1)*t)}};this._itemContext.isScrollbar?(this._pagerComponent.addEventListener("scrollDrag",o),this._pagerComponent.addEventListener("scrollUp",o)):(this._pagerComponent.addEventListener("toPrev",o),this._pagerComponent.addEventListener("toNext",o))}_renderPager(){let t=this._title?this._title.AABBBounds.height()+dq(this.attribute,"title.space",8):0,{maxWidth:e,maxHeight:i,maxCol:r=1,maxRow:n=2,item:s={},pager:a={}}=this.attribute,{spaceCol:o=16,spaceRow:l=8}=s,h=this._itemsContainer,{space:u=12,defaultCurrent:d=1}=a,c=Nw(a,["space","defaultCurrent"]),{isHorizontal:p}=this._itemContext,g,f=0,m=0,v=0,y=0,_=0,b=0,x=1;if(p){if(m=(n-1)*l+this._itemHeight*n,f=e,g=this._createPager(c),this._pagerComponent=g,this._innerView.add(g),(v=e-g.AABBBounds.width()-u)<=0)return this._innerView.removeChild(g),!1;h.getChildren().forEach((t,e)=>{let{width:i,height:r}=t.attribute;v<_+i&&(_=0,b+=r+l,x+=1),e>0&&t.setAttributes({x:_,y:b}),_+=o+i}),this._itemContext.startX=_,this._itemContext.startY=b,this._itemContext.pages=x;let i=Math.ceil(x/n);this._itemContext.totalPage=i,this._updatePositionOfPager(v,y,t,f,m)}else{if(f=this._itemMaxWidth*r+(r-1)*o,m=i,v=f,g=this._createPager(c),this._pagerComponent=g,this._innerView.add(g),(y=i-g.AABBBounds.height()-u-t)<=0)return this._innerView.removeChild(g),!1;h.getChildren().forEach((t,e)=>{let{height:i}=t.attribute;y<b+i&&(b=0,_+=this._itemMaxWidth+o,x+=1),e>0&&t.setAttributes({x:_,y:b}),b+=l+i});let e=Math.ceil(x/r);this._itemContext.totalPage=e,this._updatePositionOfPager(v,y,t,f,m)}d>1&&(p?h.setAttribute("y",-(d-1)*(m+l)):h.setAttribute("x",-(d-1)*(f+o)));let S=aj.group({x:0,y:t,width:p?v:f,height:p?m:y,clip:!0,pickable:!1});return S.add(h),this._innerView.add(S),this._bindEventsOfPager(p?m+l:f+o,p?"y":"x"),!0}_renderScrollbar(){let t=this._title?this._title.AABBBounds.height()+dq(this.attribute,"title.space",8):0,{maxWidth:e,maxHeight:i,item:r={},pager:n={}}=this.attribute,{spaceCol:s=16,spaceRow:a=8}=r,o=this._itemsContainer,{space:l=12,defaultCurrent:h=1}=n,u=Nw(n,["space","defaultCurrent"]),{isHorizontal:d}=this._itemContext,c,p=0,g=0,f=0,m=0,v=1;if(d)p=e,g=e,f=this._itemHeight,c=this._createScrollbar(u,p),this._pagerComponent=c,this._innerView.add(c),this._updatePositionOfScrollbar(g,f,t);else{if(p=i,c=this._createScrollbar(u,p),this._pagerComponent=c,this._innerView.add(c),f=i-t,g=this._itemMaxWidth,f<=0)return this._innerView.removeChild(c),!1;o.getChildren().forEach((t,e)=>{let{height:i}=t.attribute;v=Math.floor((m+i)/f)+1,m+=a+i}),this._itemContext.totalPage=v,this._itemContext.pages=v,this._updatePositionOfScrollbar(g,f,t)}h>1&&(d?o.setAttribute("x",-(h-1)*(g+s)):o.setAttribute("y",-(h-1)*(f+a)));let y=aj.group({x:0,y:t,width:g,height:f,clip:!0,pickable:!1});return y.add(o),this._innerView.add(y),this._bindEventsOfPager(d?g:f,d?"x":"y"),!0}_renderPagerComponent(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}_hover(t,e){this._lastActiveItem=t,t.hasState(t3.selected)?this._setLegendItemState(t,t3.selectedHover,e):this._setLegendItemState(t,t3.unSelectedHover,e);let i=t.getChildren()[0].find(t=>t.name===t4.focus,!1);i&&i.setAttribute("visible",!0),this._dispatchLegendEvent(t5.legendItemHover,t,e)}_unHover(t,e){let i=!1;(t.hasState(t3.unSelectedHover)||t.hasState(t3.selectedHover))&&(i=!0),t.removeState(t3.unSelectedHover),t.removeState(t3.selectedHover),t.getChildren()[0].getChildren().forEach(t=>{!i&&(t.hasState(t3.unSelectedHover)||t.hasState(t3.selectedHover))&&(i=!0),t.removeState(t3.unSelectedHover),t.removeState(t3.selectedHover)});let r=t.getChildren()[0].find(t=>t.name===t4.focus,!1);r&&r.setAttribute("visible",!1),i&&this._dispatchLegendEvent(t5.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(t5.legendItemUnHover,t,e)}_setLegendItemState(t,e,i){let r=!1;t.hasState(e)||(r=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach(t=>{t.name!==t4.focus&&(r||t.hasState(e)||(r=!0),t.addState(e,!0))}),r&&this._dispatchLegendEvent(t5.legendItemAttributeUpdate,t,i)}_removeLegendItemState(t,e,i){let r=!1;e.forEach(e=>{!r&&t.hasState(e)&&(r=!0),t.removeState(e)}),t.getChildren()[0].getChildren().forEach(t=>{t.name!==t4.focus&&e.forEach(e=>{!r&&t.hasState(e)&&(r=!0),t.removeState(e)})}),r&&this._dispatchLegendEvent(t5.legendItemAttributeUpdate,t,i)}_getSelectedLegends(){var t;let e=[];return null===(t=this._itemsContainer)||void 0===t||t.getChildren().forEach(t=>{t.hasState(t3.selected)&&e.push(t.data)}),e}_appendDataToShape(t,e,i,r,n={}){t.name=e,t.data=i,t.delegate=r,t.states=eF({},NM,n)}_dispatchLegendEvent(t,e,i){let r=this._getSelectedLegends();r.sort((t,e)=>t.index-e.index);let n=r.map(t=>t.label);this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(t3.selected),currentSelectedItems:r,currentSelected:n,event:i})}_handleStyle(t,e,i,r,n){let s={};return t.style&&(nx(t.style)?s.style=t.style(e,i,r,n):s.style=t.style),t.state&&(s.state={},Object.keys(t.state).forEach(a=>{t.state[a]&&(nx(t.state[a])?s.state[a]=t.state[a](e,i,r,n):s.state[a]=t.state[a])})),s}}NC.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:16,spaceRow:8,shape:{space:8,style:{size:10,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:8,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:10,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:12,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0};let NT=(t,e)=>{let i=[],r={},{series:n,seriesField:s}=e;return n().forEach(t=>{let e=s(t);(e===t.getSeriesField()?t.getSeriesInfoList():t.getSeriesInfoInField(e)).forEach(t=>{r[t.key]||(r[t.key]=!0,i.push(t))})}),i},NE=(t,e)=>{var i,r,n;let{series:s,selected:a,field:o,data:l}=e,h=a(),u=l();if(0===h.length&&u.length)return[];if(h.length===u.length)return t;let d={};h.forEach(t=>{d[t]=!0});let c=null!==(i=o())&&void 0!==i?i:bM;return eM(t)&&(null===(r=t[0])||void 0===r?void 0:r.nodes)?(t[0].nodes=t[0].nodes.filter(t=>!0===d[t.key]),(null===(n=t[0])||void 0===n?void 0:n.links)&&(t[0].links=t[0].links.filter(t=>!0===d[t.source]&&!0===d[t.target]))):eO(c)&&(t=t.filter(t=>!0===d[s.getSeriesFieldValue(t,c)])),t};class NO extends Ea{constructor(){super(...arguments),this.layoutType="normal",this.layoutZIndex=tM.Legend,this.layoutLevel=tC.Legend,this.specKey="legends",this._orient="left",this._visible=!0,this._position="middle",this._preSelectedData=[],this._selectedData=[],this.effect={onSelectedDataChange:()=>{dC(this._regions,t=>{var e;null===(e=t.getViewData())||void 0===e||e.markRunning()},{userId:this._seriesUserId,specIndex:this._seriesIndex}),dC(this._regions,t=>{t.reFilterViewData()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}}}get orient(){return this._orient}get visible(){return this._visible}get position(){return this._position}getLegendData(){return this._legendData.getLatestData()}getSelectedData(){return this._selectedData}setAttrFromSpec(){var t;super.setAttrFromSpec(),this._orient=l9(this._spec.orient)?this._spec.orient:"left",this._position=null!==(t=this._spec.position)&&void 0!==t?t:"middle",this._visible=!1!==this._spec.visible;let{regionId:e,regionIndex:i,seriesId:r,seriesIndex:n}=this._spec;eO(r)&&(this._seriesUserId=om(r)),eO(e)&&(this._regionUserId=om(e)),eO(n)&&(this._seriesIndex=om(n)),eO(i)&&(this._regionUserIndex=om(i)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionUserIndex)}created(){super.created(),this.initData()}onRender(t){}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reRender=!0,(null==t?void 0:t.orient)!==(null==e?void 0:e.orient)?i.reMake=!0:my(e,t)||(i.reCompile=!0),i}changeRegions(t){}_bindLegendDataChange(){this._preSelectedData=this._selectedData.slice(),this._initSelectedData()}initData(){let t=this._initLegendData();t.target.addListener("change",this._bindLegendDataChange.bind(this)),this._legendData=new Sa(this._option,t),this._initSelectedData(),dC(this._regions,t=>{t.event.on(c1.rawDataUpdate,{filter:({model:e})=>(null==e?void 0:e.id)===t.id},()=>{this._legendData.getDataView().reRunAllTransform()})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}setSelectedData(t){var e,i,r;let n=this._selectedData;ej(t)||JSON.stringify(n)===JSON.stringify(t)||(dC(this._regions,e=>{e.legendSelectedFilter&&(t=e.legendSelectedFilter(this,t))},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._selectedData=[...t],null===(i=(e=this.effect).onSelectedDataChange)||void 0===i||i.call(e),this.event.emit(c1.legendSelectedDataChange,{model:this}),null===(r=this._legendComponent)||void 0===r||r.setSelected(this._selectedData))}afterSetLayoutStartPoint(t){if(super.afterSetLayoutStartPoint(t),this._legendComponent){let{x:e,y:i}=t;l1(e*i)&&this._legendComponent.setAttributes({x:e,y:i})}}getBoundsInRect(t,e){if(!this._visible)return{x1:0,y1:0,x2:0,y2:0};let i={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},r=this._getLegendAttributes(t);if(r.disableTriggerEvent=this._option.disableTriggerEvent,this._legendComponent)my(r,this._cacheAttrs)||this._legendComponent.setAttributes(us({},r,{defaultSelected:this._selectedData}));else{let t=new(this._getLegendConstructor())(us({},r,{defaultSelected:this._selectedData}));t.name="legend",this._legendComponent=t,this.getContainer().add(t),this._option.disableTriggerEvent||this._initEvent(),t.on("*",(t,e)=>this._delegateEvent(this._legendComponent,t,e))}this._cacheAttrs=r;let n=isFinite(this._legendComponent.AABBBounds.width())?this._legendComponent.AABBBounds.width():0,s=isFinite(this._legendComponent.AABBBounds.height())?this._legendComponent.AABBBounds.height():0;if("normal-inline"!==this.layoutType){let t="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",i=this._position,{width:r,height:a}=e,o=0,l=0;"horizontal"===t?"middle"===i?o=(r-n)/2:"end"===i&&(o=r-n):"middle"===i?l=(a-s)/2:"end"===i&&(l=a-s),this._legendComponent.setAttributes({dx:o,dy:l})}return i.x2=i.x1+n,i.y2=i.y1+s,i}onDataUpdate(){var t,e,i;if(JSON.stringify(this._preSelectedData)!==JSON.stringify(this._selectedData)){if(this._legendComponent){let t=this._getLegendAttributes(this.getLayoutRect());my(t,this._cacheAttrs)||this._legendComponent.setAttributes(us({},t,{defaultSelected:this._selectedData}))}null===(e=(t=this.effect).onSelectedDataChange)||void 0===e||e.call(t),null===(i=this.getChart())||void 0===i||i.setLayoutTag(!0,null,!1),this.event.emit(c1.legendSelectedDataChange,{model:this})}}_getNeedClearVRenderComponents(){return[this._legendComponent]}clear(){super.clear(),this._cacheAttrs=null,this._preSelectedData=null}}NO.specKey="legends";class NP extends NO{constructor(){super(...arguments),this.type=lx.discreteLegend,this.name=lx.discreteLegend}static getSpecInfo(t){let e=t[this.specKey];if(!e)return;if(!eM(e))return e.type&&"discrete"!==e.type?void 0:[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.discreteLegend}];let i=[];return e.forEach((t,e)=>{t.type&&"discrete"!==t.type||i.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:lx.discreteLegend})}),i}init(t){super.init(t),dC(this._regions,t=>{t.addViewDataFilter({type:"discreteLegendFilter",options:{series:t,selected:()=>this._selectedData,field:()=>this._getSeriesLegendField(t),data:()=>this.getLegendDefaultData()},level:ty.legendFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_initLegendData(){gw(this._option.dataSet,"discreteLegendFilter",NE),gw(this._option.dataSet,"discreteLegendDataMake",NT);let t=new eH(this._option.dataSet,{name:`${this.type}_${this.id}_data`});return t.transform({type:"discreteLegendDataMake",options:{series:()=>{let t=[];return dC(this._regions,e=>{t.push(e)},{specIndex:this._spec.seriesIndex,userId:this._spec.seriesId}),t},seriesField:t=>this._getSeriesLegendField(t)}}),t}_getSeriesLegendField(t){var e,i,r;let n=t.getSeriesField(),s=null!==(e=this._spec.scaleName)&&void 0!==e?e:this._spec.scale;if(ej(s)||!t.getRawData())return n;let a=this._option.globalScale.getScaleSpec(s);if(!a)return n;if(this._spec.field)return this._spec.field;if(!l6(a.domain))return n;let o=a.domain.find(e=>e.dataId===t.getRawData().name);return o&&null!==(r=null===(i=o.fields)||void 0===i?void 0:i[0])&&void 0!==r?r:n}_initSelectedData(){let t=this.getLegendDefaultData();if(this._unselectedData){let e=[],i=[];t.forEach(t=>{this._unselectedData.includes(t)?i.push(t):e.push(t)}),this._selectedData=e,this._unselectedData=i}else this._spec.defaultSelected?this._selectedData=[...this._spec.defaultSelected]:this._selectedData=t}getLegendDefaultData(t){return nx(this._spec.data)?this._getLegendItems().map(t=>t.label):this._legendData.getLatestData().map(t?t=>t.originalKey:t=>t.key)}_addDefaultTitleText(t){var e,i,r,n;if((null===(e=t.title)||void 0===e?void 0:e.visible)&&ej(t.title.text)&&ej(null===(i=t.title.style)||void 0===i?void 0:i.text)){let e=null===(n=null===(r=this._regions)||void 0===r?void 0:r[0])||void 0===n?void 0:n.getSeries()[0];if(!e)return;t.title.text=CT(e.getRawData(),e.getSeriesField())}}_getLegendAttributes(t){let e=Object.assign(Object.assign({layout:"bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",items:this._getLegendItems(),zIndex:this.layoutZIndex},function(t,e){let{title:i={},item:r={},pager:n={},background:s={},type:a,id:o,visible:l,orient:h,position:u,data:d,filter:c,regionId:p,regionIndex:g,seriesIndex:f,seriesId:m,padding:v}=t,y=Ng(t,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible&&(y.title=Np(i)),mk(r.focusIconStyle)||Tz(r.focusIconStyle),r.shape&&(r.shape=TF(r.shape)),r.label&&(r.label=TF(r.label)),r.value&&(r.value=TF(r.value)),r.background&&(r.background=TF(r.background)),l7(r.maxWidth)&&(r.maxWidth=Number(r.maxWidth.substring(0,r.maxWidth.length-1))*e.width/100),l7(r.width)&&(r.width=Number(r.width.substring(0,r.width.length-1))*e.width/100),l7(r.height)&&(r.height=Number(r.height.substring(0,r.height.length-1))*e.width/100),y.item=r,"scrollbar"===n.type?(mk(n.railStyle)||Tz(n.railStyle),mk(n.sliderStyle)||Tz(n.sliderStyle)):(mk(n.textStyle)||Tz(n.textStyle),n.handler&&TF(n.handler)),y.pager=n,s.visible&&!mk(s.style)&&(us(y,s.style),eO(s.padding)&&(y.padding=s.padding)),y}(this._spec,t)),{maxWidth:t.width,maxHeight:t.height});return this._addDefaultTitleText(e),this._addLegendItemFormatMethods(e),e}_getLegendConstructor(){return NC}setSelectedData(t){t&&(this._unselectedData=this.getLegendDefaultData().filter(e=>!t.includes(e))),super.setSelectedData(t)}_initEvent(){if(this._legendComponent){let t=!1!==this._spec.filter;this._legendComponent.addEventListener(t5.legendItemClick,e=>{let i=dq(e,"detail.currentSelected");t&&this.setSelectedData(i),this.event.emit(c1.legendItemClick,{model:this,value:i,event:e})}),this._legendComponent.addEventListener(t5.legendItemHover,t=>{let e=dq(t,"detail");this.event.emit(c1.legendItemHover,{model:this,value:e,event:t})}),this._legendComponent.addEventListener(t5.legendItemUnHover,t=>{let e=dq(t,"detail");this.event.emit(c1.legendItemUnHover,{model:this,value:e,event:t})})}}_getLegendItems(){let t=(this._legendData.getLatestData()||[]).map(t=>{var e,i;let r=t.style("fillOpacity"),n=t.style("strokeOpacity"),s=t.style("opacity"),a=t.style("texture");return{label:t.key,shape:{symbolType:null!==(i=null!==(e=t.style("symbolType"))&&void 0!==e?e:t.shapeType)&&void 0!==i?i:"circle",fillOpacity:l1(r)?r:1,strokeOpacity:l1(n)?n:1,opacity:l1(s)?s:1,texturePadding:a?1:null,textureSize:a?4:null,texture:a,fill:t.style("fill"),stroke:t.style("stroke"),textureColor:t.style("textureColor"),innerBorder:t.style("innerBorder"),outerBorder:t.style("outerBorder"),lineDash:t.style("lineDash"),lineDashOffset:t.style("lineDashOffset"),lineWidth:t.style("lineWidth")}}});return nx(this._spec.data)?this._spec.data(t,this._option.globalScale.getScale("color"),this._option.globalScale):t}_addLegendItemFormatMethods(t){var e,i,r,n;let{formatMethod:s,formatter:a}=null!==(i=null===(e=this._spec.item)||void 0===e?void 0:e.label)&&void 0!==i?i:{},{formatMethod:o,formatter:l}=null!==(n=null===(r=this._spec.item)||void 0===r?void 0:r.value)&&void 0!==n?n:{},{formatFunc:h}=TV(s,a);a&&!s&&h&&(t.item.label.formatMethod=(t,e)=>h(t,e,a));let{formatFunc:u}=TV(o,l);l&&!o&&u&&(t.item.value.formatMethod=(t,e)=>u(l,t,e,a))}}NP.specKey="legends",NP.type=lx.discreteLegend;let NR=(t,e)=>{let{series:i,field:r,scale:n}=e,s=r();if(r&&s){let t=1/0,e=-Infinity;return i().forEach(i=>{let r=i.getRawDataStatisticsByField(s,!0),n=null==r?void 0:r.min,a=null==r?void 0:r.max;l1(n)&&(t=Math.min(n,t)),l1(a)&&(e=Math.max(a,e))}),[t,e]}if(n){let t=n();return t?t.domain():[]}return[]},NB=(t,e)=>{let{selected:i,field:r,data:n,isHierarchyData:s}=e,a=i(),o=r(),l=s||(t=>t&&t.some(t=>t&&function(t,e="value",i="children"){return!!nb(t)&&!!t.hasOwnProperty(i)&&Array.isArray(t[i])}(t)));if(a===n())return t;if(o&&!mk(a)){let[e,i]=a;return l(t)?function t(e,i,r,n="value",s="children"){return Array.isArray(e)?e.map(e=>{let a=Object.assign({},e);return Array.isArray(a[s])&&(a[s]=t(a[s],i,r,n,s)),a}).filter(t=>+t[n]>=i&&+t[n]<=r||t[s]&&t[s].length>0):e}(t,+e,+i):t.filter(t=>t[o]>=e&&t[o]<=i)}return t};function NI(t){return eM(t)?t:[t,t]}function NL(t){return t?"ew-resize":"ns-resize"}(tU=ee||(ee={})).innerView="innerView",tU.railContainer="sliderRailContainer",tU.rail="sliderRail",tU.startText="sliderStartText",tU.endText="sliderEndText",tU.startHandler="sliderStartHandler",tU.startHandlerText="startHandlerText",tU.endHandler="sliderEndHandler",tU.endHandlerText="sliderEndHandlerText",tU.track="sliderTrack",tU.trackContainer="sliderTrackContainer",N_();class ND extends Eu{get track(){return this._track}get currentValue(){return this._currentValue}get startHandler(){return this._startHandler}get endHandler(){return this._endHandler}get tooltipShape(){return this._tooltipShape}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},ND.defaultAttributes,t)),this.name="slider",this._isHorizontal=!0,this._startHandler=null,this._endHandler=null,this._startHandlerText=null,this._endHandlerText=null,this._currentHandler=null,this._currentValue={},this._onTooltipShow=t=>{this._isChanging||this._tooltipState&&this._tooltipState.isActive||(this._tooltipState?this._tooltipState.isActive=!0:this._tooltipState={isActive:!0},this._onTooltipUpdate(t),this._dispatchTooltipEvent("sliderTooltipShow"))},this._onTooltipUpdate=t=>{if(this._isChanging||!this._tooltipState||!this._tooltipState.isActive)return;let e=this._isHorizontal?this._rail.globalAABBBounds.width():this._rail.globalAABBBounds.height(),i=nL(this._isHorizontal?(t.viewX-this._rail.globalAABBBounds.x1)/e:(t.viewY-this._rail.globalAABBBounds.y1)/e,0,1);i!==this._tooltipState.pos&&(this._tooltipState.pos=i,this._tooltipState.value=this.calculateValueByPos(i*e),this._updateTooltip(),this._dispatchTooltipEvent("sliderTooltipUpdate"))},this._onTooltipHide=()=>{let{tooltip:t}=this.attribute;t&&t.alwaysShow||(this._tooltipState=null,this._tooltipShape&&this._tooltipShape.setAttribute("visible",!1),this._tooltipText&&this._tooltipText.setAttribute("visible",!1),this._dispatchTooltipEvent("sliderTooltipHide"))},this._onHandlerPointerdown=t=>{t.stopPropagation(),this._isChanging=!0;let{x:e,y:i}=this.stage.eventPointTransform(t);this._currentHandler=t.target,this._prePos=this._isHorizontal?e:i,"browser"===lX.env?(lX.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),lX.addEventListener("pointerup",this._onHandlerPointerUp)):(this.stage.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.stage.addEventListener("pointerup",this._onHandlerPointerUp),this.stage.addEventListener("pointerupoutside",this._onHandlerPointerUp))},this._onHandlerPointerMove=t=>{var e,i;t.stopPropagation(),this._isChanging=!0;let{railWidth:r,railHeight:n,min:s,max:a}=this.attribute;if(a===s)return;let{x:o,y:l}=this.stage.eventPointTransform(t),h,u,d,c=0;this._isHorizontal?(c=(h=o)-this._prePos,u=null===(i=this._currentHandler)||void 0===i?void 0:i.attribute.x,d=r):(c=(h=l)-this._prePos,u=null===(e=this._currentHandler)||void 0===e?void 0:e.attribute.y,d=n);let p=nL(u+c,0,d),g=this.calculateValueByPos(p);"text"===this._currentHandler.type?this._updateHandlerText(this._currentHandler,p,g):this._updateHandler(this._currentHandler,p,g),this._updateTrack(),this._prePos=h,this._dispatchChangeEvent()},this._onHandlerPointerUp=t=>{t.preventDefault(),this._isChanging=!1,this._currentHandler=null,"browser"===lX.env?(lX.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),lX.removeEventListener("pointerup",this._onHandlerPointerUp)):(this.stage.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.stage.removeEventListener("pointerup",this._onHandlerPointerUp),this.stage.removeEventListener("pointerupoutside",this._onHandlerPointerUp))},this._onTrackPointerdown=t=>{t.stopPropagation(),this._isChanging=!0;let{x:e,y:i}=this.stage.eventPointTransform(t);this._prePos=this._isHorizontal?e:i,"browser"===lX.env?(lX.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),lX.addEventListener("pointerup",this._onTrackPointerUp)):(this.stage.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),this.stage.addEventListener("pointerup",this._onTrackPointerUp),this.stage.addEventListener("pointerupoutside",this._onTrackPointerUp))},this._onTrackPointerMove=t=>{let e,i,r;t.stopPropagation(),this._isChanging=!0;let{railWidth:n,railHeight:s,min:a,max:o,inverse:l}=this.attribute;if(o===a)return;let{startHandler:h,endHandler:u}=this._getHandlers(),{x:d,y:c}=this.stage.eventPointTransform(t);this._isHorizontal?(e=d,i=this._track.attribute.width,r=n):(e=c,i=this._track.attribute.height,r=s);let p=e-this._prePos;if(h){let t=this._isHorizontal?h.attribute.x:h.attribute.y,e=l?nL(t+p,i,r):nL(t+p,0,r-i),n=this.calculateValueByPos(e);this._updateHandler(h,e,n)}if(u){let t=this._isHorizontal?u.attribute.x:u.attribute.y,e=l?nL(t+p,0,r-i):nL(t+p,i,r),n=this.calculateValueByPos(e),s=null==h?void 0:h.attribute;this._updateHandler(u,e,n),this._track.setAttributes(this._isHorizontal?{x:Math.min(s.x,u.attribute.x),width:Math.abs(s.x-u.attribute.x)}:{y:Math.min(s.y,u.attribute.y),height:Math.abs(s.y-u.attribute.y)})}this._prePos=e,this._dispatchChangeEvent()},this._onTrackPointerUp=t=>{t.preventDefault(),this._isChanging=!1,"browser"===lX.env?(lX.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),lX.removeEventListener("pointerup",this._onTrackPointerUp)):(this.stage.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),this.stage.removeEventListener("pointerup",this._onTrackPointerUp),this.stage.removeEventListener("pointerupoutside",this._onTrackPointerUp))},this._onRailPointerDown=t=>{let e,i,r;t.stopPropagation(),this._isChanging=!0;let{railWidth:n,railHeight:s,min:a,max:o}=this.attribute;if(o===a)return;let l=this._startHandler,h=this._endHandler;this._isHorizontal?(e=t.viewX-this._rail.globalAABBBounds.x1,i=null==l?void 0:l.attribute.x,r=null==h?void 0:h.attribute.x):(e=t.viewY-this._rail.globalAABBBounds.y1,i=null==l?void 0:l.attribute.y,r=null==h?void 0:h.attribute.y);let u=this.calculateValueByPos(e);if(eO(r)){let t=Math.abs(e-i)>Math.abs(e-r)?h:l;this._updateHandler(t,e,u)}else this._updateHandler(l,e,u);this._updateTrack(),this._dispatchChangeEvent()}}calculatePosByValue(t,e){let{layout:i,railWidth:r,railHeight:n,min:s,max:a,inverse:o}=this.attribute,l=0;return l=s===a?"start"===e?0:"end"===e?1:0:(t-s)/(a-s),(o?1-l:l)*("vertical"===i?n:r)}calculateValueByPos(t){let{layout:e,railWidth:i,railHeight:r,min:n,max:s,inverse:a}=this.attribute,o="vertical"===e?r:i;return n+(s-n)*(a?1-t/o:t/o)}setValue(t){let{min:e,max:i}=this.attribute;if(i===e)return;let[r,n]=om(t),{startHandler:s,endHandler:a}=this._getHandlers();s&&this._updateHandler(s,this.calculatePosByValue(r),r),a&&this._updateHandler(a,this.calculatePosByValue(n),n),this._updateTrack()}render(){var t,e;let i;this.removeAllChild(!0);let{layout:r="horizontal",railWidth:n,railHeight:s,startText:a,endText:o,min:l,max:h,showHandler:u=!0,showTooltip:d}=this.attribute,{value:c}=this.attribute;ej(c)&&(c=[l,h]),this._currentValue={startValue:NI(c)[0],endValue:NI(c)[1]};let p="horizontal"===r;this._isHorizontal=p;let g=aj.group({x:0,y:0});g.name=ee.innerView,this.add(g),this._innerView=g;let f,m=0;if(a&&a.visible){(f=aj.text(Object.assign({x:p?0:n/2,y:p?s/2:0,textAlign:p?"start":"center",textBaseline:p?"middle":"top",text:a.text,lineHeight:null===(t=a.style)||void 0===t?void 0:t.fontSize},a.style))).name=ee.startText,g.add(f);let e=eO(a.space)?a.space:0;m+=(p?f.AABBBounds.width():f.AABBBounds.height())+e}let v=aj.group({x:p?m:0,y:p?0:m});g.add(v);let y=aj.group({x:0,y:0});if(y.name=ee.railContainer,this._railContainer=y,v.add(y),this._mainContainer=v,this._renderRail(y),m+=p?n:s,o&&o.visible){let t=eO(o.space)?o.space:0;(i=aj.text(Object.assign({x:p?m+t:n/2,y:p?s/2:m+t,textAlign:p?"start":"center",textBaseline:p?"middle":"top",text:o.text,lineHeight:null===(e=o.style)||void 0===e?void 0:e.fontSize},o.style))).name=ee.endText,g.add(i)}this._renderTrack(y),u&&(this._renderHandlers(v),this._bindEvents()),d&&(this._renderTooltip(),this._bindTooltipEvents())}_renderRail(t){let{railWidth:e,railHeight:i,railStyle:r,slidable:n}=this.attribute,s="default";!1!==n&&(s="pointer");let a=aj.rect(Object.assign({x:0,y:0,width:e,height:i,cursor:s},r));return a.name=ee.rail,t.add(a),this._rail=a,a}_renderHandlers(t){let{range:e,min:i,max:r,handlerSize:n=14,handlerStyle:s,handlerText:a,railHeight:o,railWidth:l,slidable:h}=this.attribute,{value:u}=this.attribute;ej(u)&&(u=[i,r]);let d=a&&a.visible,c=this._isHorizontal,[p,g]=NI(u),f=this.calculatePosByValue(p,e?"start":"end"),m=this._renderHandler(Object.assign({x:c?f:l/2,y:c?o/2:f,size:n,strokeBoundsBuffer:0,cursor:!1===h?"default":NL(c)},s));if(m.name=ee.startHandler,this._startHandler=m,t.add(m),this._currentValue.startPos=f,d){let i=this._renderHandlerText(p,e?"start":"end");i.name=ee.startHandlerText,t.add(i),this._startHandlerText=i}if(e){let e=this.calculatePosByValue(g,"end"),i=this._renderHandler(Object.assign({x:c?e:l/2,y:c?o/2:e,size:n,strokeBoundsBuffer:0,cursor:!1===h?"default":NL(c)},s));if(i.name=ee.endHandler,this._endHandler=i,t.add(i),this._currentValue.endPos=e,d){let e=this._renderHandlerText(g,"end");e.name=ee.endHandlerText,t.add(e),this._endHandlerText=e}}}_renderTrack(t){let e,i,r;let{range:n,min:s,max:a,railHeight:o,railWidth:l,trackStyle:h,railStyle:u,slidable:d,value:c}=this.attribute;if(ej(c))n?(e=s,i=a):e=i=s;else if(n){let t=NS(c,s,a);e=t[0],i=t[1]}else e=s,i=nL(c,s,a);let p=this._isHorizontal;n||(e=s);let g=aj.group({x:0,y:0,width:l,height:o,cornerRadius:null==u?void 0:u.cornerRadius,clip:!0,pickable:!1});g.name=ee.trackContainer;let f=nb(n)&&!0===n.draggableTrack;r=!1===d?"default":!1===n||!1===f?"pointer":NL(p);let m=this.calculatePosByValue(e,"start"),v=this.calculatePosByValue(i,n?"end":"start"),y=aj.rect(Object.assign({x:p?Math.min(m,v):0,y:p?0:Math.min(m,v),width:p?Math.abs(v-m):l,height:p?o:Math.abs(v-m),cursor:r},h));y.name=ee.track,this._track=y,g.add(y),t.add(g)}_renderHandler(t){return aj.symbol(t)}_renderHandlerText(t,e){var i,r,n;let{align:s,handlerSize:a=14,handlerText:o={},railHeight:l,railWidth:h,slidable:u}=this.attribute,d=this._isHorizontal,c=this.calculatePosByValue(t,e),p=null!==(i=o.space)&&void 0!==i?i:4,g={text:o.formatter?o.formatter(t):t.toFixed(null!==(r=o.precision)&&void 0!==r?r:0),lineHeight:null===(n=o.style)||void 0===n?void 0:n.lineHeight,cursor:!1===u?"default":NL(d)};return d?"top"===s?(g.textBaseline="bottom",g.textAlign="center",g.x=c,g.y=(l-a)/2-p):(g.textBaseline="top",g.textAlign="center",g.x=c,g.y=(l+a)/2+p):("left"===s?(g.textBaseline="middle",g.textAlign="end",g.x=(h-a)/2-p):(g.textBaseline="middle",g.textAlign="start",g.x=(h+a)/2+p),g.y=c),aj.text(Object.assign(Object.assign({},g),o.style))}_renderTooltip(){var t;let{tooltip:e,railHeight:i,railWidth:r,align:n}=this.attribute;e&&e.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;let s=this._isHorizontal?0:r/2,a=this._isHorizontal?i/2:0;if(e&&e.shape){let t=aj.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:s,y:a,symbolType:"circle"},e.shapeStyle));this._tooltipShape=t,this._mainContainer.add(t)}let o=e&&e.text||{},l=null!==(t=o.space)&&void 0!==t?t:6,h={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(h.x=s,h.y="top"===n?a-i/2-l:a+i/2+l,h.textAlign="center",h.textBaseline="top"===n?"bottom":"top"):(h.y=a,h.x="left"===n?s-r/2-l:a+r/2+l,h.textAlign="left"===n?"end":"start",h.textBaseline="middle");let u=aj.text(Object.assign(Object.assign({},h),o.style));this._mainContainer.add(u),this._tooltipText=u,this._tooltipState&&this._updateTooltip()}_updateTooltip(){var t,e;if(!this._tooltipShape&&!this._tooltipText||!this._tooltipState)return;let{railWidth:i,railHeight:r}=this.attribute,n=this._isHorizontal?i:r,s=this._tooltipState.pos*n,a=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes({visible:!0,[a]:s});let{align:o}=this.attribute;if(this._tooltipText){let i=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes({visible:!0,[a]:s,text:i.formatter?i.formatter(this._tooltipState.value):this._isHorizontal||"left"!==o?`\u{2248} ${this._tooltipState.value.toFixed(null!==(e=i.precision)&&void 0!==e?e:0)}`:`${this._tooltipState.value.toFixed(null!==(t=i.precision)&&void 0!==t?t:0)} \u{2248}`})}}_bindEvents(){if(this.attribute.disableTriggerEvent)return;let{slidable:t,range:e}=this.attribute;t&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),nb(e)&&e.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown))}_bindTooltipEvents(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}_updateTrack(){let{inverse:t,railWidth:e,railHeight:i}=this.attribute,r=this._startHandler,n=this._endHandler;if(this._isHorizontal){let i=null==r?void 0:r.attribute.x;if(n){let t=null==n?void 0:n.attribute.x;this._track.setAttributes({x:Math.min(i,t),width:Math.abs(i-t)})}else t?this._track.setAttributes({x:i,width:e-i}):this._track.setAttributes({width:i})}else{let e=null==r?void 0:r.attribute.y;if(n){let t=null==n?void 0:n.attribute.y;this._track.setAttributes({y:Math.min(e,t),height:Math.abs(e-t)})}else t?this._track.setAttributes({y:e,height:i-e}):this._track.setAttributes({height:e})}}_updateHandler(t,e,i){var r;let n=this._isHorizontal;t.setAttribute(n?"x":"y",e);let s=t.name===ee.startHandler?this._startHandlerText:this._endHandlerText;if(s){let{handlerText:t={}}=this.attribute;s.setAttributes({text:t.formatter?t.formatter(i):i.toFixed(null!==(r=t.precision)&&void 0!==r?r:0),[n?"x":"y"]:e})}t.name===ee.startHandler?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_updateHandlerText(t,e,i){var r;let n=this._isHorizontal,{handlerText:s={}}=this.attribute;t.setAttributes({[n?"x":"y"]:e,text:s.formatter?s.formatter(i):i.toFixed(null!==(r=s.precision)&&void 0!==r?r:0)});let a=t.name===ee.startHandlerText?this._startHandler:this._endHandler;a&&a.setAttributes({[n?"x":"y"]:e}),t.name===ee.startHandlerText?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_dispatchChangeEvent(){let t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}_dispatchTooltipEvent(t){this._dispatchEvent("sliderTooltip",{type:t,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}_getHandlers(){let{inverse:t}=this.attribute,e=this._startHandler,i=this._endHandler;return i&&(this._isHorizontal?(!t&&i.attribute.x<(null==e?void 0:e.attribute.x)||t&&i.attribute.x>(null==e?void 0:e.attribute.x))&&([e,i]=[i,e]):(!t&&i.attribute.y<(null==e?void 0:e.attribute.y)||t&&i.attribute.y>(null==e?void 0:e.attribute.y))&&([e,i]=[i,e])),{startHandler:e,endHandler:i}}}ND.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}},Nx(),N_();class NF extends Nf{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},NF.defaultAttributes,t)),this.name="colorLegend",this._onSliderToolipChange=t=>{let e=this._slider.tooltipShape;if(e&&t.detail&&!ej(t.detail.value)){let i=this._colorScale.scale(t.detail.value);e.setAttribute("fill",i)}this.dispatchEvent(t)},this._onSliderChange=t=>{this._updateColor(),this.dispatchEvent(t)}}setSelected(t){this._slider&&(this._slider.setValue(t),this._updateColor())}_renderContent(){let{colors:t,slidable:e,layout:i,align:r,min:n,max:s,value:a,railWidth:o,railHeight:l,showHandler:h=!0,handlerSize:u,handlerStyle:d,railStyle:c,trackStyle:p,startText:g,endText:f,handlerText:m,showTooltip:v,tooltip:y,inverse:_,disableTriggerEvent:b}=this.attribute,x=[],S=(s-n)/(t.length-1);for(let e=0;e<t.length;e++)x.push(n+S*e);this._colorScale=(new x1).domain(x,!0).range(t),this._color=this._getTrackColor();let k=new ND({x:0,y:0,range:{draggableTrack:!0},slidable:e,layout:i,align:r,min:n,max:s,value:a,railWidth:o,railHeight:l,showHandler:h,handlerSize:u,handlerStyle:d,railStyle:c,trackStyle:Object.assign({fill:this._color},p),startText:g,endText:f,handlerText:m,showTooltip:v,tooltip:y,disableTriggerEvent:b,inverse:_});this._innerView.add(k),this._slider=k,k.translateTo(0-k.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+dq(this.attribute,"title.space",12):0)-k.AABBBounds.y1),this._updateColor()}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}_getTrackColor(){let{colors:t,layout:e,inverse:i}=this.attribute;if(mk(t))return;let r=t.length;if(1===r)return t[0];let n=[];for(let e=0;e<r;e++){let i=e/(r-1);n.push({offset:i,color:t[e]})}let s="horizontal"===e,a={gradient:"linear",stops:n,x0:0,y0:0,x1:s?1:0,y1:s?0:1};return i&&(s?(a.x0=1,a.x1=0):(a.y0=1,a.y1=0)),a}_updateColor(){var t;let{layout:e="horizontal",colors:i,railWidth:r,railHeight:n}=this.attribute,{startHandler:s,endHandler:a,track:o,attribute:l}=this._slider,{startValue:h,endValue:u,startPos:d,endPos:c}=this._slider.currentValue,p=null===(t=l.handlerStyle)||void 0===t?void 0:t.fill;if(s&&!p){let t=this._colorScale.scale(h);s.setAttribute("fill",t)}if(a&&!p){let t=this._colorScale.scale(u);a.setAttribute("fill",t)}let g="horizontal"===e?r:n;if(Math.abs(d-c)!==g&&i&&i.length>1){let t=this._color.stops,e=Math.min(d,c)/g,i=Math.max(d,c)/g,r=i-e,n=t.filter(t=>t.offset>e&&t.offset<i),s=Math.min(h,u),a=Math.max(h,u),l=this._colorScale.scale(s),p=this._colorScale.scale(a),f=[{offset:0,color:l}];n.forEach(t=>{f.push({offset:(t.offset-e)/r,color:t.color})}),f.push({offset:1,color:p}),o.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:f}))}}}NF.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}};Nx(),N_(),kU();class Nj extends Nf{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},Nj.defaultAttributes,t)),this.name="sizeLegend",this._onSliderChange=t=>{this.dispatchEvent(t)},this._onSliderToolipChange=t=>{this.dispatchEvent(t)}}setSelected(t){this._slider&&this._slider.setValue(t)}_renderContent(){let{slidable:t,layout:e,align:i,min:r,max:n,value:s,railWidth:a,railHeight:o,showHandler:l=!0,handlerSize:h,handlerStyle:u,railStyle:d,trackStyle:c,startText:p,endText:g,handlerText:f,showTooltip:m,tooltip:v,sizeBackground:y,disableTriggerEvent:_,inverse:b}=this.attribute,x=aj.group({x:0,y:0});this._innerView.add(x);let S=new ND({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:t,layout:e,align:i,min:r,max:n,value:s,railWidth:a,railHeight:o,showHandler:l,handlerSize:h,handlerStyle:Object.assign({symbolType:function(t="bottom"){let e=0;return"top"===t?`
    M${e},-6L${e-3.5},-2.5
    v5
    h7
    v-5
    Z
`:"left"===t?(e=1,`
    M${e-6},0L${e-6+2.5},-3.5
    h5
    v7
    h-5
    Z
`):"right"===t?(e=-1,`
    M${e+6},0L${e+6-2.5},-3.5
    h-5
    v7
    h5
    Z
  `):`
    M${e},6L${e-3.5},2.5
    v-5
    h7
    v5
    Z
`}(i)},u),railStyle:d,trackStyle:c,startText:p,endText:g,handlerText:f,showTooltip:m,tooltip:v,disableTriggerEvent:_,inverse:b});x.add(S);let k,A=0;"horizontal"===e?"top"===i?(k=`M0,0L${a},0L${b?0:a},12Z`,A=o):(k=`M0,12L${a},12L${b?0:a},0Z`,S.setAttribute("y",12)):"left"===i?k=`M${a},0L${a+12},${b?0:o}L${a},${o}Z`:(k=`M0,${b?0:o}L12,${o}L12,0Z`,S.setAttribute("x",12));let w=aj.path(Object.assign(Object.assign({x:0,y:A,path:k},y),{zIndex:0}));x.add(w);let M=this._title?this._title.AABBBounds.height()+dq(this.attribute,"title.space",12):0;x.translate(0-x.AABBBounds.x1,M-x.AABBBounds.y1),this._slider=S}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}Nj.defaultAttributes={layout:"horizontal",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}};var NN=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};function Nz(t){return"color"===t||"size"===t}let NH={color:NF,size:Nj},NV=["#C4E7FF","#98CAFF","#75ACFF","#518FF9","#2775DC","#005CBE","#00429F","#00287E"],NW=[2,10];class NG extends NO{static getSpecInfo(t){let e=t[this.specKey];if(!e)return;if(!eM(e))return Nz(e.type)?[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:"color"===e.type?lx.colorLegend:lx.sizeLegend}]:void 0;let i=[];return e.forEach((t,e)=>{Nz(t.type)&&i.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:"color"===t.type?lx.colorLegend:lx.sizeLegend})}),i}constructor(t,e){super(t,e),this.type=lx.colorLegend,this.name=lx.colorLegend;let i="color"===this._spec.type?lx.colorLegend:lx.sizeLegend;this.type=i,this.name=i}setAttrFromSpec(){super.setAttrFromSpec(),this._field=this._spec.field,this._legendType=this._spec.type}init(t){super.init(t),dC(this._regions,t=>{t.addViewDataFilter({type:"continuousLegendFilter",options:{selected:()=>this._selectedData,field:()=>this._field,data:()=>this._legendData.getLatestData(),isHierarchyData:t.isHierarchyData},level:ty.legendFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_getScaleInGlobal(){let t=this._option.globalScale,e=this._spec.scale;return e||(e=this._legendType),t.getScale(e)}_initLegendData(){gw(this._option.dataSet,"continuousLegendFilter",NB),gw(this._option.dataSet,"continuousLegendDataMake",NR);let t=new eH(this._option.dataSet,{name:`${this.type}_${this.id}_data`});return t.transform({type:"continuousLegendDataMake",options:{series:()=>dT(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}),field:()=>this._field,scale:this._getScaleInGlobal.bind(this)}}),t}_initSelectedData(){this._spec.defaultSelected?this._selectedData=this._spec.defaultSelected.slice():this._selectedData=this._legendData.getLatestData()}_addDefaultTitleText(t){var e,i,r,n;if((null===(e=t.title)||void 0===e?void 0:e.visible)&&ej(t.title.text)&&ej(null===(i=t.title.style)||void 0===i?void 0:i.text)){let e=this._field;if(e){let i=null===(n=null===(r=this._regions)||void 0===r?void 0:r[0])||void 0===n?void 0:n.getSeries()[0];if(!i)return;return void(t.title.text=CT(i.getRawData(),e))}let i=this._spec.scale;i||(i=this._legendType);let s=this._option.globalScale.getScaleSpec(i);if(!l6(null==s?void 0:s.domain))return;let a=s.domain[0];if(0===a.fields.length)return;t.title.text=CT(this._option.dataSet.getDataView(a.dataId),a.fields[0])}}_getLegendAttributes(t){var e,i;let r="bottom"===this.layoutOrient||"top"===this.layoutOrient?"horizontal":"vertical",n="horizontal"===r?"bottom":this.layoutOrient,s=[],a=this._getScaleInGlobal();a&&"linear"===a.type&&(s=a.range()),mk(s)&&(s="color"===this._legendType?NV:NW);let o=null!==(e=this._legendData.getLatestData()[0])&&void 0!==e?e:0,l=null!==(i=this._legendData.getLatestData()[1])&&void 0!==i?i:1;this._legendData.getLatestData()[0]===this._legendData.getLatestData()[1]&&(o=Math.min(0,this._legendData.getLatestData()[0]),l=0===this._legendData.getLatestData()[0]?1:Math.max(0,this._legendData.getLatestData()[0]));let h=Object.assign({layout:r,align:n,zIndex:this.layoutZIndex,min:o,max:l,value:this._spec.defaultSelected,["color"===this._legendType?"colors":"sizeRange"]:s},function(t){let e=us({},t),{title:i={},handler:r={},rail:n={},track:s={},startText:a,endText:o,handlerText:l,sizeBackground:h,background:u={},type:d,id:c,visible:p,orient:g,position:f,data:m,defaultSelected:v,field:y,filter:_,regionId:b,regionIndex:x,seriesIndex:S,seriesId:k,padding:A}=e,w=NN(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible&&(w.title=Np(i)),w.showHandler=!1!==r.visible,mk(r.style)||(w.handlerStyle=Tz(r.style)),eO(n.width)&&(w.railWidth=n.width),eO(n.height)&&(w.railHeight=n.height),mk(n.style)||(w.railStyle=Tz(n.style)),mk(s.style)||(w.trackStyle=Tz(s.style)),w.startText=TF(a),w.endText=TF(o),w.handlerText=TF(l),mk(h)||(w.sizeBackground=Tz(h)),u.visible&&!mk(u.style)&&(us(w,u.style),eO(u.padding)&&(w.padding=u.padding)),w}(this._spec));return this._addDefaultTitleText(h),h}_getLegendConstructor(){return NH[this._legendType]}_initEvent(){if(this._legendComponent){let t=!1!==this._spec.filter;this._legendComponent.addEventListener("change",l3(e=>{let i=dq(e,"detail.value");t&&this.setSelectedData(i),this.event.emit(c1.legendFilter,{model:this,value:i,event:e})},30))}}}NG.specKey="legends",NG.type=lx.continuousLegend;let NU=(t,e)=>eO(e)?t.map(t=>e[t]):void 0,N$=(t,e)=>i=>t.every((t,r)=>i[t]===(null==e?void 0:e[r])),NY=t=>!ej(t)&&(eM(t)?t.length>0&&t.every(eO):Object.keys(t).length>0),NK=(t,e)=>{let i=e.getSeries(),r=[];return i.forEach(e=>{var i,n,s,a,o,l,h;let u=e.getDimensionField(),d=e.getMeasureField(),c=e.getSeriesField(),p=eO(c)?t[c]:void 0,g=eO(c)&&null!==(a=null===(s=null===(n=null===(i=e.getViewDataStatistics)||void 0===i?void 0:i.call(e))||void 0===n?void 0:n.latestData[c])||void 0===s?void 0:s.values)&&void 0!==a?a:[],f=NU(u,t),m=NU(d,t),v=NY(m),y=!v&&eO(c)&&ej(p)&&g.length>0,_=()=>{var t;let i=null===(t=e.getViewData())||void 0===t?void 0:t.latestData.find(N$(u,f));if(!v&&!NY(m=NU(d,i)))return;let n=e.type===cZ.pie?e.dataToCentralPosition(i):e.dataToPosition(i);ej(n)||isNaN(n.x)||isNaN(n.y)||r.push({pos:n,data:{dimensionFields:u,dimensionData:f,measureFields:d,measureData:m,hasMeasureData:v,groupField:c,groupData:p},series:e})};if("cartesian"===e.coordinate){let t=ds(null===(l=null===(o=e.getYAxisHelper())||void 0===o?void 0:o.getScale(0))||void 0===l?void 0:l.type)?"y":"x",i=u.map((t,e)=>[t,e]).filter(([,t])=>ej(null==f?void 0:f[t])),n=[null!=f?f:[]];i.length>0&&i.forEach(([t,i])=>{var r,s,a,o;let l=null!==(o=null===(a=null===(s=null===(r=e.getViewDataStatistics)||void 0===r?void 0:r.call(e))||void 0===s?void 0:s.latestData[t])||void 0===a?void 0:a.values)&&void 0!==o?o:[],h=[];n.forEach(t=>{l.forEach(e=>{var r;let n=null!==(r=null==t?void 0:t.slice())&&void 0!==r?r:[];n[i]=e,h.push(n)})}),n=h}),n.forEach(i=>{var n,s;if(y){let s=null===(n=e.getViewData())||void 0===n?void 0:n.latestData.filter(N$(u,i));g.forEach(n=>{let a=s.find(t=>t[c]===n);if(!NY(m=NU(d,a)))return;let o=e.dataToPosition(a);ej(o)||isNaN(o.x)||isNaN(o.y)||r.push({pos:o,data:{dimensionFields:u,dimensionData:i,measureFields:d,measureData:m,hasMeasureData:v,groupField:c,groupData:n},series:e,dimType:t})})}else{let n=null===(s=e.getViewData())||void 0===s?void 0:s.latestData.find(N$(u,i));if(!v&&!NY(m=NU(d,n)))return;let a=e.dataToPosition(n);if(ej(a)||isNaN(a.x)||isNaN(a.y))return;r.push({pos:a,data:{dimensionFields:u,dimensionData:i,measureFields:d,measureData:m,hasMeasureData:v,groupField:c,groupData:p},dimType:t,series:e})}})}else if("polar"===e.coordinate){if(e.type===cZ.pie)_();else if(y){let t=(null===(h=e.getViewData())||void 0===h?void 0:h.latestData.filter(N$(u,f))).find(t=>t[c]===p);g.forEach(i=>{if(!NY(m=NU(d,t)))return;let n=e.dataToPosition(t);ej(n)||isNaN(n.x)||isNaN(n.y)||r.push({pos:n,data:{dimensionFields:u,dimensionData:f,measureFields:d,measureData:m,hasMeasureData:v,groupField:c,groupData:i},series:e})})}else _()}else"geo"===e.coordinate&&_()}),r},NZ=(t,e,i)=>{var r,n;return null!==(n=null===(r=t.tooltipHelper)||void 0===r?void 0:r.getDefaultTooltipPattern(e,i))&&void 0!==n?n:null},NX=(t,e,i,r)=>{var n,s,a,o,l,h,u;let d=Object.assign(Object.assign({},e),{activeType:t}),{style:c={}}=e;switch(t){case"mark":case"group":if(i){let r=null!==(s=null===(n=i.tooltipHelper)||void 0===n?void 0:n.spec)&&void 0!==s?s:{};if(eO(r.visible)||eO(r.activeType)?d.visible=CR(r).includes(t):eO(e.visible)||eO(e.activeType)?d.visible=CR(e).includes(t):d.visible=!0,d.handler=null!==(o=null!==(a=r.handler)&&void 0!==a?a:e.handler)&&void 0!==o?o:void 0,null===(l=d.handler)||void 0===l?void 0:l.showTooltip)return d}break;case"dimension":if((null==r?void 0:r.length)&&(NQ(r).every(t=>{var e;return!CR(null===(e=t.tooltipHelper)||void 0===e?void 0:e.spec).includes("dimension")})?d.visible=!1:eO(e.visible)||eO(e.activeType)?d.visible=CR(e).includes("dimension"):d.visible=!0,d.handler=null!==(h=e.handler)&&void 0!==h?h:void 0,null===(u=d.handler)||void 0===u?void 0:u.showTooltip))return d}let p=Nq(t,i,r),g=NJ(t,i,r),f=us({},eP(e[t]),g),m=p.title,v=N1(void 0,f,c.shape,void 0,m);eO(f.title)?f.title=CL(f.title,Object.assign(Object.assign({},m),v)):f.title=CL(m,v,!0);let y=om(p.content);if(eO(f.content)){let t=N0(y);f.content=CD(f.content,e=>N1(e,f,c.shape,t))}else f.content=CD(y,t=>N1(void 0,f,c.shape,void 0,t),!0);return d[t]=Object.assign(Object.assign(Object.assign({},p),f),{activeType:t}),d},Nq=(t,e,i)=>{var r;let n={};switch(t){case"mark":case"group":e&&(n=null!==(r=NZ(e,t))&&void 0!==r?r:{});break;case"dimension":if(null==i?void 0:i.length){let t=[];i.forEach(({data:e})=>e.forEach(e=>{let{series:r}=e,n=NZ(r,"dimension",[Object.assign(Object.assign({},i[0]),{data:[e]})]);n&&t.push(n)}));let e=[];t.forEach(({content:t})=>{nx(t)?e.push(t):e.push(...om(t))}),n=Object.assign(Object.assign({},t[0]),{content:e})}}return n},NJ=(t,e,i)=>{var r,n;let s={};switch(t){case"mark":case"group":if(e){let i=null!==(n=null===(r=e.tooltipHelper)||void 0===r?void 0:r.spec)&&void 0!==n?n:{};s=i[t]?eP(i[t]):{}}break;case"dimension":if(null==i?void 0:i.length){let t=NQ(i).filter(t=>{var e;let i=null===(e=t.tooltipHelper)||void 0===e?void 0:e.spec;return eO(null==i?void 0:i.dimension)&&CR(i).includes("dimension")}).map(t=>t.tooltipHelper.spec.dimension);if(t.length){let e=[];t.every(({content:t})=>ej(t))?e=void 0:t.forEach(({content:t})=>{ej(t)||(nx(t)?null==e||e.push(t):null==e||e.push(...om(t)))}),s=Object.assign(Object.assign({},t[0]),{content:e})}}}return s},NQ=xe(t=>t.reduce((t,e)=>t.concat(e.data.map(t=>t.series).filter(eO)),[])),N0=t=>{let e={};return t.forEach(t=>{var i;let r=null!==(i=t.seriesId)&&void 0!==i?i:0;e[r]||(e[r]=t)}),e},N1=(t,e,i,r,n)=>{var s,a,o;i&&(i.shapeSize=null!==(s=i.shapeSize)&&void 0!==s?s:i.size);let l=[t,e,i,null!==(o=null==r?void 0:r[null!==(a=null==t?void 0:t.seriesId)&&void 0!==a?a:0])&&void 0!==o?o:null==r?void 0:r[0],n].filter(eO),h=new Set(l.reduce((t,e)=>t.concat(Object.keys(e)),[]).filter(t=>t.toLowerCase().includes("shape"))),u={};return h.forEach(t=>{let e,i=0;do e=l[i++][t];while(i<l.length&&ej(e));void 0!==e&&(u[t]=e)}),u},N2=(t,e,i,r)=>{let n;if(n=nx(t)?t(e,i):t,r){let{formatFunc:i,args:s}=TV(void 0,r,t,e);i&&s&&(n=i(...s))}return n},N3=(t,e,i)=>ej(t)?t:nx(t)?t(e,i):t,N5=(t,e,i)=>{if(ej(t))return t;let r=[];return om(t).forEach(t=>{nx(t)?r=r.concat(om(t(e,i))):r.push(t)}),r};class N4{}N4.dom=`${hA}_TOOLTIP_HANDLER_DOM`,N4.canvas=`${hA}_TOOLTIP_HANDLER_CANVAS`;let N8={key:"\u5176\u4ED6",value:"..."},N6=(t,e,i)=>{if(!e&&!i)return"object"!=typeof t?null==t?void 0:t.toString():t;let r=Bq.getInstance();return e=e||"%Y%m%d",("local"===(i=i||"local")?r.timeFormat:r.timeUTCFormat)(e,t)},N9=(t,e,i)=>{var r,n,s,a;if(!e||"mouseout"===(null===(r=null==i?void 0:i.event)||void 0===r?void 0:r.type))return null;let o={title:{},content:[]},l=N3(t.title,e,i),{visible:h,value:u,valueTimeFormat:d,valueTimeFormatMode:c,valueStyle:p,hasShape:g,valueFormatter:f}=null!=l?l:{},m=!1!==N2(h,e,i);if(l&&m){let t=function(t){var e;for(let{data:i}of(null===(e=t[0])||void 0===e?void 0:e.series)?[{data:t,value:""}]:t)for(let{datum:t}of i)for(let e of null!=t?t:[])if(e)return e}(e);o.title={value:N6(N2(u,t,i,f),d,c),valueStyle:N2(p,t,i),hasShape:g}}else o.title={hasShape:!1,visible:!1};let v=N5(t.content,e,i),{maxLineCount:y=20}=t,_=t.othersLine?Object.assign(Object.assign({},N8),t.othersLine):N8,b=t=>{if(null==t?void 0:t.length)for(let e of t)for(let t of null!=v?v:[]){let r=N7(e,t,i);if(!1!==r.visible){if(o.content.length===y-1){o.content.push(Object.assign(Object.assign({},r),_));break}if(!(o.content.length<y))break;o.content.push(r)}}};switch(t.activeType){case"mark":b(null===(n=e[0])||void 0===n?void 0:n.datum);break;case"group":b(i.groupDatum);break;case"dimension":for(let{data:t}of e){for(let{datum:e,series:r}of t){if(!CR(null===(s=r.tooltipHelper)||void 0===s?void 0:s.spec).includes("dimension"))continue;let t=null!==(a=null==v?void 0:v.filter(t=>ej(t.seriesId)||t.seriesId===r.id))&&void 0!==a?a:[];for(let r of e){for(let e of t){let t=N7(r,e,i);if(!1!==t.visible){if(o.content.length===y-1){o.content.push(Object.assign(Object.assign({},t),_));break}if(!(o.content.length<y))break;o.content.push(t)}}if(o.content.length>=y)break}if(o.content.length>=y)break}if(o.content.length>=y)break}}return o.title&&(o.content.length>0&&o.content[0].shapeType?(ej(o.title.shapeType)&&(o.title.shapeType=o.content[0].shapeType),ej(o.title.shapeColor)&&(o.title.shapeColor=o.content[0].shapeColor)):o.title.hasShape=!1),o},N7=(t,e,i)=>{let r=N6(N2(e.key,t,i,e.keyFormatter),e.keyTimeFormat,e.keyTimeFormatMode),n=N6(N2(e.value,t,i,e.valueFormatter),e.valueTimeFormat,e.valueTimeFormatMode),s=!1!==N2(e.visible,t,i)&&(eO(r)||eO(n)),a=N2(e.isKeyAdaptive,t,i),o=N2(e.spaceRow,t,i),l=N2(e.shapeType,t,i),h=N2(e.shapeColor,t,i),u=N2(e.shapeFill,t,i),d=N2(e.shapeStroke,t,i),c=N2(e.shapeLineWidth,t,i),p=N2(e.shapeHollow,t,i),g=N2(e.keyStyle,t,i),f=N2(e.valueStyle,t,i);return{key:r,value:n,visible:s,isKeyAdaptive:a,hasShape:e.hasShape,shapeType:l,shapeFill:u,shapeStroke:d,shapeLineWidth:c,shapeHollow:p,shapeColor:h,keyStyle:g,valueStyle:f,spaceRow:o,datum:t}};class zt{constructor(t){this._showTooltipByHandler=(t,e)=>{var i,r,n;let s;if(ej(t))return 1;e.changePositionOnly||this.clearCache(),this._updateViewSpec(e);let a=this._cacheViewSpec;if(ej(null==a?void 0:a[this.activeType])||!1===a.visible)return 1;e.tooltipSpec=a,this._updateActualTooltip(t,e),e.tooltipActual=this._cacheActualTooltip;let{title:o,content:l}=this._cacheActualTooltip,h=ej(null==o?void 0:o.key)&&ej(null==o?void 0:o.value)&&!(null==l?void 0:l.length);return(this.component.event.emit(c1.tooltipShow,Object.assign(Object.assign({},e),{isEmptyTooltip:ej(null==o?void 0:o.key)&&ej(null==o?void 0:o.value)&&!(null==l?void 0:l.length),tooltipData:t,activeType:this.activeType,tooltip:this.component})),h)?1:((null===(i=a.handler)||void 0===i?void 0:i.showTooltip)?s=a.handler.showTooltip.bind(a.handler):(null===(r=this.component.tooltipHandler)||void 0===r?void 0:r.showTooltip)&&(s=this.component.tooltipHandler.showTooltip.bind(this.component.tooltipHandler)),s?null!==(n=s(this.activeType,t,e))&&void 0!==n?n:0:1)},this.component=t}_preprocessDimensionInfo(t){let e=[];if(null==t||t.forEach(t=>{let i=Object.assign(Object.assign({},t),{data:t.data.filter(({series:t})=>{var e,i;return!1!==(null===(i=null===(e=t.getSpec())||void 0===e?void 0:e.tooltip)||void 0===i?void 0:i.visible)})});i.data.length>0&&e.push(i)}),e.length>0)return e}_getDimensionInfo(t){var e,i;let r;let n=this.component.getChart(),s=n.getCompiler().getStage().getLayer(void 0),a={x:t.event.viewX,y:t.event.viewY};if(s.globalTransMatrix.transformPoint({x:t.event.viewX,y:t.event.viewY},a),0===(r=[...null!==(e=dW(n,a,!0))&&void 0!==e?e:[],...null!==(i=dP(n,a))&&void 0!==i?i:[]]).length)r=void 0;else if(r.length>1){let t=r.filter(t=>{var e;let i;let r=t.axis;if(r.getSpec().hasDimensionTooltip)return!0;if(!ds(r.getScale().type))return!1;for(let t of null!==(e=null==r?void 0:r.getRegions())&&void 0!==e?e:[]){for(let e of t.getSeries())if("cartesian"===e.coordinate){i=e;break}if(eO(i))break}return eO(i)&&i.getDimensionField()[0]===i.fieldY[0]?"left"===r.getOrient()||"right"===r.getOrient():"bottom"===r.getOrient()||"top"===r.getOrient()});if((r=t.length?t:r.slice(0,1)).length>1){let t=new Set;r.forEach(e=>{e.data=e.data.filter(({key:e})=>!t.has(e)&&(t.add(e),!0))})}}return r}_updateViewSpec(t){let{changePositionOnly:e,model:i,dimensionInfo:r}=t;e&&this._cacheViewSpec||(this._cacheViewSpec=NX(this.activeType,this.component.getSpec(),i,r))}_updateActualTooltip(t,e){var i,r,n,s;let a=this._cacheViewSpec[this.activeType],{changePositionOnly:o}=e;if(!o||!this._cacheActualTooltip){let o=N9(a,t,e),l=!!eO(o)&&!1!==N3(a.visible,t,e);this._cacheActualTooltip=Object.assign(Object.assign({},o),{visible:l,activeType:a.activeType,data:t});let{title:h,content:u}=this._cacheActualTooltip;this._cacheActualTooltip.title=null!==(r=null===(i=a.updateTitle)||void 0===i?void 0:i.call(a,h,t,e))&&void 0!==r?r:h,this._cacheActualTooltip.content=null!==(s=null===(n=a.updateContent)||void 0===n?void 0:n.call(a,u,t,e))&&void 0!==s?s:u}}clearCache(){this._cacheViewSpec=void 0,this._cacheActualTooltip=void 0}}class ze extends zt{constructor(){super(...arguments),this.activeType="mark"}showTooltip(t,e,i){let{datum:r,series:n,dimensionInfo:s}=t,a=Object.assign(Object.assign({},e),{dimensionInfo:this._preprocessDimensionInfo(s),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler([{datum:[r],series:n}],a)}shouldHandleTooltip(t,e){var i;let{tooltipInfo:r}=e;if(ej(r))return!1;let n=null===(i=t.model)||void 0===i?void 0:i.tooltipHelper;return!!(null==n?void 0:n.activeType.includes("mark"))}getMouseEventData(t,e){var i;let r,n;if("series"===(null===(i=t.model)||void 0===i?void 0:i.modelType)){let i=t.model,s=i.tooltipHelper,a=null==s?void 0:s.activeTriggerSet.mark,o=null==s?void 0:s.ignoreTriggerSet.mark;(null==a?void 0:a.has(t.model))||(null==a?void 0:a.has(t.mark))?r={mark:t.mark,datum:t.datum,series:i,dimensionInfo:e}:((null==o?void 0:o.has(t.model))||(null==o?void 0:o.has(t.mark)))&&(n=!0)}return{tooltipInfo:r,ignore:n}}}class zi extends zt{constructor(){super(...arguments),this.activeType="dimension"}showTooltip(t,e,i){let r=Object.assign(Object.assign({},e),{dimensionInfo:this._preprocessDimensionInfo(t),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(t,r)}shouldHandleTooltip(t,e){var i,r;let{tooltipInfo:n}=e;if(ej(n))return!1;let s=null===(i=t.model)||void 0===i?void 0:i.tooltipHelper;return!!(null!==(r=null==s?void 0:s.activeType)&&void 0!==r?r:this.component.getSpec().activeType).includes("dimension")}getMouseEventData(t){var e;return{tooltipInfo:this._getDimensionInfo(t),ignore:[...null!==(e=this.component.getOption().getAllSeries())&&void 0!==e?e:[]].some(e=>{var i;let r=null===(i=e.tooltipHelper)||void 0===i?void 0:i.ignoreTriggerSet.dimension;return t.model&&(null==r?void 0:r.has(t.model))||t.mark&&(null==r?void 0:r.has(t.mark))})}}}class zr extends zt{constructor(){super(...arguments),this.activeType="group"}showTooltip(t,e,i){let{datum:r,series:n,dimensionInfo:s}=t,a=[{datum:om(r),series:n}],o=Object.assign(Object.assign({},e),{groupDatum:this._getGroupDatum(e),dimensionInfo:this._preprocessDimensionInfo(s),changePositionOnly:i,tooltip:this.component});return this._showTooltipByHandler(a,o)}shouldHandleTooltip(t,e){var i;let{tooltipInfo:r}=e;if(ej(r))return!1;let n=null===(i=t.model)||void 0===i?void 0:i.tooltipHelper;return!!(null==n?void 0:n.activeType.includes("group"))}getMouseEventData(t,e){var i,r;let n,s;if("series"===(null===(i=t.model)||void 0===i?void 0:i.modelType)){let i=t.model,a=i.tooltipHelper,o=null==a?void 0:a.activeTriggerSet.group,l=null==a?void 0:a.ignoreTriggerSet.group;if((null==o?void 0:o.has(t.model))||(null==o?void 0:o.has(t.mark))){let s=this.component.getSpec()[this.activeType];((null==s?void 0:s.triggerMark)?om(s.triggerMark):[]).includes(null===(r=t.mark)||void 0===r?void 0:r.name)&&(n={mark:t.mark,datum:t.datum,series:i,dimensionInfo:e})}else((null==l?void 0:l.has(t.model))||(null==l?void 0:l.has(t.mark)))&&(s=!0)}return{tooltipInfo:n,ignore:s}}_getGroupDatum(t){let{model:e,mark:i,datum:r}=t;if(["line","area"].includes(i.type))return om(r);let n=e.getViewData().latestData,s=e.getSeriesField();if(!s)return n;let a=om(r)[0][s];return n.filter(t=>t[s]===a)}}let zn=t=>eO(t)&&!eM(t),zs=t=>eO(t)&&eM(t);class za extends En{_shouldMergeThemeToSpec(){return!1}_initTheme(t,e){var i;let{spec:r,theme:n}=super._initTheme(t,e);return r.style=us({},this._theme,r.style),r.offset=us({},n.offset,t.offset),r.transitionDuration=null!==(i=t.transitionDuration)&&void 0!==i?i:n.transitionDuration,{spec:r,theme:n}}_transformSpecAfterMergingTheme(t,e,i){var r,n,s,a,o,l,h,u;super._transformSpecAfterMergingTheme(t,e,i),t.visible=null===(r=t.visible)||void 0===r||r,t.activeType=CR(t),t.renderMode=null!==(n=t.renderMode)&&void 0!==n?n:hu(this._option.mode)||!hl(this._option.mode)?"canvas":"html",t.trigger=null!==(s=t.trigger)&&void 0!==s?s:"hover",t.className=null!==(a=t.className)&&void 0!==a?a:"vchart-tooltip-element",t.enterable=null!==(o=t.enterable)&&void 0!==o&&o,t.transitionDuration=null!==(l=t.transitionDuration)&&void 0!==l?l:150,t.triggerOff=null!==(h=t.triggerOff)&&void 0!==h?h:t.trigger,t.confine=null!==(u=t.confine)&&void 0!==u?u:"canvas"===t.renderMode,eO(t.mark)&&(t.mark.activeType="mark"),eO(t.dimension)&&(t.dimension.activeType="dimension"),eO(t.parentElement)?eE(t.parentElement)&&(t.parentElement=lX.getElementById(t.parentElement)):hl(this._option.mode)&&(t.parentElement=null==ho?void 0:ho.body)}}class zo extends Ea{constructor(){super(...arguments),this.layoutZIndex=1,this.type=lx.tooltip,this.name=lx.tooltip,this.transformerConstructor=za,this.specKey="tooltip",this.layoutType="none",this._alwaysShow=!1,this._eventList=[],this._isTooltipShown=!1,this._clickLock=!1,this._mountEvent=(t,e,i)=>{this.event.on(t,e,i),this._eventList.push({eventType:t,handler:i})},this._handleClickToLock=t=>{this._clickLock?(this._handleChartMouseOut(t),this._clickLock=!1):this._clickLock=!0},this._getMouseOutHandler=t=>e=>{var i,r,n;if(this._alwaysShow||this._clickLock||!this._isTooltipShown&&!(null===(r=null===(i=this.tooltipHandler)||void 0===i?void 0:i.isTooltipShown)||void 0===r?void 0:r.call(i)))return;let s=hl(null===(n=this._option)||void 0===n?void 0:n.mode),{clientX:a,clientY:o}=e.event;s&&this._isPointerOnTooltip(e)||s&&t&&this._isPointerInChart({x:a,y:o})||this._handleChartMouseOut(e)},this._handleChartMouseOut=t=>{this._alwaysShow||"none"!==this._spec.triggerOff&&(this._hideTooltipByHandler(Object.assign(Object.assign({},t),{tooltip:this})),this._cacheInfo=void 0,this._cacheParams=void 0,this._cacheActiveType=void 0)},this._getMouseMoveHandler=t=>e=>{var i;if(this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),this._alwaysShow||this._isPointerOnTooltip(e))return;if(this._clickLock)return void(t&&(this._handleChartMouseOut(e),this._clickLock=!1));let r=this._getMouseEventData(e),{tooltipInfo:{dimension:n},ignore:{mark:s,dimension:a}}=r,o={mark:!1,dimension:!1,group:!1};o.group=this._showTooltipByMouseEvent("group",r,e,t),o.group||(o.mark=this._showTooltipByMouseEvent("mark",r,e,t)),o.mark||o.group||(o.dimension=this._showTooltipByMouseEvent("dimension",r,e,t)),Object.values(o).every(t=>!t)&&!(ej((i=e).mark)&&ej(i.model)&&ej(i.datum))&&(s&&zn(this._cacheInfo)?o.mark=this._showTooltipByMouseEvent("mark",r,e,t,!0):a&&zs(this._cacheInfo)?o.dimension=this._showTooltipByMouseEvent("dimension",r,e,t,!0):eO(n)&&(o.dimension=this._showTooltipByMouseEvent("dimension",r,e,t))),o.mark||o.group||o.dimension&&!ej(n)||this._handleChartMouseOut(e)},this._showTooltipByMouseEvent=(t,e,i,r,n)=>{var s;let a;let o=this.processor[t];if(!o.shouldHandleTooltip(i,{tooltipInfo:e.tooltipInfo[t],ignore:e.ignore[t]}))return!1;if(this._timer&&clearTimeout(this._timer),n)a=!o.showTooltip(this._cacheInfo,i,!0);else{let r=e.tooltipInfo[t],n=this._isSameAsCache(r,i,t);(a=!o.showTooltip(r,i,n))&&(this._cacheInfo=r,this._cacheParams=i,this._cacheActiveType=t)}a&&(this._isTooltipShown=!0,r&&this._spec.lockAfterClick&&!this._clickLock?this._clickLock=!0:Number.isFinite(this._spec.hideTimer)&&(this._timer=setTimeout(()=>{this._handleChartMouseOut()},this._spec.hideTimer)));let l=null===(s=this._option)||void 0===s?void 0:s.globalInstance;return a&&CM.globalConfig.uniqueTooltip&&l&&CM.hideTooltip(l.id),a},this._getMouseEventData=t=>{let e={tooltipInfo:{},ignore:{}},i="dimension",{tooltipInfo:r,ignore:n}=this.processor[i].getMouseEventData(t);e.tooltipInfo[i]=r,e.ignore[i]=n;for(i of Object.keys(this.processor))if("dimension"!==i){let{tooltipInfo:n,ignore:s}=this.processor[i].getMouseEventData(t,r);e.tooltipInfo[i]=n,e.ignore[i]=s}return e},this._hideTooltipByHandler=t=>{var e,i,r,n;let s;if(!this._isTooltipShown&&!(null===(i=null===(e=this.tooltipHandler)||void 0===e?void 0:e.isTooltipShown)||void 0===i?void 0:i.call(e)))return 0;if(this.event.emit(c1.tooltipHide,Object.assign(Object.assign({},t),{source:c2.chart,tooltip:this})),Object.values(this.processor).forEach(t=>{t.clearCache()}),(null===(r=this._spec.handler)||void 0===r?void 0:r.hideTooltip)?s=this._spec.handler.hideTooltip.bind(this._spec.handler):(null===(n=this.tooltipHandler)||void 0===n?void 0:n.hideTooltip)&&(s=this.tooltipHandler.hideTooltip.bind(this.tooltipHandler)),s){let e=s(t);return e||(this._isTooltipShown=!1),e}return 1}}static getSpecInfo(t){let e=t[this.specKey];if(!e)return null;if(!eM(e))return[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.tooltip}];let i=[];return e.forEach((t,e)=>{i.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:lx.tooltip})}),i}isTooltipShown(){return this._isTooltipShown}changeRegions(t){}_getNeedClearVRenderComponents(){return[]}_registerEvent(){}_releaseEvent(){}onLayout(t){}onLayoutEnd(t){}onRender(t){}created(){super.created(),this._regions=this._option.getAllRegions(),this._initEvent()}release(){var t,e;super.release(),this._timer&&clearTimeout(this._timer),this._eventList.forEach(({eventType:t,handler:e})=>{this.event.off(t,e)}),this._eventList=[],null===(e=null===(t=this.tooltipHandler)||void 0===t?void 0:t.release)||void 0===e||e.call(t),this._isTooltipShown=!1}beforeRelease(){this.event.emit(c1.tooltipHide,{tooltip:this,chart:this.getChart()}),this.event.emit(c1.tooltipRelease,{tooltip:this,chart:this.getChart()})}_initHandler(){var t,e,i;let r=null!==(t=this._spec.renderMode)&&void 0!==t?t:"html",n=this._option.globalInstance.getTooltipHandlerByUser();if(n)this.tooltipHandler=n;else{let t="canvas"===r?N4.canvas:N4.dom,n=de.getComponentPluginInType(t);n||hc("Can not find tooltip handler: "+t);let s=new n;s.name=`${this._spec.className}-${null!==(e=this._option.globalInstance.id)&&void 0!==e?e:0}-${this.getSpecIndex()}`,null===(i=this.pluginService)||void 0===i||i.load([s]),this.tooltipHandler=s}}_initProcessor(){this.processor={mark:new ze(this),dimension:new zi(this),group:new zr(this)}}_initEvent(){var t;if(this._option.disableTriggerEvent)return;let e=om(null!==(t=this._spec.trigger)&&void 0!==t?t:"hover"),i=this._option.mode;e.includes("hover")&&(this._mountEvent("pointermove",{source:"chart"},this._getMouseMoveHandler(!1)),(hh(i)||hu(i))&&(this._mountEvent("pointerdown",{source:"chart"},this._getMouseMoveHandler(!1)),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))),this._mountEvent("pointerout",{source:"canvas"},this._getMouseOutHandler(!1))),e.includes("click")?(this._mountEvent("pointertap",{source:"chart"},this._getMouseMoveHandler(!0)),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))):this._spec.lockAfterClick&&this._mountEvent("pointertap",{source:"chart"},this._handleClickToLock)}reInit(t){var e,i;super.reInit(t),this.tooltipHandler?null===(i=(e=this.tooltipHandler).reInit)||void 0===i||i.call(e):this._initHandler()}showTooltip(t,e){var i;if(this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),!(null===(i=this.tooltipHandler)||void 0===i?void 0:i.showTooltip))return!1;let r=function(t,e,i){var r,n,s;let a=Object.assign({regionIndex:0},e),o=i.getOption(),l=o.getRegionsInUserIdOrIndex(eO(a.regionId)?[a.regionId]:void 0,eO(a.regionIndex)?[a.regionIndex]:void 0)[0];if(!l)return"none";let h=NK(t,l),u=null!==(r=a.activeType)&&void 0!==r?r:h.length>1?"dimension":"mark",d=l.getLayoutStartPoint(),c=l.getLayoutRect(),p=o.globalInstance.getContainer(),g=Object.assign({x:0,y:0},p?function(t){let{x:e,y:i}=t.getBoundingClientRect();return{x:e,y:i}}(p):{}),f=t=>{var e;let{dimensionFields:i,dimensionData:r,measureFields:n,measureData:s,groupField:a,groupData:o}=t.data;return null===(e=t.series.getViewData())||void 0===e?void 0:e.latestData.find(t=>N$(i,r)(t)&&N$(n,s)(t)&&(ej(a)||N$([a],[o])(t)))},m=t=>{var e,i;let r;let n={x:Math.min(Math.max((r=t).x,0),c.width),y:Math.min(Math.max(r.y,0),c.height)},s=null!==(e=a.x)&&void 0!==e?e:d.x+n.x,o=null!==(i=a.y)&&void 0!==i?i:d.y+n.y;return{canvasX:s,canvasY:o,clientX:g.x+s,clientY:g.y+o}};if("dimension"===u){let e=h[0];if(!e)return"none";let r=new Map;h.forEach(t=>{var e;r.has(t.series)||r.set(t.series,[]),null===(e=r.get(t.series))||void 0===e||e.push(t)});let s=[{value:t[e.data.dimensionFields[0]],data:[...r.keys()].map(t=>{var e,i;return{series:t,datum:null!==(i=null===(e=r.get(t))||void 0===e?void 0:e.map(t=>f(t)))&&void 0!==i?i:[]}})}];eO(e.dimType)&&(s[0].position=e.pos[e.dimType],s[0].dimType=e.dimType);let a={changePositionOnly:!1,action:"enter",tooltip:null,dimensionInfo:s,chart:null!==(n=o.globalInstance.getChart())&&void 0!==n?n:void 0,datum:void 0,model:void 0,source:c2.chart,event:m({x:h.reduce((t,e)=>t+e.pos.x,0)/h.length,y:h.reduce((t,e)=>t+e.pos.y,0)/h.length}),item:void 0,itemMap:new Map};i.processor.dimension.showTooltip(s,a,!1);let l=o.globalInstance;return CM.globalConfig.uniqueTooltip&&CM.hideTooltip(l.id),u}if("mark"===u){let e=h[0];if(!e)return"none";let r=Object.assign(Object.assign({},f(e)),t),n=[{datum:[r],series:e.series}],a=[{value:r[e.data.dimensionFields[0]],data:n}],l={changePositionOnly:!1,tooltip:null,dimensionInfo:a,chart:null!==(s=o.globalInstance.getChart())&&void 0!==s?s:void 0,datum:r,model:e.series,source:c2.chart,event:m(e.pos),item:void 0,itemMap:new Map};i.processor.mark.showTooltip({datum:r,mark:null,series:e.series,dimensionInfo:a},l,!1);let d=o.globalInstance;return CM.globalConfig.uniqueTooltip&&CM.hideTooltip(d.id),u}return"none"}(t,e,this);return"none"!==r&&(this._alwaysShow=!!(null==e?void 0:e.alwaysShow)),r}hideTooltip(){let t={changePositionOnly:!1,tooltip:this,item:void 0,datum:void 0,source:c2.chart};return this._alwaysShow=!1,!this._hideTooltipByHandler(t)}_isSameAsCache(t,e,i){if(i!==this._cacheActiveType)return!1;if(t===this._cacheInfo)return!0;if(ej(this._cacheInfo)||ej(t))return!1;if(zs(t)){if(zn(this._cacheInfo))return!1;let e=this._cacheInfo;if(!(e.length===t.length&&t.every((t,i)=>dh(t,e[i]))))return!1}else{if(zs(this._cacheInfo))return!1;let e=this._cacheInfo;if(!((null==t?void 0:t.datum)===e.datum&&(null==t?void 0:t.mark)===e.mark&&(null==t?void 0:t.series)===e.series))return!1}let r=this._cacheParams;return!ej(r)&&!ej(e)&&r.mark===e.mark&&r.model===e.model&&r.datum===e.datum}_isPointerInChart(t){var e;let i=null===(e=this._option)||void 0===e?void 0:e.globalInstance;if(!i||!i.getChart())return!1;let{x:r,y:n}=t,{x:s,y:a,width:o,height:l}=i.getCanvas().getBoundingClientRect();return r>=s&&r<=s+o&&n>=a&&n<=a+l}_isPointerOnTooltip(t){var e,i;if(this._spec.enterable&&"html"===this._spec.renderMode){let r;let{event:n}=t;if(eO(n.nativeEvent)){let t=n.nativeEvent;r=t.relatedTarget,t.composedPath&&t.composedPath().length>0&&(r=t.composedPath()[0])}else r=n.relatedTarget;let s=null===(i=null===(e=this.tooltipHandler)||void 0===e?void 0:e.getTooltipContainer)||void 0===i?void 0:i.call(e);if(eO(s)&&eO(r)&&aw(r,s))return!0}return!1}getVisible(){return!1!==this._spec.visible}}zo.type=lx.tooltip,zo.transformerConstructor=za,zo.specKey="tooltip";class zl extends Eu{constructor(){super(...arguments),this.name="crosshair"}render(){this.renderCrosshair(this)}}v8(),kP();class zh extends zl{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},zh.defaultAttributes,t))}renderCrosshair(t){let{start:e,end:i,lineStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-line",Object.assign({points:[e,i]},r),"line")}setLocation(t){let{start:e,end:i}=t;this.setAttributes({start:e,end:i})}}zh.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},v8(),bp();class zu extends zl{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},zu.defaultAttributes,t))}renderCrosshair(t){let{start:e,end:i,rectStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-rect",Object.assign({x:e.x,y:e.y,width:i.x-e.x,height:i.y-e.y},r),"rect")}setLocation(t){let{start:e,end:i}=t;this.setAttributes({start:e,end:i})}}zu.defaultAttributes={rectStyle:{fill:"#b2bacf",opacity:.2}};(t$=ei||(ei={}))[t$.ALL=3]="ALL",t$[t$.HORIZONTAL=2]="HORIZONTAL",t$[t$.VERTICAL=1]="VERTICAL";var zd=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let zc={x:["top","bottom"],y:["left","right"],category:["angle"],value:["radius"]};class zp extends Ea{get enableRemain(){return"none"===this.triggerOff}constructor(t,e){super(t,e),this.specKey="crosshair",this.layoutType="none",this.gridZIndex=tM.CrossHair_Grid,this.labelZIndex=tM.CrossHair,this.trigger="hover",this._handleIn=t=>{if(!this._option)return;let{x:e,y:i}=this.calculateTriggerPoint(t);this.showDefault=!1,this._layoutCrosshair(e,i);let r=this._getNeedClearVRenderComponents();this._hasActive=r.some(t=>t&&!1!==t.attribute.visible)},this._handleClickInEvent=t=>{if(!this._hasActive||!this._spec.lockAfterClick||this._clickLock)return this._clickLock?(this._clickLock=!1,void this._handleOutEvent()):void(this._onlyLockClick||(this._handleIn(t),ey(this.triggerOff)&&(this._timer&&clearTimeout(this._timer),this._timer=setTimeout(()=>{this._handleOutEvent()},this.triggerOff))));this._clickLock=!0},this._handleHoverInEvent=dJ(t=>{this._clickLock||this._handleIn(t)},10),this._handleOutEvent=()=>{this.enableRemain||this._clickLock||!this._hasActive||(this.clearOutEvent(),this.hide())},this._handleTooltipShow=t=>{let e=t.tooltipData;if(t.isEmptyTooltip||!e||!e.length||nb(this._spec.followTooltip)&&!1===this._spec.followTooltip[t.activeType])return void this._handleTooltipHideOrRelease();let{x:i,y:r}=this.calculateTriggerPoint(t);this.showDefault=!1,this._layoutCrosshair(i,r,e,t.activeType);let n=this._getNeedClearVRenderComponents();this._hasActive=n.some(t=>t&&!1!==t.attribute.visible)},this._handleTooltipHideOrRelease=()=>{this.clearOutEvent(),this.hide()},this.enable=!0,this.showDefault=!0}_getLimitBounds(){var t,e;if(!this._limitBounds){let{width:i,height:r}=null!==(e=null===(t=this._option.globalInstance.getChart())||void 0===t?void 0:t.getViewRect())&&void 0!==e?e:{width:0,height:0};this._limitBounds={x1:0,y1:0,x2:i,y2:r}}return this._limitBounds}_showDefaultCrosshair(){this.showDefault&&this._showDefaultCrosshairBySpec()}setAttrFromSpec(){super.setAttrFromSpec(),this._parseCrosshairSpec()}created(){super.created(),this._initEvent()}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||my(e,t)||(i.reRender=!0,i.reMake=!0),i}_initEvent(){if(!this._option.disableTriggerEvent){if(this._spec.followTooltip)this._registerTooltipEvent();else{let t=this._getTriggerEvent();t&&t.forEach(t=>{this._registerEvent(t.in,!1,t.click),t.out&&this._registerEvent(t.out,!0)})}}}_registerEvent(t,e,i){let r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent,n=e?{level:c3.chart}:{source:c2.chart};eM(t)?t.forEach(t=>{this.event.on(t,n,r)}):this.event.on(t,n,r)}_eventOff(t,e,i){let r=e?this._handleOutEvent:i?this._handleClickInEvent:this._handleHoverInEvent;eM(t)?t.forEach(t=>{this.event.off(t,r)}):this.event.off(t,r)}updateLayoutAttribute(){this._limitBounds=null,this._showDefaultCrosshair()}calculateTriggerPoint(t){let{event:e}=t,i=this._option.getCompiler().getStage().getLayer(void 0),r={x:e.viewX,y:e.viewY};return i.globalTransMatrix.transformPoint({x:e.viewX,y:e.viewY},r),{x:r.x-this.getLayoutStartPoint().x,y:r.y-this.getLayoutStartPoint().y}}_getTriggerEvent(){var t;let{mode:e=lb["desktop-browser"]}=this._option,i=(t=e)===lb["desktop-browser"]||t===lb["desktop-miniApp"]?{click:"pointertap",hover:"pointermove",hoverOut:"pointerleave",clickOut:"pointerleave"}:hh(t)||hu(t)?{click:"tap",hover:["pointerdown","pointermove"],hoverOut:"pointerleave",clickOut:"pointerleave"}:null;if(i){let t=om(this.trigger||"hover"),e=t=>"click"===t?"none"===this.triggerOff?null:i.clickOut:i.hoverOut;this._spec.lockAfterClick&&!t.includes("click")?(t.push("click"),this._onlyLockClick=!0):this._onlyLockClick=!1;let r=[];return t.forEach(t=>{r.push({click:"click"===t,in:i[t],out:e(t)})}),r}return null}_registerTooltipEvent(){this.event.on(c1.tooltipHide,{source:c2.chart},this._handleTooltipHideOrRelease),this.event.on(c1.tooltipShow,{source:c2.chart},this._handleTooltipShow),this.event.on(c1.tooltipRelease,{source:c2.chart},this._handleTooltipHideOrRelease)}_getAxisInfoByField(t){var e,i;let r=null===(i=(e=this._option).getComponentsByKey)||void 0===i?void 0:i.call(e,"axes");if(!(null==r?void 0:r.length))return null;let n=dq(this._spec,`${t}Field.bindingAxesIndex`);if(n||(n=[],r.forEach((e,i)=>{zc[t].includes(e.getOrient())&&n.push(i)})),!n.length)return null;let s=new Map,a=1/0,o=1/0,l=-Infinity,h=-Infinity,{x:u,y:d}=this.getLayoutStartPoint();return n.forEach(t=>{a=1/0,o=1/0,l=-Infinity,h=-Infinity;let e=r.find(e=>e.getSpecIndex()===t);e&&(e.getRegions().forEach(t=>{let{x:e,y:i}=t.getLayoutStartPoint();a=Math.min(a,e-u),o=Math.min(o,i-d),l=Math.max(l,e+t.getLayoutRect().width-u),h=Math.max(h,i+t.getLayoutRect().height-d)}),s.set(t,{x1:a,y1:o,x2:l,y2:h,axis:e}))}),s}changeRegions(t){}onLayoutEnd(t){let e=this._regions[0];this.setLayoutRect(e.getLayoutRect()),this.setLayoutStartPosition(e.getLayoutStartPoint()),super.onLayoutEnd(t)}onRender(t){}_releaseEvent(){this.clearOutEvent();let t=this._getTriggerEvent();t&&t.forEach(t=>{this._eventOff(t.in,!1,t.click),t.out&&this._eventOff(t.out,!0)})}_parseCrosshairSpec(){this._parseFieldInfo();let{trigger:t,triggerOff:e,labelZIndex:i,gridZIndex:r}=this._spec;t&&(this.trigger=t),("none"===e||ey(e)&&e>0)&&(this.triggerOff=e),void 0!==i&&(this.labelZIndex=i),void 0!==r&&(this.gridZIndex=r)}_parseField(t,e){var i,r,n;let s={},{line:a={},label:o={},visible:l}=t;if(s.visible=l,s.type=a.type||"line",!1===a.visible)s.style={visible:!1};else{let t=a.style||{},{stroke:o,fill:l,lineWidth:h}=t,{strokeOpacity:u,fillOpacity:d,opacity:c}=t,p=zd(t,["strokeOpacity","fillOpacity","opacity"]),g="line"===s.type,f=g?u:d;if(ey(c)&&(f=(null!=f?f:1)*c),s.style=Object.assign({opacity:f,pickable:!1,visible:!0},p),g)s.style.stroke=o||l,s.style.lineWidth=dq(a,"width",h||2);else{s.style.fill=l||o,(null===(n=null===(r=null===(i=this._spec[e])||void 0===i?void 0:i.line)||void 0===r?void 0:r.style)||void 0===n?void 0:n.stroke)&&(s.style.stroke=this._spec[e].line.style.stroke);let t=dq(a,"width");if("string"==typeof t){let e=parseInt(t.substring(0,t.length-1),10)/100;s.style.sizePercent=e}else"number"!=typeof t&&"function"!=typeof t||(s.style.size=t)}}if(o.visible){let t=o.labelBackground||{},e=o.style||{},i=t.style||{},{fill:r="rgba(47, 59, 82, 0.9)",stroke:n,outerBorder:a}=i,l=zd(i,["fill","stroke","outerBorder"]);s.label={visible:!0,formatMethod:o.formatMethod,formatter:o.formatter,minWidth:t.minWidth,maxWidth:t.maxWidth,padding:t.padding,textStyle:Object.assign(Object.assign({fontSize:14,pickable:!1},e),{fill:e.fill||"#fff",stroke:dq(e,"stroke")}),panel:(ew(t.visible)?t.visible:t)?Object.assign({visible:!0,pickable:!1,fill:r,stroke:n,outerBorder:Object.assign({stroke:r,distance:0,lineWidth:3},a)},l):{visible:!1},zIndex:this.labelZIndex,childrenPickable:!1,pickable:!1}}else s.label={visible:!1};return s}_filterAxisByPoint(t,e,i){return t&&t.forEach(r=>{var n,s,a;let o=r.axis;if(n=r,s=e,a=i,(n.x1>s||n.x2<s||n.y1>a||n.y2<a)&&t.delete(o.getSpecIndex()),o.type.startsWith("polarAxis")){let r=o.getCenter(),n=o.getInnerRadius(),s=o.getOuterRadius(),a=iG.distancePP({x:e,y:i},r);(a>s||a<n)&&t.delete(o.getSpecIndex())}}),t}clearOutEvent(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._clickLock&&(this._clickLock=null),this._hasActive&&(this._hasActive=null)}}zp.specKey="crosshair";let zg=(t=3,e,i,r,n,s,a,o=!1,l,h)=>{let u,d,c;let p=1&t,g=2&t;i||(i={x:0,y:0});let f=null,m=null,v=0,y=0;if(r.size){let t=Array.from(r.values())[0];v=t.axis.getScale().scale(t.value)+t.axis.getLayoutStartPoint().x-i.x,f=t.axis}if(n.size){let t=Array.from(n.values())[0];y=t.axis.getScale().scale(t.value)+t.axis.getLayoutStartPoint().y-i.y,m=t.axis}let _=!!r.size&&Number.isFinite(v),b=!!n.size&&Number.isFinite(y),x=o&&!_&&eO(l),S=o&&!b&&eO(h);p&&(u=x?l:{height:0,leftPos:0,rightPos:0,topPos:0,x:0,bottom:{visible:!1,text:"",dx:0,dy:0},top:{visible:!1,text:"",dx:0,dy:0},visible:_,axis:f}),g&&(d=S?h:{width:0,leftPos:0,topPos:0,bottomPos:0,y:0,left:{visible:!1,text:"",dx:0,dy:0},right:{visible:!1,text:"",dx:0,dy:0},visible:b,axis:m});let k,A=0,w=0;if(s&&r.forEach(({axis:t,value:i})=>{var r;i=null!=i?i:"";let n=null,a=t.getScale();if(ds(a.type))0===(c=a.bandwidth())&&a.step&&(A=a.step());else if(dr(a.type)){let r=e.fieldX[0],s=e.fieldX2,a=Et(e.getViewData().latestData,+i,r,s);if(a){let t=e.dataToPositionX(a);s?(c=Math.abs(t-e.dataToPositionX1(a)),i=`${a[r]} ~ ${a[s]}`):c=1,v=t}n=t.niceLabelFormatter}if(u&&(null===(r=s.label)||void 0===r?void 0:r.visible)&&!x){let e=TG(t.getSpec());"bottom"===t.getOrient()?(u.bottom.visible=!0,u.bottom.defaultFormatter=n,u.bottom.text=i,u.bottom.dx=0,u.bottom.dy=e):"top"===t.getOrient()&&(u.top.visible=!0,u.top.defaultFormatter=n,u.top.text=i,u.top.dx=0,u.top.dy=-e)}}),a&&n.forEach(({axis:t,value:i})=>{var r;i=null!=i?i:"";let n=null,s=t.getScale();if(ds(s.type))0===(k=s.bandwidth())&&s.step&&(w=s.step());else if(dr(s.type)){let r=e.fieldY[0],s=e.fieldY2,a=Et(e.getViewData().latestData,+i,r,s);if(a){let t=e.dataToPositionY(a);s?(k=Math.abs(t-e.dataToPositionY1(a)),i=`${a[r]} ~ ${a[s]}`):k=1,y=t}n=t.niceLabelFormatter}if(d&&(null===(r=a.label)||void 0===r?void 0:r.visible)&&!S){let e=TG(t.getSpec());"left"===t.getOrient()?(d.left.visible=!0,d.left.defaultFormatter=n,d.left.text=i,d.left.dx=-e,d.left.dy=0):"right"===t.getOrient()&&(d.right.visible=!0,d.right.defaultFormatter=n,d.right.text=i,d.right.dx=e,d.right.dy=0)}}),u&&!x){let t={x1:1/0,y1:1/0,x2:-Infinity,y2:-Infinity};if(zm(t,r),u.leftPos=t.x1,u.rightPos=t.x2,u.topPos=t.y1,u.height=t.y2-t.y1,u.x=v+i.x,s&&s.label){let{top:t,bottom:e}=u;t.visible&&zf(t,"top",s.label),e.visible&&zf(e,"bottom",s.label)}}if(d&&!S){let t={x1:1/0,y1:1/0,x2:-Infinity,y2:-Infinity};if(zm(t,n),d.leftPos=t.x1,d.topPos=t.y1,d.bottomPos=t.y2,d.width=t.x2-t.x1,d.y=y+i.y,a&&a.label){let{left:t,right:e}=d;t.visible&&zf(t,"left",a.label),e.visible&&zf(e,"right",a.label)}}return{x:p&&u?u:void 0,y:g&&d?d:void 0,offsetWidth:A,offsetHeight:w,bandWidth:null!=c?c:0,bandHeight:null!=k?k:0}},zf=(t,e,i)=>{let{formatMethod:r,formatter:n}=i,{formatFunc:s,args:a}=TV(r,n,t.text,{label:t.text,position:e});s?t.text=s(...a):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))},zm=(t,e)=>{e.forEach(({axis:e})=>{e.getRegions().forEach(e=>{t.x1=Math.min(t.x1,e.getLayoutStartPoint().x),t.y1=Math.min(t.y1,e.getLayoutStartPoint().y),t.x2=Math.max(t.x2,e.getLayoutStartPoint().x+e.getLayoutRect().width),t.y2=Math.max(t.y2,e.getLayoutStartPoint().y+e.getLayoutRect().height)})})},zv=(t,e,i,r)=>{let n;let{x:s,topPos:a,height:o}=e,l=t.type;if("line"===l)n={visible:!0,start:{x:s+i/2,y:a},end:{x:s+i/2,y:a+o}};else if("rect"===l){let l=z_(t,i,e.axis),{leftPos:h,rightPos:u}=e;n={visible:!0,start:{x:Math.max(s-l/2-r/2,h),y:a},end:{x:Math.min(s+i+l/2+r/2,u),y:a+o}}}return n},zy=(t,e,i,r)=>{let n;let{leftPos:s,width:a,y:o}=e,l=t.type;if("line"===l)n={visible:!0,start:{x:s,y:o+i/2},end:{x:s+a,y:o+i/2}};else if("rect"===l){let l=z_(t,i,e.axis),{topPos:h,bottomPos:u}=e;n={visible:!0,start:{x:s,y:Math.max(o-l/2-r/2,h)},end:{x:s+a,y:Math.min(o+i+l/2+r/2,u)}}}return n},z_=(t,e,i)=>{var r,n,s;let a=0;if(null===(r=t.style)||void 0===r?void 0:r.sizePercent)a=(t.style.sizePercent-1)*e;else if("number"==typeof(null===(n=t.style)||void 0===n?void 0:n.size))a=t.style.size-e;else if("function"==typeof(null===(s=t.style)||void 0===s?void 0:s.size)){let r=i.getLayoutRect();a=t.style.size(r,i)-e}return a};class zb extends zp{static getSpecInfo(t){let e=t[this.specKey];if(ej(e))return;if(!eM(e))return e.xField&&!1!==e.xField.visible||e.yField&&!1!==e.yField.visible?[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.cartesianCrosshair}]:void 0;let i=[];return e.forEach((t,e)=>{(t.xField&&!1!==t.xField.visible||t.yField&&!1!==t.yField.visible)&&i.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:lx.cartesianCrosshair})}),i}constructor(t,e){super(t,e),this.type=lx.cartesianCrosshair,this.name=lx.cartesianCrosshair,this._currValueX=new Map,this._currValueY=new Map}_showDefaultCrosshairBySpec(){let{xField:t,yField:e}=this._spec;if((null==t?void 0:t.visible)&&t.defaultSelect){let{axisIndex:e,datum:i}=t.defaultSelect;this._defaultCrosshair(e,i,1)}if((null==e?void 0:e.visible)&&e.defaultSelect){let{axisIndex:t,datum:i}=e.defaultSelect;this._defaultCrosshair(t,i,2)}}_defaultCrosshair(t,e,i){let r=this._option.getComponentsByKey("axes").find(e=>e.getSpecIndex()===t);r&&(1===i?(this._currValueX.clear(),this._currValueX.set(t,{axis:r,value:e})):(this._currValueY.clear(),this._currValueY.set(t,{axis:r,value:e})),this.layoutByValue(i))}_findAllAxisContains(t,e){let i=this._getAxisInfoByField("x"),r=this._getAxisInfoByField("y");return{xAxisMap:this._filterAxisByPoint(i,t,e),yAxisMap:this._filterAxisByPoint(r,t,e)}}_getValueAt(t,e){return t.getScale().invert(e)}clearAxisValue(){this._currValueX.clear(),this._currValueY.clear()}setAxisValue(t,e){dR(e.getOrient())?this._currValueX.set(e.getSpecIndex(),{value:t,axis:e}):this._currValueY.set(e.getSpecIndex(),{value:t,axis:e})}_getAllAxisValues(t,e,i,r){let n=!1;return t.forEach(t=>{ds(t.axis.getScale().type)&&(n?this.enable=!1:n=!0)}),!!this.enable&&(t.forEach((t,n)=>{let s=t.axis;i.set(n,{value:this._getValueAt(s,e-(r?s.getLayoutStartPoint().x-this.getLayoutStartPoint().x:s.getLayoutStartPoint().y-this.getLayoutStartPoint().y)),axis:s})}),!0)}_layoutCrosshair(t,e,i,r){var n;let s=t,a=e;if(i&&i.length){if("dimension"===r){let t;let e=i[0],r=e.data.findIndex(t=>t.datum.length>0);if(r>-1){let i=e.data[r];t=i.series.dataToPosition(i.datum[0])}(eO(e.dimType)?"y"===e.dimType:dB(null===(n=null==e?void 0:e.axis)||void 0===n?void 0:n.getOrient()))?a=null==t?void 0:t.y:s=null==t?void 0:t.x}else if("mark"===r){let t=i[0],e=t.series.dataToPosition(t.datum[0]);s=null==e?void 0:e.x,a=null==e?void 0:e.y}}let{xAxisMap:o,yAxisMap:l}=this._findAllAxisContains(s,a);if(o&&0===o.size||l&&0===l.size){if(this.enableRemain)return;this.hide()}else this._currValueX.clear(),this._currValueY.clear(),o&&o.size&&this._getAllAxisValues(o,s,this._currValueX,!0),l&&l.size&&this._getAllAxisValues(l,a,this._currValueY,!1),this.layoutByValue(3)}hide(){this._xCrosshair&&this._xCrosshair.hideAll(),this._xTopLabel&&this._xTopLabel.hideAll(),this._xBottomLabel&&this._xBottomLabel.hideAll(),this._yCrosshair&&this._yCrosshair.hideAll(),this._yLeftLabel&&this._yLeftLabel.hideAll(),this._yRightLabel&&this._yRightLabel.hideAll()}layoutByValue(t=3){if(!this.enable)return;let e=dE(this._regions,"cartesian");if(!e)return;let{x:i,y:r,offsetWidth:n,offsetHeight:s,bandWidth:a,bandHeight:o}=zg(t,e,this.getLayoutStartPoint(),this._currValueX,this._currValueY,this._xHair,this._yHair,this.enableRemain,this._cacheXCrossHairInfo,this._cacheYCrossHairInfo);this.enableRemain&&(i&&(this._cacheXCrossHairInfo=Object.assign(Object.assign({},i),{_isCache:!0})),r&&(this._cacheYCrossHairInfo=Object.assign(Object.assign({},r),{_isCache:!0}))),i&&this._layoutVertical(i,a,n),r&&this._layoutHorizontal(r,o,s)}_layoutVertical(t,e,i){var r,n;if(t._isCache&&this.enableRemain||!this._xHair)return;let{x:s,topPos:a,height:o,top:l,bottom:h,visible:u}=t;if(u){let u=this._xHair.type,d=zv(this._xHair,t,e,i);if(this._updateCrosshair("x",u,d),l.visible){let t=Object.assign(Object.assign(Object.assign({x:s+e/2,y:a},l),this._xHair.label),{textStyle:Object.assign(Object.assign({},null===(r=this._xHair.label)||void 0===r?void 0:r.textStyle),{textAlign:"center",textBaseline:"bottom"}),zIndex:this.labelZIndex,visible:!0});this._updateCrosshairLabel(this._xTopLabel,t,t=>{t.name="crosshair-x-top-label",this._xTopLabel=t})}else this._xTopLabel&&this._xTopLabel.hideAll();if(h.visible){let t=Object.assign(Object.assign(Object.assign({x:s+e/2,y:a+o},h),this._xHair.label),{textStyle:Object.assign(Object.assign({},null===(n=this._xHair.label)||void 0===n?void 0:n.textStyle),{textAlign:"center",textBaseline:"top"}),zIndex:this.labelZIndex,visible:!0});this._updateCrosshairLabel(this._xBottomLabel,t,t=>{t.name="crosshair-x-bottom-label",this._xBottomLabel=t})}else this._xBottomLabel&&this._xBottomLabel.hideAll()}}_layoutHorizontal(t,e,i){var r,n;if(t._isCache&&this.enableRemain||!this._yHair)return;let{leftPos:s,width:a,y:o,left:l,right:h,visible:u}=t;if(u){let u=this._yHair.type,d=zy(this._yHair,t,e,i);if(this._updateCrosshair("y",u,d),l.visible){let t=Object.assign(Object.assign(Object.assign({x:s,y:o+e/2},l),this._yHair.label),{textStyle:Object.assign(Object.assign({},null===(r=this._yHair.label)||void 0===r?void 0:r.textStyle),{textAlign:"right",textBaseline:"middle"}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._yLeftLabel,t,t=>{t.name="crosshair-y-left-label",this._yLeftLabel=t})}else this._yLeftLabel&&this._yLeftLabel.hideAll();if(h.visible){let t=Object.assign(Object.assign(Object.assign({x:s+a,y:o+e},h),this._yHair.label),{textStyle:Object.assign(Object.assign({},null===(n=this._yHair.label)||void 0===n?void 0:n.textStyle),{textAlign:"left",textBaseline:"middle"}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._yRightLabel,t,t=>{t.name="crosshair-y-right-label",this._yRightLabel=t})}else this._yRightLabel&&this._yRightLabel.hideAll()}}_parseFieldInfo(){let{xField:t,yField:e}=this._spec;t&&t.visible&&(this._xHair=this._parseField(t,"xField")),e&&e.visible&&(this._yHair=this._parseField(e,"yField"))}_updateCrosshair(t,e,i){let r;let n=this.getContainer();if(r="x"===t?this._xCrosshair:this._yCrosshair)r.setAttributes(i);else{let s="x"===t?this._xHair.style:this._yHair.style;"line"===e?r=new zh(Object.assign(Object.assign({},i),{lineStyle:s,zIndex:this.gridZIndex+1,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1})):"rect"===e&&(r=new zu(Object.assign(Object.assign({},i),{rectStyle:s,zIndex:this.gridZIndex,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1}))),null==n||n.add(r),"x"===t?this._xCrosshair=r:this._yCrosshair=r}}_updateCrosshairLabel(t,e,i){let r=this.getContainer();t?t.setAttributes(e):(i(t=new Ey(e)),null==r||r.add(t)),T7(t,this._getLimitBounds())}_getNeedClearVRenderComponents(){return[this._xCrosshair,this._xTopLabel,this._xBottomLabel,this._yCrosshair,this._yLeftLabel,this._yRightLabel]}}zb.specKey="crosshair",zb.type=lx.cartesianCrosshair;v8(),SB();class zx extends zl{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},zx.defaultAttributes,t))}renderCrosshair(t){let{center:e,radius:i,innerRadius:r=0,sectorStyle:n}=this.attribute,{startAngle:s,endAngle:a}=this.attribute;return t.createOrUpdateChild("crosshair-sector",Object.assign(Object.assign(Object.assign({},e),{outerRadius:i,innerRadius:r,startAngle:s,endAngle:a}),n),"arc")}setLocation(t){let{center:e,startAngle:i=MS,endAngle:r=Mk}=this.attribute,n=r-i,s=iA(iC(e,t));this.setAttributes({startAngle:s-n/2,endAngle:s+n/2})}}zx.defaultAttributes={sectorStyle:{fill:"#b2bacf",opacity:.2}},v8(),kU();class zS extends zl{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},zS.defaultAttributes,t))}renderCrosshair(t){let e;let{center:i,radius:r,sides:n=6,lineStyle:s}=this.attribute,{startAngle:a,endAngle:o}=this.attribute,l=(o-a)%(2*Math.PI)==0,h=(o-a)/n;for(let t=0;t<=n;t++){let s=iM(i,r,a+h*t);0===t?e=`M${s.x},${s.y}`:e+=`L${s.x},${s.y}`,t===n&&l&&(e+="Z")}return t.createOrUpdateChild("crosshair-polygon",Object.assign({path:e},s),"path")}setLocation(t){let{center:e}=this.attribute,i=iG.distancePP(t,e);this.setAttribute("radius",i)}}zS.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},v8(),SB();class zk extends zl{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},zk.defaultAttributes,t))}renderCrosshair(t){let{center:e,radius:i,lineStyle:r}=this.attribute;return t.createOrUpdateChild("crosshair-circle",Object.assign(Object.assign(Object.assign(Object.assign({},e),{outerRadius:i}),this.attribute),r),"arc")}setLocation(t){let{center:e}=this.attribute,i=iG.distancePP(t,e);this.setAttribute("radius",i)}}zk.defaultAttributes={lineStyle:{stroke:["#b2bacf",!1,!1,!1],lineWidth:1,lineDash:[2]}};var zA=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let zw=(t,e,i,r,n,s=!1,a,o)=>{let l={x:0,y:0,center:{x:0,y:0},radius:0,distance:0,startAngle:0,endAngle:0,innerRadius:0,visible:!1,label:{visible:!1,text:"",offset:0}},h={x:0,y:0,center:{x:0,y:0},radius:0,distance:0,startAngle:0,endAngle:0,innerRadius:0,visible:!1,sides:t.angleAxisHelper.getScale(0).domain().length,label:{visible:!1,text:"",offset:0}};if(r){l.visible=!!e.size;let i=t.angleAxisHelper.getBandwidth(0);e.forEach(e=>{var n,{axis:s,value:a,coord:o}=e,h=zA(e,["axis","value","coord"]);a=null!=a?a:"",us(l,h);let u=t.angleAxisHelper.dataToPosition([a]);l.angle=u;let d=s.niceLabelFormatter;(null===(n=r.label)||void 0===n?void 0:n.visible)&&(l.label.visible=!0,l.label.defaultFormatter=d,l.label.text=a,l.label.offset=TG(s.getSpec())),l.startAngle=u-i/2,l.endAngle=u+i/2})}if(n&&(h.visible=!!i.size,i.forEach(t=>{var e,{axis:i,value:r,coord:s}=t,a=zA(t,["axis","value","coord"]);r=null!=r?r:"";let o=i.niceLabelFormatter;(null===(e=n.label)||void 0===e?void 0:e.visible)&&(h.label.visible=!0,h.label.defaultFormatter=o,h.label.text=r,h.label.offset=TG(i.getSpec())),h.angle=s.angle,h.axis=i,us(h,a)})),s&&!l.visible&&eO(a))l=a;else if(l.label.visible&&r&&r.label){let{label:t}=l,{formatMethod:e,formatter:i}=r.label,{formatFunc:n,args:s}=TV(e,i,t.text,{label:t.text,orient:"angle"});n?t.text=n(...s):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))}if(s&&!h.visible&&eO(o))h=o;else if(h.label.visible&&n&&n.label){let{label:t}=h,{formatMethod:e,formatter:i}=n.label,{formatFunc:r,args:s}=TV(e,i,t.text,{label:t.text,orient:"radius"});r?t.text=r(...s):t.defaultFormatter&&(t.text=t.defaultFormatter(t.text))}return{angle:l,radius:h}},zM=(t,e)=>{let i;let{angle:r,innerRadius:n,radius:s,startAngle:a,endAngle:o,center:l}=e;return"sector"==("rect"===t.type?"sector":"line")?{center:l,innerRadius:n,radius:s,startAngle:a,endAngle:o}:{start:iM(l,n,r),end:iM(l,s,r)}},zC=(t,e)=>{let{center:i,startAngle:r,endAngle:n,distance:s,sides:a,axis:o,point:l,radius:h,innerRadius:u}=e,d=s;if("polygon"==(t.smooth?"circle":"polygon")){let t=o.getCenter(),e=iC(t,l),i=(n-r)/a,c=Math.floor((e-r)/i),p=Math.min((c+1)*i+r,n),g=iM(t,s,c*i+r),f=iM(t,s,p),m=a2([f.x,f.y],[g.x,g.y],[t.x,t.y],[l.x,l.y]);m&&(d=nL(iG.distancePN(l,m[0],m[1])+s,u,h))}return{center:i,startAngle:r,endAngle:n,radius:d,sides:a}};class zT extends zp{static getSpecInfo(t){let e=t[this.specKey];if(ej(e))return;if(!eM(e))return e.categoryField&&!1!==e.categoryField.visible||e.valueField&&!1!==e.valueField.visible?[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.polarCrosshair}]:void 0;let i=[];return e.forEach((t,e)=>{(t.categoryField&&!1!==t.categoryField.visible||t.valueField&&!1!==t.valueField.visible)&&i.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:lx.polarCrosshair})}),i}constructor(t,e){super(t,e),this.type=lx.polarCrosshair,this.name=lx.polarCrosshair,this._currValueAngle=new Map,this._currValueRadius=new Map}_showDefaultCrosshairBySpec(){let{categoryField:t,valueField:e}=this._spec;if((null==t?void 0:t.visible)&&t.defaultSelect){let{axisIndex:e,datum:i}=t.defaultSelect;this._defaultCrosshair(e,i,1)}if((null==e?void 0:e.visible)&&e.defaultSelect){let{axisIndex:t,datum:i}=e.defaultSelect;this._defaultCrosshair(t,i,2)}}_defaultCrosshair(t,e,i){let r=this._option.getComponentsByKey("axes").find(e=>e.getSpecIndex()===t);if(r){if(1===i){this._currValueAngle.clear();let i={angle:r.valueToPosition(e),radius:r.getOuterRadius()},n=r.coordToPoint(i);this._currValueAngle.set(t,this._getValueByAxis(r,n))}else{this._currValueRadius.clear();let i={angle:r.startAngle,radius:r.valueToPosition(e)},n=r.coordToPoint(i);this._currValueRadius.set(t,this._getValueByAxis(r,n))}this.layoutByValue(3)}}hide(){this._radiusCrosshair&&this._radiusCrosshair.hideAll(),this._radiusLabelCrosshair&&this._radiusLabelCrosshair.hideAll(),this._angleCrosshair&&this._angleCrosshair.hideAll(),this._angleLabelCrosshair&&this._angleLabelCrosshair.hideAll()}_findAllAxisContains(t,e){let i=this._getAxisInfoByField("category"),r=this._getAxisInfoByField("value");return{angleAxisMap:this._filterAxisByPoint(i,t,e),radiusAxisMap:this._filterAxisByPoint(r,t,e)}}_getAllAxisValues(t,e,i){let r=!1;return t.forEach(t=>{ds(t.axis.getScale().type)&&(r?this.enable=!1:r=!0)}),!!this.enable&&(t.forEach((t,r)=>{let n=t.axis;i.set(r,this._getValueByAxis(n,e))}),!0)}_getValueByAxis(t,e){let{x:i,y:r}=t.getLayoutStartPoint(),{x:n,y:s}=this.getLayoutStartPoint(),a=t.positionToData({x:e.x-(i-n),y:e.y-(r-s)}),o={x:t.getCenter().x+this.getLayoutStartPoint().x,y:t.getCenter().y+this.getLayoutStartPoint().y};return{value:a,axis:t,center:o,innerRadius:t.getInnerRadius(),radius:t.getOuterRadius(),startAngle:t.startAngle,endAngle:t.endAngle,distance:iG.distancePP(e,t.getCenter()),coord:t.pointToCoord(e),point:e}}_layoutCrosshair(t,e,i,r){let n=t,s=e;if(i&&i.length){if("dimension"===r){let t=i[0];if(t.axis){let e=t.axis.pointToCoord({x:n,y:s}),i="radius"===t.axis.getOrient()?{radius:t.position,angle:e.angle}:{radius:e.radius,angle:t.position},r=t.axis.coordToPoint(i);n=r.x,s=r.y}}else if("mark"===r){let t=i[0],e=t.series.dataToPosition(t.datum[0]);n=e.x,s=e.y}}let{angleAxisMap:a,radiusAxisMap:o}=this._findAllAxisContains(n,s);if(0!==a.size||0!==o.size)this._currValueAngle.clear(),this._currValueRadius.clear(),a&&this._getAllAxisValues(a,{x:n,y:s},this._currValueAngle),o&&this._getAllAxisValues(o,{x:n,y:s},this._currValueRadius),this.layoutByValue(3);else{if(this.enableRemain)return;this.hide()}}layoutByValue(t=3){if(!this.enable)return;let e=dE(this._regions,"polar");if(!e)return;let{angle:i,radius:r}=zw(e,this._currValueAngle,this._currValueRadius,this._angleHair,this._radiusHair,this.enableRemain,this._cacheAngleCrossHairInfo,this._cacheRadiusCrossHairInfo);this.enableRemain&&(this._cacheAngleCrossHairInfo=Object.assign(Object.assign({},i),{_isCache:!0}),this._cacheRadiusCrossHairInfo=Object.assign(Object.assign({},r),{_isCache:!0})),t&&(this._layoutRadius(r),this._layoutAngle(i))}_layoutAngle(t){var e,i;if(t._isCache&&this.enableRemain)return;let r=this.getContainer(),{angle:n,radius:s,label:a,center:o,visible:l}=t;if(l){let l="rect"===this._angleHair.type?"sector":"line",h=zM(this._angleHair,t);if(this._angleCrosshair)this._angleCrosshair.setAttributes(h);else{let t;"line"===l?t=new zh(Object.assign(Object.assign({},h),{lineStyle:this._angleHair.style,zIndex:this.gridZIndex,pickable:!1})):"sector"===l&&(t=new zx(Object.assign(Object.assign({},h),{sectorStyle:this._angleHair.style,zIndex:this.gridZIndex,pickable:!1}))),this._angleCrosshair=t,r.add(t)}if(a.visible){;let t,r;let l=(t="center",r="middle",{align:t=(i=iT(i=n))>=5/3*Math.PI||i<=1/3*Math.PI?"left":i>=2/3*Math.PI&&i<=4/3*Math.PI?"right":"center",baseline:r=i>=7/6*Math.PI&&i<=11/6*Math.PI?"bottom":i>=1/6*Math.PI&&i<=5/6*Math.PI?"top":"middle"}),h=Object.assign(Object.assign(Object.assign(Object.assign({},iM(o,s+a.offset,n)),this._angleHair.label),a),{textStyle:Object.assign(Object.assign({},null===(e=this._angleHair.label)||void 0===e?void 0:e.textStyle),{textAlign:l.align,textBaseline:l.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._angleLabelCrosshair,h,t=>{t.name="crosshair-angle-label",this._angleLabelCrosshair=t})}else this._angleLabelCrosshair&&this._angleLabelCrosshair.hideAll()}}_layoutRadius(t){var e,i;if(t._isCache&&this.enableRemain)return;let{center:r,startAngle:n,label:s,visible:a}=t,o=this.getContainer();if(a){let a=this._radiusHair.smooth?"circle":"polygon",l=zC(this._radiusHair,t),h=l.radius;if(this._radiusCrosshair)this._radiusCrosshair.setAttributes(l);else{let t;t="polygon"===a?new zS(Object.assign(Object.assign({},l),{lineStyle:this._radiusHair.style,zIndex:this.gridZIndex+1})):new zk(Object.assign(Object.assign({},l),{lineStyle:this._radiusHair.style,zIndex:this.gridZIndex})),this._radiusCrosshair=t,o.add(t)}if(s.visible){;let t,a;let o=(t="center",a="middle",{align:t=(i=iT(i=n))>=7/6*Math.PI&&i<=11/6*Math.PI?"right":i>=1/6*Math.PI&&i<=5/6*Math.PI?"left":"center",baseline:a=i>=5/3*Math.PI||i<=1/3*Math.PI?"bottom":i>=2/3*Math.PI&&i<=4/3*Math.PI?"top":"middle"}),l=Object.assign(Object.assign(Object.assign(Object.assign({},iM(r,h,n)),this._radiusHair.label),s),{textStyle:Object.assign(Object.assign({},null===(e=this._radiusHair.label)||void 0===e?void 0:e.textStyle),{textAlign:o.align,textBaseline:o.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._radiusLabelCrosshair,l,t=>{t.name="crosshair-radius-label",this._radiusLabelCrosshair=t})}else this._radiusLabelCrosshair&&this._radiusLabelCrosshair.hideAll()}}_parseFieldInfo(){var t;let{categoryField:e,valueField:i}=this._spec;e&&e.visible&&(this._angleHair=this._parseField(e,"categoryField")),i&&i.visible&&(this._radiusHair=this._parseField(i,"valueField"),this._radiusHair.smooth=null===(t=null==i?void 0:i.line)||void 0===t?void 0:t.smooth)}_updateCrosshairLabel(t,e,i){let r=this.getContainer();t?t.setAttributes(e):(t=new Ey(e),null==r||r.add(t),i(t)),T7(t,this._getLimitBounds())}_getNeedClearVRenderComponents(){return[this._radiusCrosshair,this._radiusLabelCrosshair,this._angleCrosshair,this._angleLabelCrosshair]}}zT.specKey="crosshair",zT.type=lx.polarCrosshair;let zE=(t,e)=>{let{getNewDomain:i,isContinuous:r,field:n}=e,s=n(),a=i();if(ej(a)||ej(s))return t;if(0===a.length)return[];let o={};a.forEach(t=>{o[t]||(o[t]=1)});let l=null;return l=r()?t=>t[s]>=a[0]&&t[s]<=a[1]:t=>o[t[s]+""]||o[t[s]],t.filter(l)},zO=(t,e)=>{let{stateFields:i,valueFields:r,dataCollection:n}=e.input,{stateField:s,valueField:a}=e.output,o={},l=[];return n.forEach((t,e)=>{var n;if(ej(i[e]))return;let s=null===(n=t.getFields())||void 0===n?void 0:n[i[e]];s&&s.lockStatisticsByDomain&&s.domain.forEach(t=>{o[t]=0}),t.latestData.forEach(t=>{om(i[e]).forEach(i=>{ej(t[i])||(ej(o[t[i]])&&(o[t[i]]=0),ej(r[e])||(o[t[i]]+=isNaN(parseFloat(t[r[e]]))?1:parseFloat(t[r[e]])))})})}),Object.keys(o).forEach((t,e)=>{let i={[s]:t};a&&(i[a]=o[t]),l.push(i)}),l};class zP extends Ea{get relatedAxisComponent(){return this._relatedAxisComponent}setStartAndEnd(t,e,i=["percent","percent"]){let[r="percent",n="percent"]=i,s="percent"===r?t:this.dataToStatePoint(t),a="percent"===n?e:this.dataToStatePoint(e);this._handleChange(s,a,!0)}enableInteraction(){this._activeRoam=!0}disableInteraction(){this._activeRoam=!1}zoomIn(t){this._handleChartZoom({zoomDelta:1.2,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})}zoomOut(t){this._handleChartZoom({zoomDelta:.8,zoomX:null==t?void 0:t.x,zoomY:null==t?void 0:t.y})}_handleChange(t,e,i){var r,n;null!==(n=null===(r=this._spec)||void 0===r?void 0:r.zoomLock)&&void 0!==n&&n||e-t!==this._spanCache&&(e-t<this._minSpan||e-t>this._maxSpan)?this._shouldChange=!1:(this._shouldChange=!0,this._spanCache=e-t)}_isReverse(){let t=this._relatedAxisComponent;if(!t)return!1;let e=t.getScale();return e.range()[0]>e.range()[1]&&(!t.getInverse()||this._isHorizontal)}_updateRangeFactor(t){let e=this._relatedAxisComponent.getScale(),i=this._isReverse(),r=i?[1-this._end,1-this._start]:[this._start,this._end];if(i)switch(t){case"startHandler":e.rangeFactorEnd(r[1]);break;case"endHandler":e.rangeFactorStart(r[0]);break;default:e.rangeFactorStart(r[0],!0),e.rangeFactorEnd(r[1])}else switch(t){case"startHandler":e.rangeFactorStart(r[0]);break;case"endHandler":e.rangeFactorEnd(r[1]);break;default:e.rangeFactorEnd(r[1],!0),e.rangeFactorStart(r[0])}let n=e.rangeFactor();n?(this._start=i?1-n[1]:n[0],this._end=i?1-n[0]:n[1]):(this._start=0,this._end=1)}get visible(){return this._visible}constructor(t,e){super(t,e),this.layoutType="none",this._orient="left",this._cacheVisibility=void 0,this._dataUpdating=!1,this._shouldChange=!0,this._stateField="x",this._activeRoam=!0,this._zoomAttr={enable:!0,rate:1,focus:!0},this._dragAttr={enable:!0,rate:1,reverse:!0},this._scrollAttr={enable:!0,rate:1,reverse:!0},this.effect={onZoomChange:t=>{var e,i;let r=this._relatedAxisComponent;if(r&&"axis"===this._filterMode){let n=r.getScale(),s=r.getSpec();this._auto&&this._getAxisBandSize(s)&&this._spec.ignoreBandSize&&(n.bandwidth("auto"),n.maxBandwidth("auto"),n.minBandwidth("auto")),this._updateRangeFactor(t),this._auto&&(null===(i=null===(e=this._component)||void 0===e?void 0:e.setStartAndEnd)||void 0===i||i.call(e,this._start,this._end)),r.effect.scaleUpdate()}else dC(this._regions,t=>{var e;null===(e=t.getViewData())||void 0===e||e.markRunning()},{userId:this._seriesUserId,specIndex:this._seriesIndex}),dC(this._regions,t=>{t.reFilterViewData()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._visible=!0,this._handleStateChange=(t,e,i)=>{var r,n;return this._startValue=t,this._endValue=e,this._newDomain=this._parseDomainFromState(this._startValue,this._endValue),null===(n=(r=this.effect).onZoomChange)||void 0===n||n.call(r,i),!0},this._handleChartZoom=t=>{var e,i;if(!this._activeRoam)return;let{zoomDelta:r,zoomX:n,zoomY:s}=t,{x:a,y:o}=this._regions[0].getLayoutStartPoint(),{width:l,height:h}=this._regions[0].getLayoutRect(),u=Math.abs(this._start-this._end),d=null!==(i=null===(e=this._spec.roamZoom)||void 0===e?void 0:e.rate)&&void 0!==i?i:1;if(u>=1&&r<1||u<=.01&&r>1)return;let c=this._isHorizontal?n:s,p=u*(r-1)*d,g=p/2,f=p/2;if(c){let t=this._isHorizontal?a:o,e=this._isHorizontal?l:h;g=Math.abs(t-c)/Math.abs(e-t)*p,f=Math.abs(e-c)/Math.abs(e-t)*p}let m=nL(this._start+g,0,1),v=nL(this._end-f,0,1);this._handleChange(Math.min(m,v),Math.max(m,v),!0)},this._handleChartScroll=(t,e)=>{var i;if(!this._activeRoam)return!1;let{scrollX:r,scrollY:n}=t,s=this._isHorizontal?r:n,a=this._isHorizontal?ia(r/n)>=.5:ia(n/r)>=.5;this._scrollAttr.reverse||(s=-s),a&&this._handleChartMove(s,null!==(i=this._scrollAttr.rate)&&void 0!==i?i:1);let o=0!==this._start&&1!==this._end;return a&&o},this._handleChartDrag=(t,e)=>{var i;if(!this._activeRoam)return;let[r,n]=t,s=this._isHorizontal?r:n;this._dragAttr.reverse&&(s=-s),this._handleChartMove(s,null!==(i=this._dragAttr.rate)&&void 0!==i?i:1)},this._handleChartMove=(t,e)=>{let i=this._isHorizontal?this.getLayoutRect().width:this.getLayoutRect().height;if(Math.abs(t)>=1e-6){if(t>0&&this._end<1){let r=Math.min(1-this._end,t/i)*e;this._handleChange(this._start+r,this._end+r,!0)}else if(t<0&&this._start>0){let r=Math.max(-this._start,t/i)*e;this._handleChange(this._start+r,this._end+r,!0)}}return!1},this._orient=dL(t),this._isHorizontal="horizontal"===dD(this._orient)}created(){super.created(),this._setAxisFromSpec(),this._setRegionsFromSpec(),this._initEvent(),this._initData(),this._initStateScale(),this._setStateFromSpec()}initLayout(){super.initLayout(),this._layout&&(this._layout.layoutOrient=this._orient)}_setAxisFromSpec(){if(eO(this._spec.axisId)?this._relatedAxisComponent=this._option.getComponentByUserId(this._spec.axisId):eO(this._spec.axisIndex)&&(this._relatedAxisComponent=this._option.getComponentByIndex("axes",this._spec.axisIndex)),ej(this._spec.field)&&!this._relatedAxisComponent){let t=this._option.getComponentsByKey("axes"),e=t.find(t=>t._orient===this._orient);if(e)this._relatedAxisComponent=e;else{let e=t.find(t=>!dr(t.getScale().type));this._relatedAxisComponent=e}}this._relatedAxisComponent&&"axis"===this._filterMode&&(this._relatedAxisComponent.autoIndentOnce=!0)}_setRegionsFromSpec(){var t,e;this._regions=this._relatedAxisComponent?this._relatedAxisComponent.getRegions():this._option.getAllRegions();let i=this._relatedAxisComponent?null===(e=(t=this._relatedAxisComponent).getBindSeriesFilter)||void 0===e?void 0:e.call(t):null;if(eO(i)&&(eO(i.userId)&&(this._seriesUserId=om(i.userId)),eO(i.specIndex)&&(this._seriesIndex=om(i.specIndex))),eO(this._spec.seriesId)){let t=om(this._spec.seriesId);this._seriesUserId?this._seriesUserId=this._seriesUserId.filter(e=>t.includes(e)):this._seriesUserId=t}if(eO(this._spec.seriesIndex)){let t=om(this._spec.seriesIndex);this._seriesIndex?this._seriesIndex=this._seriesIndex.filter(e=>t.includes(e)):this._seriesIndex=t}if(eO(this._spec.regionIndex)){let t=this._option.getRegionsInIndex(om(this._spec.regionIndex));this._regions=this._regions.filter(e=>t.includes(e))}else if(eO(this._spec.regionId)){let t=om(this._spec.regionId);this._regions=t.length?this._regions.filter(e=>t.includes(e.id)):[]}}onDataUpdate(){var t;let e=this._computeDomainOfStateScale(dr(this._stateScale.type));this._stateScale.domain(e,!1),this._handleChange(this._start,this._end,!0),this._spec.auto&&(this._dataUpdating=!0,null===(t=this.getChart())||void 0===t||t.setLayoutTag(!0,null,!1))}_computeDomainOfStateScale(t){if(this._spec.customDomain)return this._spec.customDomain;let e=this._data.getLatestData().map(t=>t[this._stateField]);if(t){let t=e.map(t=>1*t);return e.length?[o_(t),oy(t)]:[-Infinity,1/0]}return e}_initEvent(){this._initCommonEvent()}_initData(){let t=[],e=[],i=[];if(this._relatedAxisComponent){let r={};dC(this._regions,n=>{var s,a;let o="cartesian"===n.coordinate?n.getXAxisHelper():"polar"===n.coordinate?n.angleAxisHelper:null,l="cartesian"===n.coordinate?n.getYAxisHelper():"polar"===n.coordinate?n.radiusAxisHelper:null;if(!o||!l)return;let h=o.getAxisId()===this._relatedAxisComponent.id?o:l.getAxisId()===this._relatedAxisComponent.id?l:this._isHorizontal?o:l,u=h===o?l:o,d=dr(u.getScale(0).type);t.push(n.getRawData());let c=n.getSpec(),p=om(c.xField),g=om(c.yField),f="cartesian"===n.coordinate?p[0]:null!==(s=c.angleField)&&void 0!==s?s:c.categoryField,m="cartesian"===n.coordinate?g[0]:null!==(a=c.radiusField)&&void 0!==a?a:c.valueField;if(r[n.id]="link"===n.type?"from_xField":h===o?f:m,e.push(r[n.id]),this._valueField){let t="link"===n.type?"from_yField":u===o?f:m;i.push(d?t:null)}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._originalStateFields=r}else dC(this._regions,r=>{t.push(r.getRawData()),e.push(this._field),this._valueField&&i.push(this._spec.valueField)},{userId:this._seriesUserId,specIndex:this._seriesIndex});let{dataSet:r}=this._option;gM(r,"dataview",eC),gw(r,"dataFilterComputeDomain",zO);let n=new eH(r,{name:`${this.type}_${this.id}_data`});n.transform({type:"dataFilterComputeDomain",options:{input:{dataCollection:t,stateFields:e,valueFields:i},output:{stateField:this._stateField,valueField:this._valueField}}},!1),this._data=new Sa(this._option,n),n.reRunAllTransform(),r.multipleDataViewAddListener(t,"change",this._handleDataCollectionChange.bind(this))}setAttrFromSpec(){var t;super.setAttrFromSpec(),!0===this._spec.roamZoom||this._spec.roamZoom?this._zoomAttr=eF({},this._zoomAttr,this._spec.roamZoom):this._zoomAttr.enable=!1,!0===this._spec.roamDrag||this._spec.roamDrag?this._dragAttr=eF({},this._dragAttr,this._spec.roamDrag):this._dragAttr.enable=!1,!0===this._spec.roamScroll||this._spec.roamScroll?this._scrollAttr=eF({},this._scrollAttr,this._spec.roamScroll):this._scrollAttr.enable=!1,this._field=this._spec.field,this._width=this._computeWidth(),this._height=this._computeHeight(),this._visible=null===(t=this._spec.visible)||void 0===t||t}_statePointToData(t){let e=this._stateScale,i=e.domain();if(dr(e.type))return this._isReverse()?i[0]+(i[1]-i[0])*(1-t):i[0]+(i[1]-i[0])*t;let r=e.range();this._isReverse()&&(r=r.slice().reverse());let n=r[0]+(r[1]-r[0])*t;return e.invert(n)}dataToStatePoint(t){let e=this._stateScale,i=e.scale(t),r=e.range();return!this._isHorizontal&&dr(e.type)&&(r=r.slice().reverse()),(i-r[0])/(r[1]-r[0])}_modeCheck(t,e){return"start"===t?"percent"===e&&this._spec.start||"value"===e&&this._spec.startValue:"percent"===e&&this._spec.end||"value"===e&&this._spec.endValue}_setStateFromSpec(){var t,e;let i,r;if(this._auto=!!this._spec.auto,this._spec.rangeMode){let[t,e]=this._spec.rangeMode;this._modeCheck("start",t)&&this._modeCheck("end",e)&&(i="percent"===t?this._spec.start:this.dataToStatePoint(this._spec.startValue),r="percent"===e?this._spec.end:this.dataToStatePoint(this._spec.endValue))}else i=this._spec.start?this._spec.start:this._spec.startValue?this.dataToStatePoint(this._spec.startValue):0,r=this._spec.end?this._spec.end:this._spec.endValue?this.dataToStatePoint(this._spec.endValue):1;this._startValue=this._statePointToData(i),this._endValue=this._statePointToData(r),this._start=i,this._end=r,this._minSpan=null!==(t=this._spec.minSpan)&&void 0!==t?t:0,this._maxSpan=null!==(e=this._spec.maxSpan)&&void 0!==e?e:1,dr(this._stateScale.type)&&this._stateScale.domain()[0]!==this._stateScale.domain()[1]&&(this._spec.minValueSpan&&(this._minSpan=this._spec.minValueSpan/(this._stateScale.domain()[1]-this._stateScale.domain()[0])),this._spec.maxValueSpan&&(this._maxSpan=this._spec.maxValueSpan/(this._stateScale.domain()[1]-this._stateScale.domain()[0]))),this._minSpan=Math.max(0,this._minSpan),this._maxSpan=Math.min(this._maxSpan,1),this._relatedAxisComponent&&"axis"===this._filterMode||0===this._start&&1===this._end||(this._newDomain=this._parseDomainFromState(this._startValue,this._endValue))}_parseFieldOfSeries(t){var e;return null===(e=this._originalStateFields)||void 0===e?void 0:e[t.id]}_initStateScale(){let t=[0,1];if(this._relatedAxisComponent){let e=this._relatedAxisComponent.getScale(),i=dr(e.type),r=this._computeDomainOfStateScale(i);if(this._stateScale=e.clone(),i){let e=r.map(t=>1*t);this._stateScale.domain(r.length?[o_(e),oy(e)]:[0,1],!0).range(t)}else this._stateScale.domain(r,!0).range(t)}else this._stateScale=new x8,this._stateScale.domain(this._computeDomainOfStateScale(),!0).range(t)}init(t){super.init(t),this._addTransformToSeries(),0===this._start&&1===this._end||this.effect.onZoomChange()}_addTransformToSeries(){this._relatedAxisComponent&&"axis"===this._filterMode||(gw(this._option.dataSet,"dataFilterWithNewDomain",zE),dC(this._regions,t=>{t.addViewDataFilter({type:"dataFilterWithNewDomain",options:{getNewDomain:()=>this._newDomain,field:()=>{var e;return null!==(e=this._field)&&void 0!==e?e:this._parseFieldOfSeries(t)},isContinuous:()=>dr(this._stateScale.type)},level:ty.dataZoomFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex}))}onRender(t){}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reMake||my(e,t)||(i.reRender=!0,i.reMake=!0),i}reInit(t){super.reInit(t),this._marks.forEach(t=>{t.getMarks().forEach(t=>{this.initMarkStyleWithSpec(t,this._spec[t.name])})})}changeRegions(){}update(t){}resize(t){}_parseDomainFromState(t,e){if(dr(this._stateScale.type))return[Math.min(e,t),Math.max(e,t)];let i=this._stateScale.domain(),r=i.indexOf(t),n=i.indexOf(e);return i.slice(Math.min(r,n),Math.max(r,n)+1)}_initCommonEvent(){var t,e,i,r,n,s,a;let o={delayType:null!==(e=null===(t=this._spec)||void 0===t?void 0:t.delayType)&&void 0!==e?e:"throttle",delayTime:eO(null===(i=this._spec)||void 0===i?void 0:i.delayType)?null!==(n=null===(r=this._spec)||void 0===r?void 0:r.delayTime)&&void 0!==n?n:30:0,realTime:null===(a=null===(s=this._spec)||void 0===s?void 0:s.realTime)||void 0===a||a};this._zoomAttr.enable&&this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom,o),this._scrollAttr.enable&&this.initScrollEventOfRegions(this._regions,null,this._handleChartScroll,o),this._dragAttr.enable&&this.initDragEventOfRegions(this._regions,null,this._handleChartDrag,o)}updateLayoutAttribute(){this._visible&&this._createOrUpdateComponent(),super.updateLayoutAttribute()}onLayoutStart(t,e,i){super.onLayoutStart(t,e,i);let r=this._autoUpdate(t),n=this._isHorizontal?"height":"width";this.layout.setLayoutRect({[n]:r?this[`_${n}`]:0},{[n]:tw.Built_In}),this._dataUpdating=!1}getBoundsInRect(t){let e={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0};return this._isHorizontal?(e.y2=e.y1+this._height,e.x2=e.x1+t.width):(e.x2=e.x1+this._width,e.y2=e.y1+t.height),e}hide(){var t;null===(t=this._component)||void 0===t||t.hideAll()}show(){var t;null===(t=this._component)||void 0===t||t.showAll()}_getAxisBandSize(t){let e=null==t?void 0:t.bandSize,i=null==t?void 0:t.maxBandSize,r=null==t?void 0:t.minBandSize;if(e||r||i)return{bandSize:e,maxBandSize:i,minBandSize:r}}_autoUpdate(t){var e,i,r,n,s,a;if(!this._auto)return this._cacheVisibility=void 0,!0;let o=this._relatedAxisComponent,l=null==o?void 0:o.getSpec(),h=null==o?void 0:o.getScale(),u=this._getAxisBandSize(l);if(!this._dataUpdating&&ds(h.type)&&(null==t?void 0:t.height)===(null===(e=this._cacheRect)||void 0===e?void 0:e.height)&&(null==t?void 0:t.width)===(null===(i=this._cacheRect)||void 0===i?void 0:i.width)&&this._fixedBandSize===(null==u?void 0:u.bandSize))return this._cacheVisibility;let d=!0;if(this._isHorizontal&&(null==t?void 0:t.width)!==(null===(r=this._cacheRect)||void 0===r?void 0:r.width)?h.range(o.getInverse()?[t.width,0]:[0,t.width]):(null==t?void 0:t.height)!==(null===(n=this._cacheRect)||void 0===n?void 0:n.height)&&h.range(o.getInverse()?[0,t.height]:[t.height,0]),this._cacheRect={width:null==t?void 0:t.width,height:null==t?void 0:t.height},this._fixedBandSize=null==u?void 0:u.bandSize,ds(h.type)){u&&(this._start||this._end)&&(this.type===lx.scrollBar&&(this._start=0,this._end=1),this._updateRangeFactor());let[t,e]=null!==(s=h.rangeFactor())&&void 0!==s?s:[];d=(!ej(t)||!ej(e))&&!(0===t&&1===e)}else{let[t,e]=null!==(a=h.rangeFactor())&&void 0!==a?a:[this._start,this._end];d=!(0===t&&1===e)}return this.setStartAndEnd(this._start,this._end),d?this.show():this.hide(),this._cacheVisibility=d,d}_getNeedClearVRenderComponents(){return[this._component]}}CS(zP,RH);let zR="M -0.0544 0.25 C -0.0742 0.25 -0.0901 0.234 -0.0901 0.2143 L -0.0901 -0.1786 C -0.0901 -0.1983 -0.0742 -0.2143 -0.0544 -0.2143 L -0.0187 -0.2143 L -0.0187 -0.5 L 0.017 -0.5 L 0.017 -0.2143 L 0.0527 -0.2143 C 0.0724 -0.2143 0.0884 -0.1983 0.0884 -0.1786 L 0.0884 0.2143 C 0.0884 0.234 0.0724 0.25 0.0527 0.25 L 0.017 0.25 L 0.017 0.5 L -0.0187 0.5 L -0.0187 0.25 L -0.0544 0.25 Z M -0.0187 -0.1429 L -0.0544 -0.1429 L -0.0544 0.1786 L -0.0187 0.1786 L -0.0187 -0.1429 Z M 0.0527 -0.1429 L 0.017 -0.1429 L 0.017 0.1786 L 0.0527 0.1786 L 0.0527 -0.1429 Z",zB={horizontal:{angle:0,strokeBoundsBuffer:0,boundsPadding:2,pickMode:"imprecise",cursor:"ew-resize"},vertical:{angle:Math.PI/180*90,cursor:"ns-resize",boundsPadding:2,pickMode:"imprecise",strokeBoundsBuffer:0}};(tY=er||(er={})).startHandler="startHandler",tY.endHandler="endHandler",tY.middleHandler="middleHandler",tY.background="background";var zI=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let zL={debounce:l3,throttle:dJ};Em(),bp(),_2(),ki(),kP();class zD extends Eu{setPropsFromAttrs(){let{start:t,end:e,orient:i,previewData:r,previewPointsX:n,previewPointsY:s,previewPointsX1:a,previewPointsY1:o}=this.attribute;t&&(this.state.start=t),e&&(this.state.end=e);let{width:l,height:h}=this.getLayoutAttrFromConfig();this._spanCache=this.state.end-this.state.start,this._isHorizontal="top"===i||"bottom"===i,this._layoutCache.max=this._isHorizontal?l:h,this._layoutCache.attPos=this._isHorizontal?"x":"y",this._layoutCache.attSize=this._isHorizontal?"width":"height",r&&(this._previewData=r),nx(n)&&(this._previewPointsX=n),nx(s)&&(this._previewPointsY=s),nx(a)&&(this._previewPointsX1=a),nx(o)&&(this._previewPointsY1=o)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},zD.defaultAttributes,t)),this.name="dataZoom",this._previewData=[],this._activeState=!1,this._activeCache={startPos:{x:0,y:0},lastPos:{x:0,y:0}},this._layoutCache={attPos:"x",attSize:"width",max:0},this.state={start:0,end:1},this._statePointToData=t=>t,this._onHandlerPointerDown=(t,e)=>{t.stopPropagation(),"start"===e?(this._activeTag=er.startHandler,this._activeItem=this._startHandlerMask):"end"===e?(this._activeTag=er.endHandler,this._activeItem=this._endHandlerMask):"middleRect"===e?(this._activeTag=er.middleHandler,this._activeItem=this._middleHandlerRect):"middleSymbol"===e?(this._activeTag=er.middleHandler,this._activeItem=this._middleHandlerSymbol):"background"===e&&(this._activeTag=er.background,this._activeItem=this._background),this._activeState=!0,this._activeCache.startPos=this.eventPosToStagePos(t),this._activeCache.lastPos=this.eventPosToStagePos(t),"browser"===lX.env&&(lX.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),lX.addEventListener("pointerup",this._onHandlerPointerUp)),this.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0})},this._pointerMove=t=>{t.stopPropagation();let{start:e,end:i,brushSelect:r,realTime:n=!0}=this.attribute,s=this.eventPosToStagePos(t),{attPos:a,max:o}=this._layoutCache,l=(s[a]-this._activeCache.lastPos[a])/o,{start:h,end:u}=this.state;this._activeState&&(this._activeTag===er.middleHandler?this.moveZoomWithMiddle((this.state.start+this.state.end)/2+l):this._activeTag===er.startHandler?h+l>u?(u=(h=u)+l,this._activeTag=er.endHandler):h+=l:this._activeTag===er.endHandler&&(u+l<h?(h=(u=h)+l,this._activeTag=er.startHandler):u+=l),this._activeCache.lastPos=s,r&&this.renderDragMask()),h=Math.min(Math.max(h,0),1),u=Math.min(Math.max(u,0),1),e===h&&i===u||(this.setStateAttr(h,u,!0),n&&this._dispatchEvent("change",{start:h,end:u,tag:this._activeTag}))},this._onHandlerPointerMove=0===this.attribute.delayTime?this._pointerMove:zL[this.attribute.delayType](this._pointerMove,this.attribute.delayTime),this._onHandlerPointerUp=t=>{t.preventDefault();let{start:e,end:i,brushSelect:r,realTime:n=!0}=this.attribute;if(this._activeState&&this._activeTag===er.background){let e=this.eventPosToStagePos(t);this.backgroundDragZoom(this._activeCache.startPos,e)}this._activeState=!1,r&&this.renderDragMask(),e===this.state.start&&i===this.state.end||(this.setStateAttr(this.state.start,this.state.end,!0),this._dispatchEvent("change",{start:this.state.start,end:this.state.end,tag:this._activeTag})),"browser"===lX.env&&(lX.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),lX.removeEventListener("pointerup",this._onHandlerPointerUp)),this.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.removeEventListener("pointerup",this._onHandlerPointerUp)};let{position:i,showDetail:r}=t;this._activeCache.startPos=i,this._activeCache.lastPos=i,this._showText="auto"!==r&&r,this.setPropsFromAttrs()}setAttributes(t,e){super.setAttributes(t,e),this.setPropsFromAttrs()}bindEvents(){if(this.attribute.disableTriggerEvent)return void this.setAttribute("childrenPickable",!1);let{showDetail:t,brushSelect:e}=this.attribute;this._startHandlerMask&&this._startHandlerMask.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"start")),this._endHandlerMask&&this._endHandlerMask.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"end")),this._middleHandlerSymbol&&this._middleHandlerSymbol.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"middleSymbol")),this._middleHandlerRect&&this._middleHandlerRect.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"middleRect"));let i=e?"background":"middleRect";this._selectedBackground&&this._selectedBackground.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,i)),e&&this._background&&this._background.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"background")),e&&this._previewGroup&&this._previewGroup.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,"background")),this._selectedPreviewGroup&&this._selectedPreviewGroup.addEventListener("pointerdown",t=>this._onHandlerPointerDown(t,i)),this.addEventListener("pointerup",this._onHandlerPointerUp),this.addEventListener("pointerupoutside",this._onHandlerPointerUp),"auto"===t&&(this.addEventListener("pointerenter",this._onHandlerPointerEnter),this.addEventListener("pointerleave",this._onHandlerPointerLeave))}dragMaskSize(){let{position:t}=this.attribute,{attPos:e,max:i}=this._layoutCache;return this._activeCache.lastPos[e]-t[e]>i?i+t[e]-this._activeCache.startPos[e]:this._activeCache.lastPos[e]-t[e]<0?t[e]-this._activeCache.startPos[e]:this._activeCache.lastPos[e]-this._activeCache.startPos[e]}setStateAttr(t,e,i){let{zoomLock:r=!1,minSpan:n=0,maxSpan:s=1}=this.attribute,a=e-t;a!==this._spanCache&&(r||a<n||a>s)||(this._spanCache=a,this.state.start=t,this.state.end=e,i&&this.setAttributes({start:t,end:e}))}eventPosToStagePos(t){return this.stage.eventPointTransform(t)}_onHandlerPointerEnter(t){t.stopPropagation(),this._showText=!0,this.renderText()}_onHandlerPointerLeave(t){t.stopPropagation(),this._showText=!1,this.renderText()}backgroundDragZoom(t,e){let{attPos:i,max:r}=this._layoutCache,{position:n}=this.attribute,s=t[i]-n[i],a=e[i]-n[i],o=Math.min(Math.max(Math.min(s,a)/r,0),1),l=Math.min(Math.max(Math.max(s,a)/r,0),1);.01>Math.abs(o-l)?this.moveZoomWithMiddle(o):this.setStateAttr(o,l,!1)}moveZoomWithMiddle(t){let e=t-(this.state.start+this.state.end)/2;0!==e&&(e>0?this.state.end+e>1&&(e=1-this.state.end):e<0&&this.state.start+e<0&&(e=-this.state.start),this.setStateAttr(this.state.start+e,this.state.end+e,!1))}renderDragMask(){let{dragMaskStyle:t}=this.attribute,{position:e,width:i,height:r}=this.getLayoutAttrFromConfig();this._isHorizontal?this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:nL(0>this.dragMaskSize()?this._activeCache.lastPos.x:this._activeCache.startPos.x,e.x,e.x+i),y:e.y,width:this._activeState&&this._activeTag===er.background&&Math.abs(this.dragMaskSize())||0,height:r},t),"rect"):this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:e.x,y:nL(0>this.dragMaskSize()?this._activeCache.lastPos.y:this._activeCache.startPos.y,e.y,e.y+r),width:i,height:this._activeState&&this._activeTag===er.background&&Math.abs(this.dragMaskSize())||0},t),"rect")}isTextOverflow(t,e,i){if(!e)return!1;if(this._isHorizontal){if("start"===i){if(e.x1<t.x1)return!0}else if(e.x2>t.x2)return!0}else if("start"===i){if(e.y1<t.y1)return!0}else if(e.y2>t.y2)return!0;return!1}setTextAttr(t,e){let i,r,n,s;let{startTextStyle:a,endTextStyle:o}=this.attribute,{formatMethod:l}=a,h=zI(a,["formatMethod"]),{formatMethod:u}=o,d=zI(o,["formatMethod"]),{start:c,end:p}=this.state;this._startValue=this._statePointToData(c),this._endValue=this._statePointToData(p);let{position:g,width:f,height:m}=this.getLayoutAttrFromConfig(),v=l?l(this._startValue):this._startValue,y=u?u(this._endValue):this._endValue,_={x1:g.x,y1:g.y,x2:g.x+f,y2:g.y+m};this._isHorizontal?(i={x:g.x+c*f,y:g.y+m/2},r={x:g.x+p*f,y:g.y+m/2},n={textAlign:this.isTextOverflow(_,t,"start")?"left":"right",textBaseline:"middle"},s={textAlign:this.isTextOverflow(_,e,"end")?"right":"left",textBaseline:"middle"}):(i={x:g.x+f/2,y:g.y+c*m},r={x:g.x+f/2,y:g.y+p*m},n={textAlign:"center",textBaseline:this.isTextOverflow(_,t,"start")?"top":"bottom"},s={textAlign:"center",textBaseline:this.isTextOverflow(_,e,"end")?"bottom":"top"}),this._startText=this.maybeAddLabel(this._container,eF({},h,{text:v,x:i.x,y:i.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:n}),`data-zoom-start-text-${g}`),this._endText=this.maybeAddLabel(this._container,eF({},d,{text:y,x:r.x,y:r.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:s}),`data-zoom-end-text-${g}`)}renderText(){let t=null,e=null;this.setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds,this.setTextAttr(t,e),t=this._startText.AABBBounds,e=this._endText.AABBBounds;let{x1:i,x2:r,y1:n,y2:s}=t,{dx:a=0,dy:o=0}=this.attribute.startTextStyle;if((new iB).set(i,n,r,s).intersects(e)){let t="bottom"===this.attribute.orient||"right"===this.attribute.orient?-1:1;this._isHorizontal?this._startText.setAttribute("dy",o+t*Math.abs(e.y1-e.y2)):this._startText.setAttribute("dx",a+t*Math.abs(e.x1-e.x2))}else this._isHorizontal?this._startText.setAttribute("dy",o):this._startText.setAttribute("dx",a)}getLayoutAttrFromConfig(){var t,e,i,r,n,s;let a,o,l;if(this._layoutAttrFromConfig)return this._layoutAttrFromConfig;let{position:h,size:u,orient:d,middleHandlerStyle:c={},startHandlerStyle:p={},endHandlerStyle:g={},backgroundStyle:f={}}=this.attribute,{width:m,height:v}=u,y=null!==(e=null===(t=c.background)||void 0===t?void 0:t.size)&&void 0!==e?e:10;c.visible?this._isHorizontal?(a=m,o=v-y,l={x:h.x,y:h.y+y}):(a=m-y,o=v,l={x:h.x+("left"===d?y:0),y:h.y}):(a=m,o=v,l=h);let _=null!==(i=p.size)&&void 0!==i?i:this._isHorizontal?o:a,b=null!==(r=g.size)&&void 0!==r?r:this._isHorizontal?o:a;return p.visible&&(this._isHorizontal?(a-=(_+b)/2,l={x:l.x+_/2,y:l.y}):(o-=(_+b)/2,l={x:l.x,y:l.y+_/2})),o+=(n=f.lineWidth/2,n),a+=(s=f.lineWidth/2,s),this._layoutAttrFromConfig={position:l,width:a,height:o},this._layoutAttrFromConfig}render(){var t,e,i,r,n,s,a,o,l,h,u,d,c,p,g,f,m,v,y,_,b,x,S,k,A,w,M,C,T,E,O,P,R,B;this._layoutAttrFromConfig=null;let{orient:I,backgroundStyle:L,backgroundChartStyle:D={},selectedBackgroundStyle:F={},selectedBackgroundChartStyle:j={},middleHandlerStyle:N={},startHandlerStyle:z={},endHandlerStyle:H={},brushSelect:V,zoomLock:W}=this.attribute,{start:G,end:U}=this.state,{position:$,width:Y,height:K}=this.getLayoutAttrFromConfig(),Z=null!==(t=z.triggerMinSize)&&void 0!==t?t:40,X=null!==(e=H.triggerMinSize)&&void 0!==e?e:40,q=this.createOrUpdateChild("dataZoom-container",{},"group");if(this._container=q,this._background=q.createOrUpdateChild("background",Object.assign(Object.assign({x:$.x,y:$.y,width:Y,height:K,cursor:V?"crosshair":"auto"},L),{pickable:!W&&(null===(i=L.pickable)||void 0===i||i)}),"rect"),(null===(r=D.line)||void 0===r?void 0:r.visible)&&this.setPreviewAttributes("line",q),(null===(n=D.area)||void 0===n?void 0:n.visible)&&this.setPreviewAttributes("area",q),V&&this.renderDragMask(),this._isHorizontal?this._selectedBackground=q.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:$.x+G*Y,y:$.y,width:(U-G)*Y,height:K,cursor:V?"crosshair":"move"},F),{pickable:!W&&(null===(s=j.pickable)||void 0===s||s)}),"rect"):this._selectedBackground=q.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:$.x,y:$.y+G*K,width:Y,height:(U-G)*K,cursor:V?"crosshair":"move"},F),{pickable:!W&&(null===(a=F.pickable)||void 0===a||a)}),"rect"),(null===(o=j.line)||void 0===o?void 0:o.visible)&&this.setSelectedPreviewAttributes("line",q),(null===(l=j.area)||void 0===l?void 0:l.visible)&&this.setSelectedPreviewAttributes("area",q),this._isHorizontal){if(N.visible){let t=(null===(h=N.background)||void 0===h?void 0:h.size)||10;this._middleHandlerRect=q.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:$.x+G*Y,y:$.y-t,width:(U-G)*Y,height:t},null===(u=N.background)||void 0===u?void 0:u.style),{pickable:!W&&(null===(p=null===(c=null===(d=N.background)||void 0===d?void 0:d.style)||void 0===c?void 0:c.pickable)||void 0===p||p)}),"rect"),this._middleHandlerSymbol=q.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:$.x+(G+U)/2*Y,y:$.y-t/2,strokeBoundsBuffer:0,angle:0,symbolType:null!==(f=null===(g=N.icon)||void 0===g?void 0:g.symbolType)&&void 0!==f?f:"square"},N.icon),{pickable:!W&&(null===(m=N.icon.pickable)||void 0===m||m)}),"symbol")}this._startHandler=q.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:$.x+G*Y,y:$.y+K/2,size:K,symbolType:null!==(v=z.symbolType)&&void 0!==v?v:"square"},zB.horizontal),z),{pickable:!W&&(null===(y=z.pickable)||void 0===y||y)}),"symbol"),this._endHandler=q.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:$.x+U*Y,y:$.y+K/2,size:K,symbolType:null!==(_=H.symbolType)&&void 0!==_?_:"square"},zB.horizontal),H),{pickable:!W&&(null===(b=H.pickable)||void 0===b||b)}),"symbol");let t=Math.max(this._startHandler.AABBBounds.width(),Z),e=Math.max(this._startHandler.AABBBounds.height(),Z),i=Math.max(this._endHandler.AABBBounds.width(),X),r=Math.max(this._endHandler.AABBBounds.height(),X);this._startHandlerMask=q.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:$.x+G*Y-t/2,y:$.y+K/2-e/2,width:t,height:e,fill:"white",fillOpacity:0,zIndex:999},zB.horizontal),{pickable:!W}),"rect"),this._endHandlerMask=q.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:$.x+U*Y-i/2,y:$.y+K/2-r/2,width:i,height:r,fill:"white",fillOpacity:0,zIndex:999},zB.horizontal),{pickable:!W}),"rect")}else{if(N.visible){let t=(null===(x=N.background)||void 0===x?void 0:x.size)||10;this._middleHandlerRect=q.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:"left"===I?$.x-t:$.x+Y,y:$.y+G*K,width:t,height:(U-G)*K},null===(S=N.background)||void 0===S?void 0:S.style),{pickable:!W&&(null===(w=null===(A=null===(k=N.background)||void 0===k?void 0:k.style)||void 0===A?void 0:A.pickable)||void 0===w||w)}),"rect"),this._middleHandlerSymbol=q.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:"left"===I?$.x-t/2:$.x+Y+t/2,y:$.y+(G+U)/2*K,angle:Math.PI/180*90,symbolType:null!==(C=null===(M=N.icon)||void 0===M?void 0:M.symbolType)&&void 0!==C?C:"square",strokeBoundsBuffer:0},N.icon),{pickable:!W&&(null===(E=null===(T=N.icon)||void 0===T?void 0:T.pickable)||void 0===E||E)}),"symbol")}this._startHandler=q.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:$.x+Y/2,y:$.y+G*K,size:Y,symbolType:null!==(O=z.symbolType)&&void 0!==O?O:"square"},zB.vertical),z),{pickable:!W&&(null===(P=z.pickable)||void 0===P||P)}),"symbol"),this._endHandler=q.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:$.x+Y/2,y:$.y+U*K,size:Y,symbolType:null!==(R=H.symbolType)&&void 0!==R?R:"square"},zB.vertical),H),{pickable:!W&&(null===(B=H.pickable)||void 0===B||B)}),"symbol");let t=Math.max(this._startHandler.AABBBounds.width(),Z),e=Math.max(this._startHandler.AABBBounds.height(),Z),i=Math.max(this._endHandler.AABBBounds.width(),X),r=Math.max(this._endHandler.AABBBounds.height(),X);this._startHandlerMask=q.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:$.x+Y/2+t/2,y:$.y+G*K-e/2,width:r,height:i,fill:"white",fillOpacity:0,zIndex:999},zB.vertical),{pickable:!W}),"rect"),this._endHandlerMask=q.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:$.x+Y/2+i/2,y:$.y+U*K-r/2,width:r,height:i,fill:"white",fillOpacity:0,zIndex:999},zB.vertical),{pickable:!W}),"rect")}this._showText&&this.renderText()}computeBasePoints(){let t,e;let{orient:i}=this.attribute,{position:r,width:n,height:s}=this.getLayoutAttrFromConfig();return this._isHorizontal?(t=[{x:r.x,y:r.y+s}],e=[{x:r.x+n,y:r.y+s}]):"left"===i?(t=[{x:r.x+n,y:r.y}],e=[{x:r.x+n,y:r.y+s}]):(t=[{x:r.x,y:r.y+s}],e=[{x:r.x,y:r.y}]),{basePointStart:t,basePointEnd:e}}simplifyPoints(t){var e;return t.length>1e4?function(t,e,i){if(t.length<=10)return t;let r=void 0!==e?e*e:1;return t=function(t,e){let i=t.length-1,r=[t[0]];return function t(e,i,r,n,s){let a,o,l,h=n,u=i,d=e[i].x,c=e[i].y,p=e[r].x-d,g=e[r].y-c,f=p*p+g*g;for(let t=i+1,n=r-1;t<n;t++)l=e[t].x-d,(o=(a=l*g-p*(e[t].y-c))*a/f)>h&&(h=o,u=t);h>n&&(u-i>2&&t(e,i,u,n,s),s.push(e[u],e[u+1]),r-u>2&&t(e,u,r,n,s))}(t,0,i,e,r),r.push(t[i]),r}(t=i?t:function(t,e){let i,r,n=t[0].x,s=t[0].y,a=[t[0]];for(let o=1,l=t.length;o<l;o++)i=t[o].x-n,i*i+(r=t[o].y-s)*r>e&&(n=t[o].x,s=t[o].y,a.push(t[o]));return t[t.length-1].x===n&&t[t.length-1].y===s||a.push(t[t.length-1]),a}(t,r),r)}(t,null!==(e=this.attribute.tolerance)&&void 0!==e?e:this._previewData.length/1e4,!1):t}getPreviewLinePoints(){let t=this._previewData.map(t=>({x:this._previewPointsX&&this._previewPointsX(t),y:this._previewPointsY&&this._previewPointsY(t)}));if(0===t.length)return t;t=this.simplifyPoints(t);let{basePointStart:e,basePointEnd:i}=this.computeBasePoints();return e.concat(t).concat(i)}getPreviewAreaPoints(){let t=this._previewData.map(t=>({x:this._previewPointsX&&this._previewPointsX(t),y:this._previewPointsY&&this._previewPointsY(t),x1:this._previewPointsX1&&this._previewPointsX1(t),y1:this._previewPointsY1&&this._previewPointsY1(t)}));if(0===t.length)return t;t=this.simplifyPoints(t);let{basePointStart:e,basePointEnd:i}=this.computeBasePoints();return e.concat(t).concat(i)}setPreviewAttributes(t,e){this._previewGroup||(this._previewGroup=e.createOrUpdateChild("previewGroup",{pickable:!1},"group")),"line"===t?this._previewLine=this._previewGroup.createOrUpdateChild("previewLine",{},"line"):this._previewArea=this._previewGroup.createOrUpdateChild("previewArea",{curveType:"basis"},"area");let{backgroundChartStyle:i={}}=this.attribute;"line"===t&&this._previewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},i.line)),"area"===t&&this._previewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},i.area))}setSelectedPreviewAttributes(t,e){this._selectedPreviewGroupClip||(this._selectedPreviewGroupClip=e.createOrUpdateChild("selectedPreviewGroupClip",{pickable:!1},"group"),this._selectedPreviewGroup=this._selectedPreviewGroupClip.createOrUpdateChild("selectedPreviewGroup",{},"group")),"line"===t?this._selectedPreviewLine=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewLine",{},"line"):this._selectedPreviewArea=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewArea",{curveType:"basis"},"area");let{selectedBackgroundChartStyle:i={}}=this.attribute,{start:r,end:n}=this.state,{position:s,width:a,height:o}=this.getLayoutAttrFromConfig();this._selectedPreviewGroupClip.setAttributes({x:this._isHorizontal?s.x+r*a:s.x,y:this._isHorizontal?s.y:s.y+r*o,width:this._isHorizontal?(n-r)*a:a,height:this._isHorizontal?o:(n-r)*o,clip:!0,pickable:!1}),this._selectedPreviewGroup.setAttributes({x:-(this._isHorizontal?s.x+r*a:s.x),y:-(this._isHorizontal?s.y:s.y+r*o),width:this._isHorizontal?(n-r)*a:a,height:this._isHorizontal?o:(n-r)*o,pickable:!1}),"line"===t&&this._selectedPreviewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},i.line)),"area"===t&&this._selectedPreviewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},i.area))}maybeAddLabel(t,e,i){let r=this.find(t=>t.name===i,!0);return r?r.setAttributes(e):(r=new Ey(e)).name=i,t.add(r),r}setStartAndEnd(t,e){let{start:i,end:r}=this.attribute;eO(t)&&eO(e)&&(t!==this.state.start||e!==this.state.end)&&(this.state.start=t,this.state.end=e,i===this.state.start&&r===this.state.end||(this.setStateAttr(t,e,!0),this._dispatchEvent("change",{start:t,end:e,tag:this._activeTag})))}setPreviewData(t){this._previewData=t}setText(t,e){"start"===e?this._startText.setAttribute("text",t):this._endText.setAttribute("text",t)}getStartValue(){return this._startValue}getEndTextValue(){return this._endValue}getMiddleHandlerSize(){var t,e,i,r;let{middleHandlerStyle:n={}}=this.attribute,s=null!==(e=null===(t=n.background)||void 0===t?void 0:t.size)&&void 0!==e?e:10;return Math.max(s,...om(null!==(r=null===(i=n.icon)||void 0===i?void 0:i.size)&&void 0!==r?r:10))}setPreviewPointsX(t){nx(t)&&(this._previewPointsX=t)}setPreviewPointsY(t){nx(t)&&(this._previewPointsY=t)}setPreviewPointsX1(t){nx(t)&&(this._previewPointsX1=t)}setPreviewPointsY1(t){nx(t)&&(this._previewPointsY1=t)}setStatePointToData(t){nx(t)&&(this._statePointToData=t)}}zD.defaultAttributes={orient:"bottom",showDetail:"auto",brushSelect:!0,zoomLock:!1,minSpan:0,maxSpan:1,delayType:"throttle",delayTime:0,realTime:!0,backgroundStyle:{fill:"white",stroke:"#D1DBEE",lineWidth:1,cornerRadius:2},dragMaskStyle:{fill:"#B0C8F9",fillOpacity:.2},backgroundChartStyle:{area:{visible:!0,stroke:"#D1DBEE",lineWidth:1,fill:"#F6F8FC"},line:{visible:!0,stroke:"#D1DBEE",lineWidth:1}},selectedBackgroundStyle:{fill:"#B0C8F9",fillOpacity:.5},selectedBackgroundChartStyle:{area:{visible:!0,stroke:"#B0C8F9",lineWidth:1,fill:"#fbb934"},line:{visible:!0,stroke:"#fbb934",lineWidth:1}},middleHandlerStyle:{visible:!0,background:{size:8,style:{fill:"white",stroke:"#B0C8F9",cornerRadius:2}},icon:{size:6,fill:"white",stroke:"#B0C8F9",symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}},startHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:zR,fill:"white",stroke:"#B0C8F9",lineWidth:.5},endHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:zR,fill:"white",stroke:"#B0C8F9",lineWidth:.5},startTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}},endTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}}};class zF extends En{_mergeThemeToSpec(t,e){let i=this._theme,r=t;if(this._shouldMergeThemeToSpec()){let e=t=>{let e=us({selectedBackgroundChart:{line:{},area:{}}},this._theme,t),{selectedBackgroundChart:i={}}=t,{line:r,area:n}=i;return r&&!1!==r.visible&&(e.selectedBackgroundChart.line.style=Object.assign(Object.assign({},e.selectedBackgroundChart.line.style),{visible:!0})),n&&!1!==n.visible&&(e.selectedBackgroundChart.area.style=Object.assign(Object.assign({},e.selectedBackgroundChart.area.style),{visible:!0})),e};r=eM(t)?t.map(t=>e(t)):e(t)}return this._adjustPadding(r),{spec:r,theme:i}}}class zj extends zP{static getSpecInfo(t){let e=t[this.specKey];if(ej(e))return;if(!eM(e))return[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.dataZoom}];let i=[];return e.forEach((t,e)=>{i.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:lx.dataZoom})}),i}constructor(t,e){var i;super(t,e),this.type=lx.dataZoom,this.name=lx.dataZoom,this.transformerConstructor=zF,this.specKey="dataZoom",this.layoutZIndex=tM.DataZoom,this.layoutLevel=tC.DataZoom,this.layoutType="region-relative",this._isReverseCache=!1,this._dataToPositionX=t=>{let e="left"===this._orient?this._middleHandlerSize:0,i=this._isHorizontal?this._startHandlerSize/2:0,r=this._isHorizontal?this._stateScale:this._valueScale,n=this._isHorizontal?this._stateField:this._valueField;return r.scale(t[n])+this.getLayoutStartPoint().x+e+i},this._dataToPositionX2=t=>{let e="left"===this._orient?this._middleHandlerSize:0,i=this._isHorizontal?this._startHandlerSize/2:0,r=this._isHorizontal?this._stateScale:this._valueScale,n=r.domain()[0];return r.scale(n)+this.getLayoutStartPoint().x+e+i},this._dataToPositionY=t=>{let e=this._isHorizontal?this._middleHandlerSize:0,i=this._isHorizontal?0:this._startHandlerSize/2,r=this._isHorizontal?this._valueScale:this._stateScale,n=this._isHorizontal?this._valueField:this._stateField;return r.scale(t[n])+this.getLayoutStartPoint().y+e+i},this._dataToPositionY2=t=>{let e=this._isHorizontal?this._middleHandlerSize:0,i=this._isHorizontal?0:this._startHandlerSize/2,r=this._isHorizontal?this._valueScale:this._stateScale,n=r.domain()[0];return r.scale(n)+this.getLayoutStartPoint().y+e+i},this._valueField="y",this._filterMode=null!==(i=t.filterMode)&&void 0!==i?i:"filter"}created(){super.created(),this._initValueScale()}setAttrFromSpec(){var t,e,i,r,n,s,a,o,l,h;super.setAttrFromSpec(),ew(this._spec.roam)&&(this._zoomAttr.enable=this._spec.roam,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode),this._backgroundSize=null!==(e=null===(t=this._spec.background)||void 0===t?void 0:t.size)&&void 0!==e?e:30,this._middleHandlerSize=this._computeMiddleHandlerSize(),this._width=this._computeWidth(),this._height=this._computeHeight(),ej(null===(n=null===(r=null===(i=this._spec)||void 0===i?void 0:i.startHandler)||void 0===r?void 0:r.style)||void 0===n?void 0:n.size)&&(this._spec.startHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize),ej(null===(o=null===(a=null===(s=this._spec)||void 0===s?void 0:s.endHandler)||void 0===a?void 0:a.style)||void 0===o?void 0:o.size)&&(this._spec.endHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize);let u=null===(l=this._spec.startHandler.style.visible)||void 0===l||l,d=null===(h=this._spec.endHandler.style.visible)||void 0===h||h;this._startHandlerSize=u?this._spec.startHandler.style.size:0,this._endHandlerSize=d?this._spec.endHandler.style.size:0}onLayoutEnd(t){this._updateScaleRange(),this._isReverse()&&!this._isReverseCache&&(this._isReverseCache=this._isReverse(),this.effect.onZoomChange()),!1!==this._cacheVisibility&&super.onLayoutEnd(t)}_initValueScale(){let t=this._computeDomainOfValueScale();if(t){let e=new x1;e.domain(t),this._valueScale=e}}_updateScaleRange(){var t,e;let i;let r=this._startHandlerSize+this._endHandlerSize;if(!this._stateScale||!this._valueScale)return;let n=this._isHorizontal?this.getLayoutRect().width-r:this.getLayoutRect().height-r,s=null!==(e=null===(t=this._relatedAxisComponent)||void 0===t?void 0:t.getScale().range())&&void 0!==e?e:[this._startHandlerSize/2,n+this._startHandlerSize/2];this._isHorizontal?(i=this._visible?[this._startHandlerSize/2,this._computeWidth()-r+this._startHandlerSize/2]:s,this._stateScale.range(i),this._valueScale.range([this._computeHeight()-this._middleHandlerSize,0])):"left"===this.layoutOrient?(i=this._visible?[this._startHandlerSize/2,this._computeHeight()-r+this._startHandlerSize/2]:s,this._stateScale.range(i),this._valueScale.range([this._computeWidth()-this._middleHandlerSize,0])):(i=this._visible?[this._startHandlerSize/2,this._computeHeight()-r+this._startHandlerSize/2]:s,this._stateScale.range(i),this._valueScale.range([0,this._computeWidth()-this._middleHandlerSize])),this._component&&!1!==this._cacheVisibility&&this._component.setAttributes({size:{width:this._computeWidth(),height:this._computeHeight()},position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y}})}_computeDomainOfValueScale(){let t=this._data.getLatestData().map(t=>t[this._valueField]),e=t.map(t=>1*t);return t.length?[o_(e),oy(e)]:null}_computeMiddleHandlerSize(){var t,e,i,r;let n=0;if(null===(e=null===(t=this._spec)||void 0===t?void 0:t.middleHandler)||void 0===e?void 0:e.visible){let t=null!==(i=this._spec.middleHandler.icon.style.size)&&void 0!==i?i:8;n+=Math.max(t,null!==(r=this._spec.middleHandler.background.size)&&void 0!==r?r:40)}return n}_computeWidth(){return!1===this._visible?0:ey(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:this._backgroundSize+this._middleHandlerSize}_computeHeight(){return!1===this._visible?0:ey(this._spec.height)?this._spec.height:this._isHorizontal?this._backgroundSize+this._middleHandlerSize:this.getLayoutRect().height-(this._startHandlerSize+this._endHandlerSize)/2}_isScaleValid(t){var e;if(!t||!t.domain())return!1;let i=t.domain();return(!dr(t.type)||i[0]!==i[1])&&(!ds(t.type)||1!==((e=i)&&eM(e)?Array.from(new Set(om(e))):e).length)}_getAttrs(t){var e,i,r,n,s;let a=null!==(e=this._spec)&&void 0!==e?e:{};return Object.assign({zIndex:this.layoutZIndex,start:this._start,end:this._end,position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},orient:this._orient,size:{width:this.getLayoutRect().width,height:this.getLayoutRect().height},showDetail:a.showDetail,brushSelect:null!==(i=a.brushSelect)&&void 0!==i&&i,zoomLock:null!==(r=a.zoomLock)&&void 0!==r&&r,minSpan:this._minSpan,maxSpan:this._maxSpan,delayType:a.delayType,delayTime:eO(a.delayType)?null!==(n=a.delayTime)&&void 0!==n?n:30:0,realTime:null===(s=a.realTime)||void 0===s||s,previewData:t&&this._data.getLatestData(),previewPointsX:t&&this._dataToPositionX,previewPointsY:t&&this._dataToPositionY,tolerance:this._spec.tolerance},this._getComponentAttrs(t))}_createOrUpdateComponent(){if(this._visible){let t=this._isHorizontal?this._stateScale:this._valueScale,e=this._isHorizontal?this._valueScale:this._stateScale,i=this._isScaleValid(t)&&this._isScaleValid(e)&&!1!==this._spec.showBackgroundChart,r=this._getAttrs(i);if(this._component)this._component.setAttributes(r);else{let t=this.getContainer();this._component=new zD(r),this._isHorizontal?i&&this._component.setPreviewPointsY1(this._dataToPositionY2):i&&this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData(t=>this._statePointToData(t)),this._component.addEventListener("change",t=>{let{start:e,end:i,tag:r}=t.detail;this._handleChange(e,i,void 0,r)}),t.add(this._component),this._updateScaleRange()}}}_handleChange(t,e,i,r){if(super._handleChange(t,e,i),this._shouldChange){i&&this._component&&this._component.setStartAndEnd(t,e),this._start=t,this._end=e;let n=this._statePointToData(t),s=this._statePointToData(e);(nx(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(t,e,n,s):this._handleStateChange(n,s,r))&&this.event.emit(c1.dataZoomChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:t,end:e,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}}_handleDataCollectionChange(){var t;let e=this._data.getDataView();if(e.reRunAllTransform(),null===(t=this._component)||void 0===t||t.setPreviewData(e.latestData),this._valueScale){let t=this._computeDomainOfValueScale();t&&this._valueScale.domain(t)}}_getComponentAttrs(t){var e,i,r,n,s,a,o,l,h,u,d;let{middleHandler:c={},startText:p={},endText:g={},backgroundChart:f={},selectedBackgroundChart:m={}}=this._spec;return{backgroundStyle:Tz(null===(e=this._spec.background)||void 0===e?void 0:e.style),startHandlerStyle:Tz(null===(i=this._spec.startHandler)||void 0===i?void 0:i.style),middleHandlerStyle:c.visible?{visible:!0,icon:Tz(null===(r=c.icon)||void 0===r?void 0:r.style),background:{size:null===(n=c.background)||void 0===n?void 0:n.size,style:Tz(null===(s=c.background)||void 0===s?void 0:s.style)}}:{visible:!1},endHandlerStyle:Tz(null===(a=this._spec.endHandler)||void 0===a?void 0:a.style),startTextStyle:{padding:p.padding,formatMethod:this._getHandlerTextFormatMethod(p),textStyle:Tz(p.style)},endTextStyle:{padding:g.padding,formatMethod:this._getHandlerTextFormatMethod(g),textStyle:Tz(g.style)},selectedBackgroundStyle:Tz(this._spec.selectedBackground.style),dragMaskStyle:Tz(null===(o=this._spec.dragMask)||void 0===o?void 0:o.style),backgroundChartStyle:t?{line:us(Tz(null===(l=f.line)||void 0===l?void 0:l.style),{fill:!1}),area:Object.assign({curveType:"basis",visible:!0},Tz(null===(h=f.area)||void 0===h?void 0:h.style))}:{line:{visible:!1},area:{visible:!1}},selectedBackgroundChartStyle:t?{line:us(Tz(null===(u=m.line)||void 0===u?void 0:u.style),{fill:!1}),area:Object.assign({curveType:"basis",visible:!0},Tz(null===(d=m.area)||void 0===d?void 0:d.style))}:{line:{visible:!1},area:{visible:!1}},disableTriggerEvent:this._option.disableTriggerEvent}}_getHandlerTextFormatMethod(t){let{formatMethod:e,formatter:i}=t,{formatFunc:r}=TV(e,i);return r?t=>r(t,{label:t},i):void 0}_getNeedClearVRenderComponents(){return[this._component]}clear(){if(this._component){let t=this.getContainer();this._component.removeAllChild(),t&&t.removeChild(this._component),this._component=null}super.clear()}}zj.type=lx.dataZoom,zj.transformerConstructor=zF,zj.specKey="dataZoom";class zN extends zP{static getSpecInfo(t){let e=t[this.specKey];if(ej(e))return;if(!eM(e))return[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.scrollBar}];let i=[];return e.forEach((t,e)=>{i.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:lx.scrollBar})}),i}constructor(t,e){var i;super(t,e),this.type=lx.scrollBar,this.name=lx.scrollBar,this.specKey="scrollBar",this.layoutZIndex=tM.DataZoom,this.layoutLevel=tC.DataZoom,this.layoutType="region-relative",this._filterMode=null!==(i=t.filterMode)&&void 0!==i?i:"axis"}setAttrFromSpec(){super.setAttrFromSpec(),ew(this._spec.roam)&&(this._zoomAttr.enable=!1,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode)}onLayoutEnd(t){var e,i;this._updateScaleRange(),null===(i=(e=this.effect).onZoomChange)||void 0===i||i.call(e),super.onLayoutEnd(t)}_updateScaleRange(){this._component&&this._component.setAttributes({x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height})}_computeWidth(){return ey(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:12}_computeHeight(){return ey(this._spec.height)?this._spec.height:this._isHorizontal?12:this.getLayoutRect().height}_getAttrs(){var t,e,i,r,n,s;return Object.assign({zIndex:this.layoutZIndex,x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height,range:[this._start,this._end],direction:this._isHorizontal?"horizontal":"vertical",delayType:null===(t=this._spec)||void 0===t?void 0:t.delayType,delayTime:eO(null===(e=this._spec)||void 0===e?void 0:e.delayType)?null!==(r=null===(i=this._spec)||void 0===i?void 0:i.delayTime)&&void 0!==r?r:30:0,realTime:null===(s=null===(n=this._spec)||void 0===n?void 0:n.realTime)||void 0===s||s},this._getComponentAttrs())}_createOrUpdateComponent(){let t=this._getAttrs();if(this._component)this._component.setAttributes(t);else{let e=this.getContainer();this._component=new NA(t),this._component.addEventListener("scrollDrag",t=>{let e=t.detail.value;this._handleChange(e[0],e[1])}),e.add(this._component)}}_handleChange(t,e,i){super._handleChange(t,e,i);let r=dg(this._start,t)&&dg(this._end,e);if(this._shouldChange&&!r){i&&this._component&&this._component.setAttribute("range",[t,e]),this._start=t,this._end=e;let r=this._statePointToData(t),n=this._statePointToData(e);(nx(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(t,e,r,n):this._handleStateChange(this._statePointToData(t),this._statePointToData(e)))&&this.event.emit(c1.scrollBarChange,{model:this,value:{filterData:"axis"!==this._filterMode,start:this._start,end:this._end,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}}_handleDataCollectionChange(){}_initCommonEvent(){super._initCommonEvent(),this._component&&this._component.on("scrollDrag",t=>{let e=t.detail.value;this._handleChange(e[0],e[1])})}_getComponentAttrs(){let{rail:t,slider:e,innerPadding:i}=this._spec,r={};return ej(i)||(r.padding=i),mk(null==t?void 0:t.style)||(r.railStyle=Tz(t.style)),mk(null==e?void 0:e.style)||(r.sliderStyle=Tz(e.style)),r.disableTriggerEvent=this._option.disableTriggerEvent,r}_getNeedClearVRenderComponents(){return[this._component]}}zN.type=lx.scrollBar,zN.specKey="scrollBar";let zz=(t,e)=>{let{datum:i,title:r,content:n}=e,s=[],a=i.call(null);return r.visible&&s.push({type:"title",index:0,datum:a,spec:r}),om(n).forEach((t,e)=>{t.visible&&s.push({type:"content",index:e,datum:a,spec:t})}),s},zH={title:{style:{text:"",fontSize:20,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{style:{text:"",fontSize:16,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}};v8(),yG(),Al();class zV extends Eu{constructor(){super(...arguments),this.name="indicator"}_renderText(t,e,i,r,n,s){if(!1!==e.visible){let a=eF({},dq(zH,n),e.style,{visible:e.visible});a.lineHeight=eO(a.lineHeight)?a.lineHeight:a.fontSize,e.formatMethod&&(a._originText=a.text,a.text=e.formatMethod(a.text,a));let o=MP(a);return o.name=s,t.appendChild(o),e.autoFit&&l1(i)&&this._setLocalAutoFit(i,o,e),e.autoLimit&&l1(r)&&o.setAttribute("maxLineWidth",i),o}}render(){var t;if(this.removeAllChild(!0),!0!==this.attribute.visible)return;let{title:e={},content:i,size:r,limitRatio:n=1/0}=this.attribute,s=Math.min(r.width,r.height)*n,a=this.createOrUpdateChild("indicator-container",{x:0,y:0,zIndex:1},"group");if(eO(e)&&(this._title=this._renderText(a,e,s,n,"title.style","indicator-title")),eO(i)){let t=om(i),e=[];t.forEach((t,i)=>{!1!==t.visible&&e.push(this._renderText(a,t,s,n,"content.style","indicator-content-"+i))}),this._content=e}this._setGlobalAutoFit(s),this._setYPosition();let o=null!==(t=null==a?void 0:a.AABBBounds.height())&&void 0!==t?t:0;a.setAttribute("y",r.height/2-o/2),a.setAttribute("x",r.width/2)}_setLocalAutoFit(t,e,i){var r,n,s,a,o,l,h,u,d;if("default"!==(null!==(r=i.fitStrategy)&&void 0!==r?r:"default"))return;let c=MT(null!==(s=null===(n=i.style)||void 0===n?void 0:n.text)&&void 0!==s?s:"",null!==(a=i.style)&&void 0!==a?a:{},null===(l=null===(o=this.stage)||void 0===o?void 0:o.getTheme())||void 0===l?void 0:l.text).width;if(c>0){let r=t*(null!==(h=i.fitPercent)&&void 0!==h?h:.5)/c,n=Math.floor((null!==(d=null===(u=i.style)||void 0===u?void 0:u.fontSize)&&void 0!==d?d:20)*r);e.setAttribute("fontSize",n),e.setAttribute("lineHeight",eO(i.style.lineHeight)?i.style.lineHeight:n)}}_setGlobalAutoFit(t){var e,i,r,n,s,a,o;let l=[],h=0,u=null!==(e=this.attribute.title)&&void 0!==e?e:{};u.autoFit&&"inscribed"===u.fitStrategy?(this._title.setAttribute("fontSize",12),l.push({text:this._title,spec:null!==(i=this.attribute.title)&&void 0!==i?i:{}})):h+=null!==(a=null===(s=null===(n=null===(r=this._title)||void 0===r?void 0:r.AABBBounds)||void 0===n?void 0:n.height)||void 0===s?void 0:s.call(n))&&void 0!==a?a:0;let d=null!==(o=u.space)&&void 0!==o?o:0;if(h+=d,om(this.attribute.content).filter(t=>!1!==t.visible).forEach((t,e)=>{var i,r,n,s;let a=this._content[e];t.autoFit&&"inscribed"===t.fitStrategy?(a.setAttribute("fontSize",12),l.push({text:a,spec:t})):h+=null!==(n=null===(r=null===(i=null==a?void 0:a.AABBBounds)||void 0===i?void 0:i.height)||void 0===r?void 0:r.call(i))&&void 0!==n?n:0;let o=null!==(s=t.space)&&void 0!==s?s:0;h+=o}),l.length<=0)return;let c=12/l.reduce((t,e)=>Math.max(t,e.text.AABBBounds.width()),0)*l.length,p=h/2,g=c**2+1,f=2*p*c,m=2*((-f+Math.sqrt(f**2-4*g*(p**2-(t/2)**2)))/(2*g)*c+p),v=(m-h)/l.length;l1(m)&&l.forEach(t=>{var e;let i=null===(e=t.spec.style)||void 0===e?void 0:e.lineHeight;t.text.setAttribute("fontSize",v),t.text.setAttribute("lineHeight",eO(i)?i:v)})}_setYPosition(){var t,e,i,r,n,s;let a=0,o=null!==(r=null===(i=null===(e=null===(t=this._title)||void 0===t?void 0:t.AABBBounds)||void 0===e?void 0:e.height)||void 0===i?void 0:i.call(e))&&void 0!==r?r:0,l=null!==(s=null===(n=this.attribute.title)||void 0===n?void 0:n.space)&&void 0!==s?s:0;om(this.attribute.content).filter(t=>!1!==t.visible).forEach((t,e)=>{var i;let r=this._content[e];r.setAttribute("y",o+l+a);let n=null!==(i=t.space)&&void 0!==i?i:0;a+=r.AABBBounds.height()+n})}}class zW extends Ea{constructor(){super(...arguments),this.type=lx.indicator,this.name=lx.indicator,this.specKey="indicator",this.layoutType="none",this.layoutZIndex=tM.Indicator,this.layoutLevel=tC.Indicator,this._gap=0,this._activeDatum=null}static getSpecInfo(t){if(this.type!==zW.type)return null;let e=t[this.specKey];if(!eM(e))return!1===e.visible?[]:[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.indicator}];let i=[];return e.forEach((t,e)=>{t&&!1!==t.visible&&i.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:lx.indicator})}),i}created(){super.created(),this.initData(),this.initEvent()}setAttrFromSpec(){super.setAttrFromSpec(),this._gap=this._spec.gap||0,this._title=this._spec.title,this._content=om(this._spec.content),this._regions=this._option.getRegionsInUserIdOrIndex(om(this._spec.regionId),om(this._spec.regionIndex))}onRender(t){}changeRegions(t){}initEvent(){var t;if(this._option.disableTriggerEvent||"none"===this._spec.trigger)return;let e=null===(t=this.getCompiler())||void 0===t?void 0:t.getVGrammarView();e&&("hover"===this._spec.trigger?(e.addEventListener("element-highlight:start",t=>{this.isRelativeModel(t.options.regionId)&&this.updateDatum(t.elements[0].getDatum())}),e.addEventListener("element-highlight:reset",t=>{this.isRelativeModel(t.options.regionId)&&this.updateDatum(null)})):(e.addEventListener("element-select:start",t=>{this.isRelativeModel(t.options.regionId)&&this.updateDatum(t.elements[0].getDatum())}),e.addEventListener("element-select:reset",t=>{this.isRelativeModel(t.options.regionId)&&this.updateDatum(null)})))}updateDatum(t){this._activeDatum=t,this._displayData.updateData();let e=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(e)}initData(){gw(this._option.dataSet,"indicatorFilter",zz);let t=new eH(this._option.dataSet,{name:`${this.type}_${this.id}_data`});t.transform({type:"indicatorFilter",options:{title:this._title,content:this._content,datum:()=>this._activeDatum}}),t.target.addListener("change",this.updateDatum.bind(this)),this._displayData=new Sa(this._option,t)}updateLayoutAttribute(){let t=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(t),super.updateLayoutAttribute()}_getIndicatorAttrs(){let t=this._regions[0],{width:e,height:i}=t.getLayoutRect(),{x:r,y:n}=t.getLayoutStartPoint(),s=[];return om(this._spec.content).forEach(t=>{let e=us({},this._theme.content,t);s.push({visible:!1!==e.visible&&(!e.field||null!==this._activeDatum),space:e.space||this._gap,autoLimit:e.autoLimit,autoFit:e.autoFit,fitPercent:e.fitPercent,fitStrategy:e.fitStrategy,style:Object.assign(Object.assign({},TN(Eo(e.style,["text"]),this._activeDatum)),{text:this._createText(e.field,e.style.text)})})}),{visible:!1!==this._spec.visible&&(!1!==this._spec.fixed||null!==this._activeDatum),size:{width:e,height:i},zIndex:this.layoutZIndex,x:r,y:n,dx:this._spec.offsetX?hn(this._spec.offsetX,this._computeLayoutRadius()):0,dy:this._spec.offsetY?hn(this._spec.offsetY,this._computeLayoutRadius()):0,limitRatio:this._spec.limitRatio||1/0,title:{visible:!1!==this._spec.title.visible&&(!eO(this._spec.title.field)||null!==this._activeDatum),space:this._spec.title.space||this._gap,autoLimit:this._spec.title.autoLimit,autoFit:this._spec.title.autoFit,fitPercent:this._spec.title.fitPercent,fitStrategy:this._spec.title.fitStrategy,style:Object.assign(Object.assign({},TN(Eo(this._spec.title.style,["text"]),this._activeDatum)),{text:this._createText(this._spec.title.field,this._spec.title.style.text)})},content:s}}_createOrUpdateIndicatorComponent(t){if(this._indicatorComponent)my(t,this._cacheAttrs)||this._indicatorComponent.setAttributes(t);else{let e=this.getContainer(),i=new zV(t);i.name="indicator",e.add(i),this._indicatorComponent=i,this._indicatorComponent.on("*",(t,e)=>this._delegateEvent(this._indicatorComponent,t,e))}return this._cacheAttrs=t,this._indicatorComponent}_createText(t,e){var i;return t?this._activeDatum?this._activeDatum[t]:"":nx(e)?null!==(i=e(this._activeDatum,void 0))&&void 0!==i?i:"":null!=e?e:""}_computeLayoutRadius(){let{width:t,height:e}=this._regions[0].getLayoutRect();return Math.min(t/2,e/2)}isRelativeModel(t){return this._regions.some(e=>e.id===t)}_getNeedClearVRenderComponents(){return[this._indicatorComponent]}clear(){this._cacheAttrs=null,super.clear()}getIndicatorComponent(){return this._indicatorComponent}}zW.type=lx.indicator,zW.specKey="indicator";let zG=["sum","average","min","max","variance","standardDeviation","median"];var zU=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};function z$(t,e,i){if(!i)return!1;let r=t.map(t=>1*t),n=o_(r),s=oy(r);return e<n||e>s}function zY(t,e,i,r,n,s){var a,o;let l;let{relativeSeries:h}=r;return ey(t.x)&&z$(e,t.x,i)&&(null===(o=null==h?void 0:(a=h.getXAxisHelper()).setExtendDomain)||void 0===o||o.call(a,"marker_xAxis_extend",t.x)),l=l7(t.x)?zq(t.x,n)+s.x:h.getXAxisHelper().dataToPosition([t.x])+s.x}function zK(t,e,i,r,n,s){var a,o;let l;let{relativeSeries:h}=r;return ey(t.y)&&z$(e,t.y,i)&&(null===(o=null===(a=h.getYAxisHelper())||void 0===a?void 0:a.setExtendDomain)||void 0===o||o.call(a,"marker_yAxis_extend",t.y)),l=l7(t.y)?zq(t.y,n)+s.y:h.getYAxisHelper().dataToPosition([t.y])+s.y}function zZ(t,e,i,r){var n,s;let{relativeSeries:a}=r;return ey(t.angle)&&z$(e,t.angle,i)&&(null===(s=null===(n=a.angleAxisHelper)||void 0===n?void 0:n.setExtendDomain)||void 0===s||s.call(n,"marker_angleAxis_extend",t.angle)),a.angleAxisHelper.dataToPosition([t.angle])}function zX(t,e,i,r){var n,s;let{relativeSeries:a}=r;return ey(t.radius)&&z$(e,t.radius,i)&&(null===(s=null===(n=a.radiusAxisHelper)||void 0===n?void 0:n.setExtendDomain)||void 0===s||s.call(n,"marker_radiusAxis_extend",t.radius)),a.radiusAxisHelper.dataToPosition([t.radius])}function zq(t,e){return Number(t.substring(0,t.length-1))*e/100}function zJ(t){return zG.includes(t)}function zQ(t,e,i,r,n){let s=e.getRegion(),a=s.getLayoutStartPoint(),o=i.getRegion(),l=o.getLayoutStartPoint(),h=Math.abs(Math.min(a.x,l.x)-Math.max(a.x+s.getLayoutRect().width,l.x+o.getLayoutRect().width)),u=Math.abs(Math.min(a.y,l.y)-Math.max(a.y+s.getLayoutRect().height,l.y+o.getLayoutRect().height)),d={relativeSeries:r,startRelativeSeries:e,endRelativeSeries:i},c=[],p=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,g=r.getXAxisHelper().getScale(0).domain(),f=r.getYAxisHelper().getScale(0).domain();return p.forEach(t=>{let e=eO(t.x),i=eO(t.y);if(e&&i){let e=zY(t,g,n,d,h,a),i=zK(t,f,n,d,u,a);c.push([{x:e,y:i}])}else if(e){let e=zY(t,g,n,d,h,a),i=Math.max(a.y+s.getLayoutRect().height,l.y+o.getLayoutRect().height),r=Math.min(a.y,l.y);c.push([{x:e,y:i},{x:e,y:r}])}else if(i){let e=Math.min(a.x,l.x),i=zK(t,f,n,d,u,a),r=Math.max(a.x+s.getLayoutRect().width,l.x+o.getLayoutRect().width);c.push([{x:e,y:i},{x:r,y:i}])}}),c}function z0(t,e,i,r,n){let s={relativeSeries:r,startRelativeSeries:e,endRelativeSeries:i},a=[],o=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,l=r.angleAxisHelper.getScale(0).domain(),h=r.radiusAxisHelper.getScale(0).domain(),u=Math.min(r.getRegion().getLayoutRect().width/2,r.getRegion().getLayoutRect().height/2);return o.forEach(t=>{let e=eO(t.angle),i=eO(t.radius);if(e&&i){let e=zZ(t,l,n,s),i=zX(t,h,n,s);a.push([{angle:e,radius:i}])}else if(e){let e=zZ(t,l,n,s);a.push([{angle:e,radius:-u},{angle:e,radius:u}])}else if(i){let e=zX(t,h,n,s);a.push([{radius:e,angle:0},{radius:e,angle:2*Math.PI}])}}),a}function z1(t,e,i,r){let n=[],s=t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData,a=eM(r);return s.forEach((t,s)=>{var o,l,h,u;let d=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,c=d.getRegion(),p=c.getLayoutStartPoint(),{width:g,height:f}=c.getLayoutRect(),m=0,v=0;if(r){let t=a?r[s]:r,e=t.x,i=t.y;e&&(m=l7(e)?Number(e.substring(0,e.length-1))*g/100:e),i&&(v=l7(i)?Number(i.substring(0,i.length-1))*f/100:i)}let y=d.getXAxisHelper().getScale(0).domain(),_=d.getYAxisHelper().getScale(0).domain(),b=om(t.x),x=om(t.y);1===b.length&&ey(b[0])&&z$(y,b[0],i)&&(null===(l=null===(o=d.getXAxisHelper())||void 0===o?void 0:o.setExtendDomain)||void 0===l||l.call(o,"marker_xAxis_extend",b[0])),1===x.length&&ey(x[0])&&z$(_,x[0],i)&&(null===(u=null===(h=d.getYAxisHelper())||void 0===h?void 0:h.setExtendDomain)||void 0===u||u.call(h,"marker_yAxis_extend",x[0])),n.push({x:d.getXAxisHelper().dataToPosition(b)+p.x+m,y:d.getYAxisHelper().dataToPosition(x)+p.y+v})}),n}function z2(t,e,i){let r=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach(t=>{var n,s,a,o;let l=(null==t?void 0:t.getRefRelativeSeries)?t.getRefRelativeSeries():e,h=l.angleAxisHelper.getScale(0).domain(),u=l.radiusAxisHelper.getScale(0).domain(),d=om(t.angle),c=om(t.radius);1===d.length&&ey(d[0])&&z$(h,d[0],i)&&(null===(s=null===(n=l.angleAxisHelper)||void 0===n?void 0:n.setExtendDomain)||void 0===s||s.call(n,"marker_xAxis_extend",d[0])),1===c.length&&ey(c[0])&&z$(u,c[0],i)&&(null===(o=null===(a=l.radiusAxisHelper)||void 0===a?void 0:a.setExtendDomain)||void 0===o||o.call(a,"marker_yAxis_extend",c[0])),r.push({angle:l.angleAxisHelper.dataToPosition(d),radius:l.radiusAxisHelper.dataToPosition(c)})}),r}function z3(t,e,i){if(i){let i=e.getRegion(),{x:r,y:n}=i.getLayoutStartPoint(),{width:s,height:a}=i.getLayoutRect();return t.map(t=>{let{x:e,y:i}=t;return l7(e)&&(e=zq(e,s)),e+=r,l7(i)&&(i=zq(i,a)),{x:e,y:i+=n}})}let{width:r,height:n}=e.getOption().getChart().getViewRect();return t.map(t=>{let{x:e,y:i}=t;return l7(e)&&(e=zq(e,r)),l7(i)&&(i=zq(i,n)),{x:e,y:i}})}function z5(t){let e=1/0,i=-Infinity,r=1/0,n=-Infinity;return t.forEach(t=>{let s=t.getLayoutStartPoint(),a=t.getLayoutRect();s.x<e&&(e=s.x),s.x+a.width>i&&(i=s.x+a.width),s.y<r&&(r=s.y),s.y+a.height>n&&(n=s.y+a.height)}),{minX:e,maxX:i,minY:r,maxY:n}}function z4(t,e){let{labelBackground:i={},style:r,shape:n}=t,s=zU(t,["labelBackground","style","shape"]);return!1!==t.visible?((null==n?void 0:n.visible)?s.shape=Object.assign({visible:!0},Tz(n.style)):s.shape={visible:!1},!1!==i.visible?(s.panel=Object.assign({visible:!0,customShape:i.customShape},z6(Tz(i.style),e)),eO(i.padding)&&(s.padding=El(i.padding))):(s.panel={visible:!1},s.padding=0),r&&(s.textStyle=z6(Tz(r),e)),s):{visible:!1}}function z8(t,e){for(let i in t)nx(t[i])&&(t[i]=t[i](e));return t}function z6(t,e){return nx(t)?t(e):t}function z9(t,e){return nx(t)?t(e):t}function z7(t,e,i){return eO(t)?"regionLeft"===e?i.getLayoutStartPoint().x-t.x:"regionRight"===e?i.getLayoutStartPoint().x+i.getLayoutRect().width-t.x:"regionTop"===e?i.getLayoutStartPoint().y-t.y:"regionBottom"===e?i.getLayoutStartPoint().y+i.getLayoutRect().height-t.y:e:e}function Ht(t){let e="x"in t,i="y"in t,r="x1"in t,n="y1"in t,s="angle"in t,a="radius"in t,o="angle1"in t,l="radius1"in t;return{doXProcess:e&&!i&&!n,doXYY1Process:e&&i&&n,doYProcess:i&&!e&&!r,doYXX1Process:i&&e&&r,doXYProcess:e&&i&&r&&n,doAngleProcess:s&&!o&&!a&&!l,doRadiusProcess:a&&!l&&!s&&!o,doAngRadRad1Process:s&&!o&&a&&l,doRadAngAng1Process:a&&s&&o&&!l,doRadAngProcess:s&&a&&o&&l,doCoordinatesProcess:"coordinates"in t&&(!("process"in t)||"process"in t&&"xy"in t.process)}}function He(t){let e="x"in t,i="x1"in t,r="y"in t,n="y1"in t,s="angle"in t,a="radius"in t,o="angle1"in t,l="radius1"in t;return{doXProcess:e&&i&&!r&&!n,doYProcess:r&&n&&!e&&!i,doXYProcess:e&&i&&r&&n,doAngleProcess:s&&o&&!a&&!l,doRadiusProcess:a&&l&&!s&&!o,doRadAngProcess:s&&a&&o&&l,doCoordinatesProcess:"coordinates"in t}}function Hi(t){return{doXYProcess:eO(t.x)&&eO(t.y),doPolarProcess:eO(t.angle)&&eO(t.radius),doGeoProcess:eO(t.areaName)}}function Hr(){v8(),Em()}function Hn(t,e){let{x1:i,y1:r,x2:n,y2:s}=e,{x1:a,y1:o,x2:l,y2:h}=t.AABBBounds,u=0,d=0;return a<i&&(u=i-a),o<r&&(d=r-o),l>n&&(u=n-l),h>s&&(d=s-h),{dx:u,dy:d}}function Hs(t,e){let{dx:i,dy:r}=Hn(t,e),{dx:n=0,dy:s=0}=t.attribute;i&&t.setAttribute("dx",i+n),r&&t.setAttribute("dy",r+s)}class Ha extends Eu{constructor(){super(...arguments),this.name="marker",this._onHover=t=>{this._lastHover=E_(t,this._container,this._lastHover)},this._onUnHover=t=>{this._lastHover=Eb(t,this._container,this._lastHover)},this._onClick=t=>{this._lastSelect=Ex(t,this._container,this._lastSelect)}}transAnimationConfig(){var t,e,i;if(!1!==this.attribute.animation){let r=nb(this.attribute.animation)?this.attribute.animation:{};this._animationConfig={enter:eF({},this.defaultUpdateAnimation,r,null!==(t=this.attribute.animationEnter)&&void 0!==t?t:{}),exit:eF({},this.defaultExitAnimation,r,null!==(e=this.attribute.animationExit)&&void 0!==e?e:{}),update:eF({},this.defaultUpdateAnimation,r,null!==(i=this.attribute.animationUpdate)&&void 0!==i?i:{})}}}setAttribute(t,e,i){super.setAttribute(t,e,i),"visible"===t&&this.render()}_bindEvent(){var t,e,i;if(!this.attribute.interactive)return;let{hover:r,select:n}=this.attribute;r&&(null===(t=this._container)||void 0===t||t.addEventListener("pointermove",this._onHover),null===(e=this._container)||void 0===e||e.addEventListener("pointerout",this._onUnHover)),n&&(null===(i=this._container)||void 0===i||i.addEventListener("pointerdown",this._onClick))}_releaseEvent(){var t,e,i;null===(t=this._container)||void 0===t||t.removeEventListener("pointermove",this._onHover),null===(e=this._container)||void 0===e||e.removeEventListener("pointerout",this._onUnHover),null===(i=this._container)||void 0===i||i.removeEventListener("pointerdown",this._onClick)}_initContainer(){var t,e;let i;let{limitRect:r={},clipInRange:n}=this.attribute;if(n){let n=aj.group(Object.assign(Object.assign({},r),{clip:!0,pickable:!1}));i=aj.group({x:-(null!==(t=r.x)&&void 0!==t?t:0),y:-(null!==(e=r.y)&&void 0!==e?e:0),pickable:!1}),n.add(i),this._containerClip=n,this.add(n)}else i=aj.group({x:0,y:0,pickable:!1}),this.add(i);i.name="marker-container",this._container=i}_updateContainer(){var t,e;let{limitRect:i={},clipInRange:r}=this.attribute;this._containerClip&&this._containerClip.setAttributes(Object.assign({},i)),this._container.setAttributes({x:r?-(null!==(t=i.x)&&void 0!==t?t:0):0,y:r?-(null!==(e=i.y)&&void 0!==e?e:0):0})}render(){var t;this.transAnimationConfig(),this.setAttribute("pickable",!1);let e=null===(t=this.attribute.visible)||void 0===t||t;!1===this.attribute.interactive&&this.setAttribute("childrenPickable",!1),e&&this.isValidPoints()?this._container?(this._updateContainer(),this.updateMarker(),this.markerAnimate("update")):(this._initContainer(),this.initMarker(this._container),this.markerAnimate("enter")):(this.markerAnimate("exit"),this._container=null,this.removeAllChild(!0)),this._releaseEvent(),this._bindEvent()}release(){this.markerAnimate("exit"),super.release(),this._releaseEvent(),this._container=null}}function Ho(t,e,i,r){var n,s,a,o,l;if(!t)return;null===(n=null==t?void 0:t.animates)||void 0===n||n.forEach(t=>t.stop("end"));let h=null!==(a=null===(s=t.attribute)||void 0===s?void 0:s.fillOpacity)&&void 0!==a?a:1,u=null!==(l=null===(o=t.attribute)||void 0===o?void 0:o.strokeOpacity)&&void 0!==l?l:1;t.setAttributes({fillOpacity:0,strokeOpacity:0}),t.animate().wait(e).to({fillOpacity:h,strokeOpacity:u},i,r)}function Hl(t,e,i,r){t&&(Ho(t.startSymbol,e,i,r),t.lines.forEach(t=>Ho(t,e,i,r)),Ho(t.line,e,i,r),Ho(t.endSymbol,e,i,r))}function Hh(t,e,i,r){t&&(Ho(t.getTextShape(),e,i,r),Ho(t.getBgRect(),e,i,r))}function Hu(t,e,i,r){var n,s,a,o;t&&(t.setAttributes({fillOpacity:null!==(s=null===(n=t.attribute)||void 0===n?void 0:n.fillOpacity)&&void 0!==s?s:1,strokeOpacity:null!==(o=null===(a=t.attribute)||void 0===a?void 0:a.strokeOpacity)&&void 0!==o?o:1}),t.animate().wait(e).to({fillOpacity:0,strokeOpacity:0},i,r))}function Hd(t,e,i,r){t&&(Hu(t.startSymbol,e,i,r),t.lines.forEach(t=>Hu(t,e,i,r)),Hu(t.line,e,i,r),Hu(t.endSymbol,e,i,r))}function Hc(t,e,i,r){t&&(Hu(t.getTextShape(),e,i,r),Hu(t.getBgRect(),e,i,r))}function Hp(t,e,i,r,n){let s=.1*i,a=.7*i,o=.1*i,l=.1*i;Ho(t.startSymbol,r,s,n),t.lines.forEach(t=>t.setAttribute("clipRange",0)),t.lines.forEach((e,i)=>{let o=a/t.lines.length;e.animate().wait(r+s+i*o).to({clipRange:1},o,n)}),Ho(t.endSymbol,r+s+a,o,n),Ho(e.getTextShape(),r+s+a+o,l,n),Ho(e.getBgRect(),r+s+a+o,l,n)}function Hg(t,e,i,r,n){Hl(t,r,i,n),Hh(e,r,i,n)}function Hf(t,e,i,r,n){Ho(t,r,i,n),Hh(e,r,i,n)}function Hm(t,e,i,r,n){Ho(t,r,i,n),Hh(e,r,i,n)}function Hv(t,e,i,r,n,s){var a;Hl(t,n,r,s),Ho(e,n,r,s),(null===(a=i.getTextShape)||void 0===a?void 0:a.call(i))?Hh(i,n,r,s):Ho(i,n,r,s)}function Hy(t,e,i,r,n,s){var a;let o=.1*r,l=.65*r,h=.05*r,u=.1*r,d=.1*r;Ho(t.startSymbol,n,o,s),t.lines.forEach(t=>t.setAttribute("clipRange",0)),t.lines.forEach((e,i)=>{let r=l/t.lines.length;e.animate().wait(n+o+i*r).to({clipRange:1},r,s)}),Ho(e,n+o+l,h,s),Ho(t.endSymbol,n+o+l+h,u,s),(null===(a=i.getTextShape)||void 0===a?void 0:a.call(i))?(Ho(i.getTextShape(),n+o+l+h+u,d,s),Ho(i.getBgRect(),n+o+l+u,d,s)):Ho(i,n+o+l+u,d,s)}function H_(t,e,i,r){let{enter:n,update:s,exit:a}=i;if("enter"===r){let{type:i,duration:r,delay:s,easing:a}=n;"clipIn"===i?Hp(t,e,r,s,a):"fadeIn"===i&&Hg(t,e,r,s,a)}else if("update"===r){let{type:i,duration:r,delay:n,easing:a}=s;"clipIn"===i?Hp(t,e,r,n,a):"fadeIn"===i&&Hg(t,e,r,n,a)}else if("exit"===r){var o,l,h,u,d;let{duration:i,delay:r,easing:n}=a;o=t,l=e,h=i,Hd(o,u=r,h,d=n),Hc(l,u,h,d)}}function Hb(t,e,i,r){let{enter:n,update:s,exit:a}=i;if("enter"===r){let{type:i,duration:r,delay:s,easing:a}=n;"fadeIn"===i&&Hf(t,e,r,s,a)}else if("update"===r){let{type:i,duration:r,delay:n,easing:a}=s;"fadeIn"===i&&Hf(t,e,r,n,a)}else if("exit"===r){var o,l,h,u,d;let{duration:i,delay:r,easing:n}=a;o=t,l=e,h=i,Hu(o,u=r,h,d=n),Hc(l,u,h,d)}}function Hx(t,e,i,r){let{enter:n,update:s,exit:a}=i;if("enter"===r){let{type:i,duration:r,delay:s,easing:a}=n;"fadeIn"===i&&Hm(t,e,r,s,a)}else if("update"===r){let{type:i,duration:r,delay:n,easing:a}=s;"fadeIn"===i&&Hm(t,e,r,n,a)}else if("exit"===r){var o,l,h,u,d;let{duration:i,delay:r,easing:n}=a;o=t,l=e,h=i,Hu(o,u=r,h,d=n),Hc(l,u,h,d)}}function HS(t,e,i,r){let[n,s]=t,{enter:a,update:o,exit:l}=i;if("enter"===r){let{type:t,duration:i,delay:r,easing:o}=a;"fadeIn"===t?Hv(n,s,e,i,r,o):"callIn"===t&&Hy(n,s,e,i,r,o)}else if("update"===r){let{type:t,duration:i,delay:r,easing:a}=o;"fadeIn"===t?Hv(n,s,e,i,r,a):"callIn"===t&&Hy(n,s,e,i,r,a)}else if("exit"===r){var h,u,d,c,p,g,f;let{duration:t,delay:i,easing:r}=l;h=n,u=s,d=e,c=t,Hd(h,p=i,c,g=r),Hu(u,p,c,g),(null===(f=d.getTextShape)||void 0===f?void 0:f.call(d))?Hc(d,p,c,g):Hu(d,p,c,g)}}let Hk={type:"clipIn",duration:500,easing:"linear",delay:0},HA={type:"fadeIn",duration:500,easing:"linear",delay:0},Hw={type:"callIn",duration:500,easing:"linear",delay:0},HM={type:"fadeOut",duration:500,easing:"linear",delay:0};class HC extends Ha{constructor(){super(...arguments),this.name="markCommonLine",this.defaultUpdateAnimation=Hk,this.defaultExitAnimation=HM}getLine(){return this._line}getLabel(){return this._label}setLabelPos(){let{label:t={},limitRect:e}=this.attribute,{position:i,confine:r,autoRotate:n}=t,s=this.getPointAttrByPosition(i),a=i.toString().toLocaleLowerCase().includes("start")?this._line.getStartAngle()||0:this._line.getEndAngle()||0;if(this._label.setAttributes(Object.assign(Object.assign({},s.position),{angle:n?this.getRotateByAngle(s.angle):0,textStyle:Object.assign(Object.assign({},this.getTextStyle(i,a,n)),t.textStyle)})),e&&r){let{x:t,y:i,width:r,height:n}=e;Hs(this._label,{x1:t,y1:i,x2:t+r,y2:i+n})}}initMarker(t){let{label:e,state:i}=this.attribute,r=this.createSegment();r.name="mark-common-line-line",this._line=r,t.add(r);let n=new Ey(Object.assign(Object.assign({},e),{state:{panel:eF({},Mw,null==i?void 0:i.labelBackground),text:eF({},Mw,null==i?void 0:i.label)}}));n.name="mark-common-line-label",this._label=n,t.add(n),this.setLabelPos()}updateMarker(){let{label:t,state:e}=this.attribute;this.setLineAttributes(),this._label&&(this._label.setAttributes(Object.assign(Object.assign({dx:0,dy:0},t),{state:{panel:eF({},Mw,null==e?void 0:e.labelBackground),text:eF({},Mw,null==e?void 0:e.label)}})),this.setLabelPos())}}(tK=en||(en={})).start="start",tK.startTop="startTop",tK.startBottom="startBottom",tK.insideStart="insideStart",tK.insideStartTop="insideStartTop",tK.insideStartBottom="insideStartBottom",tK.middle="middle",tK.insideMiddleTop="insideMiddleTop",tK.insideMiddleBottom="insideMiddleBottom",tK.end="end",tK.endTop="endTop",tK.endBottom="endBottom",tK.insideEnd="insideEnd",tK.insideEndTop="insideEndTop",tK.insideEndBottom="insideEndBottom",(tZ=es||(es={})).left="left",tZ.right="right",tZ.top="top",tZ.bottom="bottom",tZ.middle="middle",tZ.insideLeft="insideLeft",tZ.insideRight="insideRight",tZ.insideTop="insideTop",tZ.insideBottom="insideBottom",(tX=ea||(ea={})).arcInnerStart="arcInnerStart",tX.arcInnerEnd="arcInnerEnd",tX.arcInnerMiddle="arcInnerMiddle",tX.arcOuterStart="arcOuterStart",tX.arcOuterEnd="arcOuterEnd",tX.arcOuterMiddle="arcOuterMiddle",tX.center="center",(tq=eo||(eo={})).top="top",tq.bottom="bottom",tq.middle="middle",tq.insideTop="insideTop",tq.insideBottom="insideBottom",tq.insideMiddle="insideMiddle";let HT={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:en.end,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},HE={postiveXAxis:{start:{textAlign:"left",textBaseline:"middle"},startTop:{textAlign:"left",textBaseline:"bottom"},startBottom:{textAlign:"left",textBaseline:"top"},insideStart:{textAlign:"right",textBaseline:"middle"},insideStartTop:{textAlign:"right",textBaseline:"bottom"},insideStartBottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"left",textBaseline:"middle"},endTop:{textAlign:"left",textBaseline:"bottom"},endBottom:{textAlign:"left",textBaseline:"top"},insideEnd:{textAlign:"right",textBaseline:"middle"},insideEndTop:{textAlign:"right",textBaseline:"bottom"},insideEndBottom:{textAlign:"right",textBaseline:"top"}},negativeXAxis:{start:{textAlign:"right",textBaseline:"middle"},startTop:{textAlign:"right",textBaseline:"bottom"},startBottom:{textAlign:"right",textBaseline:"top"},insideStart:{textAlign:"left",textBaseline:"middle"},insideStartTop:{textAlign:"left",textBaseline:"bottom"},insideStartBottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"right",textBaseline:"middle"},endTop:{textAlign:"right",textBaseline:"bottom"},endBottom:{textAlign:"right",textBaseline:"top"},insideEnd:{textAlign:"left",textBaseline:"middle"},insideEndTop:{textAlign:"left",textBaseline:"bottom"},insideEndBottom:{textAlign:"left",textBaseline:"top"}}},HO={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:ea.arcOuterMiddle,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},HP={interactive:!0,label:{position:es.right,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},HR={interactive:!0,label:{position:ea.arcOuterMiddle,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},HB={arcInnerStart:{textAlign:"center",textBaseline:"bottom"},arcInnerEnd:{textAlign:"center",textBaseline:"bottom"},arcInnerMiddle:{textAlign:"center",textBaseline:"bottom"},arcOuterStart:{textAlign:"center",textBaseline:"top"},arcOuterEnd:{textAlign:"center",textBaseline:"top"},arcOuterMiddle:{textAlign:"center",textBaseline:"top"},center:{textAlign:"center",textBaseline:"middle"}},HI={left:{textAlign:"right",textBaseline:"middle"},insideLeft:{textAlign:"left",textBaseline:"middle"},right:{textAlign:"left",textBaseline:"middle"},insideRight:{textAlign:"right",textBaseline:"middle"},top:{textAlign:"center",textBaseline:"bottom"},insideTop:{textAlign:"center",textBaseline:"top"},bottom:{textAlign:"center",textBaseline:"top"},insideBottom:{textAlign:"center",textBaseline:"bottom"},middle:{textAlign:"center",textBaseline:"middle"}},HL={postiveXAxis:{top:{textAlign:"left",textBaseline:"bottom"},bottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"left",textBaseline:"middle"},insideTop:{textAlign:"right",textBaseline:"bottom"},insideBottom:{textAlign:"right",textBaseline:"top"},insideMiddle:{textAlign:"right",textBaseline:"middle"}},negativeXAxis:{top:{textAlign:"right",textBaseline:"bottom"},bottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"right",textBaseline:"middle"},insideTop:{textAlign:"left",textBaseline:"bottom"},insideBottom:{textAlign:"left",textBaseline:"top"},insideMiddle:{textAlign:"left",textBaseline:"middle"}}};function HD(){HF._animate=H_}Hr(),Ed();class HF extends HC{markerAnimate(t){HF._animate&&this._animationConfig&&HF._animate(this._line,this._label,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},HF.defaultAttributes,t)),this.name="markLine"}getPointAttrByPosition(t){var e;let{label:i={}}=this.attribute,{refX:r=0,refY:n=0}=i,s=this._line.getMainSegmentPoints(),a=null!==(e=this._line.getEndAngle())&&void 0!==e?e:0,o=(Tv(a),a),l=r*Math.cos(o)+n*Math.cos(o-Math.PI/2),h=r*Math.sin(o)+n*Math.sin(o-Math.PI/2);return t.includes("start")||t.includes("Start")?{position:{x:s[0].x+l,y:s[0].y+h},angle:o}:t.includes("middle")||t.includes("Middle")?{position:{x:(s[0].x+s[s.length-1].x)/2+l,y:(s[0].y+s[s.length-1].y)/2+h},angle:o}:{position:{x:s[s.length-1].x+l,y:s[s.length-1].y+h},angle:o}}getRotateByAngle(t){var e;return(Tv(t)?t:t-Math.PI)+(null!==(e=this.attribute.label.refAngle)&&void 0!==e?e:0)}getTextStyle(t,e,i){return Ty(Math.abs(e),Math.PI/2,.001)||Ty(Math.abs(e),3*Math.PI/2,.001)?T_(i,e,t):Tv(e)?HE.postiveXAxis[t]:HE.negativeXAxis[t]}createSegment(){let{points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:s,state:a}=this.attribute;return new Ep({points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:s,pickable:!1,state:{line:eF({},Mw,null==a?void 0:a.line),startSymbol:eF({},Mw,null==a?void 0:a.lineStartSymbol),endSymbol:eF({},Mw,null==a?void 0:a.lineEndSymbol)}})}setLineAttributes(){let{points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:s,state:a}=this.attribute;this._line&&this._line.setAttributes({points:t,startSymbol:e,endSymbol:i,lineStyle:r,mainSegmentIndex:n,multiSegment:s,state:{line:eF({},Mw,null==a?void 0:a.line),startSymbol:eF({},Mw,null==a?void 0:a.lineStartSymbol),endSymbol:eF({},Mw,null==a?void 0:a.lineEndSymbol)}})}isValidPoints(){let{points:t}=this.attribute;if(!t||t.length<2)return!1;let e=!0;return t.forEach(t=>{if(t.length)t.forEach(t=>{l1(t.x)&&l1(t.y)||(e=!1)});else if(!l1(t.x)||!l1(t.y))return void(e=!1)}),e}}HF.defaultAttributes=HT;function Hj(t,e){let i=[];return e.forEach(e=>{let r={x:null,y:null,angle:null,radius:null,areaName:null};if(eO(e.x)){let i=e.x;eM(i)?r.x=i.map(i=>Hz(i,t,e)):r.x=Hz(i,t,e)}if(eO(e.y)){let i=e.y;eM(i)?r.y=i.map(i=>Hz(i,t,e)):r.y=Hz(i,t,e)}if(eO(e.angle)){let i=e.angle;eM(i)?r.angle=i.map(i=>Hz(i,t,e)):r.angle=Hz(i,t,e)}if(eO(e.radius)){let i=e.radius;eM(i)?r.radius=i.map(i=>Hz(i,t,e)):r.radius=Hz(i,t,e)}if(eO(e.areaName)){let i=e.areaName;r.areaName=Hz(i,t,e)}e.getRefRelativeSeries&&(r.getRefRelativeSeries=e.getRefRelativeSeries),i.push(r)}),i}let HN={min:(t,e)=>db(t[0].latestData,e.field),max:(t,e)=>dx(t[0].latestData,e.field),sum:function(t,e){return dS(t[0].latestData,e.field)},average:function(t,e){return dk(t[0].latestData,e.field)},variance:function(t,e){return dA(t[0].latestData,e.field)},standardDeviation:function(t,e){return Math.sqrt(dA(t[0].latestData,e.field))},median:function(t,e){var i,r;return i=t[0].latestData,r=e.field,d_(i.map(t=>t[r]))}};function Hz(t,e,i){let r=i.getRelativeSeries(),n=i.getStartRelativeSeries(),s=i.getEndRelativeSeries(),a=r.getData().getLatestData(),o=n.getData().getLatestData(),l=s.getData().getLatestData();if(nx(t))return t(a,o,l,r,n,s);if(eI(t)){let{aggrType:i,field:r}=t;return HN[i](e,{field:r})}return t}class HH extends Ea{constructor(){super(...arguments),this.layoutType="none",this._layoutOffsetX=0,this._layoutOffsetY=0}getRelativeSeries(){return this._relativeSeries}getMarkerData(){return this._markerData}static _getMarkerCoordinateType(t){return"cartesian"}static getSpecInfo(t){let e=t[this.specKey];if(mk(e))return;if(!eM(e)&&!1!==e.visible&&this._getMarkerCoordinateType(e)===this.coordinateType)return[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:this.type}];let i=[];return om(e).forEach((t,e)=>{!1!==t.visible&&this._getMarkerCoordinateType(t)===this.coordinateType&&i.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:this.type})}),i}created(){super.created(),this._bindSeries(),this._initDataView(),this.initEvent()}_getAllRelativeSeries(){return{getRelativeSeries:()=>this._relativeSeries,getStartRelativeSeries:()=>this._startRelativeSeries,getEndRelativeSeries:()=>this._endRelativeSeries}}_getFieldInfoFromSpec(t,e,i){return eE(e)&&zJ(e)?{field:i.getSpec()[({x:"xField",y:"yField",radius:"valueField",angle:"categoryField",areaName:"nameField"})[t]],aggrType:e}:e}_processSpecByDims(t){let e=this._relativeSeries,i={};return t.forEach(t=>i[t.dim]=this._getFieldInfoFromSpec(t.dim,t.specValue,e)),Object.assign(Object.assign({},i),this._getAllRelativeSeries())}_processSpecCoo(t){var e;let i;return(null!==(e=t.coordinates)&&void 0!==e?e:om(t.coordinate)).map(t=>{let e=this._getSeriesByIdOrIndex(t.refRelativeSeriesId,t.refRelativeSeriesIndex);if("cartesian"===this.coordinateType){let{xField:r,yField:n}=e.getSpec(),{xFieldDim:s,xFieldIndex:a,yFieldDim:o,yFieldIndex:l}=t,h=r;eO(a)&&(h=om(r)[a]),s&&om(r).includes(s)&&(h=s);let u=n;eO(l)&&(u=om(n)[l]),o&&om(n).includes(o)&&(u=o),i=Object.assign({x:void 0,y:void 0},this._getAllRelativeSeries()),eE(t[h])&&zJ(t[h])?i.x={field:h,aggrType:t[h]}:i.x=om(h).map(e=>t[e]),eE(t[u])&&zJ(t[u])?i.y={field:u,aggrType:t[u]}:i.y=om(u).map(e=>t[e])}else if("polar"===this.coordinateType){let{valueField:r,categoryField:n}=e.getSpec(),{angleFieldDim:s,angleFieldIndex:a}=t,o=n;eO(a)&&(o=om(n)[a]),s&&om(n).includes(s)&&(o=s);i=Object.assign({angle:void 0,radius:void 0},this._getAllRelativeSeries()),eE(t[o])&&zJ(t[o])?i.angle={field:o,aggrType:t[o]}:i.angle=om(o).map(e=>t[e]),eE(t[r])&&zJ(t[r])?i.radius={field:r,aggrType:t[r]}:i.radius=om(r).map(e=>t[e])}return i.getRefRelativeSeries=()=>e,i})}_getRelativeDataView(){if(this._specifiedDataSeries){let t=[];om(this._specifiedDataSeries).forEach(e=>{t=t.concat(e.getViewData().latestData)});let e=new eA;return e.registerParser("array",eg),new eH(e).parse(t,{type:"array"})}return this._relativeSeries.getViewData()}updateLayoutAttribute(){var t,e,i;if(null===(t=this._spec.visible)||void 0===t||t){if(!this._markerComponent){let t=this._createMarkerComponent();t.name=null!==(e=this._spec.name)&&void 0!==e?e:this.type,t.id=null!==(i=this._spec.id)&&void 0!==i?i:`${this.type}-${this.id}`,this._markerComponent=t,this.getContainer().add(this._markerComponent),this._markerComponent.on("*",(t,e)=>{this._delegateEvent(this._markerComponent,t,e,null,this.getMarkerData.bind(this))})}this._markerLayout()}super.updateLayoutAttribute()}_getSeriesByIdOrIndex(t,e){var i,r;let n;return(n=null===(i=this._option.getSeriesInUserIdOrIndex(eO(t)?[t]:[],[e]))||void 0===i?void 0:i[0])||(n=null!==(r=this._relativeSeries)&&void 0!==r?r:this._getFirstSeries()),n}_bindSeries(){let t=this._spec;this._relativeSeries=this._getSeriesByIdOrIndex(t.relativeSeriesId,t.relativeSeriesIndex),this._startRelativeSeries=this._getSeriesByIdOrIndex(t.startRelativeSeriesId,t.startRelativeSeriesIndex),this._endRelativeSeries=this._getSeriesByIdOrIndex(t.endRelativeSeriesId,t.endRelativeSeriesIndex),t.specifiedDataSeriesIndex&&"all"===t.specifiedDataSeriesIndex||t.specifiedDataSeriesId&&"all"===t.specifiedDataSeriesId?this._specifiedDataSeries=this._option.getAllSeries():(t.specifiedDataSeriesIndex||t.specifiedDataSeriesId)&&(this._specifiedDataSeries=this._getSeriesByIdOrIndex(t.specifiedDataSeriesId,t.specifiedDataSeriesIndex))}initEvent(){"cartesian"!==this._relativeSeries.coordinate&&(this._relativeSeries.event.on("zoom",this._markerLayout.bind(this)),this._relativeSeries.event.on("panmove",this._markerLayout.bind(this)),this._relativeSeries.event.on("scroll",this._markerLayout.bind(this)))}onRender(t){}changeRegions(t){}clear(){super.clear(),this._firstSeries=null}_getFirstSeries(){var t;if(this._firstSeries)return this._firstSeries;let e=dE(this._regions);return e?(this._firstSeries=e,e):(null===(t=this._option)||void 0===t||t.onError("need at least one series"),null)}_getNeedClearVRenderComponents(){return[this._markerComponent]}onLayoutStart(t,e,i){ej(this._spec.offsetX)||(this._layoutOffsetX=ht(this._spec.offsetX,e.width,e)),ej(this._spec.offsetY)||(this._layoutOffsetY=ht(this._spec.offsetY,e.height,e)),super.onLayoutStart(t,e,i)}_compareSpec(t,e){let i=super._compareSpec(t,e);return my(e,t)||(i.reRender=!0,i.reMake=!0,i.change=!0),i}}function HV(t,e){return function(t,e,i){let{predict:r}=function(t,e=t=>t.x,i=t=>t.y){var r,n,s,a,o;let l,h,u=0,d=0,c=0,p=0,g=0;dp(t,e,i,(t,e)=>{++g,u+=(t-u)/g,d+=(e-d)/g,c+=(t*e-c)/g,p+=(t*t-p)/g});let f=function(t,e,i,r){let n=r-t*t,s=1e-24>Math.abs(n)?0:(i-t*e)/n;return[e-s*t,s]}(u,d,c,p),m=t=>f[0]+f[1]*t;return{coef:f,predict:m,rSquared:(r=t,n=e,s=i,a=d,o=m,l=0,h=0,dp(r,n,s,(t,e)=>{let i=e-o(t),r=e-a;l+=i*i,h+=r*r}),1-l/h)}}(t,t=>t[e],t=>t[i]),n=db(t,e),s=dx(t,e),a=r(n),o=r(s);return[{[e]:n,[i]:a},{[e]:s,[i]:o}]}(t[0].latestData,e.fieldX,e.fieldY)}function HW(t,e){if(e&&e.getRelativeSeries){let i=e.getRelativeSeries();if(i){let e=i.getViewData();return e&&e.latestData&&e.latestData.length?t:[]}}return t}class HG extends HH{constructor(){super(...arguments),this.specKey="markLine",this.layoutZIndex=tM.MarkLine}static _getMarkerCoordinateType(t){let{doAngleProcess:e,doRadiusProcess:i,doAngRadRad1Process:r,doRadAngAng1Process:n,doRadAngProcess:s}=Ht(t);return"polar"===t.coordinateType||e||i||r||n||s?"polar":"cartesian"}_createMarkerComponent(){var t,e,i,r,n,s,a,o,l,h,u,d,c,p,g,f,m,v,y;let{label:_={},startSymbol:b={},endSymbol:x={}}=this._spec,S={zIndex:this.layoutZIndex,interactive:null===(t=this._spec.interactive)||void 0===t||t,hover:null===(e=this._spec.interactive)||void 0===e||e,select:null===(i=this._spec.interactive)||void 0===i||i,points:[{x:0,y:0},{x:0,y:0}],center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,lineStyle:z6(Tz(null===(r=this._spec.line)||void 0===r?void 0:r.style),this._markerData),clipInRange:null!==(n=this._spec.clip)&&void 0!==n&&n,label:z4(_,this._markerData),state:{line:z8(null!==(a=null===(s=this._spec.line)||void 0===s?void 0:s.state)&&void 0!==a?a:{},this._markerData),lineStartSymbol:z8(null!==(l=null===(o=this._spec.startSymbol)||void 0===o?void 0:o.state)&&void 0!==l?l:{},this._markerData),lineEndSymbol:z8(null!==(u=null===(h=this._spec.endSymbol)||void 0===h?void 0:h.state)&&void 0!==u?u:{},this._markerData),label:z8(null!==(p=null===(c=null===(d=this._spec)||void 0===d?void 0:d.label)||void 0===c?void 0:c.state)&&void 0!==p?p:{},this._markerData),labelBackground:z8(null!==(v=null===(m=null===(f=null===(g=this._spec)||void 0===g?void 0:g.label)||void 0===f?void 0:f.labelBackground)||void 0===m?void 0:m.state)&&void 0!==v?v:{},this._markerData)},animation:null!==(y=this._spec.animation)&&void 0!==y&&y,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return b.visible?S.startSymbol=Object.assign(Object.assign({},b),{visible:!0,style:Tz(b.style)}):S.startSymbol={visible:!1},x.visible?S.endSymbol=Object.assign(Object.assign({},x),{visible:!0,style:Tz(x.style)}):S.endSymbol={visible:!1},this._newMarkLineComponent(S)}_getUpdateMarkerAttrs(){var t,e,i,r;let n;let s=this._spec,a=this._markerData,o=this._startRelativeSeries,l=this._endRelativeSeries,h=this._relativeSeries,u=this._computePointsAttr(),d=h.getViewData().latestData,c=a.latestData[0]&&a.latestData[0].latestData?a.latestData[0].latestData:a.latestData;if(s.clip||(null===(t=s.label)||void 0===t?void 0:t.confine)){let{minX:t,maxX:e,minY:i,maxY:r}=z5([o.getRegion(),l.getRegion(),h.getRegion()]);n={x:t,y:i,width:e-t,height:r-i}}let p=null!==(i=null===(e=this._markerComponent)||void 0===e?void 0:e.attribute)&&void 0!==i?i:{},g=Object.assign(Object.assign({},p.label),{text:this._spec.label.formatMethod?this._spec.label.formatMethod(c,d):null===(r=p.label)||void 0===r?void 0:r.text});return Object.assign(Object.assign({},u),{label:g,limitRect:n,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}_markerLayout(){var t;let e=this._getUpdateMarkerAttrs();null===(t=this._markerComponent)||void 0===t||t.setAttributes(e)}_initDataView(){let t=this._spec,e="coordinates"in t,{doXProcess:i,doYProcess:r,doXYY1Process:n,doYXX1Process:s,doXYProcess:a,doAngleProcess:o,doRadiusProcess:l,doAngRadRad1Process:h,doRadAngAng1Process:u,doRadAngProcess:d}=Ht(t);if(this._markerData=this._getRelativeDataView(),!(i||r||n||s||a||o||l||h||u||d||e))return;gw(this._option.dataSet,"markerAggregation",Hj),gw(this._option.dataSet,"markerRegression",HV),gw(this._option.dataSet,"markerFilter",HW);let{options:c,needAggr:p,needRegr:g,processData:f}=this._computeOptions(),m=new eH(this._option.dataSet);m.parse([f],{type:"dataview"}),p&&m.transform({type:"markerAggregation",options:c}),g&&m.transform({type:"markerRegression",options:c}),m.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),m.target.on("change",()=>{this._markerLayout()}),this._markerData=m}}HG.specKey="markLine";class HU extends HG{constructor(){super(...arguments),this.type=lx.markLine,this.name=lx.markLine,this.coordinateType="cartesian"}_newMarkLineComponent(t){return new HF(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,n=this._endRelativeSeries,s=this._relativeSeries,a=eO(e.coordinates),o=eO(e.process),l=o&&eO(e.process.x),h=o&&eO(e.process.y),u=eO(e.positions),d=null!==(t=e.autoRange)&&void 0!==t&&t,{doXProcess:c,doYProcess:p,doXYY1Process:g,doYXX1Process:f,doXYProcess:m,doCoordinatesProcess:v}=Ht(e),y=[];if(c||g||p||f||m||a&&l||a&&h){let t=zQ(i,r,n,s,d);y=1===t.length?t[0]:t.map(t=>t[0])}else v?y=z1(i,s,d,e.coordinatesOffset):u&&(y=z3(e.positions,s,e.regionRelative));return{points:y}}_markerLayout(){var t,e,i,r,n,s,a,o;let l=this._getUpdateMarkerAttrs();if("type-step"===this._spec.type){let o,h;let u=this._startRelativeSeries,d=this._endRelativeSeries,{multiSegment:c,mainSegmentIndex:p}=this._spec.line||{},{connectDirection:g,expandDistance:f=0}=this._spec;if(l7(f)){let t=u.getRegion(),e=t.getLayoutStartPoint(),i=d.getRegion(),r=i.getLayoutStartPoint();if("bottom"===g||"top"===g){let n=Math.abs(Math.min(e.y,r.y)-Math.max(e.y+t.getLayoutRect().height,r.y+i.getLayoutRect().height));o=Number(f.substring(0,f.length-1))*n/100}else{let n=Math.abs(Math.min(e.x,r.x)-Math.max(e.x+t.getLayoutRect().width,r.x+i.getLayoutRect().width));o=Number(f.substring(0,f.length-1))*n/100}}else o=f;let{points:m,label:v,limitRect:y}=l,_=function(t,e,i,r=0){let n=[],s=t.y-e.y,a=t.x-e.x;switch(i){case"top":n.push(t),n.push({x:t.x,y:s>0?t.y-r-Math.abs(s):t.y-r}),n.push({x:e.x,y:s>0?e.y-r:e.y-r-Math.abs(s)}),n.push(e);break;case"bottom":n.push(t),n.push({x:t.x,y:s<0?t.y+r+Math.abs(s):t.y+r}),n.push({x:e.x,y:s<0?e.y+r:e.y+r+Math.abs(s)}),n.push(e);break;case"left":n.push(t),n.push({x:a>0?t.x-r-Math.abs(a):t.x-r,y:t.y}),n.push({x:a>0?e.x-r:e.x-r-Math.abs(a),y:e.y}),n.push(e);break;case"right":n.push(t),n.push({x:a>0?t.x+r:t.x+r+Math.abs(a),y:t.y}),n.push({x:a>0?e.x+r+Math.abs(a):e.x+r,y:e.y}),n.push(e)}return n}(m[0],m[1],g,o);h=c&&eO(p)?{position:"middle",autoRotate:!1,refX:0,refY:0}:Object.assign(Object.assign({position:"start",autoRotate:!1},function(t,e,i,r=0){let n=t.y-e.y,s=t.x-e.x;return"bottom"===i?{dx:s>0?-s/2:Math.abs(s/2),dy:n>0?r:Math.abs(n)+r}:"top"===i?{dx:s>0?-Math.abs(s/2):+Math.abs(s/2),dy:n>0?-(Math.abs(n)+r):-r}:"left"===i?{dx:s>0?-s-r:-r,dy:n>0?-n/2:Math.abs(n/2)}:"right"===i?{dx:s>0?r:Math.abs(s)+r,dy:n>0?-n/2:Math.abs(n/2)}:{}}(m[0],m[1],g,o)),{refX:0,refY:0}),l1(null===(t=this._spec.label)||void 0===t?void 0:t.refX)&&(h.refX+=this._spec.label.refX),l1(null===(e=this._spec.label)||void 0===e?void 0:e.refY)&&(h.refY+=this._spec.label.refY),l1(null===(i=this._spec.label)||void 0===i?void 0:i.dx)&&(h.dx=(h.dx||0)+this._spec.label.dx),l1(null===(r=this._spec.label)||void 0===r?void 0:r.dy)&&(h.dy=(h.dy||0)+this._spec.label.dy);let b=null!==(s=null===(n=this._markerComponent)||void 0===n?void 0:n.attribute)&&void 0!==s?s:{};null===(a=this._markerComponent)||void 0===a||a.setAttributes({points:c?[[_[0],_[1]],[_[1],_[2]],[_[2],_[3]]]:_,label:Object.assign(Object.assign(Object.assign({},v),h),{textStyle:Object.assign(Object.assign({},b.label.textStyle),{textAlign:"center",textBaseline:"middle"})}),limitRect:y,multiSegment:c,mainSegmentIndex:p,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}else null===(o=this._markerComponent)||void 0===o||o.setAttributes(l)}_computeOptions(){let t,e=this._getRelativeDataView(),i=!0,r=!1,n=this._spec,s=this._relativeSeries,{doXProcess:a,doYProcess:o,doXYY1Process:l,doYXX1Process:h,doXYProcess:u,doCoordinatesProcess:d}=Ht(n);if(u)t=[this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y}]),this._processSpecByDims([{dim:"x",specValue:n.x1},{dim:"y",specValue:n.y1}])];else if(a)t=[this._processSpecByDims([{dim:"x",specValue:n.x}])];else if(o)t=[this._processSpecByDims([{dim:"y",specValue:n.y}])];else if(l)t=[this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y}]),this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y1}])];else if(h)t=[this._processSpecByDims([{dim:"x",specValue:n.x},{dim:"y",specValue:n.y}]),this._processSpecByDims([{dim:"x",specValue:n.x1},{dim:"y",specValue:n.y}])];else if(d){if(t=this._processSpecCoo(n),i=!1,e=new eH(this._option.dataSet,{name:`${this.type}_${this.id}_data`}).parse([s.getViewData()],{type:"dataview"}).transform({type:"markerAggregation",options:t}),n.process&&"x"in n.process&&(t=[this._processSpecByDims([{dim:"x",specValue:n.process.x}])],i=!0),n.process&&"y"in n.process&&(t=t=[this._processSpecByDims([{dim:"y",specValue:n.process.y}])],i=!0),n.process&&"xy"in n.process){let{xField:e,yField:i}=s.getSpec();t={fieldX:e,fieldY:i},r=!0}}else i=!1;return{options:t,needAggr:i,needRegr:r,processData:e}}}HU.type=lx.markLine,HU.coordinateType="cartesian";Ec();class H$ extends Ep{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},Ep.defaultAttributes,t)),this.name="arc-segment",this.key="arc-segment",this.isReverseArc=!1}getStartAngle(){let t=this.isReverseArc?this._startAngle+Math.PI/2:this._startAngle-Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}getEndAngle(){let t=this.isReverseArc?this._endAngle-Math.PI/2:this._endAngle+Math.PI/2;return t<0?t+2*Math.PI:t>2*Math.PI?t-2*Math.PI:t}getMainSegmentPoints(){return this._mainSegmentPoints}_computeStartRotate(t){return this.isReverseArc?t+Math.PI:t}_computeEndRotate(t){return this.isReverseArc?t:t+Math.PI}render(){this.removeAllChild(!0),this._reset();let{startSymbol:t,endSymbol:e,lineStyle:i,state:r,visible:n=!0,radius:s,startAngle:a,endAngle:o,center:l}=this.attribute;if(!n)return;this._startAngle=a,this._endAngle=o,this.isReverseArc=a>o;let h={x:l.x+s*Math.cos(this._startAngle),y:l.y+s*Math.sin(this._startAngle)},u={x:l.x+s*Math.cos(this._endAngle),y:l.y+s*Math.sin(this._endAngle)};this._mainSegmentPoints=[h,u];let d=this._renderSymbol(t,this._mainSegmentPoints,"start"),c=this._renderSymbol(e,this._mainSegmentPoints,"end");this.startSymbol=d,this.endSymbol=c;let p=aj.arc(Object.assign({x:l.x,y:l.y,startAngle:a,endAngle:o,innerRadius:s,outerRadius:s},i));p.name=`${this.name}-line`,p.id=this._getNodeId("arc"),mk(null==r?void 0:r.line)||(p.states=[].concat(r.line)[0]),this.add(p),this.line=p}}Hr(),Ec();class HY extends HC{markerAnimate(t){HY._animate&&this._animationConfig&&HY._animate(this._line,this._label,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},HY.defaultAttributes,t,{label:{autoRotate:!0}})),this.name="markArcLine"}getPointAttrByPosition(t){let e;let{center:i,radius:r,startAngle:n,endAngle:s,label:a}=this.attribute,{refX:o=0,refY:l=0}=a;switch(t){case ea.arcInnerStart:e=n;case ea.arcOuterStart:e=n;break;case ea.arcInnerEnd:e=s;case ea.arcOuterEnd:e=s;break;case ea.center:case ea.arcInnerMiddle:case ea.arcOuterMiddle:default:e=(n+s)/2}return{position:{x:i.x+(r+l)*Math.cos(e)+o*Math.cos(e-Math.PI/2),y:i.y+(r+l)*Math.sin(e)+o*Math.sin(e-Math.PI/2)},angle:e}}getTextStyle(t){return HB[t]}getRotateByAngle(t){var e;return t-Math.PI/2+(null!==(e=this.attribute.label.refAngle)&&void 0!==e?e:0)}createSegment(){let{center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:s,lineStyle:a,state:o}=this.attribute;return new H$({center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:s,lineStyle:a,state:{line:eF({},Mw,null==o?void 0:o.line),startSymbol:eF({},Mw,null==o?void 0:o.lineStartSymbol),endSymbol:eF({},Mw,null==o?void 0:o.lineEndSymbol)}})}setLineAttributes(){let{center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:s,lineStyle:a,state:o}=this.attribute;this._line&&this._line.setAttributes({center:t,radius:e,startAngle:i,endAngle:r,startSymbol:n,endSymbol:s,lineStyle:a,state:{line:eF({},Mw,null==o?void 0:o.line),startSymbol:eF({},Mw,null==o?void 0:o.lineStartSymbol),endSymbol:eF({},Mw,null==o?void 0:o.lineEndSymbol)}})}isValidPoints(){return!0}}HY.defaultAttributes=HO;class HK extends HG{constructor(){super(...arguments),this.type=lx.polarMarkLine,this.name=lx.polarMarkLine,this.coordinateType="polar"}_newMarkLineComponent(t){let{doRadiusProcess:e,doRadAngAng1Process:i}=Ht(this._spec);return e||i?new HY(t):new HF(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,n=this._endRelativeSeries,s=this._relativeSeries,a=null!==(t=e.autoRange)&&void 0!==t&&t,{doAngleProcess:o,doRadiusProcess:l,doAngRadRad1Process:h,doRadAngAng1Process:u,doRadAngProcess:d,doCoordinatesProcess:c}=Ht(e),p=[],g={},f={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(o||l||h||u||d){let t=z0(i,r,n,s,a);g=(p=1===t.length?t[0]:t.map(t=>t[0]))[0].radius===p[1].radius?{radius:p[0].radius,startAngle:p[0].angle,endAngle:p[1].angle,center:f}:{points:p.map(t=>iM(f,t.radius,t.angle))}}else c&&(g={points:(p=z2(i,s,a)).map(t=>iM(f,t.radius,t.angle))});return g}_computeOptions(){let t;let e=this._spec,{doAngleProcess:i,doRadiusProcess:r,doAngRadRad1Process:n,doRadAngAng1Process:s,doRadAngProcess:a,doCoordinatesProcess:o}=Ht(e),l=this._getRelativeDataView();return a?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:i?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}])]:n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius1}])]:s?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:o&&(t=this._processSpecCoo(e)),{options:t,needAggr:!0,needRegr:!1,processData:l}}}HK.type=lx.polarMarkLine,HK.coordinateType="polar";v8(),yG(),Al();class HZ extends Eu{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},HZ.defaultAttributes,t)),this.name="title"}render(){var t,e,i,r,n,s,a,o,l,h,u,d,c,p,g,f,m,v,y,_,b,x,S,k,A,w,M,C,T,E,O,P,R,B,I,L,D,F,j,N,z,H;let{textType:V,text:W,subtextType:G,textStyle:U={},subtext:$,subtextStyle:Y={},width:K,height:Z,minWidth:X,maxWidth:q,minHeight:J,maxHeight:Q,align:tt,verticalAlign:te,padding:ti=0}=this.attribute,tr=El(ti),tn=this.createOrUpdateChild("title-container",{x:tr[3],y:tr[0],zIndex:1},"group");if(!1!==this.attribute.visible&&!1!==U.visible){if("rich"===V||eO(U.character)){let h=Object.assign({x:null!==(t=U.x)&&void 0!==t?t:0,y:null!==(e=U.y)&&void 0!==e?e:0,width:null!==(r=null!==(i=U.width)&&void 0!==i?i:K)&&void 0!==r?r:0,height:null!==(s=null!==(n=U.height)&&void 0!==n?n:Z)&&void 0!==s?s:0,ellipsis:null===(a=U.ellipsis)||void 0===a||a,wordBreak:null!==(o=U.wordBreak)&&void 0!==o?o:"break-word",maxHeight:U.maxHeight,maxWidth:U.maxWidth,textConfig:null!==(l=U.character)&&void 0!==l?l:W},U);this._mainTitle=tn.createOrUpdateChild("mainTitle",h,"richtext")}else if("html"===V){let t=Object.assign({html:Object.assign(Object.assign({dom:W},MM),U),x:null!==(h=U.x)&&void 0!==h?h:0,y:null!==(u=U.y)&&void 0!==u?u:0,width:null!==(c=null!==(d=U.width)&&void 0!==d?d:K)&&void 0!==c?c:0,height:null!==(g=null!==(p=U.height)&&void 0!==p?p:Z)&&void 0!==g?g:0,ellipsis:null===(f=U.ellipsis)||void 0===f||f,wordBreak:null!==(m=U.wordBreak)&&void 0!==m?m:"break-word",maxHeight:U.maxHeight,maxWidth:U.maxWidth,textConfig:[]},U);this._mainTitle=tn.createOrUpdateChild("mainTitle",t,"richtext")}else eO(W)&&(this._mainTitle=tn.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:eM(W)?W:[W],wrap:!0},U),{maxLineWidth:null!==(v=U.maxLineWidth)&&void 0!==v?v:K,heightLimit:U.heightLimit,lineClamp:U.lineClamp,ellipsis:null===(y=U.ellipsis)||void 0===y||y,x:0,y:0}),"text"))}let ts=this._mainTitle?this._mainTitle.AABBBounds.height():0,ta=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(!1!==this.attribute.visible&&!1!==Y.visible){if("rich"===G||eO(Y.character)){let t=Object.assign({x:null!==(_=Y.x)&&void 0!==_?_:0,y:null!==(b=Y.y)&&void 0!==b?b:0,width:null!==(S=null!==(x=Y.width)&&void 0!==x?x:K)&&void 0!==S?S:0,height:null!==(A=null!==(k=Y.height)&&void 0!==k?k:Z)&&void 0!==A?A:0,ellipsis:null===(w=Y.ellipsis)||void 0===w||w,wordBreak:null!==(M=Y.wordBreak)&&void 0!==M?M:"break-word",maxHeight:Y.maxHeight,maxWidth:Y.maxWidth,textConfig:null!==(C=Y.character)&&void 0!==C?C:$},Y);this._subTitle=tn.createOrUpdateChild("subTitle",t,"richtext")}else if("html"===G){let t=Object.assign({html:Object.assign(Object.assign({dom:$},MM),Y),x:null!==(T=Y.x)&&void 0!==T?T:0,y:null!==(E=Y.y)&&void 0!==E?E:0,width:null!==(P=null!==(O=Y.width)&&void 0!==O?O:K)&&void 0!==P?P:0,height:null!==(B=null!==(R=Y.height)&&void 0!==R?R:Z)&&void 0!==B?B:0,ellipsis:null===(I=Y.ellipsis)||void 0===I||I,wordBreak:null!==(L=Y.wordBreak)&&void 0!==L?L:"break-word",maxHeight:Y.maxHeight,maxWidth:Y.maxWidth,textConfig:[]},Y);this._subTitle=tn.createOrUpdateChild("subTitle",t,"richtext")}else eO($)&&(this._subTitle=tn.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:eM($)?$:[$],wrap:!0},Y),{maxLineWidth:null!==(D=Y.maxLineWidth)&&void 0!==D?D:K,heightLimit:Y.heightLimit,lineClamp:Y.lineClamp,ellipsis:null===(F=Y.ellipsis)||void 0===F||F,x:0,y:ts}),"text"))}let to=this._subTitle?this._subTitle.AABBBounds.height():0,tl=this._subTitle?this._subTitle.AABBBounds.width():0,th=Math.max(ta,tl),tu=ts+(null!==(j=Y.height)&&void 0!==j?j:to);if(eO(K)&&(th=K,this._mainTitle&&this._mainTitle.setAttribute("maxLineWidth",K),this._subTitle&&this._subTitle.setAttribute("maxLineWidth",K)),eO(Z)&&(tu=Z),eO(X)&&th<X&&(th=X),eO(q)&&(this._mainTitle&&this._mainTitle.setAttribute("maxLineWidth",q),this._subTitle&&this._subTitle.setAttribute("maxLineWidth",q),this._mainTitle&&this._mainTitle.setAttribute("maxWidth",q),this._subTitle&&this._subTitle.setAttribute("maxWidth",q),th>q&&(th=q)),eO(J)&&tu<J&&(tu=J),eO(Q)&&(this._mainTitle&&this._mainTitle.setAttribute("maxHeight",Q),this._subTitle&&this._subTitle.setAttribute("maxHeight",Q-ts),tu>Q&&(tu=Q)),tn.attribute.width=th,tn.attribute.height=tu,tn.attribute.boundsPadding=tr,this._mainTitle){if(eO(tt)||eO(U.align)){let t=U.align?U.align:tt,e=null!==(N=U.width)&&void 0!==N?N:ta;"left"===t?(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left")):"center"===t?(this._mainTitle.setAttribute("x",e/2),this._mainTitle.setAttribute("textAlign","center")):"right"===t&&(this._mainTitle.setAttribute("x",e),this._mainTitle.setAttribute("textAlign","right"))}if(eO(te)||eO(U.verticalAlign)){let t=U.verticalAlign?U.verticalAlign:te,e=U.height?U.height:tu;"top"===t?(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top")):"middle"===t?(this._mainTitle.setAttribute("y",e/2),this._mainTitle.setAttribute("textBaseline","middle")):"bottom"===t&&(this._mainTitle.setAttribute("y",e),this._mainTitle.setAttribute("textBaseline","bottom"))}}if(this._subTitle){if(eO(tt)||eO(Y.align)){let t=Y.align?Y.align:tt,e=null!==(z=Y.width)&&void 0!==z?z:tl;"left"===t?(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left")):"center"===t?(this._subTitle.setAttribute("x",e/2),this._subTitle.setAttribute("textAlign","center")):"right"===t&&(this._subTitle.setAttribute("x",e),this._subTitle.setAttribute("textAlign","right"))}if(eO(te)||eO(U.verticalAlign)){let t=Y.verticalAlign?Y.verticalAlign:te,e=null!==(H=Y.height)&&void 0!==H?H:0;"top"===t?(this._subTitle.setAttribute("y",ts),this._subTitle.setAttribute("textBaseline","top")):"middle"===t?(this._subTitle.setAttribute("y",ts+e/2),this._subTitle.setAttribute("textBaseline","middle")):"bottom"===t&&(this._subTitle.setAttribute("y",ts+e),this._subTitle.setAttribute("textBaseline","bottom"))}}}}HZ.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}};class HX extends Ea{get orient(){return this._orient}constructor(t,e){super(t,e),this.type=lx.title,this.specKey=lx.title,this.layoutType="normal",this.layoutZIndex=tM.Title,this.layoutLevel=tC.Title,this._orient="top",this._orient=l9(t.orient)?t.orient:"top"}initLayout(){super.initLayout(),this._layout&&(this._layout.layoutOrient=this._orient)}static getSpecInfo(t){let e=t[this.specKey];if(!e||!1===e.visible)return null;if(!eM(e))return[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.title}];let i=[];return e.forEach((t,e)=>{!1!==t.visible&&i.push({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:lx.title})}),i}onRender(t){}_compareSpec(t,e){let i=super._compareSpec(t,e);return(null==e?void 0:e.orient)!==(null==t?void 0:t.orient)&&(i.reMake=!0),i.change=!0,i.reRender=!0,i}changeRegions(t){}update(t){}resize(t){}afterSetLayoutStartPoint(t){l1(t.x)&&this._titleComponent&&this._titleComponent.setAttribute("x",t.x),l1(t.y)&&this._titleComponent&&this._titleComponent.setAttribute("y",t.y),super.afterSetLayoutStartPoint(t)}getBoundsInRect(t){let e={};this.setLayoutRect(t);let i=this._getTitleAttrs();this._createOrUpdateTitleComponent(i),e=this._getTitleLayoutRect();let{x:r,y:n}=this.getLayoutStartPoint();return{x1:r,y1:n,x2:r+e.width,y2:n+e.height}}_getTitleLayoutRect(){let t=this._titleComponent.AABBBounds;return{width:this._spec.width?this._spec.width:l1(t.width())?t.width():0,height:this._spec.height?this._spec.height:l1(t.height())?t.height():0}}_getTitleAttrs(){var t,e,i,r,n,s,a,o,l;let h=Math.max(0,null!==(t=this._spec.width)&&void 0!==t?t:this.getLayoutRect().width);return Object.assign(Object.assign({},Eo(this._spec,["padding"])),{textType:null!==(e=this._spec.textType)&&void 0!==e?e:"text",text:null!==(i=this._spec.text)&&void 0!==i?i:"",subtextType:null!==(r=this._spec.subtextType)&&void 0!==r?r:"text",subtext:null!==(n=this._spec.subtext)&&void 0!==n?n:"",x:null!==(s=this._spec.x)&&void 0!==s?s:0,y:null!==(a=this._spec.y)&&void 0!==a?a:0,width:h,height:this._spec.height,minWidth:this._spec.minWidth,maxWidth:this._spec.maxWidth,minHeight:this._spec.minHeight,maxHeight:this._spec.maxHeight,padding:this._spec.innerPadding,align:null!==(o=this._spec.align)&&void 0!==o?o:"left",verticalAlign:null!==(l=this._spec.verticalAlign)&&void 0!==l?l:"top",textStyle:Object.assign({width:h},this._spec.textStyle),subtextStyle:Object.assign({width:h},this._spec.subtextStyle)})}_createOrUpdateTitleComponent(t){if(this._titleComponent)my(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{let e=this.getContainer(),i=new HZ(t);i.name="title",e.add(i),this._titleComponent=i,i.on("*",(t,e)=>this._delegateEvent(i,t,e))}return this._cacheAttrs=t,this._titleComponent}_getNeedClearVRenderComponents(){return[this._titleComponent]}clear(){super.clear(),this._cacheAttrs=null}}HX.type=lx.title,HX.specKey=lx.title;function Hq(){HJ._animate=Hb}Hr(),AS();class HJ extends Ha{markerAnimate(t){HJ._animate&&this._animationConfig&&HJ._animate(this._area,this._label,this._animationConfig,t)}getArea(){return this._area}getLabel(){return this._label}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},HJ.defaultAttributes,t)),this.name="markArea",this.defaultUpdateAnimation=HA,this.defaultExitAnimation=HM}getPointAttrByPosition(t){let{x1:e,x2:i,y1:r,y2:n}=this._area.AABBBounds;return t.includes("left")||t.includes("Left")?{x:e,y:(r+n)/2}:t.includes("right")||t.includes("Right")?{x:i,y:(r+n)/2}:t.includes("top")||t.includes("Top")?{x:(e+i)/2,y:r}:t.includes("bottom")||t.includes("Bottom")?{x:(e+i)/2,y:n}:{x:(e+i)/2,y:(r+n)/2}}setLabelPos(){var t;if(this._label&&this._area){let{label:e={}}=this.attribute,i=null!==(t=e.position)&&void 0!==t?t:"middle",r=this.getPointAttrByPosition(i);if(this._label.setAttributes(Object.assign(Object.assign({},r),{textStyle:Object.assign(Object.assign({},HI[i]),e.textStyle)})),this.attribute.limitRect&&e.confine){let{x:t,y:e,width:i,height:r}=this.attribute.limitRect;Hs(this._label,{x1:t,y1:e,x2:t+i,y2:e+r})}}}initMarker(t){let{points:e,label:i,areaStyle:r,state:n}=this.attribute,s=aj.polygon(Object.assign({points:e},r));s.states=eF({},Mw,null==n?void 0:n.area),s.name="mark-area-polygon",this._area=s,t.add(s);let a=new Ey(Object.assign(Object.assign({},i),{state:{panel:eF({},Mw,null==n?void 0:n.labelBackground),text:eF({},Mw,null==n?void 0:n.label)}}));a.name="mark-area-label",this._label=a,t.add(a),this.setLabelPos()}updateMarker(){let{points:t,label:e,areaStyle:i,state:r}=this.attribute;this._area&&(this._area.setAttributes(Object.assign({points:t},i)),this._area.states=eF({},Mw,null==r?void 0:r.area)),this._label&&this._label.setAttributes(Object.assign(Object.assign({dx:0,dy:0},e),{state:{panel:eF({},Mw,null==r?void 0:r.labelBackground),text:eF({},Mw,null==r?void 0:r.label)}})),this.setLabelPos()}isValidPoints(){let{points:t}=this.attribute;if(!t||t.length<3)return!1;let e=!0;return t.forEach(t=>{l1(t.x)&&l1(t.y)||(e=!1)}),e}}HJ.defaultAttributes=HP;class HQ extends HH{constructor(){super(...arguments),this.specKey="markArea",this.layoutZIndex=tM.MarkArea}static _getMarkerCoordinateType(t){let{doAngleProcess:e,doRadiusProcess:i,doRadAngProcess:r}=He(t);return"polar"===t.coordinateType||e||i||r?"polar":"cartesian"}_createMarkerComponent(){var t,e,i,r,n,s,a,o,l,h,u,d;let c=null!==(t=this._spec.label)&&void 0!==t?t:{},p={zIndex:this.layoutZIndex,interactive:null===(e=this._spec.interactive)||void 0===e||e,hover:null===(i=this._spec.interactive)||void 0===i||i,select:null===(r=this._spec.interactive)||void 0===r||r,points:[{x:0,y:0}],center:{x:0,y:0},innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,areaStyle:z6(Tz(null===(n=this._spec.area)||void 0===n?void 0:n.style),this._markerData),clipInRange:null!==(s=this._spec.clip)&&void 0!==s&&s,label:z4(c,this._markerData),state:{area:z8(null===(a=this._spec.area)||void 0===a?void 0:a.state,this._markerData),label:z8(null===(o=this._spec.label)||void 0===o?void 0:o.state,this._markerData),labelBackground:z8(null===(u=null===(h=null===(l=this._spec)||void 0===l?void 0:l.label)||void 0===h?void 0:h.labelBackground)||void 0===u?void 0:u.state,this._markerData)},animation:null!==(d=this._spec.animation)&&void 0!==d&&d,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return this._newMarkAreaComponent(p)}_markerLayout(){var t,e,i,r;let n;let s=this._spec,a=this._markerData,o=this._startRelativeSeries,l=this._endRelativeSeries,h=this._relativeSeries,u=this._computePointsAttr(),d=this._getRelativeDataView().latestData,c=a?a.latestData[0]&&a.latestData[0].latestData?a.latestData[0].latestData:a.latestData:d;if(s.clip||(null===(t=s.label)||void 0===t?void 0:t.confine)){let{minX:t,maxX:e,minY:i,maxY:r}=z5([o.getRegion(),l.getRegion(),h.getRegion()]);n={x:t,y:i,width:e-t,height:r-i}}this._markerComponent&&this._markerComponent.setAttributes(Object.assign(Object.assign({},u),{label:Object.assign(Object.assign({},null===(e=this._markerComponent.attribute)||void 0===e?void 0:e.label),{text:this._spec.label.formatMethod?this._spec.label.formatMethod(c,d):null===(r=null===(i=this._markerComponent.attribute)||void 0===i?void 0:i.label)||void 0===r?void 0:r.text}),limitRect:n,dx:this._layoutOffsetX,dy:this._layoutOffsetY}))}_initDataView(){let{doXProcess:t,doYProcess:e,doXYProcess:i,doAngleProcess:r,doRadiusProcess:n,doRadAngProcess:s,doCoordinatesProcess:a}=He(this._spec);if(!(t||e||i||r||n||s||a))return null;let{options:o}=this._computeOptions(),l=this._getRelativeDataView();gw(this._option.dataSet,"markerAggregation",Hj),gw(this._option.dataSet,"markerFilter",HW);let h=new eH(this._option.dataSet,{name:`${this.type}_${this.id}_data`});h.parse([l],{type:"dataview"}),h.transform({type:"markerAggregation",options:o}),h.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),h.target.on("change",()=>{this._markerLayout()}),this._markerData=h}}HQ.specKey="markArea";class H0 extends HQ{constructor(){super(...arguments),this.type=lx.markArea,this.name=lx.markArea,this.coordinateType="cartesian"}_newMarkAreaComponent(t){return new HJ(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,n=this._endRelativeSeries,s=this._relativeSeries,{doXProcess:a,doYProcess:o,doXYProcess:l,doCoordinatesProcess:h}=He(e),u=eO(e.positions),d=null!==(t=e.autoRange)&&void 0!==t&&t,c=[],p=[];if(l){let[t,e]=p=zQ(i,r,n,s,d);t&&t.length&&e&&e.length&&(c=[{x:t[0].x,y:e[0].y},t[0],{x:e[0].x,y:t[0].y},e[0]])}else if(a||o){let[t,e]=p=zQ(i,r,n,s,d);t&&t.length&&e&&e.length&&(c=[...t,e[1],e[0]])}else h?c=z1(i,s,d,e.coordinatesOffset):u&&(c=z3(e.positions,s,e.regionRelative));return{points:c}}_computeOptions(){let t;let e=this._spec,{doXProcess:i,doYProcess:r,doXYProcess:n,doCoordinatesProcess:s}=He(e);return n?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"x",specValue:e.x1},{dim:"y",specValue:e.y1}])]:i?t=[this._processSpecByDims([{dim:"x",specValue:e.x}]),this._processSpecByDims([{dim:"x",specValue:e.x1}])]:r?t=[this._processSpecByDims([{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"y",specValue:e.y1}])]:s&&(t=this._processSpecCoo(e)),{options:t}}}H0.type=lx.markArea,H0.coordinateType="cartesian";Hr(),SB();class H1 extends Ha{markerAnimate(t){H1._animate&&this._animationConfig&&H1._animate(this._area,this._label,this._animationConfig,t)}getArea(){return this._area}getLabel(){return this._label}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},H1.defaultAttributes,t,{label:{autoRotate:!0}})),this.name="markArcArea",this.defaultUpdateAnimation=HA,this.defaultExitAnimation=HM}getPointAttrByPosition(t){let e,i;let{center:r,innerRadius:n,outerRadius:s,startAngle:a,endAngle:o,label:l}=this.attribute,{refX:h=0,refY:u=0}=l;switch(t){case ea.center:e=(n+s)/2,i=(a+o)/2;break;case ea.arcInnerStart:e=n,i=a;break;case ea.arcOuterStart:e=s,i=a;break;case ea.arcInnerEnd:e=n,i=o;break;case ea.arcOuterEnd:e=s,i=o;break;case ea.arcInnerMiddle:e=n,i=(a+o)/2;break;case ea.arcOuterMiddle:e=s,i=(a+o)/2;break;default:e=n,i=(a+o)/2}return{position:{x:r.x+(e+u)*Math.cos(i)+h*Math.cos(i-Math.PI/2),y:r.y+(e+u)*Math.sin(i)+h*Math.sin(i-Math.PI/2)},angle:i}}setLabelPos(){var t;if(this._label&&this._area){let{label:e={}}=this.attribute,{position:i="arcInnerMiddle",autoRotate:r}=e,n=this.getPointAttrByPosition(i);if(this._label.setAttributes(Object.assign(Object.assign({},n.position),{angle:r?n.angle-Math.PI/2+(null!==(t=e.refAngle)&&void 0!==t?t:0):0,textStyle:Object.assign(Object.assign({},HB[i]),e.textStyle)})),this.attribute.limitRect&&e.confine){let{x:t,y:e,width:i,height:r}=this.attribute.limitRect;Hs(this._label,{x1:t,y1:e,x2:t+i,y2:e+r})}}}initMarker(t){let{center:e,innerRadius:i,outerRadius:r,startAngle:n,endAngle:s,areaStyle:a,label:o,state:l}=this.attribute,h=aj.arc(Object.assign({x:e.x,y:e.y,innerRadius:i,outerRadius:r,startAngle:n,endAngle:s},a));h.states=eF({},Mw,null==l?void 0:l.area),h.name="polar-mark-area-area",this._area=h,t.add(h);let u=new Ey(Object.assign(Object.assign({},o),{state:{panel:eF({},Mw,null==l?void 0:l.labelBackground),text:eF({},Mw,null==l?void 0:l.label)}}));u.name="mark-area-label",this._label=u,t.add(u),this.setLabelPos()}updateMarker(){let{center:t,innerRadius:e,outerRadius:i,startAngle:r,endAngle:n,areaStyle:s,label:a,state:o}=this.attribute;this._area&&(this._area.setAttributes(Object.assign({x:t.x,y:t.y,innerRadius:e,outerRadius:i,startAngle:r,endAngle:n},s)),this._area.states=eF({},Mw,null==o?void 0:o.area)),this._label&&(this._label.setAttributes(Object.assign(Object.assign({dx:0,dy:0},a),{state:{panel:eF({},Mw,null==o?void 0:o.labelBackground),text:eF({},Mw,null==o?void 0:o.label)}})),this.setLabelPos())}isValidPoints(){return!0}}H1.defaultAttributes=HR;class H2 extends HQ{constructor(){super(...arguments),this.type=lx.polarMarkArea,this.name=lx.polarMarkArea,this.coordinateType="polar"}_newMarkAreaComponent(t){let{doRadiusProcess:e,doAngleProcess:i,doRadAngProcess:r}=He(this._spec);return i||e||r?new H1(t):new HJ(t)}_computePointsAttr(){var t;let e=this._spec,i=this._markerData,r=this._startRelativeSeries,n=this._endRelativeSeries,s=this._relativeSeries,{doAngleProcess:a,doRadiusProcess:o,doRadAngProcess:l,doCoordinatesProcess:h}=He(e),u=null!==(t=e.autoRange)&&void 0!==t&&t,d={},c={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(a||o||l){let t=z0(i,r,n,s,u);l?d={innerRadius:t[0][0].radius,outerRadius:t[1][0].radius,startAngle:t[0][0].angle,endAngle:t[1][0].angle,center:c}:a?d={innerRadius:0,outerRadius:Math.abs(t[0][0].radius),startAngle:t[0][1].angle,endAngle:t[1][1].angle,center:c}:o&&(d={innerRadius:t[0][0].radius,outerRadius:t[1][0].radius,startAngle:t[0][0].angle,endAngle:t[1][1].angle,center:c})}else h&&(d={points:z2(i,s,u).map(t=>iM(c,t.radius,t.angle))});return d}_computeOptions(){let t;let e=this._spec,{doAngleProcess:i,doRadiusProcess:r,doRadAngProcess:n,doCoordinatesProcess:s}=He(e);return n?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:i?t=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:r?t=[this._processSpecByDims([{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"radius",specValue:e.radius1}])]:s&&(t=this._processSpecCoo(e)),{options:t}}}H2.type=lx.polarMarkArea,H2.coordinateType="polar";class H3 extends _W{constructor(t){super(t)}}(tJ=el||(el={})).OnPlay="onPlay",tJ.OnPause="onPause",tJ.OnForward="onForward",tJ.OnBackward="onBackward",(tQ=eh||(eh={})).Start="start",tQ.Pause="pause",tQ.Forward="forward",tQ.Backward="backward";class H5 extends Eu{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},H5.defaultAttributes,t)),this._isPaused=!0,this.updateAttributes=()=>{this._startAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -73.1429 161.4994 a 48.7619 48.7619 0 0 1 25.9901 7.5093 l 201.7524 127.1223 a 48.7619 48.7619 0 0 1 0.3657 82.2613 l -201.7524 129.6335 A 48.7619 48.7619 0 0 1 292.5952 540.1838 v -256.7314 a 48.7619 48.7619 0 0 1 48.7619 -48.7619 z m 24.381 92.9402 v 167.9116 l 131.9497 -84.7726 L 365.7381 327.6063 z"},H5.defaultControllerAttr),{visible:this.attribute.start.visible}),this.attribute.start.style)},this._pauseAttr={style:Object.assign(Object.assign(Object.assign({symbolType:"M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -48.7619 195.0476 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z m 158.4762 0 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z"},H5.defaultControllerAttr),{visible:this.attribute.pause.visible}),this.attribute.pause.style)},this._forwardAttr={style:Object.assign(Object.assign(Object.assign({},H5.defaultControllerAttr),{visible:this.attribute.forward.visible}),this.attribute.forward.style)},this._backwardAttr={style:Object.assign(Object.assign(Object.assign({},H5.defaultControllerAttr),{visible:this.attribute.backward.visible}),this.attribute.backward.style)},this.updateLayout()},this.updateLayout=()=>{var t,e,i,r;this._layout=this.attribute.layout,"horizontal"===this._layout?(this._backwardAttr.style.symbolType=null!==(t=this._backwardAttr.style.symbolType)&&void 0!==t?t:"M 521.29 734.276 L 230.929 448.019 L 521.29 161.762 c 37.685 -37.153 38.003 -97.625 0.707 -134.384 c -37.297 -36.758 -98.646 -36.435 -136.331 0.718 l -357.43 352.378 c -0.155 0.153 -0.297 0.314 -0.451 0.468 c -0.084 0.082 -0.172 0.157 -0.256 0.239 c -18.357 18.092 -27.581 41.929 -27.743 65.902 c -0.004 0.311 -0.017 0.623 -0.018 0.934 c 0.001 0.316 0.014 0.632 0.018 0.948 c 0.165 23.97 9.389 47.803 27.743 65.892 c 0.083 0.082 0.171 0.157 0.255 0.239 c 0.154 0.154 0.296 0.315 0.452 0.468 l 357.43 352.378 c 37.685 37.153 99.034 37.476 136.331 0.718 c 37.297 -36.758 36.979 -97.231 -0.707 -134.384 z",this._forwardAttr.style.symbolType=null!==(e=this._forwardAttr.style.symbolType)&&void 0!==e?e:"M 30 163 L 320.361 449.257 L 30 735.514 c -37.685 37.153 -38.003 97.625 -0.707 134.384 c 37.297 36.758 98.646 36.435 136.331 -0.718 l 357.43 -352.378 c 0.155 -0.153 0.297 -0.314 0.451 -0.468 c 0.084 -0.082 0.172 -0.157 0.256 -0.239 c 18.357 -18.092 27.581 -41.929 27.743 -65.902 c 0.004 -0.311 0.017 -0.623 0.018 -0.934 c -0.001 -0.316 -0.014 -0.632 -0.018 -0.948 c -0.165 -23.97 -9.389 -47.803 -27.743 -65.892 c -0.083 -0.082 -0.171 -0.157 -0.255 -0.239 c -0.154 -0.154 -0.296 -0.315 -0.452 -0.468 l -357.43 -352.378 c -37.685 -37.153 -99.034 -37.476 -136.331 -0.718 c -37.297 36.758 -36.979 97.231 0.707 134.384 z"):"vertical"===this._layout&&(this._backwardAttr.style.symbolType=null!==(i=this._backwardAttr.style.symbolType)&&void 0!==i?i:"m 161.724 521.29 l 286.257 -290.361 l 286.257 290.361 c 37.153 37.685 97.625 38.003 134.384 0.707 c 36.758 -37.297 36.435 -98.646 -0.718 -136.331 l -352.378 -357.43 c -0.153 -0.155 -0.314 -0.297 -0.468 -0.451 c -0.082 -0.084 -0.157 -0.172 -0.239 -0.256 c -18.092 -18.357 -41.929 -27.581 -65.902 -27.743 c -0.311 -0.004 -0.623 -0.017 -0.934 -0.018 c -0.316 0.001 -0.632 0.014 -0.948 0.018 c -23.97 0.165 -47.803 9.389 -65.892 27.743 c -0.082 0.083 -0.157 0.171 -0.239 0.255 c -0.154 0.154 -0.315 0.296 -0.468 0.452 l -352.378 357.43 c -37.153 37.685 -37.476 99.034 -0.718 136.331 c 36.758 37.297 97.231 36.979 134.384 -0.707 z",this._forwardAttr.style.symbolType=null!==(r=this._forwardAttr.style.symbolType)&&void 0!==r?r:"M 734.276 28.71 L 448.019 319.071 L 161.762 28.71 c -37.153 -37.685 -97.625 -38.003 -134.384 -0.707 c -36.758 37.297 -36.435 98.646 0.718 136.331 l 352.378 357.43 c 0.153 0.155 0.314 0.297 0.468 0.451 c 0.082 0.084 0.157 0.172 0.239 0.256 c 18.092 18.357 41.929 27.581 65.902 27.743 c 0.311 0.004 0.623 0.017 0.934 0.018 c 0.316 -0.001 0.632 -0.014 0.948 -0.018 c 23.97 -0.165 47.803 -9.389 65.892 -27.743 c 0.082 -0.083 0.157 -0.171 0.239 -0.255 c 0.154 -0.154 0.315 -0.296 0.468 -0.452 l 352.378 -357.43 c 37.153 -37.685 37.476 -99.034 0.718 -136.331 c -36.758 -37.297 -97.231 -36.979 -134.384 0.707 z")},this._initPlay=()=>{ej(this._playController)&&(this._playController=new H3(Object.assign({},this._startAttr.style)),this.add(this._playController))},this._initBackward=()=>{ej(this._backwardController)&&(this._backwardController=new H3(Object.assign({},this._backwardAttr.style)),this.add(this._backwardController))},this._initForward=()=>{ej(this._forwardController)&&(this._forwardController=new H3(Object.assign({},this._forwardAttr.style)),this.add(this._forwardController))},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._playController.addEventListener("pointerdown",t=>{t.stopPropagation(),!0===this._isPaused?this.play():this.pause()}),this._backwardController.addEventListener("pointerdown",t=>{t.stopPropagation(),this.backward()}),this._forwardController.addEventListener("pointerdown",t=>{t.stopPropagation(),this.forward()}))},this.renderPlay=()=>{this._isPaused?this._playController.setAttributes(Object.assign({symbolType:this._playController.getComputedAttribute("symbolType")},this._startAttr.style)):this._playController.setAttributes(Object.assign({symbolType:this._playController.getComputedAttribute("symbolType")},this._pauseAttr.style))},this.renderBackward=()=>{this._backwardController.setAttributes(this._backwardAttr.style)},this.renderForward=()=>{this._forwardController.setAttributes(this._forwardAttr.style)},this.play=()=>{this._dispatchEvent(el.OnPlay)},this.pause=()=>{this._dispatchEvent(el.OnPause)},this.forward=()=>{this._dispatchEvent(el.OnForward)},this.backward=()=>{this._dispatchEvent(el.OnBackward)},this.togglePlay=()=>{this._playController.setAttributes(this._startAttr.style),this._isPaused=!0},this.togglePause=()=>{this._playController.setAttributes(this._pauseAttr.style),this._isPaused=!1},this.updateAttributes(),this._initPlay(),this._initBackward(),this._initForward(),this._initEvents()}render(){this.updateAttributes(),this.renderPlay(),this.renderBackward(),this.renderForward()}}H5.defaultControllerAttr={visible:!0,x:0,y:0,size:20,fill:"#91caff",pickMode:"imprecise",cursor:"pointer"},H5.defaultAttributes={[eh.Start]:{},[eh.Pause]:{},[eh.Backward]:{},[eh.Forward]:{}};let H4={visible:!0,style:{x:0,y:0,dx:0,dy:0,size:20},order:0,space:10},H8=[200,10];(t0=eu||(eu={})).Default="default",t0.Reverse="reverse";let H6=({direction:t,maxIndex:e,dataIndex:i})=>t===eu.Default&&i===e,H9=({direction:t,minIndex:e,dataIndex:i})=>t===eu.Reverse&&i===e,H7=({direction:t,maxIndex:e,minIndex:i,dataIndex:r})=>H6({direction:t,maxIndex:e,dataIndex:r})||H9({direction:t,minIndex:i,dataIndex:r}),Vt=({direction:t,minIndex:e,dataIndex:i})=>t===eu.Default&&i===e,Ve=({direction:t,maxIndex:e,dataIndex:i})=>t===eu.Reverse&&i===e,Vi=({direction:t,maxIndex:e,minIndex:i,dataIndex:r})=>Vt({direction:t,minIndex:i,dataIndex:r})||Ve({direction:t,maxIndex:e,dataIndex:r}),Vr=t=>"top"===t||"bottom"===t,Vn=(t,e,i,r)=>"default"===t?Math.min(e+1,r):Math.max(e-1,i);class Vs extends Eu{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},Vs.defaultAttributes,t)),this._data=[],this._dataIndex=0,this._layoutInfo={},this._updateSliderAttrs=()=>{var t,e;let i;l1(this._handlerStyle.size)?i=this._handlerStyle.size:this._handlerStyle.size&&this._handlerStyle.size.length&&(i=ih(this._handlerStyle.size[0],this._handlerStyle.size[1]));let r={visible:this._sliderVisible,min:this._minIndex,max:this._maxIndex,value:this._dataIndex,railWidth:this._railStyle.width,railHeight:this._railStyle.height,railStyle:this._railStyle,trackStyle:this._trackStyle,handlerSize:l1(i)?i:void 0,handlerStyle:this._handlerStyle,dy:this.attribute.slider.dy,dx:this.attribute.slider.dx,slidable:!0,range:!1,handlerText:{visible:!1},startText:{visible:!1},endText:{visible:!1},disableTriggerEvent:this.attribute.disableTriggerEvent};if(Vr(this._orient)){let e=Math.max(0,this._layoutInfo.slider.size),i=null!==(t=this._railStyle.height)&&void 0!==t?t:H8["1"];r.layout="horizontal",r.railHeight=i,r.railWidth=e,r.x=this._layoutInfo.slider.x,r.y=this._layoutInfo.slider.y}else{let t=Math.max(0,this._layoutInfo.slider.size),i=null!==(e=this._railStyle.width)&&void 0!==e?e:H8["1"];r.layout="vertical",r.railWidth=i,r.railHeight=t,r.x=this._layoutInfo.slider.x,r.y=this._layoutInfo.slider.y}return r},this._initSlider=()=>{let t=this._updateSliderAttrs();this._slider=new ND(t),this._sliderVisible&&this.add(this._slider)},this._updateControllerAttrs=()=>{let t={start:this._start,pause:this._pause,forward:this._forward,backward:this._backward,disableTriggerEvent:this.attribute.disableTriggerEvent};return Vr(this._orient)?t.layout="horizontal":t.layout="vertical",t.start=Object.assign(Object.assign({},t.start),{style:Object.assign(Object.assign({},t.start.style),{x:this._layoutInfo.start.x,y:this._layoutInfo.start.y})}),t.pause=Object.assign(Object.assign({},t.pause),{style:Object.assign(Object.assign({},t.pause.style),{x:this._layoutInfo.start.x,y:this._layoutInfo.start.y})}),t.backward=Object.assign(Object.assign({},t.backward),{style:Object.assign(Object.assign({},t.backward.style),{x:this._layoutInfo.backward.x,y:this._layoutInfo.backward.y})}),t.forward=Object.assign(Object.assign({},t.forward),{style:Object.assign(Object.assign({},t.forward.style),{x:this._layoutInfo.forward.x,y:this._layoutInfo.forward.y})}),t},this._initController=()=>{let t=this._updateControllerAttrs();this._controller=new H5(t),this._controllerVisible&&this.add(this._controller)},this._initAttributes(),this._initDataIndex(),this._initLayoutInfo(),this._initController(),this._initSlider()}_initAttributes(){this._size=this.attribute.size,this._orient=this.attribute.orient,this._data=this.attribute.data,this._minIndex=0,this._maxIndex=this._data.length-1;let{slider:t={},controller:e={}}=this.attribute;this._sliderVisible=t.visible,this._railStyle=Object.assign({},t.railStyle),this._trackStyle=Object.assign({},t.trackStyle),this._handlerStyle=Object.assign({},t.handlerStyle),this._controllerVisible=e.visible,this._start=Object.assign({},e.start),this._pause=Object.assign({},e.pause),this._forward=Object.assign({},e.forward),this._backward=Object.assign({},e.backward)}_initDataIndex(){var t;this._dataIndex=null!==(t=this.attribute.dataIndex)&&void 0!==t?t:0}_initLayoutInfo(){var t,e,i;let r=[this._start,this._backward,this._forward].sort((t,e)=>t.order-e.order),n=r.filter(t=>"end"!==t.position),s=r.filter(t=>"end"===t.position),a=null!==(t=Vr(this._orient)?this._railStyle.height:this._railStyle.width)&&void 0!==t?t:H8["1"],o=r.reduce((t,e)=>{let i=e.style.size,r=ey(i)?i:ih(i[0],i[1]);return t+e.space+r},0),l=this._sliderVisible?(Vr(this._orient)?null===(e=this._size)||void 0===e?void 0:e.width:null===(i=this._size)||void 0===i?void 0:i.height)-o:0,h=l-this.attribute.slider.space,u=n.reduce((t,e)=>{let{key:i,space:r,style:{size:n}}=e,s=ey(n)?n:ih(n[0],n[1]);return this._layoutInfo[i]=Object.assign(Object.assign({},this._layoutInfo[i]),{size:s,x:Vr(this._orient)?t+r:(this._size.width-s)/2,y:Vr(this._orient)?(this._size.height-s)/2:t+r}),t+r+s},0);this._layoutInfo.slider=Object.assign(Object.assign({},this._layoutInfo.slider),{size:h,x:Vr(this._orient)?u+this.attribute.slider.space:(this._size.width-a)/2,y:Vr(this._orient)?(this._size.height-a)/2:u+this.attribute.slider.space}),s.reduce((t,e)=>{let{key:i,space:r,style:{size:n}}=e,s=ey(n)?n:ih(n[0],n[1]);return this._layoutInfo[i]=Object.assign(Object.assign({},this._layoutInfo[i]),{size:s,x:Vr(this._orient)?t+r:(this._size.width-s)/2,y:Vr(this._orient)?(this._size.height-s)/2:t+r}),t+r+s},u+l)}render(){this._initLayoutInfo(),this.renderSlider(),this.renderController()}renderSlider(){let t=this._updateSliderAttrs();this._slider.setAttributes(t)}renderController(){let t=this._updateControllerAttrs();this._controller.setAttributes(t)}dispatchCustomEvent(t,e){this._dispatchEvent(t,{eventType:t,index:e,value:this._data[e]})}}function Va(){N_(),v8(),_2()}Vs.defaultAttributes={visible:!0,data:[],interval:1e3,orient:"bottom",align:"center",size:{height:20,width:300},slider:{visible:!0,space:10,dx:0,dy:0,railStyle:{cornerRadius:5},trackStyle:{},handlerStyle:{}},controller:{visible:!0,start:Object.assign(Object.assign({},H4),{key:"start",position:"start",space:0}),pause:Object.assign(Object.assign({},H4),{key:"pause",position:"start"}),forward:Object.assign(Object.assign({},H4),{key:"forward",position:"end"}),backward:Object.assign(Object.assign({},H4),{key:"backward",position:"start"})}},(t1=ed||(ed={})).change="change",t1.play="play",t1.pause="pause",t1.backward="backward",t1.forward="forward",t1.end="end",t1.OnChange="change",t1.OnPlay="play",t1.OnPause="pause",t1.OnBackward="backward",t1.OnForward="forward",t1.OnEnd="end";Va();class Vo extends Vs{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},t)),this._activeIndex=-1,this._isReachEnd=!1,this._initAttributes=()=>{var t,e,i;super._initAttributes(),this._alternate=null!==(t=this.attribute.alternate)&&void 0!==t&&t,this._interval=null!==(e=this.attribute.interval)&&void 0!==e?e:1e3,this._direction=null!==(i=this.attribute.direction)&&void 0!==i?i:eu.Default},this._initDataIndex=()=>{var t;this._dataIndex=ej(this.attribute.dataIndex)?"default"===this._direction?this._minIndex:this._maxIndex:null!==(t=this.attribute.dataIndex)&&void 0!==t?t:0,this._slider.setAttribute("value",this._dataIndex)},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._controller.addEventListener(el.OnPlay,t=>{t.stopPropagation(),this.play()}),this._controller.addEventListener(el.OnPause,t=>{t.stopPropagation(),this.pause()}),this._controller.addEventListener(el.OnForward,t=>{t.stopPropagation(),this.forward()}),this._controller.addEventListener(el.OnBackward,t=>{t.stopPropagation(),this.backward()}),this._slider.addEventListener("change",t=>{let e=Math.floor(t.detail.value)+.5;this._dataIndex=t.detail.value>=e?Math.ceil(t.detail.value):Math.floor(t.detail.value),this._slider.setValue(this._dataIndex),this.dispatchCustomEvent(ed.change)}))},this.play=()=>{this._isPlaying||1!==this._data.length&&(this._controller.togglePause(),this._isPlaying=!0,(H7({dataIndex:this._dataIndex,maxIndex:this._maxIndex,minIndex:this._minIndex,direction:this._direction})||Vi({dataIndex:this._dataIndex,maxIndex:this._maxIndex,minIndex:this._minIndex,direction:this._direction}))&&(this._direction===eu.Default?this._updateDataIndex(this._minIndex):this._updateDataIndex(this._maxIndex)),this.dispatchCustomEvent(ed.play),this._isReachEnd=!1,this._tickTime=Date.now(),this._rafId=lX.getRequestAnimationFrame()(this._play.bind(this,!0)))},this._play=t=>{let e=Date.now();if(this._isReachEnd&&e-this._tickTime>=this._interval)return this._isReachEnd=!1,void this._playEnd();t&&this._activeIndex!==this._dataIndex?(this.dispatchCustomEvent(ed.change),this._activeIndex=this._dataIndex):e-this._tickTime>=this._interval&&(this._tickTime=e,this._updateDataIndex(Vn(this._direction,this._dataIndex,this._minIndex,this._maxIndex)),this._activeIndex=this._dataIndex,this.dispatchCustomEvent(ed.change)),("default"===this._direction&&this._dataIndex>=this._maxIndex||"reverse"===this._direction&&this._dataIndex<=this._minIndex)&&(this._isReachEnd=!0),this._rafId=lX.getRequestAnimationFrame()(this._play.bind(this,!1))},this._updateDataIndex=t=>{this._dataIndex=t,this._slider.setValue(this._dataIndex)},this._playEnd=()=>{this._isPlaying=!1,this._controller.togglePlay(),lX.getCancelAnimationFrame()(this._rafId),this._activeIndex=-1,this.dispatchCustomEvent(ed.end)},this.pause=()=>{this._isPlaying&&(this._isPlaying=!1,lX.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(ed.pause))},this.backward=()=>{let t;let{loop:e=!1}=this.attribute;t=e?this._dataIndex-1<this._minIndex?this._maxIndex:this._dataIndex-1:Math.max(this._dataIndex-1,this._minIndex),this._updateDataIndex(t),this.dispatchCustomEvent(ed.change),this.dispatchCustomEvent(ed.backward)},this.forward=()=>{let t;let{loop:e=!1}=this.attribute;t=e?this._dataIndex+1>this._maxIndex?this._minIndex:this._dataIndex+1:Math.min(this._dataIndex+1,this._maxIndex),this._updateDataIndex(t),this.dispatchCustomEvent(ed.change),this.dispatchCustomEvent(ed.forward)},this._initAttributes(),this._initDataIndex(),this._initEvents()}setAttributes(t,e){super.setAttributes(t,e),this._initAttributes()}dispatchCustomEvent(t){super.dispatchCustomEvent(t,this._dataIndex)}}Va();class Vl extends Vs{constructor(t){super(t),this._isPlaying=!1,this._startTime=Date.now(),this._initAttributes=()=>{var t;super._initAttributes(),this._maxIndex=this._data.length,this._slider.setAttribute("max",this._maxIndex),this._isPlaying=!1,this._elapsed=0,this._interval=null!==(t=this.attribute.interval)&&void 0!==t?t:1e3;let e=this._data.length;this.attribute.totalDuration&&this._data.length?(this._totalDuration=this.attribute.totalDuration,this._interval=this._totalDuration/(null!=e?e:1)):(this._totalDuration=this._interval*e,this._interval=this.attribute.interval)},this._initDataIndex=()=>{var t;this._dataIndex=null!==(t=this.attribute.dataIndex)&&void 0!==t?t:this._minIndex},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._controller.addEventListener(el.OnPlay,t=>{t.stopPropagation(),this.play()}),this._controller.addEventListener(el.OnPause,t=>{t.stopPropagation(),this.pause()}),this._controller.addEventListener(el.OnForward,t=>{t.stopPropagation(),this.forward()}),this._controller.addEventListener(el.OnBackward,t=>{t.stopPropagation(),this.backward()}),this._slider.addEventListener("change",t=>{var e;t.stopPropagation();let i=null===(e=t.detail)||void 0===e?void 0:e.value,r=i/this._maxIndex;this._elapsed=r*this._totalDuration,this._startTime=Date.now()-this._elapsed,this._dispatchChange(i)}))},this._getSliderValue=()=>Math.min(this._elapsed/this._totalDuration*this._maxIndex,this._maxIndex),this._updateSlider=()=>{let t=this._getSliderValue();this._dataIndex=Math.floor(t),this._slider.setValue(Math.min(t,this._maxIndex)),this._dispatchChange(Math.floor(t))},this._dispatchChange=t=>{let e=Math.floor(t);e!==this._activeIndex&&(this._dataIndex=e,this._activeIndex=e,e!==this._maxIndex&&this.dispatchCustomEvent(ed.change))},this.play=()=>{var t,e,i,r;return t=this,e=void 0,i=void 0,r=function*(){this._isPlaying||(this._controller.togglePause(),this._isPlaying=!0,this._elapsed>=this._totalDuration&&(this._elapsed=0),this._startTime=Date.now()-this._elapsed,this.dispatchCustomEvent(ed.play),this._rafId=lX.getRequestAnimationFrame()(this._play.bind(this)))},new(i||(i=Promise))(function(n,s){function a(t){try{l(r.next(t))}catch(t){s(t)}}function o(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?n(t.value):((e=t.value)instanceof i?e:new i(function(t){t(e)})).then(a,o)}l((r=r.apply(t,e||[])).next())})},this._play=()=>{this._elapsed=Date.now()-this._startTime;let t=this._getSliderValue();this._updateSlider(),t>=this._maxIndex?this._playEnd():this._rafId=lX.getRequestAnimationFrame()(this._play.bind(this))},this._playEnd=()=>{this._isPlaying=!1,lX.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(ed.end)},this.pause=()=>{this._isPlaying&&(this._isPlaying=!1,this._elapsed=Date.now()-this._startTime,lX.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(ed.pause))},this.backward=()=>{let t=Date.now(),e=1*this._interval,i=this._elapsed-e;i<=0?(this._elapsed=0,this._startTime=t):(this._elapsed=i,this._startTime=this._startTime+this._interval),this._updateSlider(),this.dispatchCustomEvent(ed.backward)},this.forward=()=>{let t=Date.now(),e=1*this._interval,i=this._elapsed+e;i>=this._totalDuration?(this._startTime=t-this._totalDuration,this._elapsed=this._totalDuration):(this._startTime=this._startTime-e,this._elapsed=i),this._updateSlider(),this.dispatchCustomEvent(ed.forward)},this._initAttributes(),this._initDataIndex(),this._initEvents()}dispatchCustomEvent(t){super.dispatchCustomEvent(t,this._dataIndex)}render(){super.render()}}let Vh=t=>Tz(Object.assign({},t)),Vu=t=>Tz(Object.assign({},t)),Vd=t=>Object.assign(Object.assign({},t),{style:Object.assign({},Tz(t.style))}),Vc=t=>{var e,i,r,n,s,a,o,l,h,u,d,c,p,g,f;let m=Vh(null!==(i=null===(e=null==t?void 0:t.slider)||void 0===e?void 0:e.trackStyle)&&void 0!==i?i:{}),v=Vh(null!==(n=null===(r=null==t?void 0:t.slider)||void 0===r?void 0:r.railStyle)&&void 0!==n?n:{}),y=Vu(null!==(a=null===(s=null==t?void 0:t.slider)||void 0===s?void 0:s.handlerStyle)&&void 0!==a?a:{}),_=Vd(null!==(l=null===(o=null==t?void 0:t.controller)||void 0===o?void 0:o.start)&&void 0!==l?l:{}),b=Vd(null!==(u=null===(h=null==t?void 0:t.controller)||void 0===h?void 0:h.pause)&&void 0!==u?u:{}),x=Vd(null!==(c=null===(d=null==t?void 0:t.controller)||void 0===d?void 0:d.backward)&&void 0!==c?c:{}),S=Vd(null!==(g=null===(p=null==t?void 0:t.controller)||void 0===p?void 0:p.forward)&&void 0!==g?g:{}),k=Object.assign(Object.assign({},t),{direction:t.direction,interval:t.interval,visible:t.visible,orient:null!==(f=t.orient)&&void 0!==f?f:"bottom",slider:Object.assign(Object.assign({},t.slider),{trackStyle:m,railStyle:v,handlerStyle:y}),controller:Object.assign(Object.assign({},t.controller),{start:_,pause:b,backward:x,forward:S})});return t.visible||(k.controller.visible=!1,k.slider.visible=!1),k},Vp=(t,e)=>Object.assign(Object.assign({},Vc(t)),{data:e,type:"continuous"}),Vg=(t,e)=>Object.assign(Object.assign({},Vc(t)),{data:e,type:"discrete"}),Vf=t=>"left"===t||"right"===t,Vm=t=>"top"===t||"bottom"===t;class Vv extends Ea{constructor(){super(...arguments),this.layoutZIndex=tM.Player,this.layoutLevel=tC.Player,this.specKey="player",this.type=lx.player,this._orient="bottom",this._getPlayerAttrs=()=>{var t,e,i,r,n,s;let a=this._spec.type,o={size:{width:this._width,height:this._height},dx:null!==(t=this._spec.dx)&&void 0!==t?t:0+this._dx,dy:null!==(e=this._spec.dy)&&void 0!==e?e:0+this._dy};return"discrete"===a?Object.assign(Object.assign(Object.assign({},Vg(this._spec,this._specs)),o),{disableTriggerEvent:this._option.disableTriggerEvent,loop:null===(r=null===(i=this._spec)||void 0===i?void 0:i.loop)||void 0===r||r}):Object.assign(Object.assign(Object.assign({},Vp(this._spec,this._specs)),o),{disableTriggerEvent:this._option.disableTriggerEvent,loop:null===(s=null===(n=this._spec)||void 0===n?void 0:n.loop)||void 0===s||s})},this._createOrUpdatePlayerComponent=()=>{let t=Object.assign({},this._getPlayerAttrs()),e=this.getContainer();this._playerComponent?my(t,this._cacheAttrs)||(this._cacheAttrs=t,this._playerComponent.setAttributes(t),this._playerComponent._initAttributes(),this._playerComponent.render()):("discrete"===t.type?this._playerComponent=new Vo(t):this._playerComponent=new Vl(t),this._cacheAttrs=t,this._playerComponent.name="player",e.add(this._playerComponent),this._initEvent())},this._maxSize=()=>{var t,e,i,r,n,s,a,o,l;return Math.max(...om(null===(e=null===(t=this._spec.controller.start)||void 0===t?void 0:t.style)||void 0===e?void 0:e.size),...om(null===(r=null===(i=this._spec.controller.pause)||void 0===i?void 0:i.style)||void 0===r?void 0:r.size),...om(null===(s=null===(n=this._spec.controller.backward)||void 0===n?void 0:n.style)||void 0===s?void 0:s.size),...om(null===(o=null===(a=this._spec.controller.forward)||void 0===a?void 0:a.style)||void 0===o?void 0:o.size),null!==(l=Vf(this._orient)?this._spec.slider.railStyle.width:this._spec.slider.railStyle.height)&&void 0!==l?l:10)},this._sliderExceededSize=()=>{var t,e,i,r,n,s,a,o,l;let h=null!==(t=Vf(this._orient)?this._spec.slider.railStyle.width:this._spec.slider.railStyle.height)&&void 0!==t?t:10,u=Math.max(...om(null===(i=null===(e=this._spec.controller.start)||void 0===e?void 0:e.style)||void 0===i?void 0:i.size),...om(null===(n=null===(r=this._spec.controller.pause)||void 0===r?void 0:r.style)||void 0===n?void 0:n.size),...om(null===(a=null===(s=this._spec.controller.backward)||void 0===s?void 0:s.style)||void 0===a?void 0:a.size),...om(null===(l=null===(o=this._spec.controller.forward)||void 0===o?void 0:o.style)||void 0===l?void 0:l.size));return h>=u?h-u:0},this._initEvent=()=>{this._option.disableTriggerEvent||(this._option.globalInstance.on(c1.rendered,()=>{var t;(null===(t=this._spec)||void 0===t?void 0:t.auto)&&this._playerComponent.play()}),this._playerComponent.addEventListener(ed.end,()=>{var t;this.event.emit(c1.playerEnd,{model:this}),this._alternate&&"discrete"===this._spec.type&&(this._direction="default"===this._direction?"reverse":"default",this._playerComponent.setAttributes({direction:this._direction,dataIndex:"reverse"===this._direction?this._specs.length-2:1})),(null===(t=this._spec)||void 0===t?void 0:t.loop)&&this._playerComponent.play()}),this._playerComponent.addEventListener(ed.change,t=>{let{index:e}=t.detail,i=this._specs[e];om(i.data).forEach(t=>{var e,i;null===(i=null===(e=this._option)||void 0===e?void 0:e.globalInstance)||void 0===i||i.updateData(t.id,t.values)}),this.event.emit(c1.playerChange,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(ed.backward,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(c1.playerBackward,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(ed.forward,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(c1.playerForward,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(ed.play,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(c1.playerPlay,{model:this,value:{spec:i,index:e,specs:this._specs}})}),this._playerComponent.addEventListener(ed.pause,t=>{let{index:e}=t.detail,i=this._specs[e];this.event.emit(c1.playerPause,{model:this,value:{spec:i,index:e,specs:this._specs}})}))}}get orient(){return this._orient}set layoutOrient(t){this._orient=t}static getSpecInfo(t){let e=t[this.specKey];return ej(e)?null:[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.player}]}setAttrFromSpec(){var t,e,i,r,n,s,a,o;super.setAttrFromSpec(),this._orient=null!==(t=this._spec.orient)&&void 0!==t?t:"bottom",this._specs=null!==(e=this._spec.specs)&&void 0!==e?e:[],this._direction=null!==(i=this._spec.direction)&&void 0!==i?i:"default",this._alternate=null!==(r=this._spec.alternate)&&void 0!==r&&r,this._dx=null!==(n=this._spec.dx)&&void 0!==n?n:0,this._dy=null!==(s=this._spec.dy)&&void 0!==s?s:0,this._position=null!==(a=this._spec.position)&&void 0!==a?a:"middle",this._visible=null===(o=this._spec.visible)||void 0===o||o}afterSetLayoutStartPoint(t){if(super.afterSetLayoutStartPoint(t),l1(t.x)){let e=Vf(this._orient)?t.x+this._sliderExceededSize()/2:t.x;this._playerComponent&&this._playerComponent.setAttribute("x",e)}if(l1(t.y)){let e=Vm(this._orient)?t.y+this._sliderExceededSize()/2:t.y;this._playerComponent&&this._playerComponent.setAttribute("y",e)}}getBoundsInRect(t,e){this._width=this._computeWidth(t),this._height=this._computeHeight(t),this._dx=this._computeDx(e),this._dy=this._computeDy(e);let i=this._computeLayoutRect(t,this._width,this._height);return this._createOrUpdatePlayerComponent(),i}changeRegions(t){}onRender(t){}_getNeedClearVRenderComponents(){return[this._playerComponent]}_computeLayoutRect(t,e,i){if(!1===this._visible)return{x1:0,x2:0,y1:0,y2:0};switch(this._orient){case"top":case"left":return{x1:0,y1:0,x2:e,y2:i};case"right":return{x1:t.width-e,y1:0,x2:t.width,y2:t.height};default:return{x1:0,y1:t.height-i,x2:t.width,y2:t.height}}}_computeWidth(t){return ey(this._spec.width)?Math.min(t.width,Number(this._spec.width)):Vf(this._orient)?this._maxSize():t.width}_computeHeight(t){return ey(this._spec.height)?(this._height=this._spec.height,Math.min(t.height,Number(this._spec.height))):Vm(this._orient)?this._maxSize():t.height}_computeDx(t){return Vf(this._orient)||"start"===this._position?0:"middle"===this._position?(t.width-this._width)/2:t.width-this._width}_computeDy(t){return Vm(this._orient)||"start"===this._position?0:"middle"===this._position?(t.height-this._height)/2:t.height-this._height}}Vv.specKey="player",Vv.type=lx.player;let Vy=new Uint32Array(33),V_=new Uint32Array(33);V_[0]=0,Vy[0]=~V_[0];for(let t=1;t<=32;++t)V_[t]=V_[t-1]<<1|1,Vy[t]=~V_[t];function Vb(t,e,i={top:0,left:0,right:0,bottom:0}){let{top:r=0,left:n=0,right:s=0,bottom:a=0}=i,o=Math.max(1,Math.sqrt(t*e/1e6)),l=~~((t+n+s+o)/o),h=~~((e+r+a+o)/o),u=t=>~~(t/o);return u.bitmap=()=>(function(t,e){let i=new Uint32Array(~~((t*e+32)/32));function r(t,e){i[t]|=e}function n(t,e){i[t]&=e}return{array:i,get:(e,r)=>{let n=r*t+e;return i[n>>>5]&1<<(31&n)},set:(e,r)=>{var n,s;let a=r*t+e;n=a>>>5,s=1<<(31&a),i[n]|=s},clear:(e,r)=>{var n,s;let a=r*t+e;n=a>>>5,s=~(1<<(31&a)),i[n]&=s},getRange:({x1:r,y1:n,x2:s,y2:a})=>{if(s<0||a<0||r>t||n>e)return!0;let o,l,h,u,d=a;for(;d>=n;--d)if(o=d*t+r,l=d*t+s,(h=o>>>5)==(u=l>>>5)){if(i[h]&Vy[31&o]&V_[1+(31&l)])return!0}else{if(i[h]&Vy[31&o]||i[u]&V_[1+(31&l)])return!0;for(let t=h+1;t<u;++t)if(i[t])return!0}return!1},setRange:({x1:r,y1:n,x2:s,y2:a})=>{var o,l,h,u,d,c,p;let g,f,m,v,y;if(!(s<0)&&!(a<0)&&!(r>t)&&!(n>e))for(;n<=a;++n)if(g=n*t+r,f=n*t+s,(m=g>>>5)==(v=f>>>5)){;o=m,l=Vy[31&g]&V_[1+(31&f)],i[o]|=l}else{;for(h=m,u=Vy[31&g],i[h]|=u,d=v,c=V_[1+(31&f)],i[d]|=c,y=m+1;y<v;++y){;p=y,i[p]|=4294967295}}},clearRange:({x1:e,y1:r,x2:n,y2:s})=>{var a,o,l,h,u,d,c;let p,g,f,m,v;for(;r<=s;++r)if(p=r*t+e,g=r*t+n,(f=p>>>5)==(m=g>>>5)){;a=f,o=V_[31&p]|Vy[1+(31&g)],i[a]&=o}else{;for(l=f,h=V_[31&p],i[l]&=h,u=m,d=Vy[1+(31&g)],i[u]&=d,v=f+1;v<m;++v){;c=v,i[c]&=0}}},outOfBounds:({x1:i,y1:r,x2:n,y2:s})=>i<0||r<0||s>=e||n>=t,toImageData:r=>{let n=r.createImageData(t,e),s=n.data;for(let r=0;r<e;++r)for(let e=0;e<t;++e){let n=r*t+e,a=4*n,o=i[n>>>5]&1<<(31&n);s[a+0]=255*o,s[a+1]=255*o,s[a+2]=255*o,s[a+3]=31}return n}}})(l,h),u.x=t=>~~((t+n)/o),u.y=t=>~~((t+r)/o),u.ratio=o,u.padding=i,u.width=t,u.height=e,u}function Vx(t,e,i=!1){if(i){let{x1:i,x2:r,y1:n,y2:s}=e,a=nL(i,0,t.width),o=nL(r,0,t.width),l=nL(n,0,t.height),h=nL(s,0,t.height);return{x1:t.x(a),x2:t.x(o),y1:t.y(l),y2:t.y(h)}}return{x1:t.x(e.x1),x2:t.x(e.x2),y1:t.y(e.y1),y2:t.y(e.y2)}}let VS=["#ffffff","#000000"];function Vk(t,e,i,r,n,s){if("string"!=typeof t||"string"!=typeof e)return t;let a=new n$(t).toHex(),o=new n$(e).toHex();return VA(a,o,i,r,s)?a:function(t,e,i,r,n,s){let a=[];for(let o of(n&&(n instanceof Array?a.push(...n):a.push(n)),a.push(...VS),a))if(t!==o&&VA(o,e,i,r,s))return o}(a,o,i,r,n,s)}function VA(t,e,i,r,n){if("lightness"===n){let i=n$.getColorBrightness(new n$(e));return .5>n$.getColorBrightness(new n$(t))?i>=.5:i<.5}return r?Vw(t,e)>r:"largeText"===i?Vw(t,e)>3:Vw(t,e)>4.5}function Vw(t,e){let i=VM(t),r=VM(e);return((i>r?i:r)+.05)/((i>r?r:i)+.05)}function VM(t){let e,i;let r=xG(t),n=r[0]/255,s=r[1]/255,a=r[2]/255;return e=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),i=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),.2126*e+.7152*i+.0722*(a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4))}function VC(t,e,i,r){let n;switch(t){case"base":n=e;break;case"invertBase":n=i;break;case"similarBase":n=r}return n}function VT(t,e,i,r=!0,n=0){let s=i;return n>0&&(s={x1:i.x1-n,x2:i.x2+n,y1:i.y1-n,y2:i.y2+n}),s=Vx(t,s),!(r&&e.outOfBounds(s))&&!e.getRange(s)}function VE(t,e,i,r=[],n=!0,s=0){let a=r.filter(t=>eO(t));for(let r=0;r<a.length;r++){let o=i.clone();if(o.setAttributes(a[r]),o.update(),VT(t,e,o.AABBBounds,n,s))return e.setRange(Vx(t,o.AABBBounds,!0)),a[r]}return!1}let VO=["top","bottom","right","left","top-right","bottom-right","top-left","bottom-left"],VP=["top","inside-top","inside"],VR={fadeIn:(t={})=>{var e,i,r;return{from:{opacity:0,fillOpacity:0,strokeOpacity:0},to:{opacity:null!==(e=t.opacity)&&void 0!==e?e:1,fillOpacity:null!==(i=t.fillOpacity)&&void 0!==i?i:1,strokeOpacity:null!==(r=t.strokeOpacity)&&void 0!==r?r:1}}},fadeOut:(t={})=>{var e,i,r;return{from:{opacity:null!==(e=t.opacity)&&void 0!==e?e:1,fillOpacity:null!==(i=t.fillOpacity)&&void 0!==i?i:1,strokeOpacity:null!==(r=t.strokeOpacity)&&void 0!==r?r:1},to:{opacity:0,fillOpacity:0,strokeOpacity:0}}}};function VB(t,e){var i,r;return null!==(r=null===(i=VR[e])||void 0===i?void 0:i.call(VR,t))&&void 0!==r?r:{from:{},to:{}}}let VI=(t,e,i,r)=>{let n=Object.assign({},t.attribute),s=Object.assign({},e.attribute);return om(null==r?void 0:r.excludeChannels).forEach(t=>{delete s[t]}),Object.keys(s).forEach(t=>{i&&!i.includes(t)&&delete s[t]}),{from:n,to:s}};function VL(t,e,i,r){t.attribute.text!==e.attribute.text&&l1(Number(t.attribute.text)*Number(e.attribute.text))&&t.animate().play(new mW({text:t.attribute.text},{text:e.attribute.text},i,r))}let VD={mode:"same-time",duration:300,easing:"linear"};function VF(t,e,i,r){var n;let s=(n={radius:i,angle:r}).radius?{x:Math.cos(n.angle)*n.radius,y:Math.sin(n.angle)*n.radius}:{x:0,y:0};return{x:t+s.x,y:e+s.y}}function Vj(t){return 3===t||4===t}let VN=(t,e,i="top",r=0)=>{if(!t)return;let{x1:n,y1:s,x2:a,y2:o}=t,l=Math.abs(a-n),h=Math.abs(o-s),u=(e.x1+e.x2)/2,d=(e.y1+e.y2)/2,c=0,p=0,g=0,f=0;e&&(g=Math.abs(e.x1-e.x2)/2,f=Math.abs(e.y1-e.y2)/2);let m={"top-right":-235,"top-left":235,"bottom-right":45,"bottom-left":-45};switch(i){case"top":p=-1;break;case"bottom":p=1;break;case"left":c=-1;break;case"right":c=1;break;case"bottom-left":case"bottom-right":case"top-left":case"top-right":c=Math.sin(m[i]*(Math.PI/180)),p=Math.cos(m[i]*(Math.PI/180));break;case"center":c=0,p=0}return{x:u+c*(r+g)+l/2*Math.sign(c),y:d+p*(r+f)+h/2*Math.sign(p)}},Vz=t=>{if(!t||!t.attribute)return[];let{points:e,segments:i}=t.attribute;if(i&&i.length){let t=[];return i.forEach(e=>{e.points.forEach(e=>{t.push(e)})}),t}return e};function VH(t,e,i="end",r=0){if(!t||!e)return{x:1/0,y:1/0};let{x1:n,x2:s}=t,a=Math.abs(s-n),o=e.x1,l=o;return"end"===i?l=o+a/2+r:"start"===i&&(l=o-a/2-r),{x:l,y:e.y1}}function VV(t,e,i,r,n,s){return Math.abs(e/t)<s/n?{x:i+(t>0?n:-n),y:r+e*n/Math.abs(t)}:{x:i+t*s/Math.abs(e),y:r+(e>0?s:-s)}}v8(),yG(),Al(),kP();class VW extends Eu{setBitmap(t){this._bitmap=t}setBitmapTool(t){this._bmpTool=t}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},VW.defaultAttributes,t)),this.name="label",this._onHover=t=>{let e=t.target;e===this._lastHover||mk(e.states)||(e.addState(tT.hover,!0),Tf(this,t=>{t===e||mk(t.states)||t.addState(tT.hoverReverse,!0)}),this._lastHover=e)},this._onUnHover=t=>{this._lastHover&&(Tf(this,t=>{mk(t.states)||(t.removeState(tT.hoverReverse),t.removeState(tT.hover))}),this._lastHover=null)},this._onClick=t=>{let e=t.target;if(this._lastSelect===e&&e.hasState("selected"))return this._lastSelect=null,void Tf(this,t=>{mk(t.states)||(t.removeState(tT.selectedReverse),t.removeState(tT.selected))});mk(e.states)||(e.addState(tT.selected,!0),Tf(this,t=>{t===e||mk(t.states)||t.addState(tT.selectedReverse,!0)}),this._lastSelect=e)},this._handleRelatedGraphicSetState=t=>{var e,i,r,n,s;if((null===(e=t.detail)||void 0===e?void 0:e.type)===lw.STATE||(null===(i=t.detail)||void 0===i?void 0:i.type)===lw.ANIMATE_UPDATE&&(null===(r=t.detail.animationState)||void 0===r?void 0:r.isFirstFrameOfStep)){let e=null!==(s=null===(n=t.target)||void 0===n?void 0:n.currentStates)&&void 0!==s?s:[],i=this._isCollectionBase?[...this._graphicToText.values()]:[this._graphicToText.get(t.target)];this.updateStatesOfLabels(i,e)}}}labeling(t,e,i,r){}_createLabelLine(t,e){let i=function(t,e){if(!t||!e||a4(t,e,!0))return;let i=Math.min(t.x1,t.x2),r=Math.min(t.y1,t.y2),n=Math.min(e.x1,e.x2),s=Math.min(e.y1,e.y2),a=Math.abs(t.x2-i)/2,o=Math.abs(t.y2-r)/2,l=Math.abs(e.x2-n)/2,h=Math.abs(e.y2-s)/2,u=i+a,d=r+o,c=n+l,p=s+h,g=c-u,f=p-d;return[VV(g,f,u,d,a,o),VV(-g,-f,c,p,l,h)]}(t.AABBBounds,null==e?void 0:e.AABBBounds);if(i){let r=aj.line({points:i});if(null==r?void 0:r.customShape){let e=r.customShape;r.pathProxy=i=>e(t.attribute,i,new rg)}return e&&e.attribute.fill&&r.setAttribute("stroke",e.attribute.fill),this.attribute.line&&!mk(this.attribute.line.style)&&r.setAttributes(this.attribute.line.style),this._setStatesOfLabelLine(r),r}}render(){if(this._prepare(),ej(this._idToGraphic)||this._isCollectionBase&&ej(this._idToPoint))return;let{overlap:t,smartInvert:e,dataFilter:i,customLayoutFunc:r,customOverlapFunc:n}=this.attribute,s=this.attribute.data;nx(i)&&(s=i(s));let a=this._initText(s);a=nx(r)?r(s,a,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null):this._layout(a),nx(n)?a=n(a,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null):!1!==t&&(a=this._overlapping(a)),nx(this.attribute.onAfterOverlapping)&&this.attribute.onAfterOverlapping(a,this.getRelatedGraphic.bind(this),this._isCollectionBase?t=>this._idToPoint.get(t.id):null),a&&a.length&&a.forEach(t=>{this._bindEvent(t),this._setStatesOfText(t)}),!1!==e&&this._smartInvert(a),this._renderLabels(a)}_bindEvent(t){if(this.attribute.disableTriggerEvent||!t)return;let{hover:e,select:i}=this.attribute;e&&(t.addEventListener("pointermove",this._onHover),t.addEventListener("pointerout",this._onUnHover)),i&&t.addEventListener("pointerdown",this._onClick)}_setStatesOfText(t){if(!t)return;let e=this.attribute.state;e&&!mk(e)&&(t.states=e)}_setStatesOfLabelLine(t){if(!t)return;let e=this.attribute.labelLineState;e&&!mk(e)&&(t.states=e)}_createLabelText(t){var e,i;return MP(Object.assign(Object.assign({},null===(i=null===(e=this.stage)||void 0===e?void 0:e.getTheme())||void 0===i?void 0:i.text),t),"textType")}_prepare(){var t,e,i,r,n;let s=[];if((nx(this.attribute.getBaseMarks)?this.attribute.getBaseMarks():function(t,e){if(!e)return[];let i=t.find(t=>t.name===e,!0);return i?i.getChildren():[]}(this.getRootNode(),this.attribute.baseMarkGroupName)).forEach(t=>{"willRelease"!==t.releaseStatus&&s.push(t)}),null===(t=this._idToGraphic)||void 0===t||t.clear(),null===(e=this._idToPoint)||void 0===e||e.clear(),this._baseMarks=s,this._isCollectionBase="line-data"===this.attribute.type,!s||0===s.length)return;let{data:a}=this.attribute;if(a&&0!==a.length){if(this._idToGraphic||(this._idToGraphic=new Map),this._isCollectionBase){this._idToPoint||(this._idToPoint=new Map);let t=0;for(let e=0;e<s.length;e++){let i=s[e],r=Vz(i);if(r&&r.length)for(let e=0;e<r.length;e++){let n=a[t];n&&r[e]&&(eO(n.id)||(n.id=`vrender-component-${this.name}-${t}`),this._idToPoint.set(n.id,r[e]),this._idToGraphic.set(n.id,i)),t++}}}else for(let t=0;t<s.length;t++){let e=a[t],i=s[t];e&&i&&(eO(e.id)||(e.id=`vrender-component-${this.name}-${t}`),this._idToGraphic.set(e.id,i))}if(!1!==this.attribute.animation){let t=nb(this.attribute.animation)?this.attribute.animation:{};this._animationConfig={enter:eF({},VD,t,null!==(i=this.attribute.animationEnter)&&void 0!==i?i:{}),exit:eF({},VD,t,null!==(r=this.attribute.animationExit)&&void 0!==r?r:{}),update:eM(this.attribute.animationUpdate)?this.attribute.animationUpdate:eF({},VD,t,null!==(n=this.attribute.animationUpdate)&&void 0!==n?n:{})}}}}getRelatedGraphic(t){return this._idToGraphic.get(t.id)}_initText(t=[]){let{textStyle:e={}}=this.attribute,i=[];for(let r=0;r<t.length;r++){let n=t[r],s=this.getRelatedGraphic(n);if(!s)continue;let a=Object.assign(Object.assign({fill:this._isCollectionBase?eM(s.attribute.stroke)?s.attribute.stroke.find(t=>!!t&&!0!==t):s.attribute.stroke:s.attribute.fill},e),n),o=this._createLabelText(a);i.push(o)}return i}_layout(t){let{position:e,offset:i}=this.attribute;for(let r=0;r<t.length;r++){let n=t[r];if(!n)return;let s=n.attribute,a=this.getRelatedGraphic(s);if(!a)continue;n.attachedThemeGraphic=this;let o=this.getGraphicBounds(n);n.attachedThemeGraphic=null;let l=nx(e)?e(s):e,h=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(s.id),l):this.getGraphicBounds(a,{x:s.x,y:s.y},l),u=this.labeling(o,h,l,i);u&&n.setAttributes(u)}return t}_overlapping(t){var e,i,r,n;if(0===t.length)return[];let s=nb(this.attribute.overlap)?this.attribute.overlap:{},a=[],o=this.getBaseMarkGroup(),l=null!==(e=s.size)&&void 0!==e?e:{width:null!==(i=null==o?void 0:o.AABBBounds.width())&&void 0!==i?i:0,height:null!==(r=null==o?void 0:o.AABBBounds.height())&&void 0!==r?r:0};if(0===l.width||0===l.height)return t;let{avoidBaseMark:h,strategy:u=[],hideOnHit:d=!0,clampForce:c=!0,avoidMarks:p=[],overlapPadding:g}=s,f=this._bmpTool||Vb(l.width,l.height),m=this._bitmap||f.bitmap(),v=u.some(t=>"bound"===t.type);h&&(null===(n=this._baseMarks)||void 0===n||n.forEach(t=>{t.AABBBounds&&m.setRange(Vx(f,t.AABBBounds,!0))})),p.length>0&&p.forEach(t=>{eE(t)?(function(t,e){if(!e)return[];let i=t.find(t=>t.name===e,!0);return i?i.findAll(t=>"group"!==t.type,!0):[]})(this.getRootNode(),t).forEach(t=>{t.AABBBounds&&m.setRange(Vx(f,t.AABBBounds,!0))}):t.AABBBounds&&m.setRange(Vx(f,t.AABBBounds,!0))});for(let e=0;e<t.length;e++){if(!1===t[e].visible)continue;let i=t[e],r=this.getRelatedGraphic(i.attribute);if(i.update(),!a4(r.AABBBounds,{x1:0,x2:f.width,y1:0,y2:f.height},!0))continue;if(VT(f,m,i.AABBBounds,c,g)&&(!v||v&&r&&r.AABBBounds&&this._canPlaceInside(i.AABBBounds,r.AABBBounds))){m.setRange(Vx(f,i.AABBBounds,!0)),a.push(i);continue}let n=!1;for(let s=0;s<u.length;s++)if(!1!==(n=function(t,e,i,r,n,s,a){var o,l;let h=null===(o=r.overlap)||void 0===o?void 0:o.clampForce,u=null===(l=r.overlap)||void 0===l?void 0:l.overlapPadding;if("bound"===i.type||"position"===i.type){if(nx(a)){let o=((nx(i.position)?i.position(n.attribute):i.position)||function(t){return"rect"===t?VP:VO}(r.type)).map(t=>a(n.AABBBounds,s,t,r.offset));return VE(t,e,n,o,h,u)}return!1}if("moveY"===i.type){let r=(i.offset?nx(i.offset)?i.offset(n.attribute):i.offset:[]).map(t=>({x:n.attribute.x,y:n.attribute.y+t}));return VE(t,e,n,r,h,u)}if("moveX"===i.type){let r=(i.offset?nx(i.offset)?i.offset(n.attribute):i.offset:[]).map(t=>({x:n.attribute.x+t,y:n.attribute.y}));return VE(t,e,n,r,h,u)}return!1}(f,m,u[s],this.attribute,i,this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(t[e].attribute.id)):this.getGraphicBounds(r,t[e].attribute),this.labeling))){i.setAttributes({x:n.x,y:n.y}),a.push(i);break}if(!n&&c){let{dx:t=0,dy:e=0}=function(t,e,i){let{x1:r,x2:n,y1:s,y2:a}=t.AABBBounds,o=Math.min(r,n),l=Math.max(r,n),h=Math.min(s,a),u=Math.max(s,a),d=0,c=0;return o<0&&l-o<=e?d=-o:l>e&&o-(l-e)>=0&&(d=e-l),h<0&&u-h<=i?c=-h:u>i&&h-(u-i)>=0&&(c=i-u),{dx:d,dy:c}}(i,f.width,f.height);if(0===t&&0===e){if(VT(f,m,i.AABBBounds)){m.setRange(Vx(f,i.AABBBounds,!0)),a.push(i);continue}}else if(VT(f,m,{x1:i.AABBBounds.x1+t,x2:i.AABBBounds.x2+t,y1:i.AABBBounds.y1+e,y2:i.AABBBounds.y2+e})){i.setAttributes({x:i.attribute.x+t,y:i.attribute.y+e}),m.setRange(Vx(f,i.AABBBounds,!0)),a.push(i);continue}}n||d||a.push(i)}return a}getBaseMarkGroup(){let{baseMarkGroupName:t}=this.attribute;if(t)return this.getRootNode().find(e=>e.name===t,!0)}getGraphicBounds(t,e={}){if(t){if(!1!==t.attribute.visible)return t.AABBBounds;let{x:e,y:i}=t.attribute;return{x1:e,x2:e,y1:i,y2:i}}let{x:i,y:r}=e;return{x1:i,x2:i,y1:r,y2:r}}_renderLabels(t){!1===this._enableAnimation||!1===this.attribute.animation?this._renderWithOutAnimation(t):this._renderWithAnimation(t)}_renderWithAnimation(t){var e;let{syncState:i}=this.attribute,r=new Map,n=this._graphicToText||new Map,s=[],a=[],{visible:o}=null!==(e=this.attribute.line)&&void 0!==e?e:{};t&&t.forEach((t,e)=>{var l;let h;let u=this.getRelatedGraphic(t.attribute),d=t.attribute.id,c=this._isCollectionBase?d:u,p=(null==n?void 0:n.get(c))?"update":"enter";if(o&&(h=this._createLabelLine(t,u)),i&&this.updateStatesOfLabels([h?{text:t,labelLine:h}:{text:t}],null!==(l=u.currentStates)&&void 0!==l?l:[]),"enter"===p){if(s.push(t),r.set(c,h?{text:t,labelLine:h}:{text:t}),u){let{from:i,to:r}=VB(t.attribute,"fadeIn");this.add(t),h&&(a.push(h),this.add(h)),this._syncStateWithRelatedGraphic(u),this._animationConfig.enter.duration>0&&u.once("animate-bind",n=>{t.setAttributes(i),h&&h.setAttributes(i);let o=this._afterRelatedGraphicAttributeUpdate(t,s,h,a,e,u,r,this._animationConfig.enter);u.on("afterAttributeUpdate",o)})}}else if("update"===p){let e=n.get(c);n.delete(c),r.set(c,e);let i=e.text,{duration:s,easing:a}=this._animationConfig.update;(function(t,e,i){if(!eM(i)){let{duration:r,easing:n,increaseEffect:s=!0}=i;return t.animate().to(e.attribute,r,n),void(s&&VL(t,e,r,n))}i.forEach((i,r)=>{let{duration:n,easing:s,increaseEffect:a=!0,channel:o}=i,{from:l,to:h}=VI(t,e,o,i.options);mk(h)||t.animate().to(h,n,s),"text"in l&&"text"in h&&a&&VL(t,e,n,s)})})(i,t,this._animationConfig.update),e.labelLine&&h&&e.labelLine.animate().to(h.attribute,s,a)}}),n.forEach(t=>{var e;null===(e=t.text)||void 0===e||e.animate().to(VB(t.text.attribute,"fadeOut").to,this._animationConfig.exit.duration,this._animationConfig.exit.easing).onEnd(()=>{this.removeChild(t.text),t.labelLine&&this.removeChild(t.labelLine)})}),this._graphicToText=r}_renderWithOutAnimation(t){var e;let{syncState:i}=this.attribute,r=new Map,n=this._graphicToText||new Map,s=[],{visible:a}=null!==(e=this.attribute.line)&&void 0!==e?e:{};t&&t.forEach(t=>{var e;let o;let l=this.getRelatedGraphic(t.attribute),h=(null==n?void 0:n.get(l))?"update":"enter",u=this._isCollectionBase?t.attribute.id:l;if(a&&(o=this._createLabelLine(t,l)),i&&this.updateStatesOfLabels([o?{text:t,labelLine:o}:{text:t}],null!==(e=l.currentStates)&&void 0!==e?e:[]),"enter"===h)s.push(t),r.set(u,o?{text:t,labelLine:o}:{text:t}),this.add(t),o&&this.add(o),this._syncStateWithRelatedGraphic(l);else if("update"===h){let e=n.get(u);n.delete(u),r.set(u,e),e.text.setAttributes(t.attribute),e.labelLine&&o&&e.labelLine.setAttributes(o.attribute)}}),n.forEach(t=>{this.removeChild(t.text),t.labelLine&&this.removeChild(t.labelLine)}),this._graphicToText=r}updateStatesOfLabels(t,e){t.forEach(t=>{t&&(t.text&&t.text.useStates(e),t.labelLine&&t.labelLine.useStates(e))})}_syncStateWithRelatedGraphic(t){this.attribute.syncState&&t.on("afterAttributeUpdate",this._handleRelatedGraphicSetState)}_afterRelatedGraphicAttributeUpdate(t,e,i,r,n,s,a,{mode:o,duration:l,easing:h,delay:u}){let d=c=>{var p,g,f;let{detail:m}=c;if(!m)return{};let v=null===(p=m.animationState)||void 0===p?void 0:p.step;if(!(m.type===lw.ANIMATE_UPDATE&&v&&!("wait"===v.type&&null==(null===(g=v.prev)||void 0===g?void 0:g.type))))return{};if(m.type===lw.ANIMATE_END)return t.setAttributes(a),void(i&&i.setAttributes(a));let y=()=>{s&&(s.onAnimateBind=void 0,s.removeEventListener("afterAttributeUpdate",d))};switch(o){case"after":m.animationState.end&&(t.animate({onStart:y}).wait(u).to(a,l,h),i&&i.animate().wait(u).to(a,l,h));break;case"after-all":n===e.length-1&&m.animationState.end&&(e.forEach(t=>{t.animate({onStart:y}).wait(u).to(a,l,h)}),r.forEach(t=>{t.animate().wait(u).to(a,l,h)}));break;default:if(this._isCollectionBase){let e=this._idToPoint.get(t.attribute.id);!e||t.animates&&t.animates.has("label-animate")||!s.containsPoint(e.x,e.y,lA.LOCAL,null===(f=this.stage)||void 0===f?void 0:f.pickerService)||(t.animate({onStart:y}).wait(u).to(a,l,h),i&&i.animate().wait(u).to(a,l,h))}else m.animationState.isFirstFrameOfStep&&(t.animate({onStart:y}).wait(u).to(a,l,h),i&&i.animate().wait(u).to(a,l,h))}};return d}_smartInvert(t){var e,i,r,n,s;let a=nb(this.attribute.smartInvert)?this.attribute.smartInvert:{},{textType:o,contrastRatiosThreshold:l,alternativeColors:h,mode:u}=a,d=null!==(e=a.fillStrategy)&&void 0!==e?e:"invertBase",c=null!==(i=a.strokeStrategy)&&void 0!==i?i:"base",p=null!==(r=a.brightColor)&&void 0!==r?r:"#ffffff",g=null!==(n=a.darkColor)&&void 0!==n?n:"#000000",f=null!==(s=a.outsideEnable)&&void 0!==s&&s;if("null"!==d||"null"!==c)for(let e=0;e<t.length;e++){let i=t[e];if(!i)continue;let r=this.getRelatedGraphic(i.attribute),n=r.attribute.fill,s=Vk(i.attribute.fill,n,o,l,h,u),a=VA(s,p)?p:g;if(f){let t=VC(d,n,s,a);if(t&&i.setAttributes({fill:t}),0===i.attribute.lineWidth)continue;let e=VC(c,n,s,a);e&&i.setAttributes({stroke:e})}else if(this._canPlaceInside(i.AABBBounds,r.AABBBounds)){let t=VC(d,n,s,a);if(t&&i.setAttributes({fill:t}),0===i.attribute.lineWidth)continue;let e=VC(c,n,s,a);e&&i.setAttributes({stroke:e})}else{if(0===i.attribute.lineWidth)continue;if(i.attribute.stroke){i.setAttributes({fill:Vk(i.attribute.fill,i.attribute.stroke,o,l,h,u)});continue}let t=VC(d,n,s,a);t&&i.setAttributes({fill:t});let e=VC(c,n,s,a);e&&i.setAttributes({stroke:e})}}}_canPlaceInside(t,e){return!(!t||!e)&&e.encloses(t)}setLocation(t){this.translateTo(t.x,t.y)}disableAnimation(){this._enableAnimation=!1}enableAnimation(){this._enableAnimation=!0}}VW.defaultAttributes={textStyle:{fontSize:12,textAlign:"center",textBaseline:"middle",boundsPadding:[-2,-1,-2,-1]},offset:0,pickable:!1};class VG extends VW{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},VG.defaultAttributes,t))}labeling(t,e,i="top",r=0){if(!t||!e)return;let{x1:n,y1:s,x2:a,y2:o}=t,l=Math.abs(a-n),h=Math.abs(o-s),{x:u,y:d}=fL(e,i),c=0,p=0,g=i.includes("inside");switch(i.includes("top")?p=g?1:-1:i.includes("bottom")?p=g?-1:1:i.includes("left")?c=g?1:-1:i.includes("right")&&(c=g?-1:1),i){case"top-right":case"bottom-right":c=-1;break;case"top-left":case"bottom-left":c=1}return{x:u+c*r+c*l/2,y:d+p*r+p*h/2}}}VG.tag="rect-label",VG.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};class VU extends VW{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},VU.defaultAttributes,t)),this.name="symbol-label"}labeling(t,e,i="top",r=0){return VN(t,e,i,r)}}VU.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};class V${constructor(t,e,i,r,n,s,a,o,l){this.refDatum=t,this.center=e,this.outerCenter=i,this.quadrant=r,this.radian=n,this.middleAngle=s,this.innerRadius=a,this.outerRadius=o,this.circleCenter=l,this.labelVisible=!0,this.labelLimit=0}getLabelBounds(){return this.labelPosition&&this.labelSize?{x1:this.labelPosition.x-this.labelSize.width/2,y1:this.labelPosition.y-this.labelSize.height/2,x2:this.labelPosition.x+this.labelSize.width/2,y2:this.labelPosition.y+this.labelSize.height/2}:{x1:0,x2:0,y1:0,y2:0}}}class VY extends VW{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},VY.defaultAttributes,t)),this.name="arc-label",this._ellipsisWidth=0,this._arcLeft=new Map,this._arcRight=new Map}_overlapping(t){return t}labeling(t,e,i="outside",r=0){if(t&&e)return{x:0,y:0}}_layout(t){if(!t||!t.length)return;let e=super._layout(t),i=e.map(t=>this.getGraphicBounds(t)),r=Object.assign(Object.assign({},this.attribute.textStyle),{text:"\u2026"}),n=1/0;if(!1!==r.ellipsis){let t=this._createLabelText(r),e=this.getGraphicBounds(t);n=e.x2-e.x1}let s=e.map(t=>t.attribute),a=this.layoutArcLabels(this.attribute.position,this.attribute,Array.from(this._idToGraphic.values()),s,i,n);for(let t=0;t<s.length;t++){let i=s[t],r=a.find(t=>{var e;return(null===(e=t.refDatum)||void 0===e?void 0:e.id)===i.id});if(r){let i={visible:r.labelVisible,x:r.labelPosition.x,y:r.labelPosition.y,angle:r.angle,maxLineWidth:r.labelLimit,points:r.pointA&&r.pointB&&r.pointC?[r.pointA,r.pointB,r.pointC]:void 0,line:r.labelLine};e[t].setAttributes(i)}}return e}layoutArcLabels(t,e,i,r,n,s){this._arcLeft.clear(),this._arcRight.clear(),this._ellipsisWidth=s;let a=0;i.forEach(t=>{t.attribute.outerRadius>a&&(a=t.attribute.outerRadius)}),r.forEach((t,i)=>{var s,o,l,h;let u=this._idToGraphic.get(t.id).attribute,d={x:null!==(s=null==u?void 0:u.x)&&void 0!==s?s:0,y:null!==(o=null==u?void 0:u.y)&&void 0!==o?o:0};if(!ej(r[i])&&!ej(n[i])){;let t=r[i]?r[i]:null,s=n[i]?n[i]:{x1:0,x2:0,y1:0,y2:0},o=(u.startAngle+u.endAngle)/2,c=u.endAngle-u.startAngle,p=(l=function(t){for(;t<0;)t+=2*Math.PI;for(;t>=2*Math.PI;)t-=2*Math.PI;return t}(l=u.endAngle-c/2))>0&&l<=Math.PI/2?2:l>Math.PI/2&&l<=Math.PI?3:l>Math.PI&&l<=3*Math.PI/2?4:1,g=VF(d.x,d.y,u.outerRadius,o),f=new V$(t,g,VF(d.x,d.y,a+e.line.line1MinLength,o),p,c,o,u.innerRadius,u.outerRadius,d);f.pointA=VF(d.x,d.y,this.computeDatumRadius(2*d.x,2*d.y,u.outerRadius),f.middleAngle),f.labelSize={width:s.x2-s.x1,height:s.y2-s.y1},1===(h=f.quadrant)||2===h?this._arcRight.set(f.refDatum,f):Vj(f.quadrant)&&this._arcLeft.set(f.refDatum,f)}});let o=Array.from(this._arcLeft.values()),l=Array.from(this._arcRight.values()),h=[];switch(t){case"inside":case"inside-inner":case"inside-outer":h.push(...this._layoutInsideLabels(l,e,i)),h.push(...this._layoutInsideLabels(o,e,i));break;default:h.push(...this._layoutOutsideLabels(l,e,i)),h.push(...this._layoutOutsideLabels(o,e,i))}return h}_layoutInsideLabels(t,e,i){var r,n;let s=e.spaceWidth,a=null!==(r=e.position)&&void 0!==r?r:"inside",o=null!==(n=e.offsetRadius)&&void 0!==n?n:-s;return t.forEach(t=>{var i,r,n,l,h;let u;let{labelSize:d,radian:c}=t,p=t.innerRadius,g=t.outerRadius;if(c<(l=g,(h=d.height)>2*l?NaN:2*Math.asin(h/2/l)))u=0;else u=g-(c>=Math.PI?p:Math.max(p,d.height/2/Math.tan(c/2)))-s;!0!==e.rotate&&(u=g-s);let f=this._getFormatLabelText(t.refDatum,u);t.labelText=f;let m=Math.min(u,t.labelSize.width),v=this._computeAlign(t,e),y,_=0;if("inside"===a&&(_="left"===v?m:"right"===v?0:m/2),y="inside-inner"===a?p-o+_:g+o-_,t.labelPosition=VF(t.circleCenter.x,t.circleCenter.y,y,t.middleAngle),t.labelLimit=m,df(m,0)||(t.labelVisible=!1),!1!==e.rotate){t.angle=null!==(r=null===(i=e.textStyle)||void 0===i?void 0:i.angle)&&void 0!==r?r:t.middleAngle;let s=null!==(n=e.offsetAngle)&&void 0!==n?n:0;["inside-inner","inside-outer"].includes(a)&&(s+=Math.PI/2),t.angle+=s}}),t}_layoutOutsideLabels(t,e,i){var r,n,s;let a=null!==(r=i[0].attribute.x)&&void 0!==r?r:0,o=2*(null!==(n=i[0].attribute.y)&&void 0!==n?n:0),l=e.line.line2MinLength,h=e.layout,u=e.spaceWidth;if(t.forEach(t=>{let e=Vj(t.quadrant)?-1:1;t.labelPosition={x:t.outerCenter.x+e*(t.labelSize.width/2+l+u),y:t.outerCenter.y}}),t.sort((t,e)=>t.labelPosition.y-e.labelPosition.y),!1!==e.coverEnable||"none"===h.strategy){for(let r of t){let{labelPosition:t,labelSize:n}=r;r.labelLimit=n.width,r.pointB=Vj(r.quadrant)?{x:t.x+n.width/2+l+u,y:t.y}:{x:t.x-n.width/2-l-u,y:t.y},this._computeX(r,e,i)}!1===e.coverEnable&&"none"===h.strategy&&this._coverLabels(t)}else{let r=o/((null===(s=e.textStyle)||void 0===s?void 0:s.fontSize)||16);this._adjustY(t,r,e,i);let{minY:n,maxY:a}=t.reduce((t,e)=>{let{y1:i,y2:r}=e.getLabelBounds();return t.minY=Math.max(0,Math.min(i,t.minY)),t.maxY=Math.min(o,Math.max(r,t.maxY)),t},{minY:1/0,maxY:-Infinity}),l=Math.max(Math.abs(o/2-n),Math.abs(a-o/2)),h=this._computeLayoutRadius(l,e,i);for(let r of t)this._computePointB(r,h,e,i),this._computeX(r,e,i)}let d=2*a;return t.forEach(t=>{var i,r;t.labelVisible&&(dm(t.pointB.x,l+u)||df(t.pointB.x,d-l-u))&&(t.labelVisible=!1),t.angle=null!==(r=null===(i=e.textStyle)||void 0===i?void 0:i.angle)&&void 0!==r?r:0,e.offsetAngle&&(t.angle+=e.offsetAngle),t.labelLine=Object.assign({},e.line)}),t}_computeX(t,e,i){var r;let n=t.circleCenter,s=2*n.x;n.y;let a=0;i.forEach(t=>{t.attribute.outerRadius>a&&(a=t.attribute.outerRadius)});let o=this.computeLayoutOuterRadius(a,e.width,e.height),l=e.line.line1MinLength,h=e.line.line2MinLength,u=null===(r=e.layout)||void 0===r?void 0:r.align,d=e.spaceWidth,{labelPosition:c,quadrant:p,pointB:g}=t;l1(g.x*g.y)||(t.pointC={x:NaN,y:NaN},c.x=NaN,t.labelLimit=0);let f=this.computeRadius(o,e.width,e.height),m=Vj(p)?-1:1,v=0,y=(m>0?s-g.x:g.x)-h-d;"labelLine"===u&&(v=(f+l+h)*m+n.x,y=(m>0?s-v:v)-d);let _=this._getFormatLabelText(t.refDatum,y);t.labelText=_;let b=Math.min(y,t.labelSize.width);switch(u){case"labelLine":break;case"edge":v=m>0?s-b-d:b+d;break;default:v=g.x+m*h}b=Math.max(this._ellipsisWidth,b),t.labelLimit=b,t.pointC={x:v,y:c.y};let x=.5*(t.labelLimit<t.labelSize.width?t.labelLimit:t.labelSize.width);"edge"===u?c.x=(m>0?s+0:0)-m*x:c.x=v+0+m*(d+x)}_computeAlign(t,e){var i,r,n,s,a,o;let l=null!==(r=null===(i=e.textStyle)||void 0===i?void 0:i.textAlign)&&void 0!==r?r:null===(n=e.textStyle)||void 0===n?void 0:n.align,h=null!==(a=null===(s=e.layout)||void 0===s?void 0:s.textAlign)&&void 0!==a?a:null===(o=e.layout)||void 0===o?void 0:o.align;return"inside"!==e.position?ej(l)||"auto"===l?"edge"===h?Vj(t.quadrant)?"left":"right":Vj(t.quadrant)?"right":"left":l:ej(l)||"auto"===l?"center":l}_getFormatLabelText(t,e){var i;return null!==(i=null==t?void 0:t.text)&&void 0!==i?i:""}_adjustY(t,e,i,r){var n,s;r[0].attribute.x;let a=2*(null!==(s=r[0].attribute.y)&&void 0!==s?s:0),o=i.layout;if("vertical"===o.strategy){let e,i=0,r=t.length;if(r<=0)return;for(let n=0;n<r;n++){let{y1:s}=t[n].getLabelBounds();if(dm(e=s-i,0)){let i=this._shiftY(t,n,r-1,-e);this._shiftY(t,i,0,e/2)}let{y2:a}=t[n].getLabelBounds();i=a}let{y1:n}=t[0].getLabelBounds();dm(e=n-0,0)&&this._shiftY(t,0,r-1,-e);for(let e=t.length-1;e>=0&&t[e].getLabelBounds().y2>a;e--)t[e].labelVisible=!1}else if("none"!==o.strategy){let n=t.map((t,e)=>({arc:t,originIndex:e,priorityIndex:0}));n.sort((t,e)=>e.arc.radian-t.arc.radian),n.forEach((t,e)=>{t.priorityIndex=e,t.arc.labelVisible=!1});let s=1/0,l=-Infinity;for(let h=0;h<e&&h<t.length;h++){let e;this._storeY(t);let u=n[h].arc;this._computeYRange(u,i,r),u.labelVisible=!0;let d=u.labelPosition.y,{lastIndex:c,nextIndex:p}=this._findNeighborIndex(t,n[h]),g=t[c],f=t[p];if(-1===c&&-1!==p){let e=f.labelPosition.y;d>e?u.labelPosition.y=e-f.labelSize.height/2-u.labelSize.height/2:this._twoWayShift(t,u,f,p)}else if(-1!==c&&-1===p){let e=g.labelPosition.y;d<e?u.labelPosition.y=e+g.labelSize.height/2+u.labelSize.height/2:this._twoWayShift(t,g,u,n[h].originIndex)}else if(-1!==c&&-1!==p){let e=g.labelPosition.y,i=f.labelPosition.y;d>i?(u.labelPosition.y=i-f.labelSize.height/2-u.labelSize.height/2,this._twoWayShift(t,g,u,n[h].originIndex)):(d<e?u.labelPosition.y=e+g.labelSize.height/2+u.labelSize.height/2:this._twoWayShift(t,g,u,n[h].originIndex),this._twoWayShift(t,u,f,p))}let m=Math.min(s,n[h].originIndex),v=Math.max(l,n[h].originIndex);if(df(e=t[v].getLabelBounds().y2-a,0)&&this._shiftY(t,v,0,-e),dm(e=t[m].getLabelBounds().y1-0,0)&&this._shiftY(t,m,t.length-1,-e),df(e=t[v].getLabelBounds().y2-a,0)){u.labelVisible=!1,this._restoreY(t);break}o.tangentConstraint&&!this._checkYRange(t)?(u.labelVisible=!1,this._restoreY(t)):(s=m,l=v)}}}_shiftY(t,e,i,r){let n=e<i?1:-1,s=e;for(;-1!==s;){t[s].labelPosition.y+=r;let e=this._findNextVisibleIndex(t,s,i,n);if(e>=0&&e<t.length){let{y1:i,y2:r}=t[s].getLabelBounds(),{y1:a,y2:o}=t[e].getLabelBounds();if(n>0&&r<a||n<0&&i>o)return s}s=e}return i}_findNextVisibleIndex(t,e,i,r){let n=(i-e)*r;for(let i=1;i<=n;i++){let n=e+i*r;if(t[n].labelVisible)return n}return -1}_computePointB(t,e,i,r){let n=0;r.forEach(t=>{t.attribute.outerRadius>n&&(n=t.attribute.outerRadius)});let s=this.computeLayoutOuterRadius(n,i.width,i.height),a=i.line.line1MinLength;if("none"===i.layout.strategy)t.pointB={x:t.outerCenter.x,y:t.outerCenter.y};else{let r=t.circleCenter,n=this.computeRadius(s,i.width,i.height),{labelPosition:o,quadrant:l}=t,h=e-Math.max(n+a,t.outerRadius),u=Math.sqrt(e**2-Math.abs(r.y-o.y)**2)-h;l1(u)?t.pointB={x:r.x+u*(Vj(l)?-1:1),y:o.y}:t.pointB={x:NaN,y:NaN}}}_storeY(t){for(let e of t)e.labelVisible&&(e.lastLabelY=e.labelPosition.y)}_computeYRange(t,e,i){let r,n,s,a,o;let l=t.circleCenter,h={width:2*l.x,height:2*l.y},u=0;i.forEach(t=>{t.attribute.outerRadius>u&&(u=t.attribute.outerRadius)});let d=this.computeLayoutOuterRadius(u,e.width,e.height),c=e.line.line1MinLength,{width:p,height:g}=h,f=this.computeRadius(d,e.width,e.height),m=this._computeLayoutRadius(g/2,e,i),v=Math.abs(t.center.x-p/2),y=t.center.y-g/2;if(dg(p/2,v))r=0,n=1,s=-y;else if(dg(g/2,y))r=1,n=0,s=-v;else{let t=-1/(y/v);r=t,n=-1,s=y-t*v}let _=function(t,e,i,r,n,s){if(0===t&&0===e||s<=0)return[];if(0===t){let t=-i/e,n=s**2-(t-0)**2;return n<0?[]:0===n?[{x:r,y:t}]:[{x:Math.sqrt(n)+r,y:t},{x:-Math.sqrt(n)+r,y:t}]}if(0===e){let e=-i/t,a=s**2-(e-r)**2;return a<0?[]:0===a?[{x:e,y:n}]:[{x:e,y:Math.sqrt(a)+n},{x:e,y:-Math.sqrt(a)+n}]}let a=(e/t)**2+1,o=2*(e/t*(i/t+r)-n),l=o**2-4*a*((i/t+r)**2+n**2-s**2);if(l<0)return[];let h=(-o+Math.sqrt(l))/(2*a),u=(-o-Math.sqrt(l))/(2*a),d=-(e*h+i)/t;return 0===l?[{x:d,y:h}]:[{x:d,y:h},{x:-(e*u+i)/t,y:u}]}(r,n,s,c+f-m,0,m);!(_.length<2)&&(_[0].x>_[1].x&&_.reverse(),_[0].x<0?dg(_[0].y,_[1].y)?df(t.middleAngle,-Math.PI)&&dm(t.middleAngle,0)||df(t.middleAngle,Math.PI)&&dm(t.middleAngle,2*Math.PI)?(a=0,o=_[1].y+g/2):(a=_[1].y+g/2,o=g):_[0].y<_[1].y?(a=0,o=_[1].y+g/2):(a=_[1].y+g/2,o=h.height):(a=Math.min(_[0].y,_[1].y)+g/2,o=Math.max(_[0].y,_[1].y)+g/2),t.labelYRange=[a,o])}_computeLayoutRadius(t,e,i){let r=e.layoutArcGap,n=e.line.line1MinLength,s=0;i.forEach(t=>{t.attribute.outerRadius>s&&(s=t.attribute.outerRadius)});let a=this.computeLayoutOuterRadius(s,e.width,e.height),o=this.computeRadius(a,e.width,e.height)+n,l=o-r;return Math.max((l**2+t**2)/(2*l),o)}_findNeighborIndex(t,e){let i=e.originIndex,r=-1,n=-1;for(let e=i-1;e>=0;e--)if(t[e].labelVisible){r=e;break}for(let e=i+1;e<t.length;e++)if(t[e].labelVisible){n=e;break}return{lastIndex:r,nextIndex:n}}_twoWayShift(t,e,i,r){let n=i.getLabelBounds().y1-e.getLabelBounds().y2;if(dm(n,0)){let e=this._shiftY(t,r,t.length-1,-n);this._shiftY(t,e,0,n/2)}}_restoreY(t){for(let e of t)e.labelVisible&&(e.labelPosition.y=e.lastLabelY)}_checkYRange(t){for(let e of t){let{labelYRange:t,labelPosition:i}=e;if(e.labelVisible&&t&&(dm(i.y,t[0])||df(i.y,t[1])))return!1}return!0}_coverLabels(t){if(t.length<=1)return;let e=t[0].getLabelBounds();for(let i=1;i<t.length;i++){let r=t[i].getLabelBounds();!function(t,e){let{x1:i,y1:r,x2:n,y2:s}=t,{x1:a,y1:o,x2:l,y2:h}=e;return!(i<=a&&n<=a||i>=l&&n>=l||r<=o&&s<=o||r>=h&&s>=h)}(e,r)?e=r:t[i].labelVisible=!1}}_createLabelLine(t,e){var i,r,n,s,a,o,l;let{points:h,line:u={},visible:d,fill:c}=t.attribute,p=t.attribute.points?aj.line({visible:null===(n=null!==(i=u.visible&&d)&&void 0!==i?i:null===(r=t.attribute)||void 0===r?void 0:r.visible)||void 0===n||n,stroke:null!==(a=null===(s=u.style)||void 0===s?void 0:s.stroke)&&void 0!==a?a:c,lineWidth:null!==(l=null===(o=u.style)||void 0===o?void 0:o.lineWidth)&&void 0!==l?l:1,points:h,curveType:u.smooth?"basis":null}):void 0;if(p){if(null==u?void 0:u.customShape){let e=u.customShape;p.pathProxy=i=>e(t.attribute,i,new rg)}this._setStatesOfLabelLine(p)}return p}computeRadius(t,e,i,r){return this.computeLayoutRadius(e||0,i||0)*t*(ej(r)?1:r)}computeLayoutRadius(t,e){return Math.min(t/2,e/2)}_canPlaceInside(t,e){return"inside"===this.attribute.position}computeLayoutOuterRadius(t,e,i){return t/(Math.min(e,i)/2)}computeDatumRadius(t,e,i){let r=this.computeLayoutOuterRadius(i,t,e);return this.computeLayoutRadius(t||0,e||0)*r}}VY.defaultAttributes={coverEnable:!1,spaceWidth:5,layoutArcGap:6,textStyle:{visible:!0,fontSize:14,fontWeight:"normal",fillOpacity:1,boundsPadding:[-1,0,-1,0]},position:"outside",line:{visible:!0,line1MinLength:20,line2MinLength:10},layout:{align:"arc",strategy:"priority",tangentConstraint:!0}};class VK extends VW{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},VK.defaultAttributes,t)),this.name="line-data-label"}labeling(t,e,i="top",r=0){return VN(t,e,i,r)}}VK.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};class VZ extends VW{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},VZ.defaultAttributes,t)),this.name="line-label"}getGraphicBounds(t,e={},i="end"){if(!t||"line"!==t.type)return super.getGraphicBounds(t,e);let r=t.attribute.points||[e],n="start"===i?0:r.length-1;return r[n]?{x1:r[n].x,x2:r[n].x,y1:r[n].y,y2:r[n].y}:void 0}labeling(t,e,i="end",r=0){return VH(t,e,i,r)}}VZ.defaultAttributes={textStyle:{fill:"#000"},position:"end",offset:6};class VX extends VW{constructor(t){super(eF({},VX.defaultAttributes,t)),this.name="line-label"}getGraphicBounds(t,e={},i="end"){var r;if("area"!==t.type)return super.getGraphicBounds(t,e);let n=(null===(r=null==t?void 0:t.attribute)||void 0===r?void 0:r.points)||[e],s="start"===i?0:n.length-1;return{x1:n[s].x,x2:n[s].x,y1:n[s].y,y2:n[s].y}}labeling(t,e,i="end",r=0){return VH(t,e,i,r)}}VX.defaultAttributes={textStyle:{fill:"#000"},position:"end",offset:6};let Vq={rect:VG,symbol:VU,arc:VY,line:VZ,area:VX,"line-data":VK};class VJ extends Eu{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},VJ.defaultAttributes,t)),this.name="data-label"}render(){var t;let{dataLabels:e,size:i}=this.attribute;if(!e||0===e.length)return;let{width:r=0,height:n=0,padding:s}=i||{};if(!r||!n||!l1(n*r))return;this._componentMap||(this._componentMap=new Map);let a=Vb(r,n,s),o=a.bitmap(),l=new Map,h=this._componentMap;for(let i=0;i<e.length;i++){let r=e[i],n=Vq[r.type]||VW;if(n){let{baseMarkGroupName:e,type:s}=r,h=null!==(t=r.id)&&void 0!==t?t:`${e}-${s}-${i}`,u=this._componentMap.get(h);u?(u.setBitmapTool(a),u.setBitmap(o),u.setAttributes(r)):((u=new n(r)).setBitmap(o),u.setBitmapTool(a),this.add(u)),l.set(h,u)}}h.forEach((t,e)=>{l.get(e)||this.removeChild(t)}),this._componentMap=l}setLocation(t){this.translateTo(t.x,t.y)}disableAnimation(){this._componentMap.forEach(t=>{t.disableAnimation()})}enableAnimation(){this._componentMap.forEach(t=>{t.enableAnimation()})}}VJ.defaultAttributes={pickable:!1};let VQ=(t,e,i,r,n,s={})=>{var a;let o=null===(a=s.components)||void 0===a?void 0:a.dataLabel,l=t.map((t,e)=>{var a,o,l,h,u;let d=Object.assign(Object.assign({},n),{labelIndex:e}),c=null!==(a=gN(r,d,t))&&void 0!==a?a:{},{components:p={}}=s,g={};switch(t.markType){case c8.line:case c8.area:g="line"===c.type?p.lineLabel:"area"===c.type?p.areaLabel:p.lineDataLabel;break;case c8.rect:case c8.rect3d:case c8.interval:g=p.rectLabel;break;case c8.symbol:case c8.circle:case c8.cell:g=p.symbolLabel;break;case c8.arc:case c8.arc3d:g=p.arcLabel;break;case c8.polygon:case c8.path:default:g=p.pointLabel}let f=null!==(o=c.data)&&void 0!==o?o:[],m=null!==(h=null===(l=null==g?void 0:g.data)||void 0===l?void 0:l[0])&&void 0!==h?h:{};return f&&f.length>0?f.forEach((e,r)=>{if(t.elements[r]){let n=mE(i,e,t.elements[r],d);eF(e,m,n)}}):t.elements.forEach(e=>{if("willRelease"!==e.getGraphicItem().releaseStatus){if(t.isCollectionMark())e.getDatum().forEach(t=>{let r=mE(i,t,e,d);f.push(eF({},m,r))});else{let t=eF({},m,mE(i,e.getDatum(),e,d));f.push(t)}}}),eF({},g,{data:f,baseMarkGroupName:null===(u=t.graphicItem)||void 0===u?void 0:u.name,getBaseMarks:()=>t.elements.map(t=>t.getGraphicItem())},null!=c?c:{})}).filter(t=>!ej(t));return eF({},o,{size:e,dataLabels:l})};class V0 extends v1{constructor(t,e){super(t,c6.label,e),this.spec.componentType=c6.label}parseAddition(t){return super.parseAddition(t),this.labelStyle(t.labelStyle),this.size(t.size),this.target(t.target),this}labelStyle(t){return this.setFunctionSpec(t,"labelStyle")}size(t){return this.setFunctionSpec(t,"size")}target(t){if(this.spec.target){let t=om(this.spec.target).map(t=>eE(t)?this.view.getMarkById(t):t);this.detach(t)}if(this.spec.target=t,t){let e=om(t).map(t=>eE(t)?this.view.getMarkById(t):t);this.attach(e)}return this.commit(),this}_updateComponentEncoders(){let t=Object.assign({update:{}},this.spec.encode),e=Object.keys(t).reduce((e,i)=>{let r=t[i];return r&&(e[i]={callback:(t,e,i)=>{var n,s,a,o;let l=om(this.spec.target).map(t=>eE(t)?this.view.getMarkById(t):t),h=null===(s=null===(n=this.group)||void 0===n?void 0:n.getGroupGraphicItem)||void 0===s?void 0:s.call(n),u=gN(this.spec.size,i);u||(u=h?{width:null!==(a=h.attribute.width)&&void 0!==a?a:h.AABBBounds.width(),height:null!==(o=h.attribute.height)&&void 0!==o?o:h.AABBBounds.height()}:{width:1/0,height:1/0});let d=this.spec.skipTheme?null:this.view.getCurrentTheme();return VQ(l,u,r,this.spec.labelStyle,i,d)}}),e},{});this._encoders=e}}V0.componentType=c6.label;let V1=()=>{d0.registerGraphicComponent(c6.label,t=>new VJ(t)),d0.registerComponent(c6.label,V0)};class V2 extends Ea{constructor(t,e){super(t,e),this.type=lx.label,this.name=lx.label,this.layoutType="none",this.layoutZIndex=tM.Label,this._regions=e.getRegionsInIndex(e.regionIndexes)}_interactiveConfig(t){let{interactive:e}=t,i={hover:!1,select:!1,state:t.state};if(!0!==e)return i;let{hover:r,select:n}=this._option.getChart().getSpec();return!1===r&&!1===r.enable||(i.hover=!0),!1===n&&!1===n.enable||(i.select=!0),i}_compareSpec(t,e){let i=super._compareSpec(t,e);return i.reRender=!0,my(e,t)||(i.reMake=!0),i}onRender(t){}changeRegions(t){}_getNeedClearVRenderComponents(){return[]}_delegateLabelEvent(t){0===t.listenerCount("*")&&t.addEventListener("*",(e,i)=>this._delegateEvent(t,e,i))}}V2.type=lx.label;class V3 extends B6{constructor(){super(...arguments),this.skipEncode=!1}getRule(){return this._rule}setRule(t){this._rule=t}getTarget(){return this._target}setTarget(t){this._target=t,this._rule||this.setRule(t.type)}getComponent(){return this._component}setComponent(t){this._component=t}}V3.type="text",V3.constructorType="label";let V5=()=>{de.registerMark(V3.constructorType,V3),AY()};class V4 extends En{_initTheme(t,e){return{spec:t,theme:this._theme}}}class V8 extends V2{constructor(t,e){super(t,e),this.type=lx.label,this.name=lx.label,this.specKey="label",this.transformerConstructor=V4,this.layoutZIndex=tM.Label,this._layoutRule=t.labelLayout||"series"}static getSpecInfo(t,e){let i=[];return((null==e?void 0:e.region)||[]).forEach((r,n)=>{(r.seriesIndexes||[]).some(t=>{let{markLabelSpec:i={}}=e.series[t];return Object.values(i).some(t=>Array.isArray(t)&&t.some(t=>t.visible))})&&i.push({spec:t,type:lx.label,specInfoPath:["component",this.specKey,n],regionIndexes:[n]})}),i}init(t){super.init(t),this.initEvent(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()}reInit(t){super.reInit(t),this._labelInfoMap&&this._labelInfoMap.clear(),this._initTextMark(),this._initTextMarkStyle()}initEvent(){this.event.on(c1.dataZoomChange,()=>{this._labelComponentMap.forEach((t,e)=>{let i=e.getProduct().getGroupGraphicItem();i&&i.disableAnimation()}),this.event.on(pa.AFTER_MARK_RENDER_END,t)});let t=()=>{this._labelComponentMap.forEach((t,e)=>{let i=e.getProduct().getGroupGraphicItem();i&&i.enableAnimation()}),this.event.off(pa.AFTER_MARK_RENDER_END,t)}}afterCompile(){this._labelComponentMap.forEach((t,e)=>{let i=e.getProduct();i&&i.addEventListener(pa.AFTER_ELEMENT_ENCODE,()=>{!1===this._isLayout&&this._delegateLabelEvent(i.getGroupGraphicItem())})})}_initTextMark(){this._labelInfoMap||(this._labelInfoMap=new Map),this._labelComponentMap||(this._labelComponentMap=new Map),dC(this._regions,t=>{let{markLabelSpec:e={}}=t.getSpecInfo(),i=Object.keys(e),r=t.getRegion();this._labelInfoMap.get(r)||this._labelInfoMap.set(r,[]);for(let n=0;n<i.length;n++){let s=i[n],a=t.getMarkInName(s);a&&e[s].forEach((e,i)=>{if(e.visible){let n=this._labelInfoMap.get(r),o=this._createMark({type:"label",name:`${s}-label-${i}`},{noSeparateStyle:!0,attributeContext:t.getMarkAttributeContext()});o.setTarget(a),n.push({labelMark:o,baseMark:a,series:t,labelSpec:e})}})}})}_initLabelComponent(){this._labelInfoMap.forEach((t,e)=>{if("region"===this._layoutRule){let t=this._createMark({type:"component",name:`${e.getGroupMark().name}-label-component`},{componentType:"label",noSeparateStyle:!0,support3d:this._spec.support3d});t&&(t.setSkipBeforeLayouted(!0),this._marks.addMark(t),this._labelComponentMap.set(t,()=>this._labelInfoMap.get(e)))}else t.forEach((t,i)=>{let r=this._createMark({type:"component",name:`${t.labelMark.name}-component`},{componentType:"label",noSeparateStyle:!0,support3d:t.baseMark.getSupport3d()});r&&(r.setSkipBeforeLayouted(!0),this._marks.addMark(r),this._labelComponentMap.set(r,()=>this._labelInfoMap.get(e)[i]),t.labelMark.setComponent(r))})})}_initTextMarkStyle(){this._labelInfoMap.forEach(t=>{t.forEach(t=>{var e,i;let{labelMark:r,labelSpec:n,series:s}=t;if(this.initMarkStyleWithSpec(r,n,void 0),nx(null==n?void 0:n.getStyleHandler)){let t=n.getStyleHandler(s);null==t||t.call(s,r,n)}(null===(i=null===(e=r.stateStyle)||void 0===e?void 0:e.normal)||void 0===i?void 0:i.lineWidth)&&r.setAttribute("stroke",s.getColorAttribute(),"normal",tw.Base_Series)})})}updateLayoutAttribute(){super.updateLayoutAttribute(),this._labelComponentMap.forEach((t,e)=>{let i=t();eM(i)?this._updateMultiLabelAttribute(i,e):this._updateSingleLabelAttribute(i,e)})}_updateMultiLabelAttribute(t,e){this._updateLabelComponentAttribute(e.getProduct(),t.map(({baseMark:t})=>t.getProduct()),t)}_updateSingleLabelAttribute(t,e){let{baseMark:i}=t;this._updateLabelComponentAttribute(e.getProduct(),i.getProduct(),[t])}_updateLabelComponentAttribute(t,e,i){let r=this._option.getComponentsByType("totalLabel");t.target(e).configure({interactive:!1}).depend(r.map(t=>t.getMarks()[0].getProduct())).labelStyle((t,e)=>{var n,s;let a=i[e.labelIndex];if(a){let{labelSpec:t,labelMark:e}=a,i=e.getRule(),o=this._interactiveConfig(t),l=null!==(s=null===(n=this._spec)||void 0===n?void 0:n.centerOffset)&&void 0!==s?s:0,h=us({textStyle:Object.assign({pickable:!0===t.interactive},t.style),overlap:{avoidMarks:r.map(t=>t.getMarks()[0].getProductId())}},function(t,e){var i;let{labelSpec:r}=e;return r.overlap&&!nb(r.overlap)&&(r.overlap={}),(null!==(i=FB[t])&&void 0!==i?i:FB.point)(e)}(i,a),Object.assign(Object.assign(Object.assign({},Eo(t,["position","style","state","type"])),o),{centerOffset:l}));return"line"!==i&&"area"!==i||(h.type=i),h}}).encode((t,e,r)=>{if(i[r.labelIndex]){let{labelSpec:e,labelMark:n}=i[r.labelIndex];return n.skipEncode?{data:t}:FI(i[r.labelIndex],t,e.formatMethod,e.formatter)}}).size(()=>i[0].series.getRegion().getLayoutRect())}compileMarks(){this.getMarks().forEach(t=>{var e;let i;let r=this._labelComponentMap.get(t)();i=eM(r)?r[0].series.getRegion().getGroupMark().getProduct():r.series.getRegion().getGroupMark().getProduct(),t.compile({group:i}),null===(e=t.getProduct())||void 0===e||e.configure({context:{model:this,labelInfo:r}})})}getVRenderComponents(){let t=[];return this._labelComponentMap.forEach((e,i)=>{let r=i.getProduct().getGroupGraphicItem();r&&t.push(r)}),t}}V8.type=lx.label,V8.specKey="label",V8.transformerConstructor=V4;class V6 extends V2{constructor(){super(...arguments),this.type=lx.totalLabel,this.name=lx.totalLabel,this.specKey="totalLabel",this.layoutZIndex=tM.Label}static getSpecInfo(t,e){var i;let r=[];return null===(i=null==e?void 0:e.region)||void 0===i||i.forEach((t,i)=>{var n;null===(n=t.seriesIndexes)||void 0===n||n.forEach(t=>{let{spec:n}=e.series[t],s=n[this.specKey];(null==s?void 0:s.visible)&&r.push({spec:s,type:lx.totalLabel,specPath:["series",t,this.specKey],specInfoPath:["component",this.specKey,t],regionIndexes:[i],seriesIndexes:[t]})})}),r}init(t){super.init(t),this._initTextMark(),this._initLabelComponent()}_initTextMark(){var t;let e=this._getSeries();if(null===(t=e.getSpec().totalLabel)||void 0===t?void 0:t.visible){let t=e.getSeriesMark();if(t){let e=this._createMark({type:"label",name:`${t.name}-total-label`});this._baseMark=t,this._textMark=e,this._initTextMarkStyle()}}}_initTextMarkStyle(){var t;super.initMarkStyleWithSpec(this._textMark,this._spec),this.setMarkStyle(this._textMark,{text:t=>t[bL]},"normal",tw.Default);let e=this._getSeries();null===(t=e.initTotalLabelMarkStyle)||void 0===t||t.call(e,this._textMark)}_initLabelComponent(){let t=this._getSeries(),e=this._createMark({type:"component",name:`${t.name}-total-label-component`},{componentType:"label",noSeparateStyle:!0,support3d:this._spec.support3d});e&&this._marks.addMark(e)}afterCompile(){this._marks.forEach((t,e)=>{let i=t.getProduct();i&&i.addEventListener(pa.AFTER_ELEMENT_ENCODE,()=>{!1===this._isLayout&&this._delegateLabelEvent(i.getGroupGraphicItem())})})}updateLayoutAttribute(){super.updateLayoutAttribute();let t=this._getSeries();this._marks.forEach((e,i)=>{e.getProduct().target(this._baseMark.getProduct()).configure({interactive:!1}).labelStyle(()=>{var e,i;if(this._baseMark){let{offset:r,animation:n,overlap:s}=this._spec,a=this._interactiveConfig(this._spec);return us({textStyle:{pickable:!0===this._spec.interactive},position:function(t,e){var i,r;let n;let{direction:s}=t,a=("horizontal"===s?null===(i=t.getXAxisHelper())||void 0===i?void 0:i.isInverse():null===(r=t.getYAxisHelper())||void 0===r?void 0:r.isInverse())?1:0;switch(e){case"rect":case"symbol":n=({vertical:["top","bottom"],horizontal:["right","left"]})[s][a];break;default:n="top"}return n}(t,this._baseMark.type),x:0,y:0},null!==(i=null===(e=t.getTotalLabelComponentStyle)||void 0===e?void 0:e.call(t,{baseMark:this._baseMark,labelMark:this._textMark}))&&void 0!==i?i:{},Object.assign({offset:r,animation:n,overlap:s,dataFilter:t=>t.filter(t=>t.data[bF])},a))}}).encode(e=>FI({baseMark:this._baseMark,labelMark:this._textMark,series:t,labelSpec:t.getSpec().totalLabel},e,this._spec.formatMethod)).size(()=>this._regions[0].getLayoutRect())})}compileMarks(){this.getMarks().forEach(t=>{var e;let i=this._regions[0].getGroupMark().getProduct();t.compile({group:i}),null===(e=t.getProduct())||void 0===e||e.configure({context:{model:this}})})}getVRenderComponents(){let t=[];return this.getMarks().forEach(e=>{let i=e.getProduct().getGroupGraphicItem();i&&t.push(i)}),t}_getSeries(){return this._option.getSeriesInIndex([this.getSpecPath()[1]])[0]}}V6.type=lx.totalLabel,V6.specKey="totalLabel";let V9=(t,e)=>{let i=Math.atan2(t,e);return i<0?i+2*Math.PI:i};function V7(){Wt._animate=HS}Hr(),Ed(),Ec(),_2(),k_(),kP();class Wt extends Ha{markerAnimate(t){Wt._animate&&this._animationConfig&&Wt._animate([this._line,this._decorativeLine],this._item,this._animationConfig,t)}constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},Wt.defaultAttributes,t)),this.name="markPoint",this.defaultUpdateAnimation=Hw,this.defaultExitAnimation=HM,this._isArcLine=!1,this._isStraightLine=!1}setLabelPos(){}getTextAlignAttr(t,e,i,r,n){return Ty(Math.abs(r),Math.PI/2,.001)||Ty(Math.abs(r),3*Math.PI/2,.001)?T_(t,r,n):Tv(r)?HL.postiveXAxis[n]:HL.negativeXAxis[n]}setItemAttributes(t,e,i,r,n){var s,a;if(!t)return;let{autoRotate:o=!0,refX:l=0,refY:h=0,refAngle:u=0,textStyle:d={},richTextStyle:c={},imageStyle:p={},position:g=eo.middle}=e,{state:f}=this.attribute,m=(null===(s=this._line)||void 0===s?void 0:s.getEndAngle())||0,v=l*Math.cos(m)+h*Math.cos(m-Math.PI/2),y=l*Math.sin(m)+h*Math.sin(m-Math.PI/2);if("text"===n){let n=r.x-i.x,s=r.y-i.y;t.setAttributes(Object.assign(Object.assign({},d),{textStyle:Object.assign(Object.assign({},this.getTextAlignAttr(o,n,s,m,null!==(a=e.position)&&void 0!==a?a:"end")),d.textStyle),state:{panel:eF({},Mw,null==f?void 0:f.textBackground),text:eF({},Mw,null==f?void 0:f.text)}}))}else"richText"===n?(t.setAttributes({dx:this.getItemDx(t,g,c)+(c.dx||0),dy:this.getItemDy(t,g,c)+(c.dy||0)}),t.states=eF({},Mw,null==f?void 0:f.richText)):"image"===n&&(t.setAttributes({dx:this.getItemDx(t,g,p)+(p.dx||0),dy:this.getItemDy(t,g,p)+(p.dy||0)}),t.states=eF({},Mw,null==f?void 0:f.image));let _=Tv(m)?m:m-Math.PI;t.setAttributes({x:r.x+(v||0),y:r.y+(y||0),angle:o&&_+u})}getItemDx(t,e,i){var r,n;let s=null!==(n=null===(r=null==t?void 0:t.AABBBounds)||void 0===r?void 0:r.width())&&void 0!==n?n:(null==i?void 0:i.width)||0;return e.includes("inside")?-s:0}getItemDy(t,e,i){var r,n;let s=null!==(n=null===(r=null==t?void 0:t.AABBBounds)||void 0===r?void 0:r.height())&&void 0!==n?n:(null==i?void 0:i.height)||0;return e.includes("top")||e.includes("Top")?-s:e.includes("middle")||e.includes("Middle")?-s/2:0}initItem(t,e,i){let r;let{state:n}=this.attribute,{type:s="text",symbolStyle:a,richTextStyle:o,imageStyle:l,renderCustomCallback:h}=t;return"symbol"===s?(r=aj.symbol(Object.assign(Object.assign({},i),a))).states=eF({},Mw,null==n?void 0:n.symbol):"text"===s?r=new Ey(Object.assign(Object.assign({},i),{state:{panel:eF({},Mw,null==n?void 0:n.textBackground),text:eF({},Mw,null==n?void 0:n.text)}})):"richText"===s?(r=aj.richtext(Object.assign(Object.assign({},i),o))).states=eF({},Mw,null==n?void 0:n.richText):"image"===s?(r=aj.image(Object.assign(Object.assign({},i),l))).states=eF({},Mw,null==n?void 0:n.image):"custom"===s&&h&&((r=h()).states=eF({},Mw,null==n?void 0:n.customMark)),r.name=`mark-point-${s}`,this.setItemAttributes(r,t,e,i,s),r}getItemLineAttr(t,e,i){let r=[],n={x:0,y:0},s=0,a=0,o=0,{type:l="type-s",arcRatio:h=.8}=t,u=i.x-e.x,d=i.y-e.y;if(this._isStraightLine=Ty(u,0,.001)||Ty(d,0,.001),this._isArcLine){let{x:t,y:r}=e,{x:l,y:u}=i,d=(t+l)/2,c=(r+u)/2,p=r===u?0:-(t-l)/(r-u),g=d+h*(u>r?-1:1)*d,f=p*(g-d)+c;a=V9(r-f,t-g),o=V9(u-f,l-g),n={x:g,y:f},h>0?o<a&&(o+=2*Math.PI):a<o&&(a+=2*Math.PI),s=Math.sqrt((g-t)*(g-t)+(f-r)*(f-r))}else r="type-do"!==l||this._isStraightLine?"type-po"!==l||this._isStraightLine?"type-op"!==l||this._isStraightLine?[e,i]:[e,{x:e.x,y:i.y},i]:[e,{x:i.x,y:e.y},i]:[e,{x:(e.x+i.x)/2,y:i.y},i];return{points:r=function(t){let e=[t[0]];for(let i=1;i<t.length;i++)t[i].x===t[i-1].x&&t[i].y===t[i-1].y||e.push(t[i]);return e}(r),center:n,radius:s,startAngle:a,endAngle:o}}reDrawLine(t,e){this._line.release();let{startSymbol:i,endSymbol:r,lineStyle:n,type:s="type-s"}=t,{state:a}=this.attribute,o=this._isArcLine?H$:Ep;this._container.removeChild(this._line),this._line=new o(Object.assign(Object.assign({},e),{pickable:!1,startSymbol:i,endSymbol:r,lineStyle:n,visible:t.visible,state:{line:eF({},Mw,null==a?void 0:a.line),startSymbol:eF({},Mw,null==a?void 0:a.lineStartSymbol),endSymbol:eF({},Mw,null==a?void 0:a.lineEndSymbol)}})),this._container.add(this._line)}setItemLineAttr(t,e,i){if(this._line){let{startSymbol:r,endSymbol:n,lineStyle:s,type:a="type-s"}=t,{state:o}=this.attribute,l=this.getItemLineAttr(t,e,i);this._isArcLine&&"arc-segment"===this._line.key||!this._isArcLine&&"segment"===this._line.key?this._line.setAttributes(Object.assign(Object.assign({},l),{startSymbol:r,endSymbol:n,lineStyle:s,visible:t.visible,state:{line:eF({},Mw,null==o?void 0:o.line),startSymbol:eF({},Mw,null==o?void 0:o.lineStartSymbol),endSymbol:eF({},Mw,null==o?void 0:o.lineEndSymbol)}})):this.reDrawLine(t,l)}}getDecorativeLineAttr(t){var e;let i=(null===(e=null==t?void 0:t.decorativeLine)||void 0===e?void 0:e.length)||10,r=this._line.getEndAngle()||0;return{startPointOffsetX:i/2*Math.cos(r-Math.PI/2),startPointOffsetY:i/2*Math.sin(r-Math.PI/2),endPointOffsetX:-i/2*Math.cos(r-Math.PI/2),endPointOffsetY:-i/2*Math.sin(r-Math.PI/2)}}setDecorativeLineAttr(t,e,i){var r;if(this._decorativeLine){let{lineStyle:n}=t,{startPointOffsetX:s,startPointOffsetY:a,endPointOffsetX:o,endPointOffsetY:l}=this.getDecorativeLineAttr(t);this._decorativeLine.setAttributes(Object.assign(Object.assign({points:[{x:e.x+s,y:e.y+a},{x:e.x+o,y:e.y+l}]},n),{visible:i})),this._decorativeLine.states=eF({},Mw,null===(r=this.attribute.state)||void 0===r?void 0:r.line)}}setTargetItemAttributes(t,e){var i,r;this._targetItem&&(this._targetItem.setAttributes(Object.assign({x:e.x,y:e.y,visible:null!==(i=t.visible)&&void 0!==i&&i,size:t.size},t.style)),this._targetItem.states=eF({},Mw,null===(r=this.attribute.state)||void 0===r?void 0:r.targetItem))}setAllOfItemsAttr(t,e){var i;let{position:r,itemLine:n={},itemContent:s={},limitRect:a,targetSymbol:o}=this.attribute,{type:l="text",confine:h}=s;if(a&&h){let{x:t,y:i,width:r,height:n}=a,{dx:s,dy:o}=Hn(this._item,{x1:t,y1:i,x2:t+r,y2:i+n});e.x=e.x+s,e.y=e.y+o}this.setTargetItemAttributes(o,r),this.setItemLineAttr(n,t,e),this.setItemAttributes(this._item,s,t,e,l),this.setDecorativeLineAttr(n,e,null===(i=n.decorativeLine)||void 0===i?void 0:i.visible)}computeNewPositionAfterTargetItem(t){var e,i;let{itemContent:r={},targetSymbol:n}=this.attribute,{offsetX:s=0,offsetY:a=0}=r,{offset:o=0,style:l,visible:h=!1,size:u}=n,d=h?null!==(i=null!==(e=l.size)&&void 0!==e?e:u)&&void 0!==i?i:20:0,c=V9(a,s);return{newPosition:{x:t.x+(d/2+o)*Math.cos(c),y:t.y+(d/2+o)*Math.sin(c)},newItemPosition:{x:t.x+(d/2+o)*Math.cos(c)+s,y:t.y+(d/2+o)*Math.sin(c)+a}}}initMarker(t){let{position:e,itemContent:i={},itemLine:r}=this.attribute,{type:n="type-s",arcRatio:s=.8}=r,{offsetX:a=0,offsetY:o=0}=i;this._isStraightLine=Ty(a,0,.001)||Ty(o,0,.001),this._isArcLine="type-arc"===n&&0!==s&&!this._isStraightLine;let{newPosition:l,newItemPosition:h}=this.computeNewPositionAfterTargetItem(e),u=new(this._isArcLine?H$:Ep)({points:[],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0});u.name="mark-point-line",this._line=u,t.add(u);let d=aj.line({points:[]});d.name="mark-point-decorativeLine",this._decorativeLine=d,t.add(d);let c=aj.symbol({});c.name="mark-point-targetItem",this._targetItem=c,t.add(this._targetItem);let p=this.initItem(i,l,h);this._item=p,t.add(p),this.setAllOfItemsAttr(l,h)}updateMarker(){let{position:t,itemContent:e={},itemLine:i}=this.attribute,{type:r="text"}=e,{type:n="type-s",arcRatio:s=.8}=i,{offsetX:a=0,offsetY:o=0}=e;this._isStraightLine=Ty(a,0,.001)||Ty(o,0,.001);let l="type-arc"===n&&0!==s&&!this._isStraightLine,{newPosition:h,newItemPosition:u}=this.computeNewPositionAfterTargetItem(t);l!==this._isArcLine?(this._isArcLine=l,this.reDrawLine(i,{points:[{x:0,y:0}],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0})):this._isArcLine=l,this.setItemAttributes(this._item,e,h,u,r),this.setAllOfItemsAttr(h,u)}isValidPoints(){let{position:t}=this.attribute;return!(!l1(t.x)||!l1(t.y))}}Wt.defaultAttributes={interactive:!0,targetSymbol:{visible:!1,offset:0,style:{symbolType:"circle",size:20,fill:!1,stroke:"rgba(46, 47, 50)"}},itemLine:{visible:!0,decorativeLine:{visible:!1,length:30},startSymbol:{visible:!0,clip:!0,symbolType:"circle",size:20,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},endSymbol:{visible:!1,clip:!0,symbolType:"triangle",size:12,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},lineStyle:{stroke:"#000",lineWidth:1}},itemContent:{type:"text",position:"middle",refX:10,symbolStyle:{symbolType:"star",fill:"rgb(48, 115, 242)",fillOpacity:.8,size:20},textStyle:{dx:0,dy:0},imageStyle:{width:80,height:80},richTextStyle:{width:100,height:100}}};var We=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};class Wi extends HH{constructor(){super(...arguments),this.specKey="markPoint",this.layoutZIndex=tM.MarkPoint}static _getMarkerCoordinateType(t){let{doPolarProcess:e,doGeoProcess:i}=Hi(t);return"polar"===t.coordinateType||e?"polar":"geo"===t.coordinateType||i?"geo":"cartesian"}_createMarkerComponent(){var t,e,i,r,n,s,a,o,l,h,u,d,c,p,g,f,m,v,y,_,b,x,S,k,A,w,M,C,T,E,O,P;let{itemContent:R={},itemLine:B={},targetSymbol:I={}}=this._spec,{text:L={},symbol:D,image:F,richText:j}=R,N=We(R,["text","symbol","image","richText"]),z={zIndex:this.layoutZIndex,interactive:null===(t=this._spec.interactive)||void 0===t||t,hover:null===(e=this._spec.interactive)||void 0===e||e,select:null===(i=this._spec.interactive)||void 0===i||i,position:{x:0,y:0},clipInRange:null!==(r=this._spec.clip)&&void 0!==r&&r,itemContent:Object.assign({offsetX:(T=R.offsetX,E=this._relativeSeries.getRegion(),nx(T)?T(E):T),offsetY:(O=R.offsetX,P=this._relativeSeries.getRegion(),nx(O)?O(P):O)},N),targetSymbol:{offset:null!==(n=I.offset)&&void 0!==n?n:0,visible:null!==(s=I.visible)&&void 0!==s&&s,size:null!==(a=I.size)&&void 0!==a?a:20,style:z6(I.style,this._markerData)},state:{line:z8(null!==(l=null===(o=this._spec.itemLine.line)||void 0===o?void 0:o.state)&&void 0!==l?l:{},this._markerData),lineStartSymbol:z8(null!==(u=null===(h=this._spec.itemLine.startSymbol)||void 0===h?void 0:h.state)&&void 0!==u?u:{},this._markerData),lineEndSymbol:z8(null!==(c=null===(d=this._spec.itemLine.endSymbol)||void 0===d?void 0:d.state)&&void 0!==c?c:{},this._markerData),symbol:z8(null!==(g=null===(p=this._spec.itemContent.symbol)||void 0===p?void 0:p.state)&&void 0!==g?g:{},this._markerData),image:z8(null!==(m=null===(f=this._spec.itemContent.image)||void 0===f?void 0:f.state)&&void 0!==m?m:{},this._markerData),text:z8(null!==(y=null===(v=this._spec.itemContent.text)||void 0===v?void 0:v.state)&&void 0!==y?y:{},this._markerData),textBackground:z8(null===(b=null===(_=this._spec.itemContent.text)||void 0===_?void 0:_.labelBackground)||void 0===b?void 0:b.state,this._markerData),richText:z8(null!==(S=null===(x=this._spec.itemContent.richText)||void 0===x?void 0:x.state)&&void 0!==S?S:{},this._markerData),customMark:z8(null!==(A=null===(k=this._spec.itemContent.customMark)||void 0===k?void 0:k.state)&&void 0!==A?A:{},this._markerData),targetItem:z8(null!==(M=null===(w=this._spec.targetSymbol)||void 0===w?void 0:w.state)&&void 0!==M?M:{},this._markerData)},animation:null!==(C=this._spec.animation)&&void 0!==C&&C,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};(null==D?void 0:D.style)&&(z.itemContent.symbolStyle=Tz(z6(D.style,this._markerData))),(null==F?void 0:F.style)&&(z.itemContent.imageStyle=z6(F.style,this._markerData)),L&&(z.itemContent.textStyle=z4(L,this._markerData)),(null==j?void 0:j.style)&&(z.itemContent.richTextStyle=z6(j.style,this._markerData));let{visible:H,line:V={}}=B,W=We(B,["visible","line"]);return z.itemLine=!1!==H?Object.assign(Object.assign({},W),{visible:!0,lineStyle:Tz(V.style)}):{visible:!1},new Wt(z)}_markerLayout(){var t,e,i,r,n;let s;let a=this._spec,o=this._markerData,l=this._relativeSeries,{point:h}=this._computePointsAttr(),u=this._getRelativeDataView().latestData,d=o?o.latestData[0]&&o.latestData[0].latestData?o.latestData[0].latestData:o.latestData:u;if(a.clip||(null===(t=a.itemContent)||void 0===t?void 0:t.confine)){let{minX:t,maxX:e,minY:i,maxY:r}=z5([l.getRegion()]);s={x:t,y:i,width:e-t,height:r-i}}if(this._markerComponent){let t=null!==(e=this._markerComponent.attribute)&&void 0!==e?e:{},a=null!==(r=null===(i=t.itemContent)||void 0===i?void 0:i.textStyle)&&void 0!==r?r:{};this._markerComponent.setAttributes({position:void 0===h?{x:null,y:null}:h,itemContent:Object.assign(Object.assign({},t.itemContent),{textStyle:Object.assign(Object.assign({},a),{text:(null===(n=this._spec.itemContent.text)||void 0===n?void 0:n.formatMethod)?this._spec.itemContent.text.formatMethod(d,u):a.text}),offsetX:z7(h,t.itemContent.offsetX,this._relativeSeries.getRegion()),offsetY:z7(h,t.itemContent.offsetY,this._relativeSeries.getRegion())}),limitRect:s,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}}_initDataView(){let t=this._spec,{doXYProcess:e,doPolarProcess:i,doGeoProcess:r}=Hi(t);if(!(eO(t.coordinate)||e||i||r))return;gw(this._option.dataSet,"markerAggregation",Hj),gw(this._option.dataSet,"markerFilter",HW);let{options:n}=this._computeOptions(),s=new eH(this._option.dataSet,{name:`${this.type}_${this.id}_data`});s.parse([this._getRelativeDataView()],{type:"dataview"}),s.transform({type:"markerAggregation",options:n}),s.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),s.target.on("change",()=>{this._markerLayout()}),this._markerData=s}}Wi.specKey="markPoint";class Wr extends Wi{constructor(){super(...arguments),this.type=lx.markPoint,this.name=lx.markPoint,this.coordinateType="cartesian"}_computePointsAttr(){var t;let e;let i=this._spec,r=this._markerData,n=this._relativeSeries,s="x"in i&&"y"in i,a="coordinate"in i,o="position"in i,l=null!==(t=null==i?void 0:i.autoRange)&&void 0!==t&&t;return s?e=zQ(r,n,n,n,l)[0][0]:a?e=z1(r,n,l,i.coordinatesOffset)[0]:o&&(e=z3([i.position],n,i.regionRelative)[0]),{point:e}}_computeOptions(){let t;let e=this._spec,{doXYProcess:i}=Hi(e),r=eO(e.coordinate);return i?t=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}])]:r&&(t=this._processSpecCoo(e)),{options:t}}}Wr.type=lx.markPoint,Wr.coordinateType="cartesian";class Wn extends Wi{constructor(){super(...arguments),this.type=lx.polarMarkPoint,this.name=lx.polarMarkPoint,this.coordinateType="polar"}_computePointsAttr(){var t,e;let i=this._markerData,r=this._relativeSeries,n=z0(i,r,r,r,null!==(e=null===(t=this._spec)||void 0===t?void 0:t.autoRange)&&void 0!==e&&e)[0][0];return{point:iM({x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y},n.radius,n.angle)}}_computeOptions(){let t=this._spec;return{options:[this._processSpecByDims([{dim:"radius",specValue:t.radius},{dim:"angle",specValue:t.angle}])]}}}Wn.type=lx.polarMarkPoint,Wn.coordinateType="polar";class Ws extends Wi{constructor(){super(...arguments),this.type=lx.geoMarkPoint,this.name=lx.geoMarkPoint,this.coordinateType="geo"}_computePointsAttr(){let t=this._markerData;return{point:function(t,e){let i=[];return(t.latestData[0]&&t.latestData[0].latestData?t.latestData[0].latestData:t.latestData).forEach(t=>{eO(t.areaName)&&i.push([{x:e.nameValueToPosition(t.areaName).x+e.getRegion().getLayoutStartPoint().x,y:e.nameValueToPosition(t.areaName).y+e.getRegion().getLayoutStartPoint().y}])}),i}(t,this._relativeSeries)[0][0]}}_computeOptions(){let t=this._spec;return{options:[this._processSpecByDims([{dim:"areaName",specValue:t.areaName}])]}}}Ws.type=lx.geoMarkPoint,Ws.coordinateType="geo";function Wa(t,e,i){let r=0,n=t[0];if(!n)return!1;for(let s=1;s<t.length;s++){let a=t[s];r+=Wo(n.x,n.y,a.x,a.y,e,i),n=a}let s=t[0];return Wl(n.x,s.x)&&Wl(n.y,s.y)||(r+=Wo(n.x,n.y,s.x,s.y,e,i)),0!==r}function Wo(t,e,i,r,n,s){if(s>e&&s>r||s<e&&s<r||r===e)return 0;let a=(s-e)/(r-e),o=r<e?1:-1;1!==a&&0!==a||(o=r<e?.5:-.5);let l=a*(i-t)+t;return l===n?1/0:l>n?o:0}function Wl(t,e){return 1e-8>Math.abs(t-e)}function Wh(t,e){for(let i=0;i<e.length;i++)if(Wa(t,e[i].x,e[i].y)||i>0&&function(t,e,i,r,n){for(let s=0,a=n[n.length-1];s<n.length;s++){let o=n[s];if(a1([t,e],[i,r],[o.x,o.y],[a.x,a.y]))return!0;a=o}return!1}(e[i-1].x,e[i-1].y,e[i].x,e[i].y,t))return!0;return!1}(t2=ec||(ec={})).drawStart="drawStart",t2.drawEnd="drawEnd",t2.drawing="drawing",t2.moving="moving",t2.moveStart="moveStart",t2.moveEnd="moveEnd",t2.brushClear="brushClear";let Wu={trigger:"pointerdown",updateTrigger:"pointermove",endTrigger:"pointerup",resetTrigger:"pointerupoutside",hasMask:!0,brushMode:"single",brushType:"rect",brushStyle:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",strokeWidth:2},brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:10,interactiveRange:{y1:-Infinity,y2:1/0,x1:-Infinity,x2:1/0}},Wd={debounce:l3,throttle:dJ};v8(),AS();class Wc extends Eu{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},Wc.defaultAttributes,t)),this.name="brush",this._activeDrawState=!1,this._cacheDrawPoints=[],this._isDrawedBeforeEnd=!1,this._activeMoveState=!1,this._operatingMaskMoveDx=0,this._operatingMaskMoveDy=0,this._operatingMaskMoveRangeX=[-Infinity,1/0],this._operatingMaskMoveRangeY=[-Infinity,1/0],this._brushMaskAABBBoundsDict={},this._onBrushStart=t=>{var e;if(this._outOfInteractiveRange(t))return;t.stopPropagation();let i=null===(e=this.attribute.brushMoved)||void 0===e||e;this._activeMoveState=i&&this._isPosInBrushMask(t),this._activeDrawState=!this._activeMoveState,this._activeDrawState&&this._initDraw(t),this._activeMoveState&&this._initMove(t)},this._onBrushing=t=>{this._outOfInteractiveRange(t)||((this._activeDrawState||this._activeMoveState)&&t.stopPropagation(),this._activeDrawState&&this._drawing(t),this._activeMoveState&&this._moving(t))},this._onBrushingWithDelay=0===this.attribute.delayTime?this._onBrushing:Wd[this.attribute.delayType](this._onBrushing,this.attribute.delayTime),this._onBrushEnd=t=>{var e;if(!this._activeDrawState&&!this._activeMoveState)return;t.preventDefault();let{removeOnClick:i=!0}=this.attribute;this._activeDrawState&&!this._isDrawedBeforeEnd&&i?((null===(e=this._operatingMask)||void 0===e?void 0:e._AABBBounds.empty())&&this._dispatchEvent(ec.brushClear,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t}),this._container.incrementalClearChild(),this._brushMaskAABBBoundsDict={}):(this._activeDrawState&&this._dispatchEvent(ec.drawEnd,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t}),this._activeMoveState&&this._dispatchEvent(ec.moveEnd,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t})),this._activeDrawState=!1,this._activeMoveState=!1,this._isDrawedBeforeEnd=!1,this._operatingMask&&this._operatingMask.setAttribute("pickable",!1)}}_bindBrushEvents(){if(this.attribute.disableTriggerEvent)return;let{trigger:t=Wu.trigger,updateTrigger:e=Wu.updateTrigger,endTrigger:i=Wu.endTrigger,resetTrigger:r=Wu.resetTrigger}=this.attribute;this.stage.addEventListener(t,this._onBrushStart),this.stage.addEventListener(e,this._onBrushingWithDelay),this.stage.addEventListener(i,this._onBrushEnd),this.stage.addEventListener(r,this._onBrushEnd)}_isPosInBrushMask(t){let e=this.eventPosToStagePos(t),i=this._container.getChildren();for(let t=0;t<i.length;t++){let{points:r=[],dx:n=0,dy:s=0}=i[t].attribute;if(Wa(r.map(t=>({x:t.x+n,y:t.y+s})),e.x,e.y))return this._operatingMask=i[t],!0}return!1}_initDraw(t){let{brushMode:e}=this.attribute,i=this.eventPosToStagePos(t);this._cacheDrawPoints=[i],this._isDrawedBeforeEnd=!1,"single"===e&&(this._brushMaskAABBBoundsDict={},this._container.incrementalClearChild()),this._addBrushMask(),this._dispatchEvent(ec.drawStart,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t})}_initMove(t){var e,i;this._cacheMovePoint=this.eventPosToStagePos(t),this._operatingMaskMoveDx=null!==(e=this._operatingMask.attribute.dx)&&void 0!==e?e:0,this._operatingMaskMoveDy=null!==(i=this._operatingMask.attribute.dy)&&void 0!==i?i:0;let{interactiveRange:r}=this.attribute,{minY:n=-Infinity,maxY:s=1/0,minX:a=-Infinity,maxX:o=1/0}=r,{x1:l,x2:h,y1:u,y2:d}=this._operatingMask.globalAABBBounds;this._operatingMaskMoveRangeX=[a-l,o-h],this._operatingMaskMoveRangeY=[n-u,s-d],this._operatingMask.setAttribute("pickable",!0),this._dispatchEvent(ec.moveStart,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t})}_drawing(t){var e,i;let r=this.eventPosToStagePos(t),{sizeThreshold:n=5,brushType:s}=this.attribute,a=this._cacheDrawPoints.length;if(a>0){let t=null!==(e=this._cacheDrawPoints[this._cacheDrawPoints.length-1])&&void 0!==e?e:{};if(r.x===t.x&&r.y===t.y)return}"polygon"===s||a<=1?this._cacheDrawPoints.push(r):this._cacheDrawPoints[a-1]=r;let o=this._computeMaskPoints();this._operatingMask.setAttribute("points",o);let{x1:l=0,x2:h=0,y1:u=0,y2:d=0}=null===(i=this._operatingMask)||void 0===i?void 0:i._AABBBounds;this._isDrawedBeforeEnd=!this._operatingMask._AABBBounds.empty()&&!!(Math.abs(h-l)>n||Math.abs(u-d)>n),this._isDrawedBeforeEnd&&(this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchEvent(ec.drawing,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t}))}_moving(t){let e=this._cacheMovePoint,i=this.eventPosToStagePos(t);if(i.x===(null==e?void 0:e.x)&&i.y===(null==e?void 0:e.y))return;let r=i.x-e.x,n=i.y-e.y,s=Math.min(this._operatingMaskMoveRangeX[1],Math.max(this._operatingMaskMoveRangeX[0],r))+this._operatingMaskMoveDx,a=Math.min(this._operatingMaskMoveRangeY[1],Math.max(this._operatingMaskMoveRangeY[0],n))+this._operatingMaskMoveDy;this._operatingMask.setAttributes({dx:s,dy:a}),this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchEvent(ec.moving,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:t})}_computeMaskPoints(){let{brushType:t,xRange:e=[0,0],yRange:i=[0,0]}=this.attribute,r=[],n=this._cacheDrawPoints[0],s=this._cacheDrawPoints[this._cacheDrawPoints.length-1];return"rect"===t?[n,{x:s.x,y:n.y},s,{x:n.x,y:s.y}]:"x"===t?[{x:n.x,y:i[0]},{x:s.x,y:i[0]},{x:s.x,y:i[1]},{x:n.x,y:i[1]}]:"y"===t?[{x:e[0],y:n.y},{x:e[0],y:s.y},{x:e[1],y:s.y},{x:e[1],y:n.y}]:eP(this._cacheDrawPoints)}_addBrushMask(){var t;let{brushStyle:e,hasMask:i}=this.attribute,r=aj.polygon(Object.assign(Object.assign({points:eP(this._cacheDrawPoints),cursor:"move",pickable:!1},e),{opacity:i?null!==(t=e.opacity)&&void 0!==t?t:1:0}));r.name=`brush-${Date.now()}`,this._operatingMask=r,this._container.add(r),this._brushMaskAABBBoundsDict[r.name]=r.AABBBounds}_outOfInteractiveRange(t){let{interactiveRange:e}=this.attribute,{minY:i=-Infinity,maxY:r=1/0,minX:n=-Infinity,maxX:s=1/0}=e,a=this.eventPosToStagePos(t);return a.x>s||a.x<n||a.y>r||a.y<i}eventPosToStagePos(t){return this.stage.eventPointTransform(t)}render(){this._bindBrushEvents();let t=this.createOrUpdateChild("brush-container",{},"group");this._container=t}releaseBrushEvents(){let{delayType:t="throttle",delayTime:e=0,trigger:i=Wu.trigger,updateTrigger:r=Wu.updateTrigger,endTrigger:n=Wu.endTrigger,resetTrigger:s=Wu.resetTrigger}=this.attribute;this.stage.removeEventListener(i,this._onBrushStart),this.stage.removeEventListener(r,this._onBrushingWithDelay),this.stage.removeEventListener(n,this._onBrushEnd),this.stage.removeEventListener(s,this._onBrushEnd)}}Wc.defaultAttributes=Wu;class Wp extends Ea{constructor(){super(...arguments),this.layoutType="none",this.type=lx.brush,this.name=lx.brush,this.specKey="brush",this.layoutZIndex=tM.Brush,this._linkedSeries=[],this._itemMap={},this._linkedItemMap={},this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._needInitOutState=!0,this._cacheInteractiveRangeAttrs=[],this._needDisablePickable=!1,this._releatedAxes=[],this._regionAxisMap={},this._axisDataZoomMap={},this._zoomRecord=[]}init(){let t=this._transformBrushedMarkAttr(this._spec.inBrush),e=this._transformBrushedMarkAttr(this._spec.outOfBrush);this._option.getAllSeries().forEach(i=>{i.getActiveMarks().forEach(r=>{r&&(i.setMarkStyle(r,Object.assign({},t),"inBrush",tw.Series),i.setMarkStyle(r,Object.assign({},e),"outOfBrush",tw.Series))})})}static getSpecInfo(t){let e=t[this.specKey];if(!ej(e)&&!1!==e.visible)return[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.brush}]}created(){super.created(),this.initEvent(),this._bindRegions(),this._bindLinkedSeries(),this._initRegionAxisMap(),this._initAxisDataZoomMap(),this._initNeedOperatedItem()}_extendDataInBrush(t){let e=[];for(let i in t)for(let r in t[i])e.push(Object.assign({},t[i][r].data[0]));return e}_extendDatumOutOfBrush(t){let e=[];for(let i in t)e.push(t[i].data[0]);return e}_getBrushInteractiveAttr(t){let e=t.getLayoutStartPoint(),i=t.getLayoutRect(),r=e.x,n=r+i.width,s=e.y,a=s+i.height;return{interactiveRange:{minY:s,maxY:a,minX:r,maxX:n},xRange:[r,n],yRange:[s,a]}}_updateBrushComponent(t,e){let i=this._getBrushInteractiveAttr(t),r=this._brushComponents[e];r.setAttributes(i),this._initMarkBrushState(e,""),r.children[0].removeAllChild(),this._needInitOutState=!0}_createBrushComponent(t,e){var i,r;let n=this._getBrushInteractiveAttr(t),s=new Wc(Object.assign(Object.assign(Object.assign({zIndex:this.layoutZIndex,brushStyle:Tz(null===(i=this._spec)||void 0===i?void 0:i.style)},n),this._spec),{disableTriggerEvent:this._option.disableTriggerEvent}));s.id=null!==(r=this._spec.id)&&void 0!==r?r:`brush-${this.id}`,this.getContainer().add(s);let{brushMode:a="single"}=this._spec;this._brushComponents.push(s),this._cacheInteractiveRangeAttrs.push(n),s.addEventListener(ec.drawStart,e=>{this._emitEvent(c1.brushStart,t)}),s.addEventListener(ec.moveStart,e=>{this._emitEvent(c1.brushStart,t)}),s.addEventListener(ec.drawing,i=>{this._needInitOutState&&"single"===a&&this._initMarkBrushState(e,"outOfBrush"),this._needInitOutState=!1,this._needDisablePickable=!0,this._handleBrushChange(c1.brushChange,t,i),this._emitEvent(c1.brushChange,t)}),s.addEventListener(ec.moving,e=>{this._handleBrushChange(c1.brushChange,t,e),this._emitEvent(c1.brushChange,t)}),s.addEventListener(ec.brushClear,i=>{this._initMarkBrushState(e,""),this._needInitOutState=!0,this._needDisablePickable=!1,this._handleBrushChange(c1.brushChange,t,i),this._handleBrushChange(c1.brushClear,t,i),this._emitEvent(c1.brushChange,t),this._emitEvent(c1.brushClear,t)}),s.addEventListener(ec.drawEnd,e=>{this._needInitOutState=!0,this._needDisablePickable=!1;let{operateMask:i}=e.detail;this._handleBrushChange(c1.brushEnd,t,e),this._setAxisAndDataZoom(i,t),this._emitEvent(c1.brushEnd,t)}),s.addEventListener(ec.moveEnd,e=>{let{operateMask:i}=e.detail;this._handleBrushChange(c1.brushEnd,t,e),this._setAxisAndDataZoom(i,t),this._emitEvent(c1.brushEnd,t)})}_handleBrushChange(t,e,i){let{operateMask:r}=i.detail;this._reconfigItem(r,e),this._reconfigLinkedItem(r,e)}_emitEvent(t,e){this.event.emit(t,{model:this,value:{operateType:t,operateRegion:e,inBrushData:this._extendDataInBrush(this._inBrushElementsMap),outOfBrushData:this._extendDatumOutOfBrush(this._outOfBrushElementsMap),linkInBrushData:this._extendDataInBrush(this._linkedInBrushElementsMap),linkOutOfBrushData:this._extendDatumOutOfBrush(this._linkedOutOfBrushElementsMap),inBrushElementsMap:this._inBrushElementsMap,outOfBrushElementsMap:this._outOfBrushElementsMap,linkedInBrushElementsMap:this._linkedInBrushElementsMap,linkedOutOfBrushElementsMap:this._linkedOutOfBrushElementsMap,zoomRecord:this._zoomRecord}})}_transformBrushedMarkAttr(t){let e={};return(null==t?void 0:t.symbol)&&(e.symbolType=t.symbol),(null==t?void 0:t.symbolSize)&&(e.size=t.symbolSize),(null==t?void 0:t.color)&&(e.fill=t.color),(null==t?void 0:t.colorAlpha)&&(e.fillOpacity=t.colorAlpha),Object.assign(Object.assign({},Tz(t)),e)}_reconfigItem(t,e){this._itemMap[e.id].forEach(e=>{let i=e.getProduct();i&&i.elements&&i.elements.length&&i.elements.forEach(i=>{var r,n,s;let a=i.getGraphicItem(),o=e.id+"_"+i.key;(null===(r=this._outOfBrushElementsMap)||void 0===r?void 0:r[o])&&this._isBrushContainItem(t,a)?(i.addState("inBrush"),this._inBrushElementsMap[null==t?void 0:t.name]||(this._inBrushElementsMap[null==t?void 0:t.name]={}),this._inBrushElementsMap[null==t?void 0:t.name][o]=i,delete this._outOfBrushElementsMap[o]):(null===(s=null===(n=this._inBrushElementsMap)||void 0===n?void 0:n[null==t?void 0:t.name])||void 0===s?void 0:s[o])&&!this._isBrushContainItem(t,a)&&(i.removeState("inBrush"),i.addState("outOfBrush"),this._outOfBrushElementsMap[o]=i,delete this._inBrushElementsMap[t.name][o]),a.setAttribute("pickable",!this._needDisablePickable)})})}_reconfigLinkedItem(t,e){let i=e.getLayoutStartPoint(),r=e.getSeries().map(t=>t.id);this._linkedSeries.forEach(e=>{if(!r.includes(e.id)){let r=e.getRegion().getLayoutStartPoint(),n=r.x-i.x,s=r.y-i.y;this._linkedItemMap[e.id].forEach(e=>{let i=e.getProduct();i&&i.elements&&i.elements.length&&i.elements.forEach(i=>{var r,a,o;let l=i.getGraphicItem(),h=e.id+"_"+i.key;(null===(r=this._linkedOutOfBrushElementsMap)||void 0===r?void 0:r[h])&&this._isBrushContainItem(t,l,{dx:n,dy:s})?(i.addState("inBrush"),this._linkedInBrushElementsMap[null==t?void 0:t.name]||(this._linkedInBrushElementsMap[null==t?void 0:t.name]={}),this._linkedInBrushElementsMap[null==t?void 0:t.name][h]=i,delete this._linkedOutOfBrushElementsMap[h]):(null===(o=null===(a=this._linkedInBrushElementsMap)||void 0===a?void 0:a[null==t?void 0:t.name])||void 0===o?void 0:o[h])&&!this._isBrushContainItem(t,l,{dx:n,dy:s})&&(i.removeState("inBrush"),i.addState("outOfBrush"),this._linkedOutOfBrushElementsMap[h]=i),l.setAttribute("pickable",!this._needDisablePickable)})})}})}_isBrushContainItem(t,e,i){var r,n,s;if(!(null==t?void 0:t.globalTransMatrix)||!(null===(r=null==t?void 0:t.attribute)||void 0===r?void 0:r.points))return!1;let a=null!==(s=null===(n=null==t?void 0:t.attribute)||void 0===n?void 0:n.points)&&void 0!==s?s:[],{a:o,b:l,c:h,d:u,e:d,f:c}=t.globalTransMatrix,p=(null==i?void 0:i.dx)||0,g=(null==i?void 0:i.dy)||0,f=a.map(t=>({x:o*t.x+h*t.y+d+p,y:l*t.x+u*t.y+c+g}));t.globalAABBBounds.clone().set(t.globalAABBBounds.x1+p,t.globalAABBBounds.y1+g,t.globalAABBBounds.x2+p,t.globalAABBBounds.y2+g);let m=e.globalTransMatrix.e,v=e.globalTransMatrix.f,y=[];if("symbol"===e.type){let{size:t=0}=null==e?void 0:e.attribute,i=om(t)[0]/2;return Wh(f,y=[{x:m-i,y:v-i},{x:m+i,y:v-i},{x:m+i,y:v+i},{x:m-i,y:v+i}])}if("rect"===e.type){let{x1:t,x2:i,y1:r,y2:n}=null==e?void 0:e.AABBBounds,s=Math.abs(t-i),a=Math.abs(r-n);return Wh(f,y=[{x:m,y:v},{x:m+s,y:v},{x:m+s,y:v+a},{x:m,y:v+a}])}return t.globalAABBBounds.intersects(e.globalAABBBounds)}_stateClamp(t){return Math.min(Math.max(0,t),1)}_setAxisAndDataZoom(t,e){var i;if(this._zoomRecord=[],this._spec.zoomAfterBrush){let r=t.AABBBounds;null===(i=this._regionAxisMap["region_"+e.id])||void 0===i||i.forEach(t=>{var i,n;let s="bottom"===t.layoutOrient||"top"===t.layoutOrient,a=null!==(i=this._spec.axisRangeExpand)&&void 0!==i?i:0,{x1:o,x2:l,y1:h,y2:u}=r,d=s?"x":"y",c=s?o:h,p=s?l:u;if(this._axisDataZoomMap[t.id]){let i=this._axisDataZoomMap[t.id],r=i.relatedAxisComponent,n=r.getScale().invert(c-e.getLayoutStartPoint()[d]),s=r.getScale().invert(p-e.getLayoutStartPoint()[d]),o=i.dataToStatePoint(n),l=i.dataToStatePoint(s),h=this._stateClamp(o-a),u=this._stateClamp(l+a);i.setStartAndEnd(h,u,["percent","percent"]),this._zoomRecord.push({operateComponent:i,start:h,end:u})}else{let i=t.getScale().range(),r=null!==(n=t.getScale().rangeFactor())&&void 0!==n?n:[0,1],s=c-e.getLayoutStartPoint()[d],o=p-e.getLayoutStartPoint()[d],l=(s-i[0])/(i[1]-i[0])*(r[1]-r[0])+r[0],h=(o-i[0])/(i[1]-i[0])*(r[1]-r[0])+r[0],u=this._stateClamp(l-a),g=this._stateClamp(h+a);t.getScale().rangeFactor([u,g]),t.effect.scaleUpdate(),this._zoomRecord.push({operateComponent:t,start:u,end:g})}})}}_bindRegions(){eO(this._spec.regionId)&&eO(this._spec.regionIndex)&&(this._relativeRegions=this._option.getAllRegions()),this._relativeRegions=this._option.getRegionsInUserIdOrIndex(om(this._spec.regionId),om(this._spec.regionIndex))}_bindLinkedSeries(){eO(this._spec.brushLinkSeriesId)&&eO(this._spec.brushLinkSeriesIndex)||(this._linkedSeries=this._option.getSeriesInUserIdOrIndex(om(this._spec.brushLinkSeriesId),om(this._spec.brushLinkSeriesIndex)))}_initRegionAxisMap(){eO(this._spec.axisId)?om(this._spec.axisId).forEach(t=>{this._releatedAxes.push(this._option.getComponentByUserId(t))}):eO(this._spec.axisIndex)?om(this._spec.axisIndex).forEach(t=>{this._releatedAxes.push(this._option.getComponentByIndex("axes",t))}):this._releatedAxes=this._option.getComponentsByKey("axes"),this._releatedAxes.forEach(t=>{null==t||t.getRegions().forEach(e=>{this._regionAxisMap["region_"+e.id]?this._regionAxisMap["region_"+e.id].push(t):this._regionAxisMap["region_"+e.id]=[t]})})}_initAxisDataZoomMap(){this._option.getComponentsByKey("dataZoom").forEach(t=>{t.relatedAxisComponent&&(this._axisDataZoomMap[t.relatedAxisComponent.id]=t)})}_initNeedOperatedItem(){let t=this._spec.seriesId,e=this._spec.seriesIndex;this._relativeRegions.forEach(i=>{let r=[];i.getSeries().forEach(n=>{(t&&om(t).includes(n.userId.toString())||e&&om(e).includes(n.getSpecIndex())||!e&&!t)&&r.push(...n.getMarksWithoutRoot()),this._itemMap[i.id]=r})}),this._linkedSeries.forEach(t=>{this._linkedItemMap[t.id]=t.getMarksWithoutRoot()})}_initMarkBrushState(t,e){this._brushComponents.forEach((e,i)=>{i!==t&&e.children[0].removeAllChild()}),this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._option.getAllSeries().forEach(t=>{t.getMarksWithoutRoot().forEach(t=>{let i=t.getProduct();i&&i.elements&&i.elements.length&&i.elements.forEach(i=>{let r=t.id+"_"+i.key;i.removeState("inBrush"),i.removeState("outOfBrush"),i.addState(e),this._outOfBrushElementsMap[r]=i,this._linkedOutOfBrushElementsMap[r]=i})})})}initEvent(){}onRender(t){}changeRegions(t){}_getNeedClearVRenderComponents(){return this._brushComponents}_compareSpec(t,e){this._brushComponents&&this._relativeRegions.forEach((t,e)=>{this._updateBrushComponent(t,e)});let i=super._compareSpec(t,e);return my(e,t)||(i.reRender=!0,i.reMake=!0),i}onLayoutEnd(t){var e;super.onLayoutEnd(t),!this._option.disableTriggerEvent&&(null===(e=this._spec.visible)||void 0===e||e)&&(this._brushComponents?this._relativeRegions.forEach((t,e)=>{this._updateBrushComponent(t,e)}):(this._brushComponents=[],this._relativeRegions.forEach((t,e)=>{this._createBrushComponent(t,e)})))}clearGraphic(){this._brushComponents&&this._brushComponents.forEach(t=>{t._container.incrementalClearChild()})}clear(){if(this._brushComponents){let t=this.getContainer();this._brushComponents.forEach(e=>{e.removeAllChild(),e.releaseBrushEvents(),t&&t.removeChild(e)}),this._brushComponents=null}}}Wp.type=lx.brush,Wp.specKey="brush";class Wg extends Ea{constructor(){super(...arguments),this.type=lx.customMark,this.specKey="customMark",this.layoutType="none",this.layoutZIndex=tM.CustomMark,this.layoutLevel=tC.CustomMark}static getSpecInfo(t){let e=t[this.specKey];return e?eM(e)?e.map((t,e)=>({spec:t,specPath:[this.specKey,e],specInfoPath:["component",this.specKey,e],type:lx.customMark})):[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.customMark}]:null}created(){super.created(),this.initMarks(),this.initEvent()}getMarkAttributeContext(){return this._markAttributeContext}_buildMarkAttributeContext(){this._markAttributeContext={vchart:this._option.globalInstance,globalScale:(t,e)=>{var i;return null===(i=this._option.globalScale.getScale(t))||void 0===i?void 0:i.scale(e)}}}initMarks(){if(!this._spec)return;let t=this._option&&this._option.getAllSeries(),e=!1!==this._option.animation,i=[];t&&t.length&&t.forEach(t=>{let e=t&&t.getMarksWithoutRoot();e&&e.length&&e.forEach(t=>{i.push(t)})}),this._createExtensionMark(this._spec,null,`${hA}_series_${this.id}_extensionMark`,0,{depend:i,hasAnimation:e})}_createExtensionMark(t,e,i,r=0,n){var s;let a=this._createMark({type:t.type,name:`${i}_${r}`},{skipBeforeLayouted:!0,attributeContext:this._getMarkAttributeContext(),componentType:t.componentType,key:t.dataKey});if(a){if(n.hasAnimation&&t.animation){let e=CX({},Cq(t.type,t,this._markAttributeContext));a.setAnimationConfig(e)}if(n.depend&&n.depend.length&&a.setDepend(...n.depend),ej(e)?this._marks.addMark(a):e&&e.addMark(a),this.initMarkStyleWithSpec(a,t),"group"===t.type&&(i=`${i}_${r}`,null===(s=t.children)||void 0===s||s.forEach((t,e)=>{this._createExtensionMark(t,a,i,e,n)})),eO(t.dataId)||l1(t.dataIndex)){let e=this.getChart().getSeriesData(t.dataId,t.dataIndex);e&&(e.target.addListener("change",()=>{a.getData().updateData()}),a.setDataView(e))}}}initEvent(){}_compareSpec(t,e){let i=super._compareSpec(t,e);return my(e,t)||(i.reMake=!0),i.change=!0,i.reRender=!0,i}changeRegions(t){}_getNeedClearVRenderComponents(){return[]}onRender(t){}afterCompile(){this.getMarks().forEach(t=>{let e=t.getProduct();e&&e.addEventListener(pa.AFTER_ELEMENT_ENCODE,()=>{if(!1===this._isLayout){let t=e.getGroupGraphicItem();0===t.listenerCount("*")&&t.addEventListener("*",(e,i)=>this._delegateEvent(t,e,i))}})})}_getMarkAttributeContext(){return{vchart:this._option.globalInstance,chart:this.getChart(),globalScale:(t,e)=>{var i;return null===(i=this._option.globalScale.getScale(t))||void 0===i?void 0:i.scale(e)},getLayoutBounds:()=>{let{x:t,y:e}=this.getLayoutStartPoint(),{width:i,height:r}=this.getLayoutRect();return(new iB).set(t,e,t+i,e+r)}}}_getLayoutRect(){let t=new iB;return this.getMarks().forEach(e=>{let i=e.getProduct();i&&t.union(i.getBounds())}),t.empty()?{width:0,height:0}:{width:t.width(),height:t.height()}}getBoundsInRect(t){this.setLayoutRect(t);let e=this._getLayoutRect(),{x:i,y:r}=this.getLayoutStartPoint();return{x1:i,y1:r,x2:i+e.width,y2:r+e.height}}}Wg.type=lx.customMark,Wg.specKey="customMark";function Wf(t,e,i=0){return i>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2)}function Wm(t){var e;if(!t||0===t.length)return[];if(1===t.length)return[t[0].rect];let i=t.map(t=>{var e,i;return Object.assign(Object.assign({},t),{bound:{x1:(i=t.rect).x,x2:i.x+i.width,y1:i.y,y2:i.y+i.height},anchorCandidates:function(t,e,i,r=0){let n=[];return t.forEach(t=>{let{x:s,y:a}=Wb(Object.assign(Object.assign({},e),{width:i.width,height:i.height}),t,r);n.push({x:s,y:a})}),n}(null!==(e=t.anchors)&&void 0!==e?e:[],t.point,t.rect,t.offset)})}),r=[];r.push(i[0].bound);for(let t=1;t<=i.length-1;t++){let n=i[t],s=n.bound,a=r.some(t=>Wf(t,s));if(n.anchorCandidates){if(a&&(null===(e=n.anchorCandidates)||void 0===e?void 0:e.length)>0){for(let t=0;t<n.anchorCandidates.length;t++){let e=n.anchorCandidates[t],i={x1:e.x,y1:e.y,x2:e.x+s.x2-s.x1,y2:e.y+s.y2-s.y1,anchor:e};if(!r.some(t=>Wf(t,i))){r.push(i),a=!1;break}}a&&r.push(n.bound)}else r.push(n.bound)}}return r.map(t=>{var e;return{x:(e=t).x1,y:e.y1,width:e.x2-e.x1,height:e.y2-e.y1}})}function Wv(t){return t>180?t-360:t}function Wy(t,e){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI+90}function W_(t,e){for(let i=0;i<t.length;i++)if(function(t,e){var i;if(!t||!e)return!1;let r="Feature"===(i=e).type?i.geometry:i,n=r.type,s=e.bbox,a=r.coordinates;if(s&&!0===a8(t,{x1:s[0],x2:s[1],y1:s[1],y2:s[3]},!0))return!1;"Polygon"===n&&(a=[a]);let o=!1;for(let e=0;e<a.length;++e)for(let i=0;i<a[e].length;++i)if(Wa(a[e][i].map(t=>({x:t[0],y:t[1]})),t.x,t.y))return!0;return o}(e,t[i]))return!0;return!1}function Wb(t,e,i=0){let r=Object.assign({},t);return"top"===e?(r.x-=t.width/2,r.y-=i+t.height/2):"bottom"===e?(r.x-=t.width/2,r.y+=i-t.height/2):"left"===e?(r.x-=i+t.width,r.y-=t.height/2):"right"===e&&(r.x+=i,r.y-=t.height/2),r}class Wx extends Ea{constructor(){super(...arguments),this.type=lx.mapLabel,this.name=lx.mapLabel,this.specKey="mapLabel",this.layoutType="none",this.layoutZIndex=tM.MarkPoint,this._activeDatum=[]}static getSpecInfo(t){let e=t[this.specKey];return e&&e.visible&&!eO(e.series)?[{spec:e,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:lx.mapLabel}]:null}setAttrFromSpec(){var t,e,i,r;this.nameField=null!==(t=this._spec.nameField)&&void 0!==t?t:null===(e=this._series)||void 0===e?void 0:e.getDimensionField()[0],this.valueField=null!==(i=this._spec.valueField)&&void 0!==i?i:null===(r=this._series)||void 0===r?void 0:r.getMeasureField()[0]}created(){super.created(),!1!=!!this._spec.visible&&(this.initRelatedInfo(),this.initData(),this.initEvent())}initRelatedInfo(){var t,e,i,r,n,s,a,o;this._series=this._option.getSeriesInUserIdOrIndex([this._spec.seriesId])[0],"outer"===this._spec.position&&(this._map=null===(e=null===(t=this._regions[0].getSeriesInType("map")[0])||void 0===t?void 0:t.getMapViewData())||void 0===e?void 0:e.latestData,this._longitudeField=null===(n=null===(r=(i=this._regions[0]).getSpec)||void 0===r?void 0:r.call(i))||void 0===n?void 0:n.longitudeField,this._latitudeField=null===(o=null===(a=(s=this._regions[0]).getSpec)||void 0===a?void 0:a.call(s))||void 0===o?void 0:o.latitudeField)}initData(){let t=this._series;if(!t)return;let e=t.getViewData();if(e){let t=new eH(this._option.dataSet,{name:`${this.name}_data`});t.parse([e],{type:"dataview"}),t.transform({type:"copyDataView",level:ty.copyDataView},!1),this._data=new Sa(this._option,t),t.target.addListener("change",()=>{"hover"!==this._spec.trigger&&"click"!==this._spec.trigger&&(this._activeDatum=this._data.getLatestData())})}}initEvent(){var t;this.event.on("zoom",{filter:t=>this._isRelativeModel(t.model)},t=>(this.handleZoom(t),!0)),this.event.on("panmove",{filter:t=>this._isRelativeModel(t.model)},t=>(this.handlePan(t),!0));let e=this._spec.trigger;if("none"===e)return;let i=null===(t=this.getCompiler())||void 0===t?void 0:t.getVGrammarView();i&&("hover"===e?(i.addEventListener("element-highlight:start",t=>{this._isRelativeSeries(t.options.seriesId)&&this._updateDatum(t.elements[0].getDatum())}),i.addEventListener("element-highlight:reset",t=>{this._isRelativeSeries(t.options.seriesId)&&this._updateDatum(null)})):"click"===e&&(i.addEventListener("element-select:start",t=>{this._isRelativeSeries(t.options.seriesId)&&this._updateDatum(t.elements[0].getDatum())}),i.addEventListener("elementSelectReset",t=>{this._isRelativeSeries(t.options.seriesId)&&this._updateDatum([])})))}handlePan(t){let{delta:e}=t;this._markerComponents.forEach(t=>{t.translate(e[0],e[1])})}handleZoom(t){this._updateMarkerLayoutAttribute()}_updateDatum(t){this._activeDatum=t,this._markerComponents.forEach((t,e)=>{var i;let r=null===(i=this._data)||void 0===i?void 0:i.getLatestData()[e];this._activeDatum.includes(r)?t.setAttribute("visible",!0):t.setAttribute("visible",!1)})}dataToPosition(t){return this._series.dataToPosition(t)}updateLayoutAttribute(){var t;let e=null===(t=this._data)||void 0===t?void 0:t.getLatestData();e&&0!==e.length&&(super.updateLayoutAttribute(),this._updateMarkerLayoutAttribute())}_updateMarkerLayoutAttribute(){var t;let e=[],i=[];this._markerComponents||(this._markerComponents=null===(t=this._data)||void 0===t?void 0:t.getLatestData().map((t,e)=>{var i;let r=new Wt({position:void 0,animation:!1});return r&&(r.name=`${this.name}_marker_${e}`,r.id=null!==(i=this._spec.id)&&void 0!==i?i:`${this.name}_marker_${this.id}`,r.setAttribute("zIndex",this.layoutZIndex)),r})),this._markerComponents.forEach((t,r)=>{t.removeAllChild();let{pairInfo:n,contentMarks:s}=this._evaluateMarker(this._data.getLatestData()[r],r);n&&e.push(n),s&&i.push(s)});let r=this._layoutLabels(e);this._layoutMarkers(r,i),this._renderMarkers()}_evaluateMarker(t,e){var i,r,n,s,a,o,l,h,u,d,c,p;let g=0,f=0,m=0,v=0,y=0,_=this._spec.position||"top",b=this._spec.offset,x=hi(null===(i=this._spec.background)||void 0===i?void 0:i.padding),S=this._spec.space||0;f+=((null==x?void 0:x.left)||0)+((null==x?void 0:x.right)||0),m+=((null==x?void 0:x.top)||0)+((null==x?void 0:x.bottom)||0);let k={},A=this.dataToPosition(t),w=sG({});if(w.name=`${this.name}_marker_itemContainer_${e}`,k.container=w,null===(r=this._spec.background)||void 0===r?void 0:r.visible){let t=_4(Tz(Object.assign({},this._spec.background.style)));t.setAttributes(A),k.labelBackground=t,w.appendChild(t)}if(null===(n=this._spec.icon)||void 0===n?void 0:n.visible){let t=_G(Tz(Object.assign({},this._spec.icon.style)));t.setAttributes(A),t.setAttribute("symbolType",null===(s=this._spec.icon.style)||void 0===s?void 0:s.shape);let e=t.AABBBounds,i=(a=(null==e?void 0:e.y2)-(null==e?void 0:e.y1),a),r=(o=(null==e?void 0:e.x2)-(null==e?void 0:e.x1),o);k.icon=t,w.appendChild(t),y=i,v+=r,g++}if(null===(l=this._spec.nameLabel)||void 0===l?void 0:l.visible){let e=yt(Tz(Object.assign({},this._spec.nameLabel.style)));e.setAttributes(A),e.setAttribute("text",t[this.nameField]);let i=e.AABBBounds,r=(h=(null==i?void 0:i.y2)-(null==i?void 0:i.y1),h),n=(u=(null==i?void 0:i.x2)-(null==i?void 0:i.x1),u);k.nameLabel=e,w.appendChild(e),y=Math.max(y,r),v+=n,g++}if((null===(d=this._spec.valueLabel)||void 0===d?void 0:d.visible)&&eO(t[this.valueField])){let e=yt(Tz(Object.assign({},this._spec.valueLabel.style)));e.setAttributes(A),e.setAttribute("text",t[this.valueField]);let i=e.AABBBounds,r=(c=(null==i?void 0:i.y2)-(null==i?void 0:i.y1),c),n=(p=(null==i?void 0:i.x2)-(null==i?void 0:i.x1),p);k.valueLabel=e,w.appendChild(e),y=Math.max(y,r),v+=n,g++}let M=Object.values(k).find(t=>!!t&&"group"!==t.type),C={x:null==M?void 0:M.getComputedAttribute("x"),y:null==M?void 0:M.getComputedAttribute("y")},T={x:C.x,y:C.y,width:0,height:0};T.width=f+v+(g-1)*S,T.height=m+y;let E={rect:T,point:C,index:e};if("outer"!==_){let t=["top","right","left","bottom"].filter(t=>t!==_);E.rect=Wb(T,_,b),E.anchors=t,E.offset=b}else E.pointCoord={x:+(null==t?void 0:t[this._longitudeField]),y:+(null==t?void 0:t[this._latitudeField])};return{pairInfo:E,contentMarks:k}}_layoutMarkers(t,e){var i,r,n;for(let s=0;s<e.length;s++){if(!t[s]||!e[s])return;let{icon:a,nameLabel:o,valueLabel:l,labelBackground:h,container:u}=e[s],d=t[s],c=hi(null===(i=this._spec.background)||void 0===i?void 0:i.padding),p=this._spec.space||0,g=d.height/2,f=(null==c?void 0:c.left)||0;[a,o,l].forEach((t,e)=>{var i,r;if(t){let n=t.AABBBounds,s=0;"symbol"===t.type&&(s+=(i=n.x2-n.x1,i/2)),t.setAttributes({x:f+s,y:g}),f+=(r=n.x2-n.x1,r),2!==e&&(f+=p)}}),null==h||h.setAttributes({x:0,y:0,width:d.width,height:d.height}),null==u||u.setAttributes({dx:-d.width/2,dy:-d.height/2});let m=this._data.getLatestData()[s],v=this.dataToPosition(m),y=this.getRegions()[0].getLayoutStartPoint(),_=!(!(null===(r=this._spec.leader)||void 0===r?void 0:r.visible)||!(a||o||l));this._markerComponents[s].setAttributes({x:y.x,y:y.y,position:v,visible:this._activeDatum.includes(m),itemContent:{refX:0,type:"custom",renderCustomCallback:()=>u,autoRotate:!1,offsetX:d.x+d.width/2-v.x,offsetY:d.y+d.height/2-v.y},itemLine:{visible:_,type:"type-po",lineStyle:Tz(Object.assign({},null===(n=this._spec.leader)||void 0===n?void 0:n.style)),startSymbol:{visible:!1}}})}}_renderMarkers(){if(this._markerComponents&&this._markerComponents.length)for(let t=0;t<this._markerComponents.length;t++)this.getContainer().add(this._markerComponents[t])}_layoutLabels(t){return"outer"===this._spec.position&&this._map?function(t,e,i){var r;let{x1:n,x2:s,y1:a,y2:o}=(r=t.map(t=>t.pointCoord),c=1/0,p=1/0,g=-Infinity,f=-Infinity,r.forEach(t=>{c>t.x&&(c=t.x),g<t.x&&(g=t.x),p>t.y&&(p=t.y),f<t.y&&(f=t.y)}),{x1:c,y1:p,x2:g,y2:f}),l=i([(n+s)/2,(a+o)/2]);return l?Wm(t.map(t=>{let r;let n=t.rect,s=W_(e,t.pointCoord)?i(function(t,e,i,r=200){let n=5621/r,s=e;for(let e=1;e<=n;e++){let e=function(t,e,i,r={}){let n=ik(t[0]),s=ik(t[1]),a=ik(i),o=function(t,e){void 0===e&&(e="kilometers");var i=gi[e];if(!i)throw Error(e+" units is invalid");return t/i}(e,r.units),l=Math.asin(Math.sin(s)*Math.cos(o)+Math.cos(s)*Math.sin(o)*Math.cos(a));return{x:iA(n+Math.atan2(Math.sin(a)*Math.sin(o)*Math.cos(s),Math.cos(o)-Math.sin(s)*Math.sin(l))),y:iA(l)}}(s,r,i);if(!W_(t,e))return[e.x,e.y];s=[e.x,e.y]}return e}(e,[t.pointCoord.x,t.pointCoord.y],Wv(Wy(t.point,l)))):t.point;s&&(n.x=s.x,n.y=s.y);let a=Wv(Wy(t.point,l)),o=[];return a>=-45&&a<45?(r="top",o.push("left","right")):a>=45&&a<135?r="right":a>=-135&&a<-45?(r="left",o.push("left")):(r="bottom",o.push("left","right")),t.anchors=o,t.offset=20,t.rect=Wb(t.rect,r,0),t})):[]}(t,this._map,t=>this._series.dataToPosition({[this._longitudeField]:t[0],[this._latitudeField]:t[1]})):Wm(t)}_isRelativeModel(t){var e,i,r;let n=null!==(i=null===(e=this._series.getXAxisHelper())||void 0===e?void 0:e.getAxisId())&&void 0!==i?i:null===(r=this._series.getCoordinateHelper())||void 0===r?void 0:r.getCoordinateId();return(null==t?void 0:t.id)===n}_isRelativeSeries(t){return(null==t?void 0:t.id)===this._series.id}onRender(t){}changeRegions(){}_getNeedClearVRenderComponents(){return this._markerComponents}}Wx.type=lx.mapLabel,Wx.specKey="mapLabel";class WS{constructor(t,e){this._chartLayoutRect={x:0,y:0,width:1,height:1},this._col=1,this._row=1,this._elementMap=new Map,this.standardizationSpec(t),this._gridInfo=t,this._col=t.col,this._row=t.row,this._colSize=Array(this._col).fill(null),this._rowSize=Array(this._row).fill(null),this._colElements=Array(this._col).fill([]),this._rowElements=Array(this._row).fill([]),this._onError=null==e?void 0:e.onError,this.initUserSetting()}standardizationSpec(t){var e,i,r;t.col=null!==(e=t.col)&&void 0!==e?e:1,t.row=null!==(i=t.row)&&void 0!==i?i:1,t.elements=null!==(r=t.elements)&&void 0!==r?r:[]}initUserSetting(){this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach((t,e)=>{t||(this._colSize[e]={value:0,isUserSetting:!1,isLayoutSetting:!1})}),this._rowSize.forEach((t,e)=>{t||(this._rowSize[e]={value:0,isUserSetting:!1,isLayoutSetting:!1})})}setSizeFromUserSetting(t,e,i,r){t.forEach(t=>{t.index<0&&t.index>=i||(l1(t.size)?e[t.index]={value:+t.size,isUserSetting:!0,isLayoutSetting:!1}:nx(t.size)&&(e[t.index]={value:t.size(r),isUserSetting:!0,isLayoutSetting:!1}))})}clearLayoutSize(){this._colSize.forEach(t=>{t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)}),this._rowSize.forEach(t=>{t.isLayoutSetting=!1,t.isUserSetting||(t.value=0)})}getItemGridInfo(t){var e;let i;let r=this._elementMap.get(t);return r?r:((i=null===(e=this._gridInfo.elements)||void 0===e?void 0:e.find(e=>{var i;if("modelId"in e&&eO(e.modelId)){if(eO(t.model.userId)&&t.model.userId===e.modelId)return!0}else if("modelKey"in e&&eO(e.modelKey)&&"modelIndex"in e&&eO(e.modelIndex)&&(null!==(i=t.model.specKey)&&void 0!==i?i:t.model.type)===e.modelKey&&t.model.getSpecIndex()===e.modelIndex)return!0;return!1}))||(i={col:0,colSpan:1,row:0,rowSpan:1}),this._elementMap.set(t,i),i)}getSizeFromGrid(t,e){var i;let r="col"===e?this._colSize:this._rowSize,n=0;for(let s=t[e];s<t[e]+(null!==(i=t[`${e}Span`])&&void 0!==i?i:1);s++)n+=r[s].value;return n}getSizeFromUser(t,e){var i,r;let n="col"===e?this._colSize:this._rowSize;if(!(null===(i=n[t[e]])||void 0===i?void 0:i.isUserSetting))return;let s=0;for(let i=t[e];i<t[e]+(null!==(r=t[`${e}Span`])&&void 0!==r?r:1);i++){if(!n[i].isUserSetting)return;s+=n[i].value}return s}setItemLayoutSizeToGrid(t,e){if(Wk(t)){if(!e.colSpan||!(e.colSpan>1))!this._colSize[e.col].isUserSetting&&(this._colSize[e.col].value=Math.max(this._colSize[e.col].value,t.getLayoutRect().width+t.layoutPaddingLeft+t.layoutPaddingRight),this._colSize[e.col].isLayoutSetting=!0)}else{if(e.rowSpan&&e.rowSpan>1||this._rowSize[e.row].isUserSetting)return;this._rowSize[e.row].value=Math.max(this._rowSize[e.row].value,t.getLayoutRect().height+t.layoutPaddingTop+t.layoutPaddingBottom),this._rowSize[e.row].isLayoutSetting=!0}}layoutGrid(t){let e="col"===t?this._colSize:this._rowSize,i="col"===t?this._chartLayoutRect.width:this._chartLayoutRect.height,r=[];e.forEach(t=>{t.isUserSetting||t.isLayoutSetting?i-=t.value:r.push(t)}),i<0&&console.warn(`layout content ${t} size bigger than chart`),r.forEach(t=>t.value=i/r.length)}getItemPosition(t){let e=this.getItemGridInfo(t),i={x:this._chartLayoutRect.x,y:this._chartLayoutRect.y};for(let t=0;t<e.col;t++)i.x+=this._colSize[t].value;for(let t=0;t<e.row;t++)i.y+=this._rowSize[t].value;return i.x+=t.layoutPaddingLeft+t.layoutOffsetX,i.y+=t.layoutPaddingTop+t.layoutOffsetY,i}getItemLayoutRect(t){var e,i;let r=this.getItemGridInfo(t);return{width:(null!==(e=this.getSizeFromGrid(r,"col"))&&void 0!==e?e:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!==(i=this.getSizeFromGrid(r,"row"))&&void 0!==i?i:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom}}layoutItems(t,e,i,r){this._chartLayoutRect=i,this._chartViewBox=r,this.clearLayoutSize(),e.sort((t,e)=>e.layoutLevel-t.layoutLevel);let n=e.filter(t=>"normal"===t.layoutType&&!1!==t.getModelVisible()),s=n.filter(t=>Wk(t)),a=n.filter(t=>!Wk(t));n.forEach(t=>{this.layoutOneItem(t,"user",!1)});let o=e.filter(t=>"region-relative"===t.layoutType),l=o.filter(t=>Wk(t)),h=o.filter(t=>!Wk(t));l.forEach(t=>this.layoutOneItem(t,"user",!1)),this.layoutGrid("col"),a.forEach(t=>this.layoutOneItem(t,"colGrid",!1)),h.forEach(t=>{this.layoutOneItem(t,"colGrid",!1)}),this.layoutGrid("row"),h.forEach(t=>{this.layoutOneItem(t,"grid",!1)}),s.forEach(t=>this.layoutOneItem(t,"grid",!1)),l.forEach(t=>{this.layoutOneItem(t,"grid",!0)}),this.layoutGrid("col"),e.filter(t=>"region"===t.layoutType).forEach(t=>this.layoutOneItem(t,"grid",!1)),this.layoutAbsoluteItems(e.filter(t=>"absolute"===t.layoutType)),e.filter(t=>"absolute"!==t.layoutType).forEach(t=>{t.setLayoutStartPosition(this.getItemPosition(t))})}layoutAbsoluteItems(t){t.forEach(t=>{t.absoluteLayoutInRect(this._chartLayoutRect)})}layoutOneItem(t,e,i){var r,n;let s="rowGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),a="colGrid"===e||"grid"===e?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),o=this.getItemGridInfo(t),l={width:(null!==(r=a(o,"col"))&&void 0!==r?r:this._chartLayoutRect.width)-t.layoutPaddingLeft-t.layoutPaddingRight,height:(null!==(n=s(o,"row"))&&void 0!==n?n:this._chartLayoutRect.height)-t.layoutPaddingTop-t.layoutPaddingBottom},h=t.computeBoundsInRect(l);l1(h.width)||(h.width=l.width),l1(h.height)||(h.height=l.height),t.setLayoutRect("grid"!==e?h:l),this.setItemLayoutSizeToGrid(t,o)}}function Wk(t){return"left"===t.layoutOrient||"right"===t.layoutOrient}WS.type="grid";class WA extends b7{layoutItems(t,e,i,r){this._layoutInit(t,e,i,r),this._layoutNormalItems(e);let n={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},s=e.filter(t=>"absolute"===t.layoutType),a=s.filter(t=>"z"===t.layoutOrient),o={width:0,height:0};a.length&&(o=a[0].getLayoutRect()),this.leftCurrent+=o.width/8,this.rightCurrent-=o.width/8,this.topCurrent+=o.height/8,this.bottomCurrent-=o.height/8;let{regionItems:l,relativeItems:h,relativeOverlapItems:u,allRelatives:d,overlapItems:c}=this._groupItems(e);this.layoutRegionItems(l,h,u,c),this._processAutoIndent(l,h,u,c,d,n);let p=s.filter(t=>"z"!==t.layoutOrient);this.layoutAbsoluteItems(p);let g=h.filter(t=>"axes"===t.model.specKey&&dR(t.layoutOrient))[0],f=h.filter(t=>"axes"===t.model.specKey&&dB(t.layoutOrient))[0];if(g&&a.length){let t=g.getLayoutStartPoint(),e=g.getLayoutRect(),i={x:"left"===f.layoutOrient?t.x+e.width:t.x,y:t.y,width:this._chartLayoutRect.width,height:this._chartLayoutRect.height};a[0].model.directionStr="left"===f.layoutOrient?"r2l":"l2r";let r=g.getLayoutRect(),n=f.getLayoutRect(),s={length:a[0].getLayoutRect().width,width:r.width,height:n.height};g.model.setLayout3dBox&&g.model.setLayout3dBox(s),f.model.setLayout3dBox&&f.model.setLayout3dBox(s),a[0].model.setLayout3dBox&&a[0].model.setLayout3dBox(s),this.layoutZAxisItems(a,i)}}layoutZAxisItems(t,e){t.forEach(t=>{t.absoluteLayoutInRect(e)})}getItemComputeLayoutRect(t,e){return e||(e={offsetLeft:0,offsetRight:0,offsetTop:0,offsetBottom:0}),{width:this.rightCurrent-this.leftCurrent-t.layoutPaddingLeft-t.layoutPaddingRight-(e.offsetLeft+e.offsetRight),height:this.bottomCurrent-this.topCurrent-t.layoutPaddingTop-t.layoutPaddingBottom-(e.offsetTop+e.offsetBottom)}}_checkAutoIndent(t){let e={top:0,left:0,bottom:0,right:0},i=this._chartViewBox.x2-this._chartViewBox.x1-this.rightCurrent,r=this._chartViewBox.y2-this._chartViewBox.y1-this.bottomCurrent;return t.forEach(t=>{if(!t.getModelVisible()||!t.autoIndent)return;let n="left"===t.layoutOrient||"right"===t.layoutOrient,s=t.getLastComputeOutBounds();n?(e.top=Math.max(e.top,s.y1-this.topCurrent),e.bottom=Math.max(e.bottom,s.y2-r)):(e.left=Math.max(e.left,s.x1-this.leftCurrent),e.right=Math.max(e.right,s.x2-i))}),e}}WA.type="layout3d";var Ww=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)0>e.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i};let WM=new iI;v8(),yG(),_2(),bp();class WC extends Eu{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},WC.defaultAttributes,t)),this.name="poptip",this.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"]}render(){var t,e,i,r,n,s,a,o;let{titleStyle:l={},position:h,contentStyle:u={},panel:d={},space:c=4,minWidth:p=0,maxWidth:g=1/0,padding:f=4,maxWidthPercent:m,visible:v,state:y,dx:_=0,dy:b=0}=this.attribute,{title:x="",content:S=""}=this.attribute;x=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(x):x,S=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(S):S;let k=El(f),A=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group"),w=g-k[1]-k[3],M=eO(x)&&!1!==v,C=Object.assign(Object.assign({text:eM(x)?x:[x],visible:M,wrap:!0},l),{x:k[3],y:k[0],maxLineWidth:w,textAlign:"left",textBaseline:"top"}),T=A.createOrUpdateChild("poptip-title",C,"text");mk(null==y?void 0:y.title)||(T.states=y.title);let E=T.AABBBounds,O=E.height(),P=E.width(),R=O+c;M||(R=0);let B=eO(S)&&!1!==v,I=Object.assign(Object.assign({text:eM(S)?S:[S],visible:B,wrap:!0},u),{x:k[3],y:k[0]+R,maxLineWidth:w,textAlign:"left",textBaseline:"top"}),L=A.createOrUpdateChild("poptip-content",I,"text");mk(null==y?void 0:y.content)||(L.states=y.content);let D=L.AABBBounds,F=D.height(),j=D.width();B&&(R+=F);let N=ih(P+k[1]+k[3],j+k[1]+k[3]);N>g?N=g:N<p&&(N=p);let z=k[0]+k[2]+R,{visible:H}=d,V=Ww(d,["visible"]),W=null!==(t=V.size)&&void 0!==t?t:12,G=eM(W)?[W[0]+(null!==(e=V.space)&&void 0!==e?e:0),W[1]+(null!==(i=V.space)&&void 0!==i?i:0)]:W+(null!==(r=V.space)&&void 0!==r?r:0),U=null!==(n=V.lineWidth)&&void 0!==n?n:1,$=this.stage?[null!==(s=this.stage.viewWidth)&&void 0!==s?s:this.stage.width,null!==(a=this.stage.viewHeight)&&void 0!==a?a:this.stage.height]:void 0;if($){let t=this.AABBBounds,e=null!==(o=this.attribute.x)&&void 0!==o?o:t.x1,i=Math.max(e,$[0]-t.x1);if((i=Math.min(i-((eM(W)?W[0]:12)+3),i*m))<N){N=i;let t=k[1]+k[3];T.setAttribute("maxLineWidth",i-t),L.setAttribute("maxLineWidth",i-t),z=k[0]+k[2],M&&(z+=T.AABBBounds.height()+c),z+=L.AABBBounds.height()}}let Y="auto"===h,K,Z=-Infinity;for(let t=0;t<this.positionList.length+1;t++){let e=Y?this.positionList[t===this.positionList.length?K:t]:h,{angle:i,offset:r,rectOffset:n}=this.getAngleAndOffset(e,N,z,eM(G)?G:[G,G-U]);if(ew(H)){let t=(eM(W)?W[0]:W)/4,e=A.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},V),{visible:H&&(B||M),x:t,y:0,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:"arrow2Left",angle:i,dx:r[0],dy:r[1],size:W,zIndex:-9}),"symbol");mk(null==y?void 0:y.panel)||(e.states=y.panel);let n=A.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},V),{visible:H&&(B||M),x:0,y:0,width:N,height:z,zIndex:-8}),"rect");mk(null==y?void 0:y.panel)||(n.states=y.panel)}if(A.setAttributes({x:-r[0]+_,y:-r[1]+b}),!Y||!$)break;{WM.setValue(0,0,N,z).transformWithMatrix(A.globalTransMatrix);let e=(new iB).setValue(0,0,$[0],$[1]);if(function(t,e,i){if(!t||!e)return lW.NONE;let{x11:r,x12:n,y11:s,y12:a,x21:o,x22:l,y21:h,y22:u}=a5(t,e,i);return r>o&&n<l&&s>h&&a<u?lW.BBOX1:o>r&&l<n&&h>s&&u<a?lW.BBOX2:lW.NONE}(WM,e,!1))break;{let i=a3(WM,e,!1),r=(i.x2-i.x1)*(i.y2-i.y1);r>Z&&(Z=r,K=t)}}}}getAngleAndOffset(t,e,i,r){let n=r[1]/2;switch(t){case"tl":return{angle:ie/2*3,offset:[e/4,i+n],rectOffset:[-e/4,-i-r[1]]};case"top":return{angle:ie/2*3,offset:[e/2,i+n],rectOffset:[0,-i-r[1]]};case"tr":return{angle:ie/2*3,offset:[e/4*3,i+n],rectOffset:[e/4*3,-i-r[1]]};case"rt":return{angle:0,offset:[-n,i/5],rectOffset:[e/4*3,-i-r[1]]};case"right":return{angle:0,offset:[-n,i/2],rectOffset:[e/4*3,-i-r[1]]};case"rb":return{angle:0,offset:[-n,i/5*4],rectOffset:[e/4*3,-i-r[1]]};case"bl":return{angle:ie/2,offset:[e/4,-n],rectOffset:[-e/4,-i-r[1]]};case"bottom":return{angle:ie/2,offset:[e/2,-n],rectOffset:[0,-i-r[1]]};case"br":return{angle:ie/2,offset:[e/4*3,-n],rectOffset:[e/4*3,-i-r[1]]};case"lt":return{angle:ie,offset:[e+n,i/5],rectOffset:[-e/4,-i-r[1]]};case"left":return{angle:ie,offset:[e+n,i/2],rectOffset:[0,-i-r[1]]};case"lb":return{angle:ie,offset:[e+n,i/5*4],rectOffset:[e/4*3,-i-r[1]]}}}}WC.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},maxWidthPercent:.8,space:8,padding:10};let WT=class{render(t,e,i,r,n,s,a,o,l,h,u,d,c){var p,g,f;if(1===t._showPoptip){let{visible:e,visibleCb:i}=t.attribute.poptip||{};if(!1===e||i&&!1===i(t))return;let r={};eF(r,WC.defaultAttributes,t.attribute.poptip?t.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(r):this.poptipComponent=new WC(r);let n=t.attribute.poptip||{};if("text"===t.type&&null==n.title&&null==n.content){;let e={};g=e,f=n,eF(g,v4.poptip,f),(n=e).content=null!==(p=n.content)&&void 0!==p?p:t.attribute.text}let s=t.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1},n),{x:s.e,y:s.f})),h.stage.tryInitInteractiveLayer();let a=h.stage.getLayer("_builtin_interactive");a&&a.add(this.poptipComponent)}else 2===t._showPoptip&&(t._showPoptip=0,this.poptipComponent&&this.poptipComponent.setAttributes({visibleAll:!1}))}};WT=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}([eX()],WT);var WE=function(t,e,i,r){var n,s=arguments.length,a=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;o>=0;o--)(n=t[o])&&(a=(s<3?n(a):s>3?n(e,i,a):n(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a};let WO=class{constructor(){this.name="poptip",this.activeEvent="onRegister",this._uid=eV.GenAutoIncrementId(),this.key=this.name+this._uid,this.poptip=t=>{let e=t.target;if(e.isContainer||!e.attribute)return void this.unpoptip(t);if(e===this.activeGraphic)return;let{poptip:i}=e.attribute;i&&(e.setAttributes({}),e._showPoptip=1),this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2),this.setActiveGraphic(e,!0)},this.unpoptip=t=>{this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2,this.setActiveGraphic(null,!0))}}activate(t){this.pluginService=t;let{stage:e}=this.pluginService;e.addEventListener("pointerover",this.poptip)}setActiveGraphic(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}deactivate(t){let{stage:e}=this.pluginService;e.removeEventListener("pointerover",this.poptip)}};WO=WE([eX()],WO);let WP=class{constructor(){this.name="poptipForText",this.activeEvent="onRegister",this._uid=eV.GenAutoIncrementId(),this.key=this.name+this._uid,this.pointerlave=t=>{let{stage:e}=this.pluginService;t.target===e&&this.unpoptip(t)},this.poptip=t=>{let e=t.target;if("text"!==e.type||!e.cliped||e.isContainer||!e.attribute||e.attribute.disableAutoClipedPoptip)return void this.unpoptip(t);if(e===this.activeGraphic)return;let{poptip:i={}}=e.attribute;i&&(e.setAttributes({}),e._showPoptip=1),this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2),this.setActiveGraphic(e,!0)},this.unpoptip=t=>{this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2,this.setActiveGraphic(null,!0))}}activate(t){this.pluginService=t;let{stage:e}=this.pluginService;e.addEventListener("pointerover",this.poptip),e.addEventListener("pointerleave",this.pointerlave)}setActiveGraphic(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}deactivate(t){let{stage:e}=this.pluginService;e.removeEventListener("pointerover",this.poptip),e.removeEventListener("pointerleave",this.pointerlave)}};WP=WE([eX()],WP);let WR=new eW((t,e,i,r)=>{i(WT)||(t(WT).toSelf().inSingletonScope(),t(oG).toService(WT)),i(WO)||(t(WO).toSelf(),t(az).toService(WO)),i(WP)||(t(WP).toSelf(),t(az).toService(WP))}),WB=(t,e)=>t?(e||(e=t.getBoundingClientRect()),t.offsetWidth>0?e.width/t.offsetWidth:e.height/t.offsetHeight):1,WI=(t,e)=>{var i,r;let n,s;"rich"!==(null==t?void 0:t.type)&&"html"!==(null==t?void 0:t.type)?(t=(null!=t?t:"").toString(),s=(n=e.multiLine?(n=t.split("\n")).map((t,e)=>e<n.length-1?t+"\n":t):[t]).map(t=>Object.assign(Object.assign({},e),{text:t}))):(s=t.text,n=t);let a=(r={wordBreak:null!==(i=e.wordBreak)&&void 0!==i?i:"break-word",maxWidth:e.maxWidth?e.maxWidth:void 0,width:0,height:0,textConfig:s},d||(d=aj.CreateGraphic("richtext",{})),d.setAttributes(r),d.AABBBounds);return{width:a.width(),height:a.height(),text:n}},WL="vchart-tooltip-container",WD={offsetX:10,offsetY:10,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\(/g,"&#40;").replace(/  /g," &nbsp;")}},WF=(t,e)=>{let i;if(eO(t)){if(ey(t))i=t;else if(nx(t)){let r=t(e);ey(r)&&(i=r)}}return i},Wj={left:["left","center"],right:["right","center"],top:["center","top"],lt:["left","top"],tl:["left","top"],rt:["right","top"],tr:["right","top"],bottom:["center","bottom"],bl:["left","bottom"],lb:["left","bottom"],br:["right","bottom"],rb:["right","bottom"],inside:["center","center"],center:["center","center"],centerBottom:["center","centerBottom"],centerTop:["center","centerTop"],centerLeft:["centerLeft","center"],centerRight:["centerRight","center"]},WN=(t,e)=>{var i,r;return null!==(r=null===(i=Wj[t])||void 0===i?void 0:i[0])&&void 0!==r?r:e},Wz=(t,e)=>{var i,r;return null!==(r=null===(i=Wj[t])||void 0===i?void 0:i[1])&&void 0!==r?r:e},WH=(t,e,i)=>{let r=new Map,n=new Map;t.forEach(({axis:t,value:e})=>{["top","bottom"].includes(t.getOrient())?r.set(t.getSpecIndex(),{value:e,axis:t}):n.set(t.getSpecIndex(),{value:e,axis:t})});let s={visible:!!r.size,type:"rect"},a={visible:!!n.size,type:"rect"},{x:o,y:l,offsetWidth:h,offsetHeight:u,bandWidth:d,bandHeight:c}=zg(3,e,i,r,n,s,a);return o?zv(s,o,d,h):l?zy(a,l,c,u):void 0},WV=t=>nb(t)&&(eO(t.left)||eO(t.right)||eO(t.top)||eO(t.bottom)),WW=t=>nb(t)&&(eO(t.x)||eO(t.y)),WG={fontFamily:uB.fontFamily,spacing:10,wordBreak:"break-word"};function WU(t={},e,i){var r,n;return Object.assign(Object.assign({},null!=i?i:WG),{fill:null!==(r=t.fill)&&void 0!==r?r:t.fontColor,textAlign:t.textAlign,textBaseline:t.textBaseline,fontFamily:null!==(n=t.fontFamily)&&void 0!==n?n:null==e?void 0:e.fontFamily,fontSize:t.fontSize,fontWeight:t.fontWeight,lineHeight:t.lineHeight,spacing:t.spacing,multiLine:t.multiLine,maxWidth:t.maxWidth,wordBreak:t.wordBreak,autoWidth:t.autoWidth})}let W$=t=>{var e;let{backgroundColor:i,border:r,shadow:n}=t,s={lineWidth:null!==(e=null==r?void 0:r.width)&&void 0!==e?e:0,shadow:!!n};(null==r?void 0:r.color)&&(s.stroke=r.color),i&&(s.fill=i),n&&(s.shadowColor=n.color,s.shadowBlur=n.blur,s.shadowOffsetX=n.x,s.shadowOffsetY=n.y,s.shadowSpread=n.spread);let{radius:a}=null!=r?r:{};return eO(a)&&(s.cornerRadius=[a,a,a,a]),s},WY=(t,e,i)=>{var r,n,s,a,o;let{style:l={},enterable:h,transitionDuration:u}=e,{panel:d={},titleLabel:c,shape:p,keyLabel:g,valueLabel:f,spaceRow:m,maxContentHeight:v,align:y}=l,_=El(d.padding),b=hi(d.padding),x=WU(Object.assign({textAlign:"right"===y?"right":"left"},c),i),S=WU(Object.assign({textAlign:"right"===y?"right":"left"},g),i),k=WU(f,i),A={fill:!0,size:null!==(r=null==p?void 0:p.size)&&void 0!==r?r:8,spacing:null!==(n=null==p?void 0:p.spacing)&&void 0!==n?n:6},w={panel:W$(d),padding:_,title:{},content:[],titleStyle:{value:x,spaceRow:m},contentStyle:{shape:A,key:S,value:k,spaceRow:m},hasContentShape:!1,keyWidth:0,valueWidth:0,maxContentHeight:v,enterable:h,transitionDuration:u,align:y},{title:M={},content:C=[]}=t,T=b.left+b.right,E=b.top+b.bottom,O=b.top+b.bottom,P=0,R=C.filter(t=>(t.key||t.value)&&!1!==t.visible),B=!!R.length,I=0,L=0,D=0,F=0;if(B){let t=[],e=[],i=[],r=[],n=0;w.content=R.map((s,a)=>{let o=0,{hasShape:l,key:h,shapeType:u="",shapeFill:d,shapeStroke:c,shapeLineWidth:p,shapeSize:g,value:f,isKeyAdaptive:v,spaceRow:y,keyStyle:_,valueStyle:b,shapeHollow:x,shapeColor:w}=s,M={height:0,spaceRow:null!=y?y:m};if(eO(h)){let i=us({},S,WU(_,void 0,{})),{width:r,height:n,text:s}=WI(h,i);M.key=Object.assign(Object.assign({width:r,height:n},i),{text:s}),v?e.push(r):t.push(r),o=Math.max(o,n)}if(eO(f)){let t=us({},k,WU(b,void 0,{})),{width:e,height:r,text:n}=WI(f,t);M.value=Object.assign(Object.assign({width:e,height:r},t),{text:n}),i.push(e),o=Math.max(o,r)}if(l){let t={visible:!0,symbolType:u},e=null!=d?d:w;x?t.stroke=e:t.fill=e,t.stroke=null!=c?c:e,t.lineWidth=p,M.shape=t;let i=null!=g?g:A.size;o=Math.max(i,o),r.push(i)}else M.shape={visible:!1};return M.height=o,n+=o,a<R.length-1&&(n+=M.spaceRow),M}),E+=n,O+=Math.min(n,null!=v?v:1/0),I=t.length?oy(t):0,L=e.length?oy(e):0,D=i.length?oy(i):0,P=Math.max((F=r.length?oy(r)+A.spacing:0)+I+S.spacing+D+k.spacing,F+L,P),w.hasContentShape=!!r.length,w.keyWidth=I,w.valueWidth=D}let j=0,N=0,z=0,{visible:H=!0,value:V="",valueStyle:W,spaceRow:G}=M;w.title.visible=H,w.title.spaceRow=null!=G?G:m;let U={};if(H){(U=us({},x,WU(W,void 0,{}))).autoWidth&&!1!==U.multiLine&&(U.multiLine=null===(s=U.multiLine)||void 0===s||s,U.maxWidth=null!==(a=U.maxWidth)&&void 0!==a?a:B?Math.ceil(P):void 0);let{text:t,width:e,height:i}=WI(V,U);w.title.value=Object.assign(Object.assign({width:U.autoWidth&&!1!==U.multiLine?Math.min(e,null!==(o=U.maxWidth)&&void 0!==o?o:Number.MAX_VALUE):e,height:i},U),{text:t}),j=w.title.value.width,z=(N=w.title.value.height)+(B?w.title.spaceRow:0)}return E+=z,O+=z,w.title.width=j,w.title.height=N,U.autoWidth&&!1!==U.multiLine?T+=P||j:T+=Math.max(j,P),B&&w.content.forEach(t=>{var e;let i=t.value;i&&(null===(e=i.autoWidth)||void 0===e||e)&&(i.width=T-b.left-b.right-F-I-S.spacing-k.spacing,i.maxWidth||(i.maxWidth=Math.ceil(i.width)),w.valueWidth=Math.max(w.valueWidth,i.width))}),w.panel.width=T,w.panel.height=E,w.panelDomHeight=O,w};class WK extends TL{constructor(){super(...arguments),this._visible=!0,this._attributes=null,this._isReleased=!1,this.showTooltip=(t,e,i)=>{let{changePositionOnly:r}=i;return r?this.changeTooltipPosition(i,e):this.changeTooltip(!0,i,e)},this._changeTooltip=(t,e,i)=>this._isReleased?1:t?this._changeTooltipPosition(e,i):(this._clearAllCache(),this._updateTooltip(!1,e),0),this._changeTooltipPosition=(t,e)=>{var i,r,n;if(this._isReleased)return 1;let s=t.event,{tooltipSpec:a,tooltipActual:o,changePositionOnly:l}=t;if(a.enterable){if(!this._isPointerEscaped&&this._isPointerMovingToTooltip(t))return this._isTooltipPaused||(this._isTooltipPaused=!0,this._cachePointerTimer=setTimeout(()=>{this._isPointerEscaped=!0},300)),0;this._isTooltipPaused=!1,this._isPointerEscaped=!1,clearTimeout(this._cachePointerTimer),this._cachePointerPosition=this._getPointerPositionRelativeToTooltipParent(t)}let h=o.activeType;if(a.handler)return null!==(n=null===(r=(i=a.handler).showTooltip)||void 0===r?void 0:r.call(i,h,e,t))&&void 0!==n?n:0;let u=a[h];if(!u)return 1;let d=this._getActualTooltipPosition(o,t,this._getTooltipBoxSize(o,l));o.position=d,u.updatePosition&&(o.position=u.updatePosition(o.position,e,t));let c=!1!==(null==u?void 0:u.visible);return e&&"pointerout"!==s.type&&o.visible&&(o.title||o.content)||(c=!1),this._updateTooltip(c,Object.assign(Object.assign({},t),{changePositionOnly:l})),0},this._getActualTooltipPosition=(t,e,i)=>{var r,n,s,a,o,l,h;let u,d;let c=e.event,{tooltipSpec:p}=e,g=null===(r=e.dimensionInfo)||void 0===r?void 0:r[0],f={x:1/0,y:1/0},{offsetX:m,offsetY:v}=this._option;if(!p)return this._cacheTooltipPosition=void 0,f;let{activeType:y,data:_}=t,b=p[y],x=N3(b.position,_,e),S=null!==(n=N3(b.positionMode,_,e))&&void 0!==n?n:"mark"===y?"mark":"pointer",k=this._getParentElement(p),{width:A=0,height:w=0}=null!=i?i:{},M="canvas"===p.renderMode,C=null===(s=null==e?void 0:e.chart)||void 0===s?void 0:s.getCanvasRect(),T=null!==(a=null==C?void 0:C.width)&&void 0!==a?a:500,E=null!==(o=null==C?void 0:C.height)&&void 0!==o?o:500,O=!1,P={width:0,height:0},R={x:0,y:0},B={x:0,y:0},I=1,L=1;if(hl(this._env)&&!p.confine){if(P.width=window.innerWidth,P.height=window.innerHeight,!M){B=null!==(l=null==k?void 0:k.getBoundingClientRect())&&void 0!==l?l:f;let t=null!==(h=this._compiler.getCanvas())&&void 0!==h?h:this._chartContainer,e=null==t?void 0:t.getBoundingClientRect();R={x:e.x-B.x,y:e.y-B.y},I=WB(t,e),L=WB(k,B)}}else P.width=T,P.height=E;let D=L/I,F,j,N,z,H=x,V=x,W=({orient:t,mode:i,offset:r})=>{var n;let s,a;let o=e.model,l=null==o?void 0:o.getLayoutStartPoint();if(m=null!=r?r:m,"mark"===i){O=!0;let t=e.item,i=null==t?void 0:t.getBounds();i&&l&&(s=i.x1+l.x,a=i.x2+l.x)}else if("crosshair"===i&&"cartesian"===(null===(n=null==g?void 0:g.axis)||void 0===n?void 0:n.getCoordinateType())){O=!0;let t=WH(e.dimensionInfo,dE(this._component.getRegions(),"cartesian"),l);t&&(s=t.start.x,a=t.end.x)}else H=t;if(O)switch(WN(t)){case"left":F=s-A*D-m;break;case"right":F=a+m;break;case"center":F=(s+a)/2-A*D/2;break;case"centerLeft":F=(s+a)/2-A*D-m;break;case"centerRight":F=(s+a)/2+m}},G=({orient:t,mode:i,offset:r})=>{var n;let s,a;let o=e.model,l=null==o?void 0:o.getLayoutStartPoint();if(v=null!=r?r:v,"mark"===i){O=!0;let t=e.item,i=null==t?void 0:t.getBounds();i&&l&&(s=i.y1+l.y,a=i.y2+l.y)}else if("crosshair"===i&&"cartesian"===(null===(n=null==g?void 0:g.axis)||void 0===n?void 0:n.getCoordinateType())){O=!0;let t=WH(e.dimensionInfo,dE(this._component.getRegions(),"cartesian"),l);t&&(s=t.start.y,a=t.end.y)}else V=t;if(O)switch(Wz(t)){case"top":j=s-w*D-v;break;case"bottom":j=a+v;break;case"center":j=(s+a)/2-w*D/2;break;case"centerTop":j=(s+a)/2-w*D-v;break;case"centerBottom":j=(s+a)/2+v}};if(nb(x)){if(WV(x)){let{left:t,right:e,top:i,bottom:r}=x;F=WF(t,c),j=WF(i,c),N=WF(e,c),z=WF(r,c)}else if(WW(x)){let{x:t,y:e}=x;ey(t)||nx(t)?F=WF(t,c):W(t),ey(e)||nx(e)?j=WF(e,c):G(e)}}else eO(x)&&(W({orient:x,mode:S}),G({orient:x,mode:S}));let{canvasX:U,canvasY:$}=c;if(l1(F))u=F;else if(l1(N))u=T-A*D-N;else switch(WN(H,"right")){case"center":u=U-A*D/2;break;case"left":case"centerLeft":u=U-A*D-m;break;case"right":case"centerRight":u=U+m}if(l1(j))d=j;else if(l1(z))d=E-w*D-z;else switch(Wz(V,"bottom")){case"center":d=$-w*D/2;break;case"top":case"centerTop":d=$-w*D-v;break;case"bottom":case"centerBottom":d=$+v}u*=I,d*=I,hl(this._env)&&(u+=R.x,d+=R.y),u/=L,d/=L;let{width:Y,height:K}=P,Z=()=>u*L+B.x<0,X=()=>(u+A)*L+B.x>Y,q=()=>d*L+B.y<0,J=()=>(d+w)*L+B.y>K,Q=()=>{Z()&&(O?u=-B.x/L:"center"===WN(x,"right")?u+=m+A/2:u+=2*m+A)},tt=()=>{Z()&&(u=-B.x/L)},te=()=>{X()&&(O?u=(Y-B.x)/L-A:"center"===WN(x,"right")?u-=m+A/2:u-=2*m+A)},ti=()=>{X()&&(u=(Y-B.x)/L-A)},tr=()=>{q()&&(O?d=-B.y/L:"center"===Wz(x,"bottom")?d+=v+w/2:d+=2*v+w)},tn=()=>{q()&&(d=0-B.y/L)},ts=()=>{J()&&(O?d=(K-B.y)/L-w:"center"===Wz(x,"bottom")?d-=v+w/2:d-=2*v+w)},ta=()=>{J()&&(d=(K-B.y)/L-w)};switch(WN(x,"right")){case"center":case"centerLeft":case"centerRight":Z()?(Q(),ti()):(te(),tt());break;case"left":Q(),ti();break;case"right":te(),tt()}switch(Wz(x,"bottom")){case"center":case"centerTop":case"centerBottom":q()?(tr(),ta()):(ts(),tn());break;case"top":tr(),ta();break;case"bottom":ts(),tn()}let to={x:u,y:d};return this._cacheTooltipPosition=to,this._cacheTooltipSize={width:A,height:w},to}}get env(){return this._env}onAdd(t){super.onAdd(t);let e=t.component;this._component=e,this._chartOption=e.getOption(),this._env=this._chartOption.mode,this._chartContainer=this._chartOption.globalInstance.getContainer(),this._compiler=e.getCompiler(),this._initFromSpec()}hideTooltip(t){return this.changeTooltip(!1,t)}release(){var t,e,i;this._clearAllCache();let r=null!==(t=this._component.getSpec())&&void 0!==t?t:{};r.handler?null===(i=(e=r.handler).release)||void 0===i||i.call(e):(this._removeTooltip(),this._isReleased=!0)}_clearAllCache(){this._isTooltipPaused=!1,this._isPointerEscaped=!1,clearTimeout(this._cachePointerTimer),this._cachePointerTimer=-1,this._cachePointerPosition=void 0,this._cacheTooltipPosition=void 0,this._cacheTooltipSize=void 0}_throttle(t){let e=this._component.getSpec();return dJ(t,ey(e.throttleInterval)?e.throttleInterval:"html"===e.renderMode&&e.transitionDuration?50:10)}_getDefaultOption(){var t,e;let{offset:i}=this._component.getSpec();return Object.assign(Object.assign({},WD),{offsetX:null!==(t=null==i?void 0:i.x)&&void 0!==t?t:WD.offsetX,offsetY:null!==(e=null==i?void 0:i.y)&&void 0!==e?e:WD.offsetY})}_getTooltipBoxSize(t,e){var i,r,n;if(!e||ej(this._attributes)){let e=null!==(r=null===(i=this._chartOption)||void 0===i?void 0:i.getTheme())&&void 0!==r?r:{};this._attributes=WY(t,this._component.getSpec(),e)}let{panel:s,panelDomHeight:a}=null!==(n=this._attributes)&&void 0!==n?n:{},o="canvas"===this._component.getSpec().renderMode;return{width:(null==s?void 0:s.width)+(o?s.lineWidth:0),height:(null!=a?a:null==s?void 0:s.height)+(o?s.lineWidth:0)}}_getPointerPositionRelativeToTooltipParent(t){var e,i;let{canvasX:r,canvasY:n}=t.event,{tooltipSpec:s}=t,a="canvas"===s.renderMode,o=this._getParentElement(s),l={x:0,y:0},h={x:0,y:0},u=1,d=1;if(hl(this._env)&&!s.confine&&!a){h=null!==(e=null==o?void 0:o.getBoundingClientRect())&&void 0!==e?e:{x:1/0,y:1/0};let t=null!==(i=this._compiler.getCanvas())&&void 0!==i?i:this._chartContainer,r=null==t?void 0:t.getBoundingClientRect();l={x:r.x-h.x,y:r.y-h.y},u=WB(t,r),d=WB(o,h)}return r*=u,n*=u,hl(this._env)&&(r+=l.x,n+=l.y),{x:r/=d,y:n/=d}}_isPointerMovingToTooltip(t){if(!this._cacheTooltipPosition||!this._cacheTooltipSize||!this._cachePointerPosition)return!1;let{width:e,height:i}=this._cacheTooltipSize,{x:r=0,y:n}=this._cacheTooltipPosition,s=this._getPointerPositionRelativeToTooltipParent(t);if(a8(s,{x1:r,y1:n,x2:r+e,y2:n+i},!1))return!0;let a={x:r,y:n},o={x:a.x+e,y:a.y},l={x:a.x,y:a.y+i},h={x:o.x,y:l.y},u=this._cachePointerPosition;return Wa([u,a,o],s.x,s.y)||Wa([u,l,h],s.x,s.y)||Wa([u,a,h],s.x,s.y)||Wa([u,o,l],s.x,s.y)}_getParentElement(t){return t.parentElement}getTooltipContainer(){return this._container}_initFromSpec(){this._option=this._getDefaultOption(),this.changeTooltip=this._throttle(this._changeTooltip),this.changeTooltipPosition=this._throttle(this._changeTooltipPosition)}reInit(){this._initFromSpec()}}WK.specKey="tooltip";let WZ=(t,e)=>eO(t)?eM(t)?t.map(t=>`${t}px`).join(" "):`${t}px`:null!=e?e:"initial",WX=t=>{let e=t.split(" ").map(t=>Number.isNaN(t)?Number.parseFloat(t.substring(0,t.length-2)):Number.parseFloat(t));return 1===e.length?e[0]:e},Wq=(t=document.body)=>{if(ej(m)){let e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",t.appendChild(e);let i=document.createElement("div");e.appendChild(i),m=e.offsetWidth-i.offsetWidth,e.parentNode.removeChild(e)}return m};function WJ(t,e){if(!t)return;let{fontFamily:i,fontSize:r,fill:n,textAlign:s,lineHeight:a,fontWeight:o,multiLine:l,wordBreak:h,maxWidth:u}=us({},e,t),d={};return d.fontFamily=i,d.fontSize=WZ(r),d.color=n,d.textAlign=s,d.lineHeight=WZ(sm(a,r)),d.fontWeight=o,d.whiteSpace=l?"initial":"nowrap",d.wordBreak=l?null!=h?h:"break-word":"normal",d.maxWidth=WZ(u),d}class WQ{static isInstance(t){return!!t&&t.type===WQ.type}setOption(t){this._option=t,Object.values(this.children).forEach(e=>e.setOption(t))}getParentEl(){return WQ.isInstance(this.parent)?this.parent.product:this.parent}constructor(t,e,i){this.type=WQ.type,this._renderContentCache=null,this.children={},this.parent=t,this._option=e,this.childIndex=null!=i?i:0}init(t,e){}initAll(){this.init(),Object.values(this.children).forEach(t=>t.initAll())}setStyle(t){this.product&&t&&Object.keys(t).forEach(e=>{this.product.style[e]!==t[e]&&(this.product.style[e]=t[e])})}setContent(t){}setVisibility(t){if(!this.product)return;let{style:e}=this.product;e.visibility=t?"visible":"hidden",Object.values(this.children).forEach(e=>e.setVisibility(t))}getVisibility(){var t,e;return!!(null===(e=null===(t=this.product)||void 0===t?void 0:t.style)||void 0===e?void 0:e.visibility)&&"hidden"!==this.product.style.visibility}release(){var t;if(Object.values(this.children).forEach(t=>t.release()),this.children={},this.product){try{null===(t=this.getParentEl())||void 0===t||t.removeChild(this.product)}catch(t){}this.product=null}}createElement(t,e,i,r){let n=null==ho?void 0:ho.createElement(t),s=this.getParentEl();if(!n||!s)return;e&&n.classList.add(...e),i&&Object.keys(i).forEach(t=>{n.style[t]=i[t]}),r&&(n.id=r);let a=this.childIndex;if(WQ.isInstance(this.parent)){let t=Number.MAX_VALUE;for(let e=0;e<s.children.length;e++){let i=Object.values(this.parent.children).find(t=>t.product===s.children[e]);i.childIndex>this.childIndex&&i.childIndex<t&&(t=i.childIndex,a=e)}}return a>=s.children.length?s.appendChild(n):s.insertBefore(n,s.children[a]),n}}WQ.type="tooltipModel";let W0={fontSize:"13px",marginBottom:"0px",fontWeight:"normal"},W1={boxSizing:"border-box"},W2={display:"inline-block",verticalAlign:"top"},W3={paddingTop:"0px",paddingBottom:"0px",textAlign:"left",fontWeight:"normal"},W5={paddingTop:"0px",paddingBottom:"0px",textAlign:"left",fontWeight:"normal"},W4={paddingTop:"0px",paddingBottom:"0px",textAlign:"right",fontWeight:"normal"},W8={lineHeight:"normal",boxSizing:"border-box"};class W6 extends WQ{init(t,e,i){if(!this.product){let r=this.createElement(null!=i?i:"div",[...null!=t?t:[],"shape"],void 0,e);this.product=r}}setStyle(t,e){super.setStyle(t),this.setSvg(e)}setContent(t){this.setSvg(t)}setSvg(t){let e=function(t,e){var i,r,n,s,a,o;if(!(null==t?void 0:t.hasShape)||!t.symbolType)return"";let{symbolType:l,fill:h,stroke:u,hollow:d=!1}=t,c=t.size?e(t.size):"8px",p=t.lineWidth?e(t.lineWidth)+"px":"0px",g="currentColor",f=()=>u?e(u):g,m=WX(c),v=t=>new _W({symbolType:t,size:m,fill:!0}),y=v(l),_=y.getParsedPath();_.path||(y=v(_.pathStr));let b=y.getParsedPath().path,x=b.toString(),S=b.bounds,k=`${S.x1} ${S.y1} ${S.width()} ${S.height()}`;if("0px"!==p){let[t,e,i,r]=k.split(" ").map(t=>Number(t)),n=Number(p.slice(0,-2));k=`${t-n/2} ${e-n/2} ${i+n} ${r+n}`}if(!h||eE(h)||d)return g=d?"none":h?e(h):"currentColor",`
    <svg width="${c}" height="${c}" viewBox="${k}"
      style="display: block;">
      <path
        d="${x}"
        style="fill: ${g}; stroke: ${f()}; stroke-width: ${p}"
      >
      </path>
    </svg>`;if(nb(h)){g=(i="gradientColor"+t.index,i);let l="",u=(null!==(r=h.stops)&&void 0!==r?r:[]).map(t=>`<stop offset="${e(t.offset.toString())}" stop-color="${e(t.color)}"/>`).join("");return"radial"===h.gradient?l=`<radialGradient id="${g}" cx="50%" cy="50%" r="50%" fx="0%" fy="0%">
      ${u}
      </radialGradient>`:"linear"===h.gradient&&(l=`<linearGradient id="${g}" x1="${100*(null!==(n=h.x0)&&void 0!==n?n:0)}%" y1="${100*(null!==(s=h.y0)&&void 0!==s?s:0)}%" x2="${100*(null!==(a=h.x1)&&void 0!==a?a:0)}%" y2="${100*(null!==(o=h.y1)&&void 0!==o?o:0)}%">
      ${u}
      </linearGradient>`),`
    <svg width="${c}" height="${c}" viewBox="-0.5 -0.5 1 1"
      style="display: block;">
      ${l}
      <path
        d="${x}"
        style="fill: url(#${g}); stroke: ${f()}; stroke-width: ${p}"
      >
      </path>
    </svg>`}return""}(t,this._option.valueToHtml);this.product&&e!==this._svgHtmlCache&&(this._svgHtmlCache=e,this.product.innerHTML=e)}release(){super.release(),this._svgHtmlCache=""}}class W9 extends WQ{init(t,e,i){this.product||(this.product=this.createElement(null!=i?i:"span",t,void 0,e))}setContent(t,e){if(!this.product)return;let i=this._option.valueToHtml(t);e&&(i=i.replaceAll("\n","<br>")),i!==this.product.innerHTML&&(this.product.innerHTML=i)}}let W7={overflowWrap:"normal",wordWrap:"normal"};class Gt extends WQ{constructor(t,e,i,r){super(t,e,r),this.className=i}init(){var t,e;this.product||(this.product=this.createElement("div",[this.className]));let i=null!==(e=null===(t=this._option.getTooltipActual())||void 0===t?void 0:t.content)&&void 0!==e?e:[];if("shape-box"!==this.className||i.some(t=>t.hasShape&&t.shapeType)){Object.keys(this.children).forEach(t=>{let e=dy(t);e>=i.length&&(this.children[e].release(),delete this.children[e])});for(let t=0;t<i.length;t++)if(!this.children[t]){if("key-box"===this.className||"value-box"===this.className){let e=new W9(this.product,this._option,t);e.init([this.className.substring(0,this.className.indexOf("-"))],void 0,"div"),this.children[t]=e}else if("shape-box"===this.className){let e=new W6(this.product,this._option,t);e.init(["shape"],void 0,"div"),this.children[t]=e}}}else Object.keys(this.children).forEach(t=>{let e=dy(t);this.children[e].release(),delete this.children[e]})}setStyle(){var t,e,i,r;let n=this._option.getTooltipStyle();super.setStyle(us({},W2,n.content,this._getContentColumnStyle()));let s=null!==(e=null===(t=this._option.getTooltipActual())||void 0===t?void 0:t.content)&&void 0!==e?e:[],a=null!==(r=null===(i=this._option.getTooltipAttributes())||void 0===i?void 0:i.content)&&void 0!==r?r:[],o=(t,e)=>{var i,r;let{key:s,isKeyAdaptive:o}=t,{height:l}=a[e],{keyColumn:h}=n,u=us({},o?W5:W3,Object.assign(Object.assign(Object.assign({height:WZ(l)},W7),h.common),null===(i=h.items)||void 0===i?void 0:i[e]));return eE(s)&&""!==(null===(r=null==s?void 0:s.trim)||void 0===r?void 0:r.call(s))||ey(s)||u.visibility?u.visibility="visible":u.visibility="hidden",u};s.forEach((t,e)=>{var i;"key-box"===this.className?this.children[e].setStyle(o(t,e)):"value-box"===this.className?this.children[e].setStyle(((t,e)=>{var i;let{height:r}=a[e],{valueColumn:s}=n;return us({},W4,Object.assign(Object.assign(Object.assign({height:WZ(r)},W7),s.common),null===(i=s.items)||void 0===i?void 0:i[e]))})(0,e)):"shape-box"===this.className&&(null===(i=this.children[e])||void 0===i||i.setStyle(((t,e)=>{var i,r,s,l;let{height:h}=a[e],{shapeColumn:u}=n,d=o(t,e),c=`calc((${null!==(r=null!==(i=d.lineHeight)&&void 0!==i?i:d.fontSize)&&void 0!==r?r:"18px"} - ${null!==(s=u.width)&&void 0!==s?s:"8px"}) / 2)`;return us({},W8,Object.assign(Object.assign({height:WZ(h),paddingTop:c},u.common),null===(l=u.items)||void 0===l?void 0:l[e]))})(t,e),this._getShapeSvgOption(t,e)))})}setContent(){var t,e,i,r;let n=null!==(e=null===(t=this._option.getTooltipActual())||void 0===t?void 0:t.content)&&void 0!==e?e:[],s=null!==(r=null===(i=this._option.getTooltipAttributes())||void 0===i?void 0:i.content)&&void 0!==r?r:[];n.forEach((t,e)=>{var i,r,n,a,o,l,h;let u;if("key-box"===this.className){let a=t.key;u=eE(a)&&""!==(null===(i=null==a?void 0:a.trim)||void 0===i?void 0:i.call(a))||ey(a)?a:"",null===(r=this.children[e])||void 0===r||r.setContent(u,null===(n=s[e].key)||void 0===n?void 0:n.multiLine)}else if("value-box"===this.className){let i=t.value;u=eE(i)&&""!==(null===(a=null==i?void 0:i.trim)||void 0===a?void 0:a.call(i))||ey(i)?i:"",null===(o=this.children[e])||void 0===o||o.setContent(u,null===(l=s[e].value)||void 0===l?void 0:l.multiLine)}else"shape-box"===this.className&&(u=this._getShapeSvgOption(t,e),null===(h=this.children[e])||void 0===h||h.setContent(u))})}_getContentColumnStyle(){var t,e;let i=this._option.getTooltipStyle();switch(this.className){case"shape-box":let r=null!==(e=null===(t=this._option.getTooltipActual())||void 0===t?void 0:t.content)&&void 0!==e?e:[];return Object.assign(Object.assign({},i.shapeColumn),"shape-box"!==this.className||r.some(t=>t.hasShape&&t.shapeType)?{}:{display:"none"});case"key-box":return i.keyColumn;case"value-box":return i.valueColumn}}_getShapeSvgOption(t,e){var i,r;let n=this._option.getTooltipStyle(),s=Object.assign(Object.assign({},n.shapeColumn),null===(i=n.shapeColumn.items)||void 0===i?void 0:i[e]);return{hasShape:t.hasShape,symbolType:t.shapeType,size:s.width,fill:null!==(r=t.shapeFill)&&void 0!==r?r:t.shapeColor,stroke:t.shapeStroke,lineWidth:t.shapeLineWidth,hollow:t.shapeHollow,index:e}}}class Ge extends WQ{init(){this.product||(this.product=this.createElement("div",["container-box"]));let{align:t}=this._option.getTooltipAttributes();"right"===t?(this.valueBox||(this.valueBox=this._initBox("value-box",0)),this.keyBox||(this.keyBox=this._initBox("key-box",1)),this.shapeBox||(this.shapeBox=this._initBox("shape-box",2))):(this.shapeBox||(this.shapeBox=this._initBox("shape-box",0)),this.keyBox||(this.keyBox=this._initBox("key-box",1)),this.valueBox||(this.valueBox=this._initBox("value-box",2)))}_initBox(t,e){let i=new Gt(this.product,this._option,t,e);return i.init(),this.children[i.childIndex]=i,i}setStyle(t){super.setStyle(us(this._getContentContainerStyle(),t)),Object.values(this.children).forEach(t=>{t.setStyle()})}setContent(){Object.values(this.children).forEach(t=>{t.setContent()})}_getContentContainerStyle(){let t={whiteSpace:"nowrap",lineHeight:"0px"},{panelDomHeight:e,panel:i,maxContentHeight:r}=this._option.getTooltipAttributes();if(eO(r)&&e<i.height){let{shapeColumn:e={},keyColumn:i={},valueColumn:n={},panel:s={}}=this._option.getTooltipStyle(),a=[e.width,e.marginRight,i.width,i.marginRight,n.width,n.marginRight,s.paddingRight].reduce((t,e)=>t+WX(e),0);return Object.assign(Object.assign({},t),{width:`${a+Wq(this._option.getContainer())}px`,maxHeight:WZ(r),overflow:"auto"})}return t}release(){super.release(),this.shapeBox=null,this.keyBox=null,this.valueBox=null}}class Gi extends WQ{init(){let t=this._option.getTooltipActual();this.product||(this.product=this.createElement("h2"));let{align:e}=this._option.getTooltipAttributes();"right"!==e||this.textSpan||this._initTextSpan(0);let{title:i}=t;(null==i?void 0:i.hasShape)&&(null==i?void 0:i.shapeType)?this.shape||this._initShape("right"===e?1:0):this.shape&&this._releaseShape(),"right"===e||this.textSpan||this._initTextSpan(1)}_initShape(t=0){let e=new W6(this.product,this._option,t);e.init(),this.shape=e,this.children[e.childIndex]=e}_releaseShape(){this.shape&&(this.shape.release(),delete this.children[this.shape.childIndex],this.shape=null)}_initTextSpan(t=1){let e=new W9(this.product,this._option,t);e.init(),this.textSpan=e,this.children[e.childIndex]=e}setStyle(t){var e,i,r,n;let s=this._option.getTooltipStyle(),{title:a}=this._option.getTooltipActual();super.setStyle(us({},W0,s.title,t)),null===(e=this.shape)||void 0===e||e.setStyle({paddingRight:null===(i=s.shapeColumn.common)||void 0===i?void 0:i.marginRight},{hasShape:null==a?void 0:a.hasShape,symbolType:null==a?void 0:a.shapeType,size:null===(r=s.shapeColumn.common)||void 0===r?void 0:r.width,fill:null==a?void 0:a.shapeColor,hollow:null==a?void 0:a.shapeHollow}),null===(n=this.textSpan)||void 0===n||n.setStyle({color:"inherit"})}setContent(){var t,e,i,r,n,s;let a=this._option.getTooltipStyle(),o=this._option.getTooltipActual(),l=this._option.getTooltipAttributes(),{title:h}=o;this.init(),null===(t=this.shape)||void 0===t||t.setStyle(void 0,{hasShape:null==h?void 0:h.hasShape,symbolType:null==h?void 0:h.shapeType,size:null===(e=a.shapeColumn.common)||void 0===e?void 0:e.width,fill:null==h?void 0:h.shapeColor,hollow:null==h?void 0:h.shapeHollow}),null===(i=this.textSpan)||void 0===i||i.setStyle({color:"inherit"}),null===(r=this.textSpan)||void 0===r||r.setContent(null==h?void 0:h.value,null===(s=null===(n=l.title)||void 0===n?void 0:n.value)||void 0===s?void 0:s.multiLine)}release(){super.release(),this.shape=null,this.textSpan=null}}let Gr="99999999999999";class Gn extends WQ{constructor(t,e,i){super(t.getContainer(),t,0),this.title=null,this.content=null,this._classList=e,this._id=i}setVisibility(t){if(super.setVisibility(t),!this.product)return;let{classList:e}=this.product;t?e.add("visible"):e.remove("visible")}init(){var t;let e=this._option.getTooltipActual();this.product||this._initPanel(this._classList,this._id);let{title:i}=e;!1!==(null==i?void 0:i.visible)&&eO(null==i?void 0:i.value)?this.title||this._initTitle():this.title&&this._releaseTitle(),(null!==(t=e.content)&&void 0!==t?t:[]).length>0?this.content||this._initContent():this.content&&this._releaseContent()}_initPanel(t,e){let i=this.createElement("div",t,{left:"0",top:"0",pointerEvents:"none",padding:"12px",position:"absolute",zIndex:Gr,fontFamily:"sans-serif",fontSize:"11px",borderRadius:"3px",borderStyle:"solid",lineHeight:"initial",background:"#fff",boxShadow:"2px 2px 4px rgba(0, 0, 0, 0.1)",maxWidth:"100wh",maxHeight:"100vh"},e);this.product=i}_initTitle(){let t=new Gi(this.product,this._option,0);t.init(),this.title=t,this.children[t.childIndex]=t}_releaseTitle(){this.title&&(this.title.release(),delete this.children[this.title.childIndex],this.title=null)}_initContent(){let t=new Ge(this.product,this._option,1);t.init(),this.content=t,this.children[t.childIndex]=t}_releaseContent(){this.content&&(this.content.release(),delete this.children[this.content.childIndex],this.content=null)}setStyle(){let t=this._option.getTooltipStyle();super.setStyle(us({},W1,t.panel)),Object.values(this.children).forEach(t=>t.setStyle())}setContent(){Object.values(this.children).forEach(t=>{t.setContent()})}release(){super.release(),this.title=null,this.content=null}}let Gs=t=>{de.registerComponentPlugin(t.type,t)};class Ga extends WK{getVisibility(){var t;return!!(null===(t=this.model)||void 0===t?void 0:t.getVisibility())}setVisibility(t){var e;t!==this.getVisibility()&&(null===(e=this.model)||void 0===e||e.setVisibility(t))}constructor(){super(Ga.type),this.type=N4.dom,this._tooltipContainer=null==ho?void 0:ho.body}onAdd(t){super.onAdd(t),this._initStyle(),this.initEl()}initEl(){let t=this._component.getSpec(),e=t.parentElement;if(ho&&e){for(let t=0;t<e.children.length;t++)if(e.children[t].classList.contains(WL)){this._container=e.children[t];break}this._container||(this._container=ho.createElement("div"),this._container.style.position="relative",this._container.style.zIndex=Gr,this._container.classList.add(WL),e.appendChild(this._container)),this.model=new Gn({valueToHtml:this._option.sanitize,getTooltipStyle:()=>this._domStyle,getTooltipActual:()=>this._tooltipActual,getTooltipAttributes:()=>this._attributes,getContainer:()=>this._container},[t.className],this.name)}}_removeTooltip(){var t;null===(t=this.model)||void 0===t||t.release(),this._container=null}_updateTooltip(t,e){var i,r;let{tooltipActual:n,tooltipSpec:s}=e;if(t&&this.model){if(!e.changePositionOnly){this._tooltipActual=n,this._initStyle();let t=!this.model.product;this.model.initAll(),t&&this._initEvent(this.model.product),this.model.setStyle(),this.model.setContent()}this.setVisibility(t);let a=this.model.product;if(a){let{x:t=0,y:o=0}=null!==(i=n.position)&&void 0!==i?i:{};if(s.updateElement){this._updatePosition(null!==(r=this._cacheCustomTooltipPosition)&&void 0!==r?r:{x:t,y:o}),s.updateElement(a,n,e);let i=this._getActualTooltipPosition(n,e,{width:a.offsetWidth,height:a.offsetHeight});this._updatePosition(i),this._cacheCustomTooltipPosition=i}else this._updatePosition({x:t,y:o})}}else this.setVisibility(t),this._cacheCustomTooltipPosition=void 0}_initStyle(){this._domStyle=function(t){var e,i,r;let{panel:n={},title:s,content:a,titleStyle:o={},contentStyle:l={},padding:h,keyWidth:u,valueWidth:d,enterable:c,transitionDuration:p,panelDomHeight:g=0,align:f="left"}=null!=t?t:{},{fill:m,shadow:v,shadowBlur:y,shadowColor:_,shadowOffsetX:b,shadowOffsetY:x,shadowSpread:S,cornerRadius:k,stroke:A,lineWidth:w=0,width:M=0}=n,{value:C={}}=o,{shape:T={},key:E={},value:O={}}=l,P=function(t,e){if(!t)return;let{size:i}=us({},e,t),r={};return r.width=WZ(i),r}(T),R=WJ(E),B=WJ(O),{bottom:I,left:L,right:D,top:F}=hi(h),j="right"===f?"marginLeft":"marginRight";return{align:f,panel:{width:WZ(M+2*w),minHeight:WZ(g+2*w),paddingBottom:WZ(I),paddingLeft:WZ(L),paddingRight:WZ(D),paddingTop:WZ(F),borderColor:A,borderWidth:WZ(w),borderRadius:WZ(k),backgroundColor:m?`${m}`:"transparent",boxShadow:v?`${b}px ${x}px ${y}px ${S}px ${_}`:"initial",pointerEvents:c?"auto":"none",transitionDuration:p?`${p}ms`:"initial",transitionProperty:p?"transform":"initial",transitionTimingFunction:p?"ease-out":"initial"},title:Object.assign({marginTop:"0px",marginBottom:(null==a?void 0:a.length)?WZ(null==s?void 0:s.spaceRow):"0px"},WJ(us({},C,null==s?void 0:s.value))),content:{},shapeColumn:{common:P,items:null==a?void 0:a.map(({spaceRow:t},e)=>({marginTop:"0px",marginBottom:e<a.length-1?WZ(t):"0px"})),width:WZ(T.size),[j]:WZ(null!==(e=T.spacing)&&void 0!==e?e:8)},keyColumn:{common:R,items:null==a?void 0:a.map(({key:t,spaceRow:e},i)=>Object.assign(Object.assign(Object.assign({marginTop:"0px",marginBottom:i<a.length-1?WZ(e):"0px"},R),WJ(t)),(null==t?void 0:t.multiLine)?{width:WZ(Math.ceil(t.width))}:void 0)),width:WZ(u),[j]:WZ(null!==(i=E.spacing)&&void 0!==i?i:26)},valueColumn:{common:B,items:null==a?void 0:a.map(({value:t,spaceRow:e},i)=>Object.assign(Object.assign(Object.assign({marginTop:"0px",marginBottom:i<a.length-1?WZ(e):"0px"},B),WJ(t)),(null==t?void 0:t.multiLine)?{width:WZ(Math.ceil(t.width))}:void 0)),width:WZ(d),[j]:WZ(null!==(r=O.spacing)&&void 0!==r?r:0)}}}(this._attributes)}_getParentElement(t){var e;return null!==(e=this._container)&&void 0!==e?e:super._getParentElement(t)}isTooltipShown(){return this.getVisibility()}reInit(){super.reInit(),this._initStyle()}_updatePosition({x:t,y:e}){let i=this.model.product;i&&(i.style.transform=`translate3d(${t}px, ${e}px, 0)`)}_initEvent(t){t.addEventListener("pointerleave",t=>{let{renderMode:e,enterable:i}=this._component.getSpec(),r=t.relatedTarget;"html"===e&&i&&(ej(r)||r!==this._compiler.getCanvas()&&!aw(r,this.getTooltipContainer()))&&this._component.hideTooltip()})}}Ga.type=N4.dom;let Go=(t,...e)=>{let i=[t.shape,...e.map(t=>null==t?void 0:t.shape)],r=[t.key,...e.map(t=>null==t?void 0:t.key)],n=[t.value,...e.map(t=>null==t?void 0:t.value)];return eF(t,...e,{shape:i.every(ej)?void 0:eF({},...i),key:r.every(ej)?void 0:eF({},...r),value:n.every(ej)?void 0:eF({},...n)})},Gl=t=>{let{width:e,height:i,wordBreak:r="break-word",textAlign:n,textBaseline:s,text:a}=t;return Array.isArray(a)?{width:e,height:i,wordBreak:r,textAlign:n,textBaseline:s,singleLine:!1,textConfig:om(a).map(e=>Object.assign(Object.assign({},t),{text:e}))}:{width:e,height:i,wordBreak:r,textAlign:n,textBaseline:s,singleLine:!1,textConfig:null==a?void 0:a.text}},Gh={panel:{visible:!0,cornerRadius:[3,3,3,3],fill:"white",shadow:!0,shadowBlur:12,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:4,shadowSpread:0,stroke:"white"},titleStyle:{value:{fill:"#4E5969",fontFamily:MA,fontSize:14,lineHeight:18,textAlign:"left",textBaseline:"middle"},spaceRow:6},contentStyle:{shape:{fill:"black",size:8,symbolType:"circle",spacing:6},key:{fill:"#4E5969",fontFamily:MA,fontSize:12,lineHeight:18,textAlign:"left",textBaseline:"middle",spacing:26},value:{fill:"#4E5969",fontFamily:MA,fontSize:12,lineHeight:18,textAlign:"right",textBaseline:"middle",spacing:0},spaceRow:6},padding:10,positionX:"right",positionY:"bottom",offsetX:10,offsetY:10,parentBounds:(new iI).setValue(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),autoCalculatePosition:!0,autoMeasure:!0,pickable:!1,childrenPickable:!1,zIndex:500},Gu=["pointerX","pointerY","offsetX","offsetY","positionX","positionY","parentBounds"];v8(),bp(),_2(),yG(),Al();class Gd extends Eu{constructor(t,e){super((null==e?void 0:e.skipDefault)?t:eF({},Gd.defaultAttributes,t),e),this.name="tooltip"}render(){var t;let{visible:e,content:i,panel:r,keyWidth:n,valueWidth:s,hasContentShape:a,autoCalculatePosition:o,autoMeasure:l,align:h}=this.attribute;if(!e)return void this.hideAll();l&&Gd.measureTooltip(this.attribute),o&&Gd.calculateTooltipPosition(this.attribute);let u=El(this.attribute.padding);this._tooltipPanel=this.createOrUpdateChild("tooltip-background",Object.assign({visible:!0},r),"rect"),this._tooltipTitleContainer=this.createOrUpdateChild("tooltip-title",{visible:!0,x:u[3],y:u[0]},"group");let d=Gd.getTitleAttr(this.attribute);this._tooltipTitleSymbol=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-shape",eF({symbolType:"circle"},d.shape,{visible:Tm(d)&&Tm(d.shape)}),"symbol"),"object"!=typeof d.value.text||null===d.value.text||"rich"!==d.value.text.type&&"html"!==d.value.text.type?d.value.multiLine?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:Tm(d)&&Tm(d.value)},Gl(d.value)),"richtext"):this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({text:null!==(t=d.value.text)&&void 0!==t?t:"",visible:Tm(d)&&Tm(d.value)},d.value),"text"):"rich"===d.value.text.type?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:Tm(d)&&Tm(d.value)},Gl(d.value)),"richtext"):"html"===d.value.text.type&&(this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({html:Object.assign(Object.assign({dom:d.value.text.text},MM),d.value),visible:Tm(d)&&Tm(d.value),width:d.value.width,height:d.value.height,wordBreak:d.value.wordBreak,textAlign:d.value.textAlign,textBaseline:d.value.textBaseline,singleLine:!1,textConfig:[]},d.value),"richtext"));let c=Tm(d.shape)?d.shape.size+d.shape.spacing:0,{textAlign:p,textBaseline:g}=d.value,f=r.width-u[3]-u[0]-c;"center"===p?this._tooltipTitle.setAttribute("x",c+f/2):"right"===p||"end"===p?this._tooltipTitle.setAttribute("x",c+f):this._tooltipTitle.setAttribute("x",c),"bottom"===g?this._tooltipTitle.setAttribute("y",d.height):"middle"===g?this._tooltipTitle.setAttribute("y",d.height/2):this._tooltipTitle.setAttribute("y",0);let m=Tm(d)?d.height+d.spaceRow:0;if(this._tooltipContent=this.createOrUpdateChild("tooltip-content",{visible:!0},"group"),this._tooltipContent.removeAllChild(!0),i&&i.length){this._tooltipContent.setAttribute("x",u[3]),this._tooltipContent.setAttribute("y",u[0]+m);let t=0;i.forEach((e,i)=>{let r=Gd.getContentAttr(this.attribute,i);if(!Tm(r))return;let o=`tooltip-content-${i}`,l=this._tooltipContent.createOrUpdateChild(o,{visible:!0,x:0,y:t},"group"),u=r.shape.size+r.shape.spacing,d="right"===h?(a?u:0)+(Tm(r.key)?n+r.key.spacing:0)+(Tm(r.value)?s:0):0;this._createShape("right"===h?d-r.shape.size/2:d+r.shape.size/2,r,l,o),a&&("right"===h?d-=u:d+=u);let c=this._createKey(r,l,o);c&&(MR(h,c,r.key.textAlign,d,n),c.setAttribute("y",0),"right"===h?d-=n+r.key.spacing:d+=n+r.key.spacing);let p=this._createValue(r,l,o);if(p){let t="right";eO(r.value.textAlign)?t=r.value.textAlign:Tm(r.key)||"right"===h||(t="left"),p.setAttribute("textAlign",t),MR(h,p,t,d,s),p.setAttribute("y",0)}t+=r.height+r.spaceRow})}}_createShape(t,e,i,r){var n;if(Tm(e.shape))return i.createOrUpdateChild(`${r}-shape`,Object.assign({visible:!0,x:t,y:e.shape.size/2+((null!==(n=sm(e.key.lineHeight,e.key.fontSize))&&void 0!==n?n:e.key.fontSize)-e.shape.size)/2},e.shape),"symbol")}_createKey(t,e,i){var r;if(Tm(t.key)){let n;return t.key.multiLine?e.createOrUpdateChild(`${i}-key`,Object.assign(Object.assign({visible:!0},Gl(t.key)),{textBaseline:"top"}),"richtext"):"object"!=typeof t.key.text||null===t.key.text||"rich"!==t.key.text.type&&"html"!==t.key.text.type?e.createOrUpdateChild(`${i}-key`,Object.assign(Object.assign({visible:!0,text:null!==(r=t.key.text)&&void 0!==r?r:""},t.key),{textBaseline:"top"}),"text"):"rich"===t.key.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},Gl(t.key)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild(`${i}-value`,{html:Object.assign(Object.assign({dom:t.key.text.text},MM),t.key)},"richtext")}}_createValue(t,e,i){var r;if(Tm(t.value)){let n;return t.value.multiLine?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},Gl(t.value)),{textBaseline:"top"}),"richtext"):"object"!=typeof t.value.text||null===t.value.text||"rich"!==t.value.text.type&&"html"!==t.value.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0,text:null!==(r=t.value.text)&&void 0!==r?r:""},t.value),{textBaseline:"top"}),"text"):"rich"===t.value.text.type?e.createOrUpdateChild(`${i}-value`,Object.assign(Object.assign({visible:!0},Gl(t.value)),{textBaseline:"top"}),"richtext"):e.createOrUpdateChild(`${i}-value`,{html:Object.assign({dom:t.value.text.text,container:"",width:30,height:30,style:{}},t.value)},"richtext")}}setAttributes(t,e){let i=Object.keys(t);this.attribute.autoCalculatePosition&&i.every(t=>Gu.includes(t))?(this._mergeAttributes(t,i),ej(this.attribute.panel.width)&&this.attribute.autoMeasure&&Gd.measureTooltip(this.attribute),Gd.calculateTooltipPosition(this.attribute),super.setAttributes({x:this.attribute.x,y:this.attribute.y},e)):super.setAttributes(t,e)}static calculateTooltipPosition(t){let{width:e=0,height:i=0}=t.panel,{offsetX:r,offsetY:n,pointerX:s,pointerY:a,positionX:o,positionY:l,parentBounds:h}=t,u=s,d=a;return"left"===o?u-=e+r:"center"===o?u-=e/2:u+=r,"top"===l?d-=i+n:"middle"===l?d-=i/2:d+=n,u+e>h.x2&&(u-=e+r),d+i>h.y2&&(d-=i+n),u<h.x1&&(u=h.x1),d<h.y1&&(d=h.y1),t.x=u,t.y=d,t}static measureTooltip(t){let{content:e,contentStyle:i}=t,r=El(t.padding),n=Gd.getTitleAttr(t),s=0,a=r[0]+r[2],o=0,{value:l,shape:h}=n,{visible:u=!1,symbolType:d=""}=null!=h?h:{};if(eO(l)&&"object"!=typeof n.value.text){let{width:t,height:e}=MC(l).quickMeasure(l.text);s=t,o=e}if(u&&_P[d]&&(s+=h.size+h.spacing,o=Math.max(h.size,o)),t.title&&(t.title.width=s,t.title.height=o),Tm(n)&&(a+=o+n.spaceRow),e&&e.length){let r=[];if(e.forEach((e,i)=>{let n=Gd.getContentAttr(t,i);(e.key||e.value)&&Tm(n)&&r.push([e,n])}),r.length){let n=!1,o=[],l=[],h=[];r.forEach(([t,e],s)=>{var u;let{key:d,value:c,shape:p,spaceRow:g}=e,f=Tm(p),m=null!==(u=null==p?void 0:p.symbolType)&&void 0!==u?u:"",v=MC(d),y=MC(c),_=0;if(Tm(d)){let{width:t,height:e}=v.quickMeasure(d.text);l.push(t),_=Math.max(_,e)}if(Tm(c)){let{width:t,height:e}=y.quickMeasure(c.text);h.push(t),_=Math.max(_,e)}f&&_P[m]&&(n=!0,o.push(p.size),_=Math.max(p.size,_)),t.height=_,a+=_,s<r.length-1&&(a+=null!=g?g:i.spaceRow)});let u=o.length?Math.max(...o):0,d=l.length?Math.max(...l):0,c=h.length?Math.max(...h):0;s=Math.max(d+c+i.key.spacing+i.value.spacing+(n?u+i.shape.spacing:0),s),e.forEach(t=>{t.width=s}),t.hasContentShape=n,t.keyWidth=d,t.valueWidth=c}}return t.panel.width=s+r[1]+r[3],t.panel.height=a,t}static getTitleAttr(t){return Go({},Gd.defaultAttributes.titleStyle,Gd.defaultAttributes.title,t.titleStyle,t.title)}static getContentAttr(t,e){return Go({},Gd.defaultAttributes.contentStyle,t.contentStyle,t.content[e])}}Gd.defaultAttributes=Gh;class Gc extends WK{constructor(){super(Gc.type),this.type=N4.canvas}onAdd(t){var e;super.onAdd(t),this._tooltipCanvasId=null===(e=this._chartOption.modeParams)||void 0===e?void 0:e.tooltipCanvasId}_initTooltipComponent(t){let e=this._getLayer(t);this._tooltipComponent=new Gd({autoCalculatePosition:!1,autoMeasure:!1}),e.add(this._tooltipComponent)}_getLayer(t){if(this._layer)return this._layer;this._layer=t.createLayer(this._tooltipCanvasId);let e=this._layer.layerHandler.canvas.nativeCanvas;return e&&e.style&&(e.style.touchAction="none",e.style.pointerEvents="none"),this._layer}_removeTooltip(){this._layer&&this._layer.removeAllChild(),this._attributes=null}_updateTooltip(t,e){this._visible=t;let i=this._compiler.getStage();if(!i)return;if(!t)return void(this._tooltipComponent&&this._tooltipComponent.attribute.visible&&(this._tooltipComponent.hideAll(),this._tooltipComponent.setAttributes({visibleAll:!1})));this._tooltipComponent||this._initTooltipComponent(i);let{tooltipActual:r}=e,n=r.position;e.changePositionOnly?eO(n)&&this._tooltipComponent.setAttributes(n):this._tooltipComponent.setAttributes(Object.assign(Object.assign({},this._attributes),n)),this._tooltipComponent.attribute.visible||(this._tooltipComponent.showAll(),this._tooltipComponent.setAttributes({visibleAll:!0}))}isTooltipShown(){var t;return null===(t=this._tooltipComponent)||void 0===t?void 0:t.attribute.visibleAll}release(){var t;super.release(),null===(t=this._layer)||void 0===t||t.release()}}Gc.type=N4.canvas;function Gp(t,e){let i=e?t.toExponential(e-1):t.toExponential(),r=i.indexOf("e");if(r<0)return null;let n=i.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+i.slice(r+1)]}function Gg(t,e){let i=Gp(t,e);if(!i)return t+"";let r=i[0],n=i[1];return n<0?"0."+Array(-n).join("0")+r:r.length>n+1?r.slice(0,n+1)+"."+r.slice(n+1):r+Array(n-r.length+2).join("0")}class Gf{constructor(t={}){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}toString(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}}let Gm=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gv(t){let e;if(e=Gm.exec(t))return new Gf({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]});ex.getInstance().error("invalid format: "+t)}let Gy=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];class G_{constructor(){var t,e;this.locale={thousands:",",grouping:[3],currency:["$",""]},this.group=void 0===this.locale.grouping||void 0===this.locale.thousands?t=>t:(t=[...this.locale.grouping].map(Number),e=`${this.locale.thousands}`,function(i,r){let n=i.length,s=[],a=0,o=t[0],l=0;for(;n>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(i.substring(n-=o,n+o)),!((l+=o+1)>r));)o=t[a=(a+1)%t.length];return s.reverse().join(e)}),this.currencyPrefix=void 0===this.locale.currency?"":this.locale.currency[0]+"",this.currencySuffix=void 0===this.locale.currency?"":this.locale.currency[1]+"",this.decimal=void 0===this.locale.decimal?".":this.locale.decimal+"",this.numerals=void 0===this.locale.numerals?t=>t:function(t){return function(e){return e.replace(/[0-9]/g,e=>t[+e])}}([...this.locale.numerals].map(String)),this.percent=void 0===this.locale.percent?"%":this.locale.percent+"",this.minus=void 0===this.locale.minus?"\u2212":this.locale.minus+"",this.nan=void 0===this.locale.nan?"NaN":this.locale.nan+"",this.formatter=t=>this.newFormat(t),this.format=(t,e)=>this.formatter(t)(e),this.formatPrefix=(t,e)=>this._formatPrefix(t,e)}static getInstance(){return G_.instance||(G_.instance=new G_),G_.instance}newFormat(t){let e=Gv(t),i=e.fill,r=e.align,n=e.sign,s=e.symbol,a=e.zero,o=e.width,l=e.comma,h=e.precision,u=e.trim,d=e.type;"n"===d?(l=!0,d="g"):Gb[d]||(void 0===h&&(h=12),u=!0,d="g"),(a||"0"===i&&"="===r)&&(a=!0,i="0",r="=");let c="$"===s?this.currencyPrefix:"#"===s&&/[boxX]/.test(d)?"0"+d.toLowerCase():"",p="$"===s?this.currencySuffix:/[%p]/.test(d)?this.percent:"",g=Gb[d],f=/[defgprstz%]/.test(d);h=void 0===h?6:/[gprs]/.test(d)?Math.max(1,Math.min(21,h)):Math.max(0,Math.min(20,h));let{nan:m,minus:y,decimal:_,group:b,numerals:x}=this;function S(t){let e,s,S,k=c,A=p,w=t;if("c"===d)A=g(w)+A,w="";else{let t=(w=+w)<0||1/w<0;if(w=isNaN(w)?m:g(Math.abs(w),h),u&&(w=function(t){let e=t.length,i,r=-1;t:for(let n=1;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":0===r&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(i+1):t}(w)),t&&0==+w&&"+"!==n&&(t=!1),k=(t?"("===n?n:y:"-"===n||"("===n?"":n)+k,A=("s"===d?Gy[8+v/3]:"")+A+(t&&"("===n?")":""),f){for(e=-1,s=w.length;++e<s;)if(48>(S=w.charCodeAt(e))||S>57){A=(46===S?_+w.slice(e+1):w.slice(e))+A,w=w.slice(0,e);break}}}l&&!a&&(w=b(w,1/0));let M=k.length+w.length+A.length,C=M<o?Array(o-M+1).join(i):"";switch(l&&a&&(w=b(C+w,C.length?o-A.length:1/0),C=""),r){case"<":w=k+w+A+C;break;case"=":w=k+C+w+A;break;case"^":w=C.slice(0,M=C.length>>1)+k+w+A+C.slice(M);break;default:w=C+k+w+A}return x(w)}return S.toString=function(){return t+""},S}_formatPrefix(t,e){let i=Gv(t);i.type="f";let r=this.newFormat(i.toString()),n=3*Math.max(-8,Math.min(8,Math.floor(function(t){let e=Gp(Math.abs(t));return e?e[1]:NaN}(e)/3))),s=Math.pow(10,-n),a=Gy[8+n/3];return function(t){return r(s*t)+a}}}let Gb={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},f:(t,e)=>t.toFixed(e),e:(t,e)=>t.toExponential(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Gg(100*t,e),r:Gg,s:function(t,e){let i=Gp(t,e);if(!i)return t+"";let r=i[0],n=i[1],s=n-(v=3*Math.max(-8,Math.min(8,Math.floor(n/3))))+1,a=r.length;return s===a?r:s>a?r+Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+Array(1-s).join("0")+Gp(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16),t:(t,e)=>Number.isInteger(t)?t.toFixed(2):Math.floor(t*Math.pow(10,e))/Math.pow(10,e)+"",z:(t,e)=>t%1==0?t+"":t.toFixed(e)},Gx=t=>{de.registerChartPlugin(t.type,t)},GS=/\{([^}]+)\}/,Gk=/\{([^}]+)\}/g,GA=/:/;class Gw extends TL{constructor(){super(Gw.type),this.type="formatterPlugin",this._timeModeFormat={utc:Bq.getInstance().timeUTCFormat,local:Bq.getInstance().timeFormat},this._formatter=this._format,this._timeFormatter=this._timeModeFormat.local,this._numericFormatter=G_.getInstance().format,this._numericSpecifier=G_.getInstance().formatter,this._numericFormatterCache=new Map,this._isNumericFormatterCache=new Map}onInit(t,e){var i;let{globalInstance:r}=t;if(!r)return;this._spec=null!==(i=null==e?void 0:e[Gw.specKey])&&void 0!==i?i:{};let{timeMode:n,customFormatter:s,numericFormatter:a,timeFormatter:o}=this._spec;nx(s)?this._formatter=s:(this._formatter=this._format.bind(this),nx(o)?this._timeFormatter=o:n&&this._timeModeFormat[n]&&(this._timeFormatter=this._timeModeFormat[n]),a&&(this._numericFormatter=a,this._numericSpecifier=null,this._numericFormatterCache=null)),de.registerFormatter(this._formatter)}_format(t,e,i){return eM(t)?t.map((t,r)=>{let n=eM(i)?i[r]:i;return n?this._formatSingleLine(t,e,n):t}):eM(i)?i.map(i=>this._formatSingleLine(t,e,i)):this._formatSingleLine(t,e,i)}_formatSingleLine(t,e,i){let r;return(this._isNumericFormatterCache&&(this._isNumericFormatterCache.get(i)?r=this._isNumericFormatterCache.get(i):(r=GS.test(i),this._isNumericFormatterCache.set(i,r))),r)?i.replace(Gk,(t,i)=>{if(!GA.test(i)){let r=e[i.trim()];return void 0!==r?r:t}let r=i.split(":"),n=e[r.shift()],s=r.join(":");return this._formatSingleText(n,s)}):this._formatSingleText(t,i)}_formatSingleText(t,e){if(Gm.test(e)&&this._numericFormatter){let i;return this._numericFormatterCache&&this._numericSpecifier?(this._numericFormatterCache.get(e)?i=this._numericFormatterCache.get(e):(i=this._numericSpecifier(e),this._numericFormatterCache.set(e,i)),i(Number(t))):this._numericFormatter(e,Number(t))}return e.includes("%")&&this._timeFormatter?this._timeFormatter(e,t):t}release(){super.release(),this._format=null,this._timeFormatter=null,this._numericFormatter=null,this._numericSpecifier=null,this._numericFormatterCache=null,this._isNumericFormatterCache=null}}Gw.pluginType="chart",Gw.specKey="formatter",Gw.type="formatterPlugin";class GM extends Sd{constructor(){super(...arguments),this.type=GM.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,lineWidth:0})}}GM.type="image";let GC=()=>{de.registerMark(GM.type,GM),Az()};CM.useRegisters([()=>{OM(),de.registerChart(OF.type,OF)},()=>{OG(),de.registerChart(O$.type,O$)},()=>{O8(),de.registerChart(O9.type,O9)},()=>{Pf(),de.registerChart(Pv.type,Pv)},()=>{Bn(),de.registerChart(Bl.type,Bl)},()=>{BR(),de.registerChart(BL.type,BL)},()=>{B$(),de.registerChart(BK.type,BK)},()=>{O8(),de.registerChart(Io.type,Io)},()=>{R$(),de.registerChart(RK.type,RK)},()=>{IA(),IC(),de.registerChart(IE.type,IE)},()=>{Lw(),de.registerChart(LT.type,LT)},()=>{LM(),Lw(),de.registerChart(LT.type,LT)},()=>{LJ(),de.registerChart(L0.type,L0)},()=>{FV(),de.registerChart(FG.type,FG)},()=>{F7(),de.registerChart(je.type,je)},()=>{If(),de.registerChart(Iy.type,Iy)},()=>{Dn(),de.registerChart(Da.type,Da)},()=>{Df(),de.registerChart(Dv.type,Dv)},()=>{jF(),de.registerChart(jN.type,jN)},()=>{DY(),de.registerChart(DZ.type,DZ)},()=>{Fn(),de.registerChart(Fa.type,Fa)},()=>{F_(),de.registerChart(Fx.type,Fx)},()=>{jR(),de.registerChart(jI.type,jI)},()=>{jZ(),de.registerChart(jq.type,jq)},()=>{It(),B3(),Oy(),OA(),de.registerChart(Ir.type,Ir)},()=>{Ni(),de.registerChart(Nn.type,Nn)},()=>{de.registerChart(BX.type,BX)},()=>{Pi(),de.registerChart(Pn.type,Pn)},()=>{Bp(),de.registerChart(Bf.type,Bf)},()=>{Pi(),de.registerChart(Il.type,Il)},()=>{L4(),de.registerChart(L8.type,L8)},()=>{D_(),de.registerChart(Dx.type,Dx)},()=>{LO(),de.registerChart(LB.type,LB)},()=>{LP(),LO(),de.registerChart(LB.type,LB)},OA,Oy,()=>{Oc(),de.registerComponent(Ns.type,Ns)},()=>{Oc(),de.registerComponent(Nu.type,Nu)},()=>{Oc(),de.registerComponent(Nc.type,Nc)},BT,BO,()=>{de.registerComponent(NP.type,NP)},()=>{de.registerComponent(NG.type,NG)},()=>{de.registerComponent(zo.type,zo)},()=>{de.registerComponent(zb.type,zb)},()=>{de.registerComponent(zT.type,zT)},()=>{de.registerComponent(zj.type,zj)},()=>{de.registerComponent(zN.type,zN)},()=>{de.registerComponent(zW.type,zW)},RW,()=>{de.registerComponent(HU.type,HU),HD()},()=>{de.registerComponent(H0.type,H0),Hq()},()=>{de.registerComponent(Wr.type,Wr),V7()},()=>{de.registerComponent(HK.type,HK),HY._animate=H_,HD()},()=>{de.registerComponent(H2.type,H2),H1._animate=Hx,Hq()},()=>{de.registerComponent(Wn.type,Wn),V7()},()=>{de.registerComponent(Ws.type,Ws),V7()},()=>{de.registerComponent(HX.type,HX)},()=>{de.registerComponent(Vv.type,Vv)},()=>{V1(),V5(),Oa(),de.registerComponent(V8.type,V8,!0)},()=>{V1(),V5(),Oa(),de.registerComponent(V6.type,V6,!0)},()=>{de.registerComponent(Wp.type,Wp)},()=>{de.registerComponent(Wg.type,Wg)},()=>{de.registerComponent(Wx.type,Wx)},()=>{r4.load(WR)},()=>{de.registerLayout(WS.type,WS)},()=>{de.registerLayout(WA.type,WA)},()=>{AQ(),Tr(),Ta(),B0(),B9(),ON(),O2(),RL(),Bt(),LZ(),GC(),j6(),Oa(),Bu(),Pt(),L2()},()=>{Gs(Ga)},()=>{Gs(Gc)},()=>{Gx(Gw)},()=>{d0.registerInteraction(Cd.type,Cd)},()=>{d0.registerInteraction(C_.type,C_)},()=>{d0.registerInteraction(Cb.type,Cb)},()=>{d0.registerInteraction(Cx.type,Cx)},()=>{d0.registerInteraction(Cy.type,Cy)},()=>{d0.registerInteraction(Cv.type,Cv)}]);let GT=CM},2670:function(t){var e,i;e=0,i=function(){"use strict";var t="millisecond",e="second",i="minute",r="hour",n="week",s="month",a="quarter",o="year",l="date",h="Invalid Date",u=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,d=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,c=function(t,e,i){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(i)+t},p="en",g={};g[p]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],i=t%100;return"["+t+(e[(i-20)%10]||e[i]||"th")+"]"}};var f="$isDayjsObject",m=function(t){return t instanceof b||!(!t||!t[f])},v=function t(e,i,r){var n;if(!e)return p;if("string"==typeof e){var s=e.toLowerCase();g[s]&&(n=s),i&&(g[s]=i,n=s);var a=e.split("-");if(!n&&a.length>1)return t(a[0])}else{var o=e.name;g[o]=e,n=o}return!r&&n&&(p=n),n||!r&&p},y=function(t,e){if(m(t))return t.clone();var i="object"==typeof e?e:{};return i.date=t,i.args=arguments,new b(i)},_={s:c,z:function(t){var e=-t.utcOffset(),i=Math.abs(e);return(e<=0?"+":"-")+c(Math.floor(i/60),2,"0")+":"+c(i%60,2,"0")},m:function t(e,i){if(e.date()<i.date())return-t(i,e);var r=12*(i.year()-e.year())+(i.month()-e.month()),n=e.clone().add(r,s),a=i-n<0,o=e.clone().add(r+(a?-1:1),s);return+(-(r+(i-n)/(a?n-o:o-n))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(h){return({M:s,y:o,w:n,d:"day",D:l,h:r,m:i,s:e,ms:t,Q:a})[h]||String(h||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}};_.l=v,_.i=m,_.w=function(t,e){return y(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var b=function(){function c(t){this.$L=v(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[f]=!0}var p=c.prototype;return p.parse=function(t){this.$d=function(t){var e=t.date,i=t.utc;if(null===e)return new Date(NaN);if(_.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(u);if(r){var n=r[2]-1||0,s=(r[7]||"0").substring(0,3);return i?new Date(Date.UTC(r[1],n,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],n,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.init()},p.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},p.$utils=function(){return _},p.isValid=function(){return this.$d.toString()!==h},p.isSame=function(t,e){var i=y(t);return this.startOf(e)<=i&&i<=this.endOf(e)},p.isAfter=function(t,e){return y(t)<this.startOf(e)},p.isBefore=function(t,e){return this.endOf(e)<y(t)},p.$g=function(t,e,i){return _.u(t)?this[e]:this.set(i,t)},p.unix=function(){return Math.floor(this.valueOf()/1e3)},p.valueOf=function(){return this.$d.getTime()},p.startOf=function(t,a){var h=this,u=!!_.u(a)||a,d=_.p(t),c=function(t,e){var i=_.w(h.$u?Date.UTC(h.$y,e,t):new Date(h.$y,e,t),h);return u?i:i.endOf("day")},p=function(t,e){return _.w(h.toDate()[t].apply(h.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(e)),h)},g=this.$W,f=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case o:return u?c(1,0):c(31,11);case s:return u?c(1,f):c(0,f+1);case n:var y=this.$locale().weekStart||0,b=(g<y?g+7:g)-y;return c(u?m-b:m+(6-b),f);case"day":case l:return p(v+"Hours",0);case r:return p(v+"Minutes",1);case i:return p(v+"Seconds",2);case e:return p(v+"Milliseconds",3);default:return this.clone()}},p.endOf=function(t){return this.startOf(t,!1)},p.$set=function(n,a){var h,u=_.p(n),d="set"+(this.$u?"UTC":""),c=((h={}).day=d+"Date",h[l]=d+"Date",h[s]=d+"Month",h[o]=d+"FullYear",h[r]=d+"Hours",h[i]=d+"Minutes",h[e]=d+"Seconds",h[t]=d+"Milliseconds",h)[u],p="day"===u?this.$D+(a-this.$W):a;if(u===s||u===o){var g=this.clone().set(l,1);g.$d[c](p),g.init(),this.$d=g.set(l,Math.min(this.$D,g.daysInMonth())).$d}else c&&this.$d[c](p);return this.init(),this},p.set=function(t,e){return this.clone().$set(t,e)},p.get=function(t){return this[_.p(t)]()},p.add=function(t,a){var l,h=this;t=Number(t);var u=_.p(a),d=function(e){var i=y(h);return _.w(i.date(i.date()+Math.round(e*t)),h)};if(u===s)return this.set(s,this.$M+t);if(u===o)return this.set(o,this.$y+t);if("day"===u)return d(1);if(u===n)return d(7);var c=((l={})[i]=6e4,l[r]=36e5,l[e]=1e3,l)[u]||1,p=this.$d.getTime()+t*c;return _.w(p,this)},p.subtract=function(t,e){return this.add(-1*t,e)},p.format=function(t){var e=this,i=this.$locale();if(!this.isValid())return i.invalidDate||h;var r=t||"YYYY-MM-DDTHH:mm:ssZ",n=_.z(this),s=this.$H,a=this.$m,o=this.$M,l=i.weekdays,u=i.months,c=i.meridiem,p=function(t,i,n,s){return t&&(t[i]||t(e,r))||n[i].slice(0,s)},g=function(t){return _.s(s%12||12,t,"0")},f=c||function(t,e,i){var r=t<12?"AM":"PM";return i?r.toLowerCase():r};return r.replace(d,function(t,r){return r||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return _.s(e.$y,4,"0");case"M":return o+1;case"MM":return _.s(o+1,2,"0");case"MMM":return p(i.monthsShort,o,u,3);case"MMMM":return p(u,o);case"D":return e.$D;case"DD":return _.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return p(i.weekdaysMin,e.$W,l,2);case"ddd":return p(i.weekdaysShort,e.$W,l,3);case"dddd":return l[e.$W];case"H":return String(s);case"HH":return _.s(s,2,"0");case"h":return g(1);case"hh":return g(2);case"a":return f(s,a,!0);case"A":return f(s,a,!1);case"m":return String(a);case"mm":return _.s(a,2,"0");case"s":return String(e.$s);case"ss":return _.s(e.$s,2,"0");case"SSS":return _.s(e.$ms,3,"0");case"Z":return n}return null}(t)||n.replace(":","")})},p.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},p.diff=function(t,l,h){var u,d=this,c=_.p(l),p=y(t),g=(p.utcOffset()-this.utcOffset())*6e4,f=this-p,m=function(){return _.m(d,p)};switch(c){case o:u=m()/12;break;case s:u=m();break;case a:u=m()/3;break;case n:u=(f-g)/6048e5;break;case"day":u=(f-g)/864e5;break;case r:u=f/36e5;break;case i:u=f/6e4;break;case e:u=f/1e3;break;default:u=f}return h?u:_.a(u)},p.daysInMonth=function(){return this.endOf(s).$D},p.$locale=function(){return g[this.$L]},p.locale=function(t,e){if(!t)return this.$L;var i=this.clone(),r=v(t,e,!0);return r&&(i.$L=r),i},p.clone=function(){return _.w(this.$d,this)},p.toDate=function(){return new Date(this.valueOf())},p.toJSON=function(){return this.isValid()?this.toISOString():null},p.toISOString=function(){return this.$d.toISOString()},p.toString=function(){return this.$d.toUTCString()},c}(),x=b.prototype;return y.prototype=x,[["$ms",t],["$s",e],["$m",i],["$H",r],["$W","day"],["$M",s],["$y",o],["$D",l]].forEach(function(t){x[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),y.extend=function(t,e){return t.$i||(t(e,b,y),t.$i=!0),y},y.locale=v,y.isDayjs=m,y.unix=function(t){return y(1e3*t)},y.en=g[p],y.Ls=g,y.p={},y},t.exports=i()},6603:function(t,e,i){var r,n;r=0,n=function(t){"use strict";var e,i=(e=t)&&"object"==typeof e&&"default"in e?e:{default:e},r={name:"zh-cn",weekdays:"\u661F\u671F\u65E5_\u661F\u671F\u4E00_\u661F\u671F\u4E8C_\u661F\u671F\u4E09_\u661F\u671F\u56DB_\u661F\u671F\u4E94_\u661F\u671F\u516D".split("_"),weekdaysShort:"\u5468\u65E5_\u5468\u4E00_\u5468\u4E8C_\u5468\u4E09_\u5468\u56DB_\u5468\u4E94_\u5468\u516D".split("_"),weekdaysMin:"\u65E5_\u4E00_\u4E8C_\u4E09_\u56DB_\u4E94_\u516D".split("_"),months:"\u4E00\u6708_\u4E8C\u6708_\u4E09\u6708_\u56DB\u6708_\u4E94\u6708_\u516D\u6708_\u4E03\u6708_\u516B\u6708_\u4E5D\u6708_\u5341\u6708_\u5341\u4E00\u6708_\u5341\u4E8C\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function(t,e){return"W"===e?t+"\u5468":t+"\u65E5"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5E74M\u6708D\u65E5",LLL:"YYYY\u5E74M\u6708D\u65E5Ah\u70B9mm\u5206",LLLL:"YYYY\u5E74M\u6708D\u65E5ddddAh\u70B9mm\u5206",l:"YYYY/M/D",ll:"YYYY\u5E74M\u6708D\u65E5",lll:"YYYY\u5E74M\u6708D\u65E5 HH:mm",llll:"YYYY\u5E74M\u6708D\u65E5dddd HH:mm"},relativeTime:{future:"%s\u5185",past:"%s\u524D",s:"\u51E0\u79D2",m:"1 \u5206\u949F",mm:"%d \u5206\u949F",h:"1 \u5C0F\u65F6",hh:"%d \u5C0F\u65F6",d:"1 \u5929",dd:"%d \u5929",M:"1 \u4E2A\u6708",MM:"%d \u4E2A\u6708",y:"1 \u5E74",yy:"%d \u5E74"},meridiem:function(t,e){var i=100*t+e;return i<600?"\u51CC\u6668":i<900?"\u65E9\u4E0A":i<1100?"\u4E0A\u5348":i<1300?"\u4E2D\u5348":i<1800?"\u4E0B\u5348":"\u665A\u4E0A"}};return i.default.locale(r,null,!0),r},t.exports=n(i(2670))},1883:function(t){"use strict";var e=Object.prototype.hasOwnProperty,i="~";function r(){}function n(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(t,e,r,s,a){if("function"!=typeof r)throw TypeError("The listener must be a function");var o=new n(r,s||t,a),l=i?i+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],o]:t._events[l].push(o):(t._events[l]=o,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),!new r().__proto__&&(i=!1)),o.prototype.eventNames=function(){var t,r,n=[];if(0===this._eventsCount)return n;for(r in t=this._events)e.call(t,r)&&n.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},o.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,a=Array(s);n<s;n++)a[n]=r[n].fn;return a},o.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},o.prototype.emit=function(t,e,r,n,s,a){var o=i?i+t:t;if(!this._events[o])return!1;var l,h,u=this._events[o],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,n),!0;case 5:return u.fn.call(u.context,e,r,n,s),!0;case 6:return u.fn.call(u.context,e,r,n,s,a),!0}for(h=1,l=Array(d-1);h<d;h++)l[h-1]=arguments[h];u.fn.apply(u.context,l)}else{var c,p=u.length;for(h=0;h<p;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),d){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,r);break;case 4:u[h].fn.call(u[h].context,e,r,n);break;default:if(!l)for(c=1,l=Array(d-1);c<d;c++)l[c-1]=arguments[c];u[h].fn.apply(u[h].context,l)}}return!0},o.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return s(this,t,e,i,!0)},o.prototype.removeListener=function(t,e,r,n){var s=i?i+t:t;if(!this._events[s])return this;if(!e)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn===e&&(!n||o.once)&&(!r||o.context===r)&&a(this,s);else{for(var l=0,h=[],u=o.length;l<u;l++)(o[l].fn!==e||n&&!o[l].once||r&&o[l].context!==r)&&h.push(o[l]);h.length?this._events[s]=1===h.length?h[0]:h:a(this,s)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o;t.exports=o},2369:function(t,e){"use strict";var i,r,n=Symbol.for("react.element"),s=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.for("react.offscreen");function y(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case n:switch(t=t.type){case a:case l:case o:case p:case g:return t;default:switch(t=t&&t.$$typeof){case d:case u:case c:case m:case f:case h:return t;default:return e}}case s:return e}}}r=Symbol.for("react.module.reference");e.isForwardRef=function(t){return y(t)===c},e.isFragment=function(t){return y(t)===a}},7101:function(t,e,i){"use strict";t.exports=i(2369)},8977:function(t,e,i){"use strict";i.d(e,{Z:()=>x});var r=i("9933"),n=i("6293"),s=i("510");function a(t,e){return t.replace(RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var o=i("4194"),l=i("6321");let h={disabled:!1};var u=i("6693"),d=function(t){return t.scrollTop},c="unmounted",p="exited",g="entering",f="entered",m="exiting",v=function(t){function e(e,i){r=t.call(this,e,i)||this;var r,n,s=i&&!i.isMounting?e.enter:e.appear;return r.appearStatus=null,e.in?s?(n=p,r.appearStatus=g):n=f:n=e.unmountOnExit||e.mountOnEnter?c:p,r.state={status:n},r.nextCallback=null,r}(0,s.Z)(e,t),e.getDerivedStateFromProps=function(t,e){return t.in&&e.status===c?{status:p}:null};var i=e.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(t){var e=null;if(t!==this.props){var i=this.state.status;this.props.in?i!==g&&i!==f&&(e=g):(i===g||i===f)&&(e=m)}this.updateStatus(!1,e)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var t,e,i,r=this.props.timeout;return t=e=i=r,null!=r&&"number"!=typeof r&&(t=r.exit,e=r.enter,i=void 0!==r.appear?r.appear:e),{exit:t,enter:e,appear:i}},i.updateStatus=function(t,e){if(void 0===t&&(t=!1),null!==e){if(this.cancelNextCallback(),e===g){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:l.findDOMNode(this);i&&d(i)}this.performEnter(t)}else this.performExit()}else this.props.unmountOnExit&&this.state.status===p&&this.setState({status:c})},i.performEnter=function(t){var e=this,i=this.props.enter,r=this.context?this.context.isMounting:t,n=this.props.nodeRef?[r]:[l.findDOMNode(this),r],s=n[0],a=n[1],o=this.getTimeouts(),u=r?o.appear:o.enter;if(!t&&!i||h.disabled){this.safeSetState({status:f},function(){e.props.onEntered(s)});return}this.props.onEnter(s,a),this.safeSetState({status:g},function(){e.props.onEntering(s,a),e.onTransitionEnd(u,function(){e.safeSetState({status:f},function(){e.props.onEntered(s,a)})})})},i.performExit=function(){var t=this,e=this.props.exit,i=this.getTimeouts(),r=this.props.nodeRef?void 0:l.findDOMNode(this);if(!e||h.disabled){this.safeSetState({status:p},function(){t.props.onExited(r)});return}this.props.onExit(r),this.safeSetState({status:m},function(){t.props.onExiting(r),t.onTransitionEnd(i.exit,function(){t.safeSetState({status:p},function(){t.props.onExited(r)})})})},i.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(t,e){e=this.setNextCallback(e),this.setState(t,e)},i.setNextCallback=function(t){var e=this,i=!0;return this.nextCallback=function(r){i&&(i=!1,e.nextCallback=null,t(r))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},i.onTransitionEnd=function(t,e){this.setNextCallback(e);var i=this.props.nodeRef?this.props.nodeRef.current:l.findDOMNode(this),r=null==t&&!this.props.addEndListener;if(!i||r){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var n=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],s=n[0],a=n[1];this.props.addEndListener(s,a)}null!=t&&setTimeout(this.nextCallback,t)},i.render=function(){var t=this.state.status;if(t===c)return null;var e=this.props,i=e.children,r=(e.in,e.mountOnEnter,e.unmountOnExit,e.appear,e.enter,e.exit,e.timeout,e.addEndListener,e.onEnter,e.onEntering,e.onEntered,e.onExit,e.onExiting,e.onExited,e.nodeRef,(0,n.Z)(e,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return o.createElement(u.Z.Provider,{value:null},"function"==typeof i?i(t,r):o.cloneElement(o.Children.only(i),r))},e}(o.Component);function y(){}v.contextType=u.Z,v.propTypes={},v.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:y,onEntering:y,onEntered:y,onExit:y,onExiting:y,onExited:y},v.UNMOUNTED=c,v.EXITED=p,v.ENTERING=g,v.ENTERED=f,v.EXITING=m;var _=function(t,e){return t&&e&&e.split(" ").forEach(function(e){var i,r;return i=t,r=e,void(i.classList?i.classList.remove(r):"string"==typeof i.className?i.className=a(i.className,r):i.setAttribute("class",a(i.className&&i.className.baseVal||"",r)))})},b=function(t){function e(){for(var e,i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},e.onEnter=function(t,i){var r=e.resolveArguments(t,i),n=r[0],s=r[1];e.removeClasses(n,"exit"),e.addClass(n,s?"appear":"enter","base"),e.props.onEnter&&e.props.onEnter(t,i)},e.onEntering=function(t,i){var r=e.resolveArguments(t,i),n=r[0],s=r[1];e.addClass(n,s?"appear":"enter","active"),e.props.onEntering&&e.props.onEntering(t,i)},e.onEntered=function(t,i){var r=e.resolveArguments(t,i),n=r[0],s=r[1]?"appear":"enter";e.removeClasses(n,s),e.addClass(n,s,"done"),e.props.onEntered&&e.props.onEntered(t,i)},e.onExit=function(t){var i=e.resolveArguments(t)[0];e.removeClasses(i,"appear"),e.removeClasses(i,"enter"),e.addClass(i,"exit","base"),e.props.onExit&&e.props.onExit(t)},e.onExiting=function(t){var i=e.resolveArguments(t)[0];e.addClass(i,"exit","active"),e.props.onExiting&&e.props.onExiting(t)},e.onExited=function(t){var i=e.resolveArguments(t)[0];e.removeClasses(i,"exit"),e.addClass(i,"exit","done"),e.props.onExited&&e.props.onExited(t)},e.resolveArguments=function(t,i){return e.props.nodeRef?[e.props.nodeRef.current,t]:[t,i]},e.getClassNames=function(t){var i=e.props.classNames,r="string"==typeof i,n=r&&i?i+"-":"",s=r?""+n+t:i[t],a=r?s+"-active":i[t+"Active"],o=r?s+"-done":i[t+"Done"];return{baseClassName:s,activeClassName:a,doneClassName:o}},e}(0,s.Z)(e,t);var i=e.prototype;return i.addClass=function(t,e,i){var r,n,s=this.getClassNames(e)[i+"ClassName"],a=this.getClassNames("enter").doneClassName;if("appear"===e&&"done"===i&&a&&(s+=" "+a),"active"===i&&t&&d(t),s){;this.appliedClasses[e][i]=s,r=t,n=s,r&&n&&n.split(" ").forEach(function(t){return function(t,e){if(t.classList)t.classList.add(e);else{var i,r;if(i=t,r=e,i.classList?!(!!r&&i.classList.contains(r)):-1===(" "+(i.className.baseVal||i.className)+" ").indexOf(" "+r+" "))"string"==typeof t.className?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e)}}(r,t)})}},i.removeClasses=function(t,e){var i=this.appliedClasses[e],r=i.base,n=i.active,s=i.done;this.appliedClasses[e]={},r&&_(t,r),n&&_(t,n),s&&_(t,s)},i.render=function(){var t=this.props,e=(t.classNames,(0,n.Z)(t,["classNames"]));return o.createElement(v,(0,r.Z)({},e,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},e}(o.Component);b.defaultProps={classNames:""},b.propTypes={};let x=b},6693:function(t,e,i){"use strict";i.d(e,{Z:function(){return r}});let r=i(4194).createContext(null)},759:function(t,e,i){"use strict";i.d(e,{Z:function(){return S}});var r=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var i=-1;return t.some(function(t,r){return t[0]===e&&(i=r,!0)}),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),r=this.__entries__[i];return r&&r[1]},e.prototype.set=function(e,i){var r=t(this.__entries__,e);~r?this.__entries__[r][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,r=t(i,e);~r&&i.splice(r,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,r=this.__entries__;i<r.length;i++){var n=r[i];t.call(e,n[1],n[0])}},e}()}(),n="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,s=void 0!==i.g&&i.g.Math===Math?i.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(s):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)},o=["top","right","bottom","left","width","height","size","weight"],l="undefined"!=typeof MutationObserver,h=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,r=!1,n=0;function s(){i&&(i=!1,t()),r&&l()}function o(){a(s)}function l(){var t=Date.now();if(i){if(t-n<2)return;r=!0}else i=!0,r=!1,setTimeout(o,20);n=t}return l}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){!~this.observers_.indexOf(t)&&this.observers_.push(t),!this.connected_&&this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return t.forEach(function(t){return t.broadcastActive()}),t.length>0},t.prototype.connect_=function(){if(!!n&&!this.connected_)document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),l?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0},t.prototype.disconnect_=function(){if(!!n&&!!this.connected_)document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;o.some(function(t){return!!~i.indexOf(t)})&&this.refresh()},t.getInstance=function(){return!this.instance_&&(this.instance_=new t),this.instance_},t.instance_=null,t}(),u=function(t,e){for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];Object.defineProperty(t,n,{value:e[n],enumerable:!1,writable:!1,configurable:!0})}return t},d=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||s},c=m(0,0,0,0);function p(t){return parseFloat(t)||0}function g(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduce(function(e,i){return e+p(t["border-"+i+"-width"])},0)}var f="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof d(t).SVGGraphicsElement}:function(t){return t instanceof d(t).SVGElement&&"function"==typeof t.getBBox};function m(t,e,i,r){return{x:t,y:e,width:i,height:r}}var v=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=m(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=function(t){if(!n)return c;if(f(t)){var e;return m(0,0,(e=t.getBBox()).width,e.height)}return function(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return c;var r=d(t).getComputedStyle(t),n=function(t){for(var e={},i=0,r=["top","right","bottom","left"];i<r.length;i++){var n=r[i],s=t["padding-"+n];e[n]=p(s)}return e}(r),s=n.left+n.right,a=n.top+n.bottom,o=p(r.width),l=p(r.height);if("border-box"===r.boxSizing&&(Math.round(o+s)!==e&&(o-=g(r,"left","right")+s),Math.round(l+a)!==i&&(l-=g(r,"top","bottom")+a)),!function(t){return t===d(t).document.documentElement}(t)){var h=Math.round(o+s)-e,u=Math.round(l+a)-i;1!==Math.abs(h)&&(o-=h),1!==Math.abs(u)&&(l-=u)}return m(n.left,n.top,o,l)}(t)}(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),y=function(t,e){var i,r,n,s,a,o,l=(r=(i=e).x,n=i.y,s=i.width,a=i.height,u(o=Object.create(("undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object).prototype),{x:r,y:n,width:s,height:a,top:n,right:r+s,bottom:a+n,left:r}),o);u(this,{target:t,contentRect:l})},_=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new r,"function"!=typeof t)throw TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw TypeError("1 argument required, but only 0 present.");if("undefined"==typeof Element||!(Element instanceof Object))return;if(!(t instanceof d(t).Element))throw TypeError('parameter 1 is not of type "Element".');var e=this.observations_;if(!e.has(t))e.set(t,new v(t)),this.controller_.addObserver(this),this.controller_.refresh()},t.prototype.unobserve=function(t){if(!arguments.length)throw TypeError("1 argument required, but only 0 present.");if("undefined"==typeof Element||!(Element instanceof Object))return;if(!(t instanceof d(t).Element))throw TypeError('parameter 1 is not of type "Element".');var e=this.observations_;if(!!e.has(t))e.delete(t),!e.size&&this.controller_.removeObserver(this)},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(e){e.isActive()&&t.activeObservations_.push(e)})},t.prototype.broadcastActive=function(){if(!!this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map(function(t){return new y(t.target,t.broadcastRect())});this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),b="undefined"!=typeof WeakMap?new WeakMap:new r,x=function t(e){if(!(this instanceof t))throw TypeError("Cannot call a class as a function.");if(!arguments.length)throw TypeError("1 argument required, but only 0 present.");var i=new _(e,h.getInstance(),this);b.set(this,i)};["observe","unobserve","disconnect"].forEach(function(t){x.prototype[t]=function(){var e;return(e=b.get(this))[t].apply(e,arguments)}});let S=void 0!==s.ResizeObserver?s.ResizeObserver:x},939:function(t,e,i){var r=i(5666);function n(e,i){var r=e.geometry,n=r.type;if("LineString"===n)r.coordinates=t.exports.simplify(r.coordinates,i);else if("Polygon"===n||"MultiLineString"===n)for(var s=0;s<r.coordinates.length;s++)r.coordinates[s]=t.exports.simplify(r.coordinates[s],i);else if("MultiPolygon"===n)for(var a=0;a<r.coordinates.length;a++)for(var o=0;o<r.coordinates[a].length;o++)r.coordinates[a][o]=t.exports.simplify(r.coordinates[a][o],i);return e}t.exports=function(t,e,i){return(!i&&(t=JSON.parse(JSON.stringify(t))),t.features)?function(t,e){for(var i=0;i<t.features.length;i++)t.features[i]=n(t.features[i],e);return t}(t,e):t.type&&"Feature"===t.type?n(t,e):Error("FeatureCollection or individual Feature required")},t.exports.simplify=function(t,e){return r(t,e)}},5666:function(t,e,i){var r=i(5549),n=function(t,e){for(var i=0,s=0,a=1;a<=t.length-2;a++){var o=new r(t[0],t[t.length-1]).perpendicularDistance(t[a]);o>i&&(s=a,i=o)}if(i>e){var l=n(t.slice(0,s),e),h=n(t.slice(s,t.length),e),u=l.concat(h)}else u=t.length>1?[t[0],t[t.length-1]]:[t[0]];return u};t.exports=n},5549:function(t){var e=function(t,e){this.p1=t,this.p2=e};e.prototype.rise=function(){return this.p2[1]-this.p1[1]},e.prototype.run=function(){return this.p2[0]-this.p1[0]},e.prototype.slope=function(){return this.rise()/this.run()},e.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},e.prototype.isVertical=function(){return!isFinite(this.slope())},e.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},e.prototype._perpendicularDistanceHorizontal=function(t){return Math.abs(this.p1[1]-t[1])},e.prototype._perpendicularDistanceVertical=function(t){return Math.abs(this.p1[0]-t[0])},e.prototype._perpendicularDistanceHasSlope=function(t){var e=this.slope(),i=this.yIntercept();return Math.abs(e*t[0]-t[1]+i)/Math.sqrt(Math.pow(e,2)+1)},e.prototype.perpendicularDistance=function(t){return this.isVertical()?this._perpendicularDistanceVertical(t):this.isHorizontal()?this._perpendicularDistanceHorizontal(t):this._perpendicularDistanceHasSlope(t)},t.exports=e},3005:function(t,e,i){"use strict";var r=i(4194),n="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},s=r.useState,a=r.useEffect,o=r.useLayoutEffect,l=r.useDebugValue;function h(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!n(t,i)}catch(t){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var i=e(),r=s({inst:{value:i,getSnapshot:e}}),n=r[0].inst,u=r[1];return o(function(){n.value=i,n.getSnapshot=e,h(n)&&u({inst:n})},[t,i,e]),a(function(){return h(n)&&u({inst:n}),t(function(){h(n)&&u({inst:n})})},[t]),l(i),i};e.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},9312:function(t,e,i){"use strict";var r=i(4194),n=i(8218),s="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},a=n.useSyncExternalStore,o=r.useRef,l=r.useEffect,h=r.useMemo,u=r.useDebugValue;e.useSyncExternalStoreWithSelector=function(t,e,i,r,n){var d=o(null);if(null===d.current){var c={hasValue:!1,value:null};d.current=c}else c=d.current;var p=a(t,(d=h(function(){function t(t){if(!l){if(l=!0,a=t,t=r(t),void 0!==n&&c.hasValue){var e=c.value;if(n(e,t))return o=e}return o=t}if(e=o,s(a,t))return e;var i=r(t);return void 0!==n&&n(e,i)?e:(a=t,o=i)}var a,o,l=!1,h=void 0===i?null:i;return[function(){return t(e())},null===h?void 0:function(){return t(h())}]},[e,i,r,n]))[0],d[1]);return l(function(){c.hasValue=!0,c.value=p},[p]),u(p),p}},8218:function(t,e,i){"use strict";t.exports=i(3005)},7591:function(t,e,i){"use strict";t.exports=i(9312)},3229:function(t){t.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},8336:function(t,e,i){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}i.d(e,{Z:()=>n});function n(t,e,i){var n;return(n=function(t,e){if("object"!=r(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=r(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"),(e="symbol"==r(n)?n:n+"")in t)?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},9933:function(t,e,i){"use strict";function r(){return(r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)({}).hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}).apply(null,arguments)}i.d(e,{Z:function(){return r}})},510:function(t,e,i){"use strict";function r(t,e){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r(t,e)}i.d(e,{Z:()=>n})},6293:function(t,e,i){"use strict";function r(t,e){if(null==t)return{};var i={};for(var r in t)if(({}).hasOwnProperty.call(t,r)){if(e.includes(r))continue;i[r]=t[r]}return i}i.d(e,{Z:function(){return r}})},3007:function(t,e,i){"use strict";i.d(e,{ML:()=>X,Ik:()=>Y});function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function n(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach(function(e){var r,n,s;r=t,n=e,s=i[e],n in r?Object.defineProperty(r,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach(function(e){var r,n,s;r=t,n=e,s=i[e],n in r?Object.defineProperty(r,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function l(t){return function e(){for(var i=this,r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];return n.length>=t.length?t.apply(this,n):function(){for(var t=arguments.length,r=Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.apply(i,[].concat(n,r))}}}function h(t){return({}).toString.call(t).includes("Object")}function u(t){return"function"==typeof t}var d,c,p,g=l(function(t,e){throw Error(t[e]||t.default)})({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),f=function(t,e){return!h(e)&&g("changeType"),Object.keys(e).some(function(e){var i,r;return i=t,r=e,!Object.prototype.hasOwnProperty.call(i,r)})&&g("changeField"),e},m=function(t){!u(t)&&g("selectorType")},v=function(t){!(u(t)||h(t))&&g("handlerType"),h(t)&&Object.values(t).some(function(t){return!u(t)})&&g("handlersType")},y=function(t){if(!t&&g("initialIsRequired"),!h(t)&&g("initialType"),!Object.keys(t).length)g("initialContent")};function _(t,e){return u(e)?e(t.current):e}function b(t,e){return t.current=o(o({},t.current),e),e}function x(t,e,i){return u(e)?e(t.current):Object.keys(i).forEach(function(i){var r;return null===(r=e[i])||void 0===r?void 0:r.call(e,t.current[i])}),i}var S={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "};var k=(d=function(t,e){throw Error(t[e]||t.default)},function t(){for(var e=this,i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];return r.length>=d.length?d.apply(this,r):function(){for(var i=arguments.length,n=Array(i),s=0;s<i;s++)n[s]=arguments[s];return t.apply(e,[].concat(r,n))}})(S);let A=function(t){var e;if(!t&&k("configIsRequired"),e=t,!({}).toString.call(e).includes("Object"))k("configType");return t.urls?(function(){console.warn(S.deprecation)}(),{paths:{vs:t.urls.monacoBase}}):t},w=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(t){return e.reduceRight(function(t,e){return e(t)},t)}};var M={type:"cancelation",msg:"operation is manually canceled"};let C=function(t){var e=!1,i=new Promise(function(i,r){t.then(function(t){return e?r(M):i(t)}),t.catch(r)});return i.cancel=function(){return e=!0},i};var T=(p=2,function(t){if(Array.isArray(t))return t}(c=({create:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y(t),v(e);var i={current:t},r=l(x)(i,e),n=l(b)(i),s=l(f)(t),a=l(_)(i);return[function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(t){return t};return m(t),t(i.current)},function(t){(function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(t){return e.reduceRight(function(t,e){return e(t)},t)}})(r,n,s,a)(t)}]}}).create({config:{paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}},isInitialized:!1,resolve:null,reject:null,monaco:null}))||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],r=!0,n=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(r=(a=o.next()).done)&&(i.push(a.value),!e||i.length!==e);r=!0);}catch(t){n=!0,s=t}finally{try{!r&&null!=o.return&&o.return()}finally{if(n)throw s}}return i}}(c,2)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return s(t,e)}}(c,p)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),E=T[0],O=T[1];function P(t){return document.body.appendChild(t)}function R(t){var e,i,r=E(function(t){return{config:t.config,reject:t.reject}});var n=(e="".concat(r.config.paths.vs,"/loader.js"),i=document.createElement("script"),e&&(i.src=e),i);return n.onload=function(){return t()},n.onerror=r.reject,n}function B(){var t=E(function(t){return{config:t.config,resolve:t.resolve,reject:t.reject}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(e){I(e),t.resolve(e)},function(e){t.reject(e)})}function I(t){!E().monaco&&O({monaco:t})}var L=new Promise(function(t,e){return O({resolve:t,reject:e})});let D={init:function(){var t=E(function(t){return{monaco:t.monaco,isInitialized:t.isInitialized,resolve:t.resolve}});if(!t.isInitialized){if(O({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),C(L);if(window.monaco&&window.monaco.editor)return I(window.monaco),t.resolve(window.monaco),C(L);w(P,R)(B)}return C(L)},__getMonacoInstance:function(){return E(function(t){return t.monaco})}};var F=i("4194"),j={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},N={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},z=function({children:t}){return F.createElement("div",{style:N},t)},H=(0,F.memo)(function({width:t,height:e,isEditorReady:i,loading:r,_ref:n,className:s,wrapperProps:a}){return F.createElement("section",{style:{...j.wrapper,width:t,height:e},...a},!i&&F.createElement(z,null,r),F.createElement("div",{ref:n,style:{...j.fullWidth,...!i&&j.hide},className:s}))}),V=function(t){(0,F.useEffect)(t,[])},W=function(t,e,i=!0){let r=(0,F.useRef)(!0);(0,F.useEffect)(r.current||!i?()=>{r.current=!1}:t,e)};function G(){}function U(t,e,i,r){return function(t,e){return t.editor.getModel($(t,e))}(t,r)||function(t,e,i,r){return t.editor.createModel(e,i,r?$(t,r):void 0)}(t,e,i,r)}function $(t,e){return t.Uri.parse(e)}(0,F.memo)(function({original:t,modified:e,language:i,originalLanguage:r,modifiedLanguage:n,originalModelPath:s,modifiedModelPath:a,keepCurrentOriginalModel:o=!1,keepCurrentModifiedModel:l=!1,theme:h="light",loading:u="Loading...",options:d={},height:c="100%",width:p="100%",className:g,wrapperProps:f={},beforeMount:m=G,onMount:v=G}){let[y,_]=(0,F.useState)(!1),[b,x]=(0,F.useState)(!0),S=(0,F.useRef)(null),k=(0,F.useRef)(null),A=(0,F.useRef)(null),w=(0,F.useRef)(v),M=(0,F.useRef)(m),C=(0,F.useRef)(!1);V(()=>{let t=D.init();return t.then(t=>(k.current=t)&&x(!1)).catch(t=>t?.type!=="cancelation"&&console.error("Monaco initialization: error:",t)),()=>S.current?function(){let t=S.current?.getModel();o||t?.original?.dispose(),l||t?.modified?.dispose(),S.current?.dispose()}():t.cancel()}),W(()=>{if(S.current&&k.current){let e=S.current.getOriginalEditor(),n=U(k.current,t||"",r||i||"text",s||"");n!==e.getModel()&&e.setModel(n)}},[s],y),W(()=>{if(S.current&&k.current){let t=S.current.getModifiedEditor(),r=U(k.current,e||"",n||i||"text",a||"");r!==t.getModel()&&t.setModel(r)}},[a],y),W(()=>{let t=S.current.getModifiedEditor();t.getOption(k.current.editor.EditorOption.readOnly)?t.setValue(e||""):e!==t.getValue()&&(t.executeEdits("",[{range:t.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),t.pushUndoStop())},[e],y),W(()=>{S.current?.getModel()?.original.setValue(t||"")},[t],y),W(()=>{let{original:t,modified:e}=S.current.getModel();k.current.editor.setModelLanguage(t,r||i||"text"),k.current.editor.setModelLanguage(e,n||i||"text")},[i,r,n],y),W(()=>{k.current?.editor.setTheme(h)},[h],y),W(()=>{S.current?.updateOptions(d)},[d],y);let T=(0,F.useCallback)(()=>{if(!k.current)return;M.current(k.current);let o=U(k.current,t||"",r||i||"text",s||""),l=U(k.current,e||"",n||i||"text",a||"");S.current?.setModel({original:o,modified:l})},[i,e,n,t,r,s,a]),E=(0,F.useCallback)(()=>{!C.current&&A.current&&(S.current=k.current.editor.createDiffEditor(A.current,{automaticLayout:!0,...d}),T(),k.current?.editor.setTheme(h),_(!0),C.current=!0)},[d,h,T]);return(0,F.useEffect)(()=>{y&&w.current(S.current,k.current)},[y]),(0,F.useEffect)(()=>{b||y||E()},[b,y,E]),F.createElement(H,{width:p,height:c,isEditorReady:y,loading:u,_ref:A,className:g,wrapperProps:f})});var Y=function(){let[t,e]=(0,F.useState)(D.__getMonacoInstance());return V(()=>{let i;return t||(i=D.init()).then(t=>{e(t)}),()=>i?.cancel()}),t},K=function(t){let e=(0,F.useRef)();return(0,F.useEffect)(()=>{e.current=t},[t]),e.current},Z=new Map,X=(0,F.memo)(function({defaultValue:t,defaultLanguage:e,defaultPath:i,value:r,language:n,path:s,theme:a="light",line:o,loading:l="Loading...",options:h={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:c=!1,width:p="100%",height:g="100%",className:f,wrapperProps:m={},beforeMount:v=G,onMount:y=G,onChange:_,onValidate:b=G}){let[x,S]=(0,F.useState)(!1),[k,A]=(0,F.useState)(!0),w=(0,F.useRef)(null),M=(0,F.useRef)(null),C=(0,F.useRef)(null),T=(0,F.useRef)(y),E=(0,F.useRef)(v),O=(0,F.useRef)(),P=(0,F.useRef)(r),R=K(s),B=(0,F.useRef)(!1),I=(0,F.useRef)(!1);V(()=>{let t=D.init();return t.then(t=>(w.current=t)&&A(!1)).catch(t=>t?.type!=="cancelation"&&console.error("Monaco initialization: error:",t)),()=>M.current?function(){O.current?.dispose(),c?d&&Z.set(s,M.current.saveViewState()):M.current.getModel()?.dispose(),M.current.dispose()}():t.cancel()}),W(()=>{let a=U(w.current,t||r||"",e||n||"",s||i||"");a!==M.current?.getModel()&&(d&&Z.set(R,M.current?.saveViewState()),M.current?.setModel(a),d&&M.current?.restoreViewState(Z.get(s)))},[s],x),W(()=>{M.current?.updateOptions(h)},[h],x),W(()=>{M.current&&void 0!==r&&(M.current.getOption(w.current.editor.EditorOption.readOnly)?M.current.setValue(r):r===M.current.getValue()||(I.current=!0,M.current.executeEdits("",[{range:M.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),M.current.pushUndoStop(),I.current=!1))},[r],x),W(()=>{let t=M.current?.getModel();t&&n&&w.current?.editor.setModelLanguage(t,n)},[n],x),W(()=>{void 0!==o&&M.current?.revealLine(o)},[o],x),W(()=>{w.current?.editor.setTheme(a)},[a],x);let L=(0,F.useCallback)(()=>{if(!(!C.current||!w.current)&&!B.current){E.current(w.current);let l=s||i,c=U(w.current,r||t||"",e||n||"",l||"");M.current=w.current?.editor.create(C.current,{model:c,automaticLayout:!0,...h},u),d&&M.current.restoreViewState(Z.get(l)),w.current.editor.setTheme(a),void 0!==o&&M.current.revealLine(o),S(!0),B.current=!0}},[t,e,i,r,n,s,h,u,d,a,o]);return(0,F.useEffect)(()=>{x&&T.current(M.current,w.current)},[x]),(0,F.useEffect)(()=>{k||x||L()},[k,x,L]),P.current=r,(0,F.useEffect)(()=>{x&&_&&(O.current?.dispose(),O.current=M.current?.onDidChangeModelContent(t=>{I.current||_(M.current.getValue(),t)}))},[x,_]),(0,F.useEffect)(()=>{if(x){let t=w.current.editor.onDidChangeMarkers(t=>{let e=M.current.getModel()?.uri;if(e&&t.find(t=>t.path===e.path)){let t=w.current.editor.getModelMarkers({resource:e});b?.(t)}});return()=>{t?.dispose()}}return()=>{}},[x,b]),F.createElement(H,{width:p,height:g,isEditorReady:x,loading:l,_ref:C,className:f,wrapperProps:m})})},1913:function(t,e,i){"use strict";function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{_:function(){return r}})},9078:function(t,e,i){"use strict";i.d(e,{ZP:function(){return H}});let r={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console&&console[t]&&console[t].apply(console,e)}};class n{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(t,e)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||r,this.options=e,this.debug=e.debug}log(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"log","",!0)}warn(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"warn","",!0)}error(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"error","")}deprecate(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,i,r){return r&&!this.debug?null:("string"==typeof t[0]&&(t[0]=`${i}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new n(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new n(this.logger,t)}}var s=new n;class a{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach(t=>{!this.observers[t]&&(this.observers[t]=new Map);let i=this.observers[t].get(e)||0;this.observers[t].set(e,i+1)}),this}off(t,e){if(this.observers[t]){if(!e){delete this.observers[t];return}this.observers[t].delete(e)}}emit(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(t=>{let[e,r]=t;for(let t=0;t<r;t++)e(...i)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(e=>{let[r,n]=e;for(let e=0;e<n;e++)r.apply(r,[t,...i])})}}function o(){let t,e;let i=new Promise((i,r)=>{t=i,e=r});return i.resolve=t,i.reject=e,i}function l(t){return null==t?"":""+t}let h=/###/g;function u(t,e,i){function r(t){return t&&t.indexOf("###")>-1?t.replace(h,"."):t}function n(){return!t||"string"==typeof t}let s="string"!=typeof e?e:e.split("."),a=0;for(;a<s.length-1;){if(n())return{};let e=r(s[a]);!t[e]&&i&&(t[e]=new i),t=Object.prototype.hasOwnProperty.call(t,e)?t[e]:{},++a}return n()?{}:{obj:t,k:r(s[a])}}function d(t,e,i){let{obj:r,k:n}=u(t,e,Object);if(void 0!==r||1===e.length){r[n]=i;return}let s=e[e.length-1],a=e.slice(0,e.length-1),o=u(t,a,Object);for(;void 0===o.obj&&a.length;)s=`${a[a.length-1]}.${s}`,(o=u(t,a=a.slice(0,a.length-1),Object))&&o.obj&&void 0!==o.obj[`${o.k}.${s}`]&&(o.obj=void 0);o.obj[`${o.k}.${s}`]=i}function c(t,e){let{obj:i,k:r}=u(t,e);if(i)return i[r]}function p(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function f(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,t=>g[t]):t}let m=[" ",",","?","!",";"],v=new class t{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){let e=this.regExpMap.get(t);if(void 0!==e)return e;let i=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,i),this.regExpQueue.push(t),i}}(20);function y(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!t)return;if(t[e])return t[e];let r=e.split(i),n=t;for(let t=0;t<r.length;){let e;if(!n||"object"!=typeof n)return;let s="";for(let a=t;a<r.length;++a)if(a!==t&&(s+=i),s+=r[a],void 0!==(e=n[s])){if(["string","number","boolean"].indexOf(typeof e)>-1&&a<r.length-1)continue;t+=a-t+1;break}n=e}return n}function _(t){return t&&t.indexOf("_")>0?t.replace("_","-"):t}class b extends a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){0>this.options.ns.indexOf(t)&&this.options.ns.push(t)}removeNamespaces(t){let e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,i){let r,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,a=void 0!==n.ignoreJSONStructure?n.ignoreJSONStructure:this.options.ignoreJSONStructure;t.indexOf(".")>-1?r=t.split("."):(r=[t,e],i&&(Array.isArray(i)?r.push(...i):"string"==typeof i&&s?r.push(...i.split(s)):r.push(i)));let o=c(this.data,r);return(!o&&!e&&!i&&t.indexOf(".")>-1&&(t=r[0],e=r[1],i=r.slice(2).join(".")),o||!a||"string"!=typeof i)?o:y(this.data&&this.data[t]&&this.data[t][e],i,s)}addResource(t,e,i,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},s=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,a=[t,e];i&&(a=a.concat(s?i.split(s):i)),t.indexOf(".")>-1&&(a=t.split("."),r=e,e=a[1]),this.addNamespaces(e),d(this.data,a,r),!n.silent&&this.emit("added",t,e,i,r)}addResources(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(let r in i)("string"==typeof i[r]||Array.isArray(i[r]))&&this.addResource(t,e,r,i[r],{silent:!0});!r.silent&&this.emit("added",t,e,i)}addResourceBundle(t,e,i,r,n){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},a=[t,e];t.indexOf(".")>-1&&(a=t.split("."),r=i,i=e,e=a[1]),this.addNamespaces(e);let o=c(this.data,a)||{};!s.skipCopy&&(i=JSON.parse(JSON.stringify(i))),r?!function t(e,i,r){for(let n in i)"__proto__"!==n&&"constructor"!==n&&(n in e?"string"==typeof e[n]||e[n]instanceof String||"string"==typeof i[n]||i[n]instanceof String?r&&(e[n]=i[n]):t(e[n],i[n],r):e[n]=i[n]);return e}(o,i,n):o={...o,...i},d(this.data,a,o),!s.silent&&this.emit("added",t,e,i)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return void 0!==this.getResource(t,e)}getResourceBundle(t,e){return(!e&&(e=this.options.defaultNS),"v1"===this.options.compatibilityAPI)?{...this.getResource(t,e)}:this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){let e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find(t=>e[t]&&Object.keys(e[t]).length>0)}toJSON(){return this.data}}var x={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,i,r,n){return t.forEach(t=>{this.processors[t]&&(e=this.processors[t].process(e,i,r,n))}),e}};let S={};class k extends a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),!function(t,e,i){t.forEach(t=>{e[t]&&(i[t]=e[t])})}(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=s.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==t)return!1;let i=this.resolve(t,e);return i&&void 0!==i.res}extractFromKey(t,e){let i=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===i&&(i=":");let r=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,n=e.ns||this.options.defaultNS||[],s=i&&t.indexOf(i)>-1,a=!this.options.userDefinedKeySeparator&&!e.keySeparator&&!this.options.userDefinedNsSeparator&&!e.nsSeparator&&!function(t,e,i){e=e||"",i=i||"";let r=m.filter(t=>0>e.indexOf(t)&&0>i.indexOf(t));if(0===r.length)return!0;let n=v.getRegExp(`(${r.map(t=>"?"===t?"\\?":t).join("|")})`),s=!n.test(t);if(!s){let e=t.indexOf(i);e>0&&!n.test(t.substring(0,e))&&(s=!0)}return s}(t,i,r);if(s&&!a){let e=t.match(this.interpolator.nestingRegexp);if(e&&e.length>0)return{key:t,namespaces:n};let s=t.split(i);(i!==r||i===r&&this.options.ns.indexOf(s[0])>-1)&&(n=s.shift()),t=s.join(r)}return"string"==typeof n&&(n=[n]),{key:t,namespaces:n}}translate(t,e,i){if("object"!=typeof e&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof e&&(e={...e}),!e&&(e={}),null==t)return"";!Array.isArray(t)&&(t=[String(t)]);let r=void 0!==e.returnDetails?e.returnDetails:this.options.returnDetails,n=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,{key:s,namespaces:a}=this.extractFromKey(t[t.length-1],e),o=a[a.length-1],l=e.lng||this.language,h=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(l&&"cimode"===l.toLowerCase()){if(h){let t=e.nsSeparator||this.options.nsSeparator;return r?{res:`${o}${t}${s}`,usedKey:s,exactUsedKey:s,usedLng:l,usedNS:o,usedParams:this.getUsedParamsDetails(e)}:`${o}${t}${s}`}return r?{res:s,usedKey:s,exactUsedKey:s,usedLng:l,usedNS:o,usedParams:this.getUsedParamsDetails(e)}:s}let u=this.resolve(t,e),d=u&&u.res,c=u&&u.usedKey||s,p=u&&u.exactUsedKey||s,g=Object.prototype.toString.apply(d),f=void 0!==e.joinArrays?e.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject,v="string"!=typeof d&&"boolean"!=typeof d&&"number"!=typeof d;if(m&&d&&v&&0>["[object Number]","[object Function]","[object RegExp]"].indexOf(g)&&!("string"==typeof f&&Array.isArray(d))){if(!e.returnObjects&&!this.options.returnObjects){!this.options.returnedObjectHandler&&this.logger.warn("accessing an object - but returnObjects options is not enabled!");let t=this.options.returnedObjectHandler?this.options.returnedObjectHandler(c,d,{...e,ns:a}):`key '${s} (${this.language})' returned an object instead of string.`;return r?(u.res=t,u.usedParams=this.getUsedParamsDetails(e),u):t}if(n){let t=Array.isArray(d),i=t?[]:{},r=t?p:c;for(let t in d)if(Object.prototype.hasOwnProperty.call(d,t)){let s=`${r}${n}${t}`;i[t]=this.translate(s,{...e,joinArrays:!1,ns:a}),i[t]===s&&(i[t]=d[t])}d=i}}else if(m&&"string"==typeof f&&Array.isArray(d))(d=d.join(f))&&(d=this.extendTranslation(d,t,e,i));else{let r=!1,a=!1,h=void 0!==e.count&&"string"!=typeof e.count,c=k.hasDefaultValue(e),p=h?this.pluralResolver.getSuffix(l,e.count,e):"",g=e.ordinal&&h?this.pluralResolver.getSuffix(l,e.count,{ordinal:!1}):"",f=h&&!e.ordinal&&0===e.count&&this.pluralResolver.shouldUseIntlApi(),m=f&&e[`defaultValue${this.options.pluralSeparator}zero`]||e[`defaultValue${p}`]||e[`defaultValue${g}`]||e.defaultValue;!this.isValidLookup(d)&&c&&(r=!0,d=m),!this.isValidLookup(d)&&(a=!0,d=s);let v=(e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&a?void 0:d,y=c&&m!==d&&this.options.updateMissing;if(a||r||y){if(this.logger.log(y?"updateKey":"missingKey",l,o,s,y?m:d),n){let t=this.resolve(s,{...e,keySeparator:!1});t&&t.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let t=[],i=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if("fallback"===this.options.saveMissingTo&&i&&i[0])for(let e=0;e<i.length;e++)t.push(i[e]);else"all"===this.options.saveMissingTo?t=this.languageUtils.toResolveHierarchy(e.lng||this.language):t.push(e.lng||this.language);let r=(t,i,r)=>{let n=c&&r!==d?r:v;this.options.missingKeyHandler?this.options.missingKeyHandler(t,o,i,n,y,e):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(t,o,i,n,y,e),this.emit("missingKey",t,o,i,d)};this.options.saveMissing&&(this.options.saveMissingPlurals&&h?t.forEach(t=>{let i=this.pluralResolver.getSuffixes(t,e);f&&e[`defaultValue${this.options.pluralSeparator}zero`]&&0>i.indexOf(`${this.options.pluralSeparator}zero`)&&i.push(`${this.options.pluralSeparator}zero`),i.forEach(i=>{r([t],s+i,e[`defaultValue${i}`]||m)})}):r(t,s,m))}d=this.extendTranslation(d,t,e,u,i),a&&d===s&&this.options.appendNamespaceToMissingKey&&(d=`${o}:${s}`),(a||r)&&this.options.parseMissingKeyHandler&&(d="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${o}:${s}`:s,r?d:void 0):this.options.parseMissingKeyHandler(d))}return r?(u.res=d,u.usedParams=this.getUsedParamsDetails(e),u):d}extendTranslation(t,e,i,r,n){var s=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!i.skipInterpolation){let a;i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});let o="string"==typeof t&&(i&&i.interpolation&&void 0!==i.interpolation.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(o){let e=t.match(this.interpolator.nestingRegexp);a=e&&e.length}let l=i.replace&&"string"!=typeof i.replace?i.replace:i;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),t=this.interpolator.interpolate(t,l,i.lng||this.language||r.usedLng,i),o){let e=t.match(this.interpolator.nestingRegexp);a<(e&&e.length)&&(i.nest=!1)}!i.lng&&"v1"!==this.options.compatibilityAPI&&r&&r.res&&(i.lng=this.language||r.usedLng),!1!==i.nest&&(t=this.interpolator.nest(t,function(){for(var t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];return n&&n[0]===r[0]&&!i.context?(s.logger.warn(`It seems you are nesting recursively key: ${r[0]} in key: ${e[0]}`),null):s.translate(...r,e)},i)),i.interpolation&&this.interpolator.reset()}let a=i.postProcess||this.options.postProcess,o="string"==typeof a?[a]:a;return null!=t&&o&&o.length&&!1!==i.applyPostProcessor&&(t=x.handle(o,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),t}resolve(t){let e,i,r,n,s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof t&&(t=[t]),t.forEach(t=>{if(this.isValidLookup(e))return;let o=this.extractFromKey(t,a),l=o.key;i=l;let h=o.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));let u=void 0!==a.count&&"string"!=typeof a.count,d=u&&!a.ordinal&&0===a.count&&this.pluralResolver.shouldUseIntlApi(),c=void 0!==a.context&&("string"==typeof a.context||"number"==typeof a.context)&&""!==a.context,p=a.lngs?a.lngs:this.languageUtils.toResolveHierarchy(a.lng||this.language,a.fallbackLng);h.forEach(t=>{!this.isValidLookup(e)&&(s=t,!S[`${p[0]}-${t}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(s)&&(S[`${p[0]}-${t}`]=!0,this.logger.warn(`key "${i}" for languages "${p.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(i=>{let s;if(this.isValidLookup(e))return;n=i;let o=[l];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(o,l,i,t,a);else{let t;u&&(t=this.pluralResolver.getSuffix(i,a.count,a));let e=`${this.options.pluralSeparator}zero`,r=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(u&&(o.push(l+t),a.ordinal&&0===t.indexOf(r)&&o.push(l+t.replace(r,this.options.pluralSeparator)),d&&o.push(l+e)),c){let i=`${l}${this.options.contextSeparator}${a.context}`;o.push(i),u&&(o.push(i+t),a.ordinal&&0===t.indexOf(r)&&o.push(i+t.replace(r,this.options.pluralSeparator)),d&&o.push(i+e))}}for(;s=o.pop();)!this.isValidLookup(e)&&(r=s,e=this.getResource(i,t,s,a))}))})}),{res:e,usedKey:i,exactUsedKey:r,usedLng:n,usedNS:s}}isValidLookup(t){return void 0!==t&&!(!this.options.returnNull&&null===t)&&!(!this.options.returnEmptyString&&""===t)}getResource(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,e,i,r):this.resourceStore.getResource(t,e,i,r)}getUsedParamsDetails(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.replace&&"string"!=typeof t.replace,i=e?t.replace:t;if(e&&void 0!==t.count&&(i.count=t.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!e)for(let t of(i={...i},["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"]))delete i[t];return i}static hasDefaultValue(t){let e="defaultValue";for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e===i.substring(0,e.length)&&void 0!==t[i])return!0;return!1}}function A(t){return t.charAt(0).toUpperCase()+t.slice(1)}class w{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=s.create("languageUtils")}getScriptPartFromCode(t){if(!(t=_(t))||0>t.indexOf("-"))return null;let e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase())?null:this.formatLanguageCode(e.join("-"))}getLanguagePartFromCode(t){if(!(t=_(t))||0>t.indexOf("-"))return t;let e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if("string"==typeof t&&t.indexOf("-")>-1){let e=["hans","hant","latn","cyrl","cans","mong","arab"],i=t.split("-");return this.options.lowerCaseLng?i=i.map(t=>t.toLowerCase()):2===i.length?(i[0]=i[0].toLowerCase(),i[1]=i[1].toUpperCase(),e.indexOf(i[1].toLowerCase())>-1&&(i[1]=A(i[1].toLowerCase()))):3===i.length&&(i[0]=i[0].toLowerCase(),2===i[1].length&&(i[1]=i[1].toUpperCase()),"sgn"!==i[0]&&2===i[2].length&&(i[2]=i[2].toUpperCase()),e.indexOf(i[1].toLowerCase())>-1&&(i[1]=A(i[1].toLowerCase())),e.indexOf(i[2].toLowerCase())>-1&&(i[2]=A(i[2].toLowerCase()))),i.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){let e;return t?(t.forEach(t=>{if(e)return;let i=this.formatLanguageCode(t);(!this.options.supportedLngs||this.isSupportedCode(i))&&(e=i)}),!e&&this.options.supportedLngs&&t.forEach(t=>{if(e)return;let i=this.getLanguagePartFromCode(t);if(this.isSupportedCode(i))return e=i;e=this.options.supportedLngs.find(t=>{if(t===i||!(0>t.indexOf("-")&&0>i.indexOf("-"))&&(t.indexOf("-")>0&&0>i.indexOf("-")&&t.substring(0,t.indexOf("-"))===i||0===t.indexOf(i)&&i.length>1))return t})}),!e&&(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e):null}getFallbackCodes(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),"string"==typeof t&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let i=t[e];return!i&&(i=t[this.getScriptPartFromCode(e)]),!i&&(i=t[this.formatLanguageCode(e)]),!i&&(i=t[this.getLanguagePartFromCode(e)]),!i&&(i=t.default),i||[]}toResolveHierarchy(t,e){let i=this.getFallbackCodes(e||this.options.fallbackLng||[],t),r=[],n=t=>{t&&(this.isSupportedCode(t)?r.push(t):this.logger.warn(`rejecting language code not found in supportedLngs: ${t}`))};return"string"==typeof t&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?("languageOnly"!==this.options.load&&n(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&n(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&n(this.getLanguagePartFromCode(t))):"string"==typeof t&&n(this.formatLanguageCode(t)),i.forEach(t=>{0>r.indexOf(t)&&n(this.formatLanguageCode(t))}),r}}let M=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],C={1:function(t){return Number(t>1)},2:function(t){return Number(1!=t)},3:function(t){return 0},4:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},5:function(t){return Number(0==t?0:1==t?1:2==t?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5)},6:function(t){return Number(1==t?0:t>=2&&t<=4?1:2)},7:function(t){return Number(1==t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(t>=2)},10:function(t){return Number(1==t?0:2==t?1:t<7?2:t<11?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:t>2&&t<20?2:3)},12:function(t){return Number(t%10!=1||t%100==11)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2)},16:function(t){return Number(t%10==1&&t%100!=11?0:0!==t?1:2)},17:function(t){return Number(1==t||t%10==1&&t%100!=11?0:1)},18:function(t){return Number(0==t?0:1==t?1:2)},19:function(t){return Number(1==t?0:0==t||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3)},20:function(t){return Number(1==t?0:0==t||t%100>0&&t%100<20?1:2)},21:function(t){return Number(t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0)},22:function(t){return Number(1==t?0:2==t?1:(t<0||t>10)&&t%10==0?2:3)}},T=["v1","v2","v3"],E=["v4"],O={zero:0,one:1,two:2,few:3,many:4,other:5};class P{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=t,this.options=e,this.logger=s.create("pluralResolver"),(!this.options.compatibilityJSON||E.includes(this.options.compatibilityJSON))&&("undefined"==typeof Intl||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=function(){let t={};return M.forEach(e=>{e.lngs.forEach(i=>{t[i]={numbers:e.nr,plurals:C[e.fc]}})}),t}()}addRule(t,e){this.rules[t]=e}getRule(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(_("dev"===t?"en":t),{type:e.ordinal?"ordinal":"cardinal"})}catch(t){return}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getRule(t,e);return this.shouldUseIntlApi()?i&&i.resolvedOptions().pluralCategories.length>1:i&&i.numbers.length>1}getPluralFormsOfKey(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(t,i).map(t=>`${e}${t}`)}getSuffixes(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getRule(t,e);return i?this.shouldUseIntlApi()?i.resolvedOptions().pluralCategories.sort((t,e)=>O[t]-O[e]).map(t=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${t}`):i.numbers.map(i=>this.getSuffix(t,i,e)):[]}getSuffix(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.getRule(t,i);if(r)return this.shouldUseIntlApi()?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${r.select(e)}`:this.getSuffixRetroCompatible(r,e);return this.logger.warn(`no plural rule found for: ${t}`),""}getSuffixRetroCompatible(t,e){let i=t.noAbs?t.plurals(e):t.plurals(Math.abs(e)),r=t.numbers[i];this.options.simplifyPluralSuffix&&2===t.numbers.length&&1===t.numbers[0]&&(2===r?r="plural":1===r&&(r=""));let n=()=>this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString();if("v1"===this.options.compatibilityJSON)return 1===r?"":"number"==typeof r?`_plural_${r.toString()}`:n();if("v2"===this.options.compatibilityJSON)return n();if(this.options.simplifyPluralSuffix&&2===t.numbers.length&&1===t.numbers[0])return n();return this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}shouldUseIntlApi(){return!T.includes(this.options.compatibilityJSON)}}function R(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",n=!(arguments.length>4)||void 0===arguments[4]||arguments[4],s=function(t,e,i){let r=c(t,i);return void 0!==r?r:c(e,i)}(t,e,i);return!s&&n&&"string"==typeof i&&void 0===(s=y(t,i,r))&&(s=y(e,i,r)),s}class B{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=s.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(t=>t),this.init(t)}init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!t.interpolation&&(t.interpolation={escapeValue:!0});let{escape:e,escapeValue:i,useRawValueToEscape:r,prefix:n,prefixEscaped:s,suffix:a,suffixEscaped:o,formatSeparator:l,unescapeSuffix:h,unescapePrefix:u,nestingPrefix:d,nestingPrefixEscaped:c,nestingSuffix:g,nestingSuffixEscaped:m,nestingOptionsSeparator:v,maxReplaces:y,alwaysFormat:_}=t.interpolation;this.escape=void 0!==e?e:f,this.escapeValue=void 0===i||i,this.useRawValueToEscape=void 0!==r&&r,this.prefix=n?p(n):s||"{{",this.suffix=a?p(a):o||"}}",this.formatSeparator=l||",",this.unescapePrefix=h?"":u||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=d?p(d):c||p("$t("),this.nestingSuffix=g?p(g):m||p(")"),this.nestingOptionsSeparator=v||",",this.maxReplaces=y||1e3,this.alwaysFormat=void 0!==_&&_,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let t=(t,e)=>t&&t.source===e?(t.lastIndex=0,t):RegExp(e,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,e,i,r){let n,s,a;let o=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function h(t){return t.replace(/\$/g,"$$$$")}let u=t=>{if(0>t.indexOf(this.formatSeparator)){let n=R(e,o,t,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(n,void 0,i,{...r,...e,interpolationkey:t}):n}let n=t.split(this.formatSeparator),s=n.shift().trim(),a=n.join(this.formatSeparator).trim();return this.format(R(e,o,s,this.options.keySeparator,this.options.ignoreJSONStructure),a,i,{...r,...e,interpolationkey:s})};this.resetRegExp();let d=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,c=r&&r.interpolation&&void 0!==r.interpolation.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:t=>h(t)},{regex:this.regexp,safeValue:t=>this.escapeValue?h(this.escape(t)):h(t)}].forEach(e=>{for(a=0;n=e.regex.exec(t);){let i=n[1].trim();if(void 0===(s=u(i))){if("function"==typeof d){let e=d(t,n,r);s="string"==typeof e?e:""}else if(r&&Object.prototype.hasOwnProperty.call(r,i))s="";else if(c){s=n[0];continue}else this.logger.warn(`missed to pass in variable ${i} for interpolating ${t}`),s=""}else"string"!=typeof s&&!this.useRawValueToEscape&&(s=l(s));let o=e.safeValue(s);if(t=t.replace(n[0],o),c?(e.regex.lastIndex+=s.length,e.regex.lastIndex-=n[0].length):e.regex.lastIndex=0,++a>=this.maxReplaces)break}}),t}nest(t,e){let i,r,n,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};function a(t,e){let i=this.nestingOptionsSeparator;if(0>t.indexOf(i))return t;let r=t.split(RegExp(`${i}[ ]*{`)),s=`{${r[1]}`;t=r[0];let a=(s=this.interpolate(s,n)).match(/'/g),o=s.match(/"/g);(a&&a.length%2==0&&!o||o.length%2!=0)&&(s=s.replace(/'/g,'"'));try{n=JSON.parse(s),e&&(n={...e,...n})}catch(e){return this.logger.warn(`failed parsing options string in nesting for key ${t}`,e),`${t}${i}${s}`}return n.defaultValue&&n.defaultValue.indexOf(this.prefix)>-1&&delete n.defaultValue,t}for(;i=this.nestingRegexp.exec(t);){let o=[];(n=(n={...s}).replace&&"string"!=typeof n.replace?n.replace:n).applyPostProcessor=!1,delete n.defaultValue;let h=!1;if(-1!==i[0].indexOf(this.formatSeparator)&&!/{.*}/.test(i[1])){let t=i[1].split(this.formatSeparator).map(t=>t.trim());i[1]=t.shift(),o=t,h=!0}if((r=e(a.call(this,i[1].trim(),n),n))&&i[0]===t&&"string"!=typeof r)return r;"string"!=typeof r&&(r=l(r)),!r&&(this.logger.warn(`missed to resolve ${i[1]} for nesting ${t}`),r=""),h&&(r=o.reduce((t,e)=>this.format(t,e,s.lng,{...s,interpolationkey:i[1].trim()}),r.trim())),t=t.replace(i[0],r),this.regexp.lastIndex=0}return t}}function I(t){let e={};return function(i,r,n){let s=r+JSON.stringify(n),a=e[s];return!a&&(a=t(_(r),n),e[s]=a),a(i)}}class L{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=s.create("formatter"),this.options=t,this.formats={number:I((t,e)=>{let i=new Intl.NumberFormat(t,{...e});return t=>i.format(t)}),currency:I((t,e)=>{let i=new Intl.NumberFormat(t,{...e,style:"currency"});return t=>i.format(t)}),datetime:I((t,e)=>{let i=new Intl.DateTimeFormat(t,{...e});return t=>i.format(t)}),relativetime:I((t,e)=>{let i=new Intl.RelativeTimeFormat(t,{...e});return t=>i.format(t,e.range||"day")}),list:I((t,e)=>{let i=new Intl.ListFormat(t,{...e});return t=>i.format(t)})},this.init(t)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},i=e.interpolation;this.formatSeparator=i.formatSeparator?i.formatSeparator:i.formatSeparator||","}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=I(e)}format(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e.split(this.formatSeparator).reduce((t,e)=>{let{formatName:n,formatOptions:s}=function(t){let e=t.toLowerCase().trim(),i={};if(t.indexOf("(")>-1){let r=t.split("(");e=r[0].toLowerCase().trim();let n=r[1].substring(0,r[1].length-1);"currency"===e&&0>n.indexOf(":")?!i.currency&&(i.currency=n.trim()):"relativetime"===e&&0>n.indexOf(":")?!i.range&&(i.range=n.trim()):n.split(";").forEach(t=>{if(t){let[e,...r]=t.split(":"),n=r.join(":").trim().replace(/^'+|'+$/g,""),s=e.trim();!i[s]&&(i[s]=n),"false"===n&&(i[s]=!1),"true"===n&&(i[s]=!0),!isNaN(n)&&(i[s]=parseInt(n,10))}})}return{formatName:e,formatOptions:i}}(e);if(this.formats[n]){let e=t;try{let a=r&&r.formatParams&&r.formatParams[r.interpolationkey]||{},o=a.locale||a.lng||r.locale||r.lng||i;e=this.formats[n](t,o,{...s,...r,...a})}catch(t){this.logger.warn(t)}return e}return this.logger.warn(`there was no format function for ${n}`),t},t)}}class D extends a{constructor(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=t,this.store=e,this.services=i,this.languageUtils=i.languageUtils,this.options=r,this.logger=s.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(i,r.backend,r)}queueLoad(t,e,i,r){let n={},s={},a={},o={};return t.forEach(t=>{let r=!0;e.forEach(e=>{let a=`${t}|${e}`;!i.reload&&this.store.hasResourceBundle(t,e)?this.state[a]=2:this.state[a]<0||(1===this.state[a]?void 0===s[a]&&(s[a]=!0):(this.state[a]=1,r=!1,void 0===s[a]&&(s[a]=!0),void 0===n[a]&&(n[a]=!0),void 0===o[e]&&(o[e]=!0)))}),!r&&(a[t]=!0)}),(Object.keys(n).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(n),pending:Object.keys(s),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(o)}}loaded(t,e,i){let r=t.split("|"),n=r[0],s=r[1];e&&this.emit("failedLoading",n,s,e),i&&this.store.addResourceBundle(n,s,i,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2;let a={};this.queue.forEach(i=>{var r,o;!function(t,e,i,r){let{obj:n,k:s}=u(t,e,Object);n[s]=n[s]||[],n[s].push(i)}(i.loaded,[n],s),r=i,o=t,void 0!==r.pending[o]&&(delete r.pending[o],r.pendingCount--),e&&i.errors.push(e),0===i.pendingCount&&!i.done&&(Object.keys(i.loaded).forEach(t=>{!a[t]&&(a[t]={});let e=i.loaded[t];e.length&&e.forEach(e=>{void 0===a[t][e]&&(a[t][e]=!0)})}),i.done=!0,i.errors.length?i.callback(i.errors):i.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(t=>!t.done)}read(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!t.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:e,fcName:i,tried:r,wait:n,callback:s});return}this.readingCalls++;let a=(a,o)=>{if(this.readingCalls--,this.waitingReads.length>0){let t=this.waitingReads.shift();this.read(t.lng,t.ns,t.fcName,t.tried,t.wait,t.callback)}if(a&&o&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,t,e,i,r+1,2*n,s)},n);return}s(a,o)},o=this.backend[i].bind(this.backend);if(2===o.length){try{let i=o(t,e);i&&"function"==typeof i.then?i.then(t=>a(null,t)).catch(a):a(null,i)}catch(t){a(t)}return}return o(t,e,a)}prepareLoading(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();"string"==typeof t&&(t=this.languageUtils.toResolveHierarchy(t)),"string"==typeof e&&(e=[e]);let n=this.queueLoad(t,e,i,r);if(!n.toLoad.length)return!n.pending.length&&r(),null;n.toLoad.forEach(t=>{this.loadOne(t)})}load(t,e,i){this.prepareLoading(t,e,{},i)}reload(t,e,i){this.prepareLoading(t,e,{reload:!0},i)}loadOne(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=t.split("|"),r=i[0],n=i[1];this.read(r,n,"read",void 0,void 0,(i,s)=>{i&&this.logger.warn(`${e}loading namespace ${n} for language ${r} failed`,i),!i&&s&&this.logger.log(`${e}loaded namespace ${n} for language ${r}`,s),this.loaded(t,i,s)})}saveMissing(t,e,i,r,n){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)){this.logger.warn(`did not save key "${i}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(null!=i&&""!==i){if(this.backend&&this.backend.create){let o={...s,isUpdate:n},l=this.backend.create.bind(this.backend);if(l.length<6)try{let n;(n=5===l.length?l(t,e,i,r,o):l(t,e,i,r))&&"function"==typeof n.then?n.then(t=>a(null,t)).catch(a):a(null,n)}catch(t){a(t)}else l(t,e,i,r,a,o)}t&&t[0]&&this.store.addResource(t[0],e,i,r)}}}function F(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){let e={};if("object"==typeof t[1]&&(e=t[1]),"string"==typeof t[1]&&(e.defaultValue=t[1]),"string"==typeof t[2]&&(e.tDescription=t[2]),"object"==typeof t[2]||"object"==typeof t[3]){let i=t[3]||t[2];Object.keys(i).forEach(t=>{e[t]=i[t]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function j(t){return"string"==typeof t.ns&&(t.ns=[t.ns]),"string"==typeof t.fallbackLng&&(t.fallbackLng=[t.fallbackLng]),"string"==typeof t.fallbackNS&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&0>t.supportedLngs.indexOf("cimode")&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function N(){}class z extends a{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;if(super(),this.options=j(t),this.services={},this.logger=s,this.modules={external:[]},!function(t){Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(e=>{"function"==typeof t[e]&&(t[e]=t[e].bind(t))})}(this),e&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,e),this;setTimeout(()=>{this.init(t,e)},0)}}init(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof e&&(i=e,e={}),!e.defaultNS&&!1!==e.defaultNS&&e.ns&&("string"==typeof e.ns?e.defaultNS=e.ns:0>e.ns.indexOf("translation")&&(e.defaultNS=e.ns[0]));let r=F();function n(t){return t?"function"==typeof t?new t:t:null}if(this.options={...r,...this.options,...j(e)},"v1"!==this.options.compatibilityAPI&&(this.options.interpolation={...r.interpolation,...this.options.interpolation}),void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator),!this.options.isClone){let e;this.modules.logger?s.init(n(this.modules.logger),this.options):s.init(null,this.options),this.modules.formatter?e=this.modules.formatter:"undefined"!=typeof Intl&&(e=L);let i=new w(this.options);this.store=new b(this.options.resources,this.options);let a=this.services;a.logger=s,a.resourceStore=this.store,a.languageUtils=i,a.pluralResolver=new P(i,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),e&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(a.formatter=n(e),a.formatter.init(a,this.options),this.options.interpolation.format=a.formatter.format.bind(a.formatter)),a.interpolator=new B(this.options),a.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},a.backendConnector=new D(n(this.modules.backend),a.resourceStore,a,this.options),a.backendConnector.on("*",function(e){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];t.emit(e,...r)}),this.modules.languageDetector&&(a.languageDetector=n(this.modules.languageDetector),a.languageDetector.init&&a.languageDetector.init(a,this.options.detection,this.options)),this.modules.i18nFormat&&(a.i18nFormat=n(this.modules.i18nFormat),a.i18nFormat.init&&a.i18nFormat.init(this)),this.translator=new k(this.services,this.options),this.translator.on("*",function(e){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];t.emit(e,...r)}),this.modules.external.forEach(t=>{t.init&&t.init(this)})}if(this.format=this.options.interpolation.format,!i&&(i=N),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let t=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);t.length>0&&"dev"!==t[0]&&(this.options.lng=t[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(e=>{this[e]=function(){return t.store[e](...arguments)}});["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(e=>{this[e]=function(){return t.store[e](...arguments),t}});let a=o(),l=()=>{let t=(t,e)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,!this.options.isClone&&this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(e),i(t,e)};if(this.languages&&"v1"!==this.options.compatibilityAPI&&!this.isInitialized)return t(null,this.t.bind(this));this.changeLanguage(this.options.lng,t)};return this.options.resources||!this.options.initImmediate?l():setTimeout(l,0),a}loadResources(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N,i=e,r="string"==typeof t?t:this.language;if("function"==typeof t&&(i=t),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return i();let t=[],e=e=>{if(!!e&&"cimode"!==e)this.services.languageUtils.toResolveHierarchy(e).forEach(e=>{"cimode"!==e&&0>t.indexOf(e)&&t.push(e)})};r?e(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(t=>e(t)),this.options.preload&&this.options.preload.forEach(t=>e(t)),this.services.backendConnector.load(t,this.options.ns,t=>{!t&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(t)})}else i(null)}reloadResources(t,e,i){let r=o();return!t&&(t=this.languages),!e&&(e=this.options.ns),!i&&(i=N),this.services.backendConnector.reload(t,e,t=>{r.resolve(),i(t)}),r}use(t){if(!t)throw Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&x.addPostProcessor(t),"formatter"===t.type&&(this.modules.formatter=t),"3rdParty"===t.type&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!!t&&!!this.languages){if(!(["cimode","dev"].indexOf(t)>-1))for(let t=0;t<this.languages.length;t++){let e=this.languages[t];if(!(["cimode","dev"].indexOf(e)>-1)&&this.store.hasLanguageSomeTranslations(e)){this.resolvedLanguage=e;break}}}}changeLanguage(t,e){var i=this;this.isLanguageChangingTo=t;let r=o();this.emit("languageChanging",t);let n=t=>{this.language=t,this.languages=this.services.languageUtils.toResolveHierarchy(t),this.resolvedLanguage=void 0,this.setResolvedLanguage(t)},s=(t,s)=>{s?(n(s),this.translator.changeLanguage(s),this.isLanguageChangingTo=void 0,this.emit("languageChanged",s),this.logger.log("languageChanged",s)):this.isLanguageChangingTo=void 0,r.resolve(function(){return i.t(...arguments)}),e&&e(t,function(){return i.t(...arguments)})},a=e=>{!t&&!e&&this.services.languageDetector&&(e=[]);let i="string"==typeof e?e:this.services.languageUtils.getBestMatchFromCodes(e);i&&(!this.language&&n(i),!this.translator.language&&this.translator.changeLanguage(i),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(i)),this.loadResources(i,t=>{s(t,i)})};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(t):a(this.services.languageDetector.detect()),r}getFixedT(t,e,i){var r=this;let n=function(t,e){let s,a;if("object"!=typeof e){for(var o=arguments.length,l=Array(o>2?o-2:0),h=2;h<o;h++)l[h-2]=arguments[h];s=r.options.overloadTranslationOptionHandler([t,e].concat(l))}else s={...e};s.lng=s.lng||n.lng,s.lngs=s.lngs||n.lngs,s.ns=s.ns||n.ns,""!==s.keyPrefix&&(s.keyPrefix=s.keyPrefix||i||n.keyPrefix);let u=r.options.keySeparator||".";return a=s.keyPrefix&&Array.isArray(t)?t.map(t=>`${s.keyPrefix}${u}${t}`):s.keyPrefix?`${s.keyPrefix}${u}${t}`:t,r.t(a,s)};return"string"==typeof t?n.lng=t:n.lngs=t,n.ns=e,n.keyPrefix=i,n}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let i=e.lng||this.resolvedLanguage||this.languages[0],r=!!this.options&&this.options.fallbackLng,n=this.languages[this.languages.length-1];if("cimode"===i.toLowerCase())return!0;let s=(t,e)=>{let i=this.services.backendConnector.state[`${t}|${e}`];return -1===i||2===i};if(e.precheck){let t=e.precheck(this,s);if(void 0!==t)return t}return!!(this.hasResourceBundle(i,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||s(i,t)&&(!r||s(n,t)))||!1}loadNamespaces(t,e){let i=o();return this.options.ns?("string"==typeof t&&(t=[t]),t.forEach(t=>{0>this.options.ns.indexOf(t)&&this.options.ns.push(t)}),this.loadResources(t=>{i.resolve(),e&&e(t)}),i):(e&&e(),Promise.resolve())}loadLanguages(t,e){let i=o();"string"==typeof t&&(t=[t]);let r=this.options.preload||[],n=t.filter(t=>0>r.indexOf(t)&&this.services.languageUtils.isSupportedCode(t));return n.length?(this.options.preload=r.concat(n),this.loadResources(t=>{i.resolve(),e&&e(t)}),i):(e&&e(),Promise.resolve())}dir(t){return(!t&&(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),t)?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf((this.services&&this.services.languageUtils||new w(F())).getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr":"rtl"}static createInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return new z(t,e)}cloneInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N,i=t.forkResourceStore;i&&delete t.forkResourceStore;let r={...this.options,...t,isClone:!0},n=new z(r);return(void 0!==t.debug||void 0!==t.prefix)&&(n.logger=n.logger.clone(t)),["store","services","language"].forEach(t=>{n[t]=this[t]}),n.services={...this.services},n.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},i&&(n.store=new b(this.store.data,r),n.services.resourceStore=n.store),n.translator=new k(n.services,r),n.translator.on("*",function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];n.emit(t,...i)}),n.init(r,e),n.translator.options=r,n.translator.backendConnector.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},n}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}let H=z.createInstance();H.createInstance=z.createInstance,H.createInstance,H.dir,H.init,H.loadResources,H.reloadResources,H.use,H.changeLanguage,H.getFixedT,H.t,H.exists,H.setDefaultNamespace,H.hasLoadedNamespace,H.loadNamespaces,H.loadLanguages},5477:function(t,e,i){"use strict";let r;i.d(e,{Db:()=>g,$G:()=>E});var n=i("4194");i("3229"),Object.create(null);let s=t=>Array.isArray(t)?t:[t],a=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,o={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"\xa9","&#169;":"\xa9","&reg;":"\xae","&#174;":"\xae","&hellip;":"\u2026","&#8230;":"\u2026","&#x2F;":"/","&#47;":"/"},l=t=>o[t],h={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:t=>t.replace(a,l)},u=(t={})=>{h={...h,...t}},d=()=>h,c=t=>{r=t},p=()=>r,g={type:"3rdParty",init(t){u(t.options.react),c(t)}},f=(0,n.createContext)();class m{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(t=>{this.usedNamespaces[t]??=!0})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}let v=(...t)=>{console?.warn&&(A(t[0])&&(t[0]=`react-i18next:: ${t[0]}`),console.warn(...t))},y={},_=(...t)=>{(!A(t[0])||!y[t[0]])&&(A(t[0])&&(y[t[0]]=new Date),v(...t))},b=(t,e)=>()=>{if(t.isInitialized)e();else{let i=()=>{setTimeout(()=>{t.off("initialized",i)},0),e()};t.on("initialized",i)}},x=(t,e,i)=>{t.loadNamespaces(e,b(t,i))},S=(t,e,i,r)=>{A(i)&&(i=[i]),i.forEach(e=>{0>t.options.ns.indexOf(e)&&t.options.ns.push(e)}),t.loadLanguages(e,b(t,r))},k=(t,e,i={})=>e.languages&&e.languages.length?e.hasLoadedNamespace(t,{lng:i.lng,precheck:(e,r)=>{if(i.bindI18n?.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!r(e.isLanguageChangingTo,t))return!1}}):(_("i18n.languages were undefined or empty",e.languages),!0),A=t=>"string"==typeof t,w=t=>"object"==typeof t&&null!==t,M=(t,e)=>{let i=(0,n.useRef)();return(0,n.useEffect)(()=>{i.current=e?i.current:t},[t,e]),i.current},C=(t,e,i,r)=>t.getFixedT(e,i,r),T=(t,e,i,r)=>(0,n.useCallback)(C(t,e,i,r),[t,e,i,r]),E=(t,e={})=>{let{i18n:i}=e,{i18n:r,defaultNS:s}=(0,n.useContext)(f)||{},a=i||r||p();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new m),!a){_("You will need to pass in an i18next instance by using initReactI18next");let t=(t,e)=>A(e)?e:w(e)&&A(e.defaultValue)?e.defaultValue:Array.isArray(t)?t[t.length-1]:t,e=[t,{},!1];return e.t=t,e.i18n={},e.ready=!1,e}a.options.react?.wait&&_("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");let o={...d(),...a.options.react,...e},{useSuspense:l,keyPrefix:h}=o,u=t||s||a.options?.defaultNS;u=A(u)?[u]:u||["translation"],a.reportNamespaces.addUsedNamespaces?.(u);let c=(a.isInitialized||a.initializedStoreOnce)&&u.every(t=>k(t,a,o)),g=T(a,e.lng||null,"fallback"===o.nsMode?u:u[0],h),v=()=>g,y=()=>C(a,e.lng||null,"fallback"===o.nsMode?u:u[0],h),[b,E]=(0,n.useState)(v),O=u.join();e.lng&&(O=`${e.lng}${O}`);let P=M(O),R=(0,n.useRef)(!0);(0,n.useEffect)(()=>{let{bindI18n:t,bindI18nStore:i}=o;R.current=!0,!c&&!l&&(e.lng?S(a,e.lng,u,()=>{R.current&&E(y)}):x(a,u,()=>{R.current&&E(y)})),c&&P&&P!==O&&R.current&&E(y);let r=()=>{R.current&&E(y)};return t&&a?.on(t,r),i&&a?.store.on(i,r),()=>{R.current=!1,a&&t?.split(" ").forEach(t=>a.off(t,r)),i&&a&&i.split(" ").forEach(t=>a.store.off(t,r))}},[a,O]),(0,n.useEffect)(()=>{R.current&&c&&E(v)},[a,h,c]);let B=[b,a,c];if(B.t=b,B.i18n=a,B.ready=c,c||!c&&!l)return B;throw new Promise(t=>{e.lng?S(a,e.lng,u,()=>t()):x(a,u,()=>t())})}},3745:function(t,e,i){"use strict";i.d(e,{Ue:()=>c});let r=t=>{let e;let i=new Set,r=(t,r)=>{let n="function"==typeof t?t(e):t;if(!Object.is(n,e)){let t=e;e=(null!=r?r:"object"!=typeof n||null===n)?n:Object.assign({},e,n),i.forEach(i=>i(e,t))}},n=()=>e,s={setState:r,getState:n,getInitialState:()=>a,subscribe:t=>(i.add(t),()=>i.delete(t)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),i.clear()}},a=e=t(r,n,s);return s},n=t=>t?r(t):r;var s=i("4194"),a=i("7591");let{useDebugValue:o}=s,{useSyncExternalStoreWithSelector:l}=a,h=!1,u=t=>t,d=t=>{"function"!=typeof t&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let e="function"==typeof t?n(t):t,i=(t,i)=>(function(t,e=u,i){i&&!h&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),h=!0);let r=l(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,i);return o(r),r})(e,t,i);return Object.assign(i,e),i},c=t=>t?d(t):d}}]);